var za=Object.defineProperty;var Ca=v=>{throw TypeError(v)};var Va=(v,i,t)=>i in v?za(v,i,{enumerable:!0,configurable:!0,writable:!0,value:t}):v[i]=t;var ot=(v,i,t)=>Va(v,typeof i!="symbol"?i+"":i,t),Da=(v,i,t)=>i.has(v)||Ca("Cannot "+t);var gt=(v,i,t)=>(Da(v,i,"read from private field"),t?t.call(v):i.get(v)),Xt=(v,i,t)=>i.has(v)?Ca("Cannot add the same private member more than once"):i instanceof WeakSet?i.add(v):i.set(v,t),ua=(v,i,t,d)=>(Da(v,i,"write to private field"),d?d.call(v,t):i.set(v,t),t);import{s as $a,r as Ga,a as C,b as Xa,l as Qa,g as e,d as Oa,p as ht,c as Ve,m as ue,i as bt,t as l,e as a,f as x,h as y,j as fe,k as Ae,n as xt,o as oe,q as s,u as kt,v as he,D as Ja,w as je,x as L,y as r,z as ne,A as Ft,B as Z,C as ve,E as g,F as Za,G as it,H as Ht,I as er,J as tr,K as Nt,L as mt,M as Jt,N as Ra,O as ga,P as oa,Q as ma,R as Zt,S as sa,T as va,U as da,V as ar,W as rr,X as sr,Y as ir,Z as nr,_ as lr,$ as or,a0 as ia,a1 as Qt,a2 as Sa,a3 as vr,a4 as Wa,a5 as dr,a6 as zt,a7 as jt,a8 as Ma,a9 as ra,aa as cr,ab as _r,ac as ur,ad as Vt,ae as fr,af as Dt,ag as pr,ah as yr,ai as gr,aj as Ta,ak as ja,al as Ba,am as Ea,an as Aa,ao as Ya,ap as mr,aq as Ut,ar as Lt,as as St,at as Kt,au as hr,av as br,aw as La,ax as It,ay as Pt,az as kr,aA as xr,aB as wr,aC as Ua,aD as Cr,aE as Dr,aF as $r}from"../chunk/entity_proc_20260111_193353.js";import"../chunk/json_20260111_193353.js";(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const f of document.querySelectorAll('link[rel="modulepreload"]'))d(f);new MutationObserver(f=>{for(const c of f)if(c.type==="childList")for(const p of c.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&d(p)}).observe(document,{childList:!0,subtree:!0});function t(f){const c={};return f.integrity&&(c.integrity=f.integrity),f.referrerPolicy&&(c.referrerPolicy=f.referrerPolicy),f.crossOrigin==="use-credentials"?c.credentials="include":f.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function d(f){if(f.ep)return;f.ep=!0;const c=t(f);fetch(f.href,c)}})();const Sr=v=>v;function ha(v){const i=v-1;return i*i*i+1}function Na(v){const i=typeof v=="string"&&v.match(/^\s*(-?[\d.]+)([^\s]*)\s*$/);return i?[parseFloat(i[1]),i[2]||"px"]:[v,"px"]}function Mr(v,{delay:i=0,duration:t=400,easing:d=Sr}={}){const f=+getComputedStyle(v).opacity;return{delay:i,duration:t,easing:d,css:c=>`opacity: ${c*f}`}}function Tr(v,{delay:i=0,duration:t=400,easing:d=ha,x:f=0,y:c=0,opacity:p=0}={}){const o=getComputedStyle(v),E=+o.opacity,j=o.transform==="none"?"":o.transform,S=E*(1-p),[M,n]=Na(f),[U,X]=Na(c);return{delay:i,duration:t,easing:d,css:(P,B)=>`
			transform: ${j} translate(${(1-P)*M}${n}, ${(1-P)*U}${X});
			opacity: ${E-S*B}`}}function pe(v,{delay:i=0,duration:t=400,easing:d=ha,axis:f="y"}={}){const c=getComputedStyle(v),p=+c.opacity,o=f==="y"?"height":"width",E=parseFloat(c[o]),j=f==="y"?["top","bottom"]:["left","right"],S=j.map(Y=>`${Y[0].toUpperCase()}${Y.slice(1)}`),M=parseFloat(c[`padding${S[0]}`]),n=parseFloat(c[`padding${S[1]}`]),U=parseFloat(c[`margin${S[0]}`]),X=parseFloat(c[`margin${S[1]}`]),P=parseFloat(c[`border${S[0]}Width`]),B=parseFloat(c[`border${S[1]}Width`]);return{delay:i,duration:t,easing:d,css:Y=>`overflow: hidden;opacity: ${Math.min(Y*20,1)*p};${o}: ${Y*E}px;padding-${j[0]}: ${Y*M}px;padding-${j[1]}: ${Y*n}px;margin-${j[0]}: ${Y*U}px;margin-${j[1]}: ${Y*X}px;border-${j[0]}-width: ${Y*P}px;border-${j[1]}-width: ${Y*B}px;min-${o}: 0`}}function qa(v,i){for(const t in i)v[t]=i[t];return v}function jr({fallback:v,...i}){const t=new Map,d=new Map;function f(p,o,E){const{delay:j=0,duration:S=h=>Math.sqrt(h)*30,easing:M=ha}=qa(qa({},i),E),n=p.getBoundingClientRect(),U=o.getBoundingClientRect(),X=n.left-U.left,P=n.top-U.top,B=n.width/U.width,Y=n.height/U.height,de=Math.sqrt(X*X+P*P),be=getComputedStyle(o),Me=be.transform==="none"?"":be.transform,ye=+be.opacity;return{delay:j,duration:typeof S=="function"?S(de):S,easing:M,css:(h,T)=>`
			   opacity: ${h*ye};
			   transform-origin: top left;
			   transform: ${Me} translate(${T*X}px,${T*P}px) scale(${h+(1-h)*B}, ${h+(1-h)*Y});
		   `}}function c(p,o,E){return(j,S)=>(p.set(S.key,j),()=>{if(o.has(S.key)){const M=o.get(S.key);return o.delete(S.key),f(M,j,S)}return p.delete(S.key),v&&v(j,S,E)})}return[c(d,t,!1),c(t,d,!0)]}function Pa(v){return Object.prototype.toString.call(v)==="[object Date]"}function Br(v){return v}function fa(v){const i=v-1;return i*i*i+1}function pa(v,i){if(v===i||v!==v)return()=>v;const t=typeof v;if(t!==typeof i||Array.isArray(v)!==Array.isArray(i))throw new Error("Cannot interpolate values of different type");if(Array.isArray(v)){const d=i.map((f,c)=>pa(v[c],f));return f=>d.map(c=>c(f))}if(t==="object"){if(!v||!i)throw new Error("Object cannot be null");if(Pa(v)&&Pa(i)){const c=v.getTime(),o=i.getTime()-c;return E=>new Date(c+E*o)}const d=Object.keys(i),f={};return d.forEach(c=>{f[c]=pa(v[c],i[c])}),c=>{const p={};return d.forEach(o=>{p[o]=f[o](c)}),p}}if(t==="number"){const d=i-v;return f=>v+f*d}return()=>i}var Bt,Gt,ea,Ot;const ba=class ba{constructor(i,t={}){Xt(this,Bt,$a(void 0));Xt(this,Gt,$a(void 0));Xt(this,ea);Xt(this,Ot,null);gt(this,Bt).v=gt(this,Gt).v=i,ua(this,ea,t)}static of(i,t){const d=new ba(i(),t);return Ga(()=>{d.set(i())}),d}set(i,t){var M;C(gt(this,Gt),i);let{delay:d=0,duration:f=400,easing:c=Br,interpolate:p=pa}={...gt(this,ea),...t};if(f===0)return(M=gt(this,Ot))==null||M.abort(),C(gt(this,Bt),i),Promise.resolve();const o=Xa.now()+d;let E,j=!1,S=gt(this,Ot);return ua(this,Ot,Qa(n=>{if(n<o)return!0;if(!j){j=!0;const X=gt(this,Bt).v;E=p(X,i),typeof f=="function"&&(f=f(X,i)),S==null||S.abort()}const U=n-o;return U>f?(C(gt(this,Bt),i),!1):(C(gt(this,Bt),E(c(U/f))),!0)})),gt(this,Ot).promise}get current(){return e(gt(this,Bt))}get target(){return e(gt(this,Gt))}set target(i){this.set(i)}};Bt=new WeakMap,Gt=new WeakMap,ea=new WeakMap,Ot=new WeakMap;let na=ba;var Er=l('<div class="phase_display svelte-1boxe40"><span class="svelte-1boxe40"> </span> </div>'),Ar=l('<div class="lifepoint_display svelte-1boxe40"><div class="svelte-1boxe40"> </div> <div class="svelte-1boxe40"> </div></div>'),Yr=(v,i,t)=>i(e(t)),Lr=l('<div class="svelte-1boxe40"><button class="phase_button svelte-1boxe40"> </button></div>'),Ur=l("<div><!></div>"),Nr=l('<div class="svelte-1boxe40"><!></div>'),qr=l("<div><!></div>"),Pr=l('<div class="config_button_wrapper svelte-1boxe40"><button id="config_button" class="svelte-1boxe40">⚙</button></div>'),Fr=l("<!> <!> <!> <!>",1),Hr=l('<div style="position: absolute;" class="card_animation_receiver svelte-1boxe40"><!></div>'),Or=l('<div style="position: absolute; top:0rem" class="svelte-1boxe40">｛効果対象｝</div>'),Rr=l('<!> <div style="position: absolute; display:flex;justify-content: center;"><!></div>',1),Wr=l(" <!> 】",1),Ir=l('<div style="position: absolute; bottom:0rem" class="svelte-1boxe40"> <!></div>'),Kr=l("<!> <!>",1),zr=l('<div class="badge svelte-1boxe40"> </div>'),Vr=l('<div class="card_animation_receiver svelte-1boxe40"><!></div>'),Gr=l("<!> <!> <!> <!>",1),Xr=l('<td><div role="listitem"><!></div></td>');function Qr(v,i){ht(i,!1);let t=Ve(i,"view",12),d=Ve(i,"row",8),f=Ve(i,"column",8),c=Ve(i,"selectedEntities",28,()=>[]),p=Ve(i,"selectedCells",28,()=>[]),o=ue(t().getCell(d(),f())),E=ue(new na(e(o).field.duel.duelists.Above.lp,{duration:400,easing:fa})),j=ue(new na(e(o).field.duel.duelists.Below.lp,{duration:400,easing:fa}));const S=()=>{C(o,t().getCell(d(),f())),he(E,e(E).target=e(o).field.duel.duelists.Above.lp),he(j,e(j).target=e(o).field.duel.duelists.Below.lp)};e(o).onUpdate.append(S),t().onDuelUpdate.append(S),t().modalController.onUpdate.append(S);let M,n=ue([]),U=()=>console.log("hoge"),X,P=ue([]),B=ue(!1),Y=ue(!1),de=!1;const be=$=>{var O,q;C(ee,[]),c().reset(),M=$.activator,U=$.resolve,C(n,$.dummyActionInfos),C(P,$.chainBlockInfos.flatMap(V=>V.selectedEntities).getDistinct()),X=$.entitiesChoices,C(B,!1),C(Y,((O=$.cellsChoices)==null?void 0:O.selectables.includes(e(o)))??!1),de=e(Y)&&((q=$.cellsChoices)==null?void 0:q.qty)===1,S()};t().onWaitStart.append(be);const Me=()=>{M=void 0,C(n,[]),U=()=>{console.log("hoge")},X=void 0,C(P,[]),C(B,!1),C(Y,!1),de=!1};t().onWaitEnd.append(Me);let ye=ue(!1),h=[];const T=$=>{h=$.filter(O=>O.dests.includes(e(o))),C(ye,h.length>0),S()},K=()=>{h=[],C(ye,!1),S()};t().onDragStart.append(T),t().onDragEnd.append(K);const[re,z]=ni;let ee=ue([]);const Te=$=>{if(M=void 0,e(o)===$.to||e(o).entities.includes($.entity)){C(ee,[...e(ee),$]);const O=$.resolve;C(o,e(o)),setTimeout(()=>{C(ee,e(ee).filter(q=>q!==$)),$.count++,$.count>1&&O()},600)}};t().onAnimation.append(Te);const le=$=>{U({phaseChange:$})},A=()=>e(o).isStackCell&&e(o).entities.flatMap($=>$.actions).filter($=>e(n).map(O=>O.action.seq).some(O=>O===$.seq)).length>0,N=$=>{var O;if(((O=$.target)==null?void 0:O.id)==="config_button"){t(t().infoBoardState="Config",!0),t().requireUpdate();return}if(t(t().infoBoardState="Default",!0),de)U({selectedCells:[e(o)]});else if(e(Y))C(B,!e(B)),p(e(B)?[...p(),e(o)]:p().filter(q=>q!==e(o)));else if(e(o).isStackCell){t(t().infoBoardState="CellInfo",!0),t(t().infoBoardCell=e(o),!0),t().requireUpdate();const q=e(o).entities.flatMap(J=>J.actions).map(J=>J.seq),V=e(n).filter(J=>q.includes(J.action.seq));if(V.length){if(!M)return;t().modalController.actionSelector.show({title:"カードを選択。",position:"Bottom",activator:M,dummyActionInfos:V,cancelable:!0}).then(J=>{J&&U({actionInfo:J})});return}}t().requireUpdate(),console.info(e(o),Ce(...e(o).visibleEntities))},se=$=>{$.preventDefault(),$.dataTransfer&&($.dataTransfer.dropEffect="move")},me=$=>{$.preventDefault(),console.info("drop",$,e(ye),h),$.dataTransfer&&($.dataTransfer.dropEffect="move");try{if(e(ye)&&h){if(h.length===1){const O=h[0];U({actionInfo:{...O,dest:e(o)}})}else if(h.length>1){if(!M)throw new Ja("想定されない状態");e(o).field.duel.view.modalController.terminateAll(),e(o).field.duel.view.modalController.actionSelector.show({title:"選択",position:"Bottom",activator:M,dummyActionInfos:h.map(O=>({...O,dest:e(o)})),cancelable:!1}).then(O=>{U({actionInfo:O})})}}}finally{t().removeDraggingActions()}},Ce=(...$)=>{if(t().waitMode==="Animation")return"Disabled";if(X&&X.selectables.find(q=>$.find(V=>q===V)))return"Selectable";if(!e(n)||e(n).length===0||t().waitMode!=="Free"||Object.values(t().modalController.modals).some(q=>q.state==="Shown"))return"Disabled";const O=e(n).filter(q=>$.includes(q.action.entity));return O.length===0?"Disabled":e(o).isStackCell||O[0].action.entity!==$[0]?"Clickable":O.some(q=>q.dests.length)?"Draggable":"Clickable"};bt();var F=Xr(),D=a(F);D.__click=N;var R=a(D);{var te=$=>{var O=je(),q=L(O);{var V=J=>{var ke=je(),m=L(ke);{var _=b=>{var H=Er(),W=a(H),De=a(W),xe=r(W,1,!0);y((ce,Q)=>{g(De,ce),g(xe,Q)},[()=>String(e(o).field.duel.clock.turn).padStart(2,"0"),()=>e(o).field.duel.phase.toUpperCase()],fe),s(b,H)},u=b=>{var H=je(),W=L(H);{var De=ce=>{var Q=Ar(),G=a(Q),I=a(G),$e=r(G,2),Oe=a($e);y((We,Re)=>{g(I,We),g(Oe,Re)},[()=>Math.floor(e(E).current),()=>Math.floor(e(j).current)],fe),s(ce,Q)},xe=ce=>{var Q=je(),G=L(Q);{var I=$e=>{var Oe=je(),We=L(Oe);{var Re=Ue=>{var Xe=je(),qe=L(Xe);{var we=Se=>{var Pe=je(),Ie=L(Pe);ne(Ie,1,()=>t().duel.nextPhaseList,ve,(ze,Ze)=>{var _e=Lr(),Ye=a(_e);Ye.__click=[Yr,le,Ze];var w=a(Ye);y(k=>g(w,k),[()=>e(Ze).toUpperCase()],fe),s(ze,_e)}),s(Se,Pe)};x(qe,Se=>{t().duel.isEnded||Se(we)})}s(Ue,Xe)};x(We,Ue=>{t().waitMode==="Free"&&Ue(Re)})}s($e,Oe)};x(G,$e=>{e(o).column===5&&$e(I)},!0)}s(ce,Q)};x(W,ce=>{e(o).column===3?ce(De):ce(xe,!1)},!0)}s(b,H)};x(m,b=>{e(o).column===1?b(_):b(u,!1)})}s(J,ke)};x(q,J=>{e(o).row===3&&J(V)})}s($,O)},ie=$=>{var O=je(),q=L(O);{var V=ke=>{var m=Fr();const _=fe(()=>e(ee).find(Q=>Q.to===e(o)));var u=L(m);{var b=Q=>{var G=Ur(),I=a(G);Ft(I,{get entity(){return e(_).entity},state:"Disabled",dummyActionInfos:[],cardActionResolve:void 0}),y(()=>Ae(G,`card_animation_receiver ${e(o).cellType??""} svelte-1boxe40`)),Z(1,G,()=>z,()=>({key:e(_).entity.seq})),s(Q,G)};x(u,Q=>{e(_)&&e(_).index==="Top"&&Q(b)})}var H=r(u,2);ne(H,1,()=>e(o).visibleEntities,ve,(Q,G)=>{var I=je(),$e=L(I);{var Oe=We=>{var Re=Nr(),Ue=a(Re);const Xe=fe(()=>Ce(e(G))),qe=fe(()=>e(n).filter(we=>we.action.entity===e(G)));Ft(Ue,{get entity(){return e(G)},get state(){return e(Xe)},get dummyActionInfos(){return e(qe)},cardActionResolve:void 0,get selectedList(){return c()},set selectedList(we){c(we)},$$legacy:!0}),Z(2,Re,()=>re,()=>({key:e(G).seq})),s(We,Re)};x($e,We=>{e(ee).every(Re=>Re.entity.seq!==e(G).seq)&&We(Oe)})}s(Q,I)});var W=r(H,2);{var De=Q=>{var G=qr(),I=a(G);Ft(I,{get entity(){return e(_).entity},state:"Disabled",dummyActionInfos:[],cardActionResolve:void 0}),y(()=>Ae(G,`card_animation_receiver ${e(o).cellType??""} svelte-1boxe40`)),Z(1,G,()=>z,()=>({key:e(_).entity.seq})),s(Q,G)};x(W,Q=>{e(_)&&e(_).index!=="Top"&&Q(De)})}var xe=r(W,2);{var ce=Q=>{var G=Pr();s(Q,G)};x(xe,Q=>{e(o).owner.seat==="Below"&&Q(ce)})}s(ke,m)},J=ke=>{var m=Gr();const _=fe(()=>e(ee).find(G=>G.to===e(o)));var u=L(m);{var b=G=>{var I=Hr(),$e=a(I);Ft($e,{get entity(){return e(_).entity},state:"Disabled",dummyActionInfos:[],cardActionResolve:void 0}),Z(1,I,()=>z,()=>({key:e(_).entity.seq})),s(G,I)};x(u,G=>{e(_)&&e(_).index!=="Top"&&G(b)})}var H=r(u,2);{var W=G=>{var I=Kr(),$e=L(I);ne($e,1,()=>e(o).visibleEntities.map((Re,Ue)=>({index:Ue,entity:Re})).toReversed(),ve,(Re,Ue)=>{var Xe=je(),qe=L(Xe);{var we=Se=>{var Pe=Rr();const Ie=fe(()=>!e(o).isStackCell&&e(Ue).index===0?Ce(...e(o).visibleEntities):void 0);var ze=L(Pe);{var Ze=k=>{var ae=Or();s(k,ae)};x(ze,k=>{e(P).includes(e(Ue).entity)&&k(Ze)})}var _e=r(ze,2),Ye=a(_e);const w=fe(()=>e(Ue).index===0?e(n).filter(k=>e(o).visibleEntities.includes(k.action.entity)):void 0);Ft(Ye,{get entity(){return e(Ue).entity},get state(){return e(Ie)},get dummyActionInfos(){return e(w)},cardActionResolve:void 0,get selectedList(){return c()},set selectedList(k){c(k)},$$legacy:!0}),y(()=>Ae(_e,`duel_card_wrapper ${(e(Ue).entity.exist?"duel_card_wrapper_exists":"")??""} svelte-1boxe40`)),Z(2,_e,()=>re,()=>({key:e(Ue).entity.seq})),s(Se,Pe)};x(qe,Se=>{e(ee).every(Pe=>Pe.entity.seq!==e(Ue).entity.seq)&&Se(we)})}s(Re,Xe)});var Oe=r($e,2);{var We=Re=>{var Ue=Ir(),Xe=a(Ue),qe=r(Xe);ne(qe,1,()=>Ht(e(o).visibleEntities[0].status.maxCounterQty),ve,(we,Se)=>{var Pe=Wr(),Ie=L(Pe),ze=r(Ie);{var Ze=_e=>{var Ye=it();y(()=>g(Ye,`/${e(o).visibleEntities[0].status.maxCounterQty[e(Se)]??""}`)),s(_e,Ye)};x(ze,_e=>{(e(o).visibleEntities[0].status.maxCounterQty[e(Se)]??9999)<100&&_e(Ze)})}y((_e,Ye)=>g(Ie,`【
              ${_e??""}${Ye??""} `),[()=>Za(e(Se)),()=>e(o).visibleEntities[0].counterHolder.getQty(e(Se))],fe),s(we,Pe)}),y(()=>g(Xe,`【${e(o).visibleEntities[0].battlePositionName??""}】 `)),s(Re,Ue)};x(Oe,Re=>{e(o).visibleEntities[0].battlePosition&&Re(We)})}s(G,I)};x(H,G=>{e(o).visibleEntities.length>0&&G(W)})}var De=r(H,2);{var xe=G=>{var I=zr(),$e=a(I);y(()=>g($e,e(o).visibleEntities.length)),s(G,I)};x(De,G=>{e(o).isStackCell&&G(xe)})}var ce=r(De,2);{var Q=G=>{var I=Vr(),$e=a(I);Ft($e,{get entity(){return e(_).entity},state:"Disabled",dummyActionInfos:[],cardActionResolve:void 0}),Z(1,I,()=>z,()=>({key:e(_).entity.seq})),s(G,I)};x(ce,G=>{e(_)&&e(_).index==="Top"&&G(Q)})}s(ke,m)};x(q,ke=>{e(o).cellType==="Hand"?ke(V):ke(J,!1)},!0)}s($,O)};x(R,$=>{e(o).isDisabledCell?$(te):$(ie,!1)})}y($=>{Ae(F,`${`duel_field_cell duel_field_cell_${e(o).cellType} ${e(o).linkArrowSources.length===0?"":"duel_field_cell_linked"}`??""} svelte-1boxe40`),xt(F,"colspan",e(o).cellType==="Hand"?7:1),Ae(D,`${$??""} svelte-1boxe40`)},[()=>`duel_field_cell_inner_box ${e(o).cellType} ${e(ye)?"can_accept_drop":""} ${A()?"can_action":""} ${e(B)?"is_selected":e(Y)?"is_selectable":""} `],fe),oe("dragover",D,se),oe("drop",D,me),s(v,F),kt()}Oa(["click"]);const Jr=(v,i,t=void 0,d="!!!circular reference!!!")=>{let f=[];return JSON.stringify(v,(c,p)=>{if(typeof p=="object"){if(f.indexOf(p)>-1)return d;f.push(p)}let o=p;if(i&&(o=i(c,p)),typeof o=="function")return o.toString();if(o!==p&&typeof o=="object"){if(f.indexOf(o)>-1)return d;f.push(o)}return o},t)};var Zr=l('<div class="title svelte-14z6bdh"> </div>'),es=l('<div class="title svelte-14z6bdh"> </div>'),ts=l('<div class="duel_log_chain_number svelte-14z6bdh"> </div>'),as=l('<div><a class="white_button" download="error_info.json">エラー情報ダウンロード</a></div>'),rs=l("<div><!> <!></div>"),ss=l('<div><div style="display: flex;    justify-content: space-between;"><div style=" white-space: nowrap;text-align: center;"> </div> <!></div> <!></div>'),is=l("<div><!> <!></div>"),ns=l("<div><!> <!></div>"),ls=l('<div class="duel_log svelte-14z6bdh"><div class="duel_log_header svelte-14z6bdh"></div> <div class="duel_log_body svelte-14z6bdh"></div> <div class="duel_log_footer svelte-14z6bdh"></div></div>');function os(v,i){ht(i,!1);let t=ue(void 0),d=Ve(i,"log",8),f,c=ue([]);const p=()=>{const S=((f==null?void 0:f.seq)??-1)+1;d().records.slice(S).forEach(M=>{if(!f){C(c,[[[[M]]]]),f=M;return}if(!e(c)[M.clock.turn]){he(c,e(c)[M.clock.turn]=[[[M]]]),f=M;return}if(!e(c)[M.clock.turn][M.clock.phaseSeq]){he(c,e(c)[M.clock.turn][M.clock.phaseSeq]=[[M]]),f=M;return}if(f.clock.chainSeq===M.clock.chainSeq&&f.clock.chainBlockSeq===M.clock.chainBlockSeq&&f.duelist===M.duelist){e(c)[M.clock.turn][M.clock.phaseSeq].slice(-1)[0].push(M),f=M;return}e(c)[M.clock.turn][M.clock.phaseSeq].push([M]),f=M}),C(c,e(c)),er().then(()=>e(t)&&e(t).scroll(0,e(t).clientHeight*990))};d().onUpdate.append(p),d().duel.view.onDuelUpdate.append(p),p(),bt();var o=je(),E=L(o);{var j=S=>{var M=ls(),n=r(a(M),2);ne(n,5,()=>e(c),ve,(U,X)=>{var P=ns(),B=a(P);{var Y=be=>{var Me=Zr(),ye=a(Me);y(()=>g(ye,`ターン：${e(X)[0][0][0].clock.turn??""}`)),s(be,Me)};x(B,be=>{e(X)[0][0][0].clock.turn>0&&be(Y)})}var de=r(B,2);ne(de,1,()=>e(X),ve,(be,Me)=>{var ye=is(),h=a(ye);{var T=re=>{var z=es(),ee=a(z);y(()=>g(ee,e(Me)[0][0].clock.period.name)),s(re,z)};x(h,re=>{e(Me)[0][0].clock.turn>0&&re(T)})}var K=r(h,2);ne(K,1,()=>e(Me),ve,(re,z)=>{var ee=ss();const Te=fe(()=>{var F;return((F=e(z).find(D=>D.chainNumber!==void 0))==null?void 0:F.chainNumber)??0});var le=a(ee),A=a(le),N=a(A),se=r(A,2);{var me=F=>{var D=ts(),R=a(D);y(()=>g(R,`チェーン：${e(Te)??""}`)),s(F,D)};x(se,F=>{e(Te)&&F(me)})}var Ce=r(le,2);ne(Ce,1,()=>e(z),ve,(F,D)=>{var R=rs(),te=a(R);{var ie=V=>{var J=it();y(()=>g(J,e(D).text)),s(V,J)},$=V=>{var J=je(),ke=L(J);{var m=u=>{var b=it();y((H,W,De)=>g(b,`移動：${H??""} ${W??""} ⇒ ${De??""}`),[()=>{var H;return(H=e(D).mainEntity)==null?void 0:H.toString()},()=>{var H;return(H=e(D).from)==null?void 0:H.toString()},()=>{var H;return(H=e(D).to)==null?void 0:H.toString()}],fe),s(u,b)},_=u=>{var b=je(),H=L(b);{var W=xe=>{var ce=it();y((Q,G)=>g(ce,`生成：${Q??""} void ⇒ ${G??""}`),[()=>{var Q;return(Q=e(D).mainEntity)==null?void 0:Q.toString()},()=>{var Q;return(Q=e(D).to)==null?void 0:Q.toString()}],fe),s(xe,ce)},De=xe=>{var ce=je(),Q=L(ce);{var G=$e=>{var Oe=it();y((We,Re)=>g(Oe,`消滅：${We??""} ${Re??""} ⇒ void`),[()=>{var We;return(We=e(D).mainEntity)==null?void 0:We.toString()},()=>{var We;return(We=e(D).from)==null?void 0:We.toString()}],fe),s($e,Oe)},I=$e=>{var Oe=it();y(()=>g(Oe,e(D).text)),s($e,Oe)};x(Q,$e=>{e(D).type==="EntityDisappear"?$e(G):$e(I,!1)},!0)}s(xe,ce)};x(H,xe=>{e(D).type==="EntityAppear"?xe(W):xe(De,!1)},!0)}s(u,b)};x(ke,u=>{e(D).type==="EntityMove"?u(m):u(_,!1)},!0)}s(V,J)};x(te,V=>{e(D).type==="ChainBlockHeader"?V(ie):V($,!1)})}var O=r(te,2);{var q=V=>{var J=as(),ke=a(J);y(m=>xt(ke,"href",m),[()=>window.URL.createObjectURL(new Blob([Jr(e(D).error,(m,_)=>["pool","bundles","duel"].includes(m)||typeof _=="function"?void 0:_,4)],{type:"text/plain"}))],fe),s(V,J)};x(O,V=>{e(D).error&&V(q)})}y(V=>Ae(R,`duel_log_record duel_log_record_${V??""} svelte-14z6bdh`),[()=>e(D).type.toSnakeCase()],fe),s(F,R)}),y(()=>{var F,D,R;Ae(ee,`duel_log_block_duelist duel_log_block_duelist_${((F=e(z)[0].duelist)==null?void 0:F.seat)??"system"} svelte-14z6bdh`),Ae(A,`duelist ${((D=e(z)[0].duelist)==null?void 0:D.seat)??""} svelte-14z6bdh`),g(N,((R=e(z)[0].duelist)==null?void 0:R.profile.name)||"SYSTEM")}),s(re,ee)}),y(()=>Ae(ye,`duel_log_block_phase duel_log_block_phase_${e(Me)[0][0].clock.period.key??""} svelte-14z6bdh`)),s(be,ye)}),y(()=>Ae(P,`duel_log_block_turn duel_log_block_turn_${e(X)[0][0][0].clock.turn??""} svelte-14z6bdh`)),s(U,P)}),tr(n,U=>C(t,U),()=>e(t)),s(S,M)};x(E,S=>{(d().duel.view.infoBoardState==="Log"||d().duel.view.infoBoardState==="Default")&&S(j)})}s(v,o),kt()}var vs=l("<div><div> </div> <div> </div></div>");function Fa(v,i){ht(i,!1);let t=Ve(i,"duelist",12),d=ue(0),f=ue();const c=async()=>{const n=t().lp-e(d);if(!e(f)||Math.abs(n)<10){C(d,t().lp),e(f)&&(e(f)(),C(f,void 0));return}C(d,e(d)+Math.floor(Math.random()*n)),await Nt(100),c()},p=()=>{t(t()),!e(f)&&t().lp!==e(d)&&new Promise(n=>{C(f,n),Math.abs(t().lp-e(d)),c()})};t().duel.log.onUpdate.append(p),c(),bt();var o=vs(),E=a(o),j=a(E),S=r(E,2),M=a(S);y(n=>{Ae(o,`duelist duelist_${n??""} svelte-1sy3trd`),Ae(E,`duelist_name duelist_${n??""}_name svelte-1sy3trd`),g(j,t().profile.name),Ae(S,`duelist_lp ${(e(f)?"vibration":"")??""} svelte-1sy3trd`),g(M,e(d))},[()=>t().seat.toLowerCase()],fe),s(v,o),kt()}const ds=(v,i,t)=>(i(i()!=="Detail"?"Detail":"Normal"),console.info(t()),!0),cs=(v,i,t)=>(i(i()!=="Debug"?"Debug":"Normal"),console.info(t()),!0);var _s=l('<div class="duel_card_info_row svelte-1uevs9j" style=" justify-content: space-between;"><div class="svelte-1uevs9j"> </div> <div class="svelte-1uevs9j"> </div></div>'),us=l('<div></div> <div class="svelte-1uevs9j"> </div>',1),fs=l("<div> </div>"),ps=l('<span class="svelte-1uevs9j">/</span> <div class="monster_defense svelte-1uevs9j"> </div>',1),ys=l("<div> </div>"),gs=l('<div class="duel_card_info_row svelte-1uevs9j"><!> <!> <div style="flex-grow: 1;" class="svelte-1uevs9j"></div> <div class="monster_attack svelte-1uevs9j"> </div> <!></div> <div class="duel_card_info_row svelte-1uevs9j"></div>',1),ms=l('<div class="duel_card_row svelte-1uevs9j"><div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"> </div></div>'),hs=l('<div class="duel_card_row svelte-1uevs9j"><div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"> </div></div>'),bs=l("<!> <!>",1),ks=l('<pre class="description svelte-1uevs9j"> </pre>'),xs=l('<div class="duel_card_info_row svelte-1uevs9j" style="border-style: solid; border-width: 1px;"><!></div>'),ws=l('<pre class="description svelte-1uevs9j"> </pre>'),Cs=l('<!> <div class="duel_card_info_row svelte-1uevs9j"><!></div>',1),Ds=l('<div class="effect_counter_area_item svelte-1uevs9j"><span class="svelte-1uevs9j"> </span> <span class="svelte-1uevs9j"> </span> <span class="svelte-1uevs9j">/</span> <span class="svelte-1uevs9j"> </span></div>'),$s=l('<div class="duel_card_info_row effect_counter_area svelte-1uevs9j"><div class="effect_counter_area_title svelte-1uevs9j">効果使用状況</div> <div class="effect_counter_area_body svelte-1uevs9j"></div></div>'),Ss=l("[ <!> ],",1),Ms=l('<div class="svelte-1uevs9j"> <!></div>'),Ts=l('<div class="svelte-1uevs9j"> </div> <!> <div class="svelte-1uevs9j"></div>',1),js=l('<div class="svelte-1uevs9j"> </div>'),Bs=l('<div class="svelte-1uevs9j"> </div>'),Es=l('<div class="svelte-1uevs9j"> </div>'),As=l('<div class="svelte-1uevs9j"> </div>'),Ys=l('<div class="svelte-1uevs9j"> </div>'),Ls=l('<div class="svelte-1uevs9j"> </div>'),Us=l('<div class="duel_card_info_row svelte-1uevs9j"><div class="svelte-1uevs9j"><!> <div class="svelte-1uevs9j"></div> <!> <div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"></div> <!> <div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"></div> <!> <div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"></div> <!> <div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"></div> <!> <div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"></div> <!> <div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"> </div> <div class="svelte-1uevs9j"> </div> <div class="svelte-1uevs9j"> </div> <div class="svelte-1uevs9j"></div></div></div>'),Ns=l('<div class="svelte-1uevs9j">※エラッタ前のカードです</div>'),qs=l('<div class="svelte-1uevs9j">※テスト用カードです</div>'),Ps=l('<a target="_blank" rel="noopener noreferrer" title="コナミカードデータベース" class="svelte-1uevs9j"> </a>'),Fs=l('<div class="duel_card_info_links svelte-1uevs9j"><a target="_blank" rel="noopener noreferrer" title="遊戯王カードWiki" class="svelte-1uevs9j">⇒遊戯王カードWiki</a> <!></div>'),Hs=l("<!> <!>",1),Os=l('<div role="contentinfo"><div class="duel_card_info_header svelte-1uevs9j"><div class="duel_card_info_row svelte-1uevs9j"><div class="svelte-1uevs9j"> </div></div> <div class="duel_card_info_row svelte-1uevs9j" style="position:sticky; top:0;"><div class="svelte-1uevs9j"> </div> <div class="svelte-1uevs9j"> </div></div> <!></div> <div class="duel_card_info_body svelte-1uevs9j"><!></div> <div class="duel_card_info_footer svelte-1uevs9j"><!></div></div>');function Rs(v,i){ht(i,!1);let t=Ve(i,"entity",8,void 0),d=Ve(i,"mode",12,"Normal");const f=async()=>{if(!t())return;const S=(await Jt).getCardInfo(t().origin.name);if(S)return S.cardId!==void 0&&!S.description&&!S.pendulumDescription&&await Ra([S.cardId]),S},c=()=>t()&&t().entityType==="Card"&&(t().origin.cardId??!1)?`https://www.db.yugioh-card.com/yugiohdb/card_search.action?ope=2&cid=${t().origin.cardId}`:t()?`https://www.db.yugioh-card.com/yugiohdb/card_search.action?ope=1&sess=1&rp=10&mode=&sort=1&keyword=${t().origin.name}&stype=1&ctype=&othercon=2&starfr=&starto=&pscalefr=&pscaleto=&linkmarkerfr=&linkmarkerto=&link_m=2&atkfr=&atkto=&deffr=&defto=&releaseDStart=1&releaseMStart=1&releaseYStart=1999&releaseDEnd=&releaseMEnd=&releaseYEnd=`:"";bt();var p=je(),o=L(p);{var E=j=>{var S=Os();S.__click=[ds,d,t],S.__contextmenu=[cs,d,t];var M=a(S),n=a(M),U=a(n),X=a(U),P=r(n,2),B=a(P),Y=a(B),de=r(B,2),be=a(de),Me=r(P,2);{var ye=le=>{var A=bs(),N=L(A);{var se=D=>{var R=_s(),te=a(R),ie=a(te),$=r(te,2),O=a($);y(()=>{g(ie,`◀ ${t().psL??""}`),g(O,`${t().psR??""} ▶`)}),s(D,R)};x(N,D=>{var R;(R=t().origin.monsterCategories)!=null&&R.includes("Pendulum")&&D(se)})}var me=r(N,2);{var Ce=D=>{var R=gs(),te=L(R),ie=a(te);ne(ie,1,()=>t().attr,ve,(m,_)=>{var u=us(),b=L(u),H=r(b,2),W=a(H);y(()=>{Ae(b,`monster_attr ${e(_)??""} svelte-1uevs9j`),g(W,`${ga[e(_)]??""}属性`)}),s(m,u)});var $=r(ie,2);ne($,1,()=>t().types,ve,(m,_)=>{var u=fs(),b=a(u);y(()=>{Ae(u,`monster_cat ${e(_)??""} svelte-1uevs9j`),g(b,`${oa[e(_)]??""}${ma[e(_)]??""}族`)}),s(m,u)});var O=r($,4),q=a(O),V=r(O,2);{var J=m=>{var _=ps(),u=r(L(_),2),b=a(u);y(()=>g(b,t().def??"?")),s(m,_)};x(V,m=>{var _;(_=t().status.monsterCategories)!=null&&_.includes("Link")||m(J)})}var ke=r(te,2);ne(ke,5,()=>t().status.monsterCategories??[],ve,(m,_)=>{var u=ys(),b=a(u);y(()=>{Ae(u,`monster_cat ${e(_)??""} svelte-1uevs9j`),g(b,`${Zt[e(_)]??""}${sa[e(_)]??""}`)}),s(m,u)}),y(()=>g(q,t().atk??"?")),s(D,R)},F=D=>{var R=je(),te=L(R);{var ie=O=>{var q=ms(),V=r(a(q),2),J=a(V);y(()=>g(J,`${va[t().status.spellCategory]??""}魔法`)),s(O,q)},$=O=>{var q=je(),V=L(q);{var J=ke=>{var m=hs(),_=r(a(m),2),u=a(_);y(()=>g(u,`${da[t().status.trapCategory]??""}罠`)),s(ke,m)};x(V,ke=>{t().kind==="Trap"&&t().status.trapCategory&&ke(J)},!0)}s(O,q)};x(te,O=>{t().kind==="Spell"&&t().status.spellCategory?O(ie):O($,!1)},!0)}s(D,R)};x(me,D=>{t().kind==="Monster"?D(Ce):D(F,!1)})}s(le,A)};x(Me,le=>{d()!=="Debug"&&le(ye)})}var h=r(M,2),T=a(h);{var K=le=>{var A=Cs(),N=L(A);{var se=F=>{var D=xs(),R=a(D);mt(R,f,te=>{var ie=it('"読み込み中"');s(te,ie)},(te,ie)=>{var $=ks(),O=a($);y(()=>{var q;return g(O,(q=e(ie))==null?void 0:q.pendulumDescription)}),s(te,$)}),s(F,D)};x(N,F=>{var D;(D=t().status.monsterCategories)!=null&&D.includes("Pendulum")&&F(se)})}var me=r(N,2),Ce=a(me);mt(Ce,f,F=>{var D=it('"読み込み中"');s(F,D)},(F,D)=>{var R=ws(),te=a(R);y(()=>{var ie;return g(te,(ie=e(D))==null?void 0:ie.description)}),s(F,R)}),s(le,A)},re=le=>{var A=je(),N=L(A);{var se=Ce=>{var F=je(),D=L(F);{var R=te=>{var ie=$s(),$=r(a(ie),2);ne($,5,()=>t().actions,ve,(O,q)=>{var V=je();const J=fe(()=>e(q).actionCountUpperBound),ke=fe(()=>e(q).actionCount);var m=L(V);{var _=u=>{var b=Ds(),H=a(b),W=a(H),De=r(H,2),xe=a(De),ce=r(De,4),Q=a(ce);y(()=>{g(W,e(q).title),g(xe,e(ke)),g(Q,e(J))}),s(u,b)};x(m,u=>{e(J)!==void 0&&e(ke)!==void 0&&u(_)})}s(O,V)}),s(te,ie)};x(D,te=>{t().actions.some(ie=>ie.actionCountUpperBoundKey)&&te(R)})}s(Ce,F)},me=Ce=>{var F=Us(),D=a(F),R=a(D);ne(R,0,()=>["info","status"],ve,(qe,we)=>{var Se=Ts(),Pe=L(Se),Ie=a(Pe),ze=r(Pe,2);ne(ze,1,()=>Object.entries(t()[we]),ve,(_e,Ye)=>{let w=()=>e(Ye)[0],k=()=>e(Ye)[1];var ae=Ms(),ge=a(ae),He=r(ge);{var Ge=Ee=>{var Be=Ss(),Fe=r(L(Be));ne(Fe,1,k,ve,(dt,ft)=>{var Et=it();y(At=>g(Et,`${At??""},`),[()=>e(ft).toString()],fe),s(dt,Et)}),s(Ee,Be)},Ne=Ee=>{var Be=it();y(Fe=>g(Be,`${Fe??""},`),[()=>{var Fe;return(Fe=k())==null?void 0:Fe.toString()}],fe),s(Ee,Be)};x(He,Ee=>{Array.isArray(k())?Ee(Ge):Ee(Ne,!1)})}y(()=>g(ge,`"${w()??""}" : `)),s(_e,ae)});var Ze=r(ze,2);Ze.textContent="},",y(()=>g(Ie,`"${we??""}" :{`)),s(qe,Se)});var te=r(R,2);te.textContent='"actions" :[';var ie=r(te,2);ne(ie,1,()=>t().actions,ve,(qe,we)=>{var Se=js(),Pe=a(Se);y(()=>g(Pe,`"${e(we).playType??""} ${e(we).title??""}",`)),s(qe,Se)});var $=r(ie,2);$.textContent="],";var O=r($,2);O.textContent='"substituteEffects" :[';var q=r(O,2);ne(q,1,()=>t().substituteEffects,ve,(qe,we)=>{var Se=Bs(),Pe=a(Se);y(()=>g(Pe,`"${e(we).title??""}",`)),s(qe,Se)});var V=r(q,2);V.textContent="],";var J=r(V,2);J.textContent='"continuousEffects" :[';var ke=r(J,2);ne(ke,1,()=>t().continuousEffects,ve,(qe,we)=>{var Se=Es(),Pe=a(Se);y(()=>g(Pe,`"${e(we).isStarted??""}",`)),s(qe,Se)});var m=r(ke,2);m.textContent="],";var _=r(m,2);_.textContent='"procFilters" :[';var u=r(_,2);ne(u,1,()=>t().procFilterBundle.operators,ve,(qe,we)=>{var Se=As(),Pe=a(Se);y(Ie=>g(Pe,`"${Ie??""} ${e(we).title??""} ${e(we).isEffective??""} ",`),[()=>e(we).isSpawnedBy.toString()],fe),s(qe,Se)});var b=r(u,2);b.textContent="],";var H=r(b,2);H.textContent='"numericStateOperators" :[';var W=r(H,2);ne(W,1,()=>t().numericOprsBundle.operators,ve,(qe,we)=>{var Se=Ys(),Pe=a(Se);y(Ie=>g(Pe,`"${Ie??""} ${e(we).title??""} ${e(we).isEffective??""} ${e(we).isContinuous??""} ${e(we).targetState??""} ${e(we).targetStateGen??""} ",`),[()=>e(we).isSpawnedBy.toString()],fe),s(qe,Se)});var De=r(W,2);De.textContent="],";var xe=r(De,2);xe.textContent='"stateOperators" :[';var ce=r(xe,2);ne(ce,1,()=>t().statusOperatorBundle.operators,ve,(qe,we)=>{var Se=Ls(),Pe=a(Se);y(Ie=>g(Pe,`"${Ie??""} ${e(we).title??""} ${e(we).isEffective??""} ",`),[()=>e(we).isSpawnedBy.toString()],fe),s(qe,Se)});var Q=r(ce,2);Q.textContent="],";var G=r(Q,2);G.textContent='"lastMoveLogRecord" :{';var I=r(G,2),$e=a(I),Oe=r(I,2),We=a(Oe),Re=r(Oe,2),Ue=a(Re),Xe=r(Re,2);Xe.textContent="},",y((qe,we)=>{g($e,`"movedBy":"${qe??""}",`),g(We,`"movedAs":"${we??""}",`),g(Ue,`"movedAt":"${t().moveLog.latestRecord.movedAt.totalProcSeq??""}",`)},[()=>{var qe;return(qe=t().moveLog.latestRecord.movedBy)==null?void 0:qe.toString()},()=>t().moveLog.latestRecord.movedAs.join(" ")],fe),s(Ce,F)};x(N,Ce=>{d()==="Detail"?Ce(se):Ce(me,!1)},!0)}s(le,A)};x(T,le=>{d()==="Normal"?le(K):le(re,!1)})}var z=r(h,2),ee=a(z);{var Te=le=>{var A=Hs(),N=L(A);{var se=D=>{var R=Ns();s(D,R)};x(N,D=>{t().origin.isOldVersion&&D(se)})}var me=r(N,2);{var Ce=D=>{var R=qs();s(D,R)},F=D=>{var R=Fs(),te=a(R),ie=r(te,2);{var $=O=>{var q=Ps(),V=a(q);y(J=>{var ke;xt(q,"href",J),g(V,`⇒${((ke=t())!=null&&ke.origin.cardId?"公式カードページ":"公式で検索")??""}`)},[c],fe),s(O,q)};x(ie,O=>{t()&&t().entityType==="Card"&&O($)})}y(()=>xt(te,"href",`https://yugioh-wiki.net/index.php?${t().origin.wikiEncodedName}`)),s(D,R)};x(me,D=>{t().origin.isForTest?D(Ce):D(F,!1)})}s(le,A)};x(ee,le=>{t()&&le(Te)})}y((le,A,N)=>{Ae(S,`duel_card duel_card_info ${t().origin.kind??""} ${le??""} svelte-1uevs9j`),g(X,t().nm),g(Y,A),g(be,N)},[()=>{var le;return(le=t().origin.monsterCategories)==null?void 0:le.join(" ")},()=>"★".repeat(t().lvl||0),()=>"☆".repeat(t().rank||0)],fe),s(j,S)};x(o,j=>{t()&&j(E)})}s(v,p),kt()}Oa(["click","contextmenu"]);var Ws=l('<div class="duel_field_cell_info_item svelte-1xj7qf1"><!></div>'),Is=l('<div class="duel_field_cell_info_box svelte-1xj7qf1"><div class="duel_field_cell_info_label svelte-1xj7qf1"> </div> <!></div>'),Ks=l('<div class="duel_field_cell_info svelte-1xj7qf1"><div class="duel_field_cell_info_header item_btn svelte-1xj7qf1"><div class="svelte-1xj7qf1"> </div> <div class="svelte-1xj7qf1"> </div></div> <div class="duel_field_cell_info_body svelte-1xj7qf1"></div></div>');function zs(v,i){ht(i,!1);let t=Ve(i,"cell",12);const d=()=>{t(t())},f=E=>t().cardEntities.filter(j=>j.face===E);t().field.duel.view.onDuelUpdate.append(d),bt();var c=je(),p=L(c);{var o=E=>{var j=Ks(),S=a(j),M=a(S),n=a(M),U=r(M,2),X=a(U),P=r(S,2);ne(P,4,()=>["FaceUp","FaceDown"],ve,(B,Y)=>{var de=je(),be=L(de);{var Me=ye=>{var h=Is(),T=a(h),K=a(T),re=r(T,2);ne(re,1,()=>f(Y).toSorted(ar),ve,(z,ee)=>{var Te=Ws(),le=a(Te);const A=fe(()=>t().owner===t().field.duel.duelists.Below);Ft(le,{get entity(){return e(ee)},get isVisibleForcibly(){return e(A)},isWideMode:!0,cardActionResolve:void 0}),s(z,Te)}),y(()=>g(K,Y==="FaceUp"?"表向き":"裏向き")),s(ye,h)};x(be,ye=>{f(Y).length&&ye(Me)})}s(B,de)}),y(()=>{var B;g(n,(B=t().owner)==null?void 0:B.profile.name),g(X,t().cellType)}),s(E,j)};x(p,E=>{t().field.duel.view.infoBoardState==="CellInfo"&&E(o)})}s(v,c),kt()}var Vs=l('<div class="duel_config_item svelte-y4u26k"><label class="toggle svelte-y4u26k"><input type="checkbox" class="svelte-y4u26k"></label> <span class="svelte-y4u26k"> </span></div>'),Gs=l('<div class="duel_config svelte-y4u26k"><div class="duel_config_title svelte-y4u26k">デュエル設定</div> <div class="duel_config_group svelte-y4u26k"><div class="duel_config_group_title svelte-y4u26k">チェーン設定</div> <!></div></div>');function Xs(v,i){ht(i,!1);let t=Ve(i,"viewController",8),d=Ve(i,"userProfile",12);bt();var f=je(),c=L(f);{var p=o=>{var E=Gs(),j=r(a(E),2),S=r(a(j),2);ne(S,1,()=>ir,ve,(M,n)=>{var U=Vs(),X=a(U),P=a(X),B=r(X,2),Y=a(B);y(()=>g(Y,rr[e(n)])),sr(P,()=>d().chainConfig[e(n)],de=>d(d().chainConfig[e(n)]=de,!0)),oe("change",P,()=>d().save()),s(M,U)}),s(o,E)};x(c,o=>{t().infoBoardState==="Config"&&o(p)})}s(v,f),kt()}function Qs(v,{from:i,to:t},d={}){var{delay:f=0,duration:c=h=>Math.sqrt(h)*120,easing:p=fa}=d,o=getComputedStyle(v),E=o.transform==="none"?"":o.transform,[j,S]=o.transformOrigin.split(" ").map(parseFloat);j/=v.clientWidth,S/=v.clientHeight;var M=Js(v),n=v.clientWidth/t.width/M,U=v.clientHeight/t.height/M,X=i.left+i.width*j,P=i.top+i.height*S,B=t.left+t.width*j,Y=t.top+t.height*S,de=(X-B)*n,be=(P-Y)*U,Me=i.width/t.width,ye=i.height/t.height;return{delay:f,duration:typeof c=="function"?c(Math.sqrt(de*de+be*be)):c,easing:p,css:(h,T)=>{var K=T*de,re=T*be,z=h+T*Me,ee=h+T*ye;return`transform: ${E} translate(${K}px, ${re}px) scale(${z}, ${ee});`}}}function Js(v){if("currentCSSZoom"in v)return v.currentCSSZoom;for(var i=v,t=1;i!==null;)t*=+getComputedStyle(i).zoom,i=i.parentElement;return t}var Zs=l('<div class="chain_number svelte-lqu21u"> </div>'),ei=l('<div class="duel_card_row svelte-lqu21u"> </div>'),ti=l('<div class="appendix svelte-lqu21u"> </div>'),ai=l('<div class="appendix_wrapper svelte-lqu21u"></div>'),ri=l('<div><div><!> <div> </div> <div><!> <div class="duel_card_row svelte-lqu21u"><div> </div> <!></div></div></div></div>'),si=l("<div></div>");function ii(v,i){ht(i,!1);let t=Ve(i,"duel",8),d=Ve(i,"position",8,"left");const f=-100,c=()=>d()==="left"?-100:100;let p=ue([]),o=Promise.resolve(),E=Promise.resolve();const j=1e3,S=500,M=400,n=X=>{const P={...X};P.isKnown=X.chainBlockInfo.action.entity.controller.duelistType==="Player"||X.chainBlockInfo.action.entity.face==="FaceUp",P.chainBlockInfo.onStateChange.append(B=>{if(B==="done"||B==="failed"||B==="negated")return o=o.then(async()=>{const Y=new Date().getTime()-P.chainBlockInfo.wasSpawnedAt.getTime();Y<j&&await Nt(j-Y),C(p,e(p).filter(de=>de.seq!==P.seq)),await Nt(S+M)}).then(),"RemoveMe";C(p,e(p))}),E=E.then(async()=>{C(p,[P,...e(p)].sort((B,Y)=>nr.isSameChain(B.clock,Y.clock)&&B.chainBlockInfo.action.isWithChainBlock&&Y.chainBlockInfo.action.isWithChainBlock?Y.clock.totalProcSeq-B.clock.totalProcSeq:B.clock.totalProcSeq-Y.clock.totalProcSeq)),await Nt(300)}),o=o.then(()=>Nt(1e3))};t().chainBlockLog.onInsert.append(n),bt();var U=si();ne(U,13,()=>e(p),X=>X.seq,(X,P)=>{var B=ri();const Y=fe(()=>{const{activator:N,action:se,appendix:me}=e(P).chainBlockInfo;return{activator:N,action:se,appendix:me}});var de=a(B),be=a(de);{var Me=N=>{var se=Zs(),me=a(se);y(()=>g(me,`チェーン：${e(P).chainBlockInfo.chainNumber??""}`)),s(N,se)};x(be,N=>{e(P).chainBlockInfo.chainNumber&&N(Me)})}var ye=r(be,2),h=a(ye),T=r(ye,2),K=a(T);{var re=N=>{var se=ei(),me=a(se);y(()=>g(me,e(P).isKnown?e(Y).action.entity.nm:"？？？")),s(N,se)};x(K,N=>{(e(Y).action.entity.entityType==="Card"||e(Y).action.entity.entityType==="Token")&&N(re)})}var z=r(K,2),ee=a(z),Te=a(ee),le=r(ee,2);{var A=N=>{var se=ai();ne(se,5,()=>e(Y).appendix,ve,(me,Ce)=>{var F=ti(),D=a(F);y(()=>g(D,e(Ce))),s(me,F)}),s(N,se)};x(le,N=>{e(Y).appendix&&N(A)})}y((N,se,me)=>{Ae(B,`cut_in_row ${(!e(P).chainBlockInfo.chainNumber||e(P).chainBlockInfo.chainNumber===1?"cut_in_row_first":"")??""} svelte-lqu21u`),Ae(de,`cut_in_item cut_in_item_${N??""} cut_in_item_${e(P).chainBlockInfo.state??""} svelte-lqu21u`),Ae(ye,`duelist_name duelist_${N??""}_name svelte-lqu21u`),g(h,e(Y).activator.profile.name),Ae(T,`duel_card duel_card_${N??""} ${se??""} ${(e(P).isKnown?e(Y).action.entity.origin.kind:"")??""} ${e(Y).action.entity.entityType??""}  svelte-lqu21u`),g(Te,me)},[()=>e(Y).activator.seat.toLowerCase(),()=>e(P).isKnown?(e(Y).action.entity.status.monsterCategories??[]).join(" "):"Token",()=>e(Y).action.toString()],fe),Z(3,de,()=>Tr,()=>new Date().getTime()-e(P).chainBlockInfo.wasSpawnedAt.getTime()<j?{x:c(),duration:M}:{y:f,duration:M}),lr(B,()=>Qs,()=>({duration:S})),s(X,B)}),y(()=>Ae(U,`cut_in_container cut_in_container_${d()??""} svelte-lqu21u`)),s(v,U),kt()}const ni=jr({duration:400});var li=l('<div class="duel_desk_left v_flex svelte-1w535im"><!> <!> <!></div>'),oi=l('<button class="duel_field_header_message svelte-1w535im"> </button> <div class="duel_field_header_buttons svelte-1w535im"><button class="svelte-1w535im">サレンダー</button></div>',1),vi=l("<tr></tr>"),di=l('<table class="duel_field svelte-1w535im"><tbody class="svelte-1w535im"></tbody></table>'),ci=l('<button class="svelte-1w535im">OK</button>'),_i=l('<button class="svelte-1w535im">cancel</button>'),ui=l("<!> <!>",1),fi=l('<button class="svelte-1w535im"> </button>'),pi=l('<div style="text-align: left;"><!> <!> <!></div>'),yi=l('<div><!> <div class=" duel_desk_center v_flex svelte-1w535im"><div class="duel_field_header svelte-1w535im"><!></div> <div class="duel_field_body svelte-1w535im"><!></div> <div class="duel_field_footer svelte-1w535im"><!></div></div> <!></div> <div style="position:fixed;bottom:0"> </div> <!> <div><!></div>',1);function gi(v,i){ht(i,!1);let t=Ve(i,"duel",12),d=Ve(i,"userProfile",8),f=ue(0),c=ue(0),p=ue([]),o=ue([]),E=()=>{},j=ue([]),S=ue(),M=ue(),n=ue(()=>!1),U=ue(!1);const X=u=>{E=u.resolve,C(j,u.dummyActionInfos.filter(b=>b.action.entity.entityType==="Duelist").filter(b=>b.action.entity.controller.seat==="Below")),C(S,void 0),C(M,void 0),C(o,[]),C(p,[]),C(U,!1),u.entitiesChoices&&(C(S,u.entitiesChoices),C(n,()=>{var b;return((b=u.entitiesChoices)==null?void 0:b.validator(e(p)))??!1}),C(U,u.entitiesChoices.cancelable),e(S).selectables.every(b=>b.cell.isPlayFieldCell&&b.getIndexInCell()===0||b.cell.cellType==="Hand"&&b.controller.duelistType==="Player"||b.entityType==="Duelist")||t().view.modalController.entitySelector.show({title:t().view.message,position:"Middle",entitiesChoices:u.entitiesChoices,chainBlockInfos:u.chainBlockInfos,cancelable:u.entitiesChoices.cancelable}).then(b=>{E({selectedEntities:b})})),u.cellsChoices&&(C(M,u.cellsChoices),C(n,()=>{var b;return((b=u.cellsChoices)==null?void 0:b.validator(e(o)))??!1}),C(U,u.cellsChoices.cancelable))};t().view.onWaitStart.append(X);const P=()=>{E=()=>{},C(M,void 0),C(S,void 0),C(o,[]),C(p,[]),C(n,()=>!1),C(U,!1)};t().view.onWaitEnd.append(P);let B=ue(void 0),Y=ue("Normal");const de=({card:u,mode:b})=>{C(B,u),C(Y,b??(e(B)===u||e(Y)==="Normal"?"Detail":"Normal"))};t().view.onShowCardEntity.append(de);const be=()=>{t(t())};t().view.onDuelUpdate.append(be),t().log.onUpdate.append(be);const Me=()=>{e(S)&&e(S).validator(e(p))&&E({selectedEntities:e(p)}),e(M)&&e(M).validator(e(o))&&E({selectedCells:e(o)})},ye=()=>{E({})},h=u=>{E({actionInfo:u})},T=()=>{E({surrender:!0})};t().main();const K=()=>e(f)<=1400?"compact":"wide";bt();var re=yi(),z=L(re),ee=a(z);{var Te=u=>{var b=li(),H=a(b);Fa(H,{get duelist(){return t().duelists.Above}});var W=r(H,2);Rs(W,{get entity(){return e(B)},get mode(){return e(Y)}});var De=r(W,2);Fa(De,{get duelist(){return t().duelists.Below}}),s(u,b)};x(ee,u=>{K()==="wide"&&u(Te)})}var le=r(ee,2),A=a(le),N=a(A);{var se=u=>{var b=oi(),H=L(b),W=a(H),De=r(H,2),xe=a(De);y(()=>g(W,`[TURN:${t().clock.turn}][PHASE:${t().phase}] ${t().view.message}`)),oe("click",H,()=>{t(t().view.infoBoardState="Log",!0)}),oe("click",xe,T),s(u,b)};x(N,u=>{t().isEnded||u(se)})}var me=r(A,2),Ce=a(me);{var F=u=>{var b=di(),H=a(b);ne(H,5,()=>t().field.cells,ve,(W,De,xe)=>{var ce=vi();Ae(ce,`${`duel_desk_row_${xe}`??""} svelte-1w535im`),ne(ce,5,()=>e(De),ve,(Q,G,I)=>{Qr(Q,{get view(){return t().view},row:xe,column:I,get selectedEntities(){return e(p)},set selectedEntities($e){C(p,$e)},get selectedCells(){return e(o)},set selectedCells($e){C(o,$e)},$$legacy:!0})}),s(W,ce)}),s(u,b)};x(Ce,u=>{t().clock.turn>0&&u(F)})}var D=r(me,2),R=a(D);{var te=u=>{var b=ui(),H=L(b);{var W=ce=>{var Q=ci();y(G=>Q.disabled=G,[()=>!e(n)()],fe),oe("click",Q,Me),s(ce,Q)};x(H,ce=>{((e(S)&&e(S).qty)??(e(M)&&e(M).qty)??9999)>1&&ce(W)})}var De=r(H,2);{var xe=ce=>{var Q=_i();oe("click",Q,ye),s(ce,Q)};x(De,ce=>{e(U)&&ce(xe)})}s(u,b)},ie=u=>{var b=je(),H=L(b);ne(H,1,()=>e(j),ve,(W,De)=>{var xe=fi(),ce=a(xe);y(()=>g(ce,e(De).action.title)),oe("click",xe,()=>h(e(De))),s(W,xe)}),s(u,b)};x(R,u=>{e(S)&&e(S).selectables.length||e(M)&&e(M).selectables?u(te):u(ie,!1)})}var $=r(le,2);{var O=u=>{var b=pi(),H=a(b);os(H,{get log(){return t().log}});var W=r(H,2);zs(W,{get cell(){return t().view.infoBoardCell}});var De=r(W,2);Xs(De,{get userProfile(){return d()},get viewController(){return t().view}}),y(xe=>Ae(b,`duel_desk_right duel_desk_right_${xe??""}  svelte-1w535im`),[()=>t().view.infoBoardState.toLowerCase()],fe),Z(3,b,()=>pe,()=>({duration:e(f)>1400?0:200,axis:"x"})),s(u,b)};x($,u=>{(e(f)>1400||t().view.infoBoardState!=="Default")&&u(O)})}var q=r(z,2),V=a(q),J=r(q,2);or(J,{get modalController(){return t().view.modalController}});var ke=r(J,2),m=a(ke);const _=fe(()=>K()==="wide"?"right":"left");ii(m,{get duel(){return t()},get position(){return e(_)}}),y((u,b)=>{Ae(z,`flex duel_desk ${u??""}_mode svelte-1w535im`),g(V,b),Ae(ke,`cutin ${u??""}_mode svelte-1w535im`)},[K,()=>t().clock.toFullString()],fe),ia("innerWidth",u=>C(f,u)),ia("innerHeight",u=>C(c,u)),s(v,re),kt()}const mi=v=>v.filter(i=>i.kind!=="XyzMaterial").reduce((i,t)=>{const d=Qt(t);return i[d].push(t),i},{ExtraMonster:[],Monster:[],Spell:[],Trap:[]});var hi=l('<div class="svelte-1yfuu8d"><button class="button_style_reset svelte-1yfuu8d">クリア</button></div>'),bi=l("<div></div>"),ki=l("<!> <!> <!> <!> <!>",1),xi=l('<span> </span> / <span style="display: inline-block;width:2rem;text-align: right;"> </span>',1),wi=l('<li class="deck_editor_item svelte-1yfuu8d"><div role="listitem"><div class="svelte-1yfuu8d"><div class="svelte-1yfuu8d"> </div> <div style="display:flex; flex-wrap: wrap;" class="svelte-1yfuu8d"><div style="text-wrap-mode: nowrap;" class="svelte-1yfuu8d"><!> <!> <!></div> <div style="flex-grow: 1; height:0px; width:0px" class="svelte-1yfuu8d"></div> <div style="text-wrap-mode: nowrap;" class="svelte-1yfuu8d"><!></div></div></div></div> <button class="button_style_reset plus_minus_button svelte-1yfuu8d">+</button> <button class="button_style_reset plus_minus_button svelte-1yfuu8d">-</button></li>'),Ci=l('<div class="deck_editor_card_kind_header svelte-1yfuu8d"><div class="svelte-1yfuu8d"> <!> 枚） <!></div> <div style="display: flex;" class="svelte-1yfuu8d"><!> <div class="triangle svelte-1yfuu8d">▲</div></div></div> <div class="deck_editor_card_kind_body svelte-1yfuu8d"><ul></ul></div>',1),Di=l("<div><!></div>"),$i=l('<div class="svelte-1yfuu8d">読み込み中...</div>'),Si=l('<div class="deck_editor_card_list svelte-1yfuu8d"><!></div>');function Ha(v,i){ht(i,!1);let t=Ve(i,"allCardInfos",8),d=Ve(i,"deckCardTree",12),f=Ve(i,"mode",8),c=Ve(i,"onAttention",8),p=Ve(i,"searchCondition",8,void 0),o=ue("ExtraMonster");const E=500,j=ue({ExtraMonster:[],Monster:[],Spell:[],Trap:[]}),S=(...h)=>{const T=h.length?h:Ht(e(j)),K=(re,z)=>{var ee;return Ma(re,z,(ee=p())==null?void 0:ee.sort.filter(Te=>Te.priority>0).toSorted((Te,le)=>Te.priority-le.priority))};T.forEach(re=>e(j)[re].sort(K))};let M=new Promise(h=>{if(f()==="Deck"){h();return}f()==="List"&&(Object.values(e(j)).forEach(T=>T.reset()),t().filter(T=>T.kind!=="XyzMaterial").forEach(T=>{if(T.kind==="XyzMaterial")return;const K=Qt(T);e(j)[K].push(T)}),h())});const n=(h,T)=>{d(d()[T]=[],!0)},U=(h,T)=>{const K=Qt(T),re=d()[K].filter(ee=>ee.name===T.name).length;let z=h.shiftKey?3-re:1;console.debug(T,K,re,z),!h.ctrlKey&&re>2&&(z=0),z&&d(d()[K]=[...d()[K],...Array(z).fill(T)].sort(Ma),!0),c()(T)},X=(h,T)=>{const K=Qt(T);let re=0;d(d()[K]=d()[K].filter(z=>z.name!==T.name?!0:(re++,!h.shiftKey&&re>1)),!0),c()(T)};let P=ue(100);const B=()=>{C(P,e(P)+10),!(e(P)>=E)&&(e(P)>t().length+cr(...Object.values(d()).map(h=>h.length))||Nt(100).then(B))};let Y=ue(structuredClone(e(j))),de=ue("");const be=h=>{if(!p())return!0;if(h.kind==="XyzMaterial")return!1;const T=Qt(h);if(!p().deckCardKinds.includes(T)||p().name.trim().length&&[h.name,...h.nameTags??[],...h.textTags??[]].every(re=>!re.includes(p().name))||!h.isImplemented&&!p().others.includes("implemented")||h.isForTest&&!p().others.includes("test")||h.isOldVersion&&!p().others.includes("oldVersion"))return!1;if(h.kind==="Monster"){if(h.attributes&&!p().monsterAttributes.union(h.attributes).length||h.types&&!p().monsterTypes.union(h.types).length)return!1;const K=h.level??h.rank??h.link;return jt(p().starLowerBound)&&(K??0)<p().starLowerBound||jt(p().starUpperBound)&&(K??0)>p().starUpperBound||jt(p().atkLowerBound)&&(h.attack??0)<p().atkLowerBound||jt(p().atkUpperBound)&&(h.attack??0)>p().atkUpperBound||jt(p().defLowerBound)&&(h.defense??0)<p().defLowerBound||jt(p().defUpperBound)&&(h.defense??0)>p().defUpperBound||jt(p().atkPlusDef)&&(!jt(h.attack)||!jt(h.defense)||h.attack+h.defense!==p().atkPlusDef)||!h.monsterCategories||T==="ExtraMonster"&&!h.monsterCategories.union(p().exMonsterCategories).length?!1:h.monsterCategories.union(p().monsterCategories).length}if(h.kind==="Spell")return h.spellCategory&&p().spellCategories.includes(h.spellCategory);if(h.kind==="Trap")return h.trapCategory&&p().trapCategories.includes(h.trapCategory)};Sa(()=>(ra(f()),e(j),ra(d()),e(o),e(Y)),()=>{if(f()==="Deck"){if(Ht(e(j)).forEach(h=>he(j,e(j)[h]=d()[h])),!e(j)[e(o)].length)C(o,Ht(e(j)).find(h=>e(j)[h].find(be))??"ExtraMonster");else{const h=Ht(e(j)).map(T=>({kind:T,cardInfos:e(j)[T]})).filter(({cardInfos:T})=>T.length).find(({kind:T,cardInfos:K})=>K.length!==e(Y)[T].length);h&&e(o)!==h.kind&&C(o,h.kind)}C(Y,structuredClone(e(j)))}}),Sa(()=>(ra(f()),ra(p()),e(de),Nt),()=>{var h;if(f()==="List"){const T=JSON.stringify((h=p())==null?void 0:h.sort);e(de)!==T&&(C(de,T),S()),C(P,100),Nt(100).then(B)}}),vr(),bt();var Me=Si(),ye=a(Me);mt(ye,()=>M,h=>{var T=$i();s(h,T)},h=>{var T=je(),K=L(T);ne(K,1,()=>zt,ve,(re,z,ee)=>{var Te=Di();const le=fe(()=>e(j)[e(z)].filter(be));var A=a(Te);{var N=se=>{var me=Ci(),Ce=L(me),F=a(Ce),D=a(F),R=r(D);{var te=m=>{var _=it();y(u=>g(_,`/ ${u??""}`),[()=>e(j)[e(z)].length.toLocaleString()],fe),s(m,_)};x(R,m=>{f()==="List"&&m(te)})}var ie=r(R,2);{var $=m=>{var _=it();y(u=>g(_,`※表示上限${u??""}枚`),[()=>E.toLocaleString()],fe),s(m,_)};x(ie,m=>{e(le).length>E&&m($)})}var O=r(F,2),q=a(O);{var V=m=>{var _=hi(),u=a(_);oe("click",u,b=>n(b,e(z))),s(m,_)};x(q,m=>{f()==="Deck"&&e(le).length&&m(V)})}var J=r(Ce,2),ke=a(J);ne(ke,5,()=>e(le),ve,(m,_,u)=>{var b=je(),H=L(b);{var W=De=>{var xe=wi(),ce=a(xe),Q=a(ce),G=a(Q),I=a(G),$e=r(G,2),Oe=a($e),We=a(Oe);{var Re=_e=>{var Ye=ki(),w=L(Ye);{var k=Ee=>{var Be=it();y(()=>g(Be,`★${e(_).level??""}`)),s(Ee,Be)};x(w,Ee=>{e(_).level&&Ee(k)})}var ae=r(w,2);{var ge=Ee=>{var Be=it();y(()=>g(Be,`☆${e(_).rank??""}`)),s(Ee,Be)};x(ae,Ee=>{e(_).rank&&Ee(ge)})}var He=r(ae,2);ne(He,1,()=>e(_).attributes??[],ve,(Ee,Be)=>{var Fe=bi();y(()=>Ae(Fe,`monster_attr ${e(Be)??""} svelte-1yfuu8d`)),s(Ee,Fe)});var Ge=r(He,2);ne(Ge,1,()=>e(_).types??[],ve,(Ee,Be)=>{var Fe=it();y(()=>g(Fe,oa[e(Be)])),s(Ee,Fe)});var Ne=r(Ge,2);ne(Ne,1,()=>e(_).monsterCategories??[],ve,(Ee,Be)=>{var Fe=it();y(()=>g(Fe,Zt[e(Be)])),s(Ee,Fe)}),s(_e,Ye)};x(We,_e=>{e(_).kind==="Monster"&&_e(Re)})}var Ue=r(We,2);{var Xe=_e=>{var Ye=it();y(()=>g(Ye,`${va[e(_).spellCategory]??""}魔法`)),s(_e,Ye)};x(Ue,_e=>{e(_).spellCategory&&_e(Xe)})}var qe=r(Ue,2);{var we=_e=>{var Ye=it();y(()=>g(Ye,`${da[e(_).trapCategory]??""}罠`)),s(_e,Ye)};x(qe,_e=>{e(_).trapCategory&&_e(we)})}var Se=r(Oe,4),Pe=a(Se);{var Ie=_e=>{var Ye=xi(),w=L(Ye),k=a(w),ae=r(w,2),ge=a(ae);y(()=>{g(k,e(_).attack??"?"),g(ge,e(_).defense??"?")}),s(_e,Ye)};x(Pe,_e=>{e(_).kind==="Monster"&&_e(Ie)})}var ze=r(ce,2),Ze=r(ze,2);y((_e,Ye)=>{Ae(ce,`${_e??""} svelte-1yfuu8d`),g(I,e(_).name),ze.disabled=!e(_).isImplemented,xt(ze,"title",e(_).isImplemented?`※shiftキー同時押しで一括投入
※ctrlキー同時押しで枚数制限無視`:""),Ze.disabled=Ye,xt(Ze,"title",e(_).isImplemented?"※shiftキー同時押しで一括外し":"")},[()=>{var _e,Ye;return`deck_editor_card duel_card ${e(_).kind} ${(Ye=(_e=e(_))==null?void 0:_e.monsterCategories)==null?void 0:Ye.join(" ")} ${e(_).isImplemented?"is_implemented":"is_not_implemented"}`},()=>f()!=="Deck"&&d()[e(z)].every(_e=>_e.name!==e(_).name)],fe),oe("click",ce,()=>c()(e(_))),oe("click",ze,_e=>U(_e,e(_))),oe("click",Ze,_e=>X(_e,e(_))),s(De,xe)};x(H,De=>{u<e(P)&&(u<20||e(o)===e(z))&&De(W)})}s(m,b)}),y(m=>{g(D,`${Wa[e(z)]??""}（${m??""} `),Ae(ke,dr(e(z)),"svelte-1yfuu8d")},[()=>e(le).length.toLocaleString()],fe),oe("click",Ce,()=>{if(e(o)!==e(z)){C(o,e(z));return}C(o,zt.map((m,_)=>_+ee).map(m=>m%zt.length).map(m=>zt[m]).filter(m=>m!==e(z)).find(m=>e(j)[m].find(be))??e(z))}),s(se,me)};x(A,se=>{e(le).length&&se(N)})}y(()=>Ae(Te,`deck_editor_card_kind deckCardKind ${(e(z)===e(o)?"selected":"")??""} ${(e(le).length?"":"empty")??""} svelte-1yfuu8d`)),s(re,Te)}),s(h,T)}),s(v,Me),kt()}var Mi=l('<div class="duel_card_info_row svelte-rccxcp" style="position:sticky; top:0;"><div class="svelte-rccxcp"> </div> <div class="svelte-rccxcp"> </div></div>'),Ti=l('<div class="duel_card_info_row svelte-rccxcp"><div class="svelte-rccxcp"><pre class="description svelte-rccxcp"> </pre></div></div> <div class="duel_card_info_row svelte-rccxcp" style=" justify-content: space-between;"><div class="svelte-rccxcp"> </div> <div class="svelte-rccxcp"> </div></div>',1),ji=l('<div></div> <div class="svelte-rccxcp"> </div>',1),Bi=l("<div> </div>"),Ei=l('<span class="svelte-rccxcp">/</span> <div class="monster_defense svelte-rccxcp"> </div>',1),Ai=l("<div> </div>"),Yi=l('<div class="duel_card_info_row svelte-rccxcp"><!> <!> <div style="flex-grow: 1;" class="svelte-rccxcp"></div> <div class="monster_attack svelte-rccxcp"> </div> <!></div> <div class="duel_card_info_row svelte-rccxcp"></div>',1),Li=l('<div class="duel_card_row svelte-rccxcp"><div class="svelte-rccxcp"></div> <div class="svelte-rccxcp"> </div></div>'),Ui=l('<div class="duel_card_row svelte-rccxcp"><div class="svelte-rccxcp"></div> <div class="svelte-rccxcp"> </div></div>'),Ni=l('<div class="duel_card_info_row svelte-rccxcp"><div class="svelte-rccxcp">※エラッタ前カードです</div></div>'),qi=l('<div class="duel_card_info_row svelte-rccxcp"><div class="svelte-rccxcp">※テスト用カードです</div></div>'),Pi=l('<div class="duel_card_info_links svelte-rccxcp"><a target="_blank" rel="noopener noreferrer" title="遊戯王カードWiki" class="svelte-rccxcp">⇒遊戯王カードWiki</a> <a target="_blank" rel="noopener noreferrer" title="コナミカードデータベース" class="svelte-rccxcp"> </a></div>'),Fi=l('<div><div class="duel_card_info_header svelte-rccxcp"><div class="duel_card_info_row svelte-rccxcp"><div class="svelte-rccxcp"> </div></div> <!></div> <div class="duel_card_info_body svelte-rccxcp"><!> <!> <div class="duel_card_info_row description svelte-rccxcp"><div class="svelte-rccxcp"><pre class="description svelte-rccxcp"> </pre></div></div> <!> <!></div></div>');function Hi(v,i){ht(i,!1);let t=Ve(i,"cardInfo",8,void 0),d=Ve(i,"onAttention",8);bt();var f=je(),c=L(f);{var p=o=>{var E=Fi(),j=a(E),S=a(j),M=a(S),n=a(M),U=r(S,2);{var X=A=>{var N=Mi(),se=a(N),me=a(se),Ce=r(se,2),F=a(Ce);y((D,R)=>{g(me,D),g(F,R)},[()=>"★".repeat(t().level||0),()=>"☆".repeat(t().rank||0)],fe),s(A,N)};x(U,A=>{t().kind==="Monster"&&A(X)})}var P=r(j,2),B=a(P);{var Y=A=>{var N=Ti(),se=L(N),me=a(se),Ce=a(me),F=a(Ce),D=r(se,2),R=a(D),te=a(R),ie=r(R,2),$=a(ie);y(()=>{g(F,t().pendulumDescription),g(te,`◀ ${t().pendulumScaleL??""}`),g($,`${t().pendulumScaleR??""} ▶`)}),s(A,N)};x(B,A=>{var N;(N=t().monsterCategories)!=null&&N.includes("Pendulum")&&A(Y)})}var de=r(B,2);{var be=A=>{var N=Yi(),se=L(N),me=a(se);{var Ce=q=>{var V=ji(),J=L(V),ke=r(J,2),m=a(ke);y(()=>{Ae(J,`monster_attr ${t().attributes[0]??""} svelte-rccxcp`),g(m,`${ga[t().attributes[0]]??""}属性`)}),s(q,V)};x(me,q=>{t().attributes&&q(Ce)})}var F=r(me,2);{var D=q=>{var V=Bi(),J=a(V);y(()=>{Ae(V,`monster_cat ${t().types[0]??""} svelte-rccxcp`),g(J,`${oa[t().types[0]]??""}${ma[t().types[0]]??""}族`)}),s(q,V)};x(F,q=>{t().types&&q(D)})}var R=r(F,4),te=a(R),ie=r(R,2);{var $=q=>{var V=Ei(),J=r(L(V),2),ke=a(J);y(()=>g(ke,t().defense??"?")),s(q,V)};x(ie,q=>{var V;(V=t().monsterCategories)!=null&&V.includes("Link")||q($)})}var O=r(se,2);ne(O,5,()=>t().monsterCategories??[],ve,(q,V)=>{var J=Ai(),ke=a(J);y(()=>{Ae(J,`monster_cat ${e(V)??""} svelte-rccxcp`),g(ke,`${Zt[e(V)]??""}${sa[e(V)]??""}`)}),s(q,J)}),y(()=>g(te,t().attack??"?")),s(A,N)},Me=A=>{var N=je(),se=L(N);{var me=F=>{var D=Li(),R=r(a(D),2),te=a(R);y(()=>g(te,`${va[t().spellCategory]??""}魔法`)),s(F,D)},Ce=F=>{var D=je(),R=L(D);{var te=ie=>{var $=Ui(),O=r(a($),2),q=a(O);y(()=>g(q,`${da[t().trapCategory]??""}罠`)),s(ie,$)};x(R,ie=>{t().kind==="Trap"&&t().trapCategory&&ie(te)},!0)}s(F,D)};x(se,F=>{t().kind==="Spell"&&t().spellCategory?F(me):F(Ce,!1)},!0)}s(A,N)};x(de,A=>{t().kind==="Monster"?A(be):A(Me,!1)})}var ye=r(de,2),h=a(ye),T=a(h),K=a(T),re=r(ye,2);{var z=A=>{var N=Ni();s(A,N)};x(re,A=>{t().isOldVersion&&A(z)})}var ee=r(re,2);{var Te=A=>{var N=qi();s(A,N)},le=A=>{var N=Pi(),se=a(N),me=r(se,2),Ce=a(me);y(F=>{xt(se,"href",`https://yugioh-wiki.net/index.php?${t().wikiEncodedName}`),xt(me,"href",F),g(Ce,`⇒${(t().cardId?"公式カードページ":"公式で検索")??""}`)},[()=>_r(t())],fe),s(A,N)};x(ee,A=>{t().isForTest?A(Te):A(le,!1)})}y(A=>{Ae(E,`duel_card duel_card_info ${t().kind??""} ${A??""} svelte-rccxcp`),g(n,t().name),g(K,t().description)},[()=>{var A;return(A=t().monsterCategories)==null?void 0:A.join(" ")}],fe),oe("click",E,()=>d()(t())),s(o,E)};x(c,o=>{t()&&o(p)})}s(v,f),kt()}const Oi={0:{aaa:"日",aaaa:"日曜日",ddd:"Sun",dddd:"Sunday"},1:{aaa:"月",aaaa:"月曜日",ddd:"Mon",dddd:"Monday"},2:{aaa:"火",aaaa:"火曜日",ddd:"Tue",dddd:"Tuesday"},3:{aaa:"水",aaaa:"水曜日",ddd:"Wed",dddd:"Wednesday"},4:{aaa:"木",aaaa:"木曜日",ddd:"Thu",dddd:"Thursday"},5:{aaa:"金",aaaa:"金曜日",ddd:"Fri",dddd:"Friday"},6:{aaa:"土",aaaa:"土曜日",ddd:"Sat",dddd:"Saturday"}};class Ri{constructor(){ot(this,"DefaultSeparator1","/");ot(this,"DefaultSeparator2"," ");ot(this,"DefaultSeparator3",":");ot(this,"createDate",i=>{if(!i)return;const t=new Date(i);if(!isNaN(t.getTime()))return t});ot(this,"createDateOr",(i,t)=>this.createDate(i)||t||new Date);ot(this,"truncateDate",i=>{const t=i||new Date;return new Date(t.getFullYear(),t.getMonth(),t.getDate())});ot(this,"addDate",(i,t)=>{const d=this.createDateOr(i);return d.setDate(d.getDate()+t),d});ot(this,"addMonth",(i,t)=>{const d=this.createDateOr(i);return d.setMonth(d.getMonth()+t),d});ot(this,"addYear",(i,t)=>{const d=this.createDateOr(i);return d.setFullYear(d.getFullYear()+t),d});ot(this,"getDayOfWeek",(i,t="dddd")=>{const d=this.createDate(i);return d?Oi[d.getDay()][t]:""});ot(this,"formatToYYYYMMDD",(i,t=this.DefaultSeparator1)=>{const d=this.createDate(i);if(!d)return"";const f=d.getFullYear().toString(),c=("0"+(d.getMonth()+1)).slice(-2),p=("0"+d.getDate()).slice(-2);return f+t+c+t+p});ot(this,"formatToYYYYMM",(i,t=this.DefaultSeparator1)=>{const d=this.createDate(i);if(!d)return"";t||(t="");const f=d.getFullYear().toString(),c=("0"+(d.getMonth()+1)).slice(-2);return f+t+c});ot(this,"formatToHHMMSS",(i,t=this.DefaultSeparator3)=>{const d=this.createDate(i);if(!d)return"";t||(t="");const f=d.getHours(),c=d.getMinutes(),p=d.getSeconds();return("0"+f).slice(-2)+t+("0"+c).slice(-2)+t+("0"+p).slice(-2)});ot(this,"formatToHHMM",(i,t=this.DefaultSeparator3)=>{const d=this.createDate(i);if(!d)return"";t||(t="");const f=("0"+d.getHours()).slice(-2),c=("0"+d.getMinutes()).slice(-2);return f+t+c});ot(this,"formatToYYYYMMDD_HHMM",(i,t=this.DefaultSeparator1,d=this.DefaultSeparator2,f=this.DefaultSeparator3)=>{const c=this.createDate(i);return c?this.formatToYYYYMMDD(c,t)+d+this.formatToHHMM(c,f):""});ot(this,"formatToYYYYMMDD_HHMMSS",(i,t=this.DefaultSeparator1,d=this.DefaultSeparator2,f=this.DefaultSeparator3)=>{const c=this.createDate(i);return c?this.formatToYYYYMMDD(c,t)+d+this.formatToHHMMSS(c,f):""})}}const wt=new Ri;Date.prototype.truncateDate=function(){return wt.truncateDate(this)};Date.prototype.getCloneOr=function(v){return wt.createDateOr(this,v)};Date.prototype.addDate=function(v){return wt.addDate(this,v)};Date.prototype.addMonth=function(v){return wt.addDate(this,v)};Date.prototype.addYear=function(v){return wt.addDate(this,v)};Date.prototype.getDayOfWeek=function(v="dddd"){return wt.getDayOfWeek(this,v)};Date.prototype.formatToYYYYMM=function(v){return wt.formatToYYYYMM(this,v)};Date.prototype.formatToYYYYMMDD=function(v){return wt.formatToYYYYMMDD(this,v)};Date.prototype.formatToYYYYMMDD_HHMM=function(v,i,t){return wt.formatToYYYYMMDD_HHMM(this,v,i,t)};Date.prototype.formatToYYYYMMDD_HHMMSS=function(v,i,t){return wt.formatToYYYYMMDD_HHMMSS(this,v,i,t)};Date.prototype.formatToHHMM=function(v){return wt.formatToHHMM(this,v)};Date.prototype.formatToHHMMSS=function(v){return wt.formatToHHMMSS(this,v)};var Wi=l('<li class="deck_info_list_item svelte-2wdgc8"><div class="svelte-2wdgc8"> </div> <div class="svelte-2wdgc8"> </div> <div class="svelte-2wdgc8"> </div></li>'),Ii=l('<ul class="deck_info_list svelte-2wdgc8"></ul>'),Ki=l('<label for="file_selector" class="upload_area svelte-2wdgc8" role="region" aria-label="ファイルアップロードエリア"><div class="upload_area_message svelte-2wdgc8">ここにファイルをドロップ</div> <div class="upload_area_footer svelte-2wdgc8"><input type="file" id="file_selector" name="file_selector" accept=".json" multiple></div></label>'),zi=l('<div slot="body" class="modal_body svelte-2wdgc8"><!></div>'),Vi=l('<button class="svelte-2wdgc8">追加</button> <button class="svelte-2wdgc8">削除して追加</button> <button class="svelte-2wdgc8">戻る</button>',1),Gi=l('<button class="svelte-2wdgc8">Cancel</button>'),Xi=l('<div slot="footer" class="modal_window_footer svelte-2wdgc8"><!></div>');function Qi(v,i){ht(i,!1);let t=Ve(i,"eventHolder",8),d=Ve(i,"args",8),f=Ve(i,"resolve",8),c=ue(Promise.resolve([])),p=ue();const o=()=>{C(p,new DataTransfer().files),C(c,Promise.resolve([]))},E=async U=>{U.preventDefault(),console.log("hoge",U)},j=async U=>{U.preventDefault(),U.dataTransfer&&M(U.dataTransfer.files)},S=()=>{M(e(p))},M=async U=>{if(!U.length)return;const X=[],P=[];for(const B of U)try{P.push(...await Dt.createfromJson(B))}catch(Y){Y instanceof Error&&X.push(Y.message)}if(X.length){console.log(...X);return}C(c,e(c).then(()=>P))},n=o;bt(),ur(v,{get eventHolder(){return t()},get args(){return d()},$$slots:{body:(U,X)=>{var P=zi(),B=a(P);mt(B,()=>Jt,null,(Y,de)=>{var be=je(),Me=L(be);mt(Me,()=>e(c),null,(ye,h)=>{var T=je(),K=L(T);{var re=ee=>{var Te=Ii();ne(Te,5,()=>e(h),ve,(le,A)=>{var N=Wi(),se=a(N),me=a(se),Ce=r(se,2),F=a(Ce),D=r(Ce,2),R=a(D);y((te,ie,$)=>{g(me,e(A).name),g(F,`${te??""}
                  /
                  ${ie??""}`),g(R,`最終使用日時 ： ${$??""}`)},[()=>e(A).cardNames.filter(te=>{var ie,$;return!(($=(ie=e(de).getCardInfo(te))==null?void 0:ie.monsterCategories)!=null&&$.union(Vt).length)}).length,()=>e(A).cardNames.filter(te=>{var ie,$;return($=(ie=e(de).getCardInfo(te))==null?void 0:ie.monsterCategories)==null?void 0:$.union(Vt).length}).length,()=>e(A).lastUsedAt.formatToYYYYMMDD_HHMM("/"," ",":")],fe),s(le,N)}),s(ee,Te)},z=ee=>{var Te=Ki(),le=r(a(Te),2),A=a(le);fr(A,()=>e(p),N=>C(p,N)),oe("change",A,S),oe("cancel",A,n),oe("drop",Te,j),oe("dragover",Te,E),s(ee,Te)};x(K,ee=>{e(h).length?ee(re):ee(z,!1)})}s(ye,T)}),s(Y,be)}),s(U,P)},footer:(U,X)=>{var P=Xi(),B=a(P);mt(B,()=>e(c),null,(Y,de)=>{var be=je(),Me=L(be);{var ye=T=>{var K=Vi(),re=L(K),z=r(re,2),ee=r(z,2);y(()=>{re.disabled=e(de).length===0,z.disabled=e(de).length===0}),oe("click",re,()=>f()({deckInfos:e(de),replaceAll:!1})),oe("click",z,()=>f()({deckInfos:e(de),replaceAll:!0})),oe("click",ee,n),s(T,K)},h=T=>{var K=je(),re=L(K);{var z=ee=>{var Te=Gi();oe("click",Te,()=>f()(void 0)),s(ee,Te)};x(re,ee=>{d().cancelable&&ee(z)},!0)}s(T,K)};x(Me,T=>{e(de).length?T(ye):T(h,!1)})}s(Y,be)}),s(U,P)}}}),kt()}const la=class la extends yr{constructor(i,t){super(i,...Object.values(t))}};ot(la,"createModalController",i=>{const t={deckUploader:new gr({title:"デッキ情報をアップロード",position:"Middle",cancelable:!1})};return Object.assign(new la(i,t),t)});let ya=la;function Ji(v,i){ht(i,!1);let t=Ve(i,"modalController",8);bt(),pr(v,{get modalController(){return t()},children:(d,f)=>{var c=je(),p=L(c);{var o=E=>{Qi(E,{get eventHolder(){return t().eventHolder},get args(){return t().deckUploader.args},get resolve(){return t().deckUploader.resolve}})};x(p,E=>{t().deckUploader.state==="Shown"&&E(o)})}s(d,c)},$$slots:{default:!0}}),kt()}var Zi=l("<button> </button>"),en=l('<label class="svelte-n46fl7"><input type="checkbox" class="search_condition svelte-n46fl7"> </label>'),tn=l('<label class="svelte-n46fl7"><input type="checkbox" class="search_condition svelte-n46fl7"> </label>'),an=l('<div class="deck_editor_search_box_row monster_ex_categories svelte-n46fl7"><div class="svelte-n46fl7"><button class="search_condition_title black_button svelte-n46fl7">エクストラ</button></div> <div class="svelte-n46fl7"></div></div>'),rn=l('<label class="svelte-n46fl7"><input type="checkbox" class="search_condition svelte-n46fl7"> </label>'),sn=l('<label class="svelte-n46fl7"><input type="checkbox" class="search_condition svelte-n46fl7"> <div style="display: inline-block;"></div> </label>'),nn=l('<label class="svelte-n46fl7"><input type="checkbox" class="search_condition svelte-n46fl7"> </label>'),ln=l('<div class="deck_editor_search_box_row monster_categories svelte-n46fl7"><div class="svelte-n46fl7"><button class="search_condition_title black_button svelte-n46fl7">モンスター</button></div> <div class="svelte-n46fl7"></div></div> <div class="deck_editor_search_box_row monster_attributes svelte-n46fl7"><div class="svelte-n46fl7"><button class="search_condition_title black_button svelte-n46fl7">属性</button></div> <div class="svelte-n46fl7"></div></div> <div class="deck_editor_search_box_row svelte-n46fl7"><div class="svelte-n46fl7"><button class="search_condition_title black_button svelte-n46fl7">種族</button></div> <div class="svelte-n46fl7"></div></div> <div class="deck_editor_search_box_row svelte-n46fl7"><div class="svelte-n46fl7"><button class="search_condition_title black_button svelte-n46fl7">星攻守</button></div> <div class="svelte-n46fl7"><div class="star_range svelte-n46fl7"><span class="svelte-n46fl7">星</span> <input type="number" min="0" max="13" class="svelte-n46fl7"> <span class="svelte-n46fl7">～</span> <input type="number" min="0" max="13" class="svelte-n46fl7"></div> <div class="atk_range svelte-n46fl7"><span class="svelte-n46fl7">攻</span> <input type="number" min="0" max="5000" step="100" class="svelte-n46fl7"> <span class="svelte-n46fl7">～</span> <input type="number" min="0" max="5000" step="100" class="svelte-n46fl7"></div> <div class="def_range svelte-n46fl7"><span class="svelte-n46fl7">守</span> <input type="number" min="0" max="5000" step="100" class="svelte-n46fl7"> <span class="svelte-n46fl7">～</span> <input type="number" min="0" max="5000" step="100" class="svelte-n46fl7"></div> <div class="atk_plus_def svelte-n46fl7"><span class="svelte-n46fl7">攻+守</span> <input type="number" min="0" max="10000" step="100" class="svelte-n46fl7"></div></div></div>',1),on=l('<label class="svelte-n46fl7"><input type="checkbox" class="search_condition svelte-n46fl7"> </label>'),vn=l('<div class="deck_editor_search_box_row svelte-n46fl7"><div class="svelte-n46fl7"><button class="search_condition_title black_button svelte-n46fl7">魔法</button></div> <div class="svelte-n46fl7"></div></div>'),dn=l('<label class="svelte-n46fl7"><input type="checkbox" class="search_condition svelte-n46fl7"> </label>'),cn=l('<div class="deck_editor_search_box_row svelte-n46fl7"><div class="svelte-n46fl7"><button class="search_condition_title black_button svelte-n46fl7">罠</button></div> <div class="svelte-n46fl7"></div></div>'),_n=l('<label class="svelte-n46fl7"><input type="checkbox" class="search_condition svelte-n46fl7"> </label>'),un=l("<div>カード情報読込中</div>"),fn=l("<option> </option>"),pn=l('<div class="svelte-n46fl7"><a class="white_button svelte-n46fl7" download="SVS_DeckInfos.json">ダウンロード</a></div>'),yn=l('<div class="svelte-n46fl7"></div>'),gn=l('<div class="svelte-n46fl7"><a class="white_button svelte-n46fl7" download="SVS_DeckInfos.json">ダウンロード(一括)</a></div>'),mn=l('<div class="svelte-n46fl7"></div>'),hn=l('<div class="deck_editor_body_right_header svelte-n46fl7"><div class="deck_editor_body_right_header_row svelte-n46fl7"><div class="svelte-n46fl7">編集対象</div> <div class="svelte-n46fl7"><select style="width:100%" class="svelte-n46fl7"></select></div></div> <div class="deck_editor_body_right_header_row svelte-n46fl7"><div class="svelte-n46fl7">新規名称</div> <div class="svelte-n46fl7"><input type="text" style="width:100%" class="svelte-n46fl7"></div></div> <div class="deck_editor_body_right_header_row svelte-n46fl7"></div> <div class="deck_editor_body_right_header_row svelte-n46fl7"><div class="svelte-n46fl7">基本操作</div> <div class="svelte-n46fl7"><button class="white_button svelte-n46fl7">デッキを保存</button></div> <div class="svelte-n46fl7"><button class="white_button svelte-n46fl7">デッキを複製</button></div> <div class="svelte-n46fl7"><button class="white_button svelte-n46fl7" title="shiftキー押下で確認メッセージスキップ">デッキを削除</button></div></div> <div class="deck_editor_body_right_header_row svelte-n46fl7"><div class="svelte-n46fl7">DL/UL</div> <!> <!> <div class="svelte-n46fl7"><button class="white_button svelte-n46fl7">アップロード</button></div></div></div> <!>',1),bn=l('<div class="svelte-n46fl7">デッキ情報読込中</div>'),kn=l('<div class="svelte-n46fl7"></div>'),xn=l('<div><div class="deck_editor_header svelte-n46fl7"></div> <div class="deck_editor_body svelte-n46fl7"><div class="deck_editor_body_left svelte-n46fl7"><div role="contentinfo" class="deck_editor_search_box svelte-n46fl7"><div class="deck_editor_search_box_header svelte-n46fl7"><div class="svelte-n46fl7"><button class="deck_editor_search_box_title svelte-n46fl7">検索条件</button></div> <div class="deck_editor_sort_setting_container svelte-n46fl7"></div></div> <div class="deck_editor_search_box_body svelte-n46fl7"><div class="deck_editor_search_box_row svelte-n46fl7"><div class="svelte-n46fl7"><button class="search_condition_title black_button svelte-n46fl7">名称</button></div> <div class="svelte-n46fl7"><input type="text" style="width:100%" placeholder="※ルビには対応していません" class="svelte-n46fl7"></div></div> <div class="deck_editor_search_box_row card_kind svelte-n46fl7"><div class="svelte-n46fl7"><button class="search_condition_title black_button svelte-n46fl7">種類</button></div> <div class="svelte-n46fl7"></div></div> <!> <!> <!> <!> <div class="deck_editor_search_box_row svelte-n46fl7"><div class="svelte-n46fl7"><button class="search_condition_title black_button svelte-n46fl7">その他</button></div> <div class="svelte-n46fl7"></div></div></div></div> <!></div> <div class="deck_editor_body_center svelte-n46fl7"><!></div>  <div class="deck_editor_body_right svelte-n46fl7"><!></div></div> <div class="footer svelte-n46fl7"></div></div> <!>',1);function wn(v,i){ht(i,!1);const t=[],d=[],f=[],c=[],p=[],o=[],E=[],j=[],S=ya.createModalController({onDragStart:{append:()=>{},remove:()=>{}},onDragEnd:{append:()=>{},remove:()=>{}}}),M={name:"",deckCardKinds:[...zt],exMonsterCategories:[...Vt],monsterCategories:Aa.filter(w=>!Vt.includes(w)),monsterAttributes:[...Ea],monsterTypes:[...Ba],spellCategories:ja.filter(w=>w!=="PendulumScale"),trapCategories:[...Ta],starLowerBound:0,starUpperBound:13,atkLowerBound:0,atkUpperBound:5e3,defLowerBound:0,defUpperBound:5e3,atkPlusDef:void 0,others:["test","oldVersion","implemented"],sort:[...Ya]},n=ue(structuredClone(M));he(n,e(n).others=["oldVersion"]),he(n,e(n).monsterCategories=e(n).monsterCategories.filter(w=>w!=="Normal"));let U=ue("DeckEdit"),X=ue("SearchCondition");const P=()=>{if(!e(n).deckCardKinds.length){Ht(e(n)).forEach(w=>{Array.isArray(e(n)[w])&&Array.isArray(M[w])?he(n,e(n)[w]=[...M[w]]):he(n,e(n)[w]=M[w])});return}he(n,e(n).name=""),he(n,e(n).deckCardKinds=[]),he(n,e(n).exMonsterCategories=[]),he(n,e(n).monsterCategories=[]),he(n,e(n).monsterAttributes=[]),he(n,e(n).monsterTypes=[]),he(n,e(n).spellCategories=[]),he(n,e(n).trapCategories=[]),he(n,e(n).others=[]),he(n,e(n).atkLowerBound=0),he(n,e(n).atkUpperBound=5e3),he(n,e(n).defLowerBound=0),he(n,e(n).defUpperBound=5e3),he(n,e(n).atkPlusDef=void 0),he(n,e(n).sort=[...Ya])},B=w=>{w.forEach(k=>{Array.isArray(e(n)[k])&&Array.isArray(M[k])?he(n,e(n)[k]=e(n)[k].length?[]:[...M[k]]):he(n,e(n)[k]=M[k])})},Y=(w,k,ae)=>{Array.isArray(e(n)[k])&&Array.isArray(M[k])&&he(n,e(n)[k]=[ae])},de=async()=>{const k=(await e(ye)).find(ge=>ge.id===e(Me));if(!k)return;const ae=await Jt;C(K,{...k,cardTree:mi(k.cardNames.map(ge=>{const He=ae.getCardInfo(ge);return He===void 0&&console.error(ge),He}).filter(ge=>ge!==void 0))})},be=()=>Dt.getAllDeckInfo().then(w=>(C(Me,(w.find(k=>k.lastUsedAt.getTime()===Math.max(...w.map(ae=>ae.lastUsedAt.getTime())))??w[0]).id),w));let Me=ue(-1),ye=ue(be()),h=ue(e(ye).then(w=>Dt.convertToObjectURL(w)));e(ye).then(de);const T=()=>{C(ye,be()),C(h,e(ye).then(w=>Dt.convertToObjectURL(w))),de()};let K=ue({id:-Number.MAX_VALUE,name:"",description:"",lastUsedAt:new Date,cardTree:{ExtraMonster:[],Monster:[],Spell:[],Trap:[]}}),re=ue(void 0),z=0;const ee=w=>{C(X,"CardDetail"),w.cardId!==void 0&&!w.description&&!w.pendulumDescription&&(z=w.cardId,Ra([w.cardId]).then(()=>{w.cardId===z&&C(re,w)})),C(re,w)},Te=async()=>{const k=(await e(ye)).find(ae=>ae.id===e(Me));if(!k)throw new Error("illegal state");return k},le=async()=>{const w=await Te();await w.saveDeckInfo({...w,name:e(K).name,cardNames:Object.values(e(K).cardTree).flatMap(k=>k).map(k=>k.name),lastUsedAt:new Date}),T()},A=async()=>{(await Dt.createNewDeck(`デッキ_${new Date().formatToYYYYMMDD_HHMMSS("","","")}`,`コピー日時：${new Date().formatToYYYYMMDD_HHMMSS("-"," ",":")}`,Object.values(e(K).cardTree).flatMap(k=>k).map(k=>k.name))).saveDeckInfo(),T()},N=async w=>{const k=await Te();!w.shiftKey&&!confirm(`デッキ【${k.name}】を削除します。
よろしいですか？`)||(await k.delete(),T())},se=async()=>{const w=await S.deckUploader.show({title:"デッキ情報アップロード",position:"Middle",cancelable:!0});if(!w)return;const k=[];if(w.replaceAll){if(!confirm(`既存デッキ情報を全て削除し、アップロードしたファイルに置き換えます。
よろしいですか？`))return;k.push(...(await e(ye)).map(ae=>ae.id))}await Promise.all(w.deckInfos.map(ae=>Dt.createNewDeck(ae.name,ae.description,ae.cardNames,ae.lastUsedAt))),k.length&&await Promise.all(k.map(Dt.remove)),T()},me=()=>innerWidth<=1400?"compact":"wide";bt();var Ce=xn(),F=L(Ce),D=r(a(F),2),R=a(D),te=a(R),ie=a(te),$=a(ie),O=a($),q=r($,2);ne(q,5,()=>e(n).sort,ve,(w,k,ae)=>{var ge=Zi(),He=a(ge);y(()=>{Ae(ge,`deck_editor_sort_setting_item ${e(k).order??""} priority_${e(k).priority??""} svelte-n46fl7`),g(He,`${mr[e(k).key]??""}
                ${(e(k).order==="asc"?"▲":"▼")??""}`)}),oe("click",ge,()=>{e(n).sort.forEach(Ge=>Ge.priority++),e(k).order=e(k).order==="asc"?"desc":"asc",Ut(()=>e(n).sort),e(k).priority=1,Ut(()=>e(n).sort)}),s(w,ge)});var V=r(ie,2),J=a(V),ke=a(J),m=a(ke),_=r(ke,2),u=a(_),b=r(J,2),H=a(b),W=a(H),De=r(H,2);ne(De,5,()=>zt,ve,(w,k)=>{var ae=en(),ge=a(ae),He,Ge=r(ge);y(()=>{He!==(He=e(k))&&(ge.value=(ge.__value=e(k))==null?"":e(k)),g(Ge,` ${Wa[e(k)]??""}`)}),Lt(t,[],ge,()=>(e(k),e(n).deckCardKinds),Ne=>he(n,e(n).deckCardKinds=Ne)),s(w,ae)});var xe=r(b,2);{var ce=w=>{var k=an(),ae=a(k),ge=a(ae),He=r(ae,2);ne(He,5,()=>Vt,ve,(Ge,Ne)=>{var Ee=tn(),Be=a(Ee),Fe,dt=r(Be);y(()=>{Fe!==(Fe=e(Ne))&&(Be.value=(Be.__value=e(Ne))==null?"":e(Ne)),g(dt,` ${Zt[e(Ne)]??""}${sa[e(Ne)]??""}`)}),Lt(d,[],Be,()=>(e(Ne),e(n).exMonsterCategories),ft=>he(n,e(n).exMonsterCategories=ft)),s(Ge,Ee)}),oe("click",ge,()=>B(["exMonsterCategories"])),Z(3,k,()=>pe,()=>({delay:0,duration:100})),s(w,k)};x(xe,w=>{e(n).deckCardKinds.includes("ExtraMonster")&&w(ce)})}var Q=r(xe,2);{var G=w=>{var k=ln(),ae=L(k),ge=a(ae),He=a(ge),Ge=r(ge,2);ne(Ge,5,()=>Aa.filter(Le=>!Vt.includes(Le)),ve,(Le,Ke)=>{var yt=rn(),vt=a(yt),Ct,lt=r(vt);y(()=>{Ct!==(Ct=e(Ke))&&(vt.value=(vt.__value=e(Ke))==null?"":e(Ke)),g(lt,` ${Zt[e(Ke)]??""}${sa[e(Ke)]??""}`)}),Lt(f,[],vt,()=>(e(Ke),e(n).monsterCategories),Qe=>he(n,e(n).monsterCategories=Qe)),s(Le,yt)});var Ne=r(ae,2),Ee=a(Ne),Be=a(Ee),Fe=r(Ee,2);ne(Fe,5,()=>Ea,ve,(Le,Ke)=>{var yt=sn(),vt=a(yt),Ct,lt=r(vt,2),Qe=r(lt);y(()=>{Ct!==(Ct=e(Ke))&&(vt.value=(vt.__value=e(Ke))==null?"":e(Ke)),Ae(lt,`monster_attr ${e(Ke)??""} svelte-n46fl7`),g(Qe,` ${ga[e(Ke)]??""}`)}),Lt(c,[],vt,()=>(e(Ke),e(n).monsterAttributes),ut=>he(n,e(n).monsterAttributes=ut)),s(Le,yt)});var dt=r(Ne,2),ft=a(dt),Et=a(ft),At=r(ft,2);ne(At,5,()=>Ba,ve,(Le,Ke)=>{var yt=nn(),vt=a(yt),Ct,lt=r(vt);y(()=>{Ct!==(Ct=e(Ke))&&(vt.value=(vt.__value=e(Ke))==null?"":e(Ke)),g(lt,` ${oa[e(Ke)]??""}
                    ${ma[e(Ke)]??""}`)}),Lt(p,[],vt,()=>(e(Ke),e(n).monsterTypes),Qe=>he(n,e(n).monsterTypes=Qe)),oe("dblclick",yt,Qe=>Y(Qe,"monsterTypes",e(Ke))),s(Le,yt)});var Yt=r(dt,2),Rt=a(Yt),rt=a(Rt),et=r(Rt,2),nt=a(et),st=r(a(nt),2),_t=r(st,4),pt=r(nt,2),ct=r(a(pt),2),$t=r(ct,4),Mt=r(pt,2),Tt=r(a(Mt),2),Je=r(Tt,4),tt=r(Mt,2),at=r(a(tt),2);oe("click",He,()=>B(["monsterCategories"])),Z(3,ae,()=>pe,()=>({delay:0,duration:100})),oe("click",Be,()=>B(["monsterAttributes"])),Z(3,Ne,()=>pe,()=>({delay:0,duration:100})),oe("click",Et,()=>B(["monsterTypes"])),Z(3,dt,()=>pe,()=>({delay:0,duration:100})),oe("click",rt,()=>B(["starLowerBound","starUpperBound","atkLowerBound","atkUpperBound","defLowerBound","defUpperBound","atkPlusDef"])),St(st,()=>e(n).starLowerBound,Le=>he(n,e(n).starLowerBound=Le)),St(_t,()=>e(n).starUpperBound,Le=>he(n,e(n).starUpperBound=Le)),St(ct,()=>e(n).atkLowerBound,Le=>he(n,e(n).atkLowerBound=Le)),St($t,()=>e(n).atkUpperBound,Le=>he(n,e(n).atkUpperBound=Le)),St(Tt,()=>e(n).defLowerBound,Le=>he(n,e(n).defLowerBound=Le)),St(Je,()=>e(n).defUpperBound,Le=>he(n,e(n).defUpperBound=Le)),St(at,()=>e(n).atkPlusDef,Le=>he(n,e(n).atkPlusDef=Le)),Z(3,Yt,()=>pe,()=>({delay:0,duration:100})),s(w,k)};x(Q,w=>{(e(n).deckCardKinds.includes("Monster")||e(n).deckCardKinds.includes("ExtraMonster"))&&w(G)})}var I=r(Q,2);{var $e=w=>{var k=vn(),ae=a(k),ge=a(ae),He=r(ae,2);ne(He,5,()=>ja.filter(Ge=>Ge!=="PendulumScale"),ve,(Ge,Ne)=>{var Ee=on(),Be=a(Ee),Fe,dt=r(Be);y(()=>{Fe!==(Fe=e(Ne))&&(Be.value=(Be.__value=e(Ne))==null?"":e(Ne)),g(dt,` ${va[e(Ne)]??""}`)}),Lt(o,[],Be,()=>(e(Ne),e(n).spellCategories),ft=>he(n,e(n).spellCategories=ft)),s(Ge,Ee)}),oe("click",ge,()=>B(["spellCategories"])),Z(3,k,()=>pe,()=>({delay:0,duration:100})),s(w,k)};x(I,w=>{e(n).deckCardKinds.includes("Spell")&&w($e)})}var Oe=r(I,2);{var We=w=>{var k=cn(),ae=a(k),ge=a(ae),He=r(ae,2);ne(He,5,()=>Ta,ve,(Ge,Ne)=>{var Ee=dn(),Be=a(Ee),Fe,dt=r(Be);y(()=>{Fe!==(Fe=e(Ne))&&(Be.value=(Be.__value=e(Ne))==null?"":e(Ne)),g(dt,` ${da[e(Ne)]??""}`)}),Lt(E,[],Be,()=>(e(Ne),e(n).trapCategories),ft=>he(n,e(n).trapCategories=ft)),s(Ge,Ee)}),oe("click",ge,()=>B(["trapCategories"])),Z(3,k,()=>pe,()=>({delay:0,duration:100})),s(w,k)};x(Oe,w=>{e(n).deckCardKinds.includes("Trap")&&w(We)})}var Re=r(Oe,2),Ue=a(Re),Xe=a(Ue),qe=r(Ue,2);ne(qe,4,()=>[{key:"test",text:"テスト用カード"},{key:"oldVersion",text:"エラッタ前カード"},{key:"implemented",text:"未実装カード"}],ve,(w,k)=>{var ae=_n(),ge=a(ae),He,Ge=r(ge);y(()=>{He!==(He=k.key)&&(ge.value=(ge.__value=k.key)==null?"":k.key),g(Ge,` ${k.text??""}`)}),Lt(j,[],ge,()=>(k.key,e(n).others),Ne=>he(n,e(n).others=Ne)),s(w,ae)});var we=r(te,2);Hi(we,{get cardInfo(){return e(re)},onAttention:ee});var Se=r(R,2),Pe=a(Se);mt(Pe,()=>Jt,w=>{var k=un();s(w,k)},(w,k)=>{const ae=fe(()=>Object.values(e(k).dic));Ha(w,{mode:"List",get allCardInfos(){return e(ae)},onAttention:ee,get searchCondition(){return e(n)},get deckCardTree(){return e(K).cardTree},set deckCardTree(ge){he(K,e(K).cardTree=ge)},$$legacy:!0})});var Ie=r(Se,2),ze=a(Ie);{var Ze=w=>{var k=je(),ae=L(k);mt(ae,()=>e(ye),ge=>{var He=bn();s(ge,He)},(ge,He)=>{var Ge=hn(),Ne=L(Ge),Ee=a(Ne),Be=r(a(Ee),2),Fe=a(Be);y(()=>{e(Me),Ut(()=>{e(He)})}),ne(Fe,5,()=>e(He),ve,(Je,tt)=>{var at=fn(),Le={},Ke=a(at);y(()=>{Le!==(Le=e(tt).id)&&(at.value=(at.__value=e(tt).id)==null?"":e(tt).id),g(Ke,e(tt).name)}),s(Je,at)});var dt=r(Ee,2),ft=r(a(dt),2),Et=a(ft),At=r(dt,4),Yt=r(a(At),2),Rt=a(Yt),rt=r(Yt,2),et=a(rt),nt=r(rt,2),st=a(nt),_t=r(At,2),pt=r(a(_t),2);mt(pt,Te,Je=>{var tt=yn();s(Je,tt)},(Je,tt)=>{var at=pn(),Le=a(at);y(Ke=>xt(Le,"href",Ke),[()=>Dt.convertToObjectURL([e(tt)])],fe),s(Je,at)});var ct=r(pt,2);mt(ct,()=>e(h),Je=>{var tt=mn();s(Je,tt)},(Je,tt)=>{var at=gn(),Le=a(at);y(()=>xt(Le,"href",e(tt))),s(Je,at)});var $t=r(ct,2),Mt=a($t),Tt=r(Ne,2);Ha(Tt,{mode:"Deck",allCardInfos:[],onAttention:ee,get deckCardTree(){return e(K).cardTree},set deckCardTree(Je){he(K,e(K).cardTree=Je)},$$legacy:!0}),Kt(Fe,()=>e(Me),Je=>C(Me,Je)),oe("change",Fe,de),St(Et,()=>e(K).name,Je=>he(K,e(K).name=Je)),oe("click",Rt,le),oe("click",et,A),oe("click",st,N),oe("click",Mt,se),s(ge,Ge)}),s(w,k)},_e=w=>{var k=kn();s(w,k)};x(ze,w=>{e(U)==="DeckEdit"||me()==="wide"?w(Ze):w(_e,!1)})}var Ye=r(F,2);Ji(Ye,{modalController:S}),y((w,k,ae)=>Ae(F,`deck_editor screen_size_${w??""} left_pain_mode_${k??""} main_view_mode_${ae??""} svelte-n46fl7`),[me,()=>e(X).toLowerCase(),()=>e(U).toLowerCase()],fe),oe("click",O,P),oe("click",m,()=>B(["name"])),St(u,()=>e(n).name,w=>he(n,e(n).name=w)),oe("click",W,()=>B(["deckCardKinds"])),oe("click",Xe,()=>B(["others"])),Z(3,Re,()=>pe,()=>({delay:0,duration:100})),oe("focusin",te,()=>{C(X,"SearchCondition"),C(U,"SearchCondition")}),oe("click",te,()=>{C(X,"SearchCondition"),C(U,"SearchCondition")}),oe("click",Ie,()=>{C(U,"DeckEdit")}),oe("focusin",Ie,()=>{C(U,"DeckEdit")}),s(v,Ce),kt()}const Cn=["TblDeckHeader","TblDeckDetail","TblDuelistProfile"],Dn=3;var $n=l('<input class="game_mode_radio svelte-sy4ydn" type="radio" name="game_mode"> <label> </label>',1),Sn=l('<option class="svelte-sy4ydn"> </option>'),Mn=l('<option class="svelte-sy4ydn"> </option>'),Tn=l('<option class="svelte-sy4ydn"> </option>'),jn=l('<tr class="config_row svelte-sy4ydn"><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><label for="npc_deck_selector" class="config_row_label deck_selector svelte-sy4ydn">デッキ：</label></div></td><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><select id="npc_deck_selector" class="deck_selector svelte-sy4ydn"><option class="svelte-sy4ydn">デフォルト</option><!></select></div></td></tr>'),Bn=l('<option class="svelte-sy4ydn"> </option>'),En=l('<tr class="config_row svelte-sy4ydn"><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><label for="npc_selector" class="config_row_label npc_selector svelte-sy4ydn">対戦相手：</label></div></td><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><select id="npc_selector" class="npc_selector svelte-sy4ydn"></select> <div class="svelte-sy4ydn"> </div></div></td></tr> <!> <tr class="config_row svelte-sy4ydn"><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><label for="npc_selector" class="config_row_label npc_selector svelte-sy4ydn">先攻後攻：</label></div></td><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><select id="npc_selector" class="npc_selector svelte-sy4ydn"></select></div></td></tr>',1),An=l('<option class="svelte-sy4ydn"> </option>'),Yn=l('<tr class="config_row svelte-sy4ydn"><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><label for="difficulty_selector" class="config_row_label difficulty_selector svelte-sy4ydn">難易度：</label></div></td><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><select id="difficulty_selector" class="difficulty_selector svelte-sy4ydn"></select></div></td></tr>'),Ln=l('<tr class="config_row svelte-sy4ydn"><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><label class="config_row_label svelte-sy4ydn" for="game_mode_radio_preset">ゲームモード：</label></div></td><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"></div></td></tr> <tr class="config_row svelte-sy4ydn"><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><label for="deck_selector" class="config_row_label deck_selector svelte-sy4ydn">デッキ：</label></div></td><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><select id="deck_selector" class="deck_selector svelte-sy4ydn"></select></div></td></tr> <!> <tr><td colspan="2" class="svelte-sy4ydn"><div><button class="btn svelte-sy4ydn">duel start!</button></div></td></tr>',1),Un=l('<tr><td colspan="2" class="svelte-sy4ydn"><div>デッキ情報の読み込み、もしくは作成中...</div></td></tr>'),Nn=l('<tr><td colspan="2" class="svelte-sy4ydn"><div><button class="btn svelte-sy4ydn">deck edit</button></div></td></tr>'),qn=l('<tr class="config_row svelte-sy4ydn"><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><label for="duelist_name" class="config_row_label duelist_name svelte-sy4ydn">名前：</label></div></td><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><input id="duelist_name" class="duelist_name svelte-sy4ydn" type="text"></div></td></tr> <!> <!>',1),Pn=l('<tr><td colspan="2" class="svelte-sy4ydn"><div>デュエリスト情報の読み込み、もしくは作成中...</div></td></tr>'),Fn=l('<div class="app_body svelte-sy4ydn"><table class="config_table svelte-sy4ydn"><tbody><!></tbody></table></div>'),Hn=l('<span class="svelte-sy4ydn"> </span> <span class="svelte-sy4ydn"> </span>',1),On=l('<div class="result_title result_win svelte-sy4ydn">YOU WIN</div>'),Rn=l('<div class="result_title result_lose svelte-sy4ydn">YOU LOSE</div>'),Wn=l('<div class="result_title result_draw svelte-sy4ydn">DRAW</div>'),In=l('<div class="twitter_share_button_wrapper svelte-sy4ydn"><a rel="nofollow" target="_blank" class="twitter_share_button svelte-sy4ydn">X(twitter)でシェアする</a></div>'),Kn=l('<div class="result svelte-sy4ydn"><!> <div class="reason_of_end svelte-sy4ydn"> </div> <!> <div class="svelte-sy4ydn"><button class="white_button svelte-sy4ydn">TOPへ戻る</button></div></div>'),zn=l('<main style="flex-direction: column; display :flex" class="svelte-sy4ydn"><div class="link link_left svelte-sy4ydn"><a href="https://github.com/Setta238/stk_ygo_svelte" target="_blank" rel="noopener noreferrer" title="repository" class="svelte-sy4ydn">repository</a> <a href="https://x.com/ninja_no" target="_blank" rel="noopener noreferrer" title="repository" class="svelte-sy4ydn">X(Twitter)</a> <a href="https://posfie.com/@ninja_no/p/Lx7FLj3" target="_blank" rel="noopener noreferrer" title="posfie" class="svelte-sy4ydn">posfie(toggeter)</a></div> <div class="link link_right svelte-sy4ydn"><a class="a_button svelte-sy4ydn" role="button" tabindex="0">TOPへ戻る</a> <a href="/stk_ygo_svelte/note.html" target="_blank" rel="noopener noreferrer" title="repository" class="svelte-sy4ydn">現時点とこの先のこと</a></div> <!> <div class="footer card_summary svelte-sy4ydn"><!></div> <div class="footer debug_info svelte-sy4ydn"><span class="svelte-sy4ydn"> </span> <span class="user_agent_info svelte-sy4ydn"> </span> <span class="screen_info svelte-sy4ydn"> </span></div> <!></main>');function Vn(v,i){ht(i,!1);const t=new hr("stk_ygo_svelte",Dn,Cn);let d=ue(0),f=ue(0),c=ue(),p=ue("FtkChallenge"),o=ue("None"),E=ue(0),j=ue(""),S=ue(void 0);const M="https://setta238.github.io/stk_ygo_svelte/",n="遊戯王deそりてあ",U="ninja_no",X=br.getOrCreateNew(t).then(m=>(C(p,La.includes(m.previousGameMode)?m.previousGameMode:"FtkChallenge"),Te(m.previousNpcId),m)),P=m=>{var u;const _=m.find(b=>b.lastUsedAt.getTime()===Math.max(...m.map(H=>H.lastUsedAt.getTime())))??m[0];C(E,_.id),e(p)==="FtkChallenge"&&_.deckType!=="Preset"&&C(E,((u=Pt.find(b=>b.deckType==="Preset"))==null?void 0:u.id)??e(E))};let B=ue(Dt.getAllDeckInfo(t).then(m=>(Promise.all(m.filter(_=>!_.lastUsedAt).map(_=>{_.saveDeckInfo()})),P(m),m)));const Y=async()=>{const m=e(E);let _=(await e(B)).find(b=>b.id===m)??(await be()).find(b=>b.id===m);_&&await _.updateTimestamp();let u=_;if(u||(u=Pt.find(b=>b.id===m)),!u)throw new Error("illegal state");return u},de=async()=>{(await X).save({previousGameMode:e(p)})},be=()=>(C(B,Dt.getAllDeckInfo(t).then(m=>(P(m),m))),e(B)),Me=async()=>{(await e(B)).length||(await Dt.prepareSampleDeck(),be())},ye=async()=>{await Promise.all([de(),Me()]);const m=await Y(),_=await X;let u=It.find(W=>W.id===Number.MIN_SAFE_INTEGER)??It[0],b=Pt.find(W=>W.id===Number.MIN_SAFE_INTEGER)??Pt[0],H="PlayFirst";e(p)==="FtkChallenge"?u=It.filter(W=>W.npcType==="FtkChallenge").find(W=>W.difficulty===_.previousDifficulty)??u:e(p)==="Free"&&(u=It.find(W=>W.id===_.previousNpcId)??u,b=Pt.slice(-1)[0],H=_.previousStartMode),u.npcType!=="FtkChallenge"&&_.previousNpcDeckId>-1?b=(await e(B)).find(W=>W.id===_.previousNpcDeckId)??b:b=Pt.find(W=>W.id===u.id)??b,C(c,new Cr(_,"Player",m,[],u,"NPC",b,[],H)),e(c).onDuelEnd.append(()=>(C(c,e(c)),"RemoveMe"))},h=async()=>{await Promise.all([de(),Me()]),C(o,"DeckEdit")},T=async m=>{await de(),m.key==="Enter"&&!m.repeat&&(await X).save()},K=()=>{C(B,be()),C(c,void 0),C(o,"None")};let re=Date.now();const z=m=>{Date.now()-re<200||(re=Date.now(),C(p,m),be())},ee=m=>{Te(Number(m.currentTarget.value))},Te=m=>{var _;C(S,It.find(u=>u.id===m)),C(j,((_=e(S))==null?void 0:_.description)??"")};Me(),bt();var le=zn(),A=r(a(le),2),N=a(A),se=r(A,2);{var me=m=>{var _=je(),u=L(_);mt(u,()=>X,null,(b,H)=>{gi(b,{get duel(){return e(c)},get userProfile(){return e(H)}})}),s(m,_)},Ce=m=>{var _=je(),u=L(_);{var b=W=>{wn(W,{})},H=W=>{var De=Fn(),xe=a(De),ce=a(xe),Q=a(ce);mt(Q,()=>X,G=>{var I=Pn();s(G,I)},(G,I)=>{var $e=qn(),Oe=L($e),We=a(Oe),Re=a(We),Ue=r(We),Xe=a(Ue),qe=a(Xe),we=r(Oe,2);mt(we,()=>e(B),Ie=>{var ze=Un();s(Ie,ze)},(Ie,ze)=>{var Ze=Ln(),_e=L(Ze),Ye=a(_e),w=a(Ye),k=r(Ye),ae=a(k);ne(ae,5,()=>La,ve,(rt,et)=>{var nt=$n(),st=L(nt),_t=r(st,2),pt=a(_t);y(ct=>{xt(st,"id",`game_mode_radio_${ct??""}`),xr(st,e(et)),wr(st,e(p)===e(et)),Ae(_t,`game_mode_tab_label game_mode_tab_${ct??""} svelte-sy4ydn`),xt(_t,"for",`game_mode_radio_${ct??""}`),g(pt,e(et))},[()=>e(et).toLowerCase()],fe),oe("change",st,()=>z(e(et))),s(rt,nt)});var ge=r(_e,2),He=a(ge),Ge=a(He),Ne=r(He),Ee=a(Ne),Be=a(Ee);y(()=>{e(E),Ut(()=>{e(p),e(ze)})}),ne(Be,5,()=>e(p)==="FtkChallenge"?Pt.filter(rt=>rt.deckType==="Preset"):e(ze),ve,(rt,et)=>{var nt=Sn(),st={},_t=a(nt);y(()=>{st!==(st=e(et).id)&&(nt.value=(nt.__value=e(et).id)==null?"":e(et).id),g(_t,e(et).name)}),s(rt,nt)});var Fe=r(ge,2);{var dt=rt=>{var et=En(),nt=L(et),st=a(nt),_t=a(st),pt=r(st),ct=a(pt),$t=a(ct);y(()=>{e(I),Ut(()=>{})}),ne($t,5,()=>It,ve,(lt,Qe)=>{var ut=Mn(),qt={},Wt=a(ut);y(()=>{qt!==(qt=e(Qe).id)&&(ut.value=(ut.__value=e(Qe).id)==null?"":e(Qe).id),g(Wt,e(Qe).name)}),s(lt,ut)});var Mt=r($t,2),Tt=a(Mt),Je=r(nt,2);{var tt=lt=>{var Qe=jn(),ut=a(Qe),qt=a(ut),Wt=r(ut),ka=a(Wt),xa=a(ka);y(()=>{e(I),Ut(()=>{e(ze)})});var ca=a(xa);ca.value=(ca.__value=Number.MIN_SAFE_INTEGER)==null?"":Number.MIN_SAFE_INTEGER;var Ia=r(ca);ne(Ia,1,()=>e(ze),ve,(_a,ta)=>{var aa=Tn(),wa={},Ka=a(aa);y(()=>{wa!==(wa=e(ta).id)&&(aa.value=(aa.__value=e(ta).id)==null?"":e(ta).id),g(Ka,e(ta).name)}),s(_a,aa)}),Z(3,qt,()=>pe,()=>({duration:200})),Z(3,ut,()=>pe,()=>({duration:200})),Kt(xa,()=>e(I).previousNpcDeckId,_a=>e(I).previousNpcDeckId=_a),Z(3,ka,()=>pe,()=>({duration:200})),Z(3,Wt,()=>pe,()=>({duration:200})),Z(3,Qe,()=>pe,()=>({duration:200})),s(lt,Qe)};x(Je,lt=>{var Qe;((Qe=e(S))==null?void 0:Qe.npcType)!=="FtkChallenge"&&lt(tt)})}var at=r(Je,2),Le=a(at),Ke=a(Le),yt=r(Le),vt=a(yt),Ct=a(vt);y(()=>{e(I),Ut(()=>{})}),ne(Ct,5,()=>Ht(Ua),ve,(lt,Qe)=>{var ut=Bn(),qt={},Wt=a(ut);y(()=>{qt!==(qt=e(Qe))&&(ut.value=(ut.__value=e(Qe))==null?"":e(Qe)),g(Wt,Ua[e(Qe)])}),s(lt,ut)}),y(()=>g(Tt,`※${e(j)??""}`)),Z(3,_t,()=>pe,()=>({duration:200})),Z(3,st,()=>pe,()=>({duration:200})),oe("change",$t,ee),Kt($t,()=>e(I).previousNpcId,lt=>e(I).previousNpcId=lt),Z(3,ct,()=>pe,()=>({duration:200})),Z(3,pt,()=>pe,()=>({duration:200})),Z(3,nt,()=>pe,()=>({duration:200})),Z(3,Ke,()=>pe,()=>({duration:200})),Z(3,Le,()=>pe,()=>({duration:200})),Kt(Ct,()=>e(I).previousStartMode,lt=>e(I).previousStartMode=lt),Z(3,vt,()=>pe,()=>({duration:200})),Z(3,yt,()=>pe,()=>({duration:200})),Z(3,at,()=>pe,()=>({duration:200})),s(rt,et)},ft=rt=>{var et=je(),nt=L(et);{var st=_t=>{var pt=Yn(),ct=a(pt),$t=a(ct),Mt=r(ct),Tt=a(Mt),Je=a(Tt);y(()=>{e(I),Ut(()=>{})}),ne(Je,5,()=>Dr,ve,(tt,at)=>{var Le=An(),Ke={},yt=a(Le);y(()=>{Ke!==(Ke=e(at))&&(Le.value=(Le.__value=e(at))==null?"":e(at)),g(yt,e(at))}),s(tt,Le)}),Z(3,$t,()=>pe,()=>({duration:200})),Z(3,ct,()=>pe,()=>({duration:200})),Kt(Je,()=>e(I).previousDifficulty,tt=>e(I).previousDifficulty=tt),Z(3,Tt,()=>pe,()=>({duration:200})),Z(3,Mt,()=>pe,()=>({duration:200})),Z(3,pt,()=>pe,()=>({duration:200})),s(_t,pt)};x(nt,_t=>{e(p)==="FtkChallenge"&&_t(st)},!0)}s(rt,et)};x(Fe,rt=>{e(p)==="Free"?rt(dt):rt(ft,!1)})}var Et=r(Fe,2),At=a(Et),Yt=a(At),Rt=a(Yt);Z(3,w,()=>pe,()=>({duration:200})),Z(3,Ye,()=>pe,()=>({duration:200})),Z(3,ae,()=>pe,()=>({duration:200})),Z(3,k,()=>pe,()=>({duration:200})),Z(3,_e,()=>pe,()=>({duration:200})),Z(3,Ge,()=>pe,()=>({duration:200})),Z(3,He,()=>pe,()=>({duration:200})),Kt(Be,()=>e(E),rt=>C(E,rt)),Z(3,Ee,()=>pe,()=>({duration:200})),Z(3,Ne,()=>pe,()=>({duration:200})),Z(3,ge,()=>pe,()=>({duration:200})),oe("click",Rt,ye),Z(3,Yt,()=>pe,()=>({duration:200})),s(Ie,Ze)});var Se=r(we,2);{var Pe=Ie=>{var ze=Nn(),Ze=a(ze),_e=a(Ze),Ye=a(_e);oe("click",Ye,h),Z(3,_e,()=>pe,()=>({duration:200})),Z(3,Ze,()=>pe,()=>({duration:200})),Z(3,ze,()=>pe,()=>({duration:200})),s(Ie,ze)};x(Se,Ie=>{e(p)==="Free"&&Ie(Pe)})}Z(3,Re,()=>pe,()=>({duration:200})),Z(3,We,()=>pe,()=>({duration:200})),St(qe,()=>e(I).name,Ie=>e(I).name=Ie),oe("keypress",qe,T),Z(3,Xe,()=>pe,()=>({duration:200})),Z(3,Ue,()=>pe,()=>({duration:200})),Z(3,Oe,()=>pe,()=>({duration:200})),s(G,$e)}),s(W,De)};x(u,W=>{e(o)==="DeckEdit"?W(b):W(H,!1)},!0)}s(m,_)};x(se,m=>{e(c)?m(me):m(Ce,!1)})}var F=r(se,2),D=a(F);mt(D,()=>Jt,m=>{var _=it("読み込み中");s(m,_)},(m,_)=>{var u=Hn(),b=L(u),H=a(b),W=r(b,2),De=a(W);y((xe,ce,Q)=>{g(H,`公式DB上のカード${xe??""}枚`),g(De,`実装済カード（効果あり）${ce??""}枚 （効果なし）${Q??""}枚`)},[()=>e(_).knmCount.toLocaleString(),()=>e(_).definitionCount.toLocaleString(),()=>e(_).nonDefinitionCount.toLocaleString()],fe),s(m,u)});var R=r(F,2),te=a(R),ie=a(te),$=r(te,2),O=a($),q=r($,2),V=a(q),J=r(R,2);{var ke=m=>{var _=Kn(),u=a(_);{var b=I=>{var $e=je(),Oe=L($e);{var We=Ue=>{var Xe=On();s(Ue,Xe)},Re=Ue=>{var Xe=je(),qe=L(Xe);{var we=Se=>{var Pe=Rn();s(Se,Pe)};x(qe,Se=>{e(c).winner.seat==="Above"&&Se(we)},!0)}s(Ue,Xe)};x(Oe,Ue=>{e(c).winner.seat==="Below"?Ue(We):Ue(Re,!1)})}s(I,$e)},H=I=>{var $e=Wn();s(I,$e)};x(u,I=>{e(c).winner?I(b):I(H,!1)})}var W=r(u,2),De=a(W),xe=r(W,2);{var ce=I=>{var $e=In(),Oe=a($e);y(()=>xt(Oe,"href",`https://x.com/share?url=${M}&text=${e(c).twitterShareText??""}&hashtags=${n}&via=${U}`)),s(I,$e)};x(xe,I=>{e(c).twitterShareText&&I(ce)})}var Q=r(xe,2),G=a(Q);y(()=>g(De,e(c).reasonOfEnd)),oe("click",G,K),Z(3,_,()=>Mr,()=>({delay:200,duration:200})),s(m,_)};x(J,m=>{e(c)&&e(c).isEnded&&m(ke)})}y(()=>{g(ie,"build at: 20260111_193353"),g(O,kr.text),g(V,`w:${e(d)??""}px h:${e(f)??""}px`)}),ia("innerWidth",m=>C(d,m)),ia("innerHeight",m=>C(f,m)),oe("click",N,K),s(v,le),kt()}$r(Vn,{target:document.getElementById("app")});
