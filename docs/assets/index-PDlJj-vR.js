var Za=Object.defineProperty;var ja=f=>{throw TypeError(f)};var er=(f,i,t)=>i in f?Za(f,i,{enumerable:!0,configurable:!0,writable:!0,value:t}):f[i]=t;var nt=(f,i,t)=>er(f,typeof i!="symbol"?i+"":i,t),Aa=(f,i,t)=>i.has(f)||ja("Cannot "+t);var ft=(f,i,t)=>(Aa(f,i,"read from private field"),t?t.call(f):i.get(f)),la=(f,i,t)=>i.has(f)?ja("Cannot add the same private member more than once"):i instanceof WeakSet?i.add(f):i.set(f,t),ka=(f,i,t,o)=>(Aa(f,i,"write to private field"),o?o.call(f,t):i.set(f,t),t);import{s as Ba,r as tr,a as $,b as ar,l as rr,g as e,d as za,p as ct,c as je,m as ne,i as _t,t as l,e as a,f as C,h as m,j as de,k as Ae,n as rt,o as V,q as r,u as ut,v as be,D as sr,w as we,x as P,y as s,z as ce,A as Vt,B as oe,C as _e,E as b,F as ir,G as at,H as Xt,I as nr,J as Va,K as ea,L as ca,M as $a,N as oa,O as xa,P as Kt,Q as mt,R as Sa,S as ga,T as Ma,U as da,V as _a,W as Xa,X as ya,Y as ha,Z as lr,_ as or,$ as dr,a0 as vr,a1 as cr,a2 as _r,a3 as ur,a4 as ua,a5 as Ga,a6 as ta,a7 as Qa,a8 as fa,a9 as Lt,aa as fr,ab as mr,ac as aa,ad as pr,ae as Dt,af as gr,ag as yr,ah as hr,ai as La,aj as qa,ak as Ya,al as Ua,am as Ha,an as Pa,ao as br,ap as Et,aq as It,ar as Ot,as as kr,at as Rt,au as xr,av as wr,aw as Na,ax as Zt,ay as zt,az as Cr,aA as Dr,aB as $r,aC as Fa,aD as Sr,aE as Mr,aF as Tr}from"../chunk/entity_proc_20260123_123737.js";import"../chunk/json_20260123_123737.js";(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const g of document.querySelectorAll('link[rel="modulepreload"]'))o(g);new MutationObserver(g=>{for(const c of g)if(c.type==="childList")for(const u of c.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&o(u)}).observe(document,{childList:!0,subtree:!0});function t(g){const c={};return g.integrity&&(c.integrity=g.integrity),g.referrerPolicy&&(c.referrerPolicy=g.referrerPolicy),g.crossOrigin==="use-credentials"?c.credentials="include":g.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function o(g){if(g.ep)return;g.ep=!0;const c=t(g);fetch(g.href,c)}})();const Er=f=>f;function Ta(f){const i=f-1;return i*i*i+1}function Ia(f){const i=typeof f=="string"&&f.match(/^\s*(-?[\d.]+)([^\s]*)\s*$/);return i?[parseFloat(i[1]),i[2]||"px"]:[f,"px"]}function jr(f,{delay:i=0,duration:t=400,easing:o=Er}={}){const g=+getComputedStyle(f).opacity;return{delay:i,duration:t,easing:o,css:c=>`opacity: ${c*g}`}}function Ar(f,{delay:i=0,duration:t=400,easing:o=Ta,x:g=0,y:c=0,opacity:u=0}={}){const d=getComputedStyle(f),B=+d.opacity,A=d.transform==="none"?"":d.transform,S=B*(1-u),[M,n]=Ia(g),[q,R]=Ia(c);return{delay:i,duration:t,easing:o,css:(I,_)=>`
			transform: ${A} translate(${(1-I)*M}${n}, ${(1-I)*q}${R});
			opacity: ${B-S*_}`}}function xe(f,{delay:i=0,duration:t=400,easing:o=Ta,axis:g="y"}={}){const c=getComputedStyle(f),u=+c.opacity,d=g==="y"?"height":"width",B=parseFloat(c[d]),A=g==="y"?["top","bottom"]:["left","right"],S=A.map(p=>`${p[0].toUpperCase()}${p.slice(1)}`),M=parseFloat(c[`padding${S[0]}`]),n=parseFloat(c[`padding${S[1]}`]),q=parseFloat(c[`margin${S[0]}`]),R=parseFloat(c[`margin${S[1]}`]),I=parseFloat(c[`border${S[0]}Width`]),_=parseFloat(c[`border${S[1]}Width`]);return{delay:i,duration:t,easing:o,css:p=>`overflow: hidden;opacity: ${Math.min(p*20,1)*u};${d}: ${p*B}px;padding-${A[0]}: ${p*M}px;padding-${A[1]}: ${p*n}px;margin-${A[0]}: ${p*q}px;margin-${A[1]}: ${p*R}px;border-${A[0]}-width: ${p*I}px;border-${A[1]}-width: ${p*_}px;min-${d}: 0`}}function Oa(f,i){for(const t in i)f[t]=i[t];return f}function Br({fallback:f,...i}){const t=new Map,o=new Map;function g(u,d,B){const{delay:A=0,duration:S=U=>Math.sqrt(U)*30,easing:M=Ta}=Oa(Oa({},i),B),n=u.getBoundingClientRect(),q=d.getBoundingClientRect(),R=n.left-q.left,I=n.top-q.top,_=n.width/q.width,p=n.height/q.height,K=Math.sqrt(R*R+I*I),Z=getComputedStyle(d),Ce=Z.transform==="none"?"":Z.transform,j=+Z.opacity;return{delay:A,duration:typeof S=="function"?S(K):S,easing:M,css:(U,ve)=>`
			   opacity: ${U*j};
			   transform-origin: top left;
			   transform: ${Ce} translate(${ve*R}px,${ve*I}px) scale(${U+(1-U)*_}, ${U+(1-U)*p});
		   `}}function c(u,d,B){return(A,S)=>(u.set(S.key,A),()=>{if(d.has(S.key)){const M=d.get(S.key);return d.delete(S.key),g(M,A,S)}return u.delete(S.key),f&&f(A,S,B)})}return[c(o,t,!1),c(t,o,!0)]}function Ra(f){return Object.prototype.toString.call(f)==="[object Date]"}function Lr(f){return f}function wa(f){const i=f-1;return i*i*i+1}function Ca(f,i){if(f===i||f!==f)return()=>f;const t=typeof f;if(t!==typeof i||Array.isArray(f)!==Array.isArray(i))throw new Error("Cannot interpolate values of different type");if(Array.isArray(f)){const o=i.map((g,c)=>Ca(f[c],g));return g=>o.map(c=>c(g))}if(t==="object"){if(!f||!i)throw new Error("Object cannot be null");if(Ra(f)&&Ra(i)){const c=f.getTime(),d=i.getTime()-c;return B=>new Date(c+B*d)}const o=Object.keys(i),g={};return o.forEach(c=>{g[c]=Ca(f[c],i[c])}),c=>{const u={};return o.forEach(d=>{u[d]=g[d](c)}),u}}if(t==="number"){const o=i-f;return g=>f+g*o}return()=>i}var qt,ra,va,Gt;const Ea=class Ea{constructor(i,t={}){la(this,qt,Ba(void 0));la(this,ra,Ba(void 0));la(this,va);la(this,Gt,null);ft(this,qt).v=ft(this,ra).v=i,ka(this,va,t)}static of(i,t){const o=new Ea(i(),t);return tr(()=>{o.set(i())}),o}set(i,t){var M;$(ft(this,ra),i);let{delay:o=0,duration:g=400,easing:c=Lr,interpolate:u=Ca}={...ft(this,va),...t};if(g===0)return(M=ft(this,Gt))==null||M.abort(),$(ft(this,qt),i),Promise.resolve();const d=ar.now()+o;let B,A=!1,S=ft(this,Gt);return ka(this,Gt,rr(n=>{if(n<d)return!0;if(!A){A=!0;const R=ft(this,qt).v;B=u(R,i),typeof g=="function"&&(g=g(R,i)),S==null||S.abort()}const q=n-d;return q>g?($(ft(this,qt),i),!1):($(ft(this,qt),B(c(q/g))),!0)})),ft(this,Gt).promise}get current(){return e(ft(this,qt))}get target(){return e(ft(this,ra))}set target(i){this.set(i)}};qt=new WeakMap,ra=new WeakMap,va=new WeakMap,Gt=new WeakMap;let ma=Ea;var qr=l('<div class="phase_display svelte-1boxe40"><span class="svelte-1boxe40"> </span> </div>'),Yr=l('<div class="lifepoint_display svelte-1boxe40"><div class="svelte-1boxe40"> </div> <div class="svelte-1boxe40"> </div></div>'),Ur=(f,i,t)=>i(e(t)),Hr=l('<div class="svelte-1boxe40"><button class="phase_button svelte-1boxe40"> </button></div>'),Pr=l("<div><!></div>"),Nr=l('<div class="svelte-1boxe40"><!></div>'),Fr=l("<div><!></div>"),Ir=l('<div class="config_button_wrapper svelte-1boxe40"><button id="config_button" class="svelte-1boxe40">⚙</button></div>'),Or=l("<!> <!> <!> <!>",1),Rr=l('<div style="position: absolute;" class="card_animation_receiver svelte-1boxe40"><!></div>'),Kr=l('<div style="position: absolute; top:0rem" class="svelte-1boxe40">｛効果対象｝</div>'),Wr=l('<!> <div style="position: absolute; display:flex;justify-content: center;"><!></div>',1),zr=l(" <!> 】",1),Vr=l('<div style="position: absolute; bottom:0rem" class="svelte-1boxe40"> <!></div>'),Xr=l("<!> <!>",1),Gr=l('<div class="badge svelte-1boxe40"> </div>'),Qr=l('<div class="card_animation_receiver svelte-1boxe40"><!></div>'),Jr=l("<!> <!> <!> <!>",1),Zr=l('<td><div role="listitem"><!></div></td>');function es(f,i){ct(i,!1);let t=je(i,"view",12),o=je(i,"row",8),g=je(i,"column",8),c=je(i,"selectedEntities",28,()=>[]),u=je(i,"selectedCells",28,()=>[]),d=ne(t().getCell(o(),g())),B=ne(new ma(e(d).field.duel.duelists.Above.lp,{duration:400,easing:wa})),A=ne(new ma(e(d).field.duel.duelists.Below.lp,{duration:400,easing:wa}));const S=()=>{$(d,t().getCell(o(),g())),be(B,e(B).target=e(d).field.duel.duelists.Above.lp),be(A,e(A).target=e(d).field.duel.duelists.Below.lp)};e(d).onUpdate.append(S),t().onDuelUpdate.append(S),t().modalController.onUpdate.append(S);let M,n=ne([]),q=()=>console.log("hoge"),R,I=ne([]),_=ne(!1),p=ne(!1),K=!1;const Z=w=>{var F,z;$(se,[]),c().reset(),M=w.activator,q=w.resolve,$(n,w.dummyActionInfos),$(I,w.chainBlockInfos.flatMap(Q=>Q.selectedEntities).getDistinct()),R=w.entitiesChoices,$(_,!1),$(p,((F=w.cellsChoices)==null?void 0:F.selectables.includes(e(d)))??!1),K=e(p)&&((z=w.cellsChoices)==null?void 0:z.qty)===1,S()};t().onWaitStart.append(Z);const Ce=()=>{M=void 0,$(n,[]),q=()=>{console.log("hoge")},R=void 0,$(I,[]),$(_,!1),$(p,!1),K=!1};t().onWaitEnd.append(Ce);let j=ne(!1),U=[];const ve=w=>{U=w.filter(F=>F.dests.includes(e(d))),$(j,U.length>0),S()},Me=()=>{U=[],$(j,!1),S()};t().onDragStart.append(ve),t().onDragEnd.append(Me);const[ge,le]=ui;let se=ne([]);const Ee=w=>{if(M=void 0,e(d)===w.to||e(d).entities.includes(w.entity)){$(se,[...e(se),w]);const F=w.resolve;$(d,e(d)),setTimeout(()=>{$(se,e(se).filter(z=>z!==w)),w.count++,w.count>1&&F()},600)}};t().onAnimation.append(Ee);const ye=w=>{q({phaseChange:w})},Y=()=>e(d).isStackCell&&e(d).entities.flatMap(w=>w.actions).filter(w=>e(n).map(F=>F.action.seq).some(F=>F===w.seq)).length>0,N=w=>{var F;if(((F=w.target)==null?void 0:F.id)==="config_button"){t(t().infoBoardState="Config",!0),t().requireUpdate();return}if(t(t().infoBoardState="Default",!0),K)q({selectedCells:[e(d)]});else if(e(p))$(_,!e(_)),u(e(_)?[...u(),e(d)]:u().filter(z=>z!==e(d)));else if(e(d).isStackCell){t(t().infoBoardState="CellInfo",!0),t(t().infoBoardCell=e(d),!0),t().requireUpdate();const z=e(d).entities.flatMap(X=>X.actions).map(X=>X.seq),Q=e(n).filter(X=>z.includes(X.action.seq));if(Q.length){if(!M)return;t().modalController.actionSelector.show({title:"カードを選択。",position:"Bottom",activator:M,dummyActionInfos:Q,cancelable:!0}).then(X=>{X&&q({actionInfo:X})});return}}t().requireUpdate(),console.info(e(d),Te(...e(d).visibleEntities))},fe=w=>{w.preventDefault(),w.dataTransfer&&(w.dataTransfer.dropEffect="move")},ae=w=>{w.preventDefault(),console.info("drop",w,e(j),U),w.dataTransfer&&(w.dataTransfer.dropEffect="move");try{if(e(j)&&U){if(U.length===1){const F=U[0];q({actionInfo:{...F,dest:e(d)}})}else if(U.length>1){if(!M)throw new sr("想定されない状態");e(d).field.duel.view.modalController.terminateAll(),e(d).field.duel.view.modalController.actionSelector.show({title:"選択",position:"Bottom",activator:M,dummyActionInfos:U.map(F=>({...F,dest:e(d)})),cancelable:!1}).then(F=>{q({actionInfo:F})})}}}finally{t().removeDraggingActions()}},Te=(...w)=>{if(t().waitMode==="Animation")return"Disabled";if(R&&R.selectables.find(z=>w.find(Q=>z===Q)))return"Selectable";if(!e(n)||e(n).length===0||t().waitMode!=="Free"||Object.values(t().modalController.modals).some(z=>z.state==="Shown"))return"Disabled";const F=e(n).filter(z=>w.includes(z.action.entity));return F.length===0?"Disabled":e(d).isStackCell||F[0].action.entity!==w[0]?"Clickable":F.some(z=>z.dests.length)?"Draggable":"Clickable"};_t();var E=Zr(),x=a(E);x.__click=N;var L=a(x);{var W=w=>{var F=we(),z=P(F);{var Q=X=>{var ue=we(),T=P(ue);{var D=y=>{var H=qr(),G=a(H),De=a(G),$e=s(G,1,!0);m((me,ie)=>{b(De,me),b($e,ie)},[()=>String(e(d).field.duel.clock.turn).padStart(2,"0"),()=>e(d).field.duel.phase.toUpperCase()],de),r(y,H)},v=y=>{var H=we(),G=P(H);{var De=me=>{var ie=Yr(),re=a(ie),te=a(re),Se=s(re,2),Re=a(Se);m((Ie,Ke)=>{b(te,Ie),b(Re,Ke)},[()=>Math.floor(e(B).current),()=>Math.floor(e(A).current)],de),r(me,ie)},$e=me=>{var ie=we(),re=P(ie);{var te=Se=>{var Re=we(),Ie=P(Re);{var Ke=Ue=>{var Ge=we(),lt=P(Ge);{var Ye=ke=>{var Le=we(),He=P(Le);ce(He,1,()=>t().duel.nextPhaseList,_e,(We,st)=>{var Xe=Hr(),et=a(Xe);et.__click=[Ur,ye,st];var $t=a(et);m(vt=>b($t,vt),[()=>e(st).toUpperCase()],de),r(We,Xe)}),r(ke,Le)};C(lt,ke=>{t().duel.isEnded||ke(Ye)})}r(Ue,Ge)};C(Ie,Ue=>{t().waitMode==="Free"&&Ue(Ke)})}r(Se,Re)};C(re,Se=>{e(d).column===5&&Se(te)},!0)}r(me,ie)};C(G,me=>{e(d).column===3?me(De):me($e,!1)},!0)}r(y,H)};C(T,y=>{e(d).column===1?y(D):y(v,!1)})}r(X,ue)};C(z,X=>{e(d).row===3&&X(Q)})}r(w,F)},ee=w=>{var F=we(),z=P(F);{var Q=ue=>{var T=Or();const D=de(()=>e(se).find(ie=>ie.to===e(d)));var v=P(T);{var y=ie=>{var re=Pr(),te=a(re);Vt(te,{get entity(){return e(D).entity},state:"Disabled",dummyActionInfos:[],cardActionResolve:void 0}),m(()=>Ae(re,`card_animation_receiver ${e(d).cellType??""} svelte-1boxe40`)),oe(1,re,()=>le,()=>({key:e(D).entity.seq})),r(ie,re)};C(v,ie=>{e(D)&&e(D).index==="Top"&&ie(y)})}var H=s(v,2);ce(H,1,()=>e(d).visibleEntities,_e,(ie,re)=>{var te=we(),Se=P(te);{var Re=Ie=>{var Ke=Nr(),Ue=a(Ke);const Ge=de(()=>Te(e(re))),lt=de(()=>e(n).filter(Ye=>Ye.action.entity===e(re)));Vt(Ue,{get entity(){return e(re)},get state(){return e(Ge)},get dummyActionInfos(){return e(lt)},cardActionResolve:void 0,get selectedList(){return c()},set selectedList(Ye){c(Ye)},$$legacy:!0}),oe(2,Ke,()=>ge,()=>({key:e(re).seq})),r(Ie,Ke)};C(Se,Ie=>{e(se).every(Ke=>Ke.entity.seq!==e(re).seq)&&Ie(Re)})}r(ie,te)});var G=s(H,2);{var De=ie=>{var re=Fr(),te=a(re);Vt(te,{get entity(){return e(D).entity},state:"Disabled",dummyActionInfos:[],cardActionResolve:void 0}),m(()=>Ae(re,`card_animation_receiver ${e(d).cellType??""} svelte-1boxe40`)),oe(1,re,()=>le,()=>({key:e(D).entity.seq})),r(ie,re)};C(G,ie=>{e(D)&&e(D).index!=="Top"&&ie(De)})}var $e=s(G,2);{var me=ie=>{var re=Ir();r(ie,re)};C($e,ie=>{e(d).owner.seat==="Below"&&ie(me)})}r(ue,T)},X=ue=>{var T=Jr();const D=de(()=>e(se).find(re=>re.to===e(d)));var v=P(T);{var y=re=>{var te=Rr(),Se=a(te);Vt(Se,{get entity(){return e(D).entity},state:"Disabled",dummyActionInfos:[],cardActionResolve:void 0}),oe(1,te,()=>le,()=>({key:e(D).entity.seq})),r(re,te)};C(v,re=>{e(D)&&e(D).index!=="Top"&&re(y)})}var H=s(v,2);{var G=re=>{var te=Xr(),Se=P(te);ce(Se,1,()=>e(d).visibleEntities.map((Ke,Ue)=>({index:Ue,entity:Ke})).toReversed(),_e,(Ke,Ue)=>{var Ge=we(),lt=P(Ge);{var Ye=ke=>{var Le=Wr();const He=de(()=>!e(d).isStackCell&&e(Ue).index===0?Te(...e(d).visibleEntities):void 0);var We=P(Le);{var st=vt=>{var St=Kr();r(vt,St)};C(We,vt=>{e(I).includes(e(Ue).entity)&&vt(st)})}var Xe=s(We,2),et=a(Xe);const $t=de(()=>e(Ue).index===0?e(n).filter(vt=>e(d).visibleEntities.includes(vt.action.entity)):void 0);Vt(et,{get entity(){return e(Ue).entity},get state(){return e(He)},get dummyActionInfos(){return e($t)},cardActionResolve:void 0,get selectedList(){return c()},set selectedList(vt){c(vt)},$$legacy:!0}),m(()=>Ae(Xe,`duel_card_wrapper ${(e(Ue).entity.exist?"duel_card_wrapper_exists":"")??""} svelte-1boxe40`)),oe(2,Xe,()=>ge,()=>({key:e(Ue).entity.seq})),r(ke,Le)};C(lt,ke=>{e(se).every(Le=>Le.entity.seq!==e(Ue).entity.seq)&&ke(Ye)})}r(Ke,Ge)});var Re=s(Se,2);{var Ie=Ke=>{var Ue=Vr(),Ge=a(Ue),lt=s(Ge);ce(lt,1,()=>Xt(e(d).visibleEntities[0].status.maxCounterQty),_e,(Ye,ke)=>{var Le=zr(),He=P(Le),We=s(He);{var st=Xe=>{var et=at();m(()=>b(et,`/${e(d).visibleEntities[0].status.maxCounterQty[e(ke)]??""}`)),r(Xe,et)};C(We,Xe=>{(e(d).visibleEntities[0].status.maxCounterQty[e(ke)]??9999)<100&&Xe(st)})}m((Xe,et)=>b(He,`【
              ${Xe??""}${et??""} `),[()=>ir(e(ke)),()=>e(d).visibleEntities[0].counterHolder.getQty(e(ke))],de),r(Ye,Le)}),m(()=>b(Ge,`【${e(d).visibleEntities[0].battlePositionName??""}】 `)),r(Ke,Ue)};C(Re,Ke=>{e(d).visibleEntities[0].battlePosition&&Ke(Ie)})}r(re,te)};C(H,re=>{e(d).visibleEntities.length>0&&re(G)})}var De=s(H,2);{var $e=re=>{var te=Gr(),Se=a(te);m(()=>b(Se,e(d).visibleEntities.length)),r(re,te)};C(De,re=>{e(d).isStackCell&&re($e)})}var me=s(De,2);{var ie=re=>{var te=Qr(),Se=a(te);Vt(Se,{get entity(){return e(D).entity},state:"Disabled",dummyActionInfos:[],cardActionResolve:void 0}),oe(1,te,()=>le,()=>({key:e(D).entity.seq})),r(re,te)};C(me,re=>{e(D)&&e(D).index==="Top"&&re(ie)})}r(ue,T)};C(z,ue=>{e(d).cellType==="Hand"?ue(Q):ue(X,!1)},!0)}r(w,F)};C(L,w=>{e(d).isDisabledCell?w(W):w(ee,!1)})}m(w=>{Ae(E,`${`duel_field_cell duel_field_cell_${e(d).cellType} ${e(d).linkArrowSources.length===0?"":"duel_field_cell_linked"}`??""} svelte-1boxe40`),rt(E,"colspan",e(d).cellType==="Hand"?7:1),Ae(x,`${w??""} svelte-1boxe40`)},[()=>`duel_field_cell_inner_box ${e(d).cellType} ${e(j)?"can_accept_drop":""} ${Y()?"can_action":""} ${e(_)?"is_selected":e(p)?"is_selectable":""} `],de),V("dragover",x,fe),V("drop",x,ae),r(f,E),ut()}za(["click"]);const ts=(f,i,t=void 0,o="!!!circular reference!!!")=>{let g=[];return JSON.stringify(f,(c,u)=>{if(typeof u=="object"){if(g.indexOf(u)>-1)return o;g.push(u)}let d=u;if(i&&(d=i(c,u)),typeof d=="function")return d.toString();if(d!==u&&typeof d=="object"){if(g.indexOf(d)>-1)return o;g.push(d)}return d},t)};var as=l('<div class="title svelte-14z6bdh"> </div>'),rs=l('<div class="title svelte-14z6bdh"> </div>'),ss=l('<div class="duel_log_chain_number svelte-14z6bdh"> </div>'),is=l('<div><a class="white_button" download="error_info.json">エラー情報ダウンロード</a></div>'),ns=l("<div><!> <!></div>"),ls=l('<div><div style="display: flex;    justify-content: space-between;"><div style=" white-space: nowrap;text-align: center;"> </div> <!></div> <!></div>'),os=l("<div><!> <!></div>"),ds=l("<div><!> <!></div>"),vs=l('<div class="duel_log svelte-14z6bdh"><div class="duel_log_header svelte-14z6bdh"></div> <div class="duel_log_body svelte-14z6bdh"></div> <div class="duel_log_footer svelte-14z6bdh"></div></div>');function cs(f,i){ct(i,!1);let t=ne(void 0),o=je(i,"log",8),g,c=ne([]);const u=()=>{const S=((g==null?void 0:g.seq)??-1)+1;o().records.slice(S).forEach(M=>{if(!g){$(c,[[[[M]]]]),g=M;return}if(!e(c)[M.clock.turn]){be(c,e(c)[M.clock.turn]=[[[M]]]),g=M;return}if(!e(c)[M.clock.turn][M.clock.phaseSeq]){be(c,e(c)[M.clock.turn][M.clock.phaseSeq]=[[M]]),g=M;return}if(g.clock.chainSeq===M.clock.chainSeq&&g.clock.chainBlockSeq===M.clock.chainBlockSeq&&g.duelist===M.duelist){e(c)[M.clock.turn][M.clock.phaseSeq].slice(-1)[0].push(M),g=M;return}e(c)[M.clock.turn][M.clock.phaseSeq].push([M]),g=M}),$(c,e(c)),nr().then(()=>e(t)&&e(t).scroll(0,e(t).clientHeight*990))};o().onUpdate.append(u),o().duel.view.onDuelUpdate.append(u),u(),_t();var d=we(),B=P(d);{var A=S=>{var M=vs(),n=s(a(M),2);ce(n,5,()=>e(c),_e,(q,R)=>{var I=ds(),_=a(I);{var p=Z=>{var Ce=as(),j=a(Ce);m(()=>b(j,`ターン：${e(R)[0][0][0].clock.turn??""}`)),r(Z,Ce)};C(_,Z=>{e(R)[0][0][0].clock.turn>0&&Z(p)})}var K=s(_,2);ce(K,1,()=>e(R),_e,(Z,Ce)=>{var j=os(),U=a(j);{var ve=ge=>{var le=rs(),se=a(le);m(()=>b(se,e(Ce)[0][0].clock.period.name)),r(ge,le)};C(U,ge=>{e(Ce)[0][0].clock.turn>0&&ge(ve)})}var Me=s(U,2);ce(Me,1,()=>e(Ce),_e,(ge,le)=>{var se=ls();const Ee=de(()=>{var E;return((E=e(le).find(x=>x.chainNumber!==void 0))==null?void 0:E.chainNumber)??0});var ye=a(se),Y=a(ye),N=a(Y),fe=s(Y,2);{var ae=E=>{var x=ss(),L=a(x);m(()=>b(L,`チェーン：${e(Ee)??""}`)),r(E,x)};C(fe,E=>{e(Ee)&&E(ae)})}var Te=s(ye,2);ce(Te,1,()=>e(le),_e,(E,x)=>{var L=ns(),W=a(L);{var ee=Q=>{var X=at();m(()=>b(X,e(x).text)),r(Q,X)},w=Q=>{var X=we(),ue=P(X);{var T=v=>{var y=at();m((H,G,De)=>b(y,`移動：${H??""} ${G??""} ⇒ ${De??""}`),[()=>{var H;return(H=e(x).mainEntity)==null?void 0:H.toString()},()=>{var H;return(H=e(x).from)==null?void 0:H.toString()},()=>{var H;return(H=e(x).to)==null?void 0:H.toString()}],de),r(v,y)},D=v=>{var y=we(),H=P(y);{var G=$e=>{var me=at();m((ie,re)=>b(me,`生成：${ie??""} void ⇒ ${re??""}`),[()=>{var ie;return(ie=e(x).mainEntity)==null?void 0:ie.toString()},()=>{var ie;return(ie=e(x).to)==null?void 0:ie.toString()}],de),r($e,me)},De=$e=>{var me=we(),ie=P(me);{var re=Se=>{var Re=at();m((Ie,Ke)=>b(Re,`消滅：${Ie??""} ${Ke??""} ⇒ void`),[()=>{var Ie;return(Ie=e(x).mainEntity)==null?void 0:Ie.toString()},()=>{var Ie;return(Ie=e(x).from)==null?void 0:Ie.toString()}],de),r(Se,Re)},te=Se=>{var Re=at();m(()=>b(Re,e(x).text)),r(Se,Re)};C(ie,Se=>{e(x).type==="EntityDisappear"?Se(re):Se(te,!1)},!0)}r($e,me)};C(H,$e=>{e(x).type==="EntityAppear"?$e(G):$e(De,!1)},!0)}r(v,y)};C(ue,v=>{e(x).type==="EntityMove"?v(T):v(D,!1)},!0)}r(Q,X)};C(W,Q=>{e(x).type==="ChainBlockHeader"?Q(ee):Q(w,!1)})}var F=s(W,2);{var z=Q=>{var X=is(),ue=a(X);m(T=>rt(ue,"href",T),[()=>window.URL.createObjectURL(new Blob([ts(e(x).error,(T,D)=>["pool","bundles","duel"].includes(T)||typeof D=="function"?void 0:D,4)],{type:"text/plain"}))],de),r(Q,X)};C(F,Q=>{e(x).error&&Q(z)})}m(Q=>Ae(L,`duel_log_record duel_log_record_${Q??""} svelte-14z6bdh`),[()=>e(x).type.toSnakeCase()],de),r(E,L)}),m(()=>{var E,x,L;Ae(se,`duel_log_block_duelist duel_log_block_duelist_${((E=e(le)[0].duelist)==null?void 0:E.seat)??"system"} svelte-14z6bdh`),Ae(Y,`duelist ${((x=e(le)[0].duelist)==null?void 0:x.seat)??""} svelte-14z6bdh`),b(N,((L=e(le)[0].duelist)==null?void 0:L.profile.name)||"SYSTEM")}),r(ge,se)}),m(()=>Ae(j,`duel_log_block_phase duel_log_block_phase_${e(Ce)[0][0].clock.period.key??""} svelte-14z6bdh`)),r(Z,j)}),m(()=>Ae(I,`duel_log_block_turn duel_log_block_turn_${e(R)[0][0][0].clock.turn??""} svelte-14z6bdh`)),r(q,I)}),Va(n,q=>$(t,q),()=>e(t)),r(S,M)};C(B,S=>{(o().duel.view.infoBoardState==="Log"||o().duel.view.infoBoardState==="Default")&&S(A)})}r(f,d),ut()}var _s=l("<div><div> </div> <div> </div></div>");function Ka(f,i){ct(i,!1);let t=je(i,"duelist",12),o=ne(0),g=ne();const c=async()=>{const n=t().lp-e(o);if(!e(g)||Math.abs(n)<10){$(o,t().lp),e(g)&&(e(g)(),$(g,void 0));return}$(o,e(o)+Math.floor(Math.random()*n)),await ea(100),c()},u=()=>{t(t()),!e(g)&&t().lp!==e(o)&&new Promise(n=>{$(g,n),Math.abs(t().lp-e(o)),c()})};t().duel.log.onUpdate.append(u),c(),_t();var d=_s(),B=a(d),A=a(B),S=s(B,2),M=a(S);m(n=>{Ae(d,`duelist duelist_${n??""} svelte-1sy3trd`),Ae(B,`duelist_name duelist_${n??""}_name svelte-1sy3trd`),b(A,t().profile.name),Ae(S,`duelist_lp ${(e(g)?"vibration":"")??""} svelte-1sy3trd`),b(M,e(o))},[()=>t().seat.toLowerCase()],de),r(f,d),ut()}const us=(f,i,t)=>(i(i()!=="Detail"?"Detail":"Normal"),console.info(t()),!0),fs=(f,i,t)=>(i(i()!=="Debug"?"Debug":"Normal"),console.info(t()),!0);var ms=l('<div class="svelte-1uevs9j"> </div>'),ps=l('<div class="svelte-1uevs9j"> </div>'),gs=l('<div class="link_arrow_emoji svelte-1uevs9j"> </div>'),ys=l('<div class="duel_card_info_row svelte-1uevs9j" style=" justify-content: space-between;"><div class="svelte-1uevs9j"> </div> <div class="svelte-1uevs9j"> </div></div>'),hs=l('<div></div> <div class="svelte-1uevs9j"> </div>',1),bs=l("<div> </div>"),ks=l('<span class="svelte-1uevs9j">/</span> <div class="monster_defense svelte-1uevs9j"> </div>',1),xs=l("<div> </div>"),ws=l('<div class="duel_card_info_row svelte-1uevs9j"><!> <!> <div style="flex-grow: 1;" class="svelte-1uevs9j"></div> <div class="monster_attack svelte-1uevs9j"> </div> <!></div> <div class="duel_card_info_row svelte-1uevs9j"></div>',1),Cs=l('<div class="duel_card_row svelte-1uevs9j"><div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"> </div></div>'),Ds=l('<div class="duel_card_row svelte-1uevs9j"><div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"> </div></div>'),$s=l("<!> <!>",1),Ss=l('<pre class="description svelte-1uevs9j"> </pre>'),Ms=l('<div class="duel_card_info_row svelte-1uevs9j" style="border-style: solid; border-width: 1px;"><!></div>'),Ts=l('<pre class="description svelte-1uevs9j"> </pre>'),Es=l('<!> <div class="duel_card_info_row svelte-1uevs9j"><!></div>',1),js=l('<div class="effect_counter_area_item svelte-1uevs9j"><span class="svelte-1uevs9j"> </span> <span class="svelte-1uevs9j"> </span> <span class="svelte-1uevs9j">/</span> <span class="svelte-1uevs9j"> </span></div>'),As=l('<div class="duel_card_info_row effect_counter_area svelte-1uevs9j"><div class="effect_counter_area_title svelte-1uevs9j">効果使用状況</div> <div class="effect_counter_area_body svelte-1uevs9j"></div></div>'),Bs=l("[ <!> ],",1),Ls=l('<div class="svelte-1uevs9j"> <!></div>'),qs=l('<div class="svelte-1uevs9j"> </div> <!> <div class="svelte-1uevs9j"></div>',1),Ys=l('<div class="svelte-1uevs9j"> </div>'),Us=l('<div class="svelte-1uevs9j"> </div>'),Hs=l('<div class="svelte-1uevs9j"> </div>'),Ps=l('<div class="svelte-1uevs9j"> </div>'),Ns=l('<div class="svelte-1uevs9j"> </div>'),Fs=l('<div class="svelte-1uevs9j"> </div>'),Is=l('<div class="duel_card_info_row svelte-1uevs9j"><div class="svelte-1uevs9j"><!> <div class="svelte-1uevs9j"></div> <!> <div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"></div> <!> <div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"></div> <!> <div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"></div> <!> <div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"></div> <!> <div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"></div> <!> <div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"> </div> <div class="svelte-1uevs9j"> </div> <div class="svelte-1uevs9j"> </div> <div class="svelte-1uevs9j"></div></div></div>'),Os=l('<div class="svelte-1uevs9j">※エラッタ前のカードです</div>'),Rs=l('<div class="svelte-1uevs9j">※テスト用カードです</div>'),Ks=l('<a target="_blank" rel="noopener noreferrer" title="コナミカードデータベース" class="svelte-1uevs9j"> </a>'),Ws=l('<a target="_blank" rel="noopener noreferrer" title="遊戯王カードWiki" class="svelte-1uevs9j">⇒遊戯王カードWiki</a>'),zs=l('<div class="duel_card_info_links svelte-1uevs9j"><!> <!> <a target="_blank" rel="noopener noreferrer" title="google" class="svelte-1uevs9j">⇒google検索</a></div>'),Vs=l("<!> <!>",1),Xs=l('<div role="contentinfo"><div class="duel_card_info_header svelte-1uevs9j"><div class="duel_card_info_row svelte-1uevs9j"><div class="svelte-1uevs9j"> </div></div> <div class="duel_card_info_row svelte-1uevs9j" style="position:sticky; top:0;"><!> <div class="svelte-1uevs9j"> </div></div> <!></div> <div class="duel_card_info_body svelte-1uevs9j"><!></div> <div class="duel_card_info_footer svelte-1uevs9j"><!></div></div>');function Gs(f,i){ct(i,!1);let t=je(i,"entity",8),o=je(i,"mode",12,"Normal"),g=ne(new Promise(()=>{}));const c=()=>{var S,M;let A=t()&&t().entityType==="Card"?t().origin.cardId:(M=(S=t())==null?void 0:S.parent)==null?void 0:M.origin.cardId;return A??!1?`https://www.db.yugioh-card.com/yugiohdb/card_search.action?ope=2&cid=${A}`:t()?`https://www.db.yugioh-card.com/yugiohdb/card_search.action?ope=1&sess=1&rp=10&mode=&sort=1&keyword=${t().origin.name}&stype=1&ctype=&othercon=2&starfr=&starto=&pscalefr=&pscaleto=&linkmarkerfr=&linkmarkerto=&link_m=2&atkfr=&atkto=&deffr=&defto=&releaseDStart=1&releaseMStart=1&releaseYStart=1999&releaseDEnd=&releaseMEnd=&releaseYEnd=`:""};ca(()=>(Kt(t()),xa),()=>{$(g,oa.then(async A=>{if(t().origin.description||t().origin.pendulumDescription||t().origin.wikiEncodedName)return t().origin;const S=A.getCardInfo(t().origin.name);if(S)return S.cardId!==void 0&&!S.description&&!S.pendulumDescription&&await xa([S.cardId]),S}))}),$a(),_t();var u=we(),d=P(u);{var B=A=>{var S=Xs();S.__click=[us,o,t],S.__contextmenu=[fs,o,t];var M=a(S),n=a(M),q=a(n),R=a(q),I=s(n,2),_=a(I);{var p=Y=>{var N=ms(),fe=a(N);m(ae=>b(fe,ae),[()=>"★".repeat(t().lvl)],de),r(Y,N)},K=Y=>{var N=we(),fe=P(N);{var ae=E=>{var x=ps(),L=a(x);m(W=>b(L,W),[()=>"☆".repeat(t().rank)],de),r(E,x)},Te=E=>{var x=we(),L=P(x);{var W=ee=>{var w=gs(),F=a(w);m(z=>b(F,z),[()=>t().origin.linkArrowKeys.map(z=>Xa[z].emoji).join("")],de),r(ee,w)};C(L,ee=>{t().origin.linkArrowKeys&&ee(W)},!0)}r(E,x)};C(fe,E=>{t().rank&&t().rank>0?E(ae):E(Te,!1)},!0)}r(Y,N)};C(_,Y=>{t().lvl&&t().lvl>0?Y(p):Y(K,!1)})}var Z=s(_,2),Ce=a(Z),j=s(I,2);{var U=Y=>{var N=$s(),fe=P(N);{var ae=L=>{var W=ys(),ee=a(W),w=a(ee),F=s(ee,2),z=a(F);m(()=>{b(w,`◀ ${t().psL??""}`),b(z,`${t().psR??""} ▶`)}),r(L,W)};C(fe,L=>{var W;(W=t().origin.monsterCategories)!=null&&W.includes("Pendulum")&&L(ae)})}var Te=s(fe,2);{var E=L=>{var W=ws(),ee=P(W),w=a(ee);ce(w,1,()=>t().attr,_e,(D,v)=>{var y=hs(),H=P(y),G=s(H,2),De=a(G);m(()=>{Ae(H,`monster_attr ${e(v)??""} svelte-1uevs9j`),b(De,`${Sa[e(v)]??""}属性`)}),r(D,y)});var F=s(w,2);ce(F,1,()=>t().types,_e,(D,v)=>{var y=bs(),H=a(y);m(()=>{Ae(y,`monster_cat ${e(v)??""} svelte-1uevs9j`),b(H,`${ga[e(v)]??""}${Ma[e(v)]??""}族`)}),r(D,y)});var z=s(F,4),Q=a(z),X=s(z,2);{var ue=D=>{var v=ks(),y=s(P(v),2),H=a(y);m(()=>b(H,t().def??"?")),r(D,v)};C(X,D=>{var v;(v=t().status.monsterCategories)!=null&&v.includes("Link")||D(ue)})}var T=s(ee,2);ce(T,5,()=>t().status.monsterCategories??[],_e,(D,v)=>{var y=xs(),H=a(y);m(()=>{Ae(y,`monster_cat ${e(v)??""} svelte-1uevs9j`),b(H,`${da[e(v)]??""}${_a[e(v)]??""}`)}),r(D,y)}),m(()=>b(Q,t().atk??"?")),r(L,W)},x=L=>{var W=we(),ee=P(W);{var w=z=>{var Q=Cs(),X=s(a(Q),2),ue=a(X);m(()=>b(ue,`${ya[t().status.spellCategory]??""}魔法`)),r(z,Q)},F=z=>{var Q=we(),X=P(Q);{var ue=T=>{var D=Ds(),v=s(a(D),2),y=a(v);m(()=>b(y,`${ha[t().status.trapCategory]??""}罠`)),r(T,D)};C(X,T=>{t().kind==="Trap"&&t().status.trapCategory&&T(ue)},!0)}r(z,Q)};C(ee,z=>{t().kind==="Spell"&&t().status.spellCategory?z(w):z(F,!1)},!0)}r(L,W)};C(Te,L=>{t().kind==="Monster"?L(E):L(x,!1)})}r(Y,N)};C(j,Y=>{o()!=="Debug"&&Y(U)})}var ve=s(M,2),Me=a(ve);{var ge=Y=>{var N=Es(),fe=P(N);{var ae=x=>{var L=Ms(),W=a(L);mt(W,()=>e(g),ee=>{var w=at('"読み込み中"');r(ee,w)},(ee,w)=>{var F=Ss(),z=a(F);m(()=>{var Q;return b(z,(Q=e(w))==null?void 0:Q.pendulumDescription)}),r(ee,F)}),r(x,L)};C(fe,x=>{var L;(L=t().status.monsterCategories)!=null&&L.includes("Pendulum")&&x(ae)})}var Te=s(fe,2),E=a(Te);mt(E,()=>e(g),x=>{var L=at('"読み込み中"');r(x,L)},(x,L)=>{var W=Ts(),ee=a(W);m(()=>{var w;return b(ee,(w=e(L))==null?void 0:w.description)}),r(x,W)}),r(Y,N)},le=Y=>{var N=we(),fe=P(N);{var ae=E=>{var x=we(),L=P(x);{var W=ee=>{var w=As(),F=s(a(w),2);ce(F,5,()=>t().actions,_e,(z,Q)=>{var X=we();const ue=de(()=>e(Q).actionCountUpperBound),T=de(()=>e(Q).actionCount);var D=P(X);{var v=y=>{var H=js(),G=a(H),De=a(G),$e=s(G,2),me=a($e),ie=s($e,4),re=a(ie);m(()=>{b(De,e(Q).title),b(me,e(T)),b(re,e(ue))}),r(y,H)};C(D,y=>{e(ue)!==void 0&&e(T)!==void 0&&y(v)})}r(z,X)}),r(ee,w)};C(L,ee=>{t().actions.some(w=>w.actionCountUpperBoundKey)&&ee(W)})}r(E,x)},Te=E=>{var x=Is(),L=a(x),W=a(L);ce(W,0,()=>["info","status"],_e,(Ye,ke)=>{var Le=qs(),He=P(Le),We=a(He),st=s(He,2);ce(st,1,()=>Object.entries(t()[ke]),_e,(et,$t)=>{let vt=()=>e($t)[0],St=()=>e($t)[1];var jt=Ls(),Yt=a(jt),sa=s(Yt);{var Ut=kt=>{var Mt=Bs(),xt=s(P(Mt));ce(xt,1,St,_e,(ia,na)=>{var h=at();m(k=>b(h,`${k??""},`),[()=>e(na).toString()],de),r(ia,h)}),r(kt,Mt)},Qt=kt=>{var Mt=at();m(xt=>b(Mt,`${xt??""},`),[()=>{var xt;return(xt=St())==null?void 0:xt.toString()}],de),r(kt,Mt)};C(sa,kt=>{Array.isArray(St())?kt(Ut):kt(Qt,!1)})}m(()=>b(Yt,`"${vt()??""}" : `)),r(et,jt)});var Xe=s(st,2);Xe.textContent="},",m(()=>b(We,`"${ke??""}" :{`)),r(Ye,Le)});var ee=s(W,2);ee.textContent='"actions" :[';var w=s(ee,2);ce(w,1,()=>t().actions,_e,(Ye,ke)=>{var Le=Ys(),He=a(Le);m(()=>b(He,`"${e(ke).playType??""} ${e(ke).title??""}",`)),r(Ye,Le)});var F=s(w,2);F.textContent="],";var z=s(F,2);z.textContent='"substituteEffects" :[';var Q=s(z,2);ce(Q,1,()=>t().substituteEffects,_e,(Ye,ke)=>{var Le=Us(),He=a(Le);m(()=>b(He,`"${e(ke).title??""}",`)),r(Ye,Le)});var X=s(Q,2);X.textContent="],";var ue=s(X,2);ue.textContent='"continuousEffects" :[';var T=s(ue,2);ce(T,1,()=>t().continuousEffects,_e,(Ye,ke)=>{var Le=Hs(),He=a(Le);m(()=>b(He,`"${e(ke).isStarted??""}",`)),r(Ye,Le)});var D=s(T,2);D.textContent="],";var v=s(D,2);v.textContent='"procFilters" :[';var y=s(v,2);ce(y,1,()=>t().procFilterBundle.operators,_e,(Ye,ke)=>{var Le=Ps(),He=a(Le);m(We=>b(He,`"${We??""} ${e(ke).title??""} ${e(ke).isEffective??""} ",`),[()=>e(ke).isSpawnedBy.toString()],de),r(Ye,Le)});var H=s(y,2);H.textContent="],";var G=s(H,2);G.textContent='"numericStateOperators" :[';var De=s(G,2);ce(De,1,()=>t().numericOprsBundle.operators,_e,(Ye,ke)=>{var Le=Ns(),He=a(Le);m(We=>b(He,`"${We??""} ${e(ke).title??""} ${e(ke).isEffective??""} ${e(ke).isContinuous??""} ${e(ke).targetState??""} ${e(ke).targetStateGen??""} ",`),[()=>e(ke).isSpawnedBy.toString()],de),r(Ye,Le)});var $e=s(De,2);$e.textContent="],";var me=s($e,2);me.textContent='"stateOperators" :[';var ie=s(me,2);ce(ie,1,()=>t().statusOperatorBundle.operators,_e,(Ye,ke)=>{var Le=Fs(),He=a(Le);m(We=>b(He,`"${We??""} ${e(ke).title??""} ${e(ke).isEffective??""} ",`),[()=>e(ke).isSpawnedBy.toString()],de),r(Ye,Le)});var re=s(ie,2);re.textContent="],";var te=s(re,2);te.textContent='"lastMoveLogRecord" :{';var Se=s(te,2),Re=a(Se),Ie=s(Se,2),Ke=a(Ie),Ue=s(Ie,2),Ge=a(Ue),lt=s(Ue,2);lt.textContent="},",m((Ye,ke)=>{b(Re,`"movedBy":"${Ye??""}",`),b(Ke,`"movedAs":"${ke??""}",`),b(Ge,`"movedAt":"${t().moveLog.latestRecord.movedAt.totalProcSeq??""}",`)},[()=>{var Ye;return(Ye=t().moveLog.latestRecord.movedBy)==null?void 0:Ye.toString()},()=>t().moveLog.latestRecord.movedAs.join(" ")],de),r(E,x)};C(fe,E=>{o()==="Detail"?E(ae):E(Te,!1)},!0)}r(Y,N)};C(Me,Y=>{o()==="Normal"?Y(ge):Y(le,!1)})}var se=s(ve,2),Ee=a(se);{var ye=Y=>{var N=Vs(),fe=P(N);{var ae=L=>{var W=Os();r(L,W)};C(fe,L=>{t().origin.isOldVersion&&L(ae)})}var Te=s(fe,2);{var E=L=>{var W=Rs();r(L,W)},x=L=>{var W=zs(),ee=a(W);{var w=Q=>{var X=Ks();const ue=de(()=>t().entityType==="Card"?t():t().parent);var T=a(X);m(D=>{var v;rt(X,"href",D),b(T,`⇒${((v=e(ue))!=null&&v.origin.cardId?"公式カードページ":"公式で検索")??""}`)},[c],de),r(Q,X)};C(ee,Q=>{var X;t()&&(t().entityType==="Card"||((X=t().parent)==null?void 0:X.entityType)==="Card")&&Q(w)})}var F=s(ee,2);mt(F,()=>e(g),null,(Q,X)=>{var ue=we(),T=P(ue);{var D=v=>{var y=Ws();m(()=>rt(y,"href",`https://yugioh-wiki.net/index.php?${e(X).wikiEncodedName}`)),r(v,y)};C(T,v=>{e(X)&&e(X).wikiEncodedName&&v(D)})}r(Q,ue)});var z=s(F,2);m(()=>rt(z,"href",`https://www.google.com/search?q=遊戯王 ${t().origin.name}`)),r(L,W)};C(Te,L=>{t().origin.isForTest?L(E):L(x,!1)})}r(Y,N)};C(Ee,Y=>{t()&&Y(ye)})}m((Y,N)=>{Ae(S,`duel_card duel_card_info ${t().origin.kind??""} ${Y??""} svelte-1uevs9j`),b(R,t().nm),b(Ce,N)},[()=>{var Y;return(Y=t().origin.monsterCategories)==null?void 0:Y.join(" ")},()=>"★".repeat(t().lvl||0)],de),r(A,S)};C(d,A=>{t()&&A(B)})}r(f,u),ut()}za(["click","contextmenu"]);var Qs=l('<div class="duel_field_cell_info_item svelte-1xj7qf1"><!></div>'),Js=l('<div class="duel_field_cell_info_box svelte-1xj7qf1"><div class="duel_field_cell_info_label svelte-1xj7qf1"> </div> <!></div>'),Zs=l('<div class="duel_field_cell_info svelte-1xj7qf1"><div class="duel_field_cell_info_header item_btn svelte-1xj7qf1"><div class="svelte-1xj7qf1"> </div> <div class="svelte-1xj7qf1"> </div></div> <div class="duel_field_cell_info_body svelte-1xj7qf1"></div></div>');function ei(f,i){ct(i,!1);let t=je(i,"cell",12);const o=()=>{t(t())},g=B=>t().cardEntities.filter(A=>A.face===B);t().field.duel.view.onDuelUpdate.append(o),_t();var c=we(),u=P(c);{var d=B=>{var A=Zs(),S=a(A),M=a(S),n=a(M),q=s(M,2),R=a(q),I=s(S,2);ce(I,4,()=>["FaceUp","FaceDown"],_e,(_,p)=>{var K=we(),Z=P(K);{var Ce=j=>{var U=Js(),ve=a(U),Me=a(ve),ge=s(ve,2);ce(ge,1,()=>g(p).toSorted(lr),_e,(le,se)=>{var Ee=Qs(),ye=a(Ee);const Y=de(()=>t().owner===t().field.duel.duelists.Below);Vt(ye,{get entity(){return e(se)},get isVisibleForcibly(){return e(Y)},isWideMode:!0,cardActionResolve:void 0}),r(le,Ee)}),m(()=>b(Me,p==="FaceUp"?"表向き":"裏向き")),r(j,U)};C(Z,j=>{g(p).length&&j(Ce)})}r(_,K)}),m(()=>{var _;b(n,(_=t().owner)==null?void 0:_.profile.name),b(R,t().cellType)}),r(B,A)};C(u,B=>{t().field.duel.view.infoBoardState==="CellInfo"&&B(d)})}r(f,c),ut()}var ti=l('<div class="duel_config_item svelte-y4u26k"><label class="toggle svelte-y4u26k"><input type="checkbox" class="svelte-y4u26k"></label> <span class="svelte-y4u26k"> </span></div>'),ai=l('<div class="duel_config svelte-y4u26k"><div class="duel_config_title svelte-y4u26k">デュエル設定</div> <div class="duel_config_group svelte-y4u26k"><div class="duel_config_group_title svelte-y4u26k">チェーン設定</div> <!></div></div>');function ri(f,i){ct(i,!1);let t=je(i,"viewController",8),o=je(i,"userProfile",12);_t();var g=we(),c=P(g);{var u=d=>{var B=ai(),A=s(a(B),2),S=s(a(A),2);ce(S,1,()=>vr,_e,(M,n)=>{var q=ti(),R=a(q),I=a(R),_=s(R,2),p=a(_);m(()=>b(p,or[e(n)])),dr(I,()=>o().chainConfig[e(n)],K=>o(o().chainConfig[e(n)]=K,!0)),V("change",I,()=>o().save()),r(M,q)}),r(d,B)};C(c,d=>{t().infoBoardState==="Config"&&d(u)})}r(f,g),ut()}function si(f,{from:i,to:t},o={}){var{delay:g=0,duration:c=U=>Math.sqrt(U)*120,easing:u=wa}=o,d=getComputedStyle(f),B=d.transform==="none"?"":d.transform,[A,S]=d.transformOrigin.split(" ").map(parseFloat);A/=f.clientWidth,S/=f.clientHeight;var M=ii(f),n=f.clientWidth/t.width/M,q=f.clientHeight/t.height/M,R=i.left+i.width*A,I=i.top+i.height*S,_=t.left+t.width*A,p=t.top+t.height*S,K=(R-_)*n,Z=(I-p)*q,Ce=i.width/t.width,j=i.height/t.height;return{delay:g,duration:typeof c=="function"?c(Math.sqrt(K*K+Z*Z)):c,easing:u,css:(U,ve)=>{var Me=ve*K,ge=ve*Z,le=U+ve*Ce,se=U+ve*j;return`transform: ${B} translate(${Me}px, ${ge}px) scale(${le}, ${se});`}}}function ii(f){if("currentCSSZoom"in f)return f.currentCSSZoom;for(var i=f,t=1;i!==null;)t*=+getComputedStyle(i).zoom,i=i.parentElement;return t}var ni=l('<div class="chain_number svelte-lqu21u"> </div>'),li=l('<div class="duel_card_row svelte-lqu21u"> </div>'),oi=l('<div class="appendix svelte-lqu21u"> </div>'),di=l('<div class="appendix_wrapper svelte-lqu21u"></div>'),vi=l('<div><div><!> <div> </div> <div><!> <div class="duel_card_row svelte-lqu21u"><div> </div> <!></div></div></div></div>'),ci=l("<div></div>");function _i(f,i){ct(i,!1);let t=je(i,"duel",8),o=je(i,"position",8,"left");const g=-100,c=()=>o()==="left"?-100:100;let u=ne([]),d=Promise.resolve(),B=Promise.resolve();const A=1e3,S=500,M=400,n=R=>{const I={...R};I.isKnown=R.chainBlockInfo.action.entity.controller.duelistType==="Player"||R.chainBlockInfo.action.entity.face==="FaceUp",I.chainBlockInfo.onStateChange.append(_=>{if(_==="done"||_==="failed"||_==="negated")return d=d.then(async()=>{const p=new Date().getTime()-I.chainBlockInfo.wasSpawnedAt.getTime();p<A&&await ea(A-p),$(u,e(u).filter(K=>K.seq!==I.seq)),await ea(S+M)}).then(),"RemoveMe";$(u,e(u))}),B=B.then(async()=>{$(u,[I,...e(u)].sort((_,p)=>cr.isSameChain(_.clock,p.clock)&&_.chainBlockInfo.action.isWithChainBlock&&p.chainBlockInfo.action.isWithChainBlock?p.clock.totalProcSeq-_.clock.totalProcSeq:_.clock.totalProcSeq-p.clock.totalProcSeq)),await ea(300)}),d=d.then(()=>ea(1e3))};t().chainBlockLog.onInsert.append(n),_t();var q=ci();ce(q,13,()=>e(u),R=>R.seq,(R,I)=>{var _=vi();const p=de(()=>{const{activator:N,action:fe,appendix:ae}=e(I).chainBlockInfo;return{activator:N,action:fe,appendix:ae}});var K=a(_),Z=a(K);{var Ce=N=>{var fe=ni(),ae=a(fe);m(()=>b(ae,`チェーン：${e(I).chainBlockInfo.chainNumber??""}`)),r(N,fe)};C(Z,N=>{e(I).chainBlockInfo.chainNumber&&N(Ce)})}var j=s(Z,2),U=a(j),ve=s(j,2),Me=a(ve);{var ge=N=>{var fe=li(),ae=a(fe);m(()=>b(ae,e(I).isKnown?e(p).action.entity.nm:"？？？")),r(N,fe)};C(Me,N=>{(e(p).action.entity.entityType==="Card"||e(p).action.entity.entityType==="Token")&&N(ge)})}var le=s(Me,2),se=a(le),Ee=a(se),ye=s(se,2);{var Y=N=>{var fe=di();ce(fe,5,()=>e(p).appendix,_e,(ae,Te)=>{var E=oi(),x=a(E);m(()=>b(x,e(Te))),r(ae,E)}),r(N,fe)};C(ye,N=>{e(p).appendix&&N(Y)})}m((N,fe,ae)=>{Ae(_,`cut_in_row ${(!e(I).chainBlockInfo.chainNumber||e(I).chainBlockInfo.chainNumber===1?"cut_in_row_first":"")??""} svelte-lqu21u`),Ae(K,`cut_in_item cut_in_item_${N??""} cut_in_item_${e(I).chainBlockInfo.state??""} svelte-lqu21u`),Ae(j,`duelist_name duelist_${N??""}_name svelte-lqu21u`),b(U,e(p).activator.profile.name),Ae(ve,`duel_card duel_card_${N??""} ${fe??""} ${(e(I).isKnown?e(p).action.entity.origin.kind:"")??""} ${e(p).action.entity.entityType??""}  svelte-lqu21u`),b(Ee,ae)},[()=>e(p).activator.seat.toLowerCase(),()=>e(I).isKnown?(e(p).action.entity.status.monsterCategories??[]).join(" "):"Token",()=>e(p).action.toString()],de),oe(3,K,()=>Ar,()=>new Date().getTime()-e(I).chainBlockInfo.wasSpawnedAt.getTime()<A?{x:c(),duration:M}:{y:g,duration:M}),_r(_,()=>si,()=>({duration:S})),r(R,_)}),m(()=>Ae(q,`cut_in_container cut_in_container_${o()??""} svelte-lqu21u`)),r(f,q),ut()}const ui=Br({duration:400});var fi=l('<div class="duel_desk_left v_flex svelte-1w535im"><!> <!> <!></div>'),mi=l('<button class="duel_field_header_message svelte-1w535im"> </button> <div class="duel_field_header_buttons svelte-1w535im"><button class="svelte-1w535im">サレンダー</button></div>',1),pi=l("<tr></tr>"),gi=l('<table class="duel_field svelte-1w535im"><tbody class="svelte-1w535im"></tbody></table>'),yi=l('<button class="svelte-1w535im">OK</button>'),hi=l('<button class="svelte-1w535im">cancel</button>'),bi=l("<!> <!>",1),ki=l('<button class="svelte-1w535im"> </button>'),xi=l('<div style="text-align: left;"><!> <!> <!></div>'),wi=l('<div><!> <div class=" duel_desk_center v_flex svelte-1w535im"><div class="duel_field_header svelte-1w535im"><!></div> <div class="duel_field_body svelte-1w535im"><!></div> <div class="duel_field_footer svelte-1w535im"><!></div></div> <!></div> <div style="position:fixed;bottom:0"> </div> <!> <div><!></div>',1);function Ci(f,i){ct(i,!1);let t=je(i,"duel",12),o=je(i,"userProfile",8),g=ne(0),c=ne(0),u=ne([]),d=ne([]),B=()=>{},A=ne([]),S=ne(),M=ne(),n=ne(()=>!1),q=ne(!1);const R=v=>{B=v.resolve,$(A,v.dummyActionInfos.filter(y=>y.action.entity.entityType==="Duelist").filter(y=>y.action.entity.controller.seat==="Below")),$(S,void 0),$(M,void 0),$(d,[]),$(u,[]),$(q,!1),v.entitiesChoices&&($(S,v.entitiesChoices),$(n,()=>{var y;return((y=v.entitiesChoices)==null?void 0:y.validator(e(u)))??!1}),$(q,v.entitiesChoices.cancelable),e(S).selectables.every(y=>y.cell.isPlayFieldCell&&y.getIndexInCell()===0||y.cell.cellType==="Hand"&&y.controller.duelistType==="Player"||y.entityType==="Duelist")||t().view.modalController.entitySelector.show({title:t().view.message,position:"Middle",entitiesChoices:v.entitiesChoices,chainBlockInfos:v.chainBlockInfos,cancelable:v.entitiesChoices.cancelable}).then(y=>{B({selectedEntities:y})})),v.cellsChoices&&($(M,v.cellsChoices),$(n,()=>{var y;return((y=v.cellsChoices)==null?void 0:y.validator(e(d)))??!1}),$(q,v.cellsChoices.cancelable))};t().view.onWaitStart.append(R);const I=()=>{B=()=>{},$(M,void 0),$(S,void 0),$(d,[]),$(u,[]),$(n,()=>!1),$(q,!1)};t().view.onWaitEnd.append(I);let _=ne(void 0),p=ne("Normal");const K=({card:v,mode:y})=>{$(_,v),$(p,y??(e(_)===v||e(p)==="Normal"?"Detail":"Normal"))};t().view.onShowCardEntity.append(K);const Z=()=>{t(t())};t().view.onDuelUpdate.append(Z),t().log.onUpdate.append(Z);const Ce=()=>{e(S)&&e(S).validator(e(u))&&B({selectedEntities:e(u)}),e(M)&&e(M).validator(e(d))&&B({selectedCells:e(d)})},j=()=>{B({})},U=v=>{B({actionInfo:v})},ve=()=>{B({surrender:!0})};t().main();const Me=()=>e(g)<=1400?"compact":"wide";_t();var ge=wi(),le=P(ge),se=a(le);{var Ee=v=>{var y=fi(),H=a(y);Ka(H,{get duelist(){return t().duelists.Above}});var G=s(H,2);{var De=me=>{Gs(me,{get entity(){return e(_)},get mode(){return e(p)}})};C(G,me=>{e(_)&&me(De)})}var $e=s(G,2);Ka($e,{get duelist(){return t().duelists.Below}}),r(v,y)};C(se,v=>{Me()==="wide"&&v(Ee)})}var ye=s(se,2),Y=a(ye),N=a(Y);{var fe=v=>{var y=mi(),H=P(y),G=a(H),De=s(H,2),$e=a(De);m(()=>b(G,`[TURN:${t().clock.turn}][PHASE:${t().phase}] ${t().view.message}`)),V("click",H,()=>{t(t().view.infoBoardState="Log",!0)}),V("click",$e,ve),r(v,y)};C(N,v=>{t().isEnded||v(fe)})}var ae=s(Y,2),Te=a(ae);{var E=v=>{var y=gi(),H=a(y);ce(H,5,()=>t().field.cells,_e,(G,De,$e)=>{var me=pi();Ae(me,`${`duel_desk_row_${$e}`??""} svelte-1w535im`),ce(me,5,()=>e(De),_e,(ie,re,te)=>{es(ie,{get view(){return t().view},row:$e,column:te,get selectedEntities(){return e(u)},set selectedEntities(Se){$(u,Se)},get selectedCells(){return e(d)},set selectedCells(Se){$(d,Se)},$$legacy:!0})}),r(G,me)}),r(v,y)};C(Te,v=>{t().clock.turn>0&&v(E)})}var x=s(ae,2),L=a(x);{var W=v=>{var y=bi(),H=P(y);{var G=me=>{var ie=yi();m(re=>ie.disabled=re,[()=>!e(n)()],de),V("click",ie,Ce),r(me,ie)};C(H,me=>{((e(S)&&e(S).qty)??(e(M)&&e(M).qty)??9999)>1&&me(G)})}var De=s(H,2);{var $e=me=>{var ie=hi();V("click",ie,j),r(me,ie)};C(De,me=>{e(q)&&me($e)})}r(v,y)},ee=v=>{var y=we(),H=P(y);ce(H,1,()=>e(A),_e,(G,De)=>{var $e=ki(),me=a($e);m(()=>b(me,e(De).action.title)),V("click",$e,()=>U(e(De))),r(G,$e)}),r(v,y)};C(L,v=>{e(S)&&e(S).selectables.length||e(M)&&e(M).selectables?v(W):v(ee,!1)})}var w=s(ye,2);{var F=v=>{var y=xi(),H=a(y);cs(H,{get log(){return t().log}});var G=s(H,2);ei(G,{get cell(){return t().view.infoBoardCell}});var De=s(G,2);ri(De,{get userProfile(){return o()},get viewController(){return t().view}}),m($e=>Ae(y,`duel_desk_right duel_desk_right_${$e??""}  svelte-1w535im`),[()=>t().view.infoBoardState.toLowerCase()],de),oe(3,y,()=>xe,()=>({duration:e(g)>1400?0:200,axis:"x"})),r(v,y)};C(w,v=>{(e(g)>1400||t().view.infoBoardState!=="Default")&&v(F)})}var z=s(le,2),Q=a(z),X=s(z,2);ur(X,{get modalController(){return t().view.modalController}});var ue=s(X,2),T=a(ue);const D=de(()=>Me()==="wide"?"right":"left");_i(T,{get duel(){return t()},get position(){return e(D)}}),m((v,y)=>{Ae(le,`flex duel_desk ${v??""}_mode svelte-1w535im`),b(Q,y),Ae(ue,`cutin ${v??""}_mode svelte-1w535im`)},[Me,()=>t().clock.toFullString()],de),ua("innerWidth",v=>$(g,v)),ua("innerHeight",v=>$(c,v)),r(f,ge),ut()}var Di=l("<div></div>"),$i=l("<!> <!> <!> <!>",1),Si=l('<span class="atk svelte-1y1qbq4"> </span> <span class="slash svelte-1y1qbq4">/</span> <span class="def svelte-1y1qbq4"> </span>',1),Mi=l('<div role="listitem"><div class="svelte-1y1qbq4"><div class="duel_card_row card_name svelte-1y1qbq4"> </div> <div style="display:flex; flex-wrap: wrap;" class="svelte-1y1qbq4"><div style="" class="svelte-1y1qbq4"><!> <!> <!></div> <div class="atk_def svelte-1y1qbq4"><!></div></div></div></div>');function Ja(f,i){ct(i,!1);let t=je(i,"mode",8),o=je(i,"cardInfo",8),g=je(i,"onAttention",8),c=je(i,"cardControlEventHandlers",8);_t();var u=Mi(),d=a(u),B=a(d),A=a(B),S=s(B,2),M=a(S),n=a(M);{var q=j=>{var U=$i(),ve=P(U);{var Me=ye=>{var Y=at();m(()=>b(Y,`★${o().level??""}`)),r(ye,Y)},ge=ye=>{var Y=we(),N=P(Y);{var fe=Te=>{var E=at();m(()=>b(E,`☆${o().rank??""}`)),r(Te,E)},ae=Te=>{var E=we(),x=P(E);{var L=W=>{var ee=at();m(()=>b(ee,`Ｌ${o().link??""}`)),r(W,ee)};C(x,W=>{o().link&&W(L)},!0)}r(Te,E)};C(N,Te=>{o().rank?Te(fe):Te(ae,!1)},!0)}r(ye,Y)};C(ve,ye=>{o().level?ye(Me):ye(ge,!1)})}var le=s(ve,2);ce(le,1,()=>o().attributes??[],_e,(ye,Y)=>{var N=Di();m(()=>Ae(N,`monster_attr ${e(Y)??""} svelte-1y1qbq4`)),r(ye,N)});var se=s(le,2);ce(se,1,()=>o().types??[],_e,(ye,Y)=>{var N=at();m(()=>b(N,ga[e(Y)])),r(ye,N)});var Ee=s(se,2);ce(Ee,1,()=>o().monsterCategories??[],_e,(ye,Y)=>{var N=at();m(()=>b(N,da[e(Y)])),r(ye,N)}),r(j,U)};C(n,j=>{o().kind==="Monster"&&j(q)})}var R=s(n,2);{var I=j=>{var U=at();m(()=>b(U,`${ya[o().spellCategory]??""}魔法`)),r(j,U)};C(R,j=>{o().spellCategory&&j(I)})}var _=s(R,2);{var p=j=>{var U=at();m(()=>b(U,`${ha[o().trapCategory]??""}罠`)),r(j,U)};C(_,j=>{o().trapCategory&&j(p)})}var K=s(M,2),Z=a(K);{var Ce=j=>{var U=Si(),ve=P(U),Me=a(ve),ge=s(ve,4),le=a(ge);m(()=>{b(Me,o().attack??"?"),b(le,o().defense??"?")}),r(j,U)};C(Z,j=>{o().kind==="Monster"&&j(Ce)})}m(j=>{Ae(u,`${j??""} svelte-1y1qbq4`),b(A,o().name)},[()=>{var j,U;return`deck_editor_card duel_card ${o().kind} ${(U=(j=o())==null?void 0:j.monsterCategories)==null?void 0:U.join(" ")} ${o().isImplemented?"is_implemented":"is_not_implemented"}`}],de),V("click",u,()=>g()(o())),V("touchstart",u,j=>c().onCardDragStart(j,t(),o())),V("touchmove",u,j=>c().onCardDragging(j,t())),V("touchend",u,function(...j){var U;(U=c().onCardDragEnd)==null||U.apply(this,j)}),V("touchcancel",u,function(...j){var U;(U=c().onCardDragCancel)==null||U.apply(this,j)}),V("mousedown",u,j=>c().onCardDragStart(j,t(),o())),V("mousemove",u,j=>c().onCardDragging(j,t())),V("mouseup",u,function(...j){var U;(U=c().onCardDragEnd)==null||U.apply(this,j)}),r(f,u),ut()}var Ti=l('<button class="button_style_reset plus_minus_button svelte-1ty6ui7">+</button> <button class="button_style_reset plus_minus_button svelte-1ty6ui7">-</button>',1),Ei=l('<li class="deck_editor_item svelte-1ty6ui7"><!> <!></li>'),ji=l('<div class="deck_editor_card_list_wrapper svelte-1ty6ui7"><ul></ul></div>');function Ai(f,i){ct(i,!1);let t=je(i,"cardList",8),o=je(i,"mode",8),g=je(i,"state",8),c=je(i,"onAttention",8),u=je(i,"cardControlEventHandlers",8);const d=20;let B=ne(0),A=ne(d),S=ne(0),M=ne(0),n=ne(0),q=ne();ca(()=>(e(q),Kt(o()),Kt(t()),e(n),e(M),Kt(g())),()=>{if(e(q))if(be(q,e(q).scrollTop=0),o()==="List"){const _=t().length>d?d:t().length;e(n)||($(M,e(q).scrollHeight/_),$(n,Math.ceil(e(M)))),console.log(g(),t().length),t().length>d?$(S,e(n)*(t().length-d*2)+Math.ceil(e(M)*(d*2-1))):$(S,e(n)*t().length)}else $(A,t().length)}),$a(),_t();var R=ji(),I=a(R);ce(I,5,t,_e,(_,p,K)=>{var Z=we(),Ce=P(Z);{var j=U=>{var ve=Ei(),Me=a(ve);Ja(Me,{get mode(){return o()},get cardInfo(){return e(p)},get onAttention(){return c()},get cardControlEventHandlers(){return u()}});var ge=s(Me,2);{var le=se=>{var Ee=Ti(),ye=P(Ee),Y=s(ye,2);m(N=>{ye.disabled=!e(p).isImplemented,rt(ye,"title",e(p).isImplemented?`※shiftキー同時押しで一括投入
※ctrlキー同時押しで枚数制限無視`:""),Y.disabled=N,rt(Y,"title",e(p).isImplemented?"※shiftキー同時押しで一括外し":"")},[()=>t().every(N=>N.name!==e(p).name)],de),V("click",ye,N=>u().onCardAppend(N,e(p))),V("click",Y,N=>u().onCardRemove(N,e(p))),r(se,Ee)};C(ge,se=>{o()==="Deck"&&se(le)})}r(U,ve)};C(Ce,U=>{K>=e(B)&&K<=e(A)&&U(j)})}r(_,Z)}),Va(I,_=>$(q,_),()=>e(q)),m(_=>{Ae(I,`deck_editor_card_list ${_??""}  indexLowerBound_${e(B)??""} indexUpperBound=${e(A)??""} svelte-1ty6ui7`),rt(I,"style",`height: ${(e(S)?e(S)+"px":"fit-content")??""};padding-top: ${e(B)*e(n)}px`)},[()=>g().toLowerCase()],de),V("scroll",R,_=>{if(!e(n))return;const p=Math.ceil(_.currentTarget.scrollTop/e(n));$(B,p<d?0:p-d),$(A,p+d)}),r(f,R),ut()}var Bi=l('<div class="svelte-m6gfl0"><button class="button_style_reset svelte-m6gfl0">クリア</button></div>'),Li=l('<div class="deck_editor_card_kind_header svelte-m6gfl0"><div class="svelte-m6gfl0"> <!> 枚）</div> <div style="display: flex;" class="svelte-m6gfl0"><!> <div class="triangle svelte-m6gfl0">▲</div></div></div> <div class="deck_editor_card_kind_body svelte-m6gfl0"><!></div>',1),qi=l("<div><!></div>"),Yi=l('<div class="deck_editor_card_list svelte-m6gfl0"></div>');function Wa(f,i){ct(i,!1);let t=je(i,"allCardTree",8),o=je(i,"deckCardTree",12),g=je(i,"mode",8),c=je(i,"onAttention",8),u=je(i,"searchCondition",8,void 0),d=je(i,"cardControlEventHandlers",8),B=ne("ExtraMonster");const A=ne(g()==="List"?t():o()),S=(..._)=>{const p=_.length?_:Xt(e(A)),K=(Z,Ce)=>{var j;return Qa(Z,Ce,(j=u())==null?void 0:j.sort.filter(U=>U.priority>0).toSorted((U,ve)=>U.priority-ve.priority))};p.forEach(Z=>e(A)[Z].sort(K))},M=(_,p)=>{o(o()[p]=[],!0)};let n=ne(structuredClone(e(A))),q=ne("");const R=_=>{if(!u())return!0;if(_.kind==="XyzMaterial")return!1;const p=fa(_);if(!u().deckCardKinds.includes(p)||u().name.trim().length&&[_.name,..._.nameTags??[],..._.textTags??[]].every(Z=>!Z.includes(u().name))||!_.isImplemented&&!u().others.includes("implemented")||_.isForTest&&!u().others.includes("test")||_.isOldVersion&&!u().others.includes("oldVersion"))return!1;if(_.kind==="Monster"){if(_.attributes&&!u().monsterAttributes.union(_.attributes).length||_.types&&!u().monsterTypes.union(_.types).length)return!1;const K=_.level??_.rank??_.link;return Lt(u().starLowerBound)&&(K??0)<u().starLowerBound||Lt(u().starUpperBound)&&(K??0)>u().starUpperBound||Lt(u().atkLowerBound)&&(_.attack??0)<u().atkLowerBound||Lt(u().atkUpperBound)&&(_.attack??0)>u().atkUpperBound||Lt(u().defLowerBound)&&(_.defense??0)<u().defLowerBound||Lt(u().defUpperBound)&&(_.defense??0)>u().defUpperBound||Lt(u().atkPlusDef)&&(!Lt(_.attack)||!Lt(_.defense)||_.attack+_.defense!==u().atkPlusDef)||!_.monsterCategories||p==="ExtraMonster"&&!_.monsterCategories.union(u().exMonsterCategories).length?!1:_.monsterCategories.union(u().monsterCategories).length}if(_.kind==="Spell")return _.spellCategory&&u().spellCategories.includes(_.spellCategory);if(_.kind==="Trap")return _.trapCategory&&u().trapCategories.includes(_.trapCategory)};ca(()=>(Kt(g()),e(A),Kt(o()),e(B),e(n)),()=>{if(g()==="Deck"){if(Xt(e(A)).forEach(_=>be(A,e(A)[_]=o()[_])),!e(A)[e(B)].length)$(B,Xt(e(A)).find(_=>e(A)[_].find(R))??"ExtraMonster");else{const _=Xt(e(A)).map(p=>({kind:p,cardInfos:e(A)[p]})).filter(({cardInfos:p})=>p.length).find(({kind:p,cardInfos:K})=>K.length!==e(n)[p].length);_&&e(B)!==_.kind&&$(B,_.kind)}$(n,structuredClone(e(A)))}}),ca(()=>(Kt(g()),Kt(u()),e(q)),()=>{var _;if(g()==="List"){const p=JSON.stringify((_=u())==null?void 0:_.sort);e(q)!==p&&($(q,p),S())}}),$a(),_t();var I=Yi();ce(I,5,()=>ta,_e,(_,p,K)=>{var Z=qi();const Ce=de(()=>e(A)[e(p)].filter(R));var j=a(Z);{var U=ve=>{var Me=Li(),ge=P(Me),le=a(ge),se=a(le),Ee=s(se);{var ye=x=>{var L=at();m(W=>b(L,`/ ${W??""}`),[()=>e(A)[e(p)].length.toLocaleString()],de),r(x,L)};C(Ee,x=>{g()==="List"&&x(ye)})}var Y=s(le,2),N=a(Y);{var fe=x=>{var L=Bi(),W=a(L);V("click",W,ee=>M(ee,e(p))),r(x,L)};C(N,x=>{g()==="Deck"&&e(Ce).length&&x(fe)})}var ae=s(ge,2),Te=a(ae);const E=de(()=>e(B)===e(p)?"Open":"Close");Ai(Te,{get mode(){return g()},get cardList(){return e(Ce)},get onAttention(){return c()},get cardControlEventHandlers(){return d()},get state(){return e(E)}}),m(x=>b(se,`${Ga[e(p)]??""}（${x??""} `),[()=>e(Ce).length.toLocaleString()],de),V("click",ge,()=>{if(e(B)!==e(p)){$(B,e(p));return}$(B,ta.map((x,L)=>L+K).map(x=>x%ta.length).map(x=>ta[x]).filter(x=>x!==e(p)).find(x=>e(A)[x].find(R))??e(p))}),r(ve,Me)};C(j,ve=>{e(Ce).length&&ve(U)})}m(()=>Ae(Z,`deck_editor_card_kind deckCardKind ${(e(p)===e(B)?"selected":"")??""} ${(e(Ce).length?"":"empty")??""} svelte-m6gfl0`)),r(_,Z)}),r(f,I),ut()}var Ui=l('<div class="svelte-7xhk0x"> </div>'),Hi=l('<div class="svelte-7xhk0x"> </div>'),Pi=l('<div class="link_arrow_emoji svelte-7xhk0x"> </div>'),Ni=l('<div class="duel_card_info_row svelte-7xhk0x" style="position:sticky; top:0;"><!></div>'),Fi=l('<div class="duel_card_info_row svelte-7xhk0x"><div class="svelte-7xhk0x"><pre class="description svelte-7xhk0x"> </pre></div></div> <div class="duel_card_info_row svelte-7xhk0x" style=" justify-content: space-between;"><div class="svelte-7xhk0x"> </div> <div class="svelte-7xhk0x"> </div></div>',1),Ii=l('<div></div> <div class="svelte-7xhk0x"> </div>',1),Oi=l("<div> </div>"),Ri=l('<span class="svelte-7xhk0x">/</span> <div class="monster_defense svelte-7xhk0x"> </div>',1),Ki=l("<div> </div>"),Wi=l('<div class="duel_card_info_row svelte-7xhk0x"><!> <!> <div style="flex-grow: 1;" class="svelte-7xhk0x"></div> <div class="monster_attack svelte-7xhk0x"> </div> <!></div> <div class="duel_card_info_row svelte-7xhk0x"></div>',1),zi=l('<div class="duel_card_row svelte-7xhk0x"><div class="svelte-7xhk0x"></div> <div class="svelte-7xhk0x"> </div></div>'),Vi=l('<div class="duel_card_row svelte-7xhk0x"><div class="svelte-7xhk0x"></div> <div class="svelte-7xhk0x"> </div></div>'),Xi=l('<div class="duel_card_info_row svelte-7xhk0x"><div class="svelte-7xhk0x">※エラッタ前カードです</div></div>'),Gi=l('<div class="duel_card_info_row svelte-7xhk0x"><div class="svelte-7xhk0x">※テスト用カードです</div></div>'),Qi=l('<div class="duel_card_info_links svelte-7xhk0x"><a target="_blank" rel="noopener noreferrer" title="コナミカードデータベース" class="svelte-7xhk0x"> </a> <a target="_blank" rel="noopener noreferrer" title="遊戯王カードWiki" class="svelte-7xhk0x">⇒遊戯王カードWiki</a> <a target="_blank" rel="noopener noreferrer" title="google" class="svelte-7xhk0x">⇒google検索</a></div>'),Ji=l('<div><div class="duel_card_info_header svelte-7xhk0x"><div class="duel_card_info_row svelte-7xhk0x"><div class="svelte-7xhk0x"> </div></div> <!> <div class="plus_minus_button_area svelte-7xhk0x"><button class="button_style_reset plus_minus_button svelte-7xhk0x">+</button> <button class="button_style_reset plus_minus_button svelte-7xhk0x">-</button></div></div> <div class="duel_card_info_body svelte-7xhk0x"><!> <!> <div class="duel_card_info_row description svelte-7xhk0x"><div class="svelte-7xhk0x"><pre class="description svelte-7xhk0x"> </pre></div></div> <!> <!></div></div>');function Zi(f,i){ct(i,!1);let t=je(i,"cardInfo",8,void 0),o=je(i,"onAttention",8),g=je(i,"cardControlEventHandlers",8),c=je(i,"deckCardTree",8);_t();var u=we(),d=P(u);{var B=A=>{var S=Ji(),M=a(S),n=a(M),q=a(n),R=a(q),I=s(n,2);{var _=E=>{var x=Ni(),L=a(x);{var W=w=>{var F=Ui(),z=a(F);m(Q=>b(z,Q),[()=>"★".repeat(t().level)],de),r(w,F)},ee=w=>{var F=we(),z=P(F);{var Q=ue=>{var T=Hi(),D=a(T);m(v=>b(D,v),[()=>"★".repeat(t().rank)],de),r(ue,T)},X=ue=>{var T=we(),D=P(T);{var v=y=>{var H=Pi(),G=a(H);m(De=>b(G,De),[()=>t().linkArrowKeys.map(De=>Xa[De].emoji).join("")],de),r(y,H)};C(D,y=>{t().linkArrowKeys&&y(v)},!0)}r(ue,T)};C(z,ue=>{t().rank&&t().rank>0?ue(Q):ue(X,!1)},!0)}r(w,F)};C(L,w=>{t().level&&t().level>0?w(W):w(ee,!1)})}r(E,x)};C(I,E=>{t().kind==="Monster"&&E(_)})}var p=s(I,2),K=a(p),Z=s(K,2),Ce=s(M,2),j=a(Ce);{var U=E=>{var x=Fi(),L=P(x),W=a(L),ee=a(W),w=a(ee),F=s(L,2),z=a(F),Q=a(z),X=s(z,2),ue=a(X);m(()=>{b(w,t().pendulumDescription),b(Q,`◀ ${t().pendulumScaleL??""}`),b(ue,`${t().pendulumScaleR??""} ▶`)}),r(E,x)};C(j,E=>{var x;(x=t().monsterCategories)!=null&&x.includes("Pendulum")&&E(U)})}var ve=s(j,2);{var Me=E=>{var x=Wi(),L=P(x),W=a(L);{var ee=D=>{var v=Ii(),y=P(v),H=s(y,2),G=a(H);m(()=>{Ae(y,`monster_attr ${t().attributes[0]??""} svelte-7xhk0x`),b(G,`${Sa[t().attributes[0]]??""}属性`)}),r(D,v)};C(W,D=>{t().attributes&&D(ee)})}var w=s(W,2);{var F=D=>{var v=Oi(),y=a(v);m(()=>{Ae(v,`monster_cat ${t().types[0]??""} svelte-7xhk0x`),b(y,`${ga[t().types[0]]??""}${Ma[t().types[0]]??""}族`)}),r(D,v)};C(w,D=>{t().types&&D(F)})}var z=s(w,4),Q=a(z),X=s(z,2);{var ue=D=>{var v=Ri(),y=s(P(v),2),H=a(y);m(()=>b(H,t().defense??"?")),r(D,v)};C(X,D=>{var v;(v=t().monsterCategories)!=null&&v.includes("Link")||D(ue)})}var T=s(L,2);ce(T,5,()=>t().monsterCategories??[],_e,(D,v)=>{var y=Ki(),H=a(y);m(()=>{Ae(y,`monster_cat ${e(v)??""} svelte-7xhk0x`),b(H,`${da[e(v)]??""}${_a[e(v)]??""}`)}),r(D,y)}),m(()=>b(Q,t().attack??"?")),r(E,x)},ge=E=>{var x=we(),L=P(x);{var W=w=>{var F=zi(),z=s(a(F),2),Q=a(z);m(()=>b(Q,`${ya[t().spellCategory]??""}魔法`)),r(w,F)},ee=w=>{var F=we(),z=P(F);{var Q=X=>{var ue=Vi(),T=s(a(ue),2),D=a(T);m(()=>b(D,`${ha[t().trapCategory]??""}罠`)),r(X,ue)};C(z,X=>{t().kind==="Trap"&&t().trapCategory&&X(Q)},!0)}r(w,F)};C(L,w=>{t().kind==="Spell"&&t().spellCategory?w(W):w(ee,!1)},!0)}r(E,x)};C(ve,E=>{t().kind==="Monster"?E(Me):E(ge,!1)})}var le=s(ve,2),se=a(le),Ee=a(se),ye=a(Ee),Y=s(le,2);{var N=E=>{var x=Xi();r(E,x)};C(Y,E=>{t().isOldVersion&&E(N)})}var fe=s(Y,2);{var ae=E=>{var x=Gi();r(E,x)},Te=E=>{var x=Qi(),L=a(x),W=a(L),ee=s(L,2),w=s(ee,2);m(F=>{rt(L,"href",F),b(W,`⇒${(t().cardId?"公式カードページ":"公式で検索")??""}`),rt(ee,"href",`https://yugioh-wiki.net/index.php?${t().wikiEncodedName}`),rt(w,"href",`https://www.google.com/search?q=遊戯王 ${t().name}`)},[()=>fr(t())],de),r(E,x)};C(fe,E=>{t().isForTest?E(ae):E(Te,!1)})}m((E,x)=>{Ae(S,`duel_card duel_card_info ${t().kind??""} ${E??""} svelte-7xhk0x`),b(R,t().name),K.disabled=!t().isImplemented,rt(K,"title",t().isImplemented?`※shiftキー同時押しで一括投入
※ctrlキー同時押しで枚数制限無視`:""),Z.disabled=x,rt(Z,"title",t().isImplemented?"※shiftキー同時押しで一括外し":""),b(ye,t().description)},[()=>{var E;return(E=t().monsterCategories)==null?void 0:E.join(" ")},()=>c()[fa(t())].every(E=>E.name!==t().name)],de),V("click",K,E=>g().onCardAppend(E,t())),V("click",Z,E=>g().onCardRemove(E,t())),V("click",S,()=>o()(t())),r(A,S)};C(d,A=>{t()&&A(B)})}r(f,u),ut()}const en={0:{aaa:"日",aaaa:"日曜日",ddd:"Sun",dddd:"Sunday"},1:{aaa:"月",aaaa:"月曜日",ddd:"Mon",dddd:"Monday"},2:{aaa:"火",aaaa:"火曜日",ddd:"Tue",dddd:"Tuesday"},3:{aaa:"水",aaaa:"水曜日",ddd:"Wed",dddd:"Wednesday"},4:{aaa:"木",aaaa:"木曜日",ddd:"Thu",dddd:"Thursday"},5:{aaa:"金",aaaa:"金曜日",ddd:"Fri",dddd:"Friday"},6:{aaa:"土",aaaa:"土曜日",ddd:"Sat",dddd:"Saturday"}};class tn{constructor(){nt(this,"DefaultSeparator1","/");nt(this,"DefaultSeparator2"," ");nt(this,"DefaultSeparator3",":");nt(this,"createDate",i=>{if(!i)return;const t=new Date(i);if(!isNaN(t.getTime()))return t});nt(this,"createDateOr",(i,t)=>this.createDate(i)||t||new Date);nt(this,"truncateDate",i=>{const t=i||new Date;return new Date(t.getFullYear(),t.getMonth(),t.getDate())});nt(this,"addDate",(i,t)=>{const o=this.createDateOr(i);return o.setDate(o.getDate()+t),o});nt(this,"addMonth",(i,t)=>{const o=this.createDateOr(i);return o.setMonth(o.getMonth()+t),o});nt(this,"addYear",(i,t)=>{const o=this.createDateOr(i);return o.setFullYear(o.getFullYear()+t),o});nt(this,"getDayOfWeek",(i,t="dddd")=>{const o=this.createDate(i);return o?en[o.getDay()][t]:""});nt(this,"formatToYYYYMMDD",(i,t=this.DefaultSeparator1)=>{const o=this.createDate(i);if(!o)return"";const g=o.getFullYear().toString(),c=("0"+(o.getMonth()+1)).slice(-2),u=("0"+o.getDate()).slice(-2);return g+t+c+t+u});nt(this,"formatToYYYYMM",(i,t=this.DefaultSeparator1)=>{const o=this.createDate(i);if(!o)return"";t||(t="");const g=o.getFullYear().toString(),c=("0"+(o.getMonth()+1)).slice(-2);return g+t+c});nt(this,"formatToHHMMSS",(i,t=this.DefaultSeparator3)=>{const o=this.createDate(i);if(!o)return"";t||(t="");const g=o.getHours(),c=o.getMinutes(),u=o.getSeconds();return("0"+g).slice(-2)+t+("0"+c).slice(-2)+t+("0"+u).slice(-2)});nt(this,"formatToHHMM",(i,t=this.DefaultSeparator3)=>{const o=this.createDate(i);if(!o)return"";t||(t="");const g=("0"+o.getHours()).slice(-2),c=("0"+o.getMinutes()).slice(-2);return g+t+c});nt(this,"formatToYYYYMMDD_HHMM",(i,t=this.DefaultSeparator1,o=this.DefaultSeparator2,g=this.DefaultSeparator3)=>{const c=this.createDate(i);return c?this.formatToYYYYMMDD(c,t)+o+this.formatToHHMM(c,g):""});nt(this,"formatToYYYYMMDD_HHMMSS",(i,t=this.DefaultSeparator1,o=this.DefaultSeparator2,g=this.DefaultSeparator3)=>{const c=this.createDate(i);return c?this.formatToYYYYMMDD(c,t)+o+this.formatToHHMMSS(c,g):""})}}const bt=new tn;Date.prototype.truncateDate=function(){return bt.truncateDate(this)};Date.prototype.getCloneOr=function(f){return bt.createDateOr(this,f)};Date.prototype.addDate=function(f){return bt.addDate(this,f)};Date.prototype.addMonth=function(f){return bt.addDate(this,f)};Date.prototype.addYear=function(f){return bt.addDate(this,f)};Date.prototype.getDayOfWeek=function(f="dddd"){return bt.getDayOfWeek(this,f)};Date.prototype.formatToYYYYMM=function(f){return bt.formatToYYYYMM(this,f)};Date.prototype.formatToYYYYMMDD=function(f){return bt.formatToYYYYMMDD(this,f)};Date.prototype.formatToYYYYMMDD_HHMM=function(f,i,t){return bt.formatToYYYYMMDD_HHMM(this,f,i,t)};Date.prototype.formatToYYYYMMDD_HHMMSS=function(f,i,t){return bt.formatToYYYYMMDD_HHMMSS(this,f,i,t)};Date.prototype.formatToHHMM=function(f){return bt.formatToHHMM(this,f)};Date.prototype.formatToHHMMSS=function(f){return bt.formatToHHMMSS(this,f)};var an=l('<li class="deck_info_list_item svelte-2wdgc8"><div class="svelte-2wdgc8"> </div> <div class="svelte-2wdgc8"> </div> <div class="svelte-2wdgc8"> </div></li>'),rn=l('<ul class="deck_info_list svelte-2wdgc8"></ul>'),sn=l('<label for="file_selector" class="upload_area svelte-2wdgc8" role="region" aria-label="ファイルアップロードエリア"><div class="upload_area_message svelte-2wdgc8">ここにファイルをドロップ</div> <div class="upload_area_footer svelte-2wdgc8"><input type="file" id="file_selector" name="file_selector" accept=".json" multiple></div></label>'),nn=l('<div slot="body" class="modal_body svelte-2wdgc8"><!></div>'),ln=l('<button class="svelte-2wdgc8">追加</button> <button class="svelte-2wdgc8">削除して追加</button> <button class="svelte-2wdgc8">戻る</button>',1),on=l('<button class="svelte-2wdgc8">Cancel</button>'),dn=l('<div slot="footer" class="modal_window_footer svelte-2wdgc8"><!></div>');function vn(f,i){ct(i,!1);let t=je(i,"eventHolder",8),o=je(i,"args",8),g=je(i,"resolve",8),c=ne(Promise.resolve([])),u=ne();const d=()=>{$(u,new DataTransfer().files),$(c,Promise.resolve([]))},B=async q=>{q.preventDefault(),console.log("hoge",q)},A=async q=>{q.preventDefault(),q.dataTransfer&&M(q.dataTransfer.files)},S=()=>{M(e(u))},M=async q=>{if(!q.length)return;const R=[],I=[];for(const _ of q)try{I.push(...await Dt.createfromJson(_))}catch(p){p instanceof Error&&R.push(p.message)}if(R.length){console.log(...R);return}$(c,e(c).then(()=>I))},n=d;_t(),mr(f,{get eventHolder(){return t()},get args(){return o()},$$slots:{body:(q,R)=>{var I=nn(),_=a(I);mt(_,()=>oa,null,(p,K)=>{var Z=we(),Ce=P(Z);mt(Ce,()=>e(c),null,(j,U)=>{var ve=we(),Me=P(ve);{var ge=se=>{var Ee=rn();ce(Ee,5,()=>e(U),_e,(ye,Y)=>{var N=an(),fe=a(N),ae=a(fe),Te=s(fe,2),E=a(Te),x=s(Te,2),L=a(x);m((W,ee,w)=>{b(ae,e(Y).name),b(E,`${W??""}
                  /
                  ${ee??""}`),b(L,`最終使用日時 ： ${w??""}`)},[()=>e(Y).cardNames.filter(W=>{var ee,w;return!((w=(ee=e(K).getCardInfo(W))==null?void 0:ee.monsterCategories)!=null&&w.union(aa).length)}).length,()=>e(Y).cardNames.filter(W=>{var ee,w;return(w=(ee=e(K).getCardInfo(W))==null?void 0:ee.monsterCategories)==null?void 0:w.union(aa).length}).length,()=>e(Y).lastUsedAt.formatToYYYYMMDD_HHMM("/"," ",":")],de),r(ye,N)}),r(se,Ee)},le=se=>{var Ee=sn(),ye=s(a(Ee),2),Y=a(ye);pr(Y,()=>e(u),N=>$(u,N)),V("change",Y,S),V("cancel",Y,n),V("drop",Ee,A),V("dragover",Ee,B),r(se,Ee)};C(Me,se=>{e(U).length?se(ge):se(le,!1)})}r(j,ve)}),r(p,Z)}),r(q,I)},footer:(q,R)=>{var I=dn(),_=a(I);mt(_,()=>e(c),null,(p,K)=>{var Z=we(),Ce=P(Z);{var j=ve=>{var Me=ln(),ge=P(Me),le=s(ge,2),se=s(le,2);m(()=>{ge.disabled=e(K).length===0,le.disabled=e(K).length===0}),V("click",ge,()=>g()({deckInfos:e(K),replaceAll:!1})),V("click",le,()=>g()({deckInfos:e(K),replaceAll:!0})),V("click",se,n),r(ve,Me)},U=ve=>{var Me=we(),ge=P(Me);{var le=se=>{var Ee=on();V("click",Ee,()=>g()(void 0)),r(se,Ee)};C(ge,se=>{o().cancelable&&se(le)},!0)}r(ve,Me)};C(Ce,ve=>{e(K).length?ve(j):ve(U,!1)})}r(p,Z)}),r(q,I)}}}),ut()}const pa=class pa extends yr{constructor(i,t){super(i,...Object.values(t))}};nt(pa,"createModalController",i=>{const t={deckUploader:new hr({title:"デッキ情報をアップロード",position:"Middle",cancelable:!1})};return Object.assign(new pa(i,t),t)});let Da=pa;function cn(f,i){ct(i,!1);let t=je(i,"modalController",8);_t(),gr(f,{get modalController(){return t()},children:(o,g)=>{var c=we(),u=P(c);{var d=B=>{vn(B,{get eventHolder(){return t().eventHolder},get args(){return t().deckUploader.args},get resolve(){return t().deckUploader.resolve}})};C(u,B=>{t().deckUploader.state==="Shown"&&B(d)})}r(o,c)},$$slots:{default:!0}}),ut()}var _n=l("<button> </button>"),un=l('<label class="svelte-1m129ml"><input type="checkbox" class="search_condition svelte-1m129ml"> </label>'),fn=l('<label class="svelte-1m129ml"><input type="checkbox" class="search_condition svelte-1m129ml"> </label>'),mn=l('<div class="deck_editor_search_box_row monster_ex_categories svelte-1m129ml"><div class="svelte-1m129ml"><button class="search_condition_title black_button svelte-1m129ml">エクストラ</button></div> <div class="svelte-1m129ml"></div></div>'),pn=l('<label class="svelte-1m129ml"><input type="checkbox" class="search_condition svelte-1m129ml"> </label>'),gn=l('<label class="svelte-1m129ml"><input type="checkbox" class="search_condition svelte-1m129ml"> <div style="display: inline-block;"></div> </label>'),yn=l('<label class="svelte-1m129ml"><input type="checkbox" class="search_condition svelte-1m129ml"> </label>'),hn=l('<option class="svelte-1m129ml"></option>'),bn=l('<option class="svelte-1m129ml"></option>'),kn=l('<div class="deck_editor_search_box_row monster_categories svelte-1m129ml"><div class="svelte-1m129ml"><button class="search_condition_title black_button svelte-1m129ml">モンスター</button></div> <div class="svelte-1m129ml"></div></div> <div class="deck_editor_search_box_row monster_attributes svelte-1m129ml"><div class="svelte-1m129ml"><button class="search_condition_title black_button svelte-1m129ml">属性</button></div> <div class="svelte-1m129ml"></div></div> <div class="deck_editor_search_box_row svelte-1m129ml"><div class="svelte-1m129ml"><button class="search_condition_title black_button svelte-1m129ml">種族</button></div> <div class="svelte-1m129ml"></div></div> <div class="deck_editor_search_box_row svelte-1m129ml"><div class="svelte-1m129ml"><button class="search_condition_title black_button svelte-1m129ml">星攻守</button></div> <div class="svelte-1m129ml"><div class="star_range svelte-1m129ml"><span class="svelte-1m129ml">星</span> <select class="svelte-1m129ml"></select> <span class="svelte-1m129ml">～</span> <select class="svelte-1m129ml"></select></div> <div class="atk_range svelte-1m129ml"><span class="svelte-1m129ml">攻</span> <input type="number" min="0" max="5000" step="100" class="svelte-1m129ml"> <span class="svelte-1m129ml">～</span> <input type="number" min="0" max="5000" step="100" class="svelte-1m129ml"></div> <div class="def_range svelte-1m129ml"><span class="svelte-1m129ml">守</span> <input type="number" min="0" max="5000" step="100" class="svelte-1m129ml"> <span class="svelte-1m129ml">～</span> <input type="number" min="0" max="5000" step="100" class="svelte-1m129ml"></div> <div class="atk_plus_def svelte-1m129ml"><span class="svelte-1m129ml">攻+守</span> <input type="number" min="0" max="10000" step="100" class="svelte-1m129ml"></div></div></div>',1),xn=l('<label class="svelte-1m129ml"><input type="checkbox" class="search_condition svelte-1m129ml"> </label>'),wn=l('<div class="deck_editor_search_box_row svelte-1m129ml"><div class="svelte-1m129ml"><button class="search_condition_title black_button svelte-1m129ml">魔法</button></div> <div class="svelte-1m129ml"></div></div>'),Cn=l('<label class="svelte-1m129ml"><input type="checkbox" class="search_condition svelte-1m129ml"> </label>'),Dn=l('<div class="deck_editor_search_box_row svelte-1m129ml"><div class="svelte-1m129ml"><button class="search_condition_title black_button svelte-1m129ml">罠</button></div> <div class="svelte-1m129ml"></div></div>'),$n=l('<label class="svelte-1m129ml"><input type="checkbox" class="search_condition svelte-1m129ml"> </label>'),Sn=l('<div class="deck_editor_card_detail svelte-1m129ml"><!></div>'),Mn=l("<div>カード情報読込中</div>"),Tn=l("<option> </option>"),En=l('<div class="svelte-1m129ml"><a class="white_button svelte-1m129ml" download="SVS_DeckInfos.json">ダウンロード</a></div>'),jn=l('<div class="svelte-1m129ml"></div>'),An=l('<div class="svelte-1m129ml"><a class="white_button svelte-1m129ml" download="SVS_DeckInfos.json">ダウンロード(一括)</a></div>'),Bn=l('<div class="svelte-1m129ml"></div>'),Ln=l('<div class="deck_editor_body_right_header svelte-1m129ml"><div class="deck_editor_body_right_header_row svelte-1m129ml"><div class="svelte-1m129ml">編集対象</div> <div class="svelte-1m129ml"><select style="width:100%" class="svelte-1m129ml"></select></div></div> <div class="deck_editor_body_right_header_row svelte-1m129ml"><div class="svelte-1m129ml">新規名称</div> <div class="svelte-1m129ml"><input type="text" style="width:100%" class="svelte-1m129ml"></div></div> <div class="deck_editor_body_right_header_row svelte-1m129ml"></div> <div class="deck_editor_body_right_header_row svelte-1m129ml"><div class="svelte-1m129ml">基本操作</div> <div class="svelte-1m129ml"><button class="white_button svelte-1m129ml">デッキを保存</button></div> <div class="svelte-1m129ml"><button class="white_button svelte-1m129ml">デッキを複製</button></div> <div class="svelte-1m129ml"><button class="white_button svelte-1m129ml" title="shiftキー押下で確認メッセージスキップ">デッキを削除</button></div></div> <div class="deck_editor_body_right_header_row svelte-1m129ml"><div class="svelte-1m129ml">DL/UL</div> <!> <!> <div class="svelte-1m129ml"><button class="white_button svelte-1m129ml">アップロード</button></div></div></div> <div><!></div>',1),qn=l("<div>デッキ情報読込中</div>"),Yn=l('<div class="deck_editor_body_right_dummy svelte-1m129ml"></div>'),Un=l("<div><!></div>"),Hn=l('<div><div class="deck_editor_header svelte-1m129ml"></div> <div class="deck_editor_body svelte-1m129ml"><div class="deck_editor_body_left svelte-1m129ml"><div role="contentinfo" class="deck_editor_search_box svelte-1m129ml"><div class="deck_editor_search_box_header svelte-1m129ml"><div class="svelte-1m129ml"><button class="deck_editor_search_box_title svelte-1m129ml">検索条件</button></div> <div class="deck_editor_sort_setting_container svelte-1m129ml"></div></div> <div class="deck_editor_search_box_body svelte-1m129ml"><div class="deck_editor_search_box_row svelte-1m129ml"><div class="svelte-1m129ml"><button class="search_condition_title black_button svelte-1m129ml">名称</button></div> <div class="svelte-1m129ml"><input type="text" style="width:100%" placeholder="※ルビには対応していません" class="svelte-1m129ml"></div></div> <div class="deck_editor_search_box_row card_kind svelte-1m129ml"><div class="svelte-1m129ml"><button class="search_condition_title black_button svelte-1m129ml">種類</button></div> <div class="svelte-1m129ml"></div></div> <!> <!> <!> <!> <div class="deck_editor_search_box_row svelte-1m129ml"><div class="svelte-1m129ml"><button class="search_condition_title black_button svelte-1m129ml">その他</button></div> <div class="svelte-1m129ml"></div></div></div></div> <!></div> <div class="deck_editor_body_center svelte-1m129ml"><div class="deck_editor_body_center_body svelte-1m129ml"><!></div></div>  <div class="deck_editor_body_right svelte-1m129ml"><!></div></div> <div class="footer svelte-1m129ml"></div></div> <!> <!>',1);function Pn(f,i){ct(i,!1);const t=[],o=[],g=[],c=[],u=[],d=[],B=[],A=[],S=Da.createModalController({onDragStart:{append:()=>{},remove:()=>{}},onDragEnd:{append:()=>{},remove:()=>{}}}),M={name:"",deckCardKinds:[...ta],exMonsterCategories:[...aa],monsterCategories:Ha.filter(h=>!aa.includes(h)),monsterAttributes:[...Ua],monsterTypes:[...Ya],spellCategories:qa.filter(h=>h!=="PendulumScale"),trapCategories:[...La],starLowerBound:0,starUpperBound:13,atkLowerBound:0,atkUpperBound:5e3,defLowerBound:0,defUpperBound:5e3,atkPlusDef:void 0,others:["test","oldVersion","implemented"],sort:[...Pa]},n=ne(structuredClone(M));be(n,e(n).others=["oldVersion"]),be(n,e(n).monsterCategories=["Effect","Tuner","Pendulum"]);let q=ne("DeckEdit"),R=ne("SearchCondition");const I=()=>{if(!e(n).deckCardKinds.length){Xt(e(n)).forEach(h=>{Array.isArray(e(n)[h])&&Array.isArray(M[h])?be(n,e(n)[h]=[...M[h]]):be(n,e(n)[h]=M[h])});return}be(n,e(n).name=""),be(n,e(n).deckCardKinds=[]),be(n,e(n).exMonsterCategories=[]),be(n,e(n).monsterCategories=[]),be(n,e(n).monsterAttributes=[]),be(n,e(n).monsterTypes=[]),be(n,e(n).spellCategories=[]),be(n,e(n).trapCategories=[]),be(n,e(n).others=[]),be(n,e(n).atkLowerBound=0),be(n,e(n).atkUpperBound=5e3),be(n,e(n).defLowerBound=0),be(n,e(n).defUpperBound=5e3),be(n,e(n).atkPlusDef=void 0),be(n,e(n).sort=[...Pa])},_=h=>{h.forEach(k=>{Array.isArray(e(n)[k])&&Array.isArray(M[k])?be(n,e(n)[k]=e(n)[k].length?[]:[...M[k]]):be(n,e(n)[k]=M[k])})};let p=ne(),K,Z=ne(!1);const Ce=200,j=()=>{$(Z,!1),$(p,void 0),K=void 0},U=(h,k)=>{const O=fa(k),J=e(ae).cardTree[O].filter(Pe=>Pe.name===k.name).length;let pe=h.shiftKey?3-J:1;console.debug(k,O,J,pe),!h.ctrlKey&&J>2&&(pe=0),pe&&be(ae,e(ae).cardTree[O]=[...e(ae).cardTree[O],...Array(pe).fill(k)].sort(Qa)),j(),x(k)},ve=(h,k)=>{const O=fa(k);let J=0;be(ae,e(ae).cardTree[O]=e(ae).cardTree[O].filter(pe=>pe.name!==k.name?!0:(J++,!h.shiftKey&&J>1))),j(),x(k)},Me=h=>{if(h.changedTouches&&h.changedTouches.length!==1)return;const{clientX:k,clientY:O}=h.changedTouches?h.changedTouches[0]:h;return{clientX:k,clientY:O}},ge={onCardAppend:U,onCardRemove:ve,onCardDragCancel:j,onCardDragStart:(h,k,O)=>{if(x(O),k!=="List"&&k!=="Deck"){j();return}if(k==="List"&&!O.isImplemented){j();return}const J=Me(h);if(!J){j();return}K={from:k,cardInfo:O,pos:J,startPos:J},ea(Ce).then(()=>{(K==null?void 0:K.cardInfo)===O&&$(p,K)}),$(Z,!1)},onCardDragging:(h,k)=>{if(e(p)&&h.preventDefault&&h.preventDefault(),e(p)&&h.stopPropagation&&h.stopPropagation(),!K){j();return}const O=Me(h);if(!O){j();return}const J=e(p)||K;$(Z,!!(J.from==="List"&&J.cardInfo.isImplemented&&document.elementsFromPoint(O.clientX,O.clientY).some(pe=>pe.classList.contains("deck_editor_body_right_body")||pe.classList.contains("deck_editor_body_right_dummy")))),e(Z)&&$(q,"DeckEdit"),e(p)?$(p,{...e(p),pos:O}):K.pos={...O}},onCardDragEnd:h=>{if(!K||!e(p)){j();return}const k=Me(h);if(!k){j();return}e(p).from==="List"&&e(p).cardInfo.isImplemented&&document.elementsFromPoint(k.clientX,k.clientY).some(O=>O.classList.contains("deck_editor_body_right_body"))&&U(h,e(p).cardInfo),e(p).from==="Deck"&&!document.elementsFromPoint(k.clientX,k.clientY).some(O=>O.classList.contains("deck_editor_body_right_body"))&&ve(h,e(p).cardInfo),j()}},le=(h,k,O)=>{Array.isArray(e(n)[k])&&Array.isArray(M[k])&&be(n,e(n)[k]=[O])},se=async()=>{const k=(await e(Y)).find(J=>J.id===e(ye));if(!k)return;const O=await oa;$(ae,{...k,cardTree:kr(k.cardNames.map(J=>{const pe=O.getCardInfo(J);return pe===void 0&&console.error(J),pe}).filter(J=>J!==void 0))})},Ee=()=>Dt.getAllDeckInfo().then(h=>($(ye,(h.find(k=>k.lastUsedAt.getTime()===Math.max(...h.map(O=>O.lastUsedAt.getTime())))??h[0]).id),h));let ye=ne(-1),Y=ne(Ee()),N=ne(e(Y).then(h=>Dt.convertToObjectURL(h)));e(Y).then(se);const fe=()=>{$(Y,Ee()),$(N,e(Y).then(h=>Dt.convertToObjectURL(h))),se()};let ae=ne({id:-Number.MAX_VALUE,name:"",description:"",lastUsedAt:new Date,cardTree:{ExtraMonster:[],Monster:[],Spell:[],Trap:[]}}),Te=ne(void 0),E=0;const x=h=>{$(R,"CardDetail"),h.cardId!==void 0&&!h.description&&!h.pendulumDescription&&(E=h.cardId,xa([h.cardId]).then(()=>{h.cardId===E&&$(Te,h)})),$(Te,h)},L=async()=>{const k=(await e(Y)).find(O=>O.id===e(ye));if(!k)throw new Error("illegal state");return k},W=async()=>{const h=await L();await h.saveDeckInfo({...h,name:e(ae).name,cardNames:Object.values(e(ae).cardTree).flatMap(k=>k).map(k=>k.name),lastUsedAt:new Date}),fe()},ee=async()=>{(await Dt.createNewDeck(`デッキ_${new Date().formatToYYYYMMDD_HHMMSS("","","")}`,`コピー日時：${new Date().formatToYYYYMMDD_HHMMSS("-"," ",":")}`,Object.values(e(ae).cardTree).flatMap(k=>k).map(k=>k.name))).saveDeckInfo(),fe()},w=async h=>{const k=await L();!h.shiftKey&&!confirm(`デッキ【${k.name}】を削除します。
よろしいですか？`)||(await k.delete(),fe())},F=async()=>{const h=await S.deckUploader.show({title:"デッキ情報アップロード",position:"Middle",cancelable:!0});if(!h)return;const k=[];if(h.replaceAll){if(!confirm(`既存デッキ情報を全て削除し、アップロードしたファイルに置き換えます。
よろしいですか？`))return;k.push(...(await e(Y)).map(O=>O.id))}await Promise.all(h.deckInfos.map(O=>Dt.createNewDeck(O.name,O.description,O.cardNames,O.lastUsedAt))),k.length&&await Promise.all(k.map(Dt.remove)),fe()},z=()=>innerWidth<=1400?"compact":"wide";_t();var Q=Hn(),X=P(Q),ue=s(a(X),2),T=a(ue),D=a(T),v=a(D),y=a(v),H=a(y),G=s(y,2);ce(G,5,()=>e(n).sort,_e,(h,k,O)=>{var J=_n(),pe=a(J);m(()=>{Ae(J,`deck_editor_sort_setting_item ${e(k).order??""} priority_${e(k).priority??""} svelte-1m129ml`),b(pe,`${br[e(k).key]??""}
                ${(e(k).order==="asc"?"▲":"▼")??""}`)}),V("click",J,()=>{e(n).sort.forEach(Pe=>Pe.priority++),e(k).order=e(k).order==="asc"?"desc":"asc",Et(()=>e(n).sort),e(k).priority=1,Et(()=>e(n).sort)}),r(h,J)});var De=s(v,2),$e=a(De),me=a($e),ie=a(me),re=s(me,2),te=a(re),Se=s($e,2),Re=a(Se),Ie=a(Re),Ke=s(Re,2);ce(Ke,5,()=>ta,_e,(h,k)=>{var O=un(),J=a(O),pe,Pe=s(J);m(()=>{pe!==(pe=e(k))&&(J.value=(J.__value=e(k))==null?"":e(k)),b(Pe,` ${Ga[e(k)]??""}`)}),It(t,[],J,()=>(e(k),e(n).deckCardKinds),he=>be(n,e(n).deckCardKinds=he)),V("dblclick",O,he=>le(he,"deckCardKinds",e(k))),r(h,O)});var Ue=s(Se,2);{var Ge=h=>{var k=mn(),O=a(k),J=a(O),pe=s(O,2);ce(pe,5,()=>aa,_e,(Pe,he)=>{var Ne=fn(),ze=a(Ne),Ve,tt=s(ze);m(()=>{Ve!==(Ve=e(he))&&(ze.value=(ze.__value=e(he))==null?"":e(he)),b(tt,` ${da[e(he)]??""}${_a[e(he)]??""}`)}),It(o,[],ze,()=>(e(he),e(n).exMonsterCategories),Je=>be(n,e(n).exMonsterCategories=Je)),V("dblclick",Ne,Je=>le(Je,"exMonsterCategories",e(he))),r(Pe,Ne)}),V("click",J,()=>_(["exMonsterCategories"])),oe(3,k,()=>xe,()=>({delay:0,duration:100})),r(h,k)};C(Ue,h=>{e(n).deckCardKinds.includes("ExtraMonster")&&h(Ge)})}var lt=s(Ue,2);{var Ye=h=>{var k=kn(),O=P(k),J=a(O),pe=a(J),Pe=s(J,2);ce(Pe,5,()=>Ha.filter(Be=>!aa.includes(Be)),_e,(Be,qe)=>{var Oe=pn(),Fe=a(Oe),Ct,Ft=s(Fe);m(()=>{Ct!==(Ct=e(qe))&&(Fe.value=(Fe.__value=e(qe))==null?"":e(qe)),b(Ft,` ${da[e(qe)]??""}${_a[e(qe)]??""}`)}),It(g,[],Fe,()=>(e(qe),e(n).monsterCategories),Bt=>be(n,e(n).monsterCategories=Bt)),V("dblclick",Oe,Bt=>le(Bt,"exMonsterCategories",e(qe))),r(Be,Oe)});var he=s(O,2),Ne=a(he),ze=a(Ne),Ve=s(Ne,2);ce(Ve,5,()=>Ua,_e,(Be,qe)=>{var Oe=gn(),Fe=a(Oe),Ct,Ft=s(Fe,2),Bt=s(Ft);m(()=>{Ct!==(Ct=e(qe))&&(Fe.value=(Fe.__value=e(qe))==null?"":e(qe)),Ae(Ft,`monster_attr ${e(qe)??""} svelte-1m129ml`),b(Bt,` ${Sa[e(qe)]??""}`)}),It(c,[],Fe,()=>(e(qe),e(n).monsterAttributes),ba=>be(n,e(n).monsterAttributes=ba)),V("dblclick",Oe,ba=>le(ba,"monsterAttributes",e(qe))),r(Be,Oe)});var tt=s(he,2),Je=a(tt),Ht=a(Je),Tt=s(Je,2);ce(Tt,5,()=>Ya,_e,(Be,qe)=>{var Oe=yn(),Fe=a(Oe),Ct,Ft=s(Fe);m(()=>{Ct!==(Ct=e(qe))&&(Fe.value=(Fe.__value=e(qe))==null?"":e(qe)),b(Ft,` ${ga[e(qe)]??""}
                    ${Ma[e(qe)]??""}`)}),It(u,[],Fe,()=>(e(qe),e(n).monsterTypes),Bt=>be(n,e(n).monsterTypes=Bt)),V("dblclick",Oe,Bt=>le(Bt,"monsterTypes",e(qe))),r(Be,Oe)});var wt=s(tt,2),gt=a(wt),pt=a(gt),Pt=s(gt,2),At=a(Pt),Nt=s(a(At),2);m(()=>{e(n),Et(()=>{})}),ce(Nt,4,()=>Array(14),_e,(Be,qe,Oe)=>{var Fe=hn();Fe.value=(Fe.__value=Oe)==null?"":Oe,Fe.textContent=Oe,r(Be,Fe)});var Wt=s(Nt,4);m(()=>{e(n),Et(()=>{})}),ce(Wt,4,()=>Array(14),_e,(Be,qe,Oe)=>{var Fe=bn();Fe.value=(Fe.__value=Oe)==null?"":Oe,Fe.textContent=Oe,r(Be,Fe)});var ot=s(At,2),Qe=s(a(ot),2),dt=s(Qe,4),yt=s(ot,2),ht=s(a(yt),2),Jt=s(ht,4),Ze=s(yt,2),it=s(a(Ze),2);V("click",pe,()=>_(["monsterCategories"])),oe(3,O,()=>xe,()=>({delay:0,duration:100})),V("click",ze,()=>_(["monsterAttributes"])),oe(3,he,()=>xe,()=>({delay:0,duration:100})),V("click",Ht,()=>_(["monsterTypes"])),oe(3,tt,()=>xe,()=>({delay:0,duration:100})),V("click",pt,()=>_(["starLowerBound","starUpperBound","atkLowerBound","atkUpperBound","defLowerBound","defUpperBound","atkPlusDef"])),Rt(Nt,()=>e(n).starLowerBound,Be=>be(n,e(n).starLowerBound=Be)),Rt(Wt,()=>e(n).starUpperBound,Be=>be(n,e(n).starUpperBound=Be)),Ot(Qe,()=>e(n).atkLowerBound,Be=>be(n,e(n).atkLowerBound=Be)),Ot(dt,()=>e(n).atkUpperBound,Be=>be(n,e(n).atkUpperBound=Be)),Ot(ht,()=>e(n).defLowerBound,Be=>be(n,e(n).defLowerBound=Be)),Ot(Jt,()=>e(n).defUpperBound,Be=>be(n,e(n).defUpperBound=Be)),Ot(it,()=>e(n).atkPlusDef,Be=>be(n,e(n).atkPlusDef=Be)),oe(3,wt,()=>xe,()=>({delay:0,duration:100})),r(h,k)};C(lt,h=>{(e(n).deckCardKinds.includes("Monster")||e(n).deckCardKinds.includes("ExtraMonster"))&&h(Ye)})}var ke=s(lt,2);{var Le=h=>{var k=wn(),O=a(k),J=a(O),pe=s(O,2);ce(pe,5,()=>qa.filter(Pe=>Pe!=="PendulumScale"),_e,(Pe,he)=>{var Ne=xn(),ze=a(Ne),Ve,tt=s(ze);m(()=>{Ve!==(Ve=e(he))&&(ze.value=(ze.__value=e(he))==null?"":e(he)),b(tt,` ${ya[e(he)]??""}`)}),It(d,[],ze,()=>(e(he),e(n).spellCategories),Je=>be(n,e(n).spellCategories=Je)),V("dblclick",Ne,Je=>le(Je,"spellCategories",e(he))),r(Pe,Ne)}),V("click",J,()=>_(["spellCategories"])),oe(3,k,()=>xe,()=>({delay:0,duration:100})),r(h,k)};C(ke,h=>{e(n).deckCardKinds.includes("Spell")&&h(Le)})}var He=s(ke,2);{var We=h=>{var k=Dn(),O=a(k),J=a(O),pe=s(O,2);ce(pe,5,()=>La,_e,(Pe,he)=>{var Ne=Cn(),ze=a(Ne),Ve,tt=s(ze);m(()=>{Ve!==(Ve=e(he))&&(ze.value=(ze.__value=e(he))==null?"":e(he)),b(tt,` ${ha[e(he)]??""}`)}),It(B,[],ze,()=>(e(he),e(n).trapCategories),Je=>be(n,e(n).trapCategories=Je)),V("dblclick",Ne,Je=>le(Je,"trapCategories",e(he))),r(Pe,Ne)}),V("click",J,()=>_(["trapCategories"])),oe(3,k,()=>xe,()=>({delay:0,duration:100})),r(h,k)};C(He,h=>{e(n).deckCardKinds.includes("Trap")&&h(We)})}var st=s(He,2),Xe=a(st),et=a(Xe),$t=s(Xe,2);ce($t,4,()=>[{key:"test",text:"テスト用カード"},{key:"oldVersion",text:"エラッタ前カード"},{key:"implemented",text:"未実装カード"}],_e,(h,k)=>{var O=$n(),J=a(O),pe,Pe=s(J);m(()=>{pe!==(pe=k.key)&&(J.value=(J.__value=k.key)==null?"":k.key),b(Pe,` ${k.text??""}`)}),It(A,[],J,()=>(k.key,e(n).others),he=>be(n,e(n).others=he)),r(h,O)});var vt=s(D,2);{var St=h=>{var k=Sn(),O=a(k);Zi(O,{get cardInfo(){return e(Te)},onAttention:x,cardControlEventHandlers:ge,get deckCardTree(){return e(ae).cardTree}}),r(h,k)};C(vt,h=>{e(R)==="CardDetail"&&e(Te)&&h(St)})}var jt=s(T,2),Yt=a(jt),sa=a(Yt);mt(sa,()=>oa,h=>{var k=Mn();r(h,k)},(h,k)=>{Wa(h,{mode:"List",get allCardTree(){return e(k).tree},onAttention:x,get searchCondition(){return e(n)},cardControlEventHandlers:ge,get deckCardTree(){return e(ae).cardTree},set deckCardTree(O){be(ae,e(ae).cardTree=O)},$$legacy:!0})});var Ut=s(jt,2),Qt=a(Ut);{var kt=h=>{var k=we(),O=P(k);mt(O,()=>e(Y),J=>{var pe=qn();r(J,pe)},(J,pe)=>{var Pe=Ln(),he=P(Pe),Ne=a(he),ze=s(a(Ne),2),Ve=a(ze);m(()=>{e(ye),Et(()=>{e(pe)})}),ce(Ve,5,()=>e(pe),_e,(Ze,it)=>{var Be=Tn(),qe={},Oe=a(Be);m(()=>{qe!==(qe=e(it).id)&&(Be.value=(Be.__value=e(it).id)==null?"":e(it).id),b(Oe,e(it).name)}),r(Ze,Be)});var tt=s(Ne,2),Je=s(a(tt),2),Ht=a(Je),Tt=s(tt,4),wt=s(a(Tt),2),gt=a(wt),pt=s(wt,2),Pt=a(pt),At=s(pt,2),Nt=a(At),Wt=s(Tt,2),ot=s(a(Wt),2);mt(ot,L,Ze=>{var it=jn();r(Ze,it)},(Ze,it)=>{var Be=En(),qe=a(Be);m(Oe=>rt(qe,"href",Oe),[()=>Dt.convertToObjectURL([e(it)])],de),r(Ze,Be)});var Qe=s(ot,2);mt(Qe,()=>e(N),Ze=>{var it=Bn();r(Ze,it)},(Ze,it)=>{var Be=An(),qe=a(Be);m(()=>rt(qe,"href",e(it))),r(Ze,Be)});var dt=s(Qe,2),yt=a(dt),ht=s(he,2),Jt=a(ht);Wa(Jt,{mode:"Deck",allCardTree:{ExtraMonster:[],Monster:[],Spell:[],Trap:[]},onAttention:x,cardControlEventHandlers:ge,get deckCardTree(){return e(ae).cardTree},set deckCardTree(Ze){be(ae,e(ae).cardTree=Ze)},$$legacy:!0}),m(()=>Ae(ht,`deck_editor_body_right_body ${(e(Z)?"can_drop":"")??""} svelte-1m129ml`)),Rt(Ve,()=>e(ye),Ze=>$(ye,Ze)),V("change",Ve,se),Ot(Ht,()=>e(ae).name,Ze=>be(ae,e(ae).name=Ze)),V("click",gt,W),V("click",Pt,ee),V("click",Nt,w),V("click",yt,F),r(J,Pe)}),r(h,k)},Mt=h=>{var k=Yn();r(h,k)};C(Qt,h=>{e(q)==="DeckEdit"||z()==="wide"?h(kt):h(Mt,!1)})}var xt=s(X,2);{var ia=h=>{var k=Un(),O=a(k);Ja(O,{mode:"Dragging",get cardInfo(){return e(p).cardInfo},onAttention:x,cardControlEventHandlers:ge}),m(()=>rt(k,"style",`position: fixed;
          top:${e(p).pos.clientY??""}px;
          left:${e(p).pos.clientX??""}px;
          z-index:3; 
          filter: opacity(0.8);
        	transform: translateX(-50%) translateY(-50%);`)),r(h,k)};C(xt,h=>{e(p)&&h(ia)})}var na=s(xt,2);cn(na,{modalController:S}),m((h,k,O)=>Ae(X,`deck_editor
         screen_size_${h??""}
         left_pain_mode_${k??""}
         main_view_mode_${O??""}
         ${(e(p)?"dragging_card":"")??""}
          svelte-1m129ml`),[z,()=>e(R).toLowerCase(),()=>e(q).toLowerCase()],de),V("click",H,I),V("click",ie,()=>_(["name"])),Ot(te,()=>e(n).name,h=>be(n,e(n).name=h)),V("click",Ie,()=>_(["deckCardKinds"])),V("click",et,()=>_(["others"])),oe(3,st,()=>xe,()=>({delay:0,duration:100})),V("focusin",D,()=>{$(R,"SearchCondition"),$(q,"SearchCondition")}),V("click",D,()=>{$(R,"SearchCondition"),$(q,"SearchCondition")}),V("click",Ut,()=>{$(q,"DeckEdit")}),V("focusin",Ut,()=>{$(q,"DeckEdit")}),V("touchmove",X,h=>e(p)&&ge.onCardDragging(h,"Overlay")),V("mousemove",X,h=>e(p)&&ge.onCardDragging(h,"Overlay")),r(f,Q),ut()}const Nn=["TblDeckHeader","TblDeckDetail","TblDuelistProfile"],Fn=3;var In=l('<input class="game_mode_radio svelte-sy4ydn" type="radio" name="game_mode"> <label> </label>',1),On=l('<option class="svelte-sy4ydn"> </option>'),Rn=l('<option class="svelte-sy4ydn"> </option>'),Kn=l('<option class="svelte-sy4ydn"> </option>'),Wn=l('<tr class="config_row svelte-sy4ydn"><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><label for="npc_deck_selector" class="config_row_label deck_selector svelte-sy4ydn">デッキ：</label></div></td><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><select id="npc_deck_selector" class="deck_selector svelte-sy4ydn"><option class="svelte-sy4ydn">デフォルト</option><!></select></div></td></tr>'),zn=l('<option class="svelte-sy4ydn"> </option>'),Vn=l('<tr class="config_row svelte-sy4ydn"><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><label for="npc_selector" class="config_row_label npc_selector svelte-sy4ydn">対戦相手：</label></div></td><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><select id="npc_selector" class="npc_selector svelte-sy4ydn"></select> <div class="svelte-sy4ydn"> </div></div></td></tr> <!> <tr class="config_row svelte-sy4ydn"><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><label for="npc_selector" class="config_row_label npc_selector svelte-sy4ydn">先攻後攻：</label></div></td><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><select id="npc_selector" class="npc_selector svelte-sy4ydn"></select></div></td></tr>',1),Xn=l('<option class="svelte-sy4ydn"> </option>'),Gn=l('<tr class="config_row svelte-sy4ydn"><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><label for="difficulty_selector" class="config_row_label difficulty_selector svelte-sy4ydn">難易度：</label></div></td><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><select id="difficulty_selector" class="difficulty_selector svelte-sy4ydn"></select></div></td></tr>'),Qn=l('<tr class="config_row svelte-sy4ydn"><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><label class="config_row_label svelte-sy4ydn" for="game_mode_radio_preset">ゲームモード：</label></div></td><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"></div></td></tr> <tr class="config_row svelte-sy4ydn"><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><label for="deck_selector" class="config_row_label deck_selector svelte-sy4ydn">デッキ：</label></div></td><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><select id="deck_selector" class="deck_selector svelte-sy4ydn"></select></div></td></tr> <!> <tr><td colspan="2" class="svelte-sy4ydn"><div><button class="btn svelte-sy4ydn">duel start!</button></div></td></tr>',1),Jn=l('<tr><td colspan="2" class="svelte-sy4ydn"><div>デッキ情報の読み込み、もしくは作成中...</div></td></tr>'),Zn=l('<tr><td colspan="2" class="svelte-sy4ydn"><div><button class="btn svelte-sy4ydn">deck edit</button></div></td></tr>'),el=l('<tr class="config_row svelte-sy4ydn"><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><label for="duelist_name" class="config_row_label duelist_name svelte-sy4ydn">名前：</label></div></td><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><input id="duelist_name" class="duelist_name svelte-sy4ydn" type="text"></div></td></tr> <!> <!>',1),tl=l('<tr><td colspan="2" class="svelte-sy4ydn"><div>デュエリスト情報の読み込み、もしくは作成中...</div></td></tr>'),al=l('<div class="app_body svelte-sy4ydn"><table class="config_table svelte-sy4ydn"><tbody><!></tbody></table></div>'),rl=l('<span class="svelte-sy4ydn"> </span> <span class="svelte-sy4ydn"> </span>',1),sl=l('<div class="result_title result_win svelte-sy4ydn">YOU WIN</div>'),il=l('<div class="result_title result_lose svelte-sy4ydn">YOU LOSE</div>'),nl=l('<div class="result_title result_draw svelte-sy4ydn">DRAW</div>'),ll=l('<div class="twitter_share_button_wrapper svelte-sy4ydn"><a rel="nofollow" target="_blank" class="twitter_share_button svelte-sy4ydn">X(twitter)でシェアする</a></div>'),ol=l('<div class="result svelte-sy4ydn"><!> <div class="reason_of_end svelte-sy4ydn"> </div> <!> <div class="svelte-sy4ydn"><button class="white_button svelte-sy4ydn">TOPへ戻る</button></div></div>'),dl=l('<main style="flex-direction: column; display :flex" class="svelte-sy4ydn"><div class="link link_left svelte-sy4ydn"><a href="https://github.com/Setta238/stk_ygo_svelte" target="_blank" rel="noopener noreferrer" title="repository" class="svelte-sy4ydn">repository</a> <a href="https://x.com/ninja_no" target="_blank" rel="noopener noreferrer" title="repository" class="svelte-sy4ydn">X(Twitter)</a> <a href="https://posfie.com/@ninja_no/p/Lx7FLj3" target="_blank" rel="noopener noreferrer" title="posfie" class="svelte-sy4ydn">posfie(toggeter)</a></div> <div class="link link_right svelte-sy4ydn"><a class="a_button svelte-sy4ydn" role="button" tabindex="0">TOPへ戻る</a> <a href="/stk_ygo_svelte/note.html" target="_blank" rel="noopener noreferrer" title="repository" class="svelte-sy4ydn">現時点とこの先のこと</a></div> <!> <div class="footer card_summary svelte-sy4ydn"><!></div> <div class="footer debug_info svelte-sy4ydn"><span class="svelte-sy4ydn"> </span> <span class="user_agent_info svelte-sy4ydn"> </span> <span class="screen_info svelte-sy4ydn"> </span></div> <!></main>');function vl(f,i){ct(i,!1);const t=new xr("stk_ygo_svelte",Fn,Nn);let o=ne(0),g=ne(0),c=ne(),u=ne("FtkChallenge"),d=ne("None"),B=ne(0),A=ne(""),S=ne(void 0);const M="https://setta238.github.io/stk_ygo_svelte/",n="遊戯王deそりてあ",q="ninja_no",R=wr.getOrCreateNew(t).then(T=>($(u,Na.includes(T.previousGameMode)?T.previousGameMode:"FtkChallenge"),Ee(T.previousNpcId),T)),I=T=>{var v;const D=T.find(y=>y.lastUsedAt.getTime()===Math.max(...T.map(H=>H.lastUsedAt.getTime())))??T[0];$(B,D.id),e(u)==="FtkChallenge"&&D.deckType!=="Preset"&&$(B,((v=zt.find(y=>y.deckType==="Preset"))==null?void 0:v.id)??e(B))};let _=ne(Dt.getAllDeckInfo(t).then(T=>(Promise.all(T.filter(D=>!D.lastUsedAt).map(D=>{D.saveDeckInfo()})),I(T),T)));const p=async()=>{const T=e(B);let D=(await e(_)).find(y=>y.id===T)??(await Z()).find(y=>y.id===T);D&&await D.updateTimestamp();let v=D;if(v||(v=zt.find(y=>y.id===T)),!v)throw new Error("illegal state");return v},K=async()=>{(await R).save({previousGameMode:e(u)})},Z=()=>($(_,Dt.getAllDeckInfo(t).then(T=>(I(T),T))),e(_)),Ce=async()=>{(await e(_)).length||(await Dt.prepareSampleDeck(),Z())},j=async()=>{await Promise.all([K(),Ce()]);const T=await p(),D=await R;let v=Zt.find(G=>G.id===Number.MIN_SAFE_INTEGER)??Zt[0],y=zt.find(G=>G.id===Number.MIN_SAFE_INTEGER)??zt[0],H="PlayFirst";e(u)==="FtkChallenge"?v=Zt.filter(G=>G.npcType==="FtkChallenge").find(G=>G.difficulty===D.previousDifficulty)??v:e(u)==="Free"&&(v=Zt.find(G=>G.id===D.previousNpcId)??v,y=zt.slice(-1)[0],H=D.previousStartMode),v.npcType!=="FtkChallenge"&&D.previousNpcDeckId>-1?y=(await e(_)).find(G=>G.id===D.previousNpcDeckId)??y:y=zt.find(G=>G.id===v.id)??y,$(c,new Sr(D,"Player",T,[],v,"NPC",y,[],H)),e(c).onDuelEnd.append(()=>($(c,e(c)),"RemoveMe"))},U=async()=>{await Promise.all([K(),Ce()]),$(d,"DeckEdit")},ve=async T=>{await K(),T.key==="Enter"&&!T.repeat&&(await R).save()},Me=()=>{$(_,Z()),$(c,void 0),$(d,"None")};let ge=Date.now();const le=T=>{Date.now()-ge<200||(ge=Date.now(),$(u,T),Z())},se=T=>{Ee(Number(T.currentTarget.value))},Ee=T=>{var D;$(S,Zt.find(v=>v.id===T)),$(A,((D=e(S))==null?void 0:D.description)??"")};Ce(),_t();var ye=dl(),Y=s(a(ye),2),N=a(Y),fe=s(Y,2);{var ae=T=>{var D=we(),v=P(D);mt(v,()=>R,null,(y,H)=>{Ci(y,{get duel(){return e(c)},get userProfile(){return e(H)}})}),r(T,D)},Te=T=>{var D=we(),v=P(D);{var y=G=>{Pn(G,{})},H=G=>{var De=al(),$e=a(De),me=a($e),ie=a(me);mt(ie,()=>R,re=>{var te=tl();r(re,te)},(re,te)=>{var Se=el(),Re=P(Se),Ie=a(Re),Ke=a(Ie),Ue=s(Ie),Ge=a(Ue),lt=a(Ge),Ye=s(Re,2);mt(Ye,()=>e(_),He=>{var We=Jn();r(He,We)},(He,We)=>{var st=Qn(),Xe=P(st),et=a(Xe),$t=a(et),vt=s(et),St=a(vt);ce(St,5,()=>Na,_e,(J,pe)=>{var Pe=In(),he=P(Pe),Ne=s(he,2),ze=a(Ne);m(Ve=>{rt(he,"id",`game_mode_radio_${Ve??""}`),Dr(he,e(pe)),$r(he,e(u)===e(pe)),Ae(Ne,`game_mode_tab_label game_mode_tab_${Ve??""} svelte-sy4ydn`),rt(Ne,"for",`game_mode_radio_${Ve??""}`),b(ze,e(pe))},[()=>e(pe).toLowerCase()],de),V("change",he,()=>le(e(pe))),r(J,Pe)});var jt=s(Xe,2),Yt=a(jt),sa=a(Yt),Ut=s(Yt),Qt=a(Ut),kt=a(Qt);m(()=>{e(B),Et(()=>{e(u),e(We)})}),ce(kt,5,()=>e(u)==="FtkChallenge"?zt.filter(J=>J.deckType==="Preset"):e(We),_e,(J,pe)=>{var Pe=On(),he={},Ne=a(Pe);m(()=>{he!==(he=e(pe).id)&&(Pe.value=(Pe.__value=e(pe).id)==null?"":e(pe).id),b(Ne,e(pe).name)}),r(J,Pe)});var Mt=s(jt,2);{var xt=J=>{var pe=Vn(),Pe=P(pe),he=a(Pe),Ne=a(he),ze=s(he),Ve=a(ze),tt=a(Ve);m(()=>{e(te),Et(()=>{})}),ce(tt,5,()=>Zt,_e,(ot,Qe)=>{var dt=Rn(),yt={},ht=a(dt);m(()=>{yt!==(yt=e(Qe).id)&&(dt.value=(dt.__value=e(Qe).id)==null?"":e(Qe).id),b(ht,e(Qe).name)}),r(ot,dt)});var Je=s(tt,2),Ht=a(Je),Tt=s(Pe,2);{var wt=ot=>{var Qe=Wn(),dt=a(Qe),yt=a(dt),ht=s(dt),Jt=a(ht),Ze=a(Jt);m(()=>{e(te),Et(()=>{e(We)})});var it=a(Ze);it.value=(it.__value=Number.MIN_SAFE_INTEGER)==null?"":Number.MIN_SAFE_INTEGER;var Be=s(it);ce(Be,1,()=>e(We),_e,(qe,Oe)=>{var Fe=Kn(),Ct={},Ft=a(Fe);m(()=>{Ct!==(Ct=e(Oe).id)&&(Fe.value=(Fe.__value=e(Oe).id)==null?"":e(Oe).id),b(Ft,e(Oe).name)}),r(qe,Fe)}),oe(3,yt,()=>xe,()=>({duration:200})),oe(3,dt,()=>xe,()=>({duration:200})),Rt(Ze,()=>e(te).previousNpcDeckId,qe=>e(te).previousNpcDeckId=qe),oe(3,Jt,()=>xe,()=>({duration:200})),oe(3,ht,()=>xe,()=>({duration:200})),oe(3,Qe,()=>xe,()=>({duration:200})),r(ot,Qe)};C(Tt,ot=>{var Qe;((Qe=e(S))==null?void 0:Qe.npcType)!=="FtkChallenge"&&ot(wt)})}var gt=s(Tt,2),pt=a(gt),Pt=a(pt),At=s(pt),Nt=a(At),Wt=a(Nt);m(()=>{e(te),Et(()=>{})}),ce(Wt,5,()=>Xt(Fa),_e,(ot,Qe)=>{var dt=zn(),yt={},ht=a(dt);m(()=>{yt!==(yt=e(Qe))&&(dt.value=(dt.__value=e(Qe))==null?"":e(Qe)),b(ht,Fa[e(Qe)])}),r(ot,dt)}),m(()=>b(Ht,`※${e(A)??""}`)),oe(3,Ne,()=>xe,()=>({duration:200})),oe(3,he,()=>xe,()=>({duration:200})),V("change",tt,se),Rt(tt,()=>e(te).previousNpcId,ot=>e(te).previousNpcId=ot),oe(3,Ve,()=>xe,()=>({duration:200})),oe(3,ze,()=>xe,()=>({duration:200})),oe(3,Pe,()=>xe,()=>({duration:200})),oe(3,Pt,()=>xe,()=>({duration:200})),oe(3,pt,()=>xe,()=>({duration:200})),Rt(Wt,()=>e(te).previousStartMode,ot=>e(te).previousStartMode=ot),oe(3,Nt,()=>xe,()=>({duration:200})),oe(3,At,()=>xe,()=>({duration:200})),oe(3,gt,()=>xe,()=>({duration:200})),r(J,pe)},ia=J=>{var pe=we(),Pe=P(pe);{var he=Ne=>{var ze=Gn(),Ve=a(ze),tt=a(Ve),Je=s(Ve),Ht=a(Je),Tt=a(Ht);m(()=>{e(te),Et(()=>{})}),ce(Tt,5,()=>Mr,_e,(wt,gt)=>{var pt=Xn(),Pt={},At=a(pt);m(()=>{Pt!==(Pt=e(gt))&&(pt.value=(pt.__value=e(gt))==null?"":e(gt)),b(At,e(gt))}),r(wt,pt)}),oe(3,tt,()=>xe,()=>({duration:200})),oe(3,Ve,()=>xe,()=>({duration:200})),Rt(Tt,()=>e(te).previousDifficulty,wt=>e(te).previousDifficulty=wt),oe(3,Ht,()=>xe,()=>({duration:200})),oe(3,Je,()=>xe,()=>({duration:200})),oe(3,ze,()=>xe,()=>({duration:200})),r(Ne,ze)};C(Pe,Ne=>{e(u)==="FtkChallenge"&&Ne(he)},!0)}r(J,pe)};C(Mt,J=>{e(u)==="Free"?J(xt):J(ia,!1)})}var na=s(Mt,2),h=a(na),k=a(h),O=a(k);oe(3,$t,()=>xe,()=>({duration:200})),oe(3,et,()=>xe,()=>({duration:200})),oe(3,St,()=>xe,()=>({duration:200})),oe(3,vt,()=>xe,()=>({duration:200})),oe(3,Xe,()=>xe,()=>({duration:200})),oe(3,sa,()=>xe,()=>({duration:200})),oe(3,Yt,()=>xe,()=>({duration:200})),Rt(kt,()=>e(B),J=>$(B,J)),oe(3,Qt,()=>xe,()=>({duration:200})),oe(3,Ut,()=>xe,()=>({duration:200})),oe(3,jt,()=>xe,()=>({duration:200})),V("click",O,j),oe(3,k,()=>xe,()=>({duration:200})),r(He,st)});var ke=s(Ye,2);{var Le=He=>{var We=Zn(),st=a(We),Xe=a(st),et=a(Xe);V("click",et,U),oe(3,Xe,()=>xe,()=>({duration:200})),oe(3,st,()=>xe,()=>({duration:200})),oe(3,We,()=>xe,()=>({duration:200})),r(He,We)};C(ke,He=>{e(u)==="Free"&&He(Le)})}oe(3,Ke,()=>xe,()=>({duration:200})),oe(3,Ie,()=>xe,()=>({duration:200})),Ot(lt,()=>e(te).name,He=>e(te).name=He),V("keypress",lt,ve),oe(3,Ge,()=>xe,()=>({duration:200})),oe(3,Ue,()=>xe,()=>({duration:200})),oe(3,Re,()=>xe,()=>({duration:200})),r(re,Se)}),r(G,De)};C(v,G=>{e(d)==="DeckEdit"?G(y):G(H,!1)},!0)}r(T,D)};C(fe,T=>{e(c)?T(ae):T(Te,!1)})}var E=s(fe,2),x=a(E);mt(x,()=>oa,T=>{var D=at("読み込み中");r(T,D)},(T,D)=>{var v=rl(),y=P(v),H=a(y),G=s(y,2),De=a(G);m(($e,me,ie)=>{b(H,`公式DB上のカード${$e??""}枚`),b(De,`実装済カード（効果あり）${me??""}枚 （効果なし）${ie??""}枚`)},[()=>e(D).knmCount.toLocaleString(),()=>e(D).definitionCount.toLocaleString(),()=>e(D).nonDefinitionCount.toLocaleString()],de),r(T,v)});var L=s(E,2),W=a(L),ee=a(W),w=s(W,2),F=a(w),z=s(w,2),Q=a(z),X=s(L,2);{var ue=T=>{var D=ol(),v=a(D);{var y=te=>{var Se=we(),Re=P(Se);{var Ie=Ue=>{var Ge=sl();r(Ue,Ge)},Ke=Ue=>{var Ge=we(),lt=P(Ge);{var Ye=ke=>{var Le=il();r(ke,Le)};C(lt,ke=>{e(c).winner.seat==="Above"&&ke(Ye)},!0)}r(Ue,Ge)};C(Re,Ue=>{e(c).winner.seat==="Below"?Ue(Ie):Ue(Ke,!1)})}r(te,Se)},H=te=>{var Se=nl();r(te,Se)};C(v,te=>{e(c).winner?te(y):te(H,!1)})}var G=s(v,2),De=a(G),$e=s(G,2);{var me=te=>{var Se=ll(),Re=a(Se);m(()=>rt(Re,"href",`https://x.com/share?url=${M}&text=${e(c).twitterShareText??""}&hashtags=${n}&via=${q}`)),r(te,Se)};C($e,te=>{e(c).twitterShareText&&te(me)})}var ie=s($e,2),re=a(ie);m(()=>b(De,e(c).reasonOfEnd)),V("click",re,Me),oe(3,D,()=>jr,()=>({delay:200,duration:200})),r(T,D)};C(X,T=>{e(c)&&e(c).isEnded&&T(ue)})}m(()=>{b(ee,"build at: 20260123_123737"),b(F,Cr.text),b(Q,`w:${e(o)??""}px h:${e(g)??""}px`)}),ua("innerWidth",T=>$(o,T)),ua("innerHeight",T=>$(g,T)),V("click",N,Me),r(f,ye),ut()}Tr(vl,{target:document.getElementById("app")});
