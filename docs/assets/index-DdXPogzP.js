var Za=Object.defineProperty;var ja=_=>{throw TypeError(_)};var es=(_,i,t)=>i in _?Za(_,i,{enumerable:!0,configurable:!0,writable:!0,value:t}):_[i]=t;var rt=(_,i,t)=>es(_,typeof i!="symbol"?i+"":i,t),Ea=(_,i,t)=>i.has(_)||ja("Cannot "+t);var ft=(_,i,t)=>(Ea(_,i,"read from private field"),t?t.call(_):i.get(_)),na=(_,i,t)=>i.has(_)?ja("Cannot add the same private member more than once"):i instanceof WeakSet?i.add(_):i.set(_,t),ha=(_,i,t,v)=>(Ea(_,i,"write to private field"),v?v.call(_,t):i.set(_,t),t);import{s as Ba,r as ts,a as C,b as as,l as ss,g as e,d as Ka,p as ct,c as Pe,m as _e,i as _t,t as o,e as a,f as x,h as p,j as ve,k as je,n as it,o as Z,q as s,u as ut,v as ke,D as rs,w as $e,x as H,y as r,z as ce,A as Wt,B as oe,C as me,E as y,F as is,G as Qe,H as Kt,I as ns,J as os,K as zt,L as ba,M as za,N as la,O as wa,P as oa,Q as pt,R as $a,S as ma,T as Sa,U as va,V as ca,W as Va,X as ga,Y as ya,Z as ls,_ as vs,$ as ds,a0 as cs,a1 as _s,a2 as us,a3 as fs,a4 as _a,a5 as Xa,a6 as ps,a7 as ea,a8 as ka,a9 as ms,aa as Ga,ab as ua,ac as At,ad as gs,ae as ys,af as ta,ag as hs,ah as Dt,ai as bs,aj as ws,ak as ks,al as Aa,am as La,an as Ya,ao as qa,ap as Ua,aq as Pa,ar as xs,as as Ft,at as Ht,au as jt,av as Cs,aw as Zt,ax as Ds,ay as $s,az as Na,aA as Jt,aB as Rt,aC as Ss,aD as Ts,aE as Ha,aF as Ms,aG as js,aH as Es}from"../chunk/entity_proc_20260120_201717.js";import"../chunk/json_20260120_201717.js";(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const m of document.querySelectorAll('link[rel="modulepreload"]'))v(m);new MutationObserver(m=>{for(const c of m)if(c.type==="childList")for(const u of c.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&v(u)}).observe(document,{childList:!0,subtree:!0});function t(m){const c={};return m.integrity&&(c.integrity=m.integrity),m.referrerPolicy&&(c.referrerPolicy=m.referrerPolicy),m.crossOrigin==="use-credentials"?c.credentials="include":m.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function v(m){if(m.ep)return;m.ep=!0;const c=t(m);fetch(m.href,c)}})();const Bs=_=>_;function Ta(_){const i=_-1;return i*i*i+1}function Fa(_){const i=typeof _=="string"&&_.match(/^\s*(-?[\d.]+)([^\s]*)\s*$/);return i?[parseFloat(i[1]),i[2]||"px"]:[_,"px"]}function As(_,{delay:i=0,duration:t=400,easing:v=Bs}={}){const m=+getComputedStyle(_).opacity;return{delay:i,duration:t,easing:v,css:c=>`opacity: ${c*m}`}}function Ls(_,{delay:i=0,duration:t=400,easing:v=Ta,x:m=0,y:c=0,opacity:u=0}={}){const d=getComputedStyle(_),q=+d.opacity,W=d.transform==="none"?"":d.transform,S=q*(1-u),[D,n]=Fa(m),[L,Q]=Fa(c);return{delay:i,duration:t,easing:v,css:(G,P)=>`
			transform: ${W} translate(${(1-G)*D}${n}, ${(1-G)*L}${Q});
			opacity: ${q-S*P}`}}function xe(_,{delay:i=0,duration:t=400,easing:v=Ta,axis:m="y"}={}){const c=getComputedStyle(_),u=+c.opacity,d=m==="y"?"height":"width",q=parseFloat(c[d]),W=m==="y"?["top","bottom"]:["left","right"],S=W.map(j=>`${j[0].toUpperCase()}${j.slice(1)}`),D=parseFloat(c[`padding${S[0]}`]),n=parseFloat(c[`padding${S[1]}`]),L=parseFloat(c[`margin${S[0]}`]),Q=parseFloat(c[`margin${S[1]}`]),G=parseFloat(c[`border${S[0]}Width`]),P=parseFloat(c[`border${S[1]}Width`]);return{delay:i,duration:t,easing:v,css:j=>`overflow: hidden;opacity: ${Math.min(j*20,1)*u};${d}: ${j*q}px;padding-${W[0]}: ${j*D}px;padding-${W[1]}: ${j*n}px;margin-${W[0]}: ${j*L}px;margin-${W[1]}: ${j*Q}px;border-${W[0]}-width: ${j*G}px;border-${W[1]}-width: ${j*P}px;min-${d}: 0`}}function Ia(_,i){for(const t in i)_[t]=i[t];return _}function Ys({fallback:_,...i}){const t=new Map,v=new Map;function m(u,d,q){const{delay:W=0,duration:S=U=>Math.sqrt(U)*30,easing:D=Ta}=Ia(Ia({},i),q),n=u.getBoundingClientRect(),L=d.getBoundingClientRect(),Q=n.left-L.left,G=n.top-L.top,P=n.width/L.width,j=n.height/L.height,ee=Math.sqrt(Q*Q+G*G),ue=getComputedStyle(d),B=ue.transform==="none"?"":ue.transform,b=+ue.opacity;return{delay:W,duration:typeof S=="function"?S(ee):S,easing:D,css:(U,ne)=>`
			   opacity: ${U*b};
			   transform-origin: top left;
			   transform: ${B} translate(${ne*Q}px,${ne*G}px) scale(${U+(1-U)*P}, ${U+(1-U)*j});
		   `}}function c(u,d,q){return(W,S)=>(u.set(S.key,W),()=>{if(d.has(S.key)){const D=d.get(S.key);return d.delete(S.key),m(D,W,S)}return u.delete(S.key),_&&_(W,S,q)})}return[c(v,t,!1),c(t,v,!0)]}function Oa(_){return Object.prototype.toString.call(_)==="[object Date]"}function qs(_){return _}function xa(_){const i=_-1;return i*i*i+1}function Ca(_,i){if(_===i||_!==_)return()=>_;const t=typeof _;if(t!==typeof i||Array.isArray(_)!==Array.isArray(i))throw new Error("Cannot interpolate values of different type");if(Array.isArray(_)){const v=i.map((m,c)=>Ca(_[c],m));return m=>v.map(c=>c(m))}if(t==="object"){if(!_||!i)throw new Error("Object cannot be null");if(Oa(_)&&Oa(i)){const c=_.getTime(),d=i.getTime()-c;return q=>new Date(c+q*d)}const v=Object.keys(i),m={};return v.forEach(c=>{m[c]=Ca(_[c],i[c])}),c=>{const u={};return v.forEach(d=>{u[d]=m[d](c)}),u}}if(t==="number"){const v=i-_;return m=>_+m*v}return()=>i}var Lt,aa,da,Vt;const Ma=class Ma{constructor(i,t={}){na(this,Lt,Ba(void 0));na(this,aa,Ba(void 0));na(this,da);na(this,Vt,null);ft(this,Lt).v=ft(this,aa).v=i,ha(this,da,t)}static of(i,t){const v=new Ma(i(),t);return ts(()=>{v.set(i())}),v}set(i,t){var D;C(ft(this,aa),i);let{delay:v=0,duration:m=400,easing:c=qs,interpolate:u=Ca}={...ft(this,da),...t};if(m===0)return(D=ft(this,Vt))==null||D.abort(),C(ft(this,Lt),i),Promise.resolve();const d=as.now()+v;let q,W=!1,S=ft(this,Vt);return ha(this,Vt,ss(n=>{if(n<d)return!0;if(!W){W=!0;const Q=ft(this,Lt).v;q=u(Q,i),typeof m=="function"&&(m=m(Q,i)),S==null||S.abort()}const L=n-d;return L>m?(C(ft(this,Lt),i),!1):(C(ft(this,Lt),q(c(L/m))),!0)})),ft(this,Vt).promise}get current(){return e(ft(this,Lt))}get target(){return e(ft(this,aa))}set target(i){this.set(i)}};Lt=new WeakMap,aa=new WeakMap,da=new WeakMap,Vt=new WeakMap;let fa=Ma;var Us=o('<div class="phase_display svelte-1boxe40"><span class="svelte-1boxe40"> </span> </div>'),Ps=o('<div class="lifepoint_display svelte-1boxe40"><div class="svelte-1boxe40"> </div> <div class="svelte-1boxe40"> </div></div>'),Ns=(_,i,t)=>i(e(t)),Hs=o('<div class="svelte-1boxe40"><button class="phase_button svelte-1boxe40"> </button></div>'),Fs=o("<div><!></div>"),Is=o('<div class="svelte-1boxe40"><!></div>'),Os=o("<div><!></div>"),Rs=o('<div class="config_button_wrapper svelte-1boxe40"><button id="config_button" class="svelte-1boxe40">⚙</button></div>'),Ws=o("<!> <!> <!> <!>",1),Ks=o('<div style="position: absolute;" class="card_animation_receiver svelte-1boxe40"><!></div>'),zs=o('<div style="position: absolute; top:0rem" class="svelte-1boxe40">｛効果対象｝</div>'),Vs=o('<!> <div style="position: absolute; display:flex;justify-content: center;"><!></div>',1),Xs=o(" <!> 】",1),Gs=o('<div style="position: absolute; bottom:0rem" class="svelte-1boxe40"> <!></div>'),Qs=o("<!> <!>",1),Js=o('<div class="badge svelte-1boxe40"> </div>'),Zs=o('<div class="card_animation_receiver svelte-1boxe40"><!></div>'),er=o("<!> <!> <!> <!>",1),tr=o('<td><div role="listitem"><!></div></td>');function ar(_,i){ct(i,!1);let t=Pe(i,"view",12),v=Pe(i,"row",8),m=Pe(i,"column",8),c=Pe(i,"selectedEntities",28,()=>[]),u=Pe(i,"selectedCells",28,()=>[]),d=_e(t().getCell(v(),m())),q=_e(new fa(e(d).field.duel.duelists.Above.lp,{duration:400,easing:xa})),W=_e(new fa(e(d).field.duel.duelists.Below.lp,{duration:400,easing:xa}));const S=()=>{C(d,t().getCell(v(),m())),ke(q,e(q).target=e(d).field.duel.duelists.Above.lp),ke(W,e(W).target=e(d).field.duel.duelists.Below.lp)};e(d).onUpdate.append(S),t().onDuelUpdate.append(S),t().modalController.onUpdate.append(S);let D,n=_e([]),L=()=>console.log("hoge"),Q,G=_e([]),P=_e(!1),j=_e(!1),ee=!1;const ue=w=>{var $,A;C(ie,[]),c().reset(),D=w.activator,L=w.resolve,C(n,w.dummyActionInfos),C(G,w.chainBlockInfos.flatMap(I=>I.selectedEntities).getDistinct()),Q=w.entitiesChoices,C(P,!1),C(j,(($=w.cellsChoices)==null?void 0:$.selectables.includes(e(d)))??!1),ee=e(j)&&((A=w.cellsChoices)==null?void 0:A.qty)===1,S()};t().onWaitStart.append(ue);const B=()=>{D=void 0,C(n,[]),L=()=>{console.log("hoge")},Q=void 0,C(G,[]),C(P,!1),C(j,!1),ee=!1};t().onWaitEnd.append(B);let b=_e(!1),U=[];const ne=w=>{U=w.filter($=>$.dests.includes(e(d))),C(b,U.length>0),S()},Ce=()=>{U=[],C(b,!1),S()};t().onDragStart.append(ne),t().onDragEnd.append(Ce);const[he,fe]=pi;let ie=_e([]);const Ee=w=>{if(D=void 0,e(d)===w.to||e(d).entities.includes(w.entity)){C(ie,[...e(ie),w]);const $=w.resolve;C(d,e(d)),setTimeout(()=>{C(ie,e(ie).filter(A=>A!==w)),w.count++,w.count>1&&$()},600)}};t().onAnimation.append(Ee);const De=w=>{L({phaseChange:w})},F=()=>e(d).isStackCell&&e(d).entities.flatMap(w=>w.actions).filter(w=>e(n).map($=>$.action.seq).some($=>$===w.seq)).length>0,K=w=>{var $;if((($=w.target)==null?void 0:$.id)==="config_button"){t(t().infoBoardState="Config",!0),t().requireUpdate();return}if(t(t().infoBoardState="Default",!0),ee)L({selectedCells:[e(d)]});else if(e(j))C(P,!e(P)),u(e(P)?[...u(),e(d)]:u().filter(A=>A!==e(d)));else if(e(d).isStackCell){t(t().infoBoardState="CellInfo",!0),t(t().infoBoardCell=e(d),!0),t().requireUpdate();const A=e(d).entities.flatMap(O=>O.actions).map(O=>O.seq),I=e(n).filter(O=>A.includes(O.action.seq));if(I.length){if(!D)return;t().modalController.actionSelector.show({title:"カードを選択。",position:"Bottom",activator:D,dummyActionInfos:I,cancelable:!0}).then(O=>{O&&L({actionInfo:O})});return}}t().requireUpdate(),console.info(e(d),Me(...e(d).visibleEntities))},pe=w=>{w.preventDefault(),w.dataTransfer&&(w.dataTransfer.dropEffect="move")},re=w=>{w.preventDefault(),console.info("drop",w,e(b),U),w.dataTransfer&&(w.dataTransfer.dropEffect="move");try{if(e(b)&&U){if(U.length===1){const $=U[0];L({actionInfo:{...$,dest:e(d)}})}else if(U.length>1){if(!D)throw new rs("想定されない状態");e(d).field.duel.view.modalController.terminateAll(),e(d).field.duel.view.modalController.actionSelector.show({title:"選択",position:"Bottom",activator:D,dummyActionInfos:U.map($=>({...$,dest:e(d)})),cancelable:!1}).then($=>{L({actionInfo:$})})}}}finally{t().removeDraggingActions()}},Me=(...w)=>{if(t().waitMode==="Animation")return"Disabled";if(Q&&Q.selectables.find(A=>w.find(I=>A===I)))return"Selectable";if(!e(n)||e(n).length===0||t().waitMode!=="Free"||Object.values(t().modalController.modals).some(A=>A.state==="Shown"))return"Disabled";const $=e(n).filter(A=>w.includes(A.action.entity));return $.length===0?"Disabled":e(d).isStackCell||$[0].action.entity!==w[0]?"Clickable":$.some(A=>A.dests.length)?"Draggable":"Clickable"};_t();var E=tr(),T=a(E);T.__click=K;var N=a(T);{var X=w=>{var $=$e(),A=H($);{var I=O=>{var de=$e(),M=H(de);{var k=f=>{var Y=Us(),z=a(Y),ye=a(z),be=r(z,1,!0);p((le,ae)=>{y(ye,le),y(be,ae)},[()=>String(e(d).field.duel.clock.turn).padStart(2,"0"),()=>e(d).field.duel.phase.toUpperCase()],ve),s(f,Y)},l=f=>{var Y=$e(),z=H(Y);{var ye=le=>{var ae=Ps(),V=a(ae),se=a(V),Se=r(V,2),Fe=a(Se);p((He,Ie)=>{y(se,He),y(Fe,Ie)},[()=>Math.floor(e(q).current),()=>Math.floor(e(W).current)],ve),s(le,ae)},be=le=>{var ae=$e(),V=H(ae);{var se=Se=>{var Fe=$e(),He=H(Fe);{var Ie=Le=>{var Ve=$e(),nt=H(Ve);{var Ae=we=>{var Be=$e(),Ye=H(Be);ce(Ye,1,()=>t().duel.nextPhaseList,me,(Oe,tt)=>{var ze=Hs(),Je=a(ze);Je.__click=[Ns,De,tt];var $t=a(Je);p(vt=>y($t,vt),[()=>e(tt).toUpperCase()],ve),s(Oe,ze)}),s(we,Be)};x(nt,we=>{t().duel.isEnded||we(Ae)})}s(Le,Ve)};x(He,Le=>{t().waitMode==="Free"&&Le(Ie)})}s(Se,Fe)};x(V,Se=>{e(d).column===5&&Se(se)},!0)}s(le,ae)};x(z,le=>{e(d).column===3?le(ye):le(be,!1)},!0)}s(f,Y)};x(M,f=>{e(d).column===1?f(k):f(l,!1)})}s(O,de)};x(A,O=>{e(d).row===3&&O(I)})}s(w,$)},te=w=>{var $=$e(),A=H($);{var I=de=>{var M=Ws();const k=ve(()=>e(ie).find(ae=>ae.to===e(d)));var l=H(M);{var f=ae=>{var V=Fs(),se=a(V);Wt(se,{get entity(){return e(k).entity},state:"Disabled",dummyActionInfos:[],cardActionResolve:void 0}),p(()=>je(V,`card_animation_receiver ${e(d).cellType??""} svelte-1boxe40`)),oe(1,V,()=>fe,()=>({key:e(k).entity.seq})),s(ae,V)};x(l,ae=>{e(k)&&e(k).index==="Top"&&ae(f)})}var Y=r(l,2);ce(Y,1,()=>e(d).visibleEntities,me,(ae,V)=>{var se=$e(),Se=H(se);{var Fe=He=>{var Ie=Is(),Le=a(Ie);const Ve=ve(()=>Me(e(V))),nt=ve(()=>e(n).filter(Ae=>Ae.action.entity===e(V)));Wt(Le,{get entity(){return e(V)},get state(){return e(Ve)},get dummyActionInfos(){return e(nt)},cardActionResolve:void 0,get selectedList(){return c()},set selectedList(Ae){c(Ae)},$$legacy:!0}),oe(2,Ie,()=>he,()=>({key:e(V).seq})),s(He,Ie)};x(Se,He=>{e(ie).every(Ie=>Ie.entity.seq!==e(V).seq)&&He(Fe)})}s(ae,se)});var z=r(Y,2);{var ye=ae=>{var V=Os(),se=a(V);Wt(se,{get entity(){return e(k).entity},state:"Disabled",dummyActionInfos:[],cardActionResolve:void 0}),p(()=>je(V,`card_animation_receiver ${e(d).cellType??""} svelte-1boxe40`)),oe(1,V,()=>fe,()=>({key:e(k).entity.seq})),s(ae,V)};x(z,ae=>{e(k)&&e(k).index!=="Top"&&ae(ye)})}var be=r(z,2);{var le=ae=>{var V=Rs();s(ae,V)};x(be,ae=>{e(d).owner.seat==="Below"&&ae(le)})}s(de,M)},O=de=>{var M=er();const k=ve(()=>e(ie).find(V=>V.to===e(d)));var l=H(M);{var f=V=>{var se=Ks(),Se=a(se);Wt(Se,{get entity(){return e(k).entity},state:"Disabled",dummyActionInfos:[],cardActionResolve:void 0}),oe(1,se,()=>fe,()=>({key:e(k).entity.seq})),s(V,se)};x(l,V=>{e(k)&&e(k).index!=="Top"&&V(f)})}var Y=r(l,2);{var z=V=>{var se=Qs(),Se=H(se);ce(Se,1,()=>e(d).visibleEntities.map((Ie,Le)=>({index:Le,entity:Ie})).toReversed(),me,(Ie,Le)=>{var Ve=$e(),nt=H(Ve);{var Ae=we=>{var Be=Vs();const Ye=ve(()=>!e(d).isStackCell&&e(Le).index===0?Me(...e(d).visibleEntities):void 0);var Oe=H(Be);{var tt=vt=>{var St=zs();s(vt,St)};x(Oe,vt=>{e(G).includes(e(Le).entity)&&vt(tt)})}var ze=r(Oe,2),Je=a(ze);const $t=ve(()=>e(Le).index===0?e(n).filter(vt=>e(d).visibleEntities.includes(vt.action.entity)):void 0);Wt(Je,{get entity(){return e(Le).entity},get state(){return e(Ye)},get dummyActionInfos(){return e($t)},cardActionResolve:void 0,get selectedList(){return c()},set selectedList(vt){c(vt)},$$legacy:!0}),p(()=>je(ze,`duel_card_wrapper ${(e(Le).entity.exist?"duel_card_wrapper_exists":"")??""} svelte-1boxe40`)),oe(2,ze,()=>he,()=>({key:e(Le).entity.seq})),s(we,Be)};x(nt,we=>{e(ie).every(Be=>Be.entity.seq!==e(Le).entity.seq)&&we(Ae)})}s(Ie,Ve)});var Fe=r(Se,2);{var He=Ie=>{var Le=Gs(),Ve=a(Le),nt=r(Ve);ce(nt,1,()=>Kt(e(d).visibleEntities[0].status.maxCounterQty),me,(Ae,we)=>{var Be=Xs(),Ye=H(Be),Oe=r(Ye);{var tt=ze=>{var Je=Qe();p(()=>y(Je,`/${e(d).visibleEntities[0].status.maxCounterQty[e(we)]??""}`)),s(ze,Je)};x(Oe,ze=>{(e(d).visibleEntities[0].status.maxCounterQty[e(we)]??9999)<100&&ze(tt)})}p((ze,Je)=>y(Ye,`【
              ${ze??""}${Je??""} `),[()=>is(e(we)),()=>e(d).visibleEntities[0].counterHolder.getQty(e(we))],ve),s(Ae,Be)}),p(()=>y(Ve,`【${e(d).visibleEntities[0].battlePositionName??""}】 `)),s(Ie,Le)};x(Fe,Ie=>{e(d).visibleEntities[0].battlePosition&&Ie(He)})}s(V,se)};x(Y,V=>{e(d).visibleEntities.length>0&&V(z)})}var ye=r(Y,2);{var be=V=>{var se=Js(),Se=a(se);p(()=>y(Se,e(d).visibleEntities.length)),s(V,se)};x(ye,V=>{e(d).isStackCell&&V(be)})}var le=r(ye,2);{var ae=V=>{var se=Zs(),Se=a(se);Wt(Se,{get entity(){return e(k).entity},state:"Disabled",dummyActionInfos:[],cardActionResolve:void 0}),oe(1,se,()=>fe,()=>({key:e(k).entity.seq})),s(V,se)};x(le,V=>{e(k)&&e(k).index==="Top"&&V(ae)})}s(de,M)};x(A,de=>{e(d).cellType==="Hand"?de(I):de(O,!1)},!0)}s(w,$)};x(N,w=>{e(d).isDisabledCell?w(X):w(te,!1)})}p(w=>{je(E,`${`duel_field_cell duel_field_cell_${e(d).cellType} ${e(d).linkArrowSources.length===0?"":"duel_field_cell_linked"}`??""} svelte-1boxe40`),it(E,"colspan",e(d).cellType==="Hand"?7:1),je(T,`${w??""} svelte-1boxe40`)},[()=>`duel_field_cell_inner_box ${e(d).cellType} ${e(b)?"can_accept_drop":""} ${F()?"can_action":""} ${e(P)?"is_selected":e(j)?"is_selectable":""} `],ve),Z("dragover",T,pe),Z("drop",T,re),s(_,E),ut()}Ka(["click"]);const sr=(_,i,t=void 0,v="!!!circular reference!!!")=>{let m=[];return JSON.stringify(_,(c,u)=>{if(typeof u=="object"){if(m.indexOf(u)>-1)return v;m.push(u)}let d=u;if(i&&(d=i(c,u)),typeof d=="function")return d.toString();if(d!==u&&typeof d=="object"){if(m.indexOf(d)>-1)return v;m.push(d)}return d},t)};var rr=o('<div class="title svelte-14z6bdh"> </div>'),ir=o('<div class="title svelte-14z6bdh"> </div>'),nr=o('<div class="duel_log_chain_number svelte-14z6bdh"> </div>'),or=o('<div><a class="white_button" download="error_info.json">エラー情報ダウンロード</a></div>'),lr=o("<div><!> <!></div>"),vr=o('<div><div style="display: flex;    justify-content: space-between;"><div style=" white-space: nowrap;text-align: center;"> </div> <!></div> <!></div>'),dr=o("<div><!> <!></div>"),cr=o("<div><!> <!></div>"),_r=o('<div class="duel_log svelte-14z6bdh"><div class="duel_log_header svelte-14z6bdh"></div> <div class="duel_log_body svelte-14z6bdh"></div> <div class="duel_log_footer svelte-14z6bdh"></div></div>');function ur(_,i){ct(i,!1);let t=_e(void 0),v=Pe(i,"log",8),m,c=_e([]);const u=()=>{const S=((m==null?void 0:m.seq)??-1)+1;v().records.slice(S).forEach(D=>{if(!m){C(c,[[[[D]]]]),m=D;return}if(!e(c)[D.clock.turn]){ke(c,e(c)[D.clock.turn]=[[[D]]]),m=D;return}if(!e(c)[D.clock.turn][D.clock.phaseSeq]){ke(c,e(c)[D.clock.turn][D.clock.phaseSeq]=[[D]]),m=D;return}if(m.clock.chainSeq===D.clock.chainSeq&&m.clock.chainBlockSeq===D.clock.chainBlockSeq&&m.duelist===D.duelist){e(c)[D.clock.turn][D.clock.phaseSeq].slice(-1)[0].push(D),m=D;return}e(c)[D.clock.turn][D.clock.phaseSeq].push([D]),m=D}),C(c,e(c)),ns().then(()=>e(t)&&e(t).scroll(0,e(t).clientHeight*990))};v().onUpdate.append(u),v().duel.view.onDuelUpdate.append(u),u(),_t();var d=$e(),q=H(d);{var W=S=>{var D=_r(),n=r(a(D),2);ce(n,5,()=>e(c),me,(L,Q)=>{var G=cr(),P=a(G);{var j=ue=>{var B=rr(),b=a(B);p(()=>y(b,`ターン：${e(Q)[0][0][0].clock.turn??""}`)),s(ue,B)};x(P,ue=>{e(Q)[0][0][0].clock.turn>0&&ue(j)})}var ee=r(P,2);ce(ee,1,()=>e(Q),me,(ue,B)=>{var b=dr(),U=a(b);{var ne=he=>{var fe=ir(),ie=a(fe);p(()=>y(ie,e(B)[0][0].clock.period.name)),s(he,fe)};x(U,he=>{e(B)[0][0].clock.turn>0&&he(ne)})}var Ce=r(U,2);ce(Ce,1,()=>e(B),me,(he,fe)=>{var ie=vr();const Ee=ve(()=>{var E;return((E=e(fe).find(T=>T.chainNumber!==void 0))==null?void 0:E.chainNumber)??0});var De=a(ie),F=a(De),K=a(F),pe=r(F,2);{var re=E=>{var T=nr(),N=a(T);p(()=>y(N,`チェーン：${e(Ee)??""}`)),s(E,T)};x(pe,E=>{e(Ee)&&E(re)})}var Me=r(De,2);ce(Me,1,()=>e(fe),me,(E,T)=>{var N=lr(),X=a(N);{var te=I=>{var O=Qe();p(()=>y(O,e(T).text)),s(I,O)},w=I=>{var O=$e(),de=H(O);{var M=l=>{var f=Qe();p((Y,z,ye)=>y(f,`移動：${Y??""} ${z??""} ⇒ ${ye??""}`),[()=>{var Y;return(Y=e(T).mainEntity)==null?void 0:Y.toString()},()=>{var Y;return(Y=e(T).from)==null?void 0:Y.toString()},()=>{var Y;return(Y=e(T).to)==null?void 0:Y.toString()}],ve),s(l,f)},k=l=>{var f=$e(),Y=H(f);{var z=be=>{var le=Qe();p((ae,V)=>y(le,`生成：${ae??""} void ⇒ ${V??""}`),[()=>{var ae;return(ae=e(T).mainEntity)==null?void 0:ae.toString()},()=>{var ae;return(ae=e(T).to)==null?void 0:ae.toString()}],ve),s(be,le)},ye=be=>{var le=$e(),ae=H(le);{var V=Se=>{var Fe=Qe();p((He,Ie)=>y(Fe,`消滅：${He??""} ${Ie??""} ⇒ void`),[()=>{var He;return(He=e(T).mainEntity)==null?void 0:He.toString()},()=>{var He;return(He=e(T).from)==null?void 0:He.toString()}],ve),s(Se,Fe)},se=Se=>{var Fe=Qe();p(()=>y(Fe,e(T).text)),s(Se,Fe)};x(ae,Se=>{e(T).type==="EntityDisappear"?Se(V):Se(se,!1)},!0)}s(be,le)};x(Y,be=>{e(T).type==="EntityAppear"?be(z):be(ye,!1)},!0)}s(l,f)};x(de,l=>{e(T).type==="EntityMove"?l(M):l(k,!1)},!0)}s(I,O)};x(X,I=>{e(T).type==="ChainBlockHeader"?I(te):I(w,!1)})}var $=r(X,2);{var A=I=>{var O=or(),de=a(O);p(M=>it(de,"href",M),[()=>window.URL.createObjectURL(new Blob([sr(e(T).error,(M,k)=>["pool","bundles","duel"].includes(M)||typeof k=="function"?void 0:k,4)],{type:"text/plain"}))],ve),s(I,O)};x($,I=>{e(T).error&&I(A)})}p(I=>je(N,`duel_log_record duel_log_record_${I??""} svelte-14z6bdh`),[()=>e(T).type.toSnakeCase()],ve),s(E,N)}),p(()=>{var E,T,N;je(ie,`duel_log_block_duelist duel_log_block_duelist_${((E=e(fe)[0].duelist)==null?void 0:E.seat)??"system"} svelte-14z6bdh`),je(F,`duelist ${((T=e(fe)[0].duelist)==null?void 0:T.seat)??""} svelte-14z6bdh`),y(K,((N=e(fe)[0].duelist)==null?void 0:N.profile.name)||"SYSTEM")}),s(he,ie)}),p(()=>je(b,`duel_log_block_phase duel_log_block_phase_${e(B)[0][0].clock.period.key??""} svelte-14z6bdh`)),s(ue,b)}),p(()=>je(G,`duel_log_block_turn duel_log_block_turn_${e(Q)[0][0][0].clock.turn??""} svelte-14z6bdh`)),s(L,G)}),os(n,L=>C(t,L),()=>e(t)),s(S,D)};x(q,S=>{(v().duel.view.infoBoardState==="Log"||v().duel.view.infoBoardState==="Default")&&S(W)})}s(_,d),ut()}var fr=o("<div><div> </div> <div> </div></div>");function Ra(_,i){ct(i,!1);let t=Pe(i,"duelist",12),v=_e(0),m=_e();const c=async()=>{const n=t().lp-e(v);if(!e(m)||Math.abs(n)<10){C(v,t().lp),e(m)&&(e(m)(),C(m,void 0));return}C(v,e(v)+Math.floor(Math.random()*n)),await zt(100),c()},u=()=>{t(t()),!e(m)&&t().lp!==e(v)&&new Promise(n=>{C(m,n),Math.abs(t().lp-e(v)),c()})};t().duel.log.onUpdate.append(u),c(),_t();var d=fr(),q=a(d),W=a(q),S=r(q,2),D=a(S);p(n=>{je(d,`duelist duelist_${n??""} svelte-1sy3trd`),je(q,`duelist_name duelist_${n??""}_name svelte-1sy3trd`),y(W,t().profile.name),je(S,`duelist_lp ${(e(m)?"vibration":"")??""} svelte-1sy3trd`),y(D,e(v))},[()=>t().seat.toLowerCase()],ve),s(_,d),ut()}const pr=(_,i,t)=>(i(i()!=="Detail"?"Detail":"Normal"),console.info(t()),!0),mr=(_,i,t)=>(i(i()!=="Debug"?"Debug":"Normal"),console.info(t()),!0);var gr=o('<div class="svelte-1uevs9j"> </div>'),yr=o('<div class="svelte-1uevs9j"> </div>'),hr=o('<div class="link_arrow_emoji svelte-1uevs9j"> </div>'),br=o('<div class="duel_card_info_row svelte-1uevs9j" style=" justify-content: space-between;"><div class="svelte-1uevs9j"> </div> <div class="svelte-1uevs9j"> </div></div>'),wr=o('<div></div> <div class="svelte-1uevs9j"> </div>',1),kr=o("<div> </div>"),xr=o('<span class="svelte-1uevs9j">/</span> <div class="monster_defense svelte-1uevs9j"> </div>',1),Cr=o("<div> </div>"),Dr=o('<div class="duel_card_info_row svelte-1uevs9j"><!> <!> <div style="flex-grow: 1;" class="svelte-1uevs9j"></div> <div class="monster_attack svelte-1uevs9j"> </div> <!></div> <div class="duel_card_info_row svelte-1uevs9j"></div>',1),$r=o('<div class="duel_card_row svelte-1uevs9j"><div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"> </div></div>'),Sr=o('<div class="duel_card_row svelte-1uevs9j"><div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"> </div></div>'),Tr=o("<!> <!>",1),Mr=o('<pre class="description svelte-1uevs9j"> </pre>'),jr=o('<div class="duel_card_info_row svelte-1uevs9j" style="border-style: solid; border-width: 1px;"><!></div>'),Er=o('<pre class="description svelte-1uevs9j"> </pre>'),Br=o('<!> <div class="duel_card_info_row svelte-1uevs9j"><!></div>',1),Ar=o('<div class="effect_counter_area_item svelte-1uevs9j"><span class="svelte-1uevs9j"> </span> <span class="svelte-1uevs9j"> </span> <span class="svelte-1uevs9j">/</span> <span class="svelte-1uevs9j"> </span></div>'),Lr=o('<div class="duel_card_info_row effect_counter_area svelte-1uevs9j"><div class="effect_counter_area_title svelte-1uevs9j">効果使用状況</div> <div class="effect_counter_area_body svelte-1uevs9j"></div></div>'),Yr=o("[ <!> ],",1),qr=o('<div class="svelte-1uevs9j"> <!></div>'),Ur=o('<div class="svelte-1uevs9j"> </div> <!> <div class="svelte-1uevs9j"></div>',1),Pr=o('<div class="svelte-1uevs9j"> </div>'),Nr=o('<div class="svelte-1uevs9j"> </div>'),Hr=o('<div class="svelte-1uevs9j"> </div>'),Fr=o('<div class="svelte-1uevs9j"> </div>'),Ir=o('<div class="svelte-1uevs9j"> </div>'),Or=o('<div class="svelte-1uevs9j"> </div>'),Rr=o('<div class="duel_card_info_row svelte-1uevs9j"><div class="svelte-1uevs9j"><!> <div class="svelte-1uevs9j"></div> <!> <div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"></div> <!> <div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"></div> <!> <div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"></div> <!> <div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"></div> <!> <div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"></div> <!> <div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"> </div> <div class="svelte-1uevs9j"> </div> <div class="svelte-1uevs9j"> </div> <div class="svelte-1uevs9j"></div></div></div>'),Wr=o('<div class="svelte-1uevs9j">※エラッタ前のカードです</div>'),Kr=o('<div class="svelte-1uevs9j">※テスト用カードです</div>'),zr=o('<a target="_blank" rel="noopener noreferrer" title="コナミカードデータベース" class="svelte-1uevs9j"> </a>'),Vr=o('<a target="_blank" rel="noopener noreferrer" title="遊戯王カードWiki" class="svelte-1uevs9j">⇒遊戯王カードWiki</a>'),Xr=o('<div class="duel_card_info_links svelte-1uevs9j"><!> <!> <a target="_blank" rel="noopener noreferrer" title="google" class="svelte-1uevs9j">⇒google検索</a></div>'),Gr=o("<!> <!>",1),Qr=o('<div role="contentinfo"><div class="duel_card_info_header svelte-1uevs9j"><div class="duel_card_info_row svelte-1uevs9j"><div class="svelte-1uevs9j"> </div></div> <div class="duel_card_info_row svelte-1uevs9j" style="position:sticky; top:0;"><!> <div class="svelte-1uevs9j"> </div></div> <!></div> <div class="duel_card_info_body svelte-1uevs9j"><!></div> <div class="duel_card_info_footer svelte-1uevs9j"><!></div></div>');function Jr(_,i){ct(i,!1);let t=Pe(i,"entity",8),v=Pe(i,"mode",12,"Normal"),m=_e(new Promise(()=>{}));const c=()=>{var S,D;let W=t()&&t().entityType==="Card"?t().origin.cardId:(D=(S=t())==null?void 0:S.parent)==null?void 0:D.origin.cardId;return W??!1?`https://www.db.yugioh-card.com/yugiohdb/card_search.action?ope=2&cid=${W}`:t()?`https://www.db.yugioh-card.com/yugiohdb/card_search.action?ope=1&sess=1&rp=10&mode=&sort=1&keyword=${t().origin.name}&stype=1&ctype=&othercon=2&starfr=&starto=&pscalefr=&pscaleto=&linkmarkerfr=&linkmarkerto=&link_m=2&atkfr=&atkto=&deffr=&defto=&releaseDStart=1&releaseMStart=1&releaseYStart=1999&releaseDEnd=&releaseMEnd=&releaseYEnd=`:""};ba(()=>(oa(t()),wa),()=>{C(m,la.then(async W=>{if(t().origin.description||t().origin.pendulumDescription||t().origin.wikiEncodedName)return t().origin;const S=W.getCardInfo(t().origin.name);if(S)return S.cardId!==void 0&&!S.description&&!S.pendulumDescription&&await wa([S.cardId]),S}))}),za(),_t();var u=$e(),d=H(u);{var q=W=>{var S=Qr();S.__click=[pr,v,t],S.__contextmenu=[mr,v,t];var D=a(S),n=a(D),L=a(n),Q=a(L),G=r(n,2),P=a(G);{var j=F=>{var K=gr(),pe=a(K);p(re=>y(pe,re),[()=>"★".repeat(t().lvl)],ve),s(F,K)},ee=F=>{var K=$e(),pe=H(K);{var re=E=>{var T=yr(),N=a(T);p(X=>y(N,X),[()=>"☆".repeat(t().rank)],ve),s(E,T)},Me=E=>{var T=$e(),N=H(T);{var X=te=>{var w=hr(),$=a(w);p(A=>y($,A),[()=>t().origin.linkArrowKeys.map(A=>Va[A].emoji).join("")],ve),s(te,w)};x(N,te=>{t().origin.linkArrowKeys&&te(X)},!0)}s(E,T)};x(pe,E=>{t().rank&&t().rank>0?E(re):E(Me,!1)},!0)}s(F,K)};x(P,F=>{t().lvl&&t().lvl>0?F(j):F(ee,!1)})}var ue=r(P,2),B=a(ue),b=r(G,2);{var U=F=>{var K=Tr(),pe=H(K);{var re=N=>{var X=br(),te=a(X),w=a(te),$=r(te,2),A=a($);p(()=>{y(w,`◀ ${t().psL??""}`),y(A,`${t().psR??""} ▶`)}),s(N,X)};x(pe,N=>{var X;(X=t().origin.monsterCategories)!=null&&X.includes("Pendulum")&&N(re)})}var Me=r(pe,2);{var E=N=>{var X=Dr(),te=H(X),w=a(te);ce(w,1,()=>t().attr,me,(k,l)=>{var f=wr(),Y=H(f),z=r(Y,2),ye=a(z);p(()=>{je(Y,`monster_attr ${e(l)??""} svelte-1uevs9j`),y(ye,`${$a[e(l)]??""}属性`)}),s(k,f)});var $=r(w,2);ce($,1,()=>t().types,me,(k,l)=>{var f=kr(),Y=a(f);p(()=>{je(f,`monster_cat ${e(l)??""} svelte-1uevs9j`),y(Y,`${ma[e(l)]??""}${Sa[e(l)]??""}族`)}),s(k,f)});var A=r($,4),I=a(A),O=r(A,2);{var de=k=>{var l=xr(),f=r(H(l),2),Y=a(f);p(()=>y(Y,t().def??"?")),s(k,l)};x(O,k=>{var l;(l=t().status.monsterCategories)!=null&&l.includes("Link")||k(de)})}var M=r(te,2);ce(M,5,()=>t().status.monsterCategories??[],me,(k,l)=>{var f=Cr(),Y=a(f);p(()=>{je(f,`monster_cat ${e(l)??""} svelte-1uevs9j`),y(Y,`${va[e(l)]??""}${ca[e(l)]??""}`)}),s(k,f)}),p(()=>y(I,t().atk??"?")),s(N,X)},T=N=>{var X=$e(),te=H(X);{var w=A=>{var I=$r(),O=r(a(I),2),de=a(O);p(()=>y(de,`${ga[t().status.spellCategory]??""}魔法`)),s(A,I)},$=A=>{var I=$e(),O=H(I);{var de=M=>{var k=Sr(),l=r(a(k),2),f=a(l);p(()=>y(f,`${ya[t().status.trapCategory]??""}罠`)),s(M,k)};x(O,M=>{t().kind==="Trap"&&t().status.trapCategory&&M(de)},!0)}s(A,I)};x(te,A=>{t().kind==="Spell"&&t().status.spellCategory?A(w):A($,!1)},!0)}s(N,X)};x(Me,N=>{t().kind==="Monster"?N(E):N(T,!1)})}s(F,K)};x(b,F=>{v()!=="Debug"&&F(U)})}var ne=r(D,2),Ce=a(ne);{var he=F=>{var K=Br(),pe=H(K);{var re=T=>{var N=jr(),X=a(N);pt(X,()=>e(m),te=>{var w=Qe('"読み込み中"');s(te,w)},(te,w)=>{var $=Mr(),A=a($);p(()=>{var I;return y(A,(I=e(w))==null?void 0:I.pendulumDescription)}),s(te,$)}),s(T,N)};x(pe,T=>{var N;(N=t().status.monsterCategories)!=null&&N.includes("Pendulum")&&T(re)})}var Me=r(pe,2),E=a(Me);pt(E,()=>e(m),T=>{var N=Qe('"読み込み中"');s(T,N)},(T,N)=>{var X=Er(),te=a(X);p(()=>{var w;return y(te,(w=e(N))==null?void 0:w.description)}),s(T,X)}),s(F,K)},fe=F=>{var K=$e(),pe=H(K);{var re=E=>{var T=$e(),N=H(T);{var X=te=>{var w=Lr(),$=r(a(w),2);ce($,5,()=>t().actions,me,(A,I)=>{var O=$e();const de=ve(()=>e(I).actionCountUpperBound),M=ve(()=>e(I).actionCount);var k=H(O);{var l=f=>{var Y=Ar(),z=a(Y),ye=a(z),be=r(z,2),le=a(be),ae=r(be,4),V=a(ae);p(()=>{y(ye,e(I).title),y(le,e(M)),y(V,e(de))}),s(f,Y)};x(k,f=>{e(de)!==void 0&&e(M)!==void 0&&f(l)})}s(A,O)}),s(te,w)};x(N,te=>{t().actions.some(w=>w.actionCountUpperBoundKey)&&te(X)})}s(E,T)},Me=E=>{var T=Rr(),N=a(T),X=a(N);ce(X,0,()=>["info","status"],me,(Ae,we)=>{var Be=Ur(),Ye=H(Be),Oe=a(Ye),tt=r(Ye,2);ce(tt,1,()=>Object.entries(t()[we]),me,(Je,$t)=>{let vt=()=>e($t)[0],St=()=>e($t)[1];var Et=qr(),Yt=a(Et),sa=r(Yt);{var qt=wt=>{var Tt=Yr(),kt=r(H(Tt));ce(kt,1,St,me,(ra,ia)=>{var g=Qe();p(h=>y(g,`${h??""},`),[()=>e(ia).toString()],ve),s(ra,g)}),s(wt,Tt)},Xt=wt=>{var Tt=Qe();p(kt=>y(Tt,`${kt??""},`),[()=>{var kt;return(kt=St())==null?void 0:kt.toString()}],ve),s(wt,Tt)};x(sa,wt=>{Array.isArray(St())?wt(qt):wt(Xt,!1)})}p(()=>y(Yt,`"${vt()??""}" : `)),s(Je,Et)});var ze=r(tt,2);ze.textContent="},",p(()=>y(Oe,`"${we??""}" :{`)),s(Ae,Be)});var te=r(X,2);te.textContent='"actions" :[';var w=r(te,2);ce(w,1,()=>t().actions,me,(Ae,we)=>{var Be=Pr(),Ye=a(Be);p(()=>y(Ye,`"${e(we).playType??""} ${e(we).title??""}",`)),s(Ae,Be)});var $=r(w,2);$.textContent="],";var A=r($,2);A.textContent='"substituteEffects" :[';var I=r(A,2);ce(I,1,()=>t().substituteEffects,me,(Ae,we)=>{var Be=Nr(),Ye=a(Be);p(()=>y(Ye,`"${e(we).title??""}",`)),s(Ae,Be)});var O=r(I,2);O.textContent="],";var de=r(O,2);de.textContent='"continuousEffects" :[';var M=r(de,2);ce(M,1,()=>t().continuousEffects,me,(Ae,we)=>{var Be=Hr(),Ye=a(Be);p(()=>y(Ye,`"${e(we).isStarted??""}",`)),s(Ae,Be)});var k=r(M,2);k.textContent="],";var l=r(k,2);l.textContent='"procFilters" :[';var f=r(l,2);ce(f,1,()=>t().procFilterBundle.operators,me,(Ae,we)=>{var Be=Fr(),Ye=a(Be);p(Oe=>y(Ye,`"${Oe??""} ${e(we).title??""} ${e(we).isEffective??""} ",`),[()=>e(we).isSpawnedBy.toString()],ve),s(Ae,Be)});var Y=r(f,2);Y.textContent="],";var z=r(Y,2);z.textContent='"numericStateOperators" :[';var ye=r(z,2);ce(ye,1,()=>t().numericOprsBundle.operators,me,(Ae,we)=>{var Be=Ir(),Ye=a(Be);p(Oe=>y(Ye,`"${Oe??""} ${e(we).title??""} ${e(we).isEffective??""} ${e(we).isContinuous??""} ${e(we).targetState??""} ${e(we).targetStateGen??""} ",`),[()=>e(we).isSpawnedBy.toString()],ve),s(Ae,Be)});var be=r(ye,2);be.textContent="],";var le=r(be,2);le.textContent='"stateOperators" :[';var ae=r(le,2);ce(ae,1,()=>t().statusOperatorBundle.operators,me,(Ae,we)=>{var Be=Or(),Ye=a(Be);p(Oe=>y(Ye,`"${Oe??""} ${e(we).title??""} ${e(we).isEffective??""} ",`),[()=>e(we).isSpawnedBy.toString()],ve),s(Ae,Be)});var V=r(ae,2);V.textContent="],";var se=r(V,2);se.textContent='"lastMoveLogRecord" :{';var Se=r(se,2),Fe=a(Se),He=r(Se,2),Ie=a(He),Le=r(He,2),Ve=a(Le),nt=r(Le,2);nt.textContent="},",p((Ae,we)=>{y(Fe,`"movedBy":"${Ae??""}",`),y(Ie,`"movedAs":"${we??""}",`),y(Ve,`"movedAt":"${t().moveLog.latestRecord.movedAt.totalProcSeq??""}",`)},[()=>{var Ae;return(Ae=t().moveLog.latestRecord.movedBy)==null?void 0:Ae.toString()},()=>t().moveLog.latestRecord.movedAs.join(" ")],ve),s(E,T)};x(pe,E=>{v()==="Detail"?E(re):E(Me,!1)},!0)}s(F,K)};x(Ce,F=>{v()==="Normal"?F(he):F(fe,!1)})}var ie=r(ne,2),Ee=a(ie);{var De=F=>{var K=Gr(),pe=H(K);{var re=N=>{var X=Wr();s(N,X)};x(pe,N=>{t().origin.isOldVersion&&N(re)})}var Me=r(pe,2);{var E=N=>{var X=Kr();s(N,X)},T=N=>{var X=Xr(),te=a(X);{var w=I=>{var O=zr();const de=ve(()=>t().entityType==="Card"?t():t().parent);var M=a(O);p(k=>{var l;it(O,"href",k),y(M,`⇒${((l=e(de))!=null&&l.origin.cardId?"公式カードページ":"公式で検索")??""}`)},[c],ve),s(I,O)};x(te,I=>{var O;t()&&(t().entityType==="Card"||((O=t().parent)==null?void 0:O.entityType)==="Card")&&I(w)})}var $=r(te,2);pt($,()=>e(m),null,(I,O)=>{var de=$e(),M=H(de);{var k=l=>{var f=Vr();p(()=>it(f,"href",`https://yugioh-wiki.net/index.php?${e(O).wikiEncodedName}`)),s(l,f)};x(M,l=>{e(O)&&e(O).wikiEncodedName&&l(k)})}s(I,de)});var A=r($,2);p(()=>it(A,"href",`https://www.google.com/search?q=遊戯王 ${t().origin.name}`)),s(N,X)};x(Me,N=>{t().origin.isForTest?N(E):N(T,!1)})}s(F,K)};x(Ee,F=>{t()&&F(De)})}p((F,K)=>{je(S,`duel_card duel_card_info ${t().origin.kind??""} ${F??""} svelte-1uevs9j`),y(Q,t().nm),y(B,K)},[()=>{var F;return(F=t().origin.monsterCategories)==null?void 0:F.join(" ")},()=>"★".repeat(t().lvl||0)],ve),s(W,S)};x(d,W=>{t()&&W(q)})}s(_,u),ut()}Ka(["click","contextmenu"]);var Zr=o('<div class="duel_field_cell_info_item svelte-1xj7qf1"><!></div>'),ei=o('<div class="duel_field_cell_info_box svelte-1xj7qf1"><div class="duel_field_cell_info_label svelte-1xj7qf1"> </div> <!></div>'),ti=o('<div class="duel_field_cell_info svelte-1xj7qf1"><div class="duel_field_cell_info_header item_btn svelte-1xj7qf1"><div class="svelte-1xj7qf1"> </div> <div class="svelte-1xj7qf1"> </div></div> <div class="duel_field_cell_info_body svelte-1xj7qf1"></div></div>');function ai(_,i){ct(i,!1);let t=Pe(i,"cell",12);const v=()=>{t(t())},m=q=>t().cardEntities.filter(W=>W.face===q);t().field.duel.view.onDuelUpdate.append(v),_t();var c=$e(),u=H(c);{var d=q=>{var W=ti(),S=a(W),D=a(S),n=a(D),L=r(D,2),Q=a(L),G=r(S,2);ce(G,4,()=>["FaceUp","FaceDown"],me,(P,j)=>{var ee=$e(),ue=H(ee);{var B=b=>{var U=ei(),ne=a(U),Ce=a(ne),he=r(ne,2);ce(he,1,()=>m(j).toSorted(ls),me,(fe,ie)=>{var Ee=Zr(),De=a(Ee);const F=ve(()=>t().owner===t().field.duel.duelists.Below);Wt(De,{get entity(){return e(ie)},get isVisibleForcibly(){return e(F)},isWideMode:!0,cardActionResolve:void 0}),s(fe,Ee)}),p(()=>y(Ce,j==="FaceUp"?"表向き":"裏向き")),s(b,U)};x(ue,b=>{m(j).length&&b(B)})}s(P,ee)}),p(()=>{var P;y(n,(P=t().owner)==null?void 0:P.profile.name),y(Q,t().cellType)}),s(q,W)};x(u,q=>{t().field.duel.view.infoBoardState==="CellInfo"&&q(d)})}s(_,c),ut()}var si=o('<div class="duel_config_item svelte-y4u26k"><label class="toggle svelte-y4u26k"><input type="checkbox" class="svelte-y4u26k"></label> <span class="svelte-y4u26k"> </span></div>'),ri=o('<div class="duel_config svelte-y4u26k"><div class="duel_config_title svelte-y4u26k">デュエル設定</div> <div class="duel_config_group svelte-y4u26k"><div class="duel_config_group_title svelte-y4u26k">チェーン設定</div> <!></div></div>');function ii(_,i){ct(i,!1);let t=Pe(i,"viewController",8),v=Pe(i,"userProfile",12);_t();var m=$e(),c=H(m);{var u=d=>{var q=ri(),W=r(a(q),2),S=r(a(W),2);ce(S,1,()=>cs,me,(D,n)=>{var L=si(),Q=a(L),G=a(Q),P=r(Q,2),j=a(P);p(()=>y(j,vs[e(n)])),ds(G,()=>v().chainConfig[e(n)],ee=>v(v().chainConfig[e(n)]=ee,!0)),Z("change",G,()=>v().save()),s(D,L)}),s(d,q)};x(c,d=>{t().infoBoardState==="Config"&&d(u)})}s(_,m),ut()}function ni(_,{from:i,to:t},v={}){var{delay:m=0,duration:c=U=>Math.sqrt(U)*120,easing:u=xa}=v,d=getComputedStyle(_),q=d.transform==="none"?"":d.transform,[W,S]=d.transformOrigin.split(" ").map(parseFloat);W/=_.clientWidth,S/=_.clientHeight;var D=oi(_),n=_.clientWidth/t.width/D,L=_.clientHeight/t.height/D,Q=i.left+i.width*W,G=i.top+i.height*S,P=t.left+t.width*W,j=t.top+t.height*S,ee=(Q-P)*n,ue=(G-j)*L,B=i.width/t.width,b=i.height/t.height;return{delay:m,duration:typeof c=="function"?c(Math.sqrt(ee*ee+ue*ue)):c,easing:u,css:(U,ne)=>{var Ce=ne*ee,he=ne*ue,fe=U+ne*B,ie=U+ne*b;return`transform: ${q} translate(${Ce}px, ${he}px) scale(${fe}, ${ie});`}}}function oi(_){if("currentCSSZoom"in _)return _.currentCSSZoom;for(var i=_,t=1;i!==null;)t*=+getComputedStyle(i).zoom,i=i.parentElement;return t}var li=o('<div class="chain_number svelte-lqu21u"> </div>'),vi=o('<div class="duel_card_row svelte-lqu21u"> </div>'),di=o('<div class="appendix svelte-lqu21u"> </div>'),ci=o('<div class="appendix_wrapper svelte-lqu21u"></div>'),_i=o('<div><div><!> <div> </div> <div><!> <div class="duel_card_row svelte-lqu21u"><div> </div> <!></div></div></div></div>'),ui=o("<div></div>");function fi(_,i){ct(i,!1);let t=Pe(i,"duel",8),v=Pe(i,"position",8,"left");const m=-100,c=()=>v()==="left"?-100:100;let u=_e([]),d=Promise.resolve(),q=Promise.resolve();const W=1e3,S=500,D=400,n=Q=>{const G={...Q};G.isKnown=Q.chainBlockInfo.action.entity.controller.duelistType==="Player"||Q.chainBlockInfo.action.entity.face==="FaceUp",G.chainBlockInfo.onStateChange.append(P=>{if(P==="done"||P==="failed"||P==="negated")return d=d.then(async()=>{const j=new Date().getTime()-G.chainBlockInfo.wasSpawnedAt.getTime();j<W&&await zt(W-j),C(u,e(u).filter(ee=>ee.seq!==G.seq)),await zt(S+D)}).then(),"RemoveMe";C(u,e(u))}),q=q.then(async()=>{C(u,[G,...e(u)].sort((P,j)=>_s.isSameChain(P.clock,j.clock)&&P.chainBlockInfo.action.isWithChainBlock&&j.chainBlockInfo.action.isWithChainBlock?j.clock.totalProcSeq-P.clock.totalProcSeq:P.clock.totalProcSeq-j.clock.totalProcSeq)),await zt(300)}),d=d.then(()=>zt(1e3))};t().chainBlockLog.onInsert.append(n),_t();var L=ui();ce(L,13,()=>e(u),Q=>Q.seq,(Q,G)=>{var P=_i();const j=ve(()=>{const{activator:K,action:pe,appendix:re}=e(G).chainBlockInfo;return{activator:K,action:pe,appendix:re}});var ee=a(P),ue=a(ee);{var B=K=>{var pe=li(),re=a(pe);p(()=>y(re,`チェーン：${e(G).chainBlockInfo.chainNumber??""}`)),s(K,pe)};x(ue,K=>{e(G).chainBlockInfo.chainNumber&&K(B)})}var b=r(ue,2),U=a(b),ne=r(b,2),Ce=a(ne);{var he=K=>{var pe=vi(),re=a(pe);p(()=>y(re,e(G).isKnown?e(j).action.entity.nm:"？？？")),s(K,pe)};x(Ce,K=>{(e(j).action.entity.entityType==="Card"||e(j).action.entity.entityType==="Token")&&K(he)})}var fe=r(Ce,2),ie=a(fe),Ee=a(ie),De=r(ie,2);{var F=K=>{var pe=ci();ce(pe,5,()=>e(j).appendix,me,(re,Me)=>{var E=di(),T=a(E);p(()=>y(T,e(Me))),s(re,E)}),s(K,pe)};x(De,K=>{e(j).appendix&&K(F)})}p((K,pe,re)=>{je(P,`cut_in_row ${(!e(G).chainBlockInfo.chainNumber||e(G).chainBlockInfo.chainNumber===1?"cut_in_row_first":"")??""} svelte-lqu21u`),je(ee,`cut_in_item cut_in_item_${K??""} cut_in_item_${e(G).chainBlockInfo.state??""} svelte-lqu21u`),je(b,`duelist_name duelist_${K??""}_name svelte-lqu21u`),y(U,e(j).activator.profile.name),je(ne,`duel_card duel_card_${K??""} ${pe??""} ${(e(G).isKnown?e(j).action.entity.origin.kind:"")??""} ${e(j).action.entity.entityType??""}  svelte-lqu21u`),y(Ee,re)},[()=>e(j).activator.seat.toLowerCase(),()=>e(G).isKnown?(e(j).action.entity.status.monsterCategories??[]).join(" "):"Token",()=>e(j).action.toString()],ve),oe(3,ee,()=>Ls,()=>new Date().getTime()-e(G).chainBlockInfo.wasSpawnedAt.getTime()<W?{x:c(),duration:D}:{y:m,duration:D}),us(P,()=>ni,()=>({duration:S})),s(Q,P)}),p(()=>je(L,`cut_in_container cut_in_container_${v()??""} svelte-lqu21u`)),s(_,L),ut()}const pi=Ys({duration:400});var mi=o('<div class="duel_desk_left v_flex svelte-1w535im"><!> <!> <!></div>'),gi=o('<button class="duel_field_header_message svelte-1w535im"> </button> <div class="duel_field_header_buttons svelte-1w535im"><button class="svelte-1w535im">サレンダー</button></div>',1),yi=o("<tr></tr>"),hi=o('<table class="duel_field svelte-1w535im"><tbody class="svelte-1w535im"></tbody></table>'),bi=o('<button class="svelte-1w535im">OK</button>'),wi=o('<button class="svelte-1w535im">cancel</button>'),ki=o("<!> <!>",1),xi=o('<button class="svelte-1w535im"> </button>'),Ci=o('<div style="text-align: left;"><!> <!> <!></div>'),Di=o('<div><!> <div class=" duel_desk_center v_flex svelte-1w535im"><div class="duel_field_header svelte-1w535im"><!></div> <div class="duel_field_body svelte-1w535im"><!></div> <div class="duel_field_footer svelte-1w535im"><!></div></div> <!></div> <div style="position:fixed;bottom:0"> </div> <!> <div><!></div>',1);function $i(_,i){ct(i,!1);let t=Pe(i,"duel",12),v=Pe(i,"userProfile",8),m=_e(0),c=_e(0),u=_e([]),d=_e([]),q=()=>{},W=_e([]),S=_e(),D=_e(),n=_e(()=>!1),L=_e(!1);const Q=l=>{q=l.resolve,C(W,l.dummyActionInfos.filter(f=>f.action.entity.entityType==="Duelist").filter(f=>f.action.entity.controller.seat==="Below")),C(S,void 0),C(D,void 0),C(d,[]),C(u,[]),C(L,!1),l.entitiesChoices&&(C(S,l.entitiesChoices),C(n,()=>{var f;return((f=l.entitiesChoices)==null?void 0:f.validator(e(u)))??!1}),C(L,l.entitiesChoices.cancelable),e(S).selectables.every(f=>f.cell.isPlayFieldCell&&f.getIndexInCell()===0||f.cell.cellType==="Hand"&&f.controller.duelistType==="Player"||f.entityType==="Duelist")||t().view.modalController.entitySelector.show({title:t().view.message,position:"Middle",entitiesChoices:l.entitiesChoices,chainBlockInfos:l.chainBlockInfos,cancelable:l.entitiesChoices.cancelable}).then(f=>{q({selectedEntities:f})})),l.cellsChoices&&(C(D,l.cellsChoices),C(n,()=>{var f;return((f=l.cellsChoices)==null?void 0:f.validator(e(d)))??!1}),C(L,l.cellsChoices.cancelable))};t().view.onWaitStart.append(Q);const G=()=>{q=()=>{},C(D,void 0),C(S,void 0),C(d,[]),C(u,[]),C(n,()=>!1),C(L,!1)};t().view.onWaitEnd.append(G);let P=_e(void 0),j=_e("Normal");const ee=({card:l,mode:f})=>{C(P,l),C(j,f??(e(P)===l||e(j)==="Normal"?"Detail":"Normal"))};t().view.onShowCardEntity.append(ee);const ue=()=>{t(t())};t().view.onDuelUpdate.append(ue),t().log.onUpdate.append(ue);const B=()=>{e(S)&&e(S).validator(e(u))&&q({selectedEntities:e(u)}),e(D)&&e(D).validator(e(d))&&q({selectedCells:e(d)})},b=()=>{q({})},U=l=>{q({actionInfo:l})},ne=()=>{q({surrender:!0})};t().main();const Ce=()=>e(m)<=1400?"compact":"wide";_t();var he=Di(),fe=H(he),ie=a(fe);{var Ee=l=>{var f=mi(),Y=a(f);Ra(Y,{get duelist(){return t().duelists.Above}});var z=r(Y,2);{var ye=le=>{Jr(le,{get entity(){return e(P)},get mode(){return e(j)}})};x(z,le=>{e(P)&&le(ye)})}var be=r(z,2);Ra(be,{get duelist(){return t().duelists.Below}}),s(l,f)};x(ie,l=>{Ce()==="wide"&&l(Ee)})}var De=r(ie,2),F=a(De),K=a(F);{var pe=l=>{var f=gi(),Y=H(f),z=a(Y),ye=r(Y,2),be=a(ye);p(()=>y(z,`[TURN:${t().clock.turn}][PHASE:${t().phase}] ${t().view.message}`)),Z("click",Y,()=>{t(t().view.infoBoardState="Log",!0)}),Z("click",be,ne),s(l,f)};x(K,l=>{t().isEnded||l(pe)})}var re=r(F,2),Me=a(re);{var E=l=>{var f=hi(),Y=a(f);ce(Y,5,()=>t().field.cells,me,(z,ye,be)=>{var le=yi();je(le,`${`duel_desk_row_${be}`??""} svelte-1w535im`),ce(le,5,()=>e(ye),me,(ae,V,se)=>{ar(ae,{get view(){return t().view},row:be,column:se,get selectedEntities(){return e(u)},set selectedEntities(Se){C(u,Se)},get selectedCells(){return e(d)},set selectedCells(Se){C(d,Se)},$$legacy:!0})}),s(z,le)}),s(l,f)};x(Me,l=>{t().clock.turn>0&&l(E)})}var T=r(re,2),N=a(T);{var X=l=>{var f=ki(),Y=H(f);{var z=le=>{var ae=bi();p(V=>ae.disabled=V,[()=>!e(n)()],ve),Z("click",ae,B),s(le,ae)};x(Y,le=>{((e(S)&&e(S).qty)??(e(D)&&e(D).qty)??9999)>1&&le(z)})}var ye=r(Y,2);{var be=le=>{var ae=wi();Z("click",ae,b),s(le,ae)};x(ye,le=>{e(L)&&le(be)})}s(l,f)},te=l=>{var f=$e(),Y=H(f);ce(Y,1,()=>e(W),me,(z,ye)=>{var be=xi(),le=a(be);p(()=>y(le,e(ye).action.title)),Z("click",be,()=>U(e(ye))),s(z,be)}),s(l,f)};x(N,l=>{e(S)&&e(S).selectables.length||e(D)&&e(D).selectables?l(X):l(te,!1)})}var w=r(De,2);{var $=l=>{var f=Ci(),Y=a(f);ur(Y,{get log(){return t().log}});var z=r(Y,2);ai(z,{get cell(){return t().view.infoBoardCell}});var ye=r(z,2);ii(ye,{get userProfile(){return v()},get viewController(){return t().view}}),p(be=>je(f,`duel_desk_right duel_desk_right_${be??""}  svelte-1w535im`),[()=>t().view.infoBoardState.toLowerCase()],ve),oe(3,f,()=>xe,()=>({duration:e(m)>1400?0:200,axis:"x"})),s(l,f)};x(w,l=>{(e(m)>1400||t().view.infoBoardState!=="Default")&&l($)})}var A=r(fe,2),I=a(A),O=r(A,2);fs(O,{get modalController(){return t().view.modalController}});var de=r(O,2),M=a(de);const k=ve(()=>Ce()==="wide"?"right":"left");fi(M,{get duel(){return t()},get position(){return e(k)}}),p((l,f)=>{je(fe,`flex duel_desk ${l??""}_mode svelte-1w535im`),y(I,f),je(de,`cutin ${l??""}_mode svelte-1w535im`)},[Ce,()=>t().clock.toFullString()],ve),_a("innerWidth",l=>C(m,l)),_a("innerHeight",l=>C(c,l)),s(_,he),ut()}var Si=o("<div></div>"),Ti=o("<!> <!> <!> <!>",1),Mi=o('<span class="atk svelte-1y1qbq4"> </span> <span class="slash svelte-1y1qbq4">/</span> <span class="def svelte-1y1qbq4"> </span>',1),ji=o('<div role="listitem"><div class="svelte-1y1qbq4"><div class="duel_card_row card_name svelte-1y1qbq4"> </div> <div style="display:flex; flex-wrap: wrap;" class="svelte-1y1qbq4"><div style="" class="svelte-1y1qbq4"><!> <!> <!></div> <div class="atk_def svelte-1y1qbq4"><!></div></div></div></div>');function Qa(_,i){ct(i,!1);let t=Pe(i,"mode",8),v=Pe(i,"cardInfo",8),m=Pe(i,"onAttention",8),c=Pe(i,"cardControlEventHandlers",8);_t();var u=ji(),d=a(u),q=a(d),W=a(q),S=r(q,2),D=a(S),n=a(D);{var L=b=>{var U=Ti(),ne=H(U);{var Ce=De=>{var F=Qe();p(()=>y(F,`★${v().level??""}`)),s(De,F)},he=De=>{var F=$e(),K=H(F);{var pe=Me=>{var E=Qe();p(()=>y(E,`☆${v().rank??""}`)),s(Me,E)},re=Me=>{var E=$e(),T=H(E);{var N=X=>{var te=Qe();p(()=>y(te,`Ｌ${v().link??""}`)),s(X,te)};x(T,X=>{v().link&&X(N)},!0)}s(Me,E)};x(K,Me=>{v().rank?Me(pe):Me(re,!1)},!0)}s(De,F)};x(ne,De=>{v().level?De(Ce):De(he,!1)})}var fe=r(ne,2);ce(fe,1,()=>v().attributes??[],me,(De,F)=>{var K=Si();p(()=>je(K,`monster_attr ${e(F)??""} svelte-1y1qbq4`)),s(De,K)});var ie=r(fe,2);ce(ie,1,()=>v().types??[],me,(De,F)=>{var K=Qe();p(()=>y(K,ma[e(F)])),s(De,K)});var Ee=r(ie,2);ce(Ee,1,()=>v().monsterCategories??[],me,(De,F)=>{var K=Qe();p(()=>y(K,va[e(F)])),s(De,K)}),s(b,U)};x(n,b=>{v().kind==="Monster"&&b(L)})}var Q=r(n,2);{var G=b=>{var U=Qe();p(()=>y(U,`${ga[v().spellCategory]??""}魔法`)),s(b,U)};x(Q,b=>{v().spellCategory&&b(G)})}var P=r(Q,2);{var j=b=>{var U=Qe();p(()=>y(U,`${ya[v().trapCategory]??""}罠`)),s(b,U)};x(P,b=>{v().trapCategory&&b(j)})}var ee=r(D,2),ue=a(ee);{var B=b=>{var U=Mi(),ne=H(U),Ce=a(ne),he=r(ne,4),fe=a(he);p(()=>{y(Ce,v().attack??"?"),y(fe,v().defense??"?")}),s(b,U)};x(ue,b=>{v().kind==="Monster"&&b(B)})}p(b=>{je(u,`${b??""} svelte-1y1qbq4`),y(W,v().name)},[()=>{var b,U;return`deck_editor_card duel_card ${v().kind} ${(U=(b=v())==null?void 0:b.monsterCategories)==null?void 0:U.join(" ")} ${v().isImplemented?"is_implemented":"is_not_implemented"}`}],ve),Z("click",u,()=>m()(v())),Z("touchstart",u,b=>c().onCardDragStart(b,t(),v())),Z("touchmove",u,b=>c().onCardDragging(b,t())),Z("touchend",u,function(...b){var U;(U=c().onCardDragEnd)==null||U.apply(this,b)}),Z("touchcancel",u,function(...b){var U;(U=c().onCardDragCancel)==null||U.apply(this,b)}),Z("mousedown",u,b=>c().onCardDragStart(b,t(),v())),Z("mousemove",u,b=>c().onCardDragging(b,t())),Z("mouseup",u,function(...b){var U;(U=c().onCardDragEnd)==null||U.apply(this,b)}),s(_,u),ut()}var Ei=o('<div class="svelte-1a76gvv"><button class="button_style_reset svelte-1a76gvv">クリア</button></div>'),Bi=o('<button class="button_style_reset plus_minus_button svelte-1a76gvv">+</button> <button class="button_style_reset plus_minus_button svelte-1a76gvv">-</button>',1),Ai=o('<li class="deck_editor_item svelte-1a76gvv"><!> <!></li>'),Li=o('<div class="deck_editor_card_kind_header svelte-1a76gvv"><div class="svelte-1a76gvv"> <!> 枚） <!></div> <div style="display: flex;" class="svelte-1a76gvv"><!> <div class="triangle svelte-1a76gvv">▲</div></div></div> <div class="deck_editor_card_kind_body svelte-1a76gvv"><ul></ul></div>',1),Yi=o("<div><!></div>"),qi=o('<div class="deck_editor_card_list svelte-1a76gvv"></div>');function Wa(_,i){ct(i,!1);let t=Pe(i,"allCardTree",8),v=Pe(i,"deckCardTree",12),m=Pe(i,"mode",8),c=Pe(i,"onAttention",8),u=Pe(i,"searchCondition",8,void 0),d=Pe(i,"cardControlEventHandlers",8),q=_e("ExtraMonster");const W=ka.terminalTypeName==="PC"?500:ka.terminalTypeName==="Tablet Device"?300:100,S=20;let D=_e(S);const n=(B=!1)=>{if(B||C(D,S),C(D,e(D)+10),m()==="List"){if(e(D)>=W)return}else if(e(D)>ms(...Object.values(v()).map(b=>b.length)))return;zt(100).then(()=>n(!0))},L=_e(m()==="List"?t():v()),Q=(...B)=>{const b=B.length?B:Kt(e(L)),U=(ne,Ce)=>{var he;return Ga(ne,Ce,(he=u())==null?void 0:he.sort.filter(fe=>fe.priority>0).toSorted((fe,ie)=>fe.priority-ie.priority))};b.forEach(ne=>e(L)[ne].sort(U))},G=(B,b)=>{v(v()[b]=[],!0)};let P=_e(structuredClone(e(L))),j=_e("");const ee=B=>{if(!u())return!0;if(B.kind==="XyzMaterial")return!1;const b=ua(B);if(!u().deckCardKinds.includes(b)||u().name.trim().length&&[B.name,...B.nameTags??[],...B.textTags??[]].every(ne=>!ne.includes(u().name))||!B.isImplemented&&!u().others.includes("implemented")||B.isForTest&&!u().others.includes("test")||B.isOldVersion&&!u().others.includes("oldVersion"))return!1;if(B.kind==="Monster"){if(B.attributes&&!u().monsterAttributes.union(B.attributes).length||B.types&&!u().monsterTypes.union(B.types).length)return!1;const U=B.level??B.rank??B.link;return At(u().starLowerBound)&&(U??0)<u().starLowerBound||At(u().starUpperBound)&&(U??0)>u().starUpperBound||At(u().atkLowerBound)&&(B.attack??0)<u().atkLowerBound||At(u().atkUpperBound)&&(B.attack??0)>u().atkUpperBound||At(u().defLowerBound)&&(B.defense??0)<u().defLowerBound||At(u().defUpperBound)&&(B.defense??0)>u().defUpperBound||At(u().atkPlusDef)&&(!At(B.attack)||!At(B.defense)||B.attack+B.defense!==u().atkPlusDef)||!B.monsterCategories||b==="ExtraMonster"&&!B.monsterCategories.union(u().exMonsterCategories).length?!1:B.monsterCategories.union(u().monsterCategories).length}if(B.kind==="Spell")return B.spellCategory&&u().spellCategories.includes(B.spellCategory);if(B.kind==="Trap")return B.trapCategory&&u().trapCategories.includes(B.trapCategory)};ba(()=>(oa(m()),e(L),oa(v()),e(q),e(P)),()=>{if(m()==="Deck"){if(Kt(e(L)).forEach(B=>ke(L,e(L)[B]=v()[B])),!e(L)[e(q)].length)C(q,Kt(e(L)).find(B=>e(L)[B].find(ee))??"ExtraMonster");else{const B=Kt(e(L)).map(b=>({kind:b,cardInfos:e(L)[b]})).filter(({cardInfos:b})=>b.length).find(({kind:b,cardInfos:U})=>U.length!==e(P)[b].length);B&&e(q)!==B.kind&&C(q,B.kind)}C(P,structuredClone(e(L)))}}),ba(()=>(oa(m()),oa(u()),e(j)),()=>{var B;if(m()==="List"){const b=JSON.stringify((B=u())==null?void 0:B.sort);e(j)!==b&&(C(j,b),Q()),n()}}),za(),_t();var ue=qi();ce(ue,5,()=>ea,me,(B,b,U)=>{var ne=Yi();const Ce=ve(()=>e(L)[e(b)].filter(ee));var he=a(ne);{var fe=ie=>{var Ee=Li(),De=H(Ee),F=a(De),K=a(F),pe=r(K);{var re=$=>{var A=Qe();p(I=>y(A,`/ ${I??""}`),[()=>e(L)[e(b)].length.toLocaleString()],ve),s($,A)};x(pe,$=>{m()==="List"&&$(re)})}var Me=r(pe,2);{var E=$=>{var A=Qe();p(I=>y(A,`※表示上限${I??""}枚`),[()=>W.toLocaleString()],ve),s($,A)};x(Me,$=>{e(Ce).length>W&&$(E)})}var T=r(F,2),N=a(T);{var X=$=>{var A=Ei(),I=a(A);Z("click",I,O=>G(O,e(b))),s($,A)};x(N,$=>{m()==="Deck"&&e(Ce).length&&$(X)})}var te=r(De,2),w=a(te);ce(w,5,()=>e(Ce),me,($,A,I)=>{var O=$e(),de=H(O);{var M=k=>{var l=Ai(),f=a(l);Qa(f,{get mode(){return m()},get cardInfo(){return e(A)},get onAttention(){return c()},get cardControlEventHandlers(){return d()}});var Y=r(f,2);{var z=ye=>{var be=Bi(),le=H(be),ae=r(le,2);p(V=>{le.disabled=!e(A).isImplemented,it(le,"title",e(A).isImplemented?`※shiftキー同時押しで一括投入
※ctrlキー同時押しで枚数制限無視`:""),ae.disabled=V,it(ae,"title",e(A).isImplemented?"※shiftキー同時押しで一括外し":"")},[()=>m()!=="Deck"&&v()[e(b)].every(V=>V.name!==e(A).name)],ve),Z("click",le,V=>d().onCardAppend(V,e(A))),Z("click",ae,V=>d().onCardRemove(V,e(A))),s(ye,be)};x(Y,ye=>{m()==="Deck"&&ye(z)})}s(k,l)};x(de,k=>{I<e(D)&&(I<20||e(q)===e(b))&&k(M)})}s($,O)}),p($=>{y(K,`${Xa[e(b)]??""}（${$??""} `),je(w,ps(e(b)),"svelte-1a76gvv")},[()=>e(Ce).length.toLocaleString()],ve),Z("click",De,()=>{if(e(q)!==e(b)){C(q,e(b));return}C(q,ea.map(($,A)=>A+U).map($=>$%ea.length).map($=>ea[$]).filter($=>$!==e(b)).find($=>e(L)[$].find(ee))??e(b))}),s(ie,Ee)};x(he,ie=>{e(Ce).length&&ie(fe)})}p(()=>je(ne,`deck_editor_card_kind deckCardKind ${(e(b)===e(q)?"selected":"")??""} ${(e(Ce).length?"":"empty")??""} svelte-1a76gvv`)),s(B,ne)}),s(_,ue),ut()}var Ui=o('<div class="svelte-7xhk0x"> </div>'),Pi=o('<div class="svelte-7xhk0x"> </div>'),Ni=o('<div class="link_arrow_emoji svelte-7xhk0x"> </div>'),Hi=o('<div class="duel_card_info_row svelte-7xhk0x" style="position:sticky; top:0;"><!></div>'),Fi=o('<div class="duel_card_info_row svelte-7xhk0x"><div class="svelte-7xhk0x"><pre class="description svelte-7xhk0x"> </pre></div></div> <div class="duel_card_info_row svelte-7xhk0x" style=" justify-content: space-between;"><div class="svelte-7xhk0x"> </div> <div class="svelte-7xhk0x"> </div></div>',1),Ii=o('<div></div> <div class="svelte-7xhk0x"> </div>',1),Oi=o("<div> </div>"),Ri=o('<span class="svelte-7xhk0x">/</span> <div class="monster_defense svelte-7xhk0x"> </div>',1),Wi=o("<div> </div>"),Ki=o('<div class="duel_card_info_row svelte-7xhk0x"><!> <!> <div style="flex-grow: 1;" class="svelte-7xhk0x"></div> <div class="monster_attack svelte-7xhk0x"> </div> <!></div> <div class="duel_card_info_row svelte-7xhk0x"></div>',1),zi=o('<div class="duel_card_row svelte-7xhk0x"><div class="svelte-7xhk0x"></div> <div class="svelte-7xhk0x"> </div></div>'),Vi=o('<div class="duel_card_row svelte-7xhk0x"><div class="svelte-7xhk0x"></div> <div class="svelte-7xhk0x"> </div></div>'),Xi=o('<div class="duel_card_info_row svelte-7xhk0x"><div class="svelte-7xhk0x">※エラッタ前カードです</div></div>'),Gi=o('<div class="duel_card_info_row svelte-7xhk0x"><div class="svelte-7xhk0x">※テスト用カードです</div></div>'),Qi=o('<div class="duel_card_info_links svelte-7xhk0x"><a target="_blank" rel="noopener noreferrer" title="コナミカードデータベース" class="svelte-7xhk0x"> </a> <a target="_blank" rel="noopener noreferrer" title="遊戯王カードWiki" class="svelte-7xhk0x">⇒遊戯王カードWiki</a> <a target="_blank" rel="noopener noreferrer" title="google" class="svelte-7xhk0x">⇒google検索</a></div>'),Ji=o('<div><div class="duel_card_info_header svelte-7xhk0x"><div class="duel_card_info_row svelte-7xhk0x"><div class="svelte-7xhk0x"> </div></div> <!> <div class="plus_minus_button_area svelte-7xhk0x"><button class="button_style_reset plus_minus_button svelte-7xhk0x">+</button> <button class="button_style_reset plus_minus_button svelte-7xhk0x">-</button></div></div> <div class="duel_card_info_body svelte-7xhk0x"><!> <!> <div class="duel_card_info_row description svelte-7xhk0x"><div class="svelte-7xhk0x"><pre class="description svelte-7xhk0x"> </pre></div></div> <!> <!></div></div>');function Zi(_,i){ct(i,!1);let t=Pe(i,"cardInfo",8,void 0),v=Pe(i,"onAttention",8),m=Pe(i,"cardControlEventHandlers",8),c=Pe(i,"deckCardTree",8);_t();var u=$e(),d=H(u);{var q=W=>{var S=Ji(),D=a(S),n=a(D),L=a(n),Q=a(L),G=r(n,2);{var P=E=>{var T=Hi(),N=a(T);{var X=w=>{var $=Ui(),A=a($);p(I=>y(A,I),[()=>"★".repeat(t().level)],ve),s(w,$)},te=w=>{var $=$e(),A=H($);{var I=de=>{var M=Pi(),k=a(M);p(l=>y(k,l),[()=>"★".repeat(t().rank)],ve),s(de,M)},O=de=>{var M=$e(),k=H(M);{var l=f=>{var Y=Ni(),z=a(Y);p(ye=>y(z,ye),[()=>t().linkArrowKeys.map(ye=>Va[ye].emoji).join("")],ve),s(f,Y)};x(k,f=>{t().linkArrowKeys&&f(l)},!0)}s(de,M)};x(A,de=>{t().rank&&t().rank>0?de(I):de(O,!1)},!0)}s(w,$)};x(N,w=>{t().level&&t().level>0?w(X):w(te,!1)})}s(E,T)};x(G,E=>{t().kind==="Monster"&&E(P)})}var j=r(G,2),ee=a(j),ue=r(ee,2),B=r(D,2),b=a(B);{var U=E=>{var T=Fi(),N=H(T),X=a(N),te=a(X),w=a(te),$=r(N,2),A=a($),I=a(A),O=r(A,2),de=a(O);p(()=>{y(w,t().pendulumDescription),y(I,`◀ ${t().pendulumScaleL??""}`),y(de,`${t().pendulumScaleR??""} ▶`)}),s(E,T)};x(b,E=>{var T;(T=t().monsterCategories)!=null&&T.includes("Pendulum")&&E(U)})}var ne=r(b,2);{var Ce=E=>{var T=Ki(),N=H(T),X=a(N);{var te=k=>{var l=Ii(),f=H(l),Y=r(f,2),z=a(Y);p(()=>{je(f,`monster_attr ${t().attributes[0]??""} svelte-7xhk0x`),y(z,`${$a[t().attributes[0]]??""}属性`)}),s(k,l)};x(X,k=>{t().attributes&&k(te)})}var w=r(X,2);{var $=k=>{var l=Oi(),f=a(l);p(()=>{je(l,`monster_cat ${t().types[0]??""} svelte-7xhk0x`),y(f,`${ma[t().types[0]]??""}${Sa[t().types[0]]??""}族`)}),s(k,l)};x(w,k=>{t().types&&k($)})}var A=r(w,4),I=a(A),O=r(A,2);{var de=k=>{var l=Ri(),f=r(H(l),2),Y=a(f);p(()=>y(Y,t().defense??"?")),s(k,l)};x(O,k=>{var l;(l=t().monsterCategories)!=null&&l.includes("Link")||k(de)})}var M=r(N,2);ce(M,5,()=>t().monsterCategories??[],me,(k,l)=>{var f=Wi(),Y=a(f);p(()=>{je(f,`monster_cat ${e(l)??""} svelte-7xhk0x`),y(Y,`${va[e(l)]??""}${ca[e(l)]??""}`)}),s(k,f)}),p(()=>y(I,t().attack??"?")),s(E,T)},he=E=>{var T=$e(),N=H(T);{var X=w=>{var $=zi(),A=r(a($),2),I=a(A);p(()=>y(I,`${ga[t().spellCategory]??""}魔法`)),s(w,$)},te=w=>{var $=$e(),A=H($);{var I=O=>{var de=Vi(),M=r(a(de),2),k=a(M);p(()=>y(k,`${ya[t().trapCategory]??""}罠`)),s(O,de)};x(A,O=>{t().kind==="Trap"&&t().trapCategory&&O(I)},!0)}s(w,$)};x(N,w=>{t().kind==="Spell"&&t().spellCategory?w(X):w(te,!1)},!0)}s(E,T)};x(ne,E=>{t().kind==="Monster"?E(Ce):E(he,!1)})}var fe=r(ne,2),ie=a(fe),Ee=a(ie),De=a(Ee),F=r(fe,2);{var K=E=>{var T=Xi();s(E,T)};x(F,E=>{t().isOldVersion&&E(K)})}var pe=r(F,2);{var re=E=>{var T=Gi();s(E,T)},Me=E=>{var T=Qi(),N=a(T),X=a(N),te=r(N,2),w=r(te,2);p($=>{it(N,"href",$),y(X,`⇒${(t().cardId?"公式カードページ":"公式で検索")??""}`),it(te,"href",`https://yugioh-wiki.net/index.php?${t().wikiEncodedName}`),it(w,"href",`https://www.google.com/search?q=遊戯王 ${t().name}`)},[()=>gs(t())],ve),s(E,T)};x(pe,E=>{t().isForTest?E(re):E(Me,!1)})}p((E,T)=>{je(S,`duel_card duel_card_info ${t().kind??""} ${E??""} svelte-7xhk0x`),y(Q,t().name),ee.disabled=!t().isImplemented,it(ee,"title",t().isImplemented?`※shiftキー同時押しで一括投入
※ctrlキー同時押しで枚数制限無視`:""),ue.disabled=T,it(ue,"title",t().isImplemented?"※shiftキー同時押しで一括外し":""),y(De,t().description)},[()=>{var E;return(E=t().monsterCategories)==null?void 0:E.join(" ")},()=>c()[ua(t())].every(E=>E.name!==t().name)],ve),Z("click",ee,E=>m().onCardAppend(E,t())),Z("click",ue,E=>m().onCardRemove(E,t())),Z("click",S,()=>v()(t())),s(W,S)};x(d,W=>{t()&&W(q)})}s(_,u),ut()}const en={0:{aaa:"日",aaaa:"日曜日",ddd:"Sun",dddd:"Sunday"},1:{aaa:"月",aaaa:"月曜日",ddd:"Mon",dddd:"Monday"},2:{aaa:"火",aaaa:"火曜日",ddd:"Tue",dddd:"Tuesday"},3:{aaa:"水",aaaa:"水曜日",ddd:"Wed",dddd:"Wednesday"},4:{aaa:"木",aaaa:"木曜日",ddd:"Thu",dddd:"Thursday"},5:{aaa:"金",aaaa:"金曜日",ddd:"Fri",dddd:"Friday"},6:{aaa:"土",aaaa:"土曜日",ddd:"Sat",dddd:"Saturday"}};class tn{constructor(){rt(this,"DefaultSeparator1","/");rt(this,"DefaultSeparator2"," ");rt(this,"DefaultSeparator3",":");rt(this,"createDate",i=>{if(!i)return;const t=new Date(i);if(!isNaN(t.getTime()))return t});rt(this,"createDateOr",(i,t)=>this.createDate(i)||t||new Date);rt(this,"truncateDate",i=>{const t=i||new Date;return new Date(t.getFullYear(),t.getMonth(),t.getDate())});rt(this,"addDate",(i,t)=>{const v=this.createDateOr(i);return v.setDate(v.getDate()+t),v});rt(this,"addMonth",(i,t)=>{const v=this.createDateOr(i);return v.setMonth(v.getMonth()+t),v});rt(this,"addYear",(i,t)=>{const v=this.createDateOr(i);return v.setFullYear(v.getFullYear()+t),v});rt(this,"getDayOfWeek",(i,t="dddd")=>{const v=this.createDate(i);return v?en[v.getDay()][t]:""});rt(this,"formatToYYYYMMDD",(i,t=this.DefaultSeparator1)=>{const v=this.createDate(i);if(!v)return"";const m=v.getFullYear().toString(),c=("0"+(v.getMonth()+1)).slice(-2),u=("0"+v.getDate()).slice(-2);return m+t+c+t+u});rt(this,"formatToYYYYMM",(i,t=this.DefaultSeparator1)=>{const v=this.createDate(i);if(!v)return"";t||(t="");const m=v.getFullYear().toString(),c=("0"+(v.getMonth()+1)).slice(-2);return m+t+c});rt(this,"formatToHHMMSS",(i,t=this.DefaultSeparator3)=>{const v=this.createDate(i);if(!v)return"";t||(t="");const m=v.getHours(),c=v.getMinutes(),u=v.getSeconds();return("0"+m).slice(-2)+t+("0"+c).slice(-2)+t+("0"+u).slice(-2)});rt(this,"formatToHHMM",(i,t=this.DefaultSeparator3)=>{const v=this.createDate(i);if(!v)return"";t||(t="");const m=("0"+v.getHours()).slice(-2),c=("0"+v.getMinutes()).slice(-2);return m+t+c});rt(this,"formatToYYYYMMDD_HHMM",(i,t=this.DefaultSeparator1,v=this.DefaultSeparator2,m=this.DefaultSeparator3)=>{const c=this.createDate(i);return c?this.formatToYYYYMMDD(c,t)+v+this.formatToHHMM(c,m):""});rt(this,"formatToYYYYMMDD_HHMMSS",(i,t=this.DefaultSeparator1,v=this.DefaultSeparator2,m=this.DefaultSeparator3)=>{const c=this.createDate(i);return c?this.formatToYYYYMMDD(c,t)+v+this.formatToHHMMSS(c,m):""})}}const bt=new tn;Date.prototype.truncateDate=function(){return bt.truncateDate(this)};Date.prototype.getCloneOr=function(_){return bt.createDateOr(this,_)};Date.prototype.addDate=function(_){return bt.addDate(this,_)};Date.prototype.addMonth=function(_){return bt.addDate(this,_)};Date.prototype.addYear=function(_){return bt.addDate(this,_)};Date.prototype.getDayOfWeek=function(_="dddd"){return bt.getDayOfWeek(this,_)};Date.prototype.formatToYYYYMM=function(_){return bt.formatToYYYYMM(this,_)};Date.prototype.formatToYYYYMMDD=function(_){return bt.formatToYYYYMMDD(this,_)};Date.prototype.formatToYYYYMMDD_HHMM=function(_,i,t){return bt.formatToYYYYMMDD_HHMM(this,_,i,t)};Date.prototype.formatToYYYYMMDD_HHMMSS=function(_,i,t){return bt.formatToYYYYMMDD_HHMMSS(this,_,i,t)};Date.prototype.formatToHHMM=function(_){return bt.formatToHHMM(this,_)};Date.prototype.formatToHHMMSS=function(_){return bt.formatToHHMMSS(this,_)};var an=o('<li class="deck_info_list_item svelte-2wdgc8"><div class="svelte-2wdgc8"> </div> <div class="svelte-2wdgc8"> </div> <div class="svelte-2wdgc8"> </div></li>'),sn=o('<ul class="deck_info_list svelte-2wdgc8"></ul>'),rn=o('<label for="file_selector" class="upload_area svelte-2wdgc8" role="region" aria-label="ファイルアップロードエリア"><div class="upload_area_message svelte-2wdgc8">ここにファイルをドロップ</div> <div class="upload_area_footer svelte-2wdgc8"><input type="file" id="file_selector" name="file_selector" accept=".json" multiple></div></label>'),nn=o('<div slot="body" class="modal_body svelte-2wdgc8"><!></div>'),on=o('<button class="svelte-2wdgc8">追加</button> <button class="svelte-2wdgc8">削除して追加</button> <button class="svelte-2wdgc8">戻る</button>',1),ln=o('<button class="svelte-2wdgc8">Cancel</button>'),vn=o('<div slot="footer" class="modal_window_footer svelte-2wdgc8"><!></div>');function dn(_,i){ct(i,!1);let t=Pe(i,"eventHolder",8),v=Pe(i,"args",8),m=Pe(i,"resolve",8),c=_e(Promise.resolve([])),u=_e();const d=()=>{C(u,new DataTransfer().files),C(c,Promise.resolve([]))},q=async L=>{L.preventDefault(),console.log("hoge",L)},W=async L=>{L.preventDefault(),L.dataTransfer&&D(L.dataTransfer.files)},S=()=>{D(e(u))},D=async L=>{if(!L.length)return;const Q=[],G=[];for(const P of L)try{G.push(...await Dt.createfromJson(P))}catch(j){j instanceof Error&&Q.push(j.message)}if(Q.length){console.log(...Q);return}C(c,e(c).then(()=>G))},n=d;_t(),ys(_,{get eventHolder(){return t()},get args(){return v()},$$slots:{body:(L,Q)=>{var G=nn(),P=a(G);pt(P,()=>la,null,(j,ee)=>{var ue=$e(),B=H(ue);pt(B,()=>e(c),null,(b,U)=>{var ne=$e(),Ce=H(ne);{var he=ie=>{var Ee=sn();ce(Ee,5,()=>e(U),me,(De,F)=>{var K=an(),pe=a(K),re=a(pe),Me=r(pe,2),E=a(Me),T=r(Me,2),N=a(T);p((X,te,w)=>{y(re,e(F).name),y(E,`${X??""}
                  /
                  ${te??""}`),y(N,`最終使用日時 ： ${w??""}`)},[()=>e(F).cardNames.filter(X=>{var te,w;return!((w=(te=e(ee).getCardInfo(X))==null?void 0:te.monsterCategories)!=null&&w.union(ta).length)}).length,()=>e(F).cardNames.filter(X=>{var te,w;return(w=(te=e(ee).getCardInfo(X))==null?void 0:te.monsterCategories)==null?void 0:w.union(ta).length}).length,()=>e(F).lastUsedAt.formatToYYYYMMDD_HHMM("/"," ",":")],ve),s(De,K)}),s(ie,Ee)},fe=ie=>{var Ee=rn(),De=r(a(Ee),2),F=a(De);hs(F,()=>e(u),K=>C(u,K)),Z("change",F,S),Z("cancel",F,n),Z("drop",Ee,W),Z("dragover",Ee,q),s(ie,Ee)};x(Ce,ie=>{e(U).length?ie(he):ie(fe,!1)})}s(b,ne)}),s(j,ue)}),s(L,G)},footer:(L,Q)=>{var G=vn(),P=a(G);pt(P,()=>e(c),null,(j,ee)=>{var ue=$e(),B=H(ue);{var b=ne=>{var Ce=on(),he=H(Ce),fe=r(he,2),ie=r(fe,2);p(()=>{he.disabled=e(ee).length===0,fe.disabled=e(ee).length===0}),Z("click",he,()=>m()({deckInfos:e(ee),replaceAll:!1})),Z("click",fe,()=>m()({deckInfos:e(ee),replaceAll:!0})),Z("click",ie,n),s(ne,Ce)},U=ne=>{var Ce=$e(),he=H(Ce);{var fe=ie=>{var Ee=ln();Z("click",Ee,()=>m()(void 0)),s(ie,Ee)};x(he,ie=>{v().cancelable&&ie(fe)},!0)}s(ne,Ce)};x(B,ne=>{e(ee).length?ne(b):ne(U,!1)})}s(j,ue)}),s(L,G)}}}),ut()}const pa=class pa extends ws{constructor(i,t){super(i,...Object.values(t))}};rt(pa,"createModalController",i=>{const t={deckUploader:new ks({title:"デッキ情報をアップロード",position:"Middle",cancelable:!1})};return Object.assign(new pa(i,t),t)});let Da=pa;function cn(_,i){ct(i,!1);let t=Pe(i,"modalController",8);_t(),bs(_,{get modalController(){return t()},children:(v,m)=>{var c=$e(),u=H(c);{var d=q=>{dn(q,{get eventHolder(){return t().eventHolder},get args(){return t().deckUploader.args},get resolve(){return t().deckUploader.resolve}})};x(u,q=>{t().deckUploader.state==="Shown"&&q(d)})}s(v,c)},$$slots:{default:!0}}),ut()}var _n=o("<button> </button>"),un=o('<label class="svelte-1m1ssw8"><input type="checkbox" class="search_condition svelte-1m1ssw8"> </label>'),fn=o('<label class="svelte-1m1ssw8"><input type="checkbox" class="search_condition svelte-1m1ssw8"> </label>'),pn=o('<div class="deck_editor_search_box_row monster_ex_categories svelte-1m1ssw8"><div class="svelte-1m1ssw8"><button class="search_condition_title black_button svelte-1m1ssw8">エクストラ</button></div> <div class="svelte-1m1ssw8"></div></div>'),mn=o('<label class="svelte-1m1ssw8"><input type="checkbox" class="search_condition svelte-1m1ssw8"> </label>'),gn=o('<label class="svelte-1m1ssw8"><input type="checkbox" class="search_condition svelte-1m1ssw8"> <div style="display: inline-block;"></div> </label>'),yn=o('<label class="svelte-1m1ssw8"><input type="checkbox" class="search_condition svelte-1m1ssw8"> </label>'),hn=o('<div class="deck_editor_search_box_row monster_categories svelte-1m1ssw8"><div class="svelte-1m1ssw8"><button class="search_condition_title black_button svelte-1m1ssw8">モンスター</button></div> <div class="svelte-1m1ssw8"></div></div> <div class="deck_editor_search_box_row monster_attributes svelte-1m1ssw8"><div class="svelte-1m1ssw8"><button class="search_condition_title black_button svelte-1m1ssw8">属性</button></div> <div class="svelte-1m1ssw8"></div></div> <div class="deck_editor_search_box_row svelte-1m1ssw8"><div class="svelte-1m1ssw8"><button class="search_condition_title black_button svelte-1m1ssw8">種族</button></div> <div class="svelte-1m1ssw8"></div></div> <div class="deck_editor_search_box_row svelte-1m1ssw8"><div class="svelte-1m1ssw8"><button class="search_condition_title black_button svelte-1m1ssw8">星攻守</button></div> <div class="svelte-1m1ssw8"><div class="star_range svelte-1m1ssw8"><span class="svelte-1m1ssw8">星</span> <input type="number" min="0" max="13" class="svelte-1m1ssw8"> <span class="svelte-1m1ssw8">～</span> <input type="number" min="0" max="13" class="svelte-1m1ssw8"></div> <div class="atk_range svelte-1m1ssw8"><span class="svelte-1m1ssw8">攻</span> <input type="number" min="0" max="5000" step="100" class="svelte-1m1ssw8"> <span class="svelte-1m1ssw8">～</span> <input type="number" min="0" max="5000" step="100" class="svelte-1m1ssw8"></div> <div class="def_range svelte-1m1ssw8"><span class="svelte-1m1ssw8">守</span> <input type="number" min="0" max="5000" step="100" class="svelte-1m1ssw8"> <span class="svelte-1m1ssw8">～</span> <input type="number" min="0" max="5000" step="100" class="svelte-1m1ssw8"></div> <div class="atk_plus_def svelte-1m1ssw8"><span class="svelte-1m1ssw8">攻+守</span> <input type="number" min="0" max="10000" step="100" class="svelte-1m1ssw8"></div></div></div>',1),bn=o('<label class="svelte-1m1ssw8"><input type="checkbox" class="search_condition svelte-1m1ssw8"> </label>'),wn=o('<div class="deck_editor_search_box_row svelte-1m1ssw8"><div class="svelte-1m1ssw8"><button class="search_condition_title black_button svelte-1m1ssw8">魔法</button></div> <div class="svelte-1m1ssw8"></div></div>'),kn=o('<label class="svelte-1m1ssw8"><input type="checkbox" class="search_condition svelte-1m1ssw8"> </label>'),xn=o('<div class="deck_editor_search_box_row svelte-1m1ssw8"><div class="svelte-1m1ssw8"><button class="search_condition_title black_button svelte-1m1ssw8">罠</button></div> <div class="svelte-1m1ssw8"></div></div>'),Cn=o('<label class="svelte-1m1ssw8"><input type="checkbox" class="search_condition svelte-1m1ssw8"> </label>'),Dn=o('<div class="deck_editor_card_detail svelte-1m1ssw8"><!></div>'),$n=o("<div>カード情報読込中</div>"),Sn=o("<option> </option>"),Tn=o('<div class="svelte-1m1ssw8"><a class="white_button svelte-1m1ssw8" download="SVS_DeckInfos.json">ダウンロード</a></div>'),Mn=o('<div class="svelte-1m1ssw8"></div>'),jn=o('<div class="svelte-1m1ssw8"><a class="white_button svelte-1m1ssw8" download="SVS_DeckInfos.json">ダウンロード(一括)</a></div>'),En=o('<div class="svelte-1m1ssw8"></div>'),Bn=o('<div class="deck_editor_body_right_header svelte-1m1ssw8"><div class="deck_editor_body_right_header_row svelte-1m1ssw8"><div class="svelte-1m1ssw8">編集対象</div> <div class="svelte-1m1ssw8"><select style="width:100%" class="svelte-1m1ssw8"></select></div></div> <div class="deck_editor_body_right_header_row svelte-1m1ssw8"><div class="svelte-1m1ssw8">新規名称</div> <div class="svelte-1m1ssw8"><input type="text" style="width:100%" class="svelte-1m1ssw8"></div></div> <div class="deck_editor_body_right_header_row svelte-1m1ssw8"></div> <div class="deck_editor_body_right_header_row svelte-1m1ssw8"><div class="svelte-1m1ssw8">基本操作</div> <div class="svelte-1m1ssw8"><button class="white_button svelte-1m1ssw8">デッキを保存</button></div> <div class="svelte-1m1ssw8"><button class="white_button svelte-1m1ssw8">デッキを複製</button></div> <div class="svelte-1m1ssw8"><button class="white_button svelte-1m1ssw8" title="shiftキー押下で確認メッセージスキップ">デッキを削除</button></div></div> <div class="deck_editor_body_right_header_row svelte-1m1ssw8"><div class="svelte-1m1ssw8">DL/UL</div> <!> <!> <div class="svelte-1m1ssw8"><button class="white_button svelte-1m1ssw8">アップロード</button></div></div></div> <div><!></div>',1),An=o("<div>デッキ情報読込中</div>"),Ln=o('<div class="deck_editor_body_right_dummy svelte-1m1ssw8"></div>'),Yn=o("<div><!></div>"),qn=o('<div><div class="deck_editor_header svelte-1m1ssw8"></div> <div class="deck_editor_body svelte-1m1ssw8"><div class="deck_editor_body_left svelte-1m1ssw8"><div role="contentinfo" class="deck_editor_search_box svelte-1m1ssw8"><div class="deck_editor_search_box_header svelte-1m1ssw8"><div class="svelte-1m1ssw8"><button class="deck_editor_search_box_title svelte-1m1ssw8">検索条件</button></div> <div class="deck_editor_sort_setting_container svelte-1m1ssw8"></div></div> <div class="deck_editor_search_box_body svelte-1m1ssw8"><div class="deck_editor_search_box_row svelte-1m1ssw8"><div class="svelte-1m1ssw8"><button class="search_condition_title black_button svelte-1m1ssw8">名称</button></div> <div class="svelte-1m1ssw8"><input type="text" style="width:100%" placeholder="※ルビには対応していません" class="svelte-1m1ssw8"></div></div> <div class="deck_editor_search_box_row card_kind svelte-1m1ssw8"><div class="svelte-1m1ssw8"><button class="search_condition_title black_button svelte-1m1ssw8">種類</button></div> <div class="svelte-1m1ssw8"></div></div> <!> <!> <!> <!> <div class="deck_editor_search_box_row svelte-1m1ssw8"><div class="svelte-1m1ssw8"><button class="search_condition_title black_button svelte-1m1ssw8">その他</button></div> <div class="svelte-1m1ssw8"></div></div></div></div> <!></div> <div class="deck_editor_body_center svelte-1m1ssw8"><div class="deck_editor_body_center_body svelte-1m1ssw8"><!></div></div>  <div class="deck_editor_body_right svelte-1m1ssw8"><!></div></div> <div class="footer svelte-1m1ssw8"></div></div> <!> <!>',1);function Un(_,i){ct(i,!1);const t=[],v=[],m=[],c=[],u=[],d=[],q=[],W=[],S=Da.createModalController({onDragStart:{append:()=>{},remove:()=>{}},onDragEnd:{append:()=>{},remove:()=>{}}}),D={name:"",deckCardKinds:[...ea],exMonsterCategories:[...ta],monsterCategories:Ua.filter(g=>!ta.includes(g)),monsterAttributes:[...qa],monsterTypes:[...Ya],spellCategories:La.filter(g=>g!=="PendulumScale"),trapCategories:[...Aa],starLowerBound:0,starUpperBound:13,atkLowerBound:0,atkUpperBound:5e3,defLowerBound:0,defUpperBound:5e3,atkPlusDef:void 0,others:["test","oldVersion","implemented"],sort:[...Pa]},n=_e(structuredClone(D));ke(n,e(n).others=["oldVersion"]),ke(n,e(n).monsterCategories=["Effect","Tuner","Pendulum"]);let L=_e("DeckEdit"),Q=_e("SearchCondition");const G=()=>{if(!e(n).deckCardKinds.length){Kt(e(n)).forEach(g=>{Array.isArray(e(n)[g])&&Array.isArray(D[g])?ke(n,e(n)[g]=[...D[g]]):ke(n,e(n)[g]=D[g])});return}ke(n,e(n).name=""),ke(n,e(n).deckCardKinds=[]),ke(n,e(n).exMonsterCategories=[]),ke(n,e(n).monsterCategories=[]),ke(n,e(n).monsterAttributes=[]),ke(n,e(n).monsterTypes=[]),ke(n,e(n).spellCategories=[]),ke(n,e(n).trapCategories=[]),ke(n,e(n).others=[]),ke(n,e(n).atkLowerBound=0),ke(n,e(n).atkUpperBound=5e3),ke(n,e(n).defLowerBound=0),ke(n,e(n).defUpperBound=5e3),ke(n,e(n).atkPlusDef=void 0),ke(n,e(n).sort=[...Pa])},P=g=>{g.forEach(h=>{Array.isArray(e(n)[h])&&Array.isArray(D[h])?ke(n,e(n)[h]=e(n)[h].length?[]:[...D[h]]):ke(n,e(n)[h]=D[h])})};let j=_e(),ee,ue=_e(!1);const B=200,b=()=>{C(ue,!1),C(j,void 0),ee=void 0},U=(g,h)=>{const R=ua(h),J=e(re).cardTree[R].filter(qe=>qe.name===h.name).length;let ge=g.shiftKey?3-J:1;console.debug(h,R,J,ge),!g.ctrlKey&&J>2&&(ge=0),ge&&ke(re,e(re).cardTree[R]=[...e(re).cardTree[R],...Array(ge).fill(h)].sort(Ga)),b(),T(h)},ne=(g,h)=>{const R=ua(h);let J=0;ke(re,e(re).cardTree[R]=e(re).cardTree[R].filter(ge=>ge.name!==h.name?!0:(J++,!g.shiftKey&&J>1))),b(),T(h)},Ce=g=>{if(g.changedTouches&&g.changedTouches.length!==1)return;const{clientX:h,clientY:R}=g.changedTouches?g.changedTouches[0]:g;return{clientX:h,clientY:R}},he={onCardAppend:U,onCardRemove:ne,onCardDragCancel:b,onCardDragStart:(g,h,R)=>{if(T(R),h!=="List"&&h!=="Deck"){b();return}if(h==="List"&&!R.isImplemented){b();return}const J=Ce(g);if(!J){b();return}ee={from:h,cardInfo:R,pos:J,startPos:J},zt(B).then(()=>{(ee==null?void 0:ee.cardInfo)===R&&C(j,ee)}),C(ue,!1)},onCardDragging:(g,h)=>{if(e(j)&&g.preventDefault&&g.preventDefault(),e(j)&&g.stopPropagation&&g.stopPropagation(),!ee){b();return}const R=Ce(g);if(!R){b();return}const J=e(j)||ee;C(ue,!!(J.from==="List"&&J.cardInfo.isImplemented&&document.elementsFromPoint(R.clientX,R.clientY).some(ge=>ge.classList.contains("deck_editor_body_right_body")||ge.classList.contains("deck_editor_body_right_dummy")))),e(ue)&&C(L,"DeckEdit"),e(j)?C(j,{...e(j),pos:R}):ee.pos={...R}},onCardDragEnd:g=>{if(!ee||!e(j)){b();return}const h=Ce(g);if(!h){b();return}e(j).from==="List"&&e(j).cardInfo.isImplemented&&document.elementsFromPoint(h.clientX,h.clientY).some(R=>R.classList.contains("deck_editor_body_right_body"))&&U(g,e(j).cardInfo),e(j).from==="Deck"&&!document.elementsFromPoint(h.clientX,h.clientY).some(R=>R.classList.contains("deck_editor_body_right_body"))&&ne(g,e(j).cardInfo),b()}},fe=(g,h,R)=>{Array.isArray(e(n)[h])&&Array.isArray(D[h])&&ke(n,e(n)[h]=[R])},ie=async()=>{const h=(await e(F)).find(J=>J.id===e(De));if(!h)return;const R=await la;C(re,{...h,cardTree:Cs(h.cardNames.map(J=>{const ge=R.getCardInfo(J);return ge===void 0&&console.error(J),ge}).filter(J=>J!==void 0))})},Ee=()=>Dt.getAllDeckInfo().then(g=>(C(De,(g.find(h=>h.lastUsedAt.getTime()===Math.max(...g.map(R=>R.lastUsedAt.getTime())))??g[0]).id),g));let De=_e(-1),F=_e(Ee()),K=_e(e(F).then(g=>Dt.convertToObjectURL(g)));e(F).then(ie);const pe=()=>{C(F,Ee()),C(K,e(F).then(g=>Dt.convertToObjectURL(g))),ie()};let re=_e({id:-Number.MAX_VALUE,name:"",description:"",lastUsedAt:new Date,cardTree:{ExtraMonster:[],Monster:[],Spell:[],Trap:[]}}),Me=_e(void 0),E=0;const T=g=>{C(Q,"CardDetail"),g.cardId!==void 0&&!g.description&&!g.pendulumDescription&&(E=g.cardId,wa([g.cardId]).then(()=>{g.cardId===E&&C(Me,g)})),C(Me,g)},N=async()=>{const h=(await e(F)).find(R=>R.id===e(De));if(!h)throw new Error("illegal state");return h},X=async()=>{const g=await N();await g.saveDeckInfo({...g,name:e(re).name,cardNames:Object.values(e(re).cardTree).flatMap(h=>h).map(h=>h.name),lastUsedAt:new Date}),pe()},te=async()=>{(await Dt.createNewDeck(`デッキ_${new Date().formatToYYYYMMDD_HHMMSS("","","")}`,`コピー日時：${new Date().formatToYYYYMMDD_HHMMSS("-"," ",":")}`,Object.values(e(re).cardTree).flatMap(h=>h).map(h=>h.name))).saveDeckInfo(),pe()},w=async g=>{const h=await N();!g.shiftKey&&!confirm(`デッキ【${h.name}】を削除します。
よろしいですか？`)||(await h.delete(),pe())},$=async()=>{const g=await S.deckUploader.show({title:"デッキ情報アップロード",position:"Middle",cancelable:!0});if(!g)return;const h=[];if(g.replaceAll){if(!confirm(`既存デッキ情報を全て削除し、アップロードしたファイルに置き換えます。
よろしいですか？`))return;h.push(...(await e(F)).map(R=>R.id))}await Promise.all(g.deckInfos.map(R=>Dt.createNewDeck(R.name,R.description,R.cardNames,R.lastUsedAt))),h.length&&await Promise.all(h.map(Dt.remove)),pe()},A=()=>innerWidth<=1400?"compact":"wide";_t();var I=qn(),O=H(I),de=r(a(O),2),M=a(de),k=a(M),l=a(k),f=a(l),Y=a(f),z=r(f,2);ce(z,5,()=>e(n).sort,me,(g,h,R)=>{var J=_n(),ge=a(J);p(()=>{je(J,`deck_editor_sort_setting_item ${e(h).order??""} priority_${e(h).priority??""} svelte-1m1ssw8`),y(ge,`${xs[e(h).key]??""}
                ${(e(h).order==="asc"?"▲":"▼")??""}`)}),Z("click",J,()=>{e(n).sort.forEach(qe=>qe.priority++),e(h).order=e(h).order==="asc"?"desc":"asc",Ft(()=>e(n).sort),e(h).priority=1,Ft(()=>e(n).sort)}),s(g,J)});var ye=r(l,2),be=a(ye),le=a(be),ae=a(le),V=r(le,2),se=a(V),Se=r(be,2),Fe=a(Se),He=a(Fe),Ie=r(Fe,2);ce(Ie,5,()=>ea,me,(g,h)=>{var R=un(),J=a(R),ge,qe=r(J);p(()=>{ge!==(ge=e(h))&&(J.value=(J.__value=e(h))==null?"":e(h)),y(qe,` ${Xa[e(h)]??""}`)}),Ht(t,[],J,()=>(e(h),e(n).deckCardKinds),Te=>ke(n,e(n).deckCardKinds=Te)),s(g,R)});var Le=r(Se,2);{var Ve=g=>{var h=pn(),R=a(h),J=a(R),ge=r(R,2);ce(ge,5,()=>ta,me,(qe,Te)=>{var We=fn(),Re=a(We),Ke,Ze=r(Re);p(()=>{Ke!==(Ke=e(Te))&&(Re.value=(Re.__value=e(Te))==null?"":e(Te)),y(Ze,` ${va[e(Te)]??""}${ca[e(Te)]??""}`)}),Ht(v,[],Re,()=>(e(Te),e(n).exMonsterCategories),dt=>ke(n,e(n).exMonsterCategories=dt)),s(qe,We)}),Z("click",J,()=>P(["exMonsterCategories"])),oe(3,h,()=>xe,()=>({delay:0,duration:100})),s(g,h)};x(Le,g=>{e(n).deckCardKinds.includes("ExtraMonster")&&g(Ve)})}var nt=r(Le,2);{var Ae=g=>{var h=hn(),R=H(h),J=a(R),ge=a(J),qe=r(J,2);ce(qe,5,()=>Ua.filter(Ue=>!ta.includes(Ue)),me,(Ue,Ne)=>{var st=mn(),et=a(st),Ct,Nt=r(et);p(()=>{Ct!==(Ct=e(Ne))&&(et.value=(et.__value=e(Ne))==null?"":e(Ne)),y(Nt,` ${va[e(Ne)]??""}${ca[e(Ne)]??""}`)}),Ht(m,[],et,()=>(e(Ne),e(n).monsterCategories),Ot=>ke(n,e(n).monsterCategories=Ot)),s(Ue,st)});var Te=r(R,2),We=a(Te),Re=a(We),Ke=r(We,2);ce(Ke,5,()=>qa,me,(Ue,Ne)=>{var st=gn(),et=a(st),Ct,Nt=r(et,2),Ot=r(Nt);p(()=>{Ct!==(Ct=e(Ne))&&(et.value=(et.__value=e(Ne))==null?"":e(Ne)),je(Nt,`monster_attr ${e(Ne)??""} svelte-1m1ssw8`),y(Ot,` ${$a[e(Ne)]??""}`)}),Ht(c,[],et,()=>(e(Ne),e(n).monsterAttributes),Ja=>ke(n,e(n).monsterAttributes=Ja)),s(Ue,st)});var Ze=r(Te,2),dt=a(Ze),Ut=a(dt),Mt=r(dt,2);ce(Mt,5,()=>Ya,me,(Ue,Ne)=>{var st=yn(),et=a(st),Ct,Nt=r(et);p(()=>{Ct!==(Ct=e(Ne))&&(et.value=(et.__value=e(Ne))==null?"":e(Ne)),y(Nt,` ${ma[e(Ne)]??""}
                    ${Sa[e(Ne)]??""}`)}),Ht(u,[],et,()=>(e(Ne),e(n).monsterTypes),Ot=>ke(n,e(n).monsterTypes=Ot)),Z("dblclick",st,Ot=>fe(Ot,"monsterTypes",e(Ne))),s(Ue,st)});var xt=r(Ze,2),gt=a(xt),mt=a(gt),Pt=r(gt,2),Bt=a(Pt),It=r(a(Bt),2),Gt=r(It,4),ot=r(Bt,2),Xe=r(a(ot),2),lt=r(Xe,4),yt=r(ot,2),ht=r(a(yt),2),Qt=r(ht,4),Ge=r(yt,2),at=r(a(Ge),2);Z("click",ge,()=>P(["monsterCategories"])),oe(3,R,()=>xe,()=>({delay:0,duration:100})),Z("click",Re,()=>P(["monsterAttributes"])),oe(3,Te,()=>xe,()=>({delay:0,duration:100})),Z("click",Ut,()=>P(["monsterTypes"])),oe(3,Ze,()=>xe,()=>({delay:0,duration:100})),Z("click",mt,()=>P(["starLowerBound","starUpperBound","atkLowerBound","atkUpperBound","defLowerBound","defUpperBound","atkPlusDef"])),jt(It,()=>e(n).starLowerBound,Ue=>ke(n,e(n).starLowerBound=Ue)),jt(Gt,()=>e(n).starUpperBound,Ue=>ke(n,e(n).starUpperBound=Ue)),jt(Xe,()=>e(n).atkLowerBound,Ue=>ke(n,e(n).atkLowerBound=Ue)),jt(lt,()=>e(n).atkUpperBound,Ue=>ke(n,e(n).atkUpperBound=Ue)),jt(ht,()=>e(n).defLowerBound,Ue=>ke(n,e(n).defLowerBound=Ue)),jt(Qt,()=>e(n).defUpperBound,Ue=>ke(n,e(n).defUpperBound=Ue)),jt(at,()=>e(n).atkPlusDef,Ue=>ke(n,e(n).atkPlusDef=Ue)),oe(3,xt,()=>xe,()=>({delay:0,duration:100})),s(g,h)};x(nt,g=>{(e(n).deckCardKinds.includes("Monster")||e(n).deckCardKinds.includes("ExtraMonster"))&&g(Ae)})}var we=r(nt,2);{var Be=g=>{var h=wn(),R=a(h),J=a(R),ge=r(R,2);ce(ge,5,()=>La.filter(qe=>qe!=="PendulumScale"),me,(qe,Te)=>{var We=bn(),Re=a(We),Ke,Ze=r(Re);p(()=>{Ke!==(Ke=e(Te))&&(Re.value=(Re.__value=e(Te))==null?"":e(Te)),y(Ze,` ${ga[e(Te)]??""}`)}),Ht(d,[],Re,()=>(e(Te),e(n).spellCategories),dt=>ke(n,e(n).spellCategories=dt)),s(qe,We)}),Z("click",J,()=>P(["spellCategories"])),oe(3,h,()=>xe,()=>({delay:0,duration:100})),s(g,h)};x(we,g=>{e(n).deckCardKinds.includes("Spell")&&g(Be)})}var Ye=r(we,2);{var Oe=g=>{var h=xn(),R=a(h),J=a(R),ge=r(R,2);ce(ge,5,()=>Aa,me,(qe,Te)=>{var We=kn(),Re=a(We),Ke,Ze=r(Re);p(()=>{Ke!==(Ke=e(Te))&&(Re.value=(Re.__value=e(Te))==null?"":e(Te)),y(Ze,` ${ya[e(Te)]??""}`)}),Ht(q,[],Re,()=>(e(Te),e(n).trapCategories),dt=>ke(n,e(n).trapCategories=dt)),s(qe,We)}),Z("click",J,()=>P(["trapCategories"])),oe(3,h,()=>xe,()=>({delay:0,duration:100})),s(g,h)};x(Ye,g=>{e(n).deckCardKinds.includes("Trap")&&g(Oe)})}var tt=r(Ye,2),ze=a(tt),Je=a(ze),$t=r(ze,2);ce($t,4,()=>[{key:"test",text:"テスト用カード"},{key:"oldVersion",text:"エラッタ前カード"},{key:"implemented",text:"未実装カード"}],me,(g,h)=>{var R=Cn(),J=a(R),ge,qe=r(J);p(()=>{ge!==(ge=h.key)&&(J.value=(J.__value=h.key)==null?"":h.key),y(qe,` ${h.text??""}`)}),Ht(W,[],J,()=>(h.key,e(n).others),Te=>ke(n,e(n).others=Te)),s(g,R)});var vt=r(k,2);{var St=g=>{var h=Dn(),R=a(h);Zi(R,{get cardInfo(){return e(Me)},onAttention:T,cardControlEventHandlers:he,get deckCardTree(){return e(re).cardTree}}),s(g,h)};x(vt,g=>{e(Q)==="CardDetail"&&e(Me)&&g(St)})}var Et=r(M,2),Yt=a(Et),sa=a(Yt);pt(sa,()=>la,g=>{var h=$n();s(g,h)},(g,h)=>{Wa(g,{mode:"List",get allCardTree(){return e(h).tree},onAttention:T,get searchCondition(){return e(n)},cardControlEventHandlers:he,get deckCardTree(){return e(re).cardTree},set deckCardTree(R){ke(re,e(re).cardTree=R)},$$legacy:!0})});var qt=r(Et,2),Xt=a(qt);{var wt=g=>{var h=$e(),R=H(h);pt(R,()=>e(F),J=>{var ge=An();s(J,ge)},(J,ge)=>{var qe=Bn(),Te=H(qe),We=a(Te),Re=r(a(We),2),Ke=a(Re);p(()=>{e(De),Ft(()=>{e(ge)})}),ce(Ke,5,()=>e(ge),me,(Ge,at)=>{var Ue=Sn(),Ne={},st=a(Ue);p(()=>{Ne!==(Ne=e(at).id)&&(Ue.value=(Ue.__value=e(at).id)==null?"":e(at).id),y(st,e(at).name)}),s(Ge,Ue)});var Ze=r(We,2),dt=r(a(Ze),2),Ut=a(dt),Mt=r(Ze,4),xt=r(a(Mt),2),gt=a(xt),mt=r(xt,2),Pt=a(mt),Bt=r(mt,2),It=a(Bt),Gt=r(Mt,2),ot=r(a(Gt),2);pt(ot,N,Ge=>{var at=Mn();s(Ge,at)},(Ge,at)=>{var Ue=Tn(),Ne=a(Ue);p(st=>it(Ne,"href",st),[()=>Dt.convertToObjectURL([e(at)])],ve),s(Ge,Ue)});var Xe=r(ot,2);pt(Xe,()=>e(K),Ge=>{var at=En();s(Ge,at)},(Ge,at)=>{var Ue=jn(),Ne=a(Ue);p(()=>it(Ne,"href",e(at))),s(Ge,Ue)});var lt=r(Xe,2),yt=a(lt),ht=r(Te,2),Qt=a(ht);Wa(Qt,{mode:"Deck",allCardTree:{ExtraMonster:[],Monster:[],Spell:[],Trap:[]},onAttention:T,cardControlEventHandlers:he,get deckCardTree(){return e(re).cardTree},set deckCardTree(Ge){ke(re,e(re).cardTree=Ge)},$$legacy:!0}),p(()=>je(ht,`deck_editor_body_right_body ${(e(ue)?"can_drop":"")??""} svelte-1m1ssw8`)),Zt(Ke,()=>e(De),Ge=>C(De,Ge)),Z("change",Ke,ie),jt(Ut,()=>e(re).name,Ge=>ke(re,e(re).name=Ge)),Z("click",gt,X),Z("click",Pt,te),Z("click",It,w),Z("click",yt,$),s(J,qe)}),s(g,h)},Tt=g=>{var h=Ln();s(g,h)};x(Xt,g=>{e(L)==="DeckEdit"||A()==="wide"?g(wt):g(Tt,!1)})}var kt=r(O,2);{var ra=g=>{var h=Yn(),R=a(h);Qa(R,{mode:"Dragging",get cardInfo(){return e(j).cardInfo},onAttention:T,cardControlEventHandlers:he}),p(()=>it(h,"style",`position: fixed;
          top:${e(j).pos.clientY??""}px;
          left:${e(j).pos.clientX??""}px;
          z-index:3; 
          filter: opacity(0.8);
        	transform: translateX(-50%) translateY(-50%);`)),s(g,h)};x(kt,g=>{e(j)&&g(ra)})}var ia=r(kt,2);cn(ia,{modalController:S}),p((g,h,R)=>je(O,`deck_editor
         screen_size_${g??""}
         left_pain_mode_${h??""}
         main_view_mode_${R??""}
         ${(e(j)?"dragging_card":"")??""}
          svelte-1m1ssw8`),[A,()=>e(Q).toLowerCase(),()=>e(L).toLowerCase()],ve),Z("click",Y,G),Z("click",ae,()=>P(["name"])),jt(se,()=>e(n).name,g=>ke(n,e(n).name=g)),Z("click",He,()=>P(["deckCardKinds"])),Z("click",Je,()=>P(["others"])),oe(3,tt,()=>xe,()=>({delay:0,duration:100})),Z("focusin",k,()=>{C(Q,"SearchCondition"),C(L,"SearchCondition")}),Z("click",k,()=>{C(Q,"SearchCondition"),C(L,"SearchCondition")}),Z("click",qt,()=>{C(L,"DeckEdit")}),Z("focusin",qt,()=>{C(L,"DeckEdit")}),Z("touchmove",O,g=>e(j)&&he.onCardDragging(g,"Overlay")),Z("mousemove",O,g=>e(j)&&he.onCardDragging(g,"Overlay")),s(_,I),ut()}const Pn=["TblDeckHeader","TblDeckDetail","TblDuelistProfile"],Nn=3;var Hn=o('<input class="game_mode_radio svelte-sy4ydn" type="radio" name="game_mode"> <label> </label>',1),Fn=o('<option class="svelte-sy4ydn"> </option>'),In=o('<option class="svelte-sy4ydn"> </option>'),On=o('<option class="svelte-sy4ydn"> </option>'),Rn=o('<tr class="config_row svelte-sy4ydn"><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><label for="npc_deck_selector" class="config_row_label deck_selector svelte-sy4ydn">デッキ：</label></div></td><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><select id="npc_deck_selector" class="deck_selector svelte-sy4ydn"><option class="svelte-sy4ydn">デフォルト</option><!></select></div></td></tr>'),Wn=o('<option class="svelte-sy4ydn"> </option>'),Kn=o('<tr class="config_row svelte-sy4ydn"><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><label for="npc_selector" class="config_row_label npc_selector svelte-sy4ydn">対戦相手：</label></div></td><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><select id="npc_selector" class="npc_selector svelte-sy4ydn"></select> <div class="svelte-sy4ydn"> </div></div></td></tr> <!> <tr class="config_row svelte-sy4ydn"><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><label for="npc_selector" class="config_row_label npc_selector svelte-sy4ydn">先攻後攻：</label></div></td><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><select id="npc_selector" class="npc_selector svelte-sy4ydn"></select></div></td></tr>',1),zn=o('<option class="svelte-sy4ydn"> </option>'),Vn=o('<tr class="config_row svelte-sy4ydn"><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><label for="difficulty_selector" class="config_row_label difficulty_selector svelte-sy4ydn">難易度：</label></div></td><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><select id="difficulty_selector" class="difficulty_selector svelte-sy4ydn"></select></div></td></tr>'),Xn=o('<tr class="config_row svelte-sy4ydn"><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><label class="config_row_label svelte-sy4ydn" for="game_mode_radio_preset">ゲームモード：</label></div></td><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"></div></td></tr> <tr class="config_row svelte-sy4ydn"><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><label for="deck_selector" class="config_row_label deck_selector svelte-sy4ydn">デッキ：</label></div></td><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><select id="deck_selector" class="deck_selector svelte-sy4ydn"></select></div></td></tr> <!> <tr><td colspan="2" class="svelte-sy4ydn"><div><button class="btn svelte-sy4ydn">duel start!</button></div></td></tr>',1),Gn=o('<tr><td colspan="2" class="svelte-sy4ydn"><div>デッキ情報の読み込み、もしくは作成中...</div></td></tr>'),Qn=o('<tr><td colspan="2" class="svelte-sy4ydn"><div><button class="btn svelte-sy4ydn">deck edit</button></div></td></tr>'),Jn=o('<tr class="config_row svelte-sy4ydn"><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><label for="duelist_name" class="config_row_label duelist_name svelte-sy4ydn">名前：</label></div></td><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><input id="duelist_name" class="duelist_name svelte-sy4ydn" type="text"></div></td></tr> <!> <!>',1),Zn=o('<tr><td colspan="2" class="svelte-sy4ydn"><div>デュエリスト情報の読み込み、もしくは作成中...</div></td></tr>'),eo=o('<div class="app_body svelte-sy4ydn"><table class="config_table svelte-sy4ydn"><tbody><!></tbody></table></div>'),to=o('<span class="svelte-sy4ydn"> </span> <span class="svelte-sy4ydn"> </span>',1),ao=o('<div class="result_title result_win svelte-sy4ydn">YOU WIN</div>'),so=o('<div class="result_title result_lose svelte-sy4ydn">YOU LOSE</div>'),ro=o('<div class="result_title result_draw svelte-sy4ydn">DRAW</div>'),io=o('<div class="twitter_share_button_wrapper svelte-sy4ydn"><a rel="nofollow" target="_blank" class="twitter_share_button svelte-sy4ydn">X(twitter)でシェアする</a></div>'),no=o('<div class="result svelte-sy4ydn"><!> <div class="reason_of_end svelte-sy4ydn"> </div> <!> <div class="svelte-sy4ydn"><button class="white_button svelte-sy4ydn">TOPへ戻る</button></div></div>'),oo=o('<main style="flex-direction: column; display :flex" class="svelte-sy4ydn"><div class="link link_left svelte-sy4ydn"><a href="https://github.com/Setta238/stk_ygo_svelte" target="_blank" rel="noopener noreferrer" title="repository" class="svelte-sy4ydn">repository</a> <a href="https://x.com/ninja_no" target="_blank" rel="noopener noreferrer" title="repository" class="svelte-sy4ydn">X(Twitter)</a> <a href="https://posfie.com/@ninja_no/p/Lx7FLj3" target="_blank" rel="noopener noreferrer" title="posfie" class="svelte-sy4ydn">posfie(toggeter)</a></div> <div class="link link_right svelte-sy4ydn"><a class="a_button svelte-sy4ydn" role="button" tabindex="0">TOPへ戻る</a> <a href="/stk_ygo_svelte/note.html" target="_blank" rel="noopener noreferrer" title="repository" class="svelte-sy4ydn">現時点とこの先のこと</a></div> <!> <div class="footer card_summary svelte-sy4ydn"><!></div> <div class="footer debug_info svelte-sy4ydn"><span class="svelte-sy4ydn"> </span> <span class="user_agent_info svelte-sy4ydn"> </span> <span class="screen_info svelte-sy4ydn"> </span></div> <!></main>');function lo(_,i){ct(i,!1);const t=new Ds("stk_ygo_svelte",Nn,Pn);let v=_e(0),m=_e(0),c=_e(),u=_e("FtkChallenge"),d=_e("None"),q=_e(0),W=_e(""),S=_e(void 0);const D="https://setta238.github.io/stk_ygo_svelte/",n="遊戯王deそりてあ",L="ninja_no",Q=$s.getOrCreateNew(t).then(M=>(C(u,Na.includes(M.previousGameMode)?M.previousGameMode:"FtkChallenge"),Ee(M.previousNpcId),M)),G=M=>{var l;const k=M.find(f=>f.lastUsedAt.getTime()===Math.max(...M.map(Y=>Y.lastUsedAt.getTime())))??M[0];C(q,k.id),e(u)==="FtkChallenge"&&k.deckType!=="Preset"&&C(q,((l=Rt.find(f=>f.deckType==="Preset"))==null?void 0:l.id)??e(q))};let P=_e(Dt.getAllDeckInfo(t).then(M=>(Promise.all(M.filter(k=>!k.lastUsedAt).map(k=>{k.saveDeckInfo()})),G(M),M)));const j=async()=>{const M=e(q);let k=(await e(P)).find(f=>f.id===M)??(await ue()).find(f=>f.id===M);k&&await k.updateTimestamp();let l=k;if(l||(l=Rt.find(f=>f.id===M)),!l)throw new Error("illegal state");return l},ee=async()=>{(await Q).save({previousGameMode:e(u)})},ue=()=>(C(P,Dt.getAllDeckInfo(t).then(M=>(G(M),M))),e(P)),B=async()=>{(await e(P)).length||(await Dt.prepareSampleDeck(),ue())},b=async()=>{await Promise.all([ee(),B()]);const M=await j(),k=await Q;let l=Jt.find(z=>z.id===Number.MIN_SAFE_INTEGER)??Jt[0],f=Rt.find(z=>z.id===Number.MIN_SAFE_INTEGER)??Rt[0],Y="PlayFirst";e(u)==="FtkChallenge"?l=Jt.filter(z=>z.npcType==="FtkChallenge").find(z=>z.difficulty===k.previousDifficulty)??l:e(u)==="Free"&&(l=Jt.find(z=>z.id===k.previousNpcId)??l,f=Rt.slice(-1)[0],Y=k.previousStartMode),l.npcType!=="FtkChallenge"&&k.previousNpcDeckId>-1?f=(await e(P)).find(z=>z.id===k.previousNpcDeckId)??f:f=Rt.find(z=>z.id===l.id)??f,C(c,new Ms(k,"Player",M,[],l,"NPC",f,[],Y)),e(c).onDuelEnd.append(()=>(C(c,e(c)),"RemoveMe"))},U=async()=>{await Promise.all([ee(),B()]),C(d,"DeckEdit")},ne=async M=>{await ee(),M.key==="Enter"&&!M.repeat&&(await Q).save()},Ce=()=>{C(P,ue()),C(c,void 0),C(d,"None")};let he=Date.now();const fe=M=>{Date.now()-he<200||(he=Date.now(),C(u,M),ue())},ie=M=>{Ee(Number(M.currentTarget.value))},Ee=M=>{var k;C(S,Jt.find(l=>l.id===M)),C(W,((k=e(S))==null?void 0:k.description)??"")};B(),_t();var De=oo(),F=r(a(De),2),K=a(F),pe=r(F,2);{var re=M=>{var k=$e(),l=H(k);pt(l,()=>Q,null,(f,Y)=>{$i(f,{get duel(){return e(c)},get userProfile(){return e(Y)}})}),s(M,k)},Me=M=>{var k=$e(),l=H(k);{var f=z=>{Un(z,{})},Y=z=>{var ye=eo(),be=a(ye),le=a(be),ae=a(le);pt(ae,()=>Q,V=>{var se=Zn();s(V,se)},(V,se)=>{var Se=Jn(),Fe=H(Se),He=a(Fe),Ie=a(He),Le=r(He),Ve=a(Le),nt=a(Ve),Ae=r(Fe,2);pt(Ae,()=>e(P),Ye=>{var Oe=Gn();s(Ye,Oe)},(Ye,Oe)=>{var tt=Xn(),ze=H(tt),Je=a(ze),$t=a(Je),vt=r(Je),St=a(vt);ce(St,5,()=>Na,me,(J,ge)=>{var qe=Hn(),Te=H(qe),We=r(Te,2),Re=a(We);p(Ke=>{it(Te,"id",`game_mode_radio_${Ke??""}`),Ss(Te,e(ge)),Ts(Te,e(u)===e(ge)),je(We,`game_mode_tab_label game_mode_tab_${Ke??""} svelte-sy4ydn`),it(We,"for",`game_mode_radio_${Ke??""}`),y(Re,e(ge))},[()=>e(ge).toLowerCase()],ve),Z("change",Te,()=>fe(e(ge))),s(J,qe)});var Et=r(ze,2),Yt=a(Et),sa=a(Yt),qt=r(Yt),Xt=a(qt),wt=a(Xt);p(()=>{e(q),Ft(()=>{e(u),e(Oe)})}),ce(wt,5,()=>e(u)==="FtkChallenge"?Rt.filter(J=>J.deckType==="Preset"):e(Oe),me,(J,ge)=>{var qe=Fn(),Te={},We=a(qe);p(()=>{Te!==(Te=e(ge).id)&&(qe.value=(qe.__value=e(ge).id)==null?"":e(ge).id),y(We,e(ge).name)}),s(J,qe)});var Tt=r(Et,2);{var kt=J=>{var ge=Kn(),qe=H(ge),Te=a(qe),We=a(Te),Re=r(Te),Ke=a(Re),Ze=a(Ke);p(()=>{e(se),Ft(()=>{})}),ce(Ze,5,()=>Jt,me,(ot,Xe)=>{var lt=In(),yt={},ht=a(lt);p(()=>{yt!==(yt=e(Xe).id)&&(lt.value=(lt.__value=e(Xe).id)==null?"":e(Xe).id),y(ht,e(Xe).name)}),s(ot,lt)});var dt=r(Ze,2),Ut=a(dt),Mt=r(qe,2);{var xt=ot=>{var Xe=Rn(),lt=a(Xe),yt=a(lt),ht=r(lt),Qt=a(ht),Ge=a(Qt);p(()=>{e(se),Ft(()=>{e(Oe)})});var at=a(Ge);at.value=(at.__value=Number.MIN_SAFE_INTEGER)==null?"":Number.MIN_SAFE_INTEGER;var Ue=r(at);ce(Ue,1,()=>e(Oe),me,(Ne,st)=>{var et=On(),Ct={},Nt=a(et);p(()=>{Ct!==(Ct=e(st).id)&&(et.value=(et.__value=e(st).id)==null?"":e(st).id),y(Nt,e(st).name)}),s(Ne,et)}),oe(3,yt,()=>xe,()=>({duration:200})),oe(3,lt,()=>xe,()=>({duration:200})),Zt(Ge,()=>e(se).previousNpcDeckId,Ne=>e(se).previousNpcDeckId=Ne),oe(3,Qt,()=>xe,()=>({duration:200})),oe(3,ht,()=>xe,()=>({duration:200})),oe(3,Xe,()=>xe,()=>({duration:200})),s(ot,Xe)};x(Mt,ot=>{var Xe;((Xe=e(S))==null?void 0:Xe.npcType)!=="FtkChallenge"&&ot(xt)})}var gt=r(Mt,2),mt=a(gt),Pt=a(mt),Bt=r(mt),It=a(Bt),Gt=a(It);p(()=>{e(se),Ft(()=>{})}),ce(Gt,5,()=>Kt(Ha),me,(ot,Xe)=>{var lt=Wn(),yt={},ht=a(lt);p(()=>{yt!==(yt=e(Xe))&&(lt.value=(lt.__value=e(Xe))==null?"":e(Xe)),y(ht,Ha[e(Xe)])}),s(ot,lt)}),p(()=>y(Ut,`※${e(W)??""}`)),oe(3,We,()=>xe,()=>({duration:200})),oe(3,Te,()=>xe,()=>({duration:200})),Z("change",Ze,ie),Zt(Ze,()=>e(se).previousNpcId,ot=>e(se).previousNpcId=ot),oe(3,Ke,()=>xe,()=>({duration:200})),oe(3,Re,()=>xe,()=>({duration:200})),oe(3,qe,()=>xe,()=>({duration:200})),oe(3,Pt,()=>xe,()=>({duration:200})),oe(3,mt,()=>xe,()=>({duration:200})),Zt(Gt,()=>e(se).previousStartMode,ot=>e(se).previousStartMode=ot),oe(3,It,()=>xe,()=>({duration:200})),oe(3,Bt,()=>xe,()=>({duration:200})),oe(3,gt,()=>xe,()=>({duration:200})),s(J,ge)},ra=J=>{var ge=$e(),qe=H(ge);{var Te=We=>{var Re=Vn(),Ke=a(Re),Ze=a(Ke),dt=r(Ke),Ut=a(dt),Mt=a(Ut);p(()=>{e(se),Ft(()=>{})}),ce(Mt,5,()=>js,me,(xt,gt)=>{var mt=zn(),Pt={},Bt=a(mt);p(()=>{Pt!==(Pt=e(gt))&&(mt.value=(mt.__value=e(gt))==null?"":e(gt)),y(Bt,e(gt))}),s(xt,mt)}),oe(3,Ze,()=>xe,()=>({duration:200})),oe(3,Ke,()=>xe,()=>({duration:200})),Zt(Mt,()=>e(se).previousDifficulty,xt=>e(se).previousDifficulty=xt),oe(3,Ut,()=>xe,()=>({duration:200})),oe(3,dt,()=>xe,()=>({duration:200})),oe(3,Re,()=>xe,()=>({duration:200})),s(We,Re)};x(qe,We=>{e(u)==="FtkChallenge"&&We(Te)},!0)}s(J,ge)};x(Tt,J=>{e(u)==="Free"?J(kt):J(ra,!1)})}var ia=r(Tt,2),g=a(ia),h=a(g),R=a(h);oe(3,$t,()=>xe,()=>({duration:200})),oe(3,Je,()=>xe,()=>({duration:200})),oe(3,St,()=>xe,()=>({duration:200})),oe(3,vt,()=>xe,()=>({duration:200})),oe(3,ze,()=>xe,()=>({duration:200})),oe(3,sa,()=>xe,()=>({duration:200})),oe(3,Yt,()=>xe,()=>({duration:200})),Zt(wt,()=>e(q),J=>C(q,J)),oe(3,Xt,()=>xe,()=>({duration:200})),oe(3,qt,()=>xe,()=>({duration:200})),oe(3,Et,()=>xe,()=>({duration:200})),Z("click",R,b),oe(3,h,()=>xe,()=>({duration:200})),s(Ye,tt)});var we=r(Ae,2);{var Be=Ye=>{var Oe=Qn(),tt=a(Oe),ze=a(tt),Je=a(ze);Z("click",Je,U),oe(3,ze,()=>xe,()=>({duration:200})),oe(3,tt,()=>xe,()=>({duration:200})),oe(3,Oe,()=>xe,()=>({duration:200})),s(Ye,Oe)};x(we,Ye=>{e(u)==="Free"&&Ye(Be)})}oe(3,Ie,()=>xe,()=>({duration:200})),oe(3,He,()=>xe,()=>({duration:200})),jt(nt,()=>e(se).name,Ye=>e(se).name=Ye),Z("keypress",nt,ne),oe(3,Ve,()=>xe,()=>({duration:200})),oe(3,Le,()=>xe,()=>({duration:200})),oe(3,Fe,()=>xe,()=>({duration:200})),s(V,Se)}),s(z,ye)};x(l,z=>{e(d)==="DeckEdit"?z(f):z(Y,!1)},!0)}s(M,k)};x(pe,M=>{e(c)?M(re):M(Me,!1)})}var E=r(pe,2),T=a(E);pt(T,()=>la,M=>{var k=Qe("読み込み中");s(M,k)},(M,k)=>{var l=to(),f=H(l),Y=a(f),z=r(f,2),ye=a(z);p((be,le,ae)=>{y(Y,`公式DB上のカード${be??""}枚`),y(ye,`実装済カード（効果あり）${le??""}枚 （効果なし）${ae??""}枚`)},[()=>e(k).knmCount.toLocaleString(),()=>e(k).definitionCount.toLocaleString(),()=>e(k).nonDefinitionCount.toLocaleString()],ve),s(M,l)});var N=r(E,2),X=a(N),te=a(X),w=r(X,2),$=a(w),A=r(w,2),I=a(A),O=r(N,2);{var de=M=>{var k=no(),l=a(k);{var f=se=>{var Se=$e(),Fe=H(Se);{var He=Le=>{var Ve=ao();s(Le,Ve)},Ie=Le=>{var Ve=$e(),nt=H(Ve);{var Ae=we=>{var Be=so();s(we,Be)};x(nt,we=>{e(c).winner.seat==="Above"&&we(Ae)},!0)}s(Le,Ve)};x(Fe,Le=>{e(c).winner.seat==="Below"?Le(He):Le(Ie,!1)})}s(se,Se)},Y=se=>{var Se=ro();s(se,Se)};x(l,se=>{e(c).winner?se(f):se(Y,!1)})}var z=r(l,2),ye=a(z),be=r(z,2);{var le=se=>{var Se=io(),Fe=a(Se);p(()=>it(Fe,"href",`https://x.com/share?url=${D}&text=${e(c).twitterShareText??""}&hashtags=${n}&via=${L}`)),s(se,Se)};x(be,se=>{e(c).twitterShareText&&se(le)})}var ae=r(be,2),V=a(ae);p(()=>y(ye,e(c).reasonOfEnd)),Z("click",V,Ce),oe(3,k,()=>As,()=>({delay:200,duration:200})),s(M,k)};x(O,M=>{e(c)&&e(c).isEnded&&M(de)})}p(()=>{y(te,"build at: 20260120_201717"),y($,ka.text),y(I,`w:${e(v)??""}px h:${e(m)??""}px`)}),_a("innerWidth",M=>C(v,M)),_a("innerHeight",M=>C(m,M)),Z("click",K,Ce),s(_,De),ut()}Es(lo,{target:document.getElementById("app")});
