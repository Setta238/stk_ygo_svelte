var Ea=Object.defineProperty;var va=n=>{throw TypeError(n)};var qa=(n,i,t)=>i in n?Ea(n,i,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[i]=t;var Ze=(n,i,t)=>qa(n,typeof i!="symbol"?i+"":i,t),da=(n,i,t)=>i.has(n)||va("Cannot "+t);var st=(n,i,t)=>(da(n,i,"read from private field"),t?t.call(n):i.get(n)),Mt=(n,i,t)=>i.has(n)?va("Cannot add the same private member more than once"):i instanceof WeakSet?i.add(n):i.set(n,t),Rt=(n,i,t,d)=>(da(n,i,"write to private field"),d?d.call(n,t):i.set(n,t),t);import{s as ca,r as Aa,a as y,b as Ya,l as Ba,g as e,d as Da,p as lt,c as Le,m as Ce,i as ot,t as o,e as a,f as w,h as f,j as he,k as Be,n as gt,o as we,q as s,u as nt,v as Oe,S as Na,w as Pe,x as z,y as r,z as ve,D as wt,A as ne,B as ce,C as p,E as Pa,F as it,G as Vt,H as Ia,I as Ha,J as kt,K as ft,L as Qt,M as Pt,N as Zt,O as It,P as Jt,Q as Ht,R as Ut,T as Ua,U as ja,V as Fa,W as Oa,X as La,Y as Ra,Z as Wa,_ as At,$ as pt,a0 as Yt,a1 as Wt,a2 as $a,a3 as Ka,a4 as za,a5 as Ga,a6 as Xa,a7 as Va,a8 as _t,a9 as Qa,aa as Za,ab as Ja,ac as _a,ad as ua,ae as fa,af as pa,ag as ga,ah as ma,ai as Tt,aj as Et,ak as Kt,al as ha,am as er,an as bt,ao as tr,ap as ar,aq as Ct,ar as yt,as as rr,at as sr,au as ir,av as lr,aw as ba,ax as or}from"../chunk/entity_proc_20250601_192916.js";import"../chunk/json_20250601_192916.js";(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const _ of document.querySelectorAll('link[rel="modulepreload"]'))d(_);new MutationObserver(_=>{for(const c of _)if(c.type==="childList")for(const g of c.addedNodes)g.tagName==="LINK"&&g.rel==="modulepreload"&&d(g)}).observe(document,{childList:!0,subtree:!0});function t(_){const c={};return _.integrity&&(c.integrity=_.integrity),_.referrerPolicy&&(c.referrerPolicy=_.referrerPolicy),_.crossOrigin==="use-credentials"?c.credentials="include":_.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function d(_){if(_.ep)return;_.ep=!0;const c=t(_);fetch(_.href,c)}})();const nr=n=>n;function ea(n){const i=n-1;return i*i*i+1}function ya(n){const i=typeof n=="string"&&n.match(/^\s*(-?[\d.]+)([^\s]*)\s*$/);return i?[parseFloat(i[1]),i[2]||"px"]:[n,"px"]}function vr(n,{delay:i=0,duration:t=400,easing:d=nr}={}){const _=+getComputedStyle(n).opacity;return{delay:i,duration:t,easing:d,css:c=>`opacity: ${c*_}`}}function dr(n,{delay:i=0,duration:t=400,easing:d=ea,x:_=0,y:c=0,opacity:g=0}={}){const v=getComputedStyle(n),D=+v.opacity,Y=v.transform==="none"?"":v.transform,h=D*(1-g),[l,q]=ya(_),[B,L]=ya(c);return{delay:i,duration:t,easing:d,css:(N,A)=>`
			transform: ${Y} translate(${(1-N)*l}${q}, ${(1-N)*B}${L});
			opacity: ${D-h*A}`}}function Me(n,{delay:i=0,duration:t=400,easing:d=ea,axis:_="y"}={}){const c=getComputedStyle(n),g=+c.opacity,v=_==="y"?"height":"width",D=parseFloat(c[v]),Y=_==="y"?["top","bottom"]:["left","right"],h=Y.map(T=>`${T[0].toUpperCase()}${T.slice(1)}`),l=parseFloat(c[`padding${h[0]}`]),q=parseFloat(c[`padding${h[1]}`]),B=parseFloat(c[`margin${h[0]}`]),L=parseFloat(c[`margin${h[1]}`]),N=parseFloat(c[`border${h[0]}Width`]),A=parseFloat(c[`border${h[1]}Width`]);return{delay:i,duration:t,easing:d,css:T=>`overflow: hidden;opacity: ${Math.min(T*20,1)*g};${v}: ${T*D}px;padding-${Y[0]}: ${T*l}px;padding-${Y[1]}: ${T*q}px;margin-${Y[0]}: ${T*B}px;margin-${Y[1]}: ${T*L}px;border-${Y[0]}-width: ${T*N}px;border-${Y[1]}-width: ${T*A}px;min-${v}: 0`}}function wa(n,i){for(const t in i)n[t]=i[t];return n}function cr({fallback:n,...i}){const t=new Map,d=new Map;function _(g,v,D){const{delay:Y=0,duration:h=b=>Math.sqrt(b)*30,easing:l=ea}=wa(wa({},i),D),q=g.getBoundingClientRect(),B=v.getBoundingClientRect(),L=q.left-B.left,N=q.top-B.top,A=q.width/B.width,T=q.height/B.height,te=Math.sqrt(L*L+N*N),_e=getComputedStyle(v),qe=_e.transform==="none"?"":_e.transform,C=+_e.opacity;return{delay:Y,duration:typeof h=="function"?h(te):h,easing:l,css:(b,H)=>`
			   opacity: ${b*C};
			   transform-origin: top left;
			   transform: ${qe} translate(${H*L}px,${H*N}px) scale(${b+(1-b)*A}, ${b+(1-b)*T});
		   `}}function c(g,v,D){return(Y,h)=>(g.set(h.key,Y),()=>{if(v.has(h.key)){const l=v.get(h.key);return v.delete(h.key),_(l,Y,h)}return g.delete(h.key),n&&n(Y,h,D)})}return[c(d,t,!1),c(t,d,!0)]}function ka(n){return Object.prototype.toString.call(n)==="[object Date]"}function _r(n){return n}function zt(n){const i=n-1;return i*i*i+1}function Gt(n,i){if(n===i||n!==n)return()=>n;const t=typeof n;if(t!==typeof i||Array.isArray(n)!==Array.isArray(i))throw new Error("Cannot interpolate values of different type");if(Array.isArray(n)){const d=i.map((_,c)=>Gt(n[c],_));return _=>d.map(c=>c(_))}if(t==="object"){if(!n||!i)throw new Error("Object cannot be null");if(ka(n)&&ka(i)){const c=n.getTime(),v=i.getTime()-c;return D=>new Date(c+D*v)}const d=Object.keys(i),_={};return d.forEach(c=>{_[c]=Gt(n[c],i[c])}),c=>{const g={};return d.forEach(v=>{g[v]=_[v](c)}),g}}if(t==="number"){const d=i-n;return _=>n+_*d}return()=>i}var ut,Dt,qt,xt;const ta=class ta{constructor(i,t={}){Mt(this,ut,ca(void 0));Mt(this,Dt,ca(void 0));Mt(this,qt);Mt(this,xt,null);st(this,ut).v=st(this,Dt).v=i,Rt(this,qt,t)}static of(i,t){const d=new ta(i(),t);return Aa(()=>{d.set(i())}),d}set(i,t){var l;y(st(this,Dt),i);let{delay:d=0,duration:_=400,easing:c=_r,interpolate:g=Gt}={...st(this,qt),...t};if(_===0)return(l=st(this,xt))==null||l.abort(),y(st(this,ut),i),Promise.resolve();const v=Ya.now()+d;let D,Y=!1,h=st(this,xt);return Rt(this,xt,Ba(q=>{if(q<v)return!0;if(!Y){Y=!0;const L=st(this,ut).v;D=g(L,i),typeof _=="function"&&(_=_(L,i)),h==null||h.abort()}const B=q-v;return B>_?(y(st(this,ut),i),!1):(y(st(this,ut),D(c(B/_))),!0)})),st(this,xt).promise}get current(){return e(st(this,ut))}get target(){return e(st(this,Dt))}set target(i){this.set(i)}};ut=new WeakMap,Dt=new WeakMap,qt=new WeakMap,xt=new WeakMap;let Bt=ta;var ur=o('<div class="phase_display svelte-1ycsdg6"><span class="svelte-1ycsdg6"> </span> </div>'),fr=o('<div class="lifepoint_display svelte-1ycsdg6"><div class="svelte-1ycsdg6"> </div> <div class="svelte-1ycsdg6"> </div></div>'),pr=(n,i,t)=>i(e(t)),gr=o('<div class="svelte-1ycsdg6"><button class="phase_button svelte-1ycsdg6"> </button></div>'),mr=o("<div><!></div>"),hr=o('<div class="svelte-1ycsdg6"><!></div>'),br=o("<div><!></div>"),yr=o('<div class="config_button_wrapper svelte-1ycsdg6"><button id="config_button" class="svelte-1ycsdg6">⚙</button></div>'),wr=o("<!> <!> <!> <!>",1),kr=o('<div style="position: absolute;" class="card_animation_receiver svelte-1ycsdg6"><!></div>'),xr=o('<div style="position: absolute; top:0rem" class="svelte-1ycsdg6">｛効果対象｝</div>'),Cr=o('<!> <div style="position: absolute; display:flex;justify-content: center;"><!></div>',1),Dr=o(" <!> 】",1),$r=o('<div style="position: absolute; bottom:0rem" class="svelte-1ycsdg6"> <!></div>'),Sr=o("<!> <!>",1),Mr=o('<div class="badge svelte-1ycsdg6"> </div>'),Tr=o('<div class="card_animation_receiver svelte-1ycsdg6"><!></div>'),Er=o("<!> <!> <!> <!>",1),qr=o('<td><div role="listitem"><!></div></td>');function Ar(n,i){lt(i,!1);let t=Le(i,"view",12),d=Le(i,"row",8),_=Le(i,"column",8),c=Le(i,"selectedEntities",28,()=>[]),g=Le(i,"selectedCells",28,()=>[]),v=Ce(t().getCell(d(),_())),D=Ce(new Bt(e(v).field.duel.duelists.Above.lp,{duration:400,easing:zt})),Y=Ce(new Bt(e(v).field.duel.duelists.Below.lp,{duration:400,easing:zt}));const h=()=>{y(v,t().getCell(d(),_())),Oe(D,e(D).target=e(v).field.duel.duelists.Above.lp),Oe(Y,e(Y).target=e(v).field.duel.duelists.Below.lp)};e(v).onUpdate.append(h),t().onDuelUpdate.append(h),t().modalController.onUpdate.append(h);let l,q=Ce([]),B=()=>console.log("hoge"),L,N=Ce([]),A=Ce(!1),T=Ce(!1),te=!1;const _e=u=>{var x,P;y(de,[]),c().reset(),l=u.activator,B=u.resolve,y(q,u.dummyActionInfos),y(N,u.chainBlockInfos.flatMap(pe=>pe.selectedEntities).getDistinct()),L=u.entitiesChoices,y(A,!1),y(T,((x=u.cellsChoices)==null?void 0:x.selectables.includes(e(v)))??!1),te=e(T)&&((P=u.cellsChoices)==null?void 0:P.qty)===1,h()};t().onWaitStart.append(_e);const qe=()=>{l=void 0,y(q,[]),B=()=>{console.log("hoge")},L=void 0,y(N,[]),y(A,!1),y(T,!1),te=!1};t().onWaitEnd.append(qe);let C=Ce(!1),b=[];const H=u=>{b=u.filter(x=>x.dests.includes(e(v))),y(C,b.length>0),h()},ee=()=>{b=[],y(C,!1),h()};t().onDragStart.append(H),t().onDragEnd.append(ee);const[De,Z]=Es;let de=Ce([]);const V=u=>{if(l=void 0,e(v)===u.to||e(v).entities.includes(u.entity)){y(de,[...e(de),u]);const x=u.resolve;y(v,e(v)),setTimeout(()=>{y(de,e(de).filter(P=>P!==u)),u.count++,u.count>1&&x()},600)}};t().onAnimation.append(V);const be=u=>{B({phaseChange:u})},R=()=>e(v).isStackCell&&e(v).entities.flatMap(u=>u.actions).filter(u=>e(q).map(x=>x.action.seq).some(x=>x===u.seq)).length>0,I=u=>{var x;if(((x=u.target)==null?void 0:x.id)==="config_button"){t(t().infoBoardState="Config",!0),t().requireUpdate();return}if(t(t().infoBoardState="Default",!0),te)B({selectedCells:[e(v)]});else if(e(T))y(A,!e(A)),g(e(A)?[...g(),e(v)]:g().filter(P=>P!==e(v)));else if(e(v).isStackCell){t(t().infoBoardState="CellInfo",!0),t(t().infoBoardCell=e(v),!0),t().requireUpdate();const P=e(v).entities.flatMap(K=>K.actions).map(K=>K.seq),pe=e(q).filter(K=>P.includes(K.action.seq));if(pe.length){if(!l)return;t().modalController.actionSelector.show({title:"カードを選択。",position:"Bottom",activator:l,dummyActionInfos:pe,cancelable:!0}).then(K=>{K&&B({actionInfo:K})});return}}t().requireUpdate(),console.info(e(v),fe(...e(v).visibleEntities))},se=u=>{u.preventDefault(),u.dataTransfer&&(u.dataTransfer.dropEffect="move")},ae=u=>{u.preventDefault(),console.info("drop",u,e(C),b),u.dataTransfer&&(u.dataTransfer.dropEffect="move");try{if(e(C)&&b){if(b.length===1){const x=b[0];B({actionInfo:{...x,dest:e(v)}})}else if(b.length>1){if(!l)throw new Na("想定されない状態");e(v).field.duel.view.modalController.terminateAll(),e(v).field.duel.view.modalController.actionSelector.show({title:"選択",position:"Bottom",activator:l,dummyActionInfos:b.map(x=>({...x,dest:e(v)})),cancelable:!1}).then(x=>{B({actionInfo:x})})}}}finally{t().removeDraggingActions()}},fe=(...u)=>{if(t().waitMode==="Animation")return"Disabled";if(L&&L.selectables.find(P=>u.find(pe=>P===pe)))return"Selectable";if(!e(q)||e(q).length===0||t().waitMode!=="Free"||Object.values(t().modalController.modals).some(P=>P.state==="Shown"))return"Disabled";const x=e(q).filter(P=>u.includes(P.action.entity));return x.length===0?"Disabled":e(v).isStackCell||x[0].action.entity!==u[0]?"Clickable":x.some(P=>P.dests.length)?"Draggable":"Clickable"};ot();var G=qr(),S=a(G);S.__click=I;var W=a(S);{var re=u=>{var x=Pe(),P=z(x);{var pe=K=>{var ge=Pe(),U=z(ge);{var ie=E=>{var Q=ur(),ye=a(Q),ue=a(ye),le=r(ye,1,!0);f((Te,oe)=>{p(ue,Te),p(le,oe)},[()=>String(e(v).field.duel.clock.turn).padStart(2,"0"),()=>e(v).field.duel.phase.toUpperCase()],he),s(E,Q)},m=E=>{var Q=Pe(),ye=z(Q);{var ue=Te=>{var oe=fr(),j=a(oe),me=a(j),Ee=r(j,2),Ge=a(Ee);f((Ne,X)=>{p(me,Ne),p(Ge,X)},[()=>Math.floor(e(D).current),()=>Math.floor(e(Y).current)],he),s(Te,oe)},le=Te=>{var oe=Pe(),j=z(oe);{var me=Ee=>{var Ge=Pe(),Ne=z(Ge);{var X=J=>{var Ae=Pe(),k=z(Ae);{var M=O=>{var ke=Pe(),Ie=z(ke);ve(Ie,1,()=>t().duel.nextPhaseList,ce,(Ue,F)=>{var xe=gr(),Ye=a(xe);Ye.__click=[pr,be,F];var Re=a(Ye);f(He=>p(Re,He),[()=>e(F).toUpperCase()],he),s(Ue,xe)}),s(O,ke)};w(k,O=>{t().duel.isEnded||O(M)})}s(J,Ae)};w(Ne,J=>{t().waitMode==="Free"&&J(X)})}s(Ee,Ge)};w(j,Ee=>{e(v).column===5&&Ee(me)},!0)}s(Te,oe)};w(ye,Te=>{e(v).column===3?Te(ue):Te(le,!1)},!0)}s(E,Q)};w(U,E=>{e(v).column===1?E(ie):E(m,!1)})}s(K,ge)};w(P,K=>{e(v).row===3&&K(pe)})}s(u,x)},$=u=>{var x=Pe(),P=z(x);{var pe=ge=>{var U=wr();const ie=he(()=>e(de).find(oe=>oe.to===e(v)));var m=z(U);{var E=oe=>{var j=mr(),me=a(j);wt(me,{get entity(){return e(ie).entity},state:"Disabled",dummyActionInfos:[],cardActionResolve:void 0}),f(()=>Be(j,`card_animation_receiver ${e(v).cellType??""} svelte-1ycsdg6`)),ne(1,j,()=>Z,()=>({key:e(ie).entity.seq})),s(oe,j)};w(m,oe=>{e(ie)&&e(ie).index==="Top"&&oe(E)})}var Q=r(m,2);ve(Q,1,()=>e(v).visibleEntities,ce,(oe,j)=>{var me=Pe(),Ee=z(me);{var Ge=Ne=>{var X=hr(),J=a(X);const Ae=he(()=>fe(e(j))),k=he(()=>e(q).filter(M=>M.action.entity===e(j)));wt(J,{get entity(){return e(j)},get state(){return e(Ae)},get dummyActionInfos(){return e(k)},cardActionResolve:void 0,get selectedList(){return c()},set selectedList(M){c(M)},$$legacy:!0}),ne(2,X,()=>De,()=>({key:e(j).seq})),s(Ne,X)};w(Ee,Ne=>{e(de).every(X=>X.entity.seq!==e(j).seq)&&Ne(Ge)})}s(oe,me)});var ye=r(Q,2);{var ue=oe=>{var j=br(),me=a(j);wt(me,{get entity(){return e(ie).entity},state:"Disabled",dummyActionInfos:[],cardActionResolve:void 0}),f(()=>Be(j,`card_animation_receiver ${e(v).cellType??""} svelte-1ycsdg6`)),ne(1,j,()=>Z,()=>({key:e(ie).entity.seq})),s(oe,j)};w(ye,oe=>{e(ie)&&e(ie).index!=="Top"&&oe(ue)})}var le=r(ye,2);{var Te=oe=>{var j=yr();s(oe,j)};w(le,oe=>{e(v).owner.seat==="Below"&&oe(Te)})}s(ge,U)},K=ge=>{var U=Er();const ie=he(()=>e(de).find(j=>j.to===e(v)));var m=z(U);{var E=j=>{var me=kr(),Ee=a(me);wt(Ee,{get entity(){return e(ie).entity},state:"Disabled",dummyActionInfos:[],cardActionResolve:void 0}),ne(1,me,()=>Z,()=>({key:e(ie).entity.seq})),s(j,me)};w(m,j=>{e(ie)&&e(ie).index!=="Top"&&j(E)})}var Q=r(m,2);{var ye=j=>{var me=Sr(),Ee=z(me);ve(Ee,1,()=>e(v).visibleEntities.map((X,J)=>({index:J,entity:X})).toReversed(),ce,(X,J)=>{var Ae=Pe(),k=z(Ae);{var M=O=>{var ke=Cr();const Ie=he(()=>!e(v).isStackCell&&e(J).index===0?fe(...e(v).visibleEntities):void 0);var Ue=z(ke);{var F=He=>{var Xe=xr();s(He,Xe)};w(Ue,He=>{e(N).includes(e(J).entity)&&He(F)})}var xe=r(Ue,2),Ye=a(xe);const Re=he(()=>e(J).index===0?e(q).filter(He=>e(v).visibleEntities.includes(He.action.entity)):void 0);wt(Ye,{get entity(){return e(J).entity},get state(){return e(Ie)},get dummyActionInfos(){return e(Re)},cardActionResolve:void 0,get selectedList(){return c()},set selectedList(He){c(He)},$$legacy:!0}),f(()=>Be(xe,`duel_card_wrapper ${(e(J).entity.exist?"duel_card_wrapper_exists":"")??""} svelte-1ycsdg6`)),ne(2,xe,()=>De,()=>({key:e(J).entity.seq})),s(O,ke)};w(k,O=>{e(de).every(ke=>ke.entity.seq!==e(J).entity.seq)&&O(M)})}s(X,Ae)});var Ge=r(Ee,2);{var Ne=X=>{var J=$r(),Ae=a(J),k=r(Ae);ve(k,1,()=>Vt(e(v).visibleEntities[0].status.maxCounterQty),ce,(M,O)=>{var ke=Dr(),Ie=z(ke),Ue=r(Ie);{var F=xe=>{var Ye=it();f(()=>p(Ye,`/${e(v).visibleEntities[0].status.maxCounterQty[e(O)]??""}`)),s(xe,Ye)};w(Ue,xe=>{(e(v).visibleEntities[0].status.maxCounterQty[e(O)]??!1)&&xe(F)})}f((xe,Ye)=>p(Ie,`【
              ${xe??""}${Ye??""} `),[()=>Pa(e(O)),()=>e(v).visibleEntities[0].counterHolder.getQty(e(O))],he),s(M,ke)}),f(()=>p(Ae,`【${e(v).visibleEntities[0].battlePositionName??""}】 `)),s(X,J)};w(Ge,X=>{e(v).visibleEntities[0].battlePosition&&X(Ne)})}s(j,me)};w(Q,j=>{e(v).visibleEntities.length>0&&j(ye)})}var ue=r(Q,2);{var le=j=>{var me=Mr(),Ee=a(me);f(()=>p(Ee,e(v).visibleEntities.length)),s(j,me)};w(ue,j=>{e(v).isStackCell&&j(le)})}var Te=r(ue,2);{var oe=j=>{var me=Tr(),Ee=a(me);wt(Ee,{get entity(){return e(ie).entity},state:"Disabled",dummyActionInfos:[],cardActionResolve:void 0}),ne(1,me,()=>Z,()=>({key:e(ie).entity.seq})),s(j,me)};w(Te,j=>{e(ie)&&e(ie).index==="Top"&&j(oe)})}s(ge,U)};w(P,ge=>{e(v).cellType==="Hand"?ge(pe):ge(K,!1)},!0)}s(u,x)};w(W,u=>{e(v).isDisabledCell?u(re):u($,!1)})}f(u=>{Be(G,`${`duel_field_cell duel_field_cell_${e(v).cellType} ${e(v).linkArrowSources.length===0?"":"duel_field_cell_linked"}`??""} svelte-1ycsdg6`),gt(G,"colspan",e(v).cellType==="Hand"?7:1),Be(S,`${u??""} svelte-1ycsdg6`)},[()=>`duel_field_cell_inner_box ${e(v).cellType} ${e(C)?"can_accept_drop":""} ${R()?"can_action":""} ${e(A)?"is_selected":e(T)?"is_selectable":""} `],he),we("dragover",S,se),we("drop",S,ae),s(n,G),nt()}Da(["click"]);var Yr=o('<div class="title svelte-14z6bdh"> </div>'),Br=o('<div class="title svelte-14z6bdh"> </div>'),Nr=o('<div class="duel_log_chain_number svelte-14z6bdh"> </div>'),Pr=o("<div><!></div>"),Ir=o('<div><div style="display: flex;    justify-content: space-between;"><div style=" white-space: nowrap;text-align: center;"> </div> <!></div> <!></div>'),Hr=o("<div><!> <!></div>"),Ur=o("<div><!> <!></div>"),jr=o('<div class="duel_log svelte-14z6bdh"><div class="duel_log_header svelte-14z6bdh"></div> <div class="duel_log_body svelte-14z6bdh"></div> <div class="duel_log_footer svelte-14z6bdh"></div></div>');function Fr(n,i){lt(i,!1);let t=Ce(void 0),d=Le(i,"log",8),_,c=Ce([]);const g=()=>{const h=((_==null?void 0:_.seq)??-1)+1;d().records.slice(h).forEach(l=>{if(!_){y(c,[[[[l]]]]),_=l;return}if(!e(c)[l.clock.turn]){Oe(c,e(c)[l.clock.turn]=[[[l]]]),_=l;return}if(!e(c)[l.clock.turn][l.clock.phaseSeq]){Oe(c,e(c)[l.clock.turn][l.clock.phaseSeq]=[[l]]),_=l;return}if(_.clock.chainSeq===l.clock.chainSeq&&_.clock.chainBlockSeq===l.clock.chainBlockSeq&&_.duelist===l.duelist){e(c)[l.clock.turn][l.clock.phaseSeq].slice(-1)[0].push(l),_=l;return}e(c)[l.clock.turn][l.clock.phaseSeq].push([l]),_=l}),y(c,e(c)),Ia().then(()=>e(t)&&e(t).scroll(0,e(t).clientHeight*990))};d().onUpdate.append(g),d().duel.view.onDuelUpdate.append(g),g(),ot();var v=Pe(),D=z(v);{var Y=h=>{var l=jr(),q=r(a(l),2);ve(q,5,()=>e(c),ce,(B,L)=>{var N=Ur(),A=a(N);{var T=_e=>{var qe=Yr(),C=a(qe);f(()=>p(C,`ターン：${e(L)[0][0][0].clock.turn??""}`)),s(_e,qe)};w(A,_e=>{e(L)[0][0][0].clock.turn>0&&_e(T)})}var te=r(A,2);ve(te,1,()=>e(L),ce,(_e,qe)=>{var C=Hr(),b=a(C);{var H=De=>{var Z=Br(),de=a(Z);f(()=>p(de,e(qe)[0][0].clock.period.name)),s(De,Z)};w(b,De=>{e(qe)[0][0].clock.turn>0&&De(H)})}var ee=r(b,2);ve(ee,1,()=>e(qe),ce,(De,Z)=>{var de=Ir();const V=he(()=>{var G;return((G=e(Z).find(S=>S.chainNumber!==void 0))==null?void 0:G.chainNumber)??0});var be=a(de),R=a(be),I=a(R),se=r(R,2);{var ae=G=>{var S=Nr(),W=a(S);f(()=>p(W,`チェーン：${e(V)??""}`)),s(G,S)};w(se,G=>{e(V)&&G(ae)})}var fe=r(be,2);ve(fe,1,()=>e(Z),ce,(G,S)=>{var W=Pr(),re=a(W);{var $=x=>{var P=it();f(()=>p(P,e(S).text)),s(x,P)},u=x=>{var P=Pe(),pe=z(P);{var K=U=>{var ie=it();f((m,E,Q)=>p(ie,`移動：${m??""} ${E??""} ⇒ ${Q??""}`),[()=>{var m;return(m=e(S).mainEntity)==null?void 0:m.toString()},()=>{var m;return(m=e(S).from)==null?void 0:m.toString()},()=>{var m;return(m=e(S).to)==null?void 0:m.toString()}],he),s(U,ie)},ge=U=>{var ie=Pe(),m=z(ie);{var E=ye=>{var ue=it();f((le,Te)=>p(ue,`生成：${le??""} void ⇒ ${Te??""}`),[()=>{var le;return(le=e(S).mainEntity)==null?void 0:le.toString()},()=>{var le;return(le=e(S).to)==null?void 0:le.toString()}],he),s(ye,ue)},Q=ye=>{var ue=Pe(),le=z(ue);{var Te=j=>{var me=it();f((Ee,Ge)=>p(me,`消滅：${Ee??""} ${Ge??""} ⇒ void`),[()=>{var Ee;return(Ee=e(S).mainEntity)==null?void 0:Ee.toString()},()=>{var Ee;return(Ee=e(S).from)==null?void 0:Ee.toString()}],he),s(j,me)},oe=j=>{var me=it();f(()=>p(me,e(S).text)),s(j,me)};w(le,j=>{e(S).type==="EntityDisappear"?j(Te):j(oe,!1)},!0)}s(ye,ue)};w(m,ye=>{e(S).type==="EntityAppear"?ye(E):ye(Q,!1)},!0)}s(U,ie)};w(pe,U=>{e(S).type==="EntityMove"?U(K):U(ge,!1)},!0)}s(x,P)};w(re,x=>{e(S).type==="ChainBlockHeader"?x($):x(u,!1)})}f(x=>Be(W,`duel_log_record duel_log_record_${x??""} svelte-14z6bdh`),[()=>e(S).type.toSnakeCase()],he),s(G,W)}),f(()=>{var G,S,W;Be(de,`duel_log_block_duelist duel_log_block_duelist_${((G=e(Z)[0].duelist)==null?void 0:G.seat)??"system"} svelte-14z6bdh`),Be(R,`duelist ${((S=e(Z)[0].duelist)==null?void 0:S.seat)??""} svelte-14z6bdh`),p(I,((W=e(Z)[0].duelist)==null?void 0:W.profile.name)||"SYSTEM")}),s(De,de)}),f(()=>Be(C,`duel_log_block_phase duel_log_block_phase_${e(qe)[0][0].clock.period.key??""} svelte-14z6bdh`)),s(_e,C)}),f(()=>Be(N,`duel_log_block_turn duel_log_block_turn_${e(L)[0][0][0].clock.turn??""} svelte-14z6bdh`)),s(B,N)}),Ha(q,B=>y(t,B),()=>e(t)),s(h,l)};w(D,h=>{(d().duel.view.infoBoardState==="Log"||d().duel.view.infoBoardState==="Default")&&h(Y)})}s(n,v),nt()}var Or=o("<div><div> </div> <div> </div></div>");function xa(n,i){lt(i,!1);let t=Le(i,"duelist",12),d=Ce(0),_=Ce();const c=async()=>{const q=t().lp-e(d);if(!e(_)||Math.abs(q)<10){y(d,t().lp),e(_)&&(e(_)(),y(_,void 0));return}y(d,e(d)+Math.floor(Math.random()*q)),await kt(100),c()},g=()=>{t(t()),!e(_)&&t().lp!==e(d)&&new Promise(q=>{y(_,q),Math.abs(t().lp-e(d)),c()})};t().duel.log.onUpdate.append(g),c(),ot();var v=Or(),D=a(v),Y=a(D),h=r(D,2),l=a(h);f(q=>{Be(v,`duelist duelist_${q??""} svelte-1sy3trd`),Be(D,`duelist_name duelist_${q??""}_name svelte-1sy3trd`),p(Y,t().profile.name),Be(h,`duelist_lp ${(e(_)?"vibration":"")??""} svelte-1sy3trd`),p(l,e(d))},[()=>t().seat.toLowerCase()],he),s(n,v),nt()}const Lr=(n,i,t)=>(i(i()==="Normal"?"Debug":"Normal"),console.info(t()),!0);var Rr=o('<div class="duel_card_info_row svelte-19vwcsh" style=" justify-content: space-between;"><div class="svelte-19vwcsh"> </div> <div class="svelte-19vwcsh"> </div></div>'),Wr=o('<div></div> <div class="svelte-19vwcsh"> </div>',1),Kr=o("<div> </div>"),zr=o("<div> </div>"),Gr=o('<div class="duel_card_info_row svelte-19vwcsh"><!> <!></div> <div class="duel_card_info_row svelte-19vwcsh"></div>',1),Xr=o('<div class="duel_card_row svelte-19vwcsh"><div class="svelte-19vwcsh"></div> <div class="svelte-19vwcsh"> </div></div>'),Vr=o('<div class="duel_card_row svelte-19vwcsh"><div class="svelte-19vwcsh"></div> <div class="svelte-19vwcsh"> </div></div>'),Qr=o("<!> <!>",1),Zr=o('<div class="duel_card_info_row svelte-19vwcsh" style="border-style: solid; border-width: 1px;"><pre class="description svelte-19vwcsh"> </pre></div>'),Jr=o('<!> <div class="duel_card_info_row svelte-19vwcsh"><pre class="description svelte-19vwcsh"> </pre></div>',1),es=o("[ <!> ],",1),ts=o('<div class="svelte-19vwcsh"> <!></div>'),as=o('<div class="svelte-19vwcsh"> </div> <!> <div class="svelte-19vwcsh"></div>',1),rs=o('<div class="svelte-19vwcsh"> </div>'),ss=o('<div class="svelte-19vwcsh"> </div>'),is=o('<div class="svelte-19vwcsh"> </div>'),ls=o('<div class="svelte-19vwcsh"> </div>'),os=o('<div class="svelte-19vwcsh"> </div>'),ns=o('<div class="svelte-19vwcsh"> </div>'),vs=o('<div class="duel_card_info_row svelte-19vwcsh"><div class="svelte-19vwcsh"><!> <div class="svelte-19vwcsh"></div> <!> <div class="svelte-19vwcsh"></div> <div class="svelte-19vwcsh"></div> <!> <div class="svelte-19vwcsh"></div> <div class="svelte-19vwcsh"></div> <!> <div class="svelte-19vwcsh"></div> <div class="svelte-19vwcsh"></div> <!> <div class="svelte-19vwcsh"></div> <div class="svelte-19vwcsh"></div> <!> <div class="svelte-19vwcsh"></div> <div class="svelte-19vwcsh"></div> <!> <div class="svelte-19vwcsh"></div> <div class="svelte-19vwcsh"></div> <div class="svelte-19vwcsh"> </div> <div class="svelte-19vwcsh"> </div> <div class="svelte-19vwcsh"> </div> <div class="svelte-19vwcsh"></div></div></div>'),ds=o('<div class="svelte-19vwcsh">※テスト用カードです</div>'),cs=o('<div class="duel_card_info_links svelte-19vwcsh"><a target="_blank" rel="noopener noreferrer" title="遊戯王カードWiki" class="svelte-19vwcsh">⇒遊戯王カードWiki</a> <a target="_blank" rel="noopener noreferrer" title="コナミカードデータベース" class="svelte-19vwcsh"> </a></div>'),_s=o('<div role="contentinfo"><div class="duel_card_info_header svelte-19vwcsh"><div class="duel_card_info_row svelte-19vwcsh"><div class="svelte-19vwcsh"> </div></div> <div class="duel_card_info_row svelte-19vwcsh" style="position:sticky; top:0;"><div class="svelte-19vwcsh"> </div> <div class="svelte-19vwcsh"> </div></div> <!></div> <div class="duel_card_info_body svelte-19vwcsh"><!></div> <div class="duel_card_info_footer svelte-19vwcsh"><!></div></div>');function us(n,i){lt(i,!1);let t=Le(i,"entity",8,void 0);const d=()=>t()?ft[t().origin.name]:void 0,_=()=>{var Y;return t()&&(t().origin.cardId??!1)?`https://www.db.yugioh-card.com/yugiohdb/card_search.action?ope=2&cid=${t().origin.cardId}`:`https://www.db.yugioh-card.com/yugiohdb/card_search.action?ope=1&sess=1&rp=10&mode=&sort=1&keyword=${(Y=d())==null?void 0:Y.name}&stype=1&ctype=&othercon=2&starfr=&starto=&pscalefr=&pscaleto=&linkmarkerfr=&linkmarkerto=&link_m=2&atkfr=&atkto=&deffr=&defto=&releaseDStart=1&releaseMStart=1&releaseYStart=1999&releaseDEnd=&releaseMEnd=&releaseYEnd=`};let c=Le(i,"mode",12,"Normal");ot();var g=Pe(),v=z(g);{var D=Y=>{var h=_s();h.__contextmenu=[Lr,c,t];var l=a(h),q=a(l),B=a(q),L=a(B),N=r(q,2),A=a(N),T=a(A),te=r(A,2),_e=a(te),qe=r(N,2);{var C=R=>{var I=Qr(),se=z(I);{var ae=W=>{var re=Rr(),$=a(re),u=a($),x=r($,2),P=a(x);f(()=>{p(u,`◀ ${t().psL??""}`),p(P,`${t().psR??""} ▶`)}),s(W,re)};w(se,W=>{var re;(re=t().status.monsterCategories)!=null&&re.includes("Pendulum")&&W(ae)})}var fe=r(se,2);{var G=W=>{var re=Gr(),$=z(re),u=a($);ve(u,1,()=>t().attr,ce,(pe,K)=>{var ge=Wr(),U=z(ge),ie=r(U,2),m=a(ie);f(()=>{Be(U,`monster_attr ${e(K)??""} svelte-19vwcsh`),p(m,`${Qt[e(K)]??""}属性`)}),s(pe,ge)});var x=r(u,2);ve(x,1,()=>t().types,ce,(pe,K)=>{var ge=Kr(),U=a(ge);f(()=>{Be(ge,`monster_cat ${e(K)??""} svelte-19vwcsh`),p(U,`${Pt[e(K)]??""}${Zt[e(K)]??""}族`)}),s(pe,ge)});var P=r($,2);ve(P,5,()=>t().status.monsterCategories??[],ce,(pe,K)=>{var ge=zr(),U=a(ge);f(()=>{Be(ge,`monster_cat ${e(K)??""} svelte-19vwcsh`),p(U,`${It[e(K)]??""}${Jt[e(K)]??""}`)}),s(pe,ge)}),s(W,re)},S=W=>{var re=Pe(),$=z(re);{var u=P=>{var pe=Xr(),K=r(a(pe),2),ge=a(K);f(()=>p(ge,`${Ht[t().status.spellCategory]??""}魔法`)),s(P,pe)},x=P=>{var pe=Pe(),K=z(pe);{var ge=U=>{var ie=Vr(),m=r(a(ie),2),E=a(m);f(()=>p(E,`${Ut[t().status.trapCategory]??""}罠`)),s(U,ie)};w(K,U=>{t().kind==="Trap"&&t().status.trapCategory&&U(ge)},!0)}s(P,pe)};w($,P=>{t().kind==="Spell"&&t().status.spellCategory?P(u):P(x,!1)},!0)}s(W,re)};w(fe,W=>{t().kind==="Monster"?W(G):W(S,!1)})}s(R,I)};w(qe,R=>{c()==="Normal"&&R(C)})}var b=r(l,2),H=a(b);{var ee=R=>{var I=Jr(),se=z(I);{var ae=W=>{var re=Zr(),$=a(re),u=a($);f(()=>p(u,ft[t().origin.name].pendulumDescription)),s(W,re)};w(se,W=>{var re;(re=t().status.monsterCategories)!=null&&re.includes("Pendulum")&&W(ae)})}var fe=r(se,2),G=a(fe),S=a(G);f(W=>p(S,W),[()=>{var W;return(W=d())==null?void 0:W.description}],he),s(R,I)},De=R=>{var I=vs(),se=a(I),ae=a(se);ve(ae,0,()=>["info","status"],ce,(Ne,X)=>{var J=as(),Ae=z(J),k=a(Ae),M=r(Ae,2);ve(M,1,()=>Object.entries(t()[X]),ce,(ke,Ie)=>{let Ue=()=>e(Ie)[0],F=()=>e(Ie)[1];var xe=ts(),Ye=a(xe),Re=r(Ye);{var He=Je=>{var tt=es(),Qe=r(z(tt));ve(Qe,1,F,ce,($e,je)=>{var Se=it();f(Fe=>p(Se,`${Fe??""},`),[()=>e(je).toString()],he),s($e,Se)}),s(Je,tt)},Xe=Je=>{var tt=it();f(Qe=>p(tt,`${Qe??""},`),[()=>{var Qe;return(Qe=F())==null?void 0:Qe.toString()}],he),s(Je,tt)};w(Re,Je=>{Array.isArray(F())?Je(He):Je(Xe,!1)})}f(()=>p(Ye,`"${Ue()??""}" : `)),s(ke,xe)});var O=r(M,2);O.textContent="},",f(()=>p(k,`"${X??""}" :{`)),s(Ne,J)});var fe=r(ae,2);fe.textContent='"actions" :[';var G=r(fe,2);ve(G,1,()=>t().actions,ce,(Ne,X)=>{var J=rs(),Ae=a(J);f(()=>p(Ae,`"${e(X).playType??""} ${e(X).title??""}",`)),s(Ne,J)});var S=r(G,2);S.textContent="],";var W=r(S,2);W.textContent='"substituteEffects" :[';var re=r(W,2);ve(re,1,()=>t().substituteEffects,ce,(Ne,X)=>{var J=ss(),Ae=a(J);f(()=>p(Ae,`"${e(X).title??""}",`)),s(Ne,J)});var $=r(re,2);$.textContent="],";var u=r($,2);u.textContent='"continuousEffects" :[';var x=r(u,2);ve(x,1,()=>t().continuousEffects,ce,(Ne,X)=>{var J=is(),Ae=a(J);f(()=>p(Ae,`"${e(X).isStarted??""}",`)),s(Ne,J)});var P=r(x,2);P.textContent="],";var pe=r(P,2);pe.textContent='"procFilters" :[';var K=r(pe,2);ve(K,1,()=>t().procFilterBundle.operators,ce,(Ne,X)=>{var J=ls(),Ae=a(J);f(k=>p(Ae,`"${k??""} ${e(X).title??""} ${e(X).isEffective??""} ",`),[()=>e(X).isSpawnedBy.toString()],he),s(Ne,J)});var ge=r(K,2);ge.textContent="],";var U=r(ge,2);U.textContent='"numericStateOperators" :[';var ie=r(U,2);ve(ie,1,()=>t().numericOprsBundle.operators,ce,(Ne,X)=>{var J=os(),Ae=a(J);f(k=>p(Ae,`"${k??""} ${e(X).title??""} ${e(X).isEffective??""} ${e(X).isContinuous??""} ${e(X).targetState??""} ${e(X).targetStateGen??""} ",`),[()=>e(X).isSpawnedBy.toString()],he),s(Ne,J)});var m=r(ie,2);m.textContent="],";var E=r(m,2);E.textContent='"stateOperators" :[';var Q=r(E,2);ve(Q,1,()=>t().statusOperatorBundle.operators,ce,(Ne,X)=>{var J=ns(),Ae=a(J);f(k=>p(Ae,`"${k??""} ${e(X).title??""} ${e(X).isEffective??""} ",`),[()=>e(X).isSpawnedBy.toString()],he),s(Ne,J)});var ye=r(Q,2);ye.textContent="],";var ue=r(ye,2);ue.textContent='"lastMoveLogRecord" :{';var le=r(ue,2),Te=a(le),oe=r(le,2),j=a(oe),me=r(oe,2),Ee=a(me),Ge=r(me,2);Ge.textContent="},",f((Ne,X)=>{p(Te,`"movedBy":"${Ne??""}",`),p(j,`"movedAs":"${X??""}",`),p(Ee,`"movedAt":"${t().moveLog.latestRecord.movedAt.totalProcSeq??""}",`)},[()=>{var Ne;return(Ne=t().moveLog.latestRecord.movedBy)==null?void 0:Ne.toString()},()=>t().moveLog.latestRecord.movedAs.join(" ")],he),s(R,I)};w(H,R=>{c()==="Normal"?R(ee):R(De,!1)})}var Z=r(b,2),de=a(Z);{var V=R=>{var I=ds();s(R,I)},be=R=>{var I=cs(),se=a(I),ae=r(se,2),fe=a(ae);f(G=>{var S;gt(se,"href",`https://yugioh-wiki.net/index.php?${t().origin.wikiEncodedName}`),gt(ae,"href",G),p(fe,`⇒${((S=t())!=null&&S.origin.cardId?"公式カードページ":"公式で検索")??""}`)},[_],he),s(R,I)};w(de,R=>{var I;(I=t())!=null&&I.origin.isForTest?R(V):R(be,!1)})}f((R,I,se)=>{Be(h,`duel_card duel_card_info ${t().origin.kind??""} ${R??""} svelte-19vwcsh`),p(L,t().nm),p(T,I),p(_e,se)},[()=>{var R;return(R=t().origin.monsterCategories)==null?void 0:R.join(" ")},()=>"★".repeat(t().lvl||0),()=>"☆".repeat(t().rank||0)],he),s(Y,h)};w(v,Y=>{t()&&Y(D)})}s(n,g),nt()}Da(["contextmenu"]);var fs=o('<div class="duel_field_cell_info_item svelte-1xj7qf1"><!></div>'),ps=o('<div class="duel_field_cell_info_box svelte-1xj7qf1"><div class="duel_field_cell_info_label svelte-1xj7qf1"> </div> <!></div>'),gs=o('<div class="duel_field_cell_info svelte-1xj7qf1"><div class="duel_field_cell_info_header item_btn svelte-1xj7qf1"><div class="svelte-1xj7qf1"> </div> <div class="svelte-1xj7qf1"> </div></div> <div class="duel_field_cell_info_body svelte-1xj7qf1"></div></div>');function ms(n,i){lt(i,!1);let t=Le(i,"cell",12);const d=()=>{t(t())},_=D=>t().cardEntities.filter(Y=>Y.face===D);t().field.duel.view.onDuelUpdate.append(d),ot();var c=Pe(),g=z(c);{var v=D=>{var Y=gs(),h=a(Y),l=a(h),q=a(l),B=r(l,2),L=a(B),N=r(h,2);ve(N,4,()=>["FaceUp","FaceDown"],ce,(A,T)=>{var te=Pe(),_e=z(te);{var qe=C=>{var b=ps(),H=a(b),ee=a(H),De=r(H,2);ve(De,1,()=>_(T).toSorted(Ua),ce,(Z,de)=>{var V=fs(),be=a(V);const R=he(()=>t().owner===t().field.duel.duelists.Below);wt(be,{get entity(){return e(de)},get isVisibleForcibly(){return e(R)},isWideMode:!0,cardActionResolve:void 0}),s(Z,V)}),f(()=>p(ee,T==="FaceUp"?"表向き":"裏向き")),s(C,b)};w(_e,C=>{_(T).length&&C(qe)})}s(A,te)}),f(()=>{var A;p(q,(A=t().owner)==null?void 0:A.profile.name),p(L,t().cellType)}),s(D,Y)};w(g,D=>{t().field.duel.view.infoBoardState==="CellInfo"&&D(v)})}s(n,c),nt()}var hs=o('<div class="duel_config_item svelte-y4u26k"><label class="toggle svelte-y4u26k"><input type="checkbox" class="svelte-y4u26k"></label> <span class="svelte-y4u26k"> </span></div>'),bs=o('<div class="duel_config svelte-y4u26k"><div class="duel_config_title svelte-y4u26k">デュエル設定</div> <div class="duel_config_group svelte-y4u26k"><div class="duel_config_group_title svelte-y4u26k">チェーン設定</div> <!></div></div>');function ys(n,i){lt(i,!1);let t=Le(i,"viewController",8),d=Le(i,"userProfile",12);ot();var _=Pe(),c=z(_);{var g=v=>{var D=bs(),Y=r(a(D),2),h=r(a(Y),2);ve(h,1,()=>Oa,ce,(l,q)=>{var B=hs(),L=a(B),N=a(L),A=r(L,2),T=a(A);f(()=>p(T,ja[e(q)])),Fa(N,()=>d().chainConfig[e(q)],te=>d(d().chainConfig[e(q)]=te,!0)),we("change",N,()=>d().save()),s(l,B)}),s(v,D)};w(c,v=>{t().infoBoardState==="Config"&&v(g)})}s(n,_),nt()}function ws(n,{from:i,to:t},d={}){var{delay:_=0,duration:c=b=>Math.sqrt(b)*120,easing:g=zt}=d,v=getComputedStyle(n),D=v.transform==="none"?"":v.transform,[Y,h]=v.transformOrigin.split(" ").map(parseFloat);Y/=n.clientWidth,h/=n.clientHeight;var l=ks(n),q=n.clientWidth/t.width/l,B=n.clientHeight/t.height/l,L=i.left+i.width*Y,N=i.top+i.height*h,A=t.left+t.width*Y,T=t.top+t.height*h,te=(L-A)*q,_e=(N-T)*B,qe=i.width/t.width,C=i.height/t.height;return{delay:_,duration:typeof c=="function"?c(Math.sqrt(te*te+_e*_e)):c,easing:g,css:(b,H)=>{var ee=H*te,De=H*_e,Z=b+H*qe,de=b+H*C;return`transform: ${D} translate(${ee}px, ${De}px) scale(${Z}, ${de});`}}}function ks(n){if("currentCSSZoom"in n)return n.currentCSSZoom;for(var i=n,t=1;i!==null;)t*=+getComputedStyle(i).zoom,i=i.parentElement;return t}var xs=o('<div class="chain_number svelte-d2f52m"> </div>'),Cs=o('<div class="duel_card_row svelte-d2f52m"> </div>'),Ds=o('<div class="appendix svelte-d2f52m"> </div>'),$s=o('<div class="appendix_wrapper svelte-d2f52m"></div>'),Ss=o('<div><div><!> <div> </div> <div><!> <div class="duel_card_row svelte-d2f52m"><div> </div> <!></div></div></div></div>'),Ms=o("<div></div>");function Ts(n,i){lt(i,!1);let t=Le(i,"duel",8),d=Le(i,"position",8,"left");const _=-100,c=()=>d()==="left"?-100:100;let g=Ce([]),v=Promise.resolve(),D=Promise.resolve();const Y=1e3,h=500,l=400,q=L=>{const N={...L};N.isKnown=L.chainBlockInfo.action.entity.controller.duelistType==="Player"||L.chainBlockInfo.action.entity.face==="FaceUp",N.chainBlockInfo.onStateChange.append(A=>{if(A==="done"||A==="failed"||A==="nagated")return v=v.then(async()=>{const T=new Date().getTime()-N.chainBlockInfo.wasSpawnedAt.getTime();T<Y&&await kt(Y-T),y(g,e(g).filter(te=>te.seq!==N.seq)),await kt(h+l)}).then(),"RemoveMe";y(g,e(g))}),D=D.then(async()=>{y(g,[N,...e(g)].sort((A,T)=>La.isSameChain(A.clock,T.clock)&&A.chainBlockInfo.action.isWithChainBlock&&T.chainBlockInfo.action.isWithChainBlock?T.clock.totalProcSeq-A.clock.totalProcSeq:A.clock.totalProcSeq-T.clock.totalProcSeq)),await kt(300)}),v=v.then(()=>kt(1e3))};t().chainBlockLog.onInsert.append(q),ot();var B=Ms();ve(B,13,()=>e(g),L=>L.seq,(L,N)=>{var A=Ss();const T=he(()=>{const{activator:I,action:se,appendix:ae}=e(N).chainBlockInfo;return{activator:I,action:se,appendix:ae}});var te=a(A),_e=a(te);{var qe=I=>{var se=xs(),ae=a(se);f(()=>p(ae,`チェーン：${e(N).chainBlockInfo.chainNumber??""}`)),s(I,se)};w(_e,I=>{e(N).chainBlockInfo.chainNumber&&I(qe)})}var C=r(_e,2),b=a(C),H=r(C,2),ee=a(H);{var De=I=>{var se=Cs(),ae=a(se);f(()=>p(ae,e(N).isKnown?e(T).action.entity.nm:"？？？")),s(I,se)};w(ee,I=>{(e(T).action.entity.entityType==="Card"||e(T).action.entity.entityType==="Token")&&I(De)})}var Z=r(ee,2),de=a(Z),V=a(de),be=r(de,2);{var R=I=>{var se=$s();ve(se,5,()=>e(T).appendix,ce,(ae,fe)=>{var G=Ds(),S=a(G);f(()=>p(S,e(fe))),s(ae,G)}),s(I,se)};w(be,I=>{e(T).appendix&&I(R)})}f((I,se,ae)=>{Be(A,`cut_in_row ${(!e(N).chainBlockInfo.chainNumber||e(N).chainBlockInfo.chainNumber===1?"cut_in_row_first":"")??""} svelte-d2f52m`),Be(te,`cut_in_item cut_in_item_${I??""} cut_in_item_${e(N).chainBlockInfo.state??""} svelte-d2f52m`),Be(C,`duelist_name duelist_${I??""}_name svelte-d2f52m`),p(b,e(T).activator.profile.name),Be(H,`duel_card duel_card_${I??""} ${se??""} ${(e(N).isKnown?e(T).action.entity.origin.kind:"")??""} ${e(T).action.entity.entityType??""}  svelte-d2f52m`),p(V,ae)},[()=>e(T).activator.seat.toLowerCase(),()=>e(N).isKnown?(e(T).action.entity.status.monsterCategories??[]).join(" "):"Token",()=>e(T).action.toString()],he),ne(3,te,()=>dr,()=>new Date().getTime()-e(N).chainBlockInfo.wasSpawnedAt.getTime()<Y?{x:c(),duration:l}:{y:_,duration:l}),Ra(A,()=>ws,()=>({duration:h})),s(L,A)}),f(()=>Be(B,`cut_in_container cut_in_container_${d()??""} svelte-d2f52m`)),s(n,B),nt()}const Es=cr({duration:400});var qs=o('<div class="duel_desk_left v_flex svelte-1i63tk9"><!> <!> <!></div>'),As=o('<button class="duel_field_header_message svelte-1i63tk9"> </button> <div class="duel_field_header_buttons svelte-1i63tk9"><button class="svelte-1i63tk9">サレンダー</button></div>',1),Ys=o("<tr></tr>"),Bs=o('<table class="duel_field svelte-1i63tk9"><tbody class="svelte-1i63tk9"></tbody></table>'),Ns=o('<button class="svelte-1i63tk9">OK</button>'),Ps=o('<button class="svelte-1i63tk9">cancel</button>'),Is=o("<!> <!>",1),Hs=o('<button class="svelte-1i63tk9"> </button>'),Us=o('<div style="text-align: left;"><!> <!> <!></div>'),js=o('<div><!> <div class=" duel_desk_center v_flex svelte-1i63tk9"><div class="duel_field_header svelte-1i63tk9"><!></div> <div class="duel_field_body svelte-1i63tk9"><!></div> <div class="duel_field_footer svelte-1i63tk9"><!></div></div> <!></div> <div style="position:fixed;left:0;bottom:0"> </div> <!> <div><!></div>',1);function Fs(n,i){lt(i,!1);let t=Le(i,"duel",12),d=Le(i,"userProfile",8),_=Ce(0),c=Ce(0),g=Ce([]),v=Ce([]),D=()=>{},Y=Ce([]),h=Ce(),l=Ce(),q=Ce(()=>!1),B=Ce(!1);const L=m=>{D=m.resolve,y(Y,m.dummyActionInfos.filter(E=>E.action.entity.entityType==="Duelist").filter(E=>E.action.entity.controller.seat==="Below")),y(h,void 0),y(l,void 0),y(v,[]),y(g,[]),y(B,!1),m.entitiesChoices&&(y(h,m.entitiesChoices),y(q,()=>{var E;return((E=m.entitiesChoices)==null?void 0:E.validator(e(g)))??!1}),y(B,m.entitiesChoices.cancelable),e(h).selectables.every(E=>E.cell.isPlayFieldCell&&E.getIndexInCell()===0||E.cell.cellType==="Hand"&&E.controller.duelistType==="Player"||E.entityType==="Duelist")||t().view.modalController.entitySelector.show({title:t().view.message,position:"Middle",entitiesChoices:m.entitiesChoices,chainBlockInfos:m.chainBlockInfos,cancelable:m.entitiesChoices.cancelable}).then(E=>{D({selectedEntities:E})})),m.cellsChoices&&(y(l,m.cellsChoices),y(q,()=>{var E;return((E=m.cellsChoices)==null?void 0:E.validator(e(v)))??!1}),y(B,m.cellsChoices.cancelable))};t().view.onWaitStart.append(L);const N=()=>{D=()=>{},y(l,void 0),y(h,void 0),y(v,[]),y(g,[]),y(q,()=>!1),y(B,!1)};t().view.onWaitEnd.append(N);let A=Ce(void 0),T=Ce("Normal");const te=({card:m,mode:E})=>{y(A,m),y(T,E)};t().view.onShowCardEntity.append(te);const _e=()=>{t(t())};t().view.onDuelUpdate.append(_e),t().log.onUpdate.append(_e);const qe=()=>{e(h)&&e(h).validator(e(g))&&D({selectedEntities:e(g)}),e(l)&&e(l).validator(e(v))&&D({selectedCells:e(v)})},C=()=>{D({})},b=m=>{D({actionInfo:m})},H=()=>{D({surrender:!0})};t().main();const ee=()=>e(_)<=1400?"compact":"wide";ot();var De=js(),Z=z(De),de=a(Z);{var V=m=>{var E=qs(),Q=a(E);xa(Q,{get duelist(){return t().duelists.Above}});var ye=r(Q,2);us(ye,{get entity(){return e(A)},get mode(){return e(T)}});var ue=r(ye,2);xa(ue,{get duelist(){return t().duelists.Below}}),s(m,E)};w(de,m=>{ee()==="wide"&&m(V)})}var be=r(de,2),R=a(be),I=a(R);{var se=m=>{var E=As(),Q=z(E),ye=a(Q),ue=r(Q,2),le=a(ue);f(()=>p(ye,`[TURN:${t().clock.turn}][PHASE:${t().phase}] ${t().view.message}`)),we("click",Q,()=>{t(t().view.infoBoardState="Log",!0)}),we("click",le,H),s(m,E)};w(I,m=>{t().isEnded||m(se)})}var ae=r(R,2),fe=a(ae);{var G=m=>{var E=Bs(),Q=a(E);ve(Q,5,()=>t().field.cells,ce,(ye,ue,le)=>{var Te=Ys();Be(Te,`${`duel_desk_row_${le}`??""} svelte-1i63tk9`),ve(Te,5,()=>e(ue),ce,(oe,j,me)=>{Ar(oe,{get view(){return t().view},row:le,column:me,get selectedEntities(){return e(g)},set selectedEntities(Ee){y(g,Ee)},get selectedCells(){return e(v)},set selectedCells(Ee){y(v,Ee)},$$legacy:!0})}),s(ye,Te)}),s(m,E)};w(fe,m=>{t().clock.turn>0&&m(G)})}var S=r(ae,2),W=a(S);{var re=m=>{var E=Is(),Q=z(E);{var ye=Te=>{var oe=Ns();f(j=>oe.disabled=j,[()=>!e(q)()],he),we("click",oe,qe),s(Te,oe)};w(Q,Te=>{((e(h)&&e(h).qty)??(e(l)&&e(l).qty)??9999)>1&&Te(ye)})}var ue=r(Q,2);{var le=Te=>{var oe=Ps();we("click",oe,C),s(Te,oe)};w(ue,Te=>{e(B)&&Te(le)})}s(m,E)},$=m=>{var E=Pe(),Q=z(E);ve(Q,1,()=>e(Y),ce,(ye,ue)=>{var le=Hs(),Te=a(le);f(()=>p(Te,e(ue).action.title)),we("click",le,()=>b(e(ue))),s(ye,le)}),s(m,E)};w(W,m=>{e(h)&&e(h).selectables.length||e(l)&&e(l).selectables?m(re):m($,!1)})}var u=r(be,2);{var x=m=>{var E=Us(),Q=a(E);Fr(Q,{get log(){return t().log}});var ye=r(Q,2);ms(ye,{get cell(){return t().view.infoBoardCell}});var ue=r(ye,2);ys(ue,{get userProfile(){return d()},get viewController(){return t().view}}),f(le=>Be(E,`duel_desk_right duel_desk_right_${le??""}  svelte-1i63tk9`),[()=>t().view.infoBoardState.toLowerCase()],he),ne(3,E,()=>Me,()=>({duration:e(_)>1400?0:200,axis:"x"})),s(m,E)};w(u,m=>{(e(_)>1400||t().view.infoBoardState!=="Default")&&m(x)})}var P=r(Z,2),pe=a(P),K=r(P,2);Wa(K,{get modalController(){return t().view.modalController}});var ge=r(K,2),U=a(ge);const ie=he(()=>ee()==="wide"?"right":"left");Ts(U,{get duel(){return t()},get position(){return e(ie)}}),f((m,E)=>{Be(Z,`flex duel_desk ${m??""}_mode svelte-1i63tk9`),p(pe,E),Be(ge,`cutin ${m??""}_mode svelte-1i63tk9`)},[ee,()=>t().clock.toFullString()],he),At("innerWidth",m=>y(_,m)),At("innerHeight",m=>y(c,m)),s(n,De),nt()}var Os=o('<div class="svelte-swqq02"><button class="button_style_reset svelte-swqq02" title="※shiftキー同時押しで一括外し">クリア</button></div>'),Ls=o('<div class="svelte-swqq02"><button class="button_style_reset svelte-swqq02" title="※shiftキー同時押しで一括外し">クリア</button></div>'),Rs=o("<div></div>"),Ws=o("<!> <!> <!> <!> <!>",1),Ks=o('<span> </span> / <span style="display: inline-block;width:2rem;text-align: right;"> </span>',1),zs=o('<li class="deck_editor_item svelte-swqq02"><div role="listitem"><div class="svelte-swqq02"><div class="svelte-swqq02"> </div> <div style="display:flex" class="svelte-swqq02"><div class="svelte-swqq02"><!> <!> <!></div> <div style="flex-grow: 1; width:0.1rem" class="svelte-swqq02"></div> <div class="svelte-swqq02"><!></div></div></div></div> <button class="button_style_reset svelte-swqq02" title="※shiftキー同時押しで一括投入">+</button> <button class="button_style_reset svelte-swqq02" title="※shiftキー同時押しで一括外し">-</button></li>'),Gs=o('<div class="deck_editor_card_kind svelte-swqq02"><div class="deck_editor_card_kind_header svelte-swqq02"><div class="svelte-swqq02"> </div> <!></div> <ul class="svelte-swqq02"></ul></div>'),Xs=o('<div class="deck_editor_deck_type svelte-swqq02"><div class="deck_editor_deck_type_header svelte-swqq02"><div class="svelte-swqq02"> </div> <!></div> <!></div>'),Vs=o('<div class="svelte-swqq02">読み込み中...</div>'),Qs=o('<div class="deck_editor_card_list svelte-swqq02"><!></div>');function Ca(n,i){lt(i,!1);let t=Le(i,"allCardInfos",8),d=Le(i,"deckCardInfos",12),_=Le(i,"mode",8),c=Le(i,"onAttention",8),g=Le(i,"searchCondition",8,void 0);const v={Deck:["Monster","Spell","Trap"],ExtraDeck:["Monster"]},D={Deck:{Monster:[],Spell:[],Trap:[]},ExtraDeck:{Monster:[],Spell:[],Trap:[]}},Y=C=>{var b;return(b=C.monsterCategories)!=null&&b.union(Yt).length?"ExtraDeck":"Deck"},h=C=>{Object.values(D).forEach(b=>Object.values(b).forEach(H=>H.reset())),C.filter(b=>b.isImplemented).filter(b=>b.kind!=="XyzMaterial").forEach(b=>{var ee;if(b.kind==="XyzMaterial")return;const H=(ee=b.monsterCategories)!=null&&ee.union(Yt).length?"ExtraDeck":"Deck";D[H][b.kind].push(b)}),Object.values(D).forEach(b=>Object.values(b).forEach(H=>H.sort(Wt)))},l=_()==="List"?new Promise(C=>{h(t()),C()}):Promise.resolve(),q=()=>(_()==="Deck"&&(h(d()),y(A,d().length)),D),B=(C,b,H)=>{d(d().filter(ee=>Y(ee)!==b||ee.kind!==H&&H))},L=(C,b)=>{try{if(C.ctrlKey){d().push(b);return}const H=d().filter(De=>De.name===b.name).length;if(H>2)return;const ee=C.shiftKey?3-H:1;if(ee<1)return;d().push(...Array(ee).fill(b))}finally{d().sort(Wt),d(d())}},N=(C,b)=>{let H=0;d(d().filter(ee=>ee.name!==b.name?!0:(H++,!C.shiftKey&&H>1))),d().sort(Wt)};let A=Ce(100);const T=()=>{e(A)>t().length+d().length||(y(A,e(A)+10),kt(100).then(T))};kt(100).then(T);const te=(C,b)=>{if(!g())return!0;if(!g().cardKinds.includes(C.kind)||g().name.trim().length&&[C.name,...C.nameTags??[],...C.textTags??[]].every(ee=>!ee.includes(g().name))||C.isForTest&&!g().others.includes("test"))return!1;if(C.kind==="Monster")return C.attributes&&!g().monsterAttributes.union(C.attributes).length||C.types&&!g().monsterTypes.union(C.types).length||!C.monsterCategories?!1:C.monsterCategories.union(g().monsterCategories).length;if(C.kind==="Spell")return C.spellCategory&&g().spellCategories.includes(C.spellCategory);if(C.kind==="Trap")return C.trapCategory&&g().trapCategories.includes(C.trapCategory)};ot();var _e=Qs(),qe=a(_e);pt(qe,()=>l,C=>{var b=Vs();s(C,b)},C=>{var b=Pe();const H=he(q);var ee=z(b);ve(ee,1,()=>za,ce,(De,Z)=>{var de=Xs();const V=he(()=>Object.values(e(H)[e(Z)]).flatMap(G=>G));var be=a(de),R=a(be),I=a(R),se=r(R,2);{var ae=G=>{var S=Os(),W=a(S);we("click",W,re=>B(re,e(Z),void 0)),s(G,S)};w(se,G=>{_()==="Deck"&&e(V).some(te)&&G(ae)})}var fe=r(be,2);ve(fe,1,()=>Vt(e(H)[e(Z)]).filter(G=>v[e(Z)].includes(G)),ce,(G,S)=>{var W=Gs();const re=he(()=>e(H)[e(Z)][e(S)].filter(te));var $=a(W),u=a($),x=a(u),P=r(u,2);{var pe=ge=>{var U=Ls(),ie=a(U);we("click",ie,m=>B(m,e(Z),e(S))),s(ge,U)};w(P,ge=>{_()==="Deck"&&e(re).length&&ge(pe)})}var K=r($,2);ve(K,5,()=>e(re),ce,(ge,U,ie)=>{var m=Pe(),E=z(m);{var Q=ye=>{var ue=zs(),le=a(ue),Te=a(le),oe=a(Te),j=a(oe),me=r(oe,2),Ee=a(me),Ge=a(Ee);{var Ne=F=>{var xe=Ws(),Ye=z(xe);{var Re=$e=>{var je=it();f(()=>p(je,`★${e(U).level??""}`)),s($e,je)};w(Ye,$e=>{e(U).level&&$e(Re)})}var He=r(Ye,2);{var Xe=$e=>{var je=it();f(()=>p(je,`☆${e(U).rank??""}`)),s($e,je)};w(He,$e=>{e(U).rank&&$e(Xe)})}var Je=r(He,2);ve(Je,1,()=>e(U).attributes??[],ce,($e,je)=>{var Se=Rs();f(()=>Be(Se,`monster_attr ${e(je)??""} svelte-swqq02`)),s($e,Se)});var tt=r(Je,2);ve(tt,1,()=>e(U).types??[],ce,($e,je)=>{var Se=it();f(()=>p(Se,Pt[e(je)])),s($e,Se)});var Qe=r(tt,2);ve(Qe,1,()=>e(U).monsterCategories??[],ce,($e,je)=>{var Se=it();f(()=>p(Se,It[e(je)])),s($e,Se)}),s(F,xe)};w(Ge,F=>{e(U).kind==="Monster"&&F(Ne)})}var X=r(Ge,2);{var J=F=>{var xe=it();f(()=>p(xe,`${Ht[e(U).spellCategory]??""}魔法`)),s(F,xe)};w(X,F=>{e(U).spellCategory!==void 0&&F(J)})}var Ae=r(X,2);{var k=F=>{var xe=it();f(()=>p(xe,`${Ut[e(U).trapCategory]??""}罠`)),s(F,xe)};w(Ae,F=>{e(U).trapCategory!==void 0&&F(k)})}var M=r(Ee,4),O=a(M);{var ke=F=>{var xe=Ks(),Ye=z(xe),Re=a(Ye),He=r(Ye,2),Xe=a(He);f(()=>{p(Re,e(U).attack??"?"),p(Xe,e(U).defense??"?")}),s(F,xe)};w(O,F=>{e(U).kind==="Monster"&&F(ke)})}var Ie=r(le,2),Ue=r(Ie,2);f(F=>{Be(le,`${F??""} svelte-swqq02`),p(j,e(U).name)},[()=>{var F,xe;return`deck_editor_card duel_card ${e(U).kind} ${(xe=(F=e(U))==null?void 0:F.monsterCategories)==null?void 0:xe.join(" ")} ${e(U).isImplemented?"is_implemented":"is_not_implemented"}`}],he),we("mouseenter",le,()=>c()(e(U))),we("click",Ie,F=>L(F,e(U))),we("click",Ue,F=>N(F,e(U))),s(ye,ue)};w(E,ye=>{ie<e(A)&&ye(Q)})}s(ge,m)}),f(()=>p(x,`${$a[e(S)]??""}（${e(re).length??""} / ${e(H)[e(Z)][e(S)].length??""}枚）`)),s(G,W)}),f(G=>p(I,`${Ka[e(Z)]??""}（${G??""} / ${e(V).length??""}枚）`),[()=>e(V).filter(te).length],he),s(De,de)}),s(C,b)}),s(n,_e),nt()}var Zs=o('<div class="duel_card_info_row svelte-rccxcp" style="position:sticky; top:0;"><div class="svelte-rccxcp"> </div> <div class="svelte-rccxcp"> </div></div>'),Js=o('<div class="duel_card_info_row svelte-rccxcp"><div class="svelte-rccxcp"><pre class="description svelte-rccxcp"> </pre></div></div> <div class="duel_card_info_row svelte-rccxcp" style=" justify-content: space-between;"><div class="svelte-rccxcp"> </div> <div class="svelte-rccxcp"> </div></div>',1),ei=o('<div></div> <div class="svelte-rccxcp"> </div>',1),ti=o("<div> </div>"),ai=o("<div> </div>"),ri=o('<div class="duel_card_info_row svelte-rccxcp"><!> <!></div> <div class="duel_card_info_row svelte-rccxcp"></div>',1),si=o('<div class="duel_card_row svelte-rccxcp"><div class="svelte-rccxcp"></div> <div class="svelte-rccxcp"> </div></div>'),ii=o('<div class="duel_card_row svelte-rccxcp"><div class="svelte-rccxcp"></div> <div class="svelte-rccxcp"> </div></div>'),li=o('<div class="duel_card_info_row svelte-rccxcp"><div class="svelte-rccxcp">※テスト用カードです</div></div>'),oi=o('<div class="duel_card_info_links svelte-rccxcp"><a target="_blank" rel="noopener noreferrer" title="遊戯王カードWiki" class="svelte-rccxcp">⇒遊戯王カードWiki</a> <a target="_blank" rel="noopener noreferrer" title="コナミカードデータベース" class="svelte-rccxcp"> </a></div>'),ni=o('<div><div class="duel_card_info_header svelte-rccxcp"><div class="duel_card_info_row svelte-rccxcp"><div class="svelte-rccxcp"> </div></div> <!></div> <div class="duel_card_info_body svelte-rccxcp"><!> <!> <div class="duel_card_info_row description svelte-rccxcp"><div class="svelte-rccxcp"><pre class="description svelte-rccxcp"> </pre></div></div> <!></div></div>');function vi(n,i){lt(i,!1);let t=Le(i,"cardInfo",8,void 0);const d=()=>t()?ft[t().name]:void 0;ot();var _=Pe(),c=z(_);{var g=v=>{var D=ni(),Y=a(D),h=a(Y),l=a(h),q=a(l),B=r(h,2);{var L=V=>{var be=Zs(),R=a(be),I=a(R),se=r(R,2),ae=a(se);f((fe,G)=>{p(I,fe),p(ae,G)},[()=>"★".repeat(t().level||0),()=>"☆".repeat(t().rank||0)],he),s(V,be)};w(B,V=>{t().kind==="Monster"&&V(L)})}var N=r(Y,2),A=a(N);{var T=V=>{var be=Js(),R=z(be),I=a(R),se=a(I),ae=a(se),fe=r(R,2),G=a(fe),S=a(G),W=r(G,2),re=a(W);f(()=>{p(ae,ft[t().name].pendulumDescription),p(S,`◀ ${t().pendulumScaleL??""}`),p(re,`${t().pendulumScaleR??""} ▶`)}),s(V,be)};w(A,V=>{var be;(be=t().monsterCategories)!=null&&be.includes("Pendulum")&&V(T)})}var te=r(A,2);{var _e=V=>{var be=ri(),R=z(be),I=a(R);{var se=S=>{var W=ei(),re=z(W),$=r(re,2),u=a($);f(()=>{Be(re,`monster_attr ${t().attributes[0]??""} svelte-rccxcp`),p(u,`${Qt[t().attributes[0]]??""}属性`)}),s(S,W)};w(I,S=>{t().attributes&&S(se)})}var ae=r(I,2);{var fe=S=>{var W=ti(),re=a(W);f(()=>{Be(W,`monster_cat ${t().types[0]??""} svelte-rccxcp`),p(re,`${Pt[t().types[0]]??""}${Zt[t().types[0]]??""}族`)}),s(S,W)};w(ae,S=>{t().types&&S(fe)})}var G=r(R,2);ve(G,5,()=>t().monsterCategories??[],ce,(S,W)=>{var re=ai(),$=a(re);f(()=>{Be(re,`monster_cat ${e(W)??""} svelte-rccxcp`),p($,`${It[e(W)]??""}${Jt[e(W)]??""}`)}),s(S,re)}),s(V,be)},qe=V=>{var be=Pe(),R=z(be);{var I=ae=>{var fe=si(),G=r(a(fe),2),S=a(G);f(()=>p(S,`${Ht[t().spellCategory]??""}魔法`)),s(ae,fe)},se=ae=>{var fe=Pe(),G=z(fe);{var S=W=>{var re=ii(),$=r(a(re),2),u=a($);f(()=>p(u,`${Ut[t().trapCategory]??""}罠`)),s(W,re)};w(G,W=>{t().kind==="Trap"&&t().trapCategory&&W(S)},!0)}s(ae,fe)};w(R,ae=>{t().kind==="Spell"&&t().spellCategory?ae(I):ae(se,!1)},!0)}s(V,be)};w(te,V=>{t().kind==="Monster"?V(_e):V(qe,!1)})}var C=r(te,2),b=a(C),H=a(b),ee=a(H),De=r(C,2);{var Z=V=>{var be=li();s(V,be)},de=V=>{var be=oi(),R=a(be),I=r(R,2),se=a(I);f(ae=>{gt(R,"href",`https://yugioh-wiki.net/index.php?${t().wikiEncodedName}`),gt(I,"href",ae),p(se,`⇒${(t().cardId?"公式カードページ":"公式で検索")??""}`)},[()=>Ga(t())],he),s(V,be)};w(De,V=>{t().isForTest?V(Z):V(de,!1)})}f((V,be)=>{Be(D,`duel_card duel_card_info ${t().kind??""} ${V??""} svelte-rccxcp`),p(q,t().name),p(ee,be)},[()=>{var V;return(V=t().monsterCategories)==null?void 0:V.join(" ")},()=>{var V;return(V=d())==null?void 0:V.description}],he),s(v,D)};w(c,v=>{t()&&v(g)})}s(n,_),nt()}const di={0:{aaa:"日",aaaa:"日曜日",ddd:"Sun",dddd:"Sunday"},1:{aaa:"月",aaaa:"月曜日",ddd:"Mon",dddd:"Monday"},2:{aaa:"火",aaaa:"火曜日",ddd:"Tue",dddd:"Tuesday"},3:{aaa:"水",aaaa:"水曜日",ddd:"Wed",dddd:"Wednesday"},4:{aaa:"木",aaaa:"木曜日",ddd:"Thu",dddd:"Thursday"},5:{aaa:"金",aaaa:"金曜日",ddd:"Fri",dddd:"Friday"},6:{aaa:"土",aaaa:"土曜日",ddd:"Sat",dddd:"Saturday"}};class ci{constructor(){Ze(this,"DefaultSeparator1","/");Ze(this,"DefaultSeparator2"," ");Ze(this,"DefaultSeparator3",":");Ze(this,"createDate",i=>{if(!i)return;const t=new Date(i);if(!isNaN(t.getTime()))return t});Ze(this,"createDateOr",(i,t)=>this.createDate(i)||t||new Date);Ze(this,"truncateDate",i=>{const t=i||new Date;return new Date(t.getFullYear(),t.getMonth(),t.getDate())});Ze(this,"addDate",(i,t)=>{const d=this.createDateOr(i);return d.setDate(d.getDate()+t),d});Ze(this,"addMonth",(i,t)=>{const d=this.createDateOr(i);return d.setMonth(d.getMonth()+t),d});Ze(this,"addYear",(i,t)=>{const d=this.createDateOr(i);return d.setFullYear(d.getFullYear()+t),d});Ze(this,"getDayOfWeek",(i,t="dddd")=>{const d=this.createDate(i);return d?di[d.getDay()][t]:""});Ze(this,"formatToYYYYMMDD",(i,t=this.DefaultSeparator1)=>{const d=this.createDate(i);if(!d)return"";const _=d.getFullYear().toString(),c=("0"+(d.getMonth()+1)).slice(-2),g=("0"+d.getDate()).slice(-2);return _+t+c+t+g});Ze(this,"formatToYYYYMM",(i,t=this.DefaultSeparator1)=>{const d=this.createDate(i);if(!d)return"";t||(t="");const _=d.getFullYear().toString(),c=("0"+(d.getMonth()+1)).slice(-2);return _+t+c});Ze(this,"formatToHHMMSS",(i,t=this.DefaultSeparator3)=>{const d=this.createDate(i);if(!d)return"";t||(t="");const _=d.getHours(),c=d.getMinutes(),g=d.getSeconds();return("0"+_).slice(-2)+t+("0"+c).slice(-2)+t+("0"+g).slice(-2)});Ze(this,"formatToHHMM",(i,t=this.DefaultSeparator3)=>{const d=this.createDate(i);if(!d)return"";t||(t="");const _=("0"+d.getHours()).slice(-2),c=("0"+d.getMinutes()).slice(-2);return _+t+c});Ze(this,"formatToYYYYMMDD_HHMM",(i,t=this.DefaultSeparator1,d=this.DefaultSeparator2,_=this.DefaultSeparator3)=>{const c=this.createDate(i);return c?this.formatToYYYYMMDD(c,t)+d+this.formatToHHMM(c,_):""});Ze(this,"formatToYYYYMMDD_HHMMSS",(i,t=this.DefaultSeparator1,d=this.DefaultSeparator2,_=this.DefaultSeparator3)=>{const c=this.createDate(i);return c?this.formatToYYYYMMDD(c,t)+d+this.formatToHHMMSS(c,_):""})}}const vt=new ci;Date.prototype.truncateDate=function(){return vt.truncateDate(this)};Date.prototype.getCloneOr=function(n){return vt.createDateOr(this,n)};Date.prototype.addDate=function(n){return vt.addDate(this,n)};Date.prototype.addMonth=function(n){return vt.addDate(this,n)};Date.prototype.addYear=function(n){return vt.addDate(this,n)};Date.prototype.getDayOfWeek=function(n="dddd"){return vt.getDayOfWeek(this,n)};Date.prototype.formatToYYYYMM=function(n){return vt.formatToYYYYMM(this,n)};Date.prototype.formatToYYYYMMDD=function(n){return vt.formatToYYYYMMDD(this,n)};Date.prototype.formatToYYYYMMDD_HHMM=function(n,i,t){return vt.formatToYYYYMMDD_HHMM(this,n,i,t)};Date.prototype.formatToYYYYMMDD_HHMMSS=function(n,i,t){return vt.formatToYYYYMMDD_HHMMSS(this,n,i,t)};Date.prototype.formatToHHMM=function(n){return vt.formatToHHMM(this,n)};Date.prototype.formatToHHMMSS=function(n){return vt.formatToHHMMSS(this,n)};var _i=o('<li class="deck_info_list_item svelte-2wdgc8"><div class="svelte-2wdgc8"> </div> <div class="svelte-2wdgc8"> </div> <div class="svelte-2wdgc8"> </div></li>'),ui=o('<ul class="deck_info_list svelte-2wdgc8"></ul>'),fi=o('<label for="file_selector" class="upload_area svelte-2wdgc8" role="region" aria-label="ファイルアップロードエリア"><div class="upload_area_message svelte-2wdgc8">ここにファイルをドロップ</div> <div class="upload_area_footer svelte-2wdgc8"><input type="file" id="file_selector" name="file_selector" accept=".json" multiple></div></label>'),pi=o('<div slot="body" class="modal_body svelte-2wdgc8"><!></div>'),gi=o('<button class="svelte-2wdgc8">追加</button> <button class="svelte-2wdgc8">削除して追加</button> <button class="svelte-2wdgc8">戻る</button>',1),mi=o('<button class="svelte-2wdgc8">Cancel</button>'),hi=o('<div slot="footer" class="modal_window_footer svelte-2wdgc8"><!></div>');function bi(n,i){lt(i,!1);let t=Le(i,"eventHolder",8),d=Le(i,"args",8),_=Le(i,"resolve",8),c=Ce(Promise.resolve([])),g=Ce();const v=()=>{y(g,new DataTransfer().files),y(c,Promise.resolve([]))},D=async B=>{B.preventDefault(),console.log("hoge",B)},Y=async B=>{B.preventDefault(),B.dataTransfer&&l(B.dataTransfer.files)},h=()=>{l(e(g))},l=async B=>{if(!B.length)return;const L=[],N=[];for(const A of B)try{N.push(...await _t.createfromJson(A))}catch(T){T instanceof Error&&L.push(T.message)}if(L.length){console.log(...L);return}y(c,e(c).then(()=>N))},q=v;ot(),Xa(n,{get eventHolder(){return t()},get args(){return d()},$$slots:{body:(B,L)=>{var N=pi(),A=a(N);pt(A,()=>e(c),null,(T,te)=>{var _e=Pe(),qe=z(_e);{var C=H=>{var ee=ui();ve(ee,5,()=>e(te),ce,(De,Z)=>{var de=_i(),V=a(de),be=a(V),R=r(V,2),I=a(R),se=r(R,2),ae=a(se);f((fe,G,S)=>{p(be,e(Z).name),p(I,`${fe??""}
                /
                ${G??""}`),p(ae,`最終使用日時 ： ${S??""}`)},[()=>e(Z).cardNames.filter(fe=>d().mainCardNames.includes(fe)).length,()=>e(Z).cardNames.filter(fe=>d().exCardNames.includes(fe)).length,()=>e(Z).lastUsedAt.formatToYYYYMMDD_HHMM("/"," ",":")],he),s(De,de)}),s(H,ee)},b=H=>{var ee=fi(),De=r(a(ee),2),Z=a(De);Va(Z,()=>e(g),de=>y(g,de)),we("change",Z,h),we("cancel",Z,q),we("drop",ee,Y),we("dragover",ee,D),s(H,ee)};w(qe,H=>{e(te).length?H(C):H(b,!1)})}s(T,_e)}),s(B,N)},footer:(B,L)=>{var N=hi(),A=a(N);pt(A,()=>e(c),null,(T,te)=>{var _e=Pe(),qe=z(_e);{var C=H=>{var ee=gi(),De=z(ee),Z=r(De,2),de=r(Z,2);f(()=>{De.disabled=e(te).length===0,Z.disabled=e(te).length===0}),we("click",De,()=>_()({deckInfos:e(te),replaceAll:!1})),we("click",Z,()=>_()({deckInfos:e(te),replaceAll:!0})),we("click",de,q),s(H,ee)},b=H=>{var ee=Pe(),De=z(ee);{var Z=de=>{var V=mi();we("click",V,()=>_()(void 0)),s(de,V)};w(De,de=>{d().cancelable&&de(Z)},!0)}s(H,ee)};w(qe,H=>{e(te).length?H(C):H(b,!1)})}s(T,_e)}),s(B,N)}}}),nt()}const Nt=class Nt extends Za{constructor(i,t){super(i,...Object.values(t))}};Ze(Nt,"createModalController",i=>{const t={deckUploader:new Ja({title:"デッキ情報をアップロード",position:"Middle",cancelable:!1,mainCardNames:[],exCardNames:[]})};return Object.assign(new Nt(i,t),t)});let Xt=Nt;function yi(n,i){lt(i,!1);let t=Le(i,"modalController",8);ot(),Qa(n,{get modalController(){return t()},children:(d,_)=>{var c=Pe(),g=z(c);{var v=D=>{bi(D,{get eventHolder(){return t().eventHolder},get args(){return t().deckUploader.args},get resolve(){return t().deckUploader.resolve}})};w(g,D=>{t().deckUploader.state==="Shown"&&D(v)})}s(d,c)},$$slots:{default:!0}}),nt()}var wi=o('<label><input type="checkbox"> </label>'),ki=o('<label><input type="checkbox"> </label>'),xi=o('<label><input type="checkbox"> <div style="display: inline-block;"></div> </label>'),Ci=o('<label><input type="checkbox"> </label>'),Di=o('<div class="deck_editor_search_box_row svelte-1s1plv5"><div class="svelte-1s1plv5"><button class="search_condition_title black_button svelte-1s1plv5">モンスター</button></div> <div class="svelte-1s1plv5"></div></div> <div class="deck_editor_search_box_row svelte-1s1plv5"><div class="svelte-1s1plv5"><button class="search_condition_title black_button svelte-1s1plv5">属性</button></div> <div class="svelte-1s1plv5"></div></div> <div class="deck_editor_search_box_row svelte-1s1plv5"><div class="svelte-1s1plv5"><button class="search_condition_title black_button svelte-1s1plv5">種族</button></div> <div class="svelte-1s1plv5"></div></div>',1),$i=o('<label><input type="checkbox"> </label>'),Si=o('<div class="deck_editor_search_box_row svelte-1s1plv5"><div class="svelte-1s1plv5"><button class="search_condition_title black_button svelte-1s1plv5">魔法</button></div> <div class="svelte-1s1plv5"></div></div>'),Mi=o('<label><input type="checkbox"> </label>'),Ti=o('<div class="deck_editor_search_box_row svelte-1s1plv5"><div class="svelte-1s1plv5"><button class="search_condition_title black_button svelte-1s1plv5">罠</button></div> <div class="svelte-1s1plv5"></div></div>'),Ei=o('<label><input type="checkbox"> </label>'),qi=o("<option> </option>"),Ai=o('<div class="svelte-1s1plv5"><a class="white_button svelte-1s1plv5" download="SVS_DeckInfos.json">ダウンロード</a></div>'),Yi=o('<div class="svelte-1s1plv5"></div>'),Bi=o('<div class="svelte-1s1plv5"><a class="white_button svelte-1s1plv5" download="SVS_DeckInfos.json">ダウンロード(一括)</a></div>'),Ni=o('<div class="svelte-1s1plv5"></div>'),Pi=o('<div class="deck_editor_body_right_header svelte-1s1plv5"><div class="deck_editor_body_right_header_row svelte-1s1plv5"><div class="svelte-1s1plv5">編集対象 <select></select></div> <div class="svelte-1s1plv5"></div> <div class="svelte-1s1plv5">新規名称 <input type="text"></div></div> <div class="deck_editor_body_right_header_row svelte-1s1plv5"></div> <div class="deck_editor_body_right_header_row svelte-1s1plv5"><div class="svelte-1s1plv5">基本操作</div> <div class="svelte-1s1plv5"><button class="white_button svelte-1s1plv5">デッキを保存</button></div> <div class="svelte-1s1plv5"></div> <div class="svelte-1s1plv5"><button class="white_button svelte-1s1plv5">デッキを複製</button></div> <div class="svelte-1s1plv5"><button class="white_button svelte-1s1plv5" title="shiftキー押下で確認メッセージスキップ">デッキを削除</button></div></div> <div class="deck_editor_body_right_header_row svelte-1s1plv5"><div class="svelte-1s1plv5">DL/UL</div> <!> <!> <div class="svelte-1s1plv5"><button class="white_button svelte-1s1plv5">アップロード</button></div></div></div> <!>',1),Ii=o("<div>デッキ情報読込中</div>"),Hi=o('<div class="deck_editor svelte-1s1plv5"><div class="deck_editor_header"></div> <div class="deck_editor_body svelte-1s1plv5"><div class="deck_editor_body_left svelte-1s1plv5"><div role="contentinfo"><div class="deck_editor_search_box_header svelte-1s1plv5"><div>検索条件</div> <div><button class="white_button svelte-1s1plv5">条件クリア</button></div></div> <div class="deck_editor_search_box_row svelte-1s1plv5"><div class="svelte-1s1plv5">名称</div> <div class="svelte-1s1plv5"><input type="text" style="width:70%"> <button class="white_button svelte-1s1plv5">クリア</button> <span>※ルビには対応していません</span></div></div> <div class="deck_editor_search_box_row svelte-1s1plv5"><div class="svelte-1s1plv5"><button class="search_condition_title black_button svelte-1s1plv5">種類</button></div> <div class="svelte-1s1plv5"></div></div> <!> <!> <!> <div class="deck_editor_search_box_row svelte-1s1plv5"><div class="svelte-1s1plv5"><button class="search_condition_title black_button svelte-1s1plv5">その他</button></div> <div class="svelte-1s1plv5"></div></div></div> <!></div> <div class="deck_editor_body_center svelte-1s1plv5"><!></div> <div class="deck_editor_body_right svelte-1s1plv5"><!></div></div> <div class="footer svelte-1s1plv5"></div></div> <!>',1);function Ui(n,i){lt(i,!1);const t=[],d=[],_=[],c=[],g=[],v=[],D=[],Y=Xt.createModalController({onDragStart:{append:()=>{},remove:()=>{}},onDragEnd:{append:()=>{},remove:()=>{}}}),h={name:"",cardKinds:_a.filter(k=>k!=="XyzMaterial"),monsterCategories:[...ma],monsterAttributes:[...ga],monsterTypes:[...pa],spellCategories:[...fa],trapCategories:[...ua],others:["test"]},l=Ce(structuredClone(h));Oe(l,e(l).others=[]);let q=Ce("SearchCondition");const B=async()=>{Oe(l,e(l).name=""),Oe(l,e(l).cardKinds=[]),Oe(l,e(l).monsterCategories=[]),Oe(l,e(l).monsterAttributes=[]),Oe(l,e(l).monsterTypes=[]),Oe(l,e(l).spellCategories=[]),Oe(l,e(l).trapCategories=[]),Oe(l,e(l).others=[])},L=async k=>{Array.isArray(e(l)[k])&&Array.isArray(h[k])&&Oe(l,e(l)[k]=e(l)[k].length?[]:[...h[k]])},N=(k,M,O)=>{Array.isArray(e(l)[M])&&Array.isArray(h[M])&&Oe(l,e(l)[M]=[O])},A=async()=>{const M=(await e(_e)).find(O=>O.id===e(te));M&&y(b,{...M,cardInfos:M.cardNames.map(O=>ft[O])})},T=()=>_t.getAllDeckInfo().then(k=>(y(te,(k.find(M=>M.lastUsedAt.getTime()===Math.max(...k.map(O=>O.lastUsedAt.getTime())))??k[0]).id),k));let te=Ce(-1),_e=Ce(T()),qe=Ce(e(_e).then(k=>_t.convertToObjectURL(k)));e(_e).then(A);const C=()=>{y(_e,T()),y(qe,e(_e).then(k=>_t.convertToObjectURL(k))),A()};let b=Ce({id:-Number.MAX_VALUE,name:"",description:"",lastUsedAt:new Date,cardInfos:[]}),H=Ce(ft.ゾンビーノ);const ee=k=>{y(q,"CardDetail"),y(H,k)},De=async()=>{const M=(await e(_e)).find(O=>O.id===e(te));if(!M)throw new Error("illegal state");return M},Z=async()=>{const k=await De();await k.saveDeckInfo({...k,name:e(b).name,cardNames:e(b).cardInfos.map(M=>M.name),lastUsedAt:new Date}),C()},de=async()=>{(await _t.createNewDeck(`デッキ_${new Date().formatToYYYYMMDD_HHMMSS("","","")}`,`コピー日時：${new Date().formatToYYYYMMDD_HHMMSS("-"," ",":")}`,e(b).cardInfos.map(M=>M.name))).saveDeckInfo(),C()},V=async k=>{const M=await De();!k.shiftKey&&!confirm(`デッキ【${M.name}】を削除します。
よろしいですか？`)||(await M.delete(),C())},be=async()=>{const k=await Y.deckUploader.show({title:"デッキ情報アップロード",position:"Middle",cancelable:!0,mainCardNames:Object.values(ft).filter(O=>{var ke;return!((ke=O.monsterCategories)!=null&&ke.union(Yt).length)}).map(O=>O.name),exCardNames:Object.values(ft).filter(O=>{var ke;return(ke=O.monsterCategories)==null?void 0:ke.union(Yt).length}).map(O=>O.name)});if(!k)return;const M=[];if(k.replaceAll){if(!confirm(`既存デッキ情報を全て削除し、アップロードしたファイルに置き換えます。
よろしいですか？`))return;M.push(...(await e(_e)).map(O=>O.id))}await Promise.all(k.deckInfos.map(O=>_t.createNewDeck(O.name,O.description,O.cardNames,O.lastUsedAt))),M.length&&await Promise.all(M.map(_t.remove)),C()};ot();var R=Hi(),I=z(R),se=r(a(I),2),ae=a(se),fe=a(ae),G=a(fe),S=r(a(G),2),W=a(S),re=r(G,2),$=r(a(re),2),u=a($),x=r(u,2),P=r(re,2),pe=a(P),K=a(pe),ge=r(pe,2);ve(ge,5,()=>_a.filter(k=>k!=="XyzMaterial"),ce,(k,M)=>{var O=wi(),ke=a(O),Ie,Ue=r(ke);f(()=>{Ie!==(Ie=e(M))&&(ke.value=(ke.__value=e(M))==null?"":e(M)),p(Ue,` ${$a[e(M)]??""}`)}),bt(t,[],ke,()=>(e(M),e(l).cardKinds),F=>Oe(l,e(l).cardKinds=F)),s(k,O)});var U=r(P,2);{var ie=k=>{var M=Di(),O=z(M),ke=a(O),Ie=a(ke),Ue=r(ke,2);ve(Ue,5,()=>ma,ce,(Qe,$e)=>{var je=ki(),Se=a(je),Fe,Ke=r(Se);f(()=>{Fe!==(Fe=e($e))&&(Se.value=(Se.__value=e($e))==null?"":e($e)),p(Ke,` ${It[e($e)]??""}${Jt[e($e)]??""}`)}),bt(d,[],Se,()=>(e($e),e(l).monsterCategories),We=>Oe(l,e(l).monsterCategories=We)),s(Qe,je)});var F=r(O,2),xe=a(F),Ye=a(xe),Re=r(xe,2);ve(Re,5,()=>ga,ce,(Qe,$e)=>{var je=xi(),Se=a(je),Fe,Ke=r(Se,2),We=r(Ke);f(()=>{Fe!==(Fe=e($e))&&(Se.value=(Se.__value=e($e))==null?"":e($e)),Be(Ke,`monster_attr ${e($e)??""} svelte-1s1plv5`),p(We,` ${Qt[e($e)]??""}`)}),bt(_,[],Se,()=>(e($e),e(l).monsterAttributes),dt=>Oe(l,e(l).monsterAttributes=dt)),s(Qe,je)});var He=r(F,2),Xe=a(He),Je=a(Xe),tt=r(Xe,2);ve(tt,5,()=>pa,ce,(Qe,$e)=>{var je=Ci(),Se=a(je),Fe,Ke=r(Se);f(()=>{Fe!==(Fe=e($e))&&(Se.value=(Se.__value=e($e))==null?"":e($e)),p(Ke,` ${Pt[e($e)]??""}
                  ${Zt[e($e)]??""}`)}),bt(c,[],Se,()=>(e($e),e(l).monsterTypes),We=>Oe(l,e(l).monsterTypes=We)),we("dblclick",je,We=>N(We,"monsterTypes",e($e))),s(Qe,je)}),we("click",Ie,()=>L("monsterCategories")),ne(3,O,()=>Me,()=>({delay:0,duration:100})),we("click",Ye,()=>L("monsterAttributes")),ne(3,F,()=>Me,()=>({delay:0,duration:100})),we("click",Je,()=>L("monsterTypes")),ne(3,He,()=>Me,()=>({delay:0,duration:100})),s(k,M)};w(U,k=>{e(l).cardKinds.includes("Monster")&&k(ie)})}var m=r(U,2);{var E=k=>{var M=Si(),O=a(M),ke=a(O),Ie=r(O,2);ve(Ie,5,()=>fa,ce,(Ue,F)=>{var xe=$i(),Ye=a(xe),Re,He=r(Ye);f(()=>{Re!==(Re=e(F))&&(Ye.value=(Ye.__value=e(F))==null?"":e(F)),p(He,` ${Ht[e(F)]??""}`)}),bt(g,[],Ye,()=>(e(F),e(l).spellCategories),Xe=>Oe(l,e(l).spellCategories=Xe)),s(Ue,xe)}),we("click",ke,()=>L("spellCategories")),ne(3,M,()=>Me,()=>({delay:0,duration:100})),s(k,M)};w(m,k=>{e(l).cardKinds.includes("Spell")&&k(E)})}var Q=r(m,2);{var ye=k=>{var M=Ti(),O=a(M),ke=a(O),Ie=r(O,2);ve(Ie,5,()=>ua,ce,(Ue,F)=>{var xe=Mi(),Ye=a(xe),Re,He=r(Ye);f(()=>{Re!==(Re=e(F))&&(Ye.value=(Ye.__value=e(F))==null?"":e(F)),p(He,` ${Ut[e(F)]??""}`)}),bt(v,[],Ye,()=>(e(F),e(l).trapCategories),Xe=>Oe(l,e(l).trapCategories=Xe)),s(Ue,xe)}),we("click",ke,()=>L("trapCategories")),ne(3,M,()=>Me,()=>({delay:0,duration:100})),s(k,M)};w(Q,k=>{e(l).cardKinds.includes("Trap")&&k(ye)})}var ue=r(Q,2),le=a(ue),Te=a(le),oe=r(le,2);ve(oe,4,()=>[{key:"test",text:"テスト用カードを表示する"}],ce,(k,M)=>{var O=Ei(),ke=a(O),Ie,Ue=r(ke);f(()=>{Ie!==(Ie=M.key)&&(ke.value=(ke.__value=M.key)==null?"":M.key),p(Ue,` ${M.text??""}`)}),bt(D,[],ke,()=>(M.key,e(l).others),F=>Oe(l,e(l).others=F)),s(k,O)});var j=r(fe,2);vi(j,{get cardInfo(){return e(H)}});var me=r(ae,2),Ee=a(me);const Ge=he(()=>Object.values(ft));Ca(Ee,{mode:"List",get allCardInfos(){return e(Ge)},onAttention:ee,get searchCondition(){return e(l)},get deckCardInfos(){return e(b).cardInfos},set deckCardInfos(k){Oe(b,e(b).cardInfos=k)},$$legacy:!0});var Ne=r(me,2),X=a(Ne);pt(X,()=>e(_e),k=>{var M=Ii();s(k,M)},(k,M)=>{var O=Pi(),ke=z(O),Ie=a(ke),Ue=a(Ie),F=r(a(Ue));f(()=>{e(te),Tt(()=>{e(M)})}),ve(F,5,()=>e(M),ce,(ze,Ve)=>{var et=qi(),mt={},$t=a(et);f(()=>{mt!==(mt=e(Ve).id)&&(et.value=(et.__value=e(Ve).id)==null?"":e(Ve).id),p($t,e(Ve).name)}),s(ze,et)});var xe=r(Ue,4),Ye=r(a(xe)),Re=r(Ie,4),He=r(a(Re),2),Xe=a(He),Je=r(He,4),tt=a(Je),Qe=r(Je,2),$e=a(Qe),je=r(Re,2),Se=r(a(je),2);pt(Se,De,ze=>{var Ve=Yi();s(ze,Ve)},(ze,Ve)=>{var et=Ai(),mt=a(et);f($t=>gt(mt,"href",$t),[()=>_t.convertToObjectURL([e(Ve)])],he),s(ze,et)});var Fe=r(Se,2);pt(Fe,()=>e(qe),ze=>{var Ve=Ni();s(ze,Ve)},(ze,Ve)=>{var et=Bi(),mt=a(et);f(()=>gt(mt,"href",e(Ve))),s(ze,et)});var Ke=r(Fe,2),We=a(Ke),dt=r(ke,2);Ca(dt,{mode:"Deck",allCardInfos:[],onAttention:ee,get deckCardInfos(){return e(b).cardInfos},set deckCardInfos(ze){Oe(b,e(b).cardInfos=ze)},$$legacy:!0}),Et(F,()=>e(te),ze=>y(te,ze)),we("change",F,A),Kt(Ye,()=>e(b).name,ze=>Oe(b,e(b).name=ze)),we("click",Xe,Z),we("click",tt,de),we("click",$e,V),we("click",We,be),s(k,O)});var J=r(se,2);J.textContent=`実装済カード${er+ha}枚（内、効果のないモンスター${ha??""}枚）`;var Ae=r(I,2);yi(Ae,{modalController:Y}),f(()=>Be(fe,`deck_editor_search_box ${(e(q)==="SearchCondition"?"":"minimum")??""} svelte-1s1plv5`)),we("click",W,B),Kt(u,()=>e(l).name,k=>Oe(l,e(l).name=k)),we("click",x,()=>Oe(l,e(l).name="")),we("click",K,()=>L("cardKinds")),we("click",Te,()=>L("others")),ne(3,ue,()=>Me,()=>({delay:0,duration:100})),we("mouseenter",fe,()=>y(q,"SearchCondition")),s(n,R),nt()}String.prototype.format=(n,...i)=>{for(const[t,d]of i.entries()){const _=new RegExp(`\\{${t}\\}`,"g");n=n.replace(_,d)}return n};String.prototype.toSnakeCase=function(){return this.split(/(?=[A-Z])/).join("_").toLowerCase()};const ji=["TblDeckHeader","TblDeckDetail","TblDuelistProfile"],Fi=3;var Oi=o('<input class="game_mode_radio svelte-1aa1tc6" type="radio" name="game_mode"> <label> </label>',1),Li=o('<option class="svelte-1aa1tc6"> </option>'),Ri=o('<option class="svelte-1aa1tc6"> </option>'),Wi=o('<option class="svelte-1aa1tc6"> </option>'),Ki=o('<option class="svelte-1aa1tc6"> </option>'),zi=o('<tr class="config_row svelte-1aa1tc6"><td class="svelte-1aa1tc6"><div class="svelte-1aa1tc6"><label for="npc_selector" class="config_row_label npc_selector svelte-1aa1tc6">対戦相手：</label></div></td><td class="svelte-1aa1tc6"><div class="svelte-1aa1tc6"><select id="npc_selector" class="npc_selector svelte-1aa1tc6"></select> <div class="svelte-1aa1tc6"> </div></div></td></tr> <tr class="config_row svelte-1aa1tc6"><td class="svelte-1aa1tc6"><div class="svelte-1aa1tc6"><label for="npc_deck_selector" class="config_row_label deck_selector svelte-1aa1tc6">デッキ：</label></div></td><td class="svelte-1aa1tc6"><div class="svelte-1aa1tc6"><select id="npc_deck_selector" class="deck_selector svelte-1aa1tc6"><option class="svelte-1aa1tc6">デフォルト</option><!></select></div></td></tr> <tr class="config_row svelte-1aa1tc6"><td class="svelte-1aa1tc6"><div class="svelte-1aa1tc6"><label for="npc_selector" class="config_row_label npc_selector svelte-1aa1tc6">先攻後攻：</label></div></td><td class="svelte-1aa1tc6"><div class="svelte-1aa1tc6"><select id="npc_selector" class="npc_selector svelte-1aa1tc6"></select></div></td></tr>',1),Gi=o('<tr class="config_row svelte-1aa1tc6"><td class="svelte-1aa1tc6"><div class="svelte-1aa1tc6"><label class="config_row_label svelte-1aa1tc6" for="game_mode_radio_preset">ゲームモード：</label></div></td><td class="svelte-1aa1tc6"><div class="svelte-1aa1tc6"></div></td></tr> <tr class="config_row svelte-1aa1tc6"><td class="svelte-1aa1tc6"><div class="svelte-1aa1tc6"><label for="deck_selector" class="config_row_label deck_selector svelte-1aa1tc6">デッキ：</label></div></td><td class="svelte-1aa1tc6"><div class="svelte-1aa1tc6"><select id="deck_selector" class="deck_selector svelte-1aa1tc6"></select></div></td></tr> <!> <tr><td colspan="2" class="svelte-1aa1tc6"><div><button class="btn svelte-1aa1tc6">duel start!</button></div></td></tr>',1),Xi=o('<tr><td colspan="2" class="svelte-1aa1tc6"><div>デッキ情報の読み込み、もしくは作成中...</div></td></tr>'),Vi=o('<tr><td colspan="2" class="svelte-1aa1tc6"><div><button class="btn svelte-1aa1tc6">deck edit</button></div></td></tr>'),Qi=o('<tr class="config_row svelte-1aa1tc6"><td class="svelte-1aa1tc6"><div class="svelte-1aa1tc6"><label for="duelist_name" class="config_row_label duelist_name svelte-1aa1tc6">名前：</label></div></td><td class="svelte-1aa1tc6"><div class="svelte-1aa1tc6"><input id="duelist_name" class="duelist_name svelte-1aa1tc6" type="text"></div></td></tr> <!> <!>',1),Zi=o('<tr><td colspan="2" class="svelte-1aa1tc6"><div>デュエリスト情報の読み込み、もしくは作成中...</div></td></tr>'),Ji=o('<div class="app_body svelte-1aa1tc6"><table class="config_table svelte-1aa1tc6"><tbody><!></tbody></table></div>'),el=o('<div class="result_title result_win svelte-1aa1tc6">YOU WIN</div>'),tl=o('<div class="result_title result_lose svelte-1aa1tc6">YOU LOSE</div>'),al=o('<div class="result_title result_draw svelte-1aa1tc6">DRAW</div>'),rl=o('<div class="result svelte-1aa1tc6"><!> <div class="reason_of_end svelte-1aa1tc6"> </div> <button class="white_button svelte-1aa1tc6">TOPへ戻る</button></div>'),sl=o('<main style="flex-direction: column; display :flex" class="svelte-1aa1tc6"><div class="link link_left svelte-1aa1tc6"><a href="https://github.com/Setta238/stk_ygo_svelte" target="_blank" rel="noopener noreferrer" title="repository" class="svelte-1aa1tc6">repository</a> <a href="https://x.com/ninja_no" target="_blank" rel="noopener noreferrer" title="repository" class="svelte-1aa1tc6">X(Twitter)</a> <a href="https://posfie.com/@ninja_no/p/Lx7FLj3" target="_blank" rel="noopener noreferrer" title="posfie" class="svelte-1aa1tc6">posfie(toggeter)</a></div> <div class="link link_right svelte-1aa1tc6"><a class="a_button svelte-1aa1tc6" role="button" tabindex="0">TOPへ戻る</a> <a href="/stk_ygo_svelte/note.html" target="_blank" rel="noopener noreferrer" title="repository" class="svelte-1aa1tc6">現時点とこの先のこと</a></div> <!> <div class="debug_info svelte-1aa1tc6"><span class="svelte-1aa1tc6"> </span> <span class="user_agent_info svelte-1aa1tc6"> </span> <span class="screen_info svelte-1aa1tc6"> </span></div> <!></main>');function il(n,i){lt(i,!1);const t=new tr("stk_ygo_svelte",Fi,ji);let d=Ce(0),_=Ce(0),c=Ce(),g=Ce("Preset"),v=Ce("None"),D=Ce(0),Y=Ce("");const h=ar.getOrCreateNew(t).then($=>{var u;return y(g,$.previousGameMode??"Preset"),y(Y,((u=Ct.find(x=>x.id===$.previousNpcId))==null?void 0:u.description)??""),$}),l=$=>{var x;const u=$.find(P=>P.lastUsedAt.getTime()===Math.max(...$.map(pe=>pe.lastUsedAt.getTime())))??$[0];y(D,u.id),e(g)==="Preset"&&u.deckType!=="Preset"&&y(D,((x=yt.find(P=>P.deckType==="Preset"))==null?void 0:x.id)??e(D))};let q=Ce(_t.getAllDeckInfo(t).then($=>(Promise.all($.filter(u=>!u.lastUsedAt).map(u=>{u.saveDeckInfo()})),l($),$)));const B=async()=>{let $=(await e(q)).find(x=>x.id===e(D))??(await N()).find(x=>x.id===e(D));$&&await $.updateTimestamp();let u=$;if(u||(u=yt.find(x=>x.id===e(D))),!u)throw new Error("illegal state");return u},L=async()=>{(await h).save({previousGameMode:e(g)})},N=()=>(y(q,_t.getAllDeckInfo(t).then($=>(l($),$))),e(q)),A=async()=>{(await e(q)).length||(await _t.prepareSampleDeck(),N())},T=async()=>{await Promise.all([L(),A()]);const $=await B(),u=await h;let x=Ct.find(K=>K.id===Number.MIN_SAFE_INTEGER)??Ct[0],P=yt.find(K=>K.id===Number.MIN_SAFE_INTEGER)??yt[0],pe="PlayFirst";e(g)==="Free"&&(x=Ct.find(K=>K.id===u.previousNpcId)??x,P=yt.slice(-1)[0],pe=u.previousStartMode,u.previousNpcDeckId>-1?P=(await e(q)).find(K=>K.id===u.previousNpcDeckId)??P:P=yt.find(K=>K.id===x.id)??P),y(c,new sr(u,"Player",$,[],x,"NPC",P,[],pe)),e(c).onDuelEnd.append(()=>(y(c,e(c)),"RemoveMe"))},te=async()=>{await Promise.all([L(),A()]),y(v,"DeckEdit")},_e=async $=>{await L(),$.key==="Enter"&&!$.repeat&&(await h).save()},qe=()=>{y(q,N()),y(c,void 0),y(v,"None")};let C=Date.now();const b=$=>{Date.now()-C<200||(C=Date.now(),y(g,$),N())},H=$=>{var u;y(Y,((u=Ct.find(x=>x.id===Number($.currentTarget.value)))==null?void 0:u.description)??"")};A(),ot();var ee=sl(),De=r(a(ee),2),Z=a(De),de=r(De,2);{var V=$=>{var u=Pe(),x=z(u);pt(x,()=>h,null,(P,pe)=>{Fs(P,{get duel(){return e(c)},get userProfile(){return e(pe)}})}),s($,u)},be=$=>{var u=Pe(),x=z(u);{var P=K=>{Ui(K,{})},pe=K=>{var ge=Ji(),U=a(ge),ie=a(U),m=a(ie);pt(m,()=>h,E=>{var Q=Zi();s(E,Q)},(E,Q)=>{var ye=Qi(),ue=z(ye),le=a(ue),Te=a(le),oe=r(le),j=a(oe),me=a(j),Ee=r(ue,2);pt(Ee,()=>e(q),X=>{var J=Xi();s(X,J)},(X,J)=>{var Ae=Gi(),k=z(Ae),M=a(k),O=a(M),ke=r(M),Ie=a(ke);ve(Ie,4,()=>["Preset","Free"],ce,(Se,Fe)=>{var Ke=Oi(),We=z(Ke),dt=r(We,2),ze=a(dt);f(Ve=>{gt(We,"id",`game_mode_radio_${Ve??""}`),ir(We,Fe),lr(We,e(g)===Fe),Be(dt,`game_mode_tab_label game_mode_tab_${Ve??""} svelte-1aa1tc6`),gt(dt,"for",`game_mode_radio_${Ve??""}`),p(ze,Fe)},[()=>Fe.toLowerCase()],he),we("change",We,()=>b(Fe)),s(Se,Ke)});var Ue=r(k,2),F=a(Ue),xe=a(F),Ye=r(F),Re=a(Ye),He=a(Re);f(()=>{e(D),Tt(()=>{e(g),e(J)})}),ve(He,5,()=>e(g)==="Preset"?yt.filter(Se=>Se.deckType==="Preset"):e(J),ce,(Se,Fe)=>{var Ke=Li(),We={},dt=a(Ke);f(()=>{We!==(We=e(Fe).id)&&(Ke.value=(Ke.__value=e(Fe).id)==null?"":e(Fe).id),p(dt,e(Fe).name)}),s(Se,Ke)});var Xe=r(Ue,2);{var Je=Se=>{var Fe=zi(),Ke=z(Fe),We=a(Ke),dt=a(We),ze=r(We),Ve=a(ze),et=a(Ve);f(()=>{e(Q),Tt(()=>{})}),ve(et,5,()=>Ct,ce,(ct,at)=>{var rt=Ri(),ht={},St=a(rt);f(()=>{ht!==(ht=e(at).id)&&(rt.value=(rt.__value=e(at).id)==null?"":e(at).id),p(St,e(at).name)}),s(ct,rt)});var mt=r(et,2),$t=a(mt),jt=r(Ke,2),Ft=a(jt),Sa=a(Ft),aa=r(Ft),ra=a(aa),sa=a(ra);f(()=>{e(Q),Tt(()=>{e(J)})});var Ot=a(sa);Ot.value=(Ot.__value=Number.MIN_SAFE_INTEGER)==null?"":Number.MIN_SAFE_INTEGER;var Ma=r(Ot);ve(Ma,1,()=>e(J),ce,(ct,at)=>{var rt=Wi(),ht={},St=a(rt);f(()=>{ht!==(ht=e(at).id)&&(rt.value=(rt.__value=e(at).id)==null?"":e(at).id),p(St,e(at).name)}),s(ct,rt)});var ia=r(jt,2),Lt=a(ia),Ta=a(Lt),la=r(Lt),oa=a(la),na=a(oa);f(()=>{e(Q),Tt(()=>{})}),ve(na,5,()=>Vt(ba),ce,(ct,at)=>{var rt=Ki(),ht={},St=a(rt);f(()=>{ht!==(ht=e(at))&&(rt.value=(rt.__value=e(at))==null?"":e(at)),p(St,ba[e(at)])}),s(ct,rt)}),f(()=>p($t,`※${e(Y)??""}`)),ne(3,dt,()=>Me,()=>({duration:200})),ne(3,We,()=>Me,()=>({duration:200})),we("change",et,H),Et(et,()=>e(Q).previousNpcId,ct=>e(Q).previousNpcId=ct),ne(3,Ve,()=>Me,()=>({duration:200})),ne(3,ze,()=>Me,()=>({duration:200})),ne(3,Ke,()=>Me,()=>({duration:200})),ne(3,Sa,()=>Me,()=>({duration:200})),ne(3,Ft,()=>Me,()=>({duration:200})),Et(sa,()=>e(Q).previousNpcDeckId,ct=>e(Q).previousNpcDeckId=ct),ne(3,ra,()=>Me,()=>({duration:200})),ne(3,aa,()=>Me,()=>({duration:200})),ne(3,jt,()=>Me,()=>({duration:200})),ne(3,Ta,()=>Me,()=>({duration:200})),ne(3,Lt,()=>Me,()=>({duration:200})),Et(na,()=>e(Q).previousStartMode,ct=>e(Q).previousStartMode=ct),ne(3,oa,()=>Me,()=>({duration:200})),ne(3,la,()=>Me,()=>({duration:200})),ne(3,ia,()=>Me,()=>({duration:200})),s(Se,Fe)};w(Xe,Se=>{e(g)==="Free"&&Se(Je)})}var tt=r(Xe,2),Qe=a(tt),$e=a(Qe),je=a($e);ne(3,O,()=>Me,()=>({duration:200})),ne(3,M,()=>Me,()=>({duration:200})),ne(3,Ie,()=>Me,()=>({duration:200})),ne(3,ke,()=>Me,()=>({duration:200})),ne(3,k,()=>Me,()=>({duration:200})),ne(3,xe,()=>Me,()=>({duration:200})),ne(3,F,()=>Me,()=>({duration:200})),Et(He,()=>e(D),Se=>y(D,Se)),ne(3,Re,()=>Me,()=>({duration:200})),ne(3,Ye,()=>Me,()=>({duration:200})),ne(3,Ue,()=>Me,()=>({duration:200})),we("click",je,T),ne(3,$e,()=>Me,()=>({duration:200})),s(X,Ae)});var Ge=r(Ee,2);{var Ne=X=>{var J=Vi(),Ae=a(J),k=a(Ae),M=a(k);we("click",M,te),ne(3,k,()=>Me,()=>({duration:200})),ne(3,Ae,()=>Me,()=>({duration:200})),ne(3,J,()=>Me,()=>({duration:200})),s(X,J)};w(Ge,X=>{e(g)==="Free"&&X(Ne)})}ne(3,Te,()=>Me,()=>({duration:200})),ne(3,le,()=>Me,()=>({duration:200})),Kt(me,()=>e(Q).name,X=>e(Q).name=X),we("keypress",me,_e),ne(3,j,()=>Me,()=>({duration:200})),ne(3,oe,()=>Me,()=>({duration:200})),ne(3,ue,()=>Me,()=>({duration:200})),s(E,ye)}),s(K,ge)};w(x,K=>{e(v)==="DeckEdit"?K(P):K(pe,!1)},!0)}s($,u)};w(de,$=>{e(c)?$(V):$(be,!1)})}var R=r(de,2),I=a(R),se=a(I),ae=r(I,2),fe=a(ae),G=r(ae,2),S=a(G),W=r(R,2);{var re=$=>{var u=rl(),x=a(u);{var P=ie=>{var m=Pe(),E=z(m);{var Q=ue=>{var le=el();s(ue,le)},ye=ue=>{var le=Pe(),Te=z(le);{var oe=j=>{var me=tl();s(j,me)};w(Te,j=>{e(c).winner.seat==="Above"&&j(oe)},!0)}s(ue,le)};w(E,ue=>{e(c).winner.seat==="Below"?ue(Q):ue(ye,!1)})}s(ie,m)},pe=ie=>{var m=al();s(ie,m)};w(x,ie=>{e(c).winner?ie(P):ie(pe,!1)})}var K=r(x,2),ge=a(K),U=r(K,2);f(()=>p(ge,e(c).reasonOfEnd)),we("click",U,qe),ne(3,u,()=>vr,()=>({delay:200,duration:200})),s($,u)};w(W,$=>{e(c)&&e(c).isEnded&&$(re)})}f(()=>{p(se,"build at: 20250601_192916"),p(fe,rr.text),p(S,`w:${e(d)??""}px h:${e(_)??""}px`)}),At("innerWidth",$=>y(d,$)),At("innerHeight",$=>y(_,$)),we("click",Z,qe),s(n,ee),nt()}or(il,{target:document.getElementById("app")});
