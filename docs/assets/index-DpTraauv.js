var Ha=Object.defineProperty;var ha=o=>{throw TypeError(o)};var Pa=(o,i,t)=>i in o?Ha(o,i,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[i]=t;var Ze=(o,i,t)=>Pa(o,typeof i!="symbol"?i+"":i,t),ya=(o,i,t)=>i.has(o)||ha("Cannot "+t);var at=(o,i,t)=>(ya(o,i,"read from private field"),t?t.call(o):i.get(o)),Ut=(o,i,t)=>i.has(o)?ha("Cannot add the same private member more than once"):i instanceof WeakSet?i.add(o):i.set(o,t),aa=(o,i,t,v)=>(ya(o,i,"write to private field"),v?v.call(o,t):i.set(o,t),t);import{s as ka,r as Oa,a as D,b as La,l as Ra,g as e,d as Na,p as st,c as Le,m as we,i as it,t as n,e as a,f as y,h as u,j as ce,k as Ae,n as pt,o as ke,q as r,u as nt,v as Oe,S as Wa,w as Me,x as H,y as s,z as ie,D as St,A as ee,B as oe,C as f,E as Ka,F as rt,G as oa,H as za,I as Ga,J as Xa,K as Mt,L as bt,M as va,N as Vt,O as da,P as Qt,Q as ca,R as Zt,T as Jt,U as Va,V as Qa,W as Za,X as Ja,Y as er,Z as tr,_ as ar,$ as Kt,a0 as ht,a1 as zt,a2 as ra,a3 as Ia,a4 as rr,a5 as sr,a6 as ir,a7 as nr,a8 as lr,a9 as ft,aa as or,ab as vr,ac as dr,ad as wa,ae as xa,af as Ca,ag as Da,ah as $a,ai as Sa,aj as At,ak as Yt,al as sa,am as Ma,an as cr,ao as Dt,ap as _r,aq as ur,ar as Ta,as as qt,at as $t,au as fr,av as pr,aw as gr,ax as mr,ay as ja,az as br,aA as hr}from"../chunk/entity_proc_20251130_215506.js";import"../chunk/json_20251130_215506.js";(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const _ of document.querySelectorAll('link[rel="modulepreload"]'))v(_);new MutationObserver(_=>{for(const c of _)if(c.type==="childList")for(const b of c.addedNodes)b.tagName==="LINK"&&b.rel==="modulepreload"&&v(b)}).observe(document,{childList:!0,subtree:!0});function t(_){const c={};return _.integrity&&(c.integrity=_.integrity),_.referrerPolicy&&(c.referrerPolicy=_.referrerPolicy),_.crossOrigin==="use-credentials"?c.credentials="include":_.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function v(_){if(_.ep)return;_.ep=!0;const c=t(_);fetch(_.href,c)}})();const yr=o=>o;function _a(o){const i=o-1;return i*i*i+1}function Ea(o){const i=typeof o=="string"&&o.match(/^\s*(-?[\d.]+)([^\s]*)\s*$/);return i?[parseFloat(i[1]),i[2]||"px"]:[o,"px"]}function kr(o,{delay:i=0,duration:t=400,easing:v=yr}={}){const _=+getComputedStyle(o).opacity;return{delay:i,duration:t,easing:v,css:c=>`opacity: ${c*_}`}}function wr(o,{delay:i=0,duration:t=400,easing:v=_a,x:_=0,y:c=0,opacity:b=0}={}){const d=getComputedStyle(o),q=+d.opacity,P=d.transform==="none"?"":d.transform,w=q*(1-b),[l,L]=Ea(_),[I,R]=Ea(c);return{delay:i,duration:t,easing:v,css:(W,A)=>`
			transform: ${P} translate(${(1-W)*l}${L}, ${(1-W)*I}${R});
			opacity: ${q-w*A}`}}function fe(o,{delay:i=0,duration:t=400,easing:v=_a,axis:_="y"}={}){const c=getComputedStyle(o),b=+c.opacity,d=_==="y"?"height":"width",q=parseFloat(c[d]),P=_==="y"?["top","bottom"]:["left","right"],w=P.map(Y=>`${Y[0].toUpperCase()}${Y.slice(1)}`),l=parseFloat(c[`padding${w[0]}`]),L=parseFloat(c[`padding${w[1]}`]),I=parseFloat(c[`margin${w[0]}`]),R=parseFloat(c[`margin${w[1]}`]),W=parseFloat(c[`border${w[0]}Width`]),A=parseFloat(c[`border${w[1]}Width`]);return{delay:i,duration:t,easing:v,css:Y=>`overflow: hidden;opacity: ${Math.min(Y*20,1)*b};${d}: ${Y*q}px;padding-${P[0]}: ${Y*l}px;padding-${P[1]}: ${Y*L}px;margin-${P[0]}: ${Y*I}px;margin-${P[1]}: ${Y*R}px;border-${P[0]}-width: ${Y*W}px;border-${P[1]}-width: ${Y*A}px;min-${d}: 0`}}function qa(o,i){for(const t in i)o[t]=i[t];return o}function xr({fallback:o,...i}){const t=new Map,v=new Map;function _(b,d,q){const{delay:P=0,duration:w=k=>Math.sqrt(k)*30,easing:l=_a}=qa(qa({},i),q),L=b.getBoundingClientRect(),I=d.getBoundingClientRect(),R=L.left-I.left,W=L.top-I.top,A=L.width/I.width,Y=L.height/I.height,te=Math.sqrt(R*R+W*W),ne=getComputedStyle(d),Te=ne.transform==="none"?"":ne.transform,j=+ne.opacity;return{delay:P,duration:typeof w=="function"?w(te):w,easing:l,css:(k,K)=>`
			   opacity: ${k*j};
			   transform-origin: top left;
			   transform: ${Te} translate(${K*R}px,${K*W}px) scale(${k+(1-k)*A}, ${k+(1-k)*Y});
		   `}}function c(b,d,q){return(P,w)=>(b.set(w.key,P),()=>{if(d.has(w.key)){const l=d.get(w.key);return d.delete(w.key),_(l,P,w)}return b.delete(w.key),o&&o(P,w,q)})}return[c(v,t,!1),c(t,v,!0)]}function Aa(o){return Object.prototype.toString.call(o)==="[object Date]"}function Cr(o){return o}function ia(o){const i=o-1;return i*i*i+1}function na(o,i){if(o===i||o!==o)return()=>o;const t=typeof o;if(t!==typeof i||Array.isArray(o)!==Array.isArray(i))throw new Error("Cannot interpolate values of different type");if(Array.isArray(o)){const v=i.map((_,c)=>na(o[c],_));return _=>v.map(c=>c(_))}if(t==="object"){if(!o||!i)throw new Error("Object cannot be null");if(Aa(o)&&Aa(i)){const c=o.getTime(),d=i.getTime()-c;return q=>new Date(c+q*d)}const v=Object.keys(i),_={};return v.forEach(c=>{_[c]=na(o[c],i[c])}),c=>{const b={};return v.forEach(d=>{b[d]=_[d](c)}),b}}if(t==="number"){const v=i-o;return _=>o+_*v}return()=>i}var mt,Bt,Ft,Tt;const ua=class ua{constructor(i,t={}){Ut(this,mt,ka(void 0));Ut(this,Bt,ka(void 0));Ut(this,Ft);Ut(this,Tt,null);at(this,mt).v=at(this,Bt).v=i,aa(this,Ft,t)}static of(i,t){const v=new ua(i(),t);return Oa(()=>{v.set(i())}),v}set(i,t){var l;D(at(this,Bt),i);let{delay:v=0,duration:_=400,easing:c=Cr,interpolate:b=na}={...at(this,Ft),...t};if(_===0)return(l=at(this,Tt))==null||l.abort(),D(at(this,mt),i),Promise.resolve();const d=La.now()+v;let q,P=!1,w=at(this,Tt);return aa(this,Tt,Ra(L=>{if(L<d)return!0;if(!P){P=!0;const R=at(this,mt).v;q=b(R,i),typeof _=="function"&&(_=_(R,i)),w==null||w.abort()}const I=L-d;return I>_?(D(at(this,mt),i),!1):(D(at(this,mt),q(c(I/_))),!0)})),at(this,Tt).promise}get current(){return e(at(this,mt))}get target(){return e(at(this,Bt))}set target(i){this.set(i)}};mt=new WeakMap,Bt=new WeakMap,Ft=new WeakMap,Tt=new WeakMap;let Gt=ua;var Dr=n('<div class="phase_display svelte-1ycsdg6"><span class="svelte-1ycsdg6"> </span> </div>'),$r=n('<div class="lifepoint_display svelte-1ycsdg6"><div class="svelte-1ycsdg6"> </div> <div class="svelte-1ycsdg6"> </div></div>'),Sr=(o,i,t)=>i(e(t)),Mr=n('<div class="svelte-1ycsdg6"><button class="phase_button svelte-1ycsdg6"> </button></div>'),Tr=n("<div><!></div>"),jr=n('<div class="svelte-1ycsdg6"><!></div>'),Er=n("<div><!></div>"),qr=n('<div class="config_button_wrapper svelte-1ycsdg6"><button id="config_button" class="svelte-1ycsdg6">⚙</button></div>'),Ar=n("<!> <!> <!> <!>",1),Yr=n('<div style="position: absolute;" class="card_animation_receiver svelte-1ycsdg6"><!></div>'),Br=n('<div style="position: absolute; top:0rem" class="svelte-1ycsdg6">｛効果対象｝</div>'),Nr=n('<!> <div style="position: absolute; display:flex;justify-content: center;"><!></div>',1),Ir=n(" <!> 】",1),Ur=n('<div style="position: absolute; bottom:0rem" class="svelte-1ycsdg6"> <!></div>'),Fr=n("<!> <!>",1),Hr=n('<div class="badge svelte-1ycsdg6"> </div>'),Pr=n('<div class="card_animation_receiver svelte-1ycsdg6"><!></div>'),Or=n("<!> <!> <!> <!>",1),Lr=n('<td><div role="listitem"><!></div></td>');function Rr(o,i){st(i,!1);let t=Le(i,"view",12),v=Le(i,"row",8),_=Le(i,"column",8),c=Le(i,"selectedEntities",28,()=>[]),b=Le(i,"selectedCells",28,()=>[]),d=we(t().getCell(v(),_())),q=we(new Gt(e(d).field.duel.duelists.Above.lp,{duration:400,easing:ia})),P=we(new Gt(e(d).field.duel.duelists.Below.lp,{duration:400,easing:ia}));const w=()=>{D(d,t().getCell(v(),_())),Oe(q,e(q).target=e(d).field.duel.duelists.Above.lp),Oe(P,e(P).target=e(d).field.duel.duelists.Below.lp)};e(d).onUpdate.append(w),t().onDuelUpdate.append(w),t().modalController.onUpdate.append(w);let l,L=we([]),I=()=>console.log("hoge"),R,W=we([]),A=we(!1),Y=we(!1),te=!1;const ne=S=>{var le,de;D(_e,[]),c().reset(),l=S.activator,I=S.resolve,D(L,S.dummyActionInfos),D(W,S.chainBlockInfos.flatMap(se=>se.selectedEntities).getDistinct()),R=S.entitiesChoices,D(A,!1),D(Y,((le=S.cellsChoices)==null?void 0:le.selectables.includes(e(d)))??!1),te=e(Y)&&((de=S.cellsChoices)==null?void 0:de.qty)===1,w()};t().onWaitStart.append(ne);const Te=()=>{l=void 0,D(L,[]),I=()=>{console.log("hoge")},R=void 0,D(W,[]),D(A,!1),D(Y,!1),te=!1};t().onWaitEnd.append(Te);let j=we(!1),k=[];const K=S=>{k=S.filter(le=>le.dests.includes(e(d))),D(j,k.length>0),w()},ae=()=>{k=[],D(j,!1),w()};t().onDragStart.append(K),t().onDragEnd.append(ae);const[xe,Z]=Ks;let _e=we([]);const V=S=>{if(l=void 0,e(d)===S.to||e(d).entities.includes(S.entity)){D(_e,[...e(_e),S]);const le=S.resolve;D(d,e(d)),setTimeout(()=>{D(_e,e(_e).filter(de=>de!==S)),S.count++,S.count>1&&le()},600)}};t().onAnimation.append(V);const pe=S=>{I({phaseChange:S})},X=()=>e(d).isStackCell&&e(d).entities.flatMap(S=>S.actions).filter(S=>e(L).map(le=>le.action.seq).some(le=>le===S.seq)).length>0,z=S=>{var le;if(((le=S.target)==null?void 0:le.id)==="config_button"){t(t().infoBoardState="Config",!0),t().requireUpdate();return}if(t(t().infoBoardState="Default",!0),te)I({selectedCells:[e(d)]});else if(e(Y))D(A,!e(A)),b(e(A)?[...b(),e(d)]:b().filter(de=>de!==e(d)));else if(e(d).isStackCell){t(t().infoBoardState="CellInfo",!0),t(t().infoBoardCell=e(d),!0),t().requireUpdate();const de=e(d).entities.flatMap(p=>p.actions).map(p=>p.seq),se=e(L).filter(p=>de.includes(p.action.seq));if(se.length){if(!l)return;t().modalController.actionSelector.show({title:"カードを選択。",position:"Bottom",activator:l,dummyActionInfos:se,cancelable:!0}).then(p=>{p&&I({actionInfo:p})});return}}t().requireUpdate(),console.info(e(d),be(...e(d).visibleEntities))},re=S=>{S.preventDefault(),S.dataTransfer&&(S.dataTransfer.dropEffect="move")},ve=S=>{S.preventDefault(),console.info("drop",S,e(j),k),S.dataTransfer&&(S.dataTransfer.dropEffect="move");try{if(e(j)&&k){if(k.length===1){const le=k[0];I({actionInfo:{...le,dest:e(d)}})}else if(k.length>1){if(!l)throw new Wa("想定されない状態");e(d).field.duel.view.modalController.terminateAll(),e(d).field.duel.view.modalController.actionSelector.show({title:"選択",position:"Bottom",activator:l,dummyActionInfos:k.map(le=>({...le,dest:e(d)})),cancelable:!1}).then(le=>{I({actionInfo:le})})}}}finally{t().removeDraggingActions()}},be=(...S)=>{if(t().waitMode==="Animation")return"Disabled";if(R&&R.selectables.find(de=>S.find(se=>de===se)))return"Selectable";if(!e(L)||e(L).length===0||t().waitMode!=="Free"||Object.values(t().modalController.modals).some(de=>de.state==="Shown"))return"Disabled";const le=e(L).filter(de=>S.includes(de.action.entity));return le.length===0?"Disabled":e(d).isStackCell||le[0].action.entity!==S[0]?"Clickable":le.some(de=>de.dests.length)?"Draggable":"Clickable"};it();var U=Lr(),M=a(U);M.__click=z;var G=a(M);{var J=S=>{var le=Me(),de=H(le);{var se=p=>{var T=Me(),x=H(T);{var F=g=>{var Q=Dr(),he=a(Q),Se=a(he),ge=s(he,1,!0);u((ue,$)=>{f(Se,ue),f(ge,$)},[()=>String(e(d).field.duel.clock.turn).padStart(2,"0"),()=>e(d).field.duel.phase.toUpperCase()],ce),r(g,Q)},h=g=>{var Q=Me(),he=H(Q);{var Se=ue=>{var $=$r(),N=a($),ye=a(N),$e=s(N,2),Re=a($e);u((Ye,Be)=>{f(ye,Ye),f(Re,Be)},[()=>Math.floor(e(q).current),()=>Math.floor(e(P).current)],ce),r(ue,$)},ge=ue=>{var $=Me(),N=H($);{var ye=$e=>{var Re=Me(),Ye=H(Re);{var Be=Ie=>{var ze=Me(),E=H(ze);{var C=m=>{var B=Me(),me=H(B);ie(me,1,()=>t().duel.nextPhaseList,oe,(je,O)=>{var Ce=Mr(),Ne=a(Ce);Ne.__click=[Sr,pe,O];var We=a(Ne);u(Ue=>f(We,Ue),[()=>e(O).toUpperCase()],ce),r(je,Ce)}),r(m,B)};y(E,m=>{t().duel.isEnded||m(C)})}r(Ie,ze)};y(Ye,Ie=>{t().waitMode==="Free"&&Ie(Be)})}r($e,Re)};y(N,$e=>{e(d).column===5&&$e(ye)},!0)}r(ue,$)};y(he,ue=>{e(d).column===3?ue(Se):ue(ge,!1)},!0)}r(g,Q)};y(x,g=>{e(d).column===1?g(F):g(h,!1)})}r(p,T)};y(de,p=>{e(d).row===3&&p(se)})}r(S,le)},Ee=S=>{var le=Me(),de=H(le);{var se=T=>{var x=Ar();const F=ce(()=>e(_e).find($=>$.to===e(d)));var h=H(x);{var g=$=>{var N=Tr(),ye=a(N);St(ye,{get entity(){return e(F).entity},state:"Disabled",dummyActionInfos:[],cardActionResolve:void 0}),u(()=>Ae(N,`card_animation_receiver ${e(d).cellType??""} svelte-1ycsdg6`)),ee(1,N,()=>Z,()=>({key:e(F).entity.seq})),r($,N)};y(h,$=>{e(F)&&e(F).index==="Top"&&$(g)})}var Q=s(h,2);ie(Q,1,()=>e(d).visibleEntities,oe,($,N)=>{var ye=Me(),$e=H(ye);{var Re=Ye=>{var Be=jr(),Ie=a(Be);const ze=ce(()=>be(e(N))),E=ce(()=>e(L).filter(C=>C.action.entity===e(N)));St(Ie,{get entity(){return e(N)},get state(){return e(ze)},get dummyActionInfos(){return e(E)},cardActionResolve:void 0,get selectedList(){return c()},set selectedList(C){c(C)},$$legacy:!0}),ee(2,Be,()=>xe,()=>({key:e(N).seq})),r(Ye,Be)};y($e,Ye=>{e(_e).every(Be=>Be.entity.seq!==e(N).seq)&&Ye(Re)})}r($,ye)});var he=s(Q,2);{var Se=$=>{var N=Er(),ye=a(N);St(ye,{get entity(){return e(F).entity},state:"Disabled",dummyActionInfos:[],cardActionResolve:void 0}),u(()=>Ae(N,`card_animation_receiver ${e(d).cellType??""} svelte-1ycsdg6`)),ee(1,N,()=>Z,()=>({key:e(F).entity.seq})),r($,N)};y(he,$=>{e(F)&&e(F).index!=="Top"&&$(Se)})}var ge=s(he,2);{var ue=$=>{var N=qr();r($,N)};y(ge,$=>{e(d).owner.seat==="Below"&&$(ue)})}r(T,x)},p=T=>{var x=Or();const F=ce(()=>e(_e).find(N=>N.to===e(d)));var h=H(x);{var g=N=>{var ye=Yr(),$e=a(ye);St($e,{get entity(){return e(F).entity},state:"Disabled",dummyActionInfos:[],cardActionResolve:void 0}),ee(1,ye,()=>Z,()=>({key:e(F).entity.seq})),r(N,ye)};y(h,N=>{e(F)&&e(F).index!=="Top"&&N(g)})}var Q=s(h,2);{var he=N=>{var ye=Fr(),$e=H(ye);ie($e,1,()=>e(d).visibleEntities.map((Be,Ie)=>({index:Ie,entity:Be})).toReversed(),oe,(Be,Ie)=>{var ze=Me(),E=H(ze);{var C=m=>{var B=Nr();const me=ce(()=>!e(d).isStackCell&&e(Ie).index===0?be(...e(d).visibleEntities):void 0);var je=H(B);{var O=Ue=>{var Ke=Br();r(Ue,Ke)};y(je,Ue=>{e(W).includes(e(Ie).entity)&&Ue(O)})}var Ce=s(je,2),Ne=a(Ce);const We=ce(()=>e(Ie).index===0?e(L).filter(Ue=>e(d).visibleEntities.includes(Ue.action.entity)):void 0);St(Ne,{get entity(){return e(Ie).entity},get state(){return e(me)},get dummyActionInfos(){return e(We)},cardActionResolve:void 0,get selectedList(){return c()},set selectedList(Ue){c(Ue)},$$legacy:!0}),u(()=>Ae(Ce,`duel_card_wrapper ${(e(Ie).entity.exist?"duel_card_wrapper_exists":"")??""} svelte-1ycsdg6`)),ee(2,Ce,()=>xe,()=>({key:e(Ie).entity.seq})),r(m,B)};y(E,m=>{e(_e).every(B=>B.entity.seq!==e(Ie).entity.seq)&&m(C)})}r(Be,ze)});var Re=s($e,2);{var Ye=Be=>{var Ie=Ur(),ze=a(Ie),E=s(ze);ie(E,1,()=>oa(e(d).visibleEntities[0].status.maxCounterQty),oe,(C,m)=>{var B=Ir(),me=H(B),je=s(me);{var O=Ce=>{var Ne=rt();u(()=>f(Ne,`/${e(d).visibleEntities[0].status.maxCounterQty[e(m)]??""}`)),r(Ce,Ne)};y(je,Ce=>{(e(d).visibleEntities[0].status.maxCounterQty[e(m)]??9999)<100&&Ce(O)})}u((Ce,Ne)=>f(me,`【
              ${Ce??""}${Ne??""} `),[()=>Ka(e(m)),()=>e(d).visibleEntities[0].counterHolder.getQty(e(m))],ce),r(C,B)}),u(()=>f(ze,`【${e(d).visibleEntities[0].battlePositionName??""}】 `)),r(Be,Ie)};y(Re,Be=>{e(d).visibleEntities[0].battlePosition&&Be(Ye)})}r(N,ye)};y(Q,N=>{e(d).visibleEntities.length>0&&N(he)})}var Se=s(Q,2);{var ge=N=>{var ye=Hr(),$e=a(ye);u(()=>f($e,e(d).visibleEntities.length)),r(N,ye)};y(Se,N=>{e(d).isStackCell&&N(ge)})}var ue=s(Se,2);{var $=N=>{var ye=Pr(),$e=a(ye);St($e,{get entity(){return e(F).entity},state:"Disabled",dummyActionInfos:[],cardActionResolve:void 0}),ee(1,ye,()=>Z,()=>({key:e(F).entity.seq})),r(N,ye)};y(ue,N=>{e(F)&&e(F).index==="Top"&&N($)})}r(T,x)};y(de,T=>{e(d).cellType==="Hand"?T(se):T(p,!1)},!0)}r(S,le)};y(G,S=>{e(d).isDisabledCell?S(J):S(Ee,!1)})}u(S=>{Ae(U,`${`duel_field_cell duel_field_cell_${e(d).cellType} ${e(d).linkArrowSources.length===0?"":"duel_field_cell_linked"}`??""} svelte-1ycsdg6`),pt(U,"colspan",e(d).cellType==="Hand"?7:1),Ae(M,`${S??""} svelte-1ycsdg6`)},[()=>`duel_field_cell_inner_box ${e(d).cellType} ${e(j)?"can_accept_drop":""} ${X()?"can_action":""} ${e(A)?"is_selected":e(Y)?"is_selectable":""} `],ce),ke("dragover",M,re),ke("drop",M,ve),r(o,U),nt()}Na(["click"]);var Wr=n('<div class="title svelte-14z6bdh"> </div>'),Kr=n('<div class="title svelte-14z6bdh"> </div>'),zr=n('<div class="duel_log_chain_number svelte-14z6bdh"> </div>'),Gr=n('<div><a class="white_button" download="error_info.json">エラー情報ダウンロード</a></div>'),Xr=n("<div><!> <!></div>"),Vr=n('<div><div style="display: flex;    justify-content: space-between;"><div style=" white-space: nowrap;text-align: center;"> </div> <!></div> <!></div>'),Qr=n("<div><!> <!></div>"),Zr=n("<div><!> <!></div>"),Jr=n('<div class="duel_log svelte-14z6bdh"><div class="duel_log_header svelte-14z6bdh"></div> <div class="duel_log_body svelte-14z6bdh"></div> <div class="duel_log_footer svelte-14z6bdh"></div></div>');function es(o,i){st(i,!1);let t=we(void 0),v=Le(i,"log",8),_,c=we([]);const b=()=>{const w=((_==null?void 0:_.seq)??-1)+1;v().records.slice(w).forEach(l=>{if(!_){D(c,[[[[l]]]]),_=l;return}if(!e(c)[l.clock.turn]){Oe(c,e(c)[l.clock.turn]=[[[l]]]),_=l;return}if(!e(c)[l.clock.turn][l.clock.phaseSeq]){Oe(c,e(c)[l.clock.turn][l.clock.phaseSeq]=[[l]]),_=l;return}if(_.clock.chainSeq===l.clock.chainSeq&&_.clock.chainBlockSeq===l.clock.chainBlockSeq&&_.duelist===l.duelist){e(c)[l.clock.turn][l.clock.phaseSeq].slice(-1)[0].push(l),_=l;return}e(c)[l.clock.turn][l.clock.phaseSeq].push([l]),_=l}),D(c,e(c)),za().then(()=>e(t)&&e(t).scroll(0,e(t).clientHeight*990))};v().onUpdate.append(b),v().duel.view.onDuelUpdate.append(b),b(),it();var d=Me(),q=H(d);{var P=w=>{var l=Jr(),L=s(a(l),2);ie(L,5,()=>e(c),oe,(I,R)=>{var W=Zr(),A=a(W);{var Y=ne=>{var Te=Wr(),j=a(Te);u(()=>f(j,`ターン：${e(R)[0][0][0].clock.turn??""}`)),r(ne,Te)};y(A,ne=>{e(R)[0][0][0].clock.turn>0&&ne(Y)})}var te=s(A,2);ie(te,1,()=>e(R),oe,(ne,Te)=>{var j=Qr(),k=a(j);{var K=xe=>{var Z=Kr(),_e=a(Z);u(()=>f(_e,e(Te)[0][0].clock.period.name)),r(xe,Z)};y(k,xe=>{e(Te)[0][0].clock.turn>0&&xe(K)})}var ae=s(k,2);ie(ae,1,()=>e(Te),oe,(xe,Z)=>{var _e=Vr();const V=ce(()=>{var U;return((U=e(Z).find(M=>M.chainNumber!==void 0))==null?void 0:U.chainNumber)??0});var pe=a(_e),X=a(pe),z=a(X),re=s(X,2);{var ve=U=>{var M=zr(),G=a(M);u(()=>f(G,`チェーン：${e(V)??""}`)),r(U,M)};y(re,U=>{e(V)&&U(ve)})}var be=s(pe,2);ie(be,1,()=>e(Z),oe,(U,M)=>{var G=Xr(),J=a(G);{var Ee=se=>{var p=rt();u(()=>f(p,e(M).text)),r(se,p)},S=se=>{var p=Me(),T=H(p);{var x=h=>{var g=rt();u((Q,he,Se)=>f(g,`移動：${Q??""} ${he??""} ⇒ ${Se??""}`),[()=>{var Q;return(Q=e(M).mainEntity)==null?void 0:Q.toString()},()=>{var Q;return(Q=e(M).from)==null?void 0:Q.toString()},()=>{var Q;return(Q=e(M).to)==null?void 0:Q.toString()}],ce),r(h,g)},F=h=>{var g=Me(),Q=H(g);{var he=ge=>{var ue=rt();u(($,N)=>f(ue,`生成：${$??""} void ⇒ ${N??""}`),[()=>{var $;return($=e(M).mainEntity)==null?void 0:$.toString()},()=>{var $;return($=e(M).to)==null?void 0:$.toString()}],ce),r(ge,ue)},Se=ge=>{var ue=Me(),$=H(ue);{var N=$e=>{var Re=rt();u((Ye,Be)=>f(Re,`消滅：${Ye??""} ${Be??""} ⇒ void`),[()=>{var Ye;return(Ye=e(M).mainEntity)==null?void 0:Ye.toString()},()=>{var Ye;return(Ye=e(M).from)==null?void 0:Ye.toString()}],ce),r($e,Re)},ye=$e=>{var Re=rt();u(()=>f(Re,e(M).text)),r($e,Re)};y($,$e=>{e(M).type==="EntityDisappear"?$e(N):$e(ye,!1)},!0)}r(ge,ue)};y(Q,ge=>{e(M).type==="EntityAppear"?ge(he):ge(Se,!1)},!0)}r(h,g)};y(T,h=>{e(M).type==="EntityMove"?h(x):h(F,!1)},!0)}r(se,p)};y(J,se=>{e(M).type==="ChainBlockHeader"?se(Ee):se(S,!1)})}var le=s(J,2);{var de=se=>{var p=Gr(),T=a(p);u(x=>pt(T,"href",x),[()=>window.URL.createObjectURL(new Blob([Xa(e(M).error,(x,F)=>["pool","bundles","duel"].includes(x)||typeof F=="function"?void 0:F,4)],{type:"text/plain"}))],ce),r(se,p)};y(le,se=>{e(M).error&&se(de)})}u(se=>Ae(G,`duel_log_record duel_log_record_${se??""} svelte-14z6bdh`),[()=>e(M).type.toSnakeCase()],ce),r(U,G)}),u(()=>{var U,M,G;Ae(_e,`duel_log_block_duelist duel_log_block_duelist_${((U=e(Z)[0].duelist)==null?void 0:U.seat)??"system"} svelte-14z6bdh`),Ae(X,`duelist ${((M=e(Z)[0].duelist)==null?void 0:M.seat)??""} svelte-14z6bdh`),f(z,((G=e(Z)[0].duelist)==null?void 0:G.profile.name)||"SYSTEM")}),r(xe,_e)}),u(()=>Ae(j,`duel_log_block_phase duel_log_block_phase_${e(Te)[0][0].clock.period.key??""} svelte-14z6bdh`)),r(ne,j)}),u(()=>Ae(W,`duel_log_block_turn duel_log_block_turn_${e(R)[0][0][0].clock.turn??""} svelte-14z6bdh`)),r(I,W)}),Ga(L,I=>D(t,I),()=>e(t)),r(w,l)};y(q,w=>{(v().duel.view.infoBoardState==="Log"||v().duel.view.infoBoardState==="Default")&&w(P)})}r(o,d),nt()}var ts=n("<div><div> </div> <div> </div></div>");function Ya(o,i){st(i,!1);let t=Le(i,"duelist",12),v=we(0),_=we();const c=async()=>{const L=t().lp-e(v);if(!e(_)||Math.abs(L)<10){D(v,t().lp),e(_)&&(e(_)(),D(_,void 0));return}D(v,e(v)+Math.floor(Math.random()*L)),await Mt(100),c()},b=()=>{t(t()),!e(_)&&t().lp!==e(v)&&new Promise(L=>{D(_,L),Math.abs(t().lp-e(v)),c()})};t().duel.log.onUpdate.append(b),c(),it();var d=ts(),q=a(d),P=a(q),w=s(q,2),l=a(w);u(L=>{Ae(d,`duelist duelist_${L??""} svelte-1sy3trd`),Ae(q,`duelist_name duelist_${L??""}_name svelte-1sy3trd`),f(P,t().profile.name),Ae(w,`duelist_lp ${(e(_)?"vibration":"")??""} svelte-1sy3trd`),f(l,e(v))},[()=>t().seat.toLowerCase()],ce),r(o,d),nt()}const as=(o,i,t)=>(i(i()!=="Detail"?"Detail":"Normal"),console.info(t()),!0),rs=(o,i,t)=>(i(i()!=="Debug"?"Debug":"Normal"),console.info(t()),!0);var ss=n('<div class="duel_card_info_row svelte-1uevs9j" style=" justify-content: space-between;"><div class="svelte-1uevs9j"> </div> <div class="svelte-1uevs9j"> </div></div>'),is=n('<div></div> <div class="svelte-1uevs9j"> </div>',1),ns=n("<div> </div>"),ls=n("<div> </div>"),os=n('<div class="duel_card_info_row svelte-1uevs9j"><!> <!></div> <div class="duel_card_info_row svelte-1uevs9j"></div>',1),vs=n('<div class="duel_card_row svelte-1uevs9j"><div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"> </div></div>'),ds=n('<div class="duel_card_row svelte-1uevs9j"><div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"> </div></div>'),cs=n("<!> <!>",1),_s=n('<div class="duel_card_info_row svelte-1uevs9j" style="border-style: solid; border-width: 1px;"><pre class="description svelte-1uevs9j"> </pre></div>'),us=n('<!> <div class="duel_card_info_row svelte-1uevs9j"><pre class="description svelte-1uevs9j"> </pre></div>',1),fs=n('<div class="effect_counter_area_item svelte-1uevs9j"><span class="svelte-1uevs9j"> </span> <span class="svelte-1uevs9j"> </span> <span class="svelte-1uevs9j">/</span> <span class="svelte-1uevs9j"> </span></div>'),ps=n('<div class="duel_card_info_row effect_counter_area svelte-1uevs9j"><div class="effect_counter_area_title svelte-1uevs9j">効果使用状況</div> <div class="effect_counter_area_body svelte-1uevs9j"></div></div>'),gs=n("[ <!> ],",1),ms=n('<div class="svelte-1uevs9j"> <!></div>'),bs=n('<div class="svelte-1uevs9j"> </div> <!> <div class="svelte-1uevs9j"></div>',1),hs=n('<div class="svelte-1uevs9j"> </div>'),ys=n('<div class="svelte-1uevs9j"> </div>'),ks=n('<div class="svelte-1uevs9j"> </div>'),ws=n('<div class="svelte-1uevs9j"> </div>'),xs=n('<div class="svelte-1uevs9j"> </div>'),Cs=n('<div class="svelte-1uevs9j"> </div>'),Ds=n('<div class="duel_card_info_row svelte-1uevs9j"><div class="svelte-1uevs9j"><!> <div class="svelte-1uevs9j"></div> <!> <div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"></div> <!> <div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"></div> <!> <div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"></div> <!> <div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"></div> <!> <div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"></div> <!> <div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"> </div> <div class="svelte-1uevs9j"> </div> <div class="svelte-1uevs9j"> </div> <div class="svelte-1uevs9j"></div></div></div>'),$s=n('<div class="svelte-1uevs9j">※テスト用カードです</div>'),Ss=n('<div class="duel_card_info_links svelte-1uevs9j"><a target="_blank" rel="noopener noreferrer" title="遊戯王カードWiki" class="svelte-1uevs9j">⇒遊戯王カードWiki</a> <a target="_blank" rel="noopener noreferrer" title="コナミカードデータベース" class="svelte-1uevs9j"> </a></div>'),Ms=n('<div role="contentinfo"><div class="duel_card_info_header svelte-1uevs9j"><div class="duel_card_info_row svelte-1uevs9j"><div class="svelte-1uevs9j"> </div></div> <div class="duel_card_info_row svelte-1uevs9j" style="position:sticky; top:0;"><div class="svelte-1uevs9j"> </div> <div class="svelte-1uevs9j"> </div></div> <!></div> <div class="duel_card_info_body svelte-1uevs9j"><!></div> <div class="duel_card_info_footer svelte-1uevs9j"><!></div></div>');function Ts(o,i){st(i,!1);let t=Le(i,"entity",8,void 0),v=Le(i,"mode",12,"Normal");const _=()=>t()?bt[t().origin.name]:void 0,c=()=>{var P;return t()&&(t().origin.cardId??!1)?`https://www.db.yugioh-card.com/yugiohdb/card_search.action?ope=2&cid=${t().origin.cardId}`:`https://www.db.yugioh-card.com/yugiohdb/card_search.action?ope=1&sess=1&rp=10&mode=&sort=1&keyword=${(P=_())==null?void 0:P.name}&stype=1&ctype=&othercon=2&starfr=&starto=&pscalefr=&pscaleto=&linkmarkerfr=&linkmarkerto=&link_m=2&atkfr=&atkto=&deffr=&defto=&releaseDStart=1&releaseMStart=1&releaseYStart=1999&releaseDEnd=&releaseMEnd=&releaseYEnd=`};it();var b=Me(),d=H(b);{var q=P=>{var w=Ms();w.__click=[as,v,t],w.__contextmenu=[rs,v,t];var l=a(w),L=a(l),I=a(L),R=a(I),W=s(L,2),A=a(W),Y=a(A),te=s(A,2),ne=a(te),Te=s(W,2);{var j=X=>{var z=cs(),re=H(z);{var ve=G=>{var J=ss(),Ee=a(J),S=a(Ee),le=s(Ee,2),de=a(le);u(()=>{f(S,`◀ ${t().psL??""}`),f(de,`${t().psR??""} ▶`)}),r(G,J)};y(re,G=>{var J;(J=t().origin.monsterCategories)!=null&&J.includes("Pendulum")&&G(ve)})}var be=s(re,2);{var U=G=>{var J=os(),Ee=H(J),S=a(Ee);ie(S,1,()=>t().attr,oe,(se,p)=>{var T=is(),x=H(T),F=s(x,2),h=a(F);u(()=>{Ae(x,`monster_attr ${e(p)??""} svelte-1uevs9j`),f(h,`${va[e(p)]??""}属性`)}),r(se,T)});var le=s(S,2);ie(le,1,()=>t().types,oe,(se,p)=>{var T=ns(),x=a(T);u(()=>{Ae(T,`monster_cat ${e(p)??""} svelte-1uevs9j`),f(x,`${Vt[e(p)]??""}${da[e(p)]??""}族`)}),r(se,T)});var de=s(Ee,2);ie(de,5,()=>t().status.monsterCategories??[],oe,(se,p)=>{var T=ls(),x=a(T);u(()=>{Ae(T,`monster_cat ${e(p)??""} svelte-1uevs9j`),f(x,`${Qt[e(p)]??""}${ca[e(p)]??""}`)}),r(se,T)}),r(G,J)},M=G=>{var J=Me(),Ee=H(J);{var S=de=>{var se=vs(),p=s(a(se),2),T=a(p);u(()=>f(T,`${Zt[t().status.spellCategory]??""}魔法`)),r(de,se)},le=de=>{var se=Me(),p=H(se);{var T=x=>{var F=ds(),h=s(a(F),2),g=a(h);u(()=>f(g,`${Jt[t().status.trapCategory]??""}罠`)),r(x,F)};y(p,x=>{t().kind==="Trap"&&t().status.trapCategory&&x(T)},!0)}r(de,se)};y(Ee,de=>{t().kind==="Spell"&&t().status.spellCategory?de(S):de(le,!1)},!0)}r(G,J)};y(be,G=>{t().kind==="Monster"?G(U):G(M,!1)})}r(X,z)};y(Te,X=>{v()!=="Debug"&&X(j)})}var k=s(l,2),K=a(k);{var ae=X=>{var z=us(),re=H(z);{var ve=G=>{var J=_s(),Ee=a(J),S=a(Ee);u(()=>f(S,bt[t().origin.name].pendulumDescription)),r(G,J)};y(re,G=>{var J;(J=t().status.monsterCategories)!=null&&J.includes("Pendulum")&&G(ve)})}var be=s(re,2),U=a(be),M=a(U);u(G=>f(M,G),[()=>{var G;return(G=_())==null?void 0:G.description}],ce),r(X,z)},xe=X=>{var z=Me(),re=H(z);{var ve=U=>{var M=Me(),G=H(M);{var J=Ee=>{var S=ps(),le=s(a(S),2);ie(le,5,()=>t().actions,oe,(de,se)=>{var p=Me();const T=ce(()=>e(se).actionCountUpperBound),x=ce(()=>e(se).actionCount);var F=H(p);{var h=g=>{var Q=fs(),he=a(Q),Se=a(he),ge=s(he,2),ue=a(ge),$=s(ge,4),N=a($);u(()=>{f(Se,e(se).title),f(ue,e(x)),f(N,e(T))}),r(g,Q)};y(F,g=>{e(T)!==void 0&&e(x)!==void 0&&g(h)})}r(de,p)}),r(Ee,S)};y(G,Ee=>{t().actions.some(S=>S.actionCountUpperBoundKey)&&Ee(J)})}r(U,M)},be=U=>{var M=Ds(),G=a(M),J=a(G);ie(J,0,()=>["info","status"],oe,(C,m)=>{var B=bs(),me=H(B),je=a(me),O=s(me,2);ie(O,1,()=>Object.entries(t()[m]),oe,(Ne,We)=>{let Ue=()=>e(We)[0],Ke=()=>e(We)[1];var vt=ms(),dt=a(vt),tt=s(dt);{var De=qe=>{var Ve=gs(),Je=s(H(Ve));ie(Je,1,Ke,oe,(lt,yt)=>{var Ge=rt();u(Fe=>f(Ge,`${Fe??""},`),[()=>e(yt).toString()],ce),r(lt,Ge)}),r(qe,Ve)},He=qe=>{var Ve=rt();u(Je=>f(Ve,`${Je??""},`),[()=>{var Je;return(Je=Ke())==null?void 0:Je.toString()}],ce),r(qe,Ve)};y(tt,qe=>{Array.isArray(Ke())?qe(De):qe(He,!1)})}u(()=>f(dt,`"${Ue()??""}" : `)),r(Ne,vt)});var Ce=s(O,2);Ce.textContent="},",u(()=>f(je,`"${m??""}" :{`)),r(C,B)});var Ee=s(J,2);Ee.textContent='"actions" :[';var S=s(Ee,2);ie(S,1,()=>t().actions,oe,(C,m)=>{var B=hs(),me=a(B);u(()=>f(me,`"${e(m).playType??""} ${e(m).title??""}",`)),r(C,B)});var le=s(S,2);le.textContent="],";var de=s(le,2);de.textContent='"substituteEffects" :[';var se=s(de,2);ie(se,1,()=>t().substituteEffects,oe,(C,m)=>{var B=ys(),me=a(B);u(()=>f(me,`"${e(m).title??""}",`)),r(C,B)});var p=s(se,2);p.textContent="],";var T=s(p,2);T.textContent='"continuousEffects" :[';var x=s(T,2);ie(x,1,()=>t().continuousEffects,oe,(C,m)=>{var B=ks(),me=a(B);u(()=>f(me,`"${e(m).isStarted??""}",`)),r(C,B)});var F=s(x,2);F.textContent="],";var h=s(F,2);h.textContent='"procFilters" :[';var g=s(h,2);ie(g,1,()=>t().procFilterBundle.operators,oe,(C,m)=>{var B=ws(),me=a(B);u(je=>f(me,`"${je??""} ${e(m).title??""} ${e(m).isEffective??""} ",`),[()=>e(m).isSpawnedBy.toString()],ce),r(C,B)});var Q=s(g,2);Q.textContent="],";var he=s(Q,2);he.textContent='"numericStateOperators" :[';var Se=s(he,2);ie(Se,1,()=>t().numericOprsBundle.operators,oe,(C,m)=>{var B=xs(),me=a(B);u(je=>f(me,`"${je??""} ${e(m).title??""} ${e(m).isEffective??""} ${e(m).isContinuous??""} ${e(m).targetState??""} ${e(m).targetStateGen??""} ",`),[()=>e(m).isSpawnedBy.toString()],ce),r(C,B)});var ge=s(Se,2);ge.textContent="],";var ue=s(ge,2);ue.textContent='"stateOperators" :[';var $=s(ue,2);ie($,1,()=>t().statusOperatorBundle.operators,oe,(C,m)=>{var B=Cs(),me=a(B);u(je=>f(me,`"${je??""} ${e(m).title??""} ${e(m).isEffective??""} ",`),[()=>e(m).isSpawnedBy.toString()],ce),r(C,B)});var N=s($,2);N.textContent="],";var ye=s(N,2);ye.textContent='"lastMoveLogRecord" :{';var $e=s(ye,2),Re=a($e),Ye=s($e,2),Be=a(Ye),Ie=s(Ye,2),ze=a(Ie),E=s(Ie,2);E.textContent="},",u((C,m)=>{f(Re,`"movedBy":"${C??""}",`),f(Be,`"movedAs":"${m??""}",`),f(ze,`"movedAt":"${t().moveLog.latestRecord.movedAt.totalProcSeq??""}",`)},[()=>{var C;return(C=t().moveLog.latestRecord.movedBy)==null?void 0:C.toString()},()=>t().moveLog.latestRecord.movedAs.join(" ")],ce),r(U,M)};y(re,U=>{v()==="Detail"?U(ve):U(be,!1)},!0)}r(X,z)};y(K,X=>{v()==="Normal"?X(ae):X(xe,!1)})}var Z=s(k,2),_e=a(Z);{var V=X=>{var z=$s();r(X,z)},pe=X=>{var z=Ss(),re=a(z),ve=s(re,2),be=a(ve);u(U=>{var M;pt(re,"href",`https://yugioh-wiki.net/index.php?${t().origin.wikiEncodedName}`),pt(ve,"href",U),f(be,`⇒${((M=t())!=null&&M.origin.cardId?"公式カードページ":"公式で検索")??""}`)},[c],ce),r(X,z)};y(_e,X=>{var z;(z=t())!=null&&z.origin.isForTest?X(V):X(pe,!1)})}u((X,z,re)=>{Ae(w,`duel_card duel_card_info ${t().origin.kind??""} ${X??""} svelte-1uevs9j`),f(R,t().nm),f(Y,z),f(ne,re)},[()=>{var X;return(X=t().origin.monsterCategories)==null?void 0:X.join(" ")},()=>"★".repeat(t().lvl||0),()=>"☆".repeat(t().rank||0)],ce),r(P,w)};y(d,P=>{t()&&P(q)})}r(o,b),nt()}Na(["click","contextmenu"]);var js=n('<div class="duel_field_cell_info_item svelte-1xj7qf1"><!></div>'),Es=n('<div class="duel_field_cell_info_box svelte-1xj7qf1"><div class="duel_field_cell_info_label svelte-1xj7qf1"> </div> <!></div>'),qs=n('<div class="duel_field_cell_info svelte-1xj7qf1"><div class="duel_field_cell_info_header item_btn svelte-1xj7qf1"><div class="svelte-1xj7qf1"> </div> <div class="svelte-1xj7qf1"> </div></div> <div class="duel_field_cell_info_body svelte-1xj7qf1"></div></div>');function As(o,i){st(i,!1);let t=Le(i,"cell",12);const v=()=>{t(t())},_=q=>t().cardEntities.filter(P=>P.face===q);t().field.duel.view.onDuelUpdate.append(v),it();var c=Me(),b=H(c);{var d=q=>{var P=qs(),w=a(P),l=a(w),L=a(l),I=s(l,2),R=a(I),W=s(w,2);ie(W,4,()=>["FaceUp","FaceDown"],oe,(A,Y)=>{var te=Me(),ne=H(te);{var Te=j=>{var k=Es(),K=a(k),ae=a(K),xe=s(K,2);ie(xe,1,()=>_(Y).toSorted(Va),oe,(Z,_e)=>{var V=js(),pe=a(V);const X=ce(()=>t().owner===t().field.duel.duelists.Below);St(pe,{get entity(){return e(_e)},get isVisibleForcibly(){return e(X)},isWideMode:!0,cardActionResolve:void 0}),r(Z,V)}),u(()=>f(ae,Y==="FaceUp"?"表向き":"裏向き")),r(j,k)};y(ne,j=>{_(Y).length&&j(Te)})}r(A,te)}),u(()=>{var A;f(L,(A=t().owner)==null?void 0:A.profile.name),f(R,t().cellType)}),r(q,P)};y(b,q=>{t().field.duel.view.infoBoardState==="CellInfo"&&q(d)})}r(o,c),nt()}var Ys=n('<div class="duel_config_item svelte-y4u26k"><label class="toggle svelte-y4u26k"><input type="checkbox" class="svelte-y4u26k"></label> <span class="svelte-y4u26k"> </span></div>'),Bs=n('<div class="duel_config svelte-y4u26k"><div class="duel_config_title svelte-y4u26k">デュエル設定</div> <div class="duel_config_group svelte-y4u26k"><div class="duel_config_group_title svelte-y4u26k">チェーン設定</div> <!></div></div>');function Ns(o,i){st(i,!1);let t=Le(i,"viewController",8),v=Le(i,"userProfile",12);it();var _=Me(),c=H(_);{var b=d=>{var q=Bs(),P=s(a(q),2),w=s(a(P),2);ie(w,1,()=>Ja,oe,(l,L)=>{var I=Ys(),R=a(I),W=a(R),A=s(R,2),Y=a(A);u(()=>f(Y,Qa[e(L)])),Za(W,()=>v().chainConfig[e(L)],te=>v(v().chainConfig[e(L)]=te,!0)),ke("change",W,()=>v().save()),r(l,I)}),r(d,q)};y(c,d=>{t().infoBoardState==="Config"&&d(b)})}r(o,_),nt()}function Is(o,{from:i,to:t},v={}){var{delay:_=0,duration:c=k=>Math.sqrt(k)*120,easing:b=ia}=v,d=getComputedStyle(o),q=d.transform==="none"?"":d.transform,[P,w]=d.transformOrigin.split(" ").map(parseFloat);P/=o.clientWidth,w/=o.clientHeight;var l=Us(o),L=o.clientWidth/t.width/l,I=o.clientHeight/t.height/l,R=i.left+i.width*P,W=i.top+i.height*w,A=t.left+t.width*P,Y=t.top+t.height*w,te=(R-A)*L,ne=(W-Y)*I,Te=i.width/t.width,j=i.height/t.height;return{delay:_,duration:typeof c=="function"?c(Math.sqrt(te*te+ne*ne)):c,easing:b,css:(k,K)=>{var ae=K*te,xe=K*ne,Z=k+K*Te,_e=k+K*j;return`transform: ${q} translate(${ae}px, ${xe}px) scale(${Z}, ${_e});`}}}function Us(o){if("currentCSSZoom"in o)return o.currentCSSZoom;for(var i=o,t=1;i!==null;)t*=+getComputedStyle(i).zoom,i=i.parentElement;return t}var Fs=n('<div class="chain_number svelte-d2f52m"> </div>'),Hs=n('<div class="duel_card_row svelte-d2f52m"> </div>'),Ps=n('<div class="appendix svelte-d2f52m"> </div>'),Os=n('<div class="appendix_wrapper svelte-d2f52m"></div>'),Ls=n('<div><div><!> <div> </div> <div><!> <div class="duel_card_row svelte-d2f52m"><div> </div> <!></div></div></div></div>'),Rs=n("<div></div>");function Ws(o,i){st(i,!1);let t=Le(i,"duel",8),v=Le(i,"position",8,"left");const _=-100,c=()=>v()==="left"?-100:100;let b=we([]),d=Promise.resolve(),q=Promise.resolve();const P=1e3,w=500,l=400,L=R=>{const W={...R};W.isKnown=R.chainBlockInfo.action.entity.controller.duelistType==="Player"||R.chainBlockInfo.action.entity.face==="FaceUp",W.chainBlockInfo.onStateChange.append(A=>{if(A==="done"||A==="failed"||A==="nagated")return d=d.then(async()=>{const Y=new Date().getTime()-W.chainBlockInfo.wasSpawnedAt.getTime();Y<P&&await Mt(P-Y),D(b,e(b).filter(te=>te.seq!==W.seq)),await Mt(w+l)}).then(),"RemoveMe";D(b,e(b))}),q=q.then(async()=>{D(b,[W,...e(b)].sort((A,Y)=>er.isSameChain(A.clock,Y.clock)&&A.chainBlockInfo.action.isWithChainBlock&&Y.chainBlockInfo.action.isWithChainBlock?Y.clock.totalProcSeq-A.clock.totalProcSeq:A.clock.totalProcSeq-Y.clock.totalProcSeq)),await Mt(300)}),d=d.then(()=>Mt(1e3))};t().chainBlockLog.onInsert.append(L),it();var I=Rs();ie(I,13,()=>e(b),R=>R.seq,(R,W)=>{var A=Ls();const Y=ce(()=>{const{activator:z,action:re,appendix:ve}=e(W).chainBlockInfo;return{activator:z,action:re,appendix:ve}});var te=a(A),ne=a(te);{var Te=z=>{var re=Fs(),ve=a(re);u(()=>f(ve,`チェーン：${e(W).chainBlockInfo.chainNumber??""}`)),r(z,re)};y(ne,z=>{e(W).chainBlockInfo.chainNumber&&z(Te)})}var j=s(ne,2),k=a(j),K=s(j,2),ae=a(K);{var xe=z=>{var re=Hs(),ve=a(re);u(()=>f(ve,e(W).isKnown?e(Y).action.entity.nm:"？？？")),r(z,re)};y(ae,z=>{(e(Y).action.entity.entityType==="Card"||e(Y).action.entity.entityType==="Token")&&z(xe)})}var Z=s(ae,2),_e=a(Z),V=a(_e),pe=s(_e,2);{var X=z=>{var re=Os();ie(re,5,()=>e(Y).appendix,oe,(ve,be)=>{var U=Ps(),M=a(U);u(()=>f(M,e(be))),r(ve,U)}),r(z,re)};y(pe,z=>{e(Y).appendix&&z(X)})}u((z,re,ve)=>{Ae(A,`cut_in_row ${(!e(W).chainBlockInfo.chainNumber||e(W).chainBlockInfo.chainNumber===1?"cut_in_row_first":"")??""} svelte-d2f52m`),Ae(te,`cut_in_item cut_in_item_${z??""} cut_in_item_${e(W).chainBlockInfo.state??""} svelte-d2f52m`),Ae(j,`duelist_name duelist_${z??""}_name svelte-d2f52m`),f(k,e(Y).activator.profile.name),Ae(K,`duel_card duel_card_${z??""} ${re??""} ${(e(W).isKnown?e(Y).action.entity.origin.kind:"")??""} ${e(Y).action.entity.entityType??""}  svelte-d2f52m`),f(V,ve)},[()=>e(Y).activator.seat.toLowerCase(),()=>e(W).isKnown?(e(Y).action.entity.status.monsterCategories??[]).join(" "):"Token",()=>e(Y).action.toString()],ce),ee(3,te,()=>wr,()=>new Date().getTime()-e(W).chainBlockInfo.wasSpawnedAt.getTime()<P?{x:c(),duration:l}:{y:_,duration:l}),tr(A,()=>Is,()=>({duration:w})),r(R,A)}),u(()=>Ae(I,`cut_in_container cut_in_container_${v()??""} svelte-d2f52m`)),r(o,I),nt()}const Ks=xr({duration:400});var zs=n('<div class="duel_desk_left v_flex svelte-1i63tk9"><!> <!> <!></div>'),Gs=n('<button class="duel_field_header_message svelte-1i63tk9"> </button> <div class="duel_field_header_buttons svelte-1i63tk9"><button class="svelte-1i63tk9">サレンダー</button></div>',1),Xs=n("<tr></tr>"),Vs=n('<table class="duel_field svelte-1i63tk9"><tbody class="svelte-1i63tk9"></tbody></table>'),Qs=n('<button class="svelte-1i63tk9">OK</button>'),Zs=n('<button class="svelte-1i63tk9">cancel</button>'),Js=n("<!> <!>",1),ei=n('<button class="svelte-1i63tk9"> </button>'),ti=n('<div style="text-align: left;"><!> <!> <!></div>'),ai=n('<div><!> <div class=" duel_desk_center v_flex svelte-1i63tk9"><div class="duel_field_header svelte-1i63tk9"><!></div> <div class="duel_field_body svelte-1i63tk9"><!></div> <div class="duel_field_footer svelte-1i63tk9"><!></div></div> <!></div> <div style="position:fixed;left:0;bottom:0"> </div> <!> <div><!></div>',1);function ri(o,i){st(i,!1);let t=Le(i,"duel",12),v=Le(i,"userProfile",8),_=we(0),c=we(0),b=we([]),d=we([]),q=()=>{},P=we([]),w=we(),l=we(),L=we(()=>!1),I=we(!1);const R=h=>{q=h.resolve,D(P,h.dummyActionInfos.filter(g=>g.action.entity.entityType==="Duelist").filter(g=>g.action.entity.controller.seat==="Below")),D(w,void 0),D(l,void 0),D(d,[]),D(b,[]),D(I,!1),h.entitiesChoices&&(D(w,h.entitiesChoices),D(L,()=>{var g;return((g=h.entitiesChoices)==null?void 0:g.validator(e(b)))??!1}),D(I,h.entitiesChoices.cancelable),e(w).selectables.every(g=>g.cell.isPlayFieldCell&&g.getIndexInCell()===0||g.cell.cellType==="Hand"&&g.controller.duelistType==="Player"||g.entityType==="Duelist")||t().view.modalController.entitySelector.show({title:t().view.message,position:"Middle",entitiesChoices:h.entitiesChoices,chainBlockInfos:h.chainBlockInfos,cancelable:h.entitiesChoices.cancelable}).then(g=>{q({selectedEntities:g})})),h.cellsChoices&&(D(l,h.cellsChoices),D(L,()=>{var g;return((g=h.cellsChoices)==null?void 0:g.validator(e(d)))??!1}),D(I,h.cellsChoices.cancelable))};t().view.onWaitStart.append(R);const W=()=>{q=()=>{},D(l,void 0),D(w,void 0),D(d,[]),D(b,[]),D(L,()=>!1),D(I,!1)};t().view.onWaitEnd.append(W);let A=we(void 0),Y=we("Normal");const te=({card:h,mode:g})=>{D(A,h),D(Y,g??(e(A)===h||e(Y)==="Normal"?"Detail":"Normal"))};t().view.onShowCardEntity.append(te);const ne=()=>{t(t())};t().view.onDuelUpdate.append(ne),t().log.onUpdate.append(ne);const Te=()=>{e(w)&&e(w).validator(e(b))&&q({selectedEntities:e(b)}),e(l)&&e(l).validator(e(d))&&q({selectedCells:e(d)})},j=()=>{q({})},k=h=>{q({actionInfo:h})},K=()=>{q({surrender:!0})};t().main();const ae=()=>e(_)<=1400?"compact":"wide";it();var xe=ai(),Z=H(xe),_e=a(Z);{var V=h=>{var g=zs(),Q=a(g);Ya(Q,{get duelist(){return t().duelists.Above}});var he=s(Q,2);Ts(he,{get entity(){return e(A)},get mode(){return e(Y)}});var Se=s(he,2);Ya(Se,{get duelist(){return t().duelists.Below}}),r(h,g)};y(_e,h=>{ae()==="wide"&&h(V)})}var pe=s(_e,2),X=a(pe),z=a(X);{var re=h=>{var g=Gs(),Q=H(g),he=a(Q),Se=s(Q,2),ge=a(Se);u(()=>f(he,`[TURN:${t().clock.turn}][PHASE:${t().phase}] ${t().view.message}`)),ke("click",Q,()=>{t(t().view.infoBoardState="Log",!0)}),ke("click",ge,K),r(h,g)};y(z,h=>{t().isEnded||h(re)})}var ve=s(X,2),be=a(ve);{var U=h=>{var g=Vs(),Q=a(g);ie(Q,5,()=>t().field.cells,oe,(he,Se,ge)=>{var ue=Xs();Ae(ue,`${`duel_desk_row_${ge}`??""} svelte-1i63tk9`),ie(ue,5,()=>e(Se),oe,($,N,ye)=>{Rr($,{get view(){return t().view},row:ge,column:ye,get selectedEntities(){return e(b)},set selectedEntities($e){D(b,$e)},get selectedCells(){return e(d)},set selectedCells($e){D(d,$e)},$$legacy:!0})}),r(he,ue)}),r(h,g)};y(be,h=>{t().clock.turn>0&&h(U)})}var M=s(ve,2),G=a(M);{var J=h=>{var g=Js(),Q=H(g);{var he=ue=>{var $=Qs();u(N=>$.disabled=N,[()=>!e(L)()],ce),ke("click",$,Te),r(ue,$)};y(Q,ue=>{((e(w)&&e(w).qty)??(e(l)&&e(l).qty)??9999)>1&&ue(he)})}var Se=s(Q,2);{var ge=ue=>{var $=Zs();ke("click",$,j),r(ue,$)};y(Se,ue=>{e(I)&&ue(ge)})}r(h,g)},Ee=h=>{var g=Me(),Q=H(g);ie(Q,1,()=>e(P),oe,(he,Se)=>{var ge=ei(),ue=a(ge);u(()=>f(ue,e(Se).action.title)),ke("click",ge,()=>k(e(Se))),r(he,ge)}),r(h,g)};y(G,h=>{e(w)&&e(w).selectables.length||e(l)&&e(l).selectables?h(J):h(Ee,!1)})}var S=s(pe,2);{var le=h=>{var g=ti(),Q=a(g);es(Q,{get log(){return t().log}});var he=s(Q,2);As(he,{get cell(){return t().view.infoBoardCell}});var Se=s(he,2);Ns(Se,{get userProfile(){return v()},get viewController(){return t().view}}),u(ge=>Ae(g,`duel_desk_right duel_desk_right_${ge??""}  svelte-1i63tk9`),[()=>t().view.infoBoardState.toLowerCase()],ce),ee(3,g,()=>fe,()=>({duration:e(_)>1400?0:200,axis:"x"})),r(h,g)};y(S,h=>{(e(_)>1400||t().view.infoBoardState!=="Default")&&h(le)})}var de=s(Z,2),se=a(de),p=s(de,2);ar(p,{get modalController(){return t().view.modalController}});var T=s(p,2),x=a(T);const F=ce(()=>ae()==="wide"?"right":"left");Ws(x,{get duel(){return t()},get position(){return e(F)}}),u((h,g)=>{Ae(Z,`flex duel_desk ${h??""}_mode svelte-1i63tk9`),f(se,g),Ae(T,`cutin ${h??""}_mode svelte-1i63tk9`)},[ae,()=>t().clock.toFullString()],ce),Kt("innerWidth",h=>D(_,h)),Kt("innerHeight",h=>D(c,h)),r(o,xe),nt()}var si=n('<div class="svelte-swqq02"><button class="button_style_reset svelte-swqq02" title="※shiftキー同時押しで一括外し">クリア</button></div>'),ii=n('<div class="svelte-swqq02"><button class="button_style_reset svelte-swqq02" title="※shiftキー同時押しで一括外し">クリア</button></div>'),ni=n("<div></div>"),li=n("<!> <!> <!> <!> <!>",1),oi=n('<span> </span> / <span style="display: inline-block;width:2rem;text-align: right;"> </span>',1),vi=n('<li class="deck_editor_item svelte-swqq02"><div role="listitem"><div class="svelte-swqq02"><div class="svelte-swqq02"> </div> <div style="display:flex" class="svelte-swqq02"><div class="svelte-swqq02"><!> <!> <!></div> <div style="flex-grow: 1; width:0.1rem" class="svelte-swqq02"></div> <div class="svelte-swqq02"><!></div></div></div></div> <button class="button_style_reset svelte-swqq02" title="※shiftキー同時押しで一括投入">+</button> <button class="button_style_reset svelte-swqq02" title="※shiftキー同時押しで一括外し">-</button></li>'),di=n('<div class="deck_editor_card_kind svelte-swqq02"><div class="deck_editor_card_kind_header svelte-swqq02"><div class="svelte-swqq02"> </div> <!></div> <ul class="svelte-swqq02"></ul></div>'),ci=n('<div class="deck_editor_deck_type svelte-swqq02"><div class="deck_editor_deck_type_header svelte-swqq02"><div class="svelte-swqq02"> </div> <!></div> <!></div>'),_i=n('<div class="svelte-swqq02">読み込み中...</div>'),ui=n('<div class="deck_editor_card_list svelte-swqq02"><!></div>');function Ba(o,i){st(i,!1);let t=Le(i,"allCardInfos",8),v=Le(i,"deckCardInfos",12),_=Le(i,"mode",8),c=Le(i,"onAttention",8),b=Le(i,"searchCondition",8,void 0);const d={Deck:["Monster","Spell","Trap"],ExtraDeck:["Monster"]},q={Deck:{Monster:[],Spell:[],Trap:[]},ExtraDeck:{Monster:[],Spell:[],Trap:[]}},P=j=>{var k;return(k=j.monsterCategories)!=null&&k.union(zt).length?"ExtraDeck":"Deck"},w=j=>{Object.values(q).forEach(k=>Object.values(k).forEach(K=>K.reset())),j.filter(k=>k.isImplemented).filter(k=>k.kind!=="XyzMaterial").forEach(k=>{var ae;if(k.kind==="XyzMaterial")return;const K=(ae=k.monsterCategories)!=null&&ae.union(zt).length?"ExtraDeck":"Deck";q[K][k.kind].push(k)}),Object.values(q).forEach(k=>Object.values(k).forEach(K=>K.sort(ra)))},l=_()==="List"?new Promise(j=>{w(t()),j()}):Promise.resolve(),L=()=>(_()==="Deck"&&(w(v()),D(A,v().length)),q),I=(j,k,K)=>{v(v().filter(ae=>P(ae)!==k||ae.kind!==K&&K))},R=(j,k)=>{try{if(j.ctrlKey){v().push(k);return}const K=v().filter(xe=>xe.name===k.name).length;if(K>2)return;const ae=j.shiftKey?3-K:1;if(ae<1)return;v().push(...Array(ae).fill(k))}finally{v().sort(ra),v(v())}},W=(j,k)=>{let K=0;v(v().filter(ae=>ae.name!==k.name?!0:(K++,!j.shiftKey&&K>1))),v().sort(ra)};let A=we(100);const Y=()=>{e(A)>t().length+v().length||(D(A,e(A)+10),Mt(100).then(Y))};Mt(100).then(Y);const te=(j,k)=>{if(!b())return!0;if(!b().cardKinds.includes(j.kind)||b().name.trim().length&&[j.name,...j.nameTags??[],...j.textTags??[]].every(ae=>!ae.includes(b().name))||j.isForTest&&!b().others.includes("test"))return!1;if(j.kind==="Monster")return j.attributes&&!b().monsterAttributes.union(j.attributes).length||j.types&&!b().monsterTypes.union(j.types).length||!j.monsterCategories?!1:j.monsterCategories.union(b().monsterCategories).length;if(j.kind==="Spell")return j.spellCategory&&b().spellCategories.includes(j.spellCategory);if(j.kind==="Trap")return j.trapCategory&&b().trapCategories.includes(j.trapCategory)};it();var ne=ui(),Te=a(ne);ht(Te,()=>l,j=>{var k=_i();r(j,k)},j=>{var k=Me();const K=ce(L);var ae=H(k);ie(ae,1,()=>sr,oe,(xe,Z)=>{var _e=ci();const V=ce(()=>Object.values(e(K)[e(Z)]).flatMap(U=>U));var pe=a(_e),X=a(pe),z=a(X),re=s(X,2);{var ve=U=>{var M=si(),G=a(M);ke("click",G,J=>I(J,e(Z),void 0)),r(U,M)};y(re,U=>{_()==="Deck"&&e(V).some(te)&&U(ve)})}var be=s(pe,2);ie(be,1,()=>oa(e(K)[e(Z)]).filter(U=>d[e(Z)].includes(U)),oe,(U,M)=>{var G=di();const J=ce(()=>e(K)[e(Z)][e(M)].filter(te));var Ee=a(G),S=a(Ee),le=a(S),de=s(S,2);{var se=T=>{var x=ii(),F=a(x);ke("click",F,h=>I(h,e(Z),e(M))),r(T,x)};y(de,T=>{_()==="Deck"&&e(J).length&&T(se)})}var p=s(Ee,2);ie(p,5,()=>e(J),oe,(T,x,F)=>{var h=Me(),g=H(h);{var Q=he=>{var Se=vi(),ge=a(Se),ue=a(ge),$=a(ue),N=a($),ye=s($,2),$e=a(ye),Re=a($e);{var Ye=O=>{var Ce=li(),Ne=H(Ce);{var We=De=>{var He=rt();u(()=>f(He,`★${e(x).level??""}`)),r(De,He)};y(Ne,De=>{e(x).level&&De(We)})}var Ue=s(Ne,2);{var Ke=De=>{var He=rt();u(()=>f(He,`☆${e(x).rank??""}`)),r(De,He)};y(Ue,De=>{e(x).rank&&De(Ke)})}var vt=s(Ue,2);ie(vt,1,()=>e(x).attributes??[],oe,(De,He)=>{var qe=ni();u(()=>Ae(qe,`monster_attr ${e(He)??""} svelte-swqq02`)),r(De,qe)});var dt=s(vt,2);ie(dt,1,()=>e(x).types??[],oe,(De,He)=>{var qe=rt();u(()=>f(qe,Vt[e(He)])),r(De,qe)});var tt=s(dt,2);ie(tt,1,()=>e(x).monsterCategories??[],oe,(De,He)=>{var qe=rt();u(()=>f(qe,Qt[e(He)])),r(De,qe)}),r(O,Ce)};y(Re,O=>{e(x).kind==="Monster"&&O(Ye)})}var Be=s(Re,2);{var Ie=O=>{var Ce=rt();u(()=>f(Ce,`${Zt[e(x).spellCategory]??""}魔法`)),r(O,Ce)};y(Be,O=>{e(x).spellCategory!==void 0&&O(Ie)})}var ze=s(Be,2);{var E=O=>{var Ce=rt();u(()=>f(Ce,`${Jt[e(x).trapCategory]??""}罠`)),r(O,Ce)};y(ze,O=>{e(x).trapCategory!==void 0&&O(E)})}var C=s($e,4),m=a(C);{var B=O=>{var Ce=oi(),Ne=H(Ce),We=a(Ne),Ue=s(Ne,2),Ke=a(Ue);u(()=>{f(We,e(x).attack??"?"),f(Ke,e(x).defense??"?")}),r(O,Ce)};y(m,O=>{e(x).kind==="Monster"&&O(B)})}var me=s(ge,2),je=s(me,2);u(O=>{Ae(ge,`${O??""} svelte-swqq02`),f(N,e(x).name)},[()=>{var O,Ce;return`deck_editor_card duel_card ${e(x).kind} ${(Ce=(O=e(x))==null?void 0:O.monsterCategories)==null?void 0:Ce.join(" ")} ${e(x).isImplemented?"is_implemented":"is_not_implemented"}`}],ce),ke("mouseenter",ge,()=>c()(e(x))),ke("click",me,O=>R(O,e(x))),ke("click",je,O=>W(O,e(x))),r(he,Se)};y(g,he=>{F<e(A)&&he(Q)})}r(T,h)}),u(()=>f(le,`${Ia[e(M)]??""}（${e(J).length??""} / ${e(K)[e(Z)][e(M)].length??""}枚）`)),r(U,G)}),u(U=>f(z,`${rr[e(Z)]??""}（${U??""} / ${e(V).length??""}枚）`),[()=>e(V).filter(te).length],ce),r(xe,_e)}),r(j,k)}),r(o,ne),nt()}var fi=n('<div class="duel_card_info_row svelte-rccxcp" style="position:sticky; top:0;"><div class="svelte-rccxcp"> </div> <div class="svelte-rccxcp"> </div></div>'),pi=n('<div class="duel_card_info_row svelte-rccxcp"><div class="svelte-rccxcp"><pre class="description svelte-rccxcp"> </pre></div></div> <div class="duel_card_info_row svelte-rccxcp" style=" justify-content: space-between;"><div class="svelte-rccxcp"> </div> <div class="svelte-rccxcp"> </div></div>',1),gi=n('<div></div> <div class="svelte-rccxcp"> </div>',1),mi=n("<div> </div>"),bi=n("<div> </div>"),hi=n('<div class="duel_card_info_row svelte-rccxcp"><!> <!></div> <div class="duel_card_info_row svelte-rccxcp"></div>',1),yi=n('<div class="duel_card_row svelte-rccxcp"><div class="svelte-rccxcp"></div> <div class="svelte-rccxcp"> </div></div>'),ki=n('<div class="duel_card_row svelte-rccxcp"><div class="svelte-rccxcp"></div> <div class="svelte-rccxcp"> </div></div>'),wi=n('<div class="duel_card_info_row svelte-rccxcp"><div class="svelte-rccxcp">※テスト用カードです</div></div>'),xi=n('<div class="duel_card_info_links svelte-rccxcp"><a target="_blank" rel="noopener noreferrer" title="遊戯王カードWiki" class="svelte-rccxcp">⇒遊戯王カードWiki</a> <a target="_blank" rel="noopener noreferrer" title="コナミカードデータベース" class="svelte-rccxcp"> </a></div>'),Ci=n('<div><div class="duel_card_info_header svelte-rccxcp"><div class="duel_card_info_row svelte-rccxcp"><div class="svelte-rccxcp"> </div></div> <!></div> <div class="duel_card_info_body svelte-rccxcp"><!> <!> <div class="duel_card_info_row description svelte-rccxcp"><div class="svelte-rccxcp"><pre class="description svelte-rccxcp"> </pre></div></div> <!></div></div>');function Di(o,i){st(i,!1);let t=Le(i,"cardInfo",8,void 0);const v=()=>t()?bt[t().name]:void 0;it();var _=Me(),c=H(_);{var b=d=>{var q=Ci(),P=a(q),w=a(P),l=a(w),L=a(l),I=s(w,2);{var R=V=>{var pe=fi(),X=a(pe),z=a(X),re=s(X,2),ve=a(re);u((be,U)=>{f(z,be),f(ve,U)},[()=>"★".repeat(t().level||0),()=>"☆".repeat(t().rank||0)],ce),r(V,pe)};y(I,V=>{t().kind==="Monster"&&V(R)})}var W=s(P,2),A=a(W);{var Y=V=>{var pe=pi(),X=H(pe),z=a(X),re=a(z),ve=a(re),be=s(X,2),U=a(be),M=a(U),G=s(U,2),J=a(G);u(()=>{f(ve,bt[t().name].pendulumDescription),f(M,`◀ ${t().pendulumScaleL??""}`),f(J,`${t().pendulumScaleR??""} ▶`)}),r(V,pe)};y(A,V=>{var pe;(pe=t().monsterCategories)!=null&&pe.includes("Pendulum")&&V(Y)})}var te=s(A,2);{var ne=V=>{var pe=hi(),X=H(pe),z=a(X);{var re=M=>{var G=gi(),J=H(G),Ee=s(J,2),S=a(Ee);u(()=>{Ae(J,`monster_attr ${t().attributes[0]??""} svelte-rccxcp`),f(S,`${va[t().attributes[0]]??""}属性`)}),r(M,G)};y(z,M=>{t().attributes&&M(re)})}var ve=s(z,2);{var be=M=>{var G=mi(),J=a(G);u(()=>{Ae(G,`monster_cat ${t().types[0]??""} svelte-rccxcp`),f(J,`${Vt[t().types[0]]??""}${da[t().types[0]]??""}族`)}),r(M,G)};y(ve,M=>{t().types&&M(be)})}var U=s(X,2);ie(U,5,()=>t().monsterCategories??[],oe,(M,G)=>{var J=bi(),Ee=a(J);u(()=>{Ae(J,`monster_cat ${e(G)??""} svelte-rccxcp`),f(Ee,`${Qt[e(G)]??""}${ca[e(G)]??""}`)}),r(M,J)}),r(V,pe)},Te=V=>{var pe=Me(),X=H(pe);{var z=ve=>{var be=yi(),U=s(a(be),2),M=a(U);u(()=>f(M,`${Zt[t().spellCategory]??""}魔法`)),r(ve,be)},re=ve=>{var be=Me(),U=H(be);{var M=G=>{var J=ki(),Ee=s(a(J),2),S=a(Ee);u(()=>f(S,`${Jt[t().trapCategory]??""}罠`)),r(G,J)};y(U,G=>{t().kind==="Trap"&&t().trapCategory&&G(M)},!0)}r(ve,be)};y(X,ve=>{t().kind==="Spell"&&t().spellCategory?ve(z):ve(re,!1)},!0)}r(V,pe)};y(te,V=>{t().kind==="Monster"?V(ne):V(Te,!1)})}var j=s(te,2),k=a(j),K=a(k),ae=a(K),xe=s(j,2);{var Z=V=>{var pe=wi();r(V,pe)},_e=V=>{var pe=xi(),X=a(pe),z=s(X,2),re=a(z);u(ve=>{pt(X,"href",`https://yugioh-wiki.net/index.php?${t().wikiEncodedName}`),pt(z,"href",ve),f(re,`⇒${(t().cardId?"公式カードページ":"公式で検索")??""}`)},[()=>ir(t())],ce),r(V,pe)};y(xe,V=>{t().isForTest?V(Z):V(_e,!1)})}u((V,pe)=>{Ae(q,`duel_card duel_card_info ${t().kind??""} ${V??""} svelte-rccxcp`),f(L,t().name),f(ae,pe)},[()=>{var V;return(V=t().monsterCategories)==null?void 0:V.join(" ")},()=>{var V;return(V=v())==null?void 0:V.description}],ce),r(d,q)};y(c,d=>{t()&&d(b)})}r(o,_),nt()}const $i={0:{aaa:"日",aaaa:"日曜日",ddd:"Sun",dddd:"Sunday"},1:{aaa:"月",aaaa:"月曜日",ddd:"Mon",dddd:"Monday"},2:{aaa:"火",aaaa:"火曜日",ddd:"Tue",dddd:"Tuesday"},3:{aaa:"水",aaaa:"水曜日",ddd:"Wed",dddd:"Wednesday"},4:{aaa:"木",aaaa:"木曜日",ddd:"Thu",dddd:"Thursday"},5:{aaa:"金",aaaa:"金曜日",ddd:"Fri",dddd:"Friday"},6:{aaa:"土",aaaa:"土曜日",ddd:"Sat",dddd:"Saturday"}};class Si{constructor(){Ze(this,"DefaultSeparator1","/");Ze(this,"DefaultSeparator2"," ");Ze(this,"DefaultSeparator3",":");Ze(this,"createDate",i=>{if(!i)return;const t=new Date(i);if(!isNaN(t.getTime()))return t});Ze(this,"createDateOr",(i,t)=>this.createDate(i)||t||new Date);Ze(this,"truncateDate",i=>{const t=i||new Date;return new Date(t.getFullYear(),t.getMonth(),t.getDate())});Ze(this,"addDate",(i,t)=>{const v=this.createDateOr(i);return v.setDate(v.getDate()+t),v});Ze(this,"addMonth",(i,t)=>{const v=this.createDateOr(i);return v.setMonth(v.getMonth()+t),v});Ze(this,"addYear",(i,t)=>{const v=this.createDateOr(i);return v.setFullYear(v.getFullYear()+t),v});Ze(this,"getDayOfWeek",(i,t="dddd")=>{const v=this.createDate(i);return v?$i[v.getDay()][t]:""});Ze(this,"formatToYYYYMMDD",(i,t=this.DefaultSeparator1)=>{const v=this.createDate(i);if(!v)return"";const _=v.getFullYear().toString(),c=("0"+(v.getMonth()+1)).slice(-2),b=("0"+v.getDate()).slice(-2);return _+t+c+t+b});Ze(this,"formatToYYYYMM",(i,t=this.DefaultSeparator1)=>{const v=this.createDate(i);if(!v)return"";t||(t="");const _=v.getFullYear().toString(),c=("0"+(v.getMonth()+1)).slice(-2);return _+t+c});Ze(this,"formatToHHMMSS",(i,t=this.DefaultSeparator3)=>{const v=this.createDate(i);if(!v)return"";t||(t="");const _=v.getHours(),c=v.getMinutes(),b=v.getSeconds();return("0"+_).slice(-2)+t+("0"+c).slice(-2)+t+("0"+b).slice(-2)});Ze(this,"formatToHHMM",(i,t=this.DefaultSeparator3)=>{const v=this.createDate(i);if(!v)return"";t||(t="");const _=("0"+v.getHours()).slice(-2),c=("0"+v.getMinutes()).slice(-2);return _+t+c});Ze(this,"formatToYYYYMMDD_HHMM",(i,t=this.DefaultSeparator1,v=this.DefaultSeparator2,_=this.DefaultSeparator3)=>{const c=this.createDate(i);return c?this.formatToYYYYMMDD(c,t)+v+this.formatToHHMM(c,_):""});Ze(this,"formatToYYYYMMDD_HHMMSS",(i,t=this.DefaultSeparator1,v=this.DefaultSeparator2,_=this.DefaultSeparator3)=>{const c=this.createDate(i);return c?this.formatToYYYYMMDD(c,t)+v+this.formatToHHMMSS(c,_):""})}}const ct=new Si;Date.prototype.truncateDate=function(){return ct.truncateDate(this)};Date.prototype.getCloneOr=function(o){return ct.createDateOr(this,o)};Date.prototype.addDate=function(o){return ct.addDate(this,o)};Date.prototype.addMonth=function(o){return ct.addDate(this,o)};Date.prototype.addYear=function(o){return ct.addDate(this,o)};Date.prototype.getDayOfWeek=function(o="dddd"){return ct.getDayOfWeek(this,o)};Date.prototype.formatToYYYYMM=function(o){return ct.formatToYYYYMM(this,o)};Date.prototype.formatToYYYYMMDD=function(o){return ct.formatToYYYYMMDD(this,o)};Date.prototype.formatToYYYYMMDD_HHMM=function(o,i,t){return ct.formatToYYYYMMDD_HHMM(this,o,i,t)};Date.prototype.formatToYYYYMMDD_HHMMSS=function(o,i,t){return ct.formatToYYYYMMDD_HHMMSS(this,o,i,t)};Date.prototype.formatToHHMM=function(o){return ct.formatToHHMM(this,o)};Date.prototype.formatToHHMMSS=function(o){return ct.formatToHHMMSS(this,o)};var Mi=n('<li class="deck_info_list_item svelte-2wdgc8"><div class="svelte-2wdgc8"> </div> <div class="svelte-2wdgc8"> </div> <div class="svelte-2wdgc8"> </div></li>'),Ti=n('<ul class="deck_info_list svelte-2wdgc8"></ul>'),ji=n('<label for="file_selector" class="upload_area svelte-2wdgc8" role="region" aria-label="ファイルアップロードエリア"><div class="upload_area_message svelte-2wdgc8">ここにファイルをドロップ</div> <div class="upload_area_footer svelte-2wdgc8"><input type="file" id="file_selector" name="file_selector" accept=".json" multiple></div></label>'),Ei=n('<div slot="body" class="modal_body svelte-2wdgc8"><!></div>'),qi=n('<button class="svelte-2wdgc8">追加</button> <button class="svelte-2wdgc8">削除して追加</button> <button class="svelte-2wdgc8">戻る</button>',1),Ai=n('<button class="svelte-2wdgc8">Cancel</button>'),Yi=n('<div slot="footer" class="modal_window_footer svelte-2wdgc8"><!></div>');function Bi(o,i){st(i,!1);let t=Le(i,"eventHolder",8),v=Le(i,"args",8),_=Le(i,"resolve",8),c=we(Promise.resolve([])),b=we();const d=()=>{D(b,new DataTransfer().files),D(c,Promise.resolve([]))},q=async I=>{I.preventDefault(),console.log("hoge",I)},P=async I=>{I.preventDefault(),I.dataTransfer&&l(I.dataTransfer.files)},w=()=>{l(e(b))},l=async I=>{if(!I.length)return;const R=[],W=[];for(const A of I)try{W.push(...await ft.createfromJson(A))}catch(Y){Y instanceof Error&&R.push(Y.message)}if(R.length){console.log(...R);return}D(c,e(c).then(()=>W))},L=d;it(),nr(o,{get eventHolder(){return t()},get args(){return v()},$$slots:{body:(I,R)=>{var W=Ei(),A=a(W);ht(A,()=>e(c),null,(Y,te)=>{var ne=Me(),Te=H(ne);{var j=K=>{var ae=Ti();ie(ae,5,()=>e(te),oe,(xe,Z)=>{var _e=Mi(),V=a(_e),pe=a(V),X=s(V,2),z=a(X),re=s(X,2),ve=a(re);u((be,U,M)=>{f(pe,e(Z).name),f(z,`${be??""}
                /
                ${U??""}`),f(ve,`最終使用日時 ： ${M??""}`)},[()=>e(Z).cardNames.filter(be=>v().mainCardNames.includes(be)).length,()=>e(Z).cardNames.filter(be=>v().exCardNames.includes(be)).length,()=>e(Z).lastUsedAt.formatToYYYYMMDD_HHMM("/"," ",":")],ce),r(xe,_e)}),r(K,ae)},k=K=>{var ae=ji(),xe=s(a(ae),2),Z=a(xe);lr(Z,()=>e(b),_e=>D(b,_e)),ke("change",Z,w),ke("cancel",Z,L),ke("drop",ae,P),ke("dragover",ae,q),r(K,ae)};y(Te,K=>{e(te).length?K(j):K(k,!1)})}r(Y,ne)}),r(I,W)},footer:(I,R)=>{var W=Yi(),A=a(W);ht(A,()=>e(c),null,(Y,te)=>{var ne=Me(),Te=H(ne);{var j=K=>{var ae=qi(),xe=H(ae),Z=s(xe,2),_e=s(Z,2);u(()=>{xe.disabled=e(te).length===0,Z.disabled=e(te).length===0}),ke("click",xe,()=>_()({deckInfos:e(te),replaceAll:!1})),ke("click",Z,()=>_()({deckInfos:e(te),replaceAll:!0})),ke("click",_e,L),r(K,ae)},k=K=>{var ae=Me(),xe=H(ae);{var Z=_e=>{var V=Ai();ke("click",V,()=>_()(void 0)),r(_e,V)};y(xe,_e=>{v().cancelable&&_e(Z)},!0)}r(K,ae)};y(Te,K=>{e(te).length?K(j):K(k,!1)})}r(Y,ne)}),r(I,W)}}}),nt()}const Xt=class Xt extends vr{constructor(i,t){super(i,...Object.values(t))}};Ze(Xt,"createModalController",i=>{const t={deckUploader:new dr({title:"デッキ情報をアップロード",position:"Middle",cancelable:!1,mainCardNames:[],exCardNames:[]})};return Object.assign(new Xt(i,t),t)});let la=Xt;function Ni(o,i){st(i,!1);let t=Le(i,"modalController",8);it(),or(o,{get modalController(){return t()},children:(v,_)=>{var c=Me(),b=H(c);{var d=q=>{Bi(q,{get eventHolder(){return t().eventHolder},get args(){return t().deckUploader.args},get resolve(){return t().deckUploader.resolve}})};y(b,q=>{t().deckUploader.state==="Shown"&&q(d)})}r(v,c)},$$slots:{default:!0}}),nt()}var Ii=n('<label><input type="checkbox"> </label>'),Ui=n('<label><input type="checkbox"> </label>'),Fi=n('<label><input type="checkbox"> <div style="display: inline-block;"></div> </label>'),Hi=n('<label><input type="checkbox"> </label>'),Pi=n('<div class="deck_editor_search_box_row svelte-1s1plv5"><div class="svelte-1s1plv5"><button class="search_condition_title black_button svelte-1s1plv5">モンスター</button></div> <div class="svelte-1s1plv5"></div></div> <div class="deck_editor_search_box_row svelte-1s1plv5"><div class="svelte-1s1plv5"><button class="search_condition_title black_button svelte-1s1plv5">属性</button></div> <div class="svelte-1s1plv5"></div></div> <div class="deck_editor_search_box_row svelte-1s1plv5"><div class="svelte-1s1plv5"><button class="search_condition_title black_button svelte-1s1plv5">種族</button></div> <div class="svelte-1s1plv5"></div></div>',1),Oi=n('<label><input type="checkbox"> </label>'),Li=n('<div class="deck_editor_search_box_row svelte-1s1plv5"><div class="svelte-1s1plv5"><button class="search_condition_title black_button svelte-1s1plv5">魔法</button></div> <div class="svelte-1s1plv5"></div></div>'),Ri=n('<label><input type="checkbox"> </label>'),Wi=n('<div class="deck_editor_search_box_row svelte-1s1plv5"><div class="svelte-1s1plv5"><button class="search_condition_title black_button svelte-1s1plv5">罠</button></div> <div class="svelte-1s1plv5"></div></div>'),Ki=n('<label><input type="checkbox"> </label>'),zi=n("<option> </option>"),Gi=n('<div class="svelte-1s1plv5"><a class="white_button svelte-1s1plv5" download="SVS_DeckInfos.json">ダウンロード</a></div>'),Xi=n('<div class="svelte-1s1plv5"></div>'),Vi=n('<div class="svelte-1s1plv5"><a class="white_button svelte-1s1plv5" download="SVS_DeckInfos.json">ダウンロード(一括)</a></div>'),Qi=n('<div class="svelte-1s1plv5"></div>'),Zi=n('<div class="deck_editor_body_right_header svelte-1s1plv5"><div class="deck_editor_body_right_header_row svelte-1s1plv5"><div class="svelte-1s1plv5">編集対象 <select></select></div> <div class="svelte-1s1plv5"></div> <div class="svelte-1s1plv5">新規名称 <input type="text"></div></div> <div class="deck_editor_body_right_header_row svelte-1s1plv5"></div> <div class="deck_editor_body_right_header_row svelte-1s1plv5"><div class="svelte-1s1plv5">基本操作</div> <div class="svelte-1s1plv5"><button class="white_button svelte-1s1plv5">デッキを保存</button></div> <div class="svelte-1s1plv5"></div> <div class="svelte-1s1plv5"><button class="white_button svelte-1s1plv5">デッキを複製</button></div> <div class="svelte-1s1plv5"><button class="white_button svelte-1s1plv5" title="shiftキー押下で確認メッセージスキップ">デッキを削除</button></div></div> <div class="deck_editor_body_right_header_row svelte-1s1plv5"><div class="svelte-1s1plv5">DL/UL</div> <!> <!> <div class="svelte-1s1plv5"><button class="white_button svelte-1s1plv5">アップロード</button></div></div></div> <!>',1),Ji=n("<div>デッキ情報読込中</div>"),en=n('<div class="deck_editor svelte-1s1plv5"><div class="deck_editor_header"></div> <div class="deck_editor_body svelte-1s1plv5"><div class="deck_editor_body_left svelte-1s1plv5"><div role="contentinfo"><div class="deck_editor_search_box_header svelte-1s1plv5"><div>検索条件</div> <div><button class="white_button svelte-1s1plv5">条件クリア</button></div></div> <div class="deck_editor_search_box_row svelte-1s1plv5"><div class="svelte-1s1plv5">名称</div> <div class="svelte-1s1plv5"><input type="text" style="width:70%"> <button class="white_button svelte-1s1plv5">クリア</button> <span>※ルビには対応していません</span></div></div> <div class="deck_editor_search_box_row svelte-1s1plv5"><div class="svelte-1s1plv5"><button class="search_condition_title black_button svelte-1s1plv5">種類</button></div> <div class="svelte-1s1plv5"></div></div> <!> <!> <!> <div class="deck_editor_search_box_row svelte-1s1plv5"><div class="svelte-1s1plv5"><button class="search_condition_title black_button svelte-1s1plv5">その他</button></div> <div class="svelte-1s1plv5"></div></div></div> <!></div> <div class="deck_editor_body_center svelte-1s1plv5"><!></div> <div class="deck_editor_body_right svelte-1s1plv5"><!></div></div> <div class="footer svelte-1s1plv5"></div></div> <!>',1);function tn(o,i){st(i,!1);const t=[],v=[],_=[],c=[],b=[],d=[],q=[],P=la.createModalController({onDragStart:{append:()=>{},remove:()=>{}},onDragEnd:{append:()=>{},remove:()=>{}}}),w={name:"",cardKinds:wa.filter(E=>E!=="XyzMaterial"),monsterCategories:[...Sa],monsterAttributes:[...$a],monsterTypes:[...Da],spellCategories:[...Ca],trapCategories:[...xa],others:["test"]},l=we(structuredClone(w));Oe(l,e(l).others=[]);let L=we("SearchCondition");const I=async()=>{Oe(l,e(l).name=""),Oe(l,e(l).cardKinds=[]),Oe(l,e(l).monsterCategories=[]),Oe(l,e(l).monsterAttributes=[]),Oe(l,e(l).monsterTypes=[]),Oe(l,e(l).spellCategories=[]),Oe(l,e(l).trapCategories=[]),Oe(l,e(l).others=[])},R=async E=>{Array.isArray(e(l)[E])&&Array.isArray(w[E])&&Oe(l,e(l)[E]=e(l)[E].length?[]:[...w[E]])},W=(E,C,m)=>{Array.isArray(e(l)[C])&&Array.isArray(w[C])&&Oe(l,e(l)[C]=[m])},A=async()=>{const C=(await e(ne)).find(m=>m.id===e(te));C&&D(k,{...C,cardInfos:C.cardNames.map(m=>bt[m])})},Y=()=>ft.getAllDeckInfo().then(E=>(D(te,(E.find(C=>C.lastUsedAt.getTime()===Math.max(...E.map(m=>m.lastUsedAt.getTime())))??E[0]).id),E));let te=we(-1),ne=we(Y()),Te=we(e(ne).then(E=>ft.convertToObjectURL(E)));e(ne).then(A);const j=()=>{D(ne,Y()),D(Te,e(ne).then(E=>ft.convertToObjectURL(E))),A()};let k=we({id:-Number.MAX_VALUE,name:"",description:"",lastUsedAt:new Date,cardInfos:[]}),K=we(bt.ゾンビーノ);const ae=E=>{D(L,"CardDetail"),D(K,E)},xe=async()=>{const C=(await e(ne)).find(m=>m.id===e(te));if(!C)throw new Error("illegal state");return C},Z=async()=>{const E=await xe();await E.saveDeckInfo({...E,name:e(k).name,cardNames:e(k).cardInfos.map(C=>C.name),lastUsedAt:new Date}),j()},_e=async()=>{(await ft.createNewDeck(`デッキ_${new Date().formatToYYYYMMDD_HHMMSS("","","")}`,`コピー日時：${new Date().formatToYYYYMMDD_HHMMSS("-"," ",":")}`,e(k).cardInfos.map(C=>C.name))).saveDeckInfo(),j()},V=async E=>{const C=await xe();!E.shiftKey&&!confirm(`デッキ【${C.name}】を削除します。
よろしいですか？`)||(await C.delete(),j())},pe=async()=>{const E=await P.deckUploader.show({title:"デッキ情報アップロード",position:"Middle",cancelable:!0,mainCardNames:Object.values(bt).filter(m=>{var B;return!((B=m.monsterCategories)!=null&&B.union(zt).length)}).map(m=>m.name),exCardNames:Object.values(bt).filter(m=>{var B;return(B=m.monsterCategories)==null?void 0:B.union(zt).length}).map(m=>m.name)});if(!E)return;const C=[];if(E.replaceAll){if(!confirm(`既存デッキ情報を全て削除し、アップロードしたファイルに置き換えます。
よろしいですか？`))return;C.push(...(await e(ne)).map(m=>m.id))}await Promise.all(E.deckInfos.map(m=>ft.createNewDeck(m.name,m.description,m.cardNames,m.lastUsedAt))),C.length&&await Promise.all(C.map(ft.remove)),j()};it();var X=en(),z=H(X),re=s(a(z),2),ve=a(re),be=a(ve),U=a(be),M=s(a(U),2),G=a(M),J=s(U,2),Ee=s(a(J),2),S=a(Ee),le=s(S,2),de=s(J,2),se=a(de),p=a(se),T=s(se,2);ie(T,5,()=>wa.filter(E=>E!=="XyzMaterial"),oe,(E,C)=>{var m=Ii(),B=a(m),me,je=s(B);u(()=>{me!==(me=e(C))&&(B.value=(B.__value=e(C))==null?"":e(C)),f(je,` ${Ia[e(C)]??""}`)}),Dt(t,[],B,()=>(e(C),e(l).cardKinds),O=>Oe(l,e(l).cardKinds=O)),r(E,m)});var x=s(de,2);{var F=E=>{var C=Pi(),m=H(C),B=a(m),me=a(B),je=s(B,2);ie(je,5,()=>Sa,oe,(tt,De)=>{var He=Ui(),qe=a(He),Ve,Je=s(qe);u(()=>{Ve!==(Ve=e(De))&&(qe.value=(qe.__value=e(De))==null?"":e(De)),f(Je,` ${Qt[e(De)]??""}${ca[e(De)]??""}`)}),Dt(v,[],qe,()=>(e(De),e(l).monsterCategories),lt=>Oe(l,e(l).monsterCategories=lt)),r(tt,He)});var O=s(m,2),Ce=a(O),Ne=a(Ce),We=s(Ce,2);ie(We,5,()=>$a,oe,(tt,De)=>{var He=Fi(),qe=a(He),Ve,Je=s(qe,2),lt=s(Je);u(()=>{Ve!==(Ve=e(De))&&(qe.value=(qe.__value=e(De))==null?"":e(De)),Ae(Je,`monster_attr ${e(De)??""} svelte-1s1plv5`),f(lt,` ${va[e(De)]??""}`)}),Dt(_,[],qe,()=>(e(De),e(l).monsterAttributes),yt=>Oe(l,e(l).monsterAttributes=yt)),r(tt,He)});var Ue=s(O,2),Ke=a(Ue),vt=a(Ke),dt=s(Ke,2);ie(dt,5,()=>Da,oe,(tt,De)=>{var He=Hi(),qe=a(He),Ve,Je=s(qe);u(()=>{Ve!==(Ve=e(De))&&(qe.value=(qe.__value=e(De))==null?"":e(De)),f(Je,` ${Vt[e(De)]??""}
                  ${da[e(De)]??""}`)}),Dt(c,[],qe,()=>(e(De),e(l).monsterTypes),lt=>Oe(l,e(l).monsterTypes=lt)),ke("dblclick",He,lt=>W(lt,"monsterTypes",e(De))),r(tt,He)}),ke("click",me,()=>R("monsterCategories")),ee(3,m,()=>fe,()=>({delay:0,duration:100})),ke("click",Ne,()=>R("monsterAttributes")),ee(3,O,()=>fe,()=>({delay:0,duration:100})),ke("click",vt,()=>R("monsterTypes")),ee(3,Ue,()=>fe,()=>({delay:0,duration:100})),r(E,C)};y(x,E=>{e(l).cardKinds.includes("Monster")&&E(F)})}var h=s(x,2);{var g=E=>{var C=Li(),m=a(C),B=a(m),me=s(m,2);ie(me,5,()=>Ca,oe,(je,O)=>{var Ce=Oi(),Ne=a(Ce),We,Ue=s(Ne);u(()=>{We!==(We=e(O))&&(Ne.value=(Ne.__value=e(O))==null?"":e(O)),f(Ue,` ${Zt[e(O)]??""}`)}),Dt(b,[],Ne,()=>(e(O),e(l).spellCategories),Ke=>Oe(l,e(l).spellCategories=Ke)),r(je,Ce)}),ke("click",B,()=>R("spellCategories")),ee(3,C,()=>fe,()=>({delay:0,duration:100})),r(E,C)};y(h,E=>{e(l).cardKinds.includes("Spell")&&E(g)})}var Q=s(h,2);{var he=E=>{var C=Wi(),m=a(C),B=a(m),me=s(m,2);ie(me,5,()=>xa,oe,(je,O)=>{var Ce=Ri(),Ne=a(Ce),We,Ue=s(Ne);u(()=>{We!==(We=e(O))&&(Ne.value=(Ne.__value=e(O))==null?"":e(O)),f(Ue,` ${Jt[e(O)]??""}`)}),Dt(d,[],Ne,()=>(e(O),e(l).trapCategories),Ke=>Oe(l,e(l).trapCategories=Ke)),r(je,Ce)}),ke("click",B,()=>R("trapCategories")),ee(3,C,()=>fe,()=>({delay:0,duration:100})),r(E,C)};y(Q,E=>{e(l).cardKinds.includes("Trap")&&E(he)})}var Se=s(Q,2),ge=a(Se),ue=a(ge),$=s(ge,2);ie($,4,()=>[{key:"test",text:"テスト用カードを表示する"}],oe,(E,C)=>{var m=Ki(),B=a(m),me,je=s(B);u(()=>{me!==(me=C.key)&&(B.value=(B.__value=C.key)==null?"":C.key),f(je,` ${C.text??""}`)}),Dt(q,[],B,()=>(C.key,e(l).others),O=>Oe(l,e(l).others=O)),r(E,m)});var N=s(be,2);Di(N,{get cardInfo(){return e(K)}});var ye=s(ve,2),$e=a(ye);const Re=ce(()=>Object.values(bt));Ba($e,{mode:"List",get allCardInfos(){return e(Re)},onAttention:ae,get searchCondition(){return e(l)},get deckCardInfos(){return e(k).cardInfos},set deckCardInfos(E){Oe(k,e(k).cardInfos=E)},$$legacy:!0});var Ye=s(ye,2),Be=a(Ye);ht(Be,()=>e(ne),E=>{var C=Ji();r(E,C)},(E,C)=>{var m=Zi(),B=H(m),me=a(B),je=a(me),O=s(a(je));u(()=>{e(te),At(()=>{e(C)})}),ie(O,5,()=>e(C),oe,(Ge,Fe)=>{var Pe=zi(),Xe={},Qe=a(Pe);u(()=>{Xe!==(Xe=e(Fe).id)&&(Pe.value=(Pe.__value=e(Fe).id)==null?"":e(Fe).id),f(Qe,e(Fe).name)}),r(Ge,Pe)});var Ce=s(je,4),Ne=s(a(Ce)),We=s(me,4),Ue=s(a(We),2),Ke=a(Ue),vt=s(Ue,4),dt=a(vt),tt=s(vt,2),De=a(tt),He=s(We,2),qe=s(a(He),2);ht(qe,xe,Ge=>{var Fe=Xi();r(Ge,Fe)},(Ge,Fe)=>{var Pe=Gi(),Xe=a(Pe);u(Qe=>pt(Xe,"href",Qe),[()=>ft.convertToObjectURL([e(Fe)])],ce),r(Ge,Pe)});var Ve=s(qe,2);ht(Ve,()=>e(Te),Ge=>{var Fe=Qi();r(Ge,Fe)},(Ge,Fe)=>{var Pe=Vi(),Xe=a(Pe);u(()=>pt(Xe,"href",e(Fe))),r(Ge,Pe)});var Je=s(Ve,2),lt=a(Je),yt=s(B,2);Ba(yt,{mode:"Deck",allCardInfos:[],onAttention:ae,get deckCardInfos(){return e(k).cardInfos},set deckCardInfos(Ge){Oe(k,e(k).cardInfos=Ge)},$$legacy:!0}),Yt(O,()=>e(te),Ge=>D(te,Ge)),ke("change",O,A),sa(Ne,()=>e(k).name,Ge=>Oe(k,e(k).name=Ge)),ke("click",Ke,Z),ke("click",dt,_e),ke("click",De,V),ke("click",lt,pe),r(E,m)});var Ie=s(re,2);Ie.textContent=`実装済カード${cr+Ma}枚（内、効果のないモンスター${Ma??""}枚）`;var ze=s(z,2);Ni(ze,{modalController:P}),u(()=>Ae(be,`deck_editor_search_box ${(e(L)==="SearchCondition"?"":"minimum")??""} svelte-1s1plv5`)),ke("click",G,I),sa(S,()=>e(l).name,E=>Oe(l,e(l).name=E)),ke("click",le,()=>Oe(l,e(l).name="")),ke("click",p,()=>R("cardKinds")),ke("click",ue,()=>R("others")),ee(3,Se,()=>fe,()=>({delay:0,duration:100})),ke("mouseenter",be,()=>D(L,"SearchCondition")),r(o,X),nt()}String.prototype.format=(o,...i)=>{for(const[t,v]of i.entries()){const _=new RegExp(`\\{${t}\\}`,"g");o=o.replace(_,v)}return o};String.prototype.toSnakeCase=function(){return this.split(/(?=[A-Z])/).join("_").toLowerCase()};const an=["TblDeckHeader","TblDeckDetail","TblDuelistProfile"],rn=3;var sn=n('<input class="game_mode_radio svelte-abgng1" type="radio" name="game_mode"> <label> </label>',1),nn=n('<option class="svelte-abgng1"> </option>'),ln=n('<option class="svelte-abgng1"> </option>'),on=n('<option class="svelte-abgng1"> </option>'),vn=n('<tr class="config_row svelte-abgng1"><td class="svelte-abgng1"><div class="svelte-abgng1"><label for="npc_deck_selector" class="config_row_label deck_selector svelte-abgng1">デッキ：</label></div></td><td class="svelte-abgng1"><div class="svelte-abgng1"><select id="npc_deck_selector" class="deck_selector svelte-abgng1"><option class="svelte-abgng1">デフォルト</option><!></select></div></td></tr>'),dn=n('<option class="svelte-abgng1"> </option>'),cn=n('<tr class="config_row svelte-abgng1"><td class="svelte-abgng1"><div class="svelte-abgng1"><label for="npc_selector" class="config_row_label npc_selector svelte-abgng1">対戦相手：</label></div></td><td class="svelte-abgng1"><div class="svelte-abgng1"><select id="npc_selector" class="npc_selector svelte-abgng1"></select> <div class="svelte-abgng1"> </div></div></td></tr> <!> <tr class="config_row svelte-abgng1"><td class="svelte-abgng1"><div class="svelte-abgng1"><label for="npc_selector" class="config_row_label npc_selector svelte-abgng1">先攻後攻：</label></div></td><td class="svelte-abgng1"><div class="svelte-abgng1"><select id="npc_selector" class="npc_selector svelte-abgng1"></select></div></td></tr>',1),_n=n('<option class="svelte-abgng1"> </option>'),un=n('<tr class="config_row svelte-abgng1"><td class="svelte-abgng1"><div class="svelte-abgng1"><label for="difficulty_selector" class="config_row_label difficulty_selector svelte-abgng1">難易度：</label></div></td><td class="svelte-abgng1"><div class="svelte-abgng1"><select id="difficulty_selector" class="difficulty_selector svelte-abgng1"></select></div></td></tr>'),fn=n('<tr class="config_row svelte-abgng1"><td class="svelte-abgng1"><div class="svelte-abgng1"><label class="config_row_label svelte-abgng1" for="game_mode_radio_preset">ゲームモード：</label></div></td><td class="svelte-abgng1"><div class="svelte-abgng1"></div></td></tr> <tr class="config_row svelte-abgng1"><td class="svelte-abgng1"><div class="svelte-abgng1"><label for="deck_selector" class="config_row_label deck_selector svelte-abgng1">デッキ：</label></div></td><td class="svelte-abgng1"><div class="svelte-abgng1"><select id="deck_selector" class="deck_selector svelte-abgng1"></select></div></td></tr> <!> <tr><td colspan="2" class="svelte-abgng1"><div><button class="btn svelte-abgng1">duel start!</button></div></td></tr>',1),pn=n('<tr><td colspan="2" class="svelte-abgng1"><div>デッキ情報の読み込み、もしくは作成中...</div></td></tr>'),gn=n('<tr><td colspan="2" class="svelte-abgng1"><div><button class="btn svelte-abgng1">deck edit</button></div></td></tr>'),mn=n('<tr class="config_row svelte-abgng1"><td class="svelte-abgng1"><div class="svelte-abgng1"><label for="duelist_name" class="config_row_label duelist_name svelte-abgng1">名前：</label></div></td><td class="svelte-abgng1"><div class="svelte-abgng1"><input id="duelist_name" class="duelist_name svelte-abgng1" type="text"></div></td></tr> <!> <!>',1),bn=n('<tr><td colspan="2" class="svelte-abgng1"><div>デュエリスト情報の読み込み、もしくは作成中...</div></td></tr>'),hn=n('<div class="app_body svelte-abgng1"><table class="config_table svelte-abgng1"><tbody><!></tbody></table></div>'),yn=n('<div class="result_title result_win svelte-abgng1">YOU WIN</div>'),kn=n('<div class="result_title result_lose svelte-abgng1">YOU LOSE</div>'),wn=n('<div class="result_title result_draw svelte-abgng1">DRAW</div>'),xn=n('<div class="twitter_share_button_wrapper svelte-abgng1"><a rel="nofollow" target="_blank" class="twitter_share_button svelte-abgng1">X(twitter)でシェアする</a></div>'),Cn=n('<div class="result svelte-abgng1"><!> <div class="reason_of_end svelte-abgng1"> </div> <!> <div class="svelte-abgng1"><button class="white_button svelte-abgng1">TOPへ戻る</button></div></div>'),Dn=n('<main style="flex-direction: column; display :flex" class="svelte-abgng1"><div class="link link_left svelte-abgng1"><a href="https://github.com/Setta238/stk_ygo_svelte" target="_blank" rel="noopener noreferrer" title="repository" class="svelte-abgng1">repository</a> <a href="https://x.com/ninja_no" target="_blank" rel="noopener noreferrer" title="repository" class="svelte-abgng1">X(Twitter)</a> <a href="https://posfie.com/@ninja_no/p/Lx7FLj3" target="_blank" rel="noopener noreferrer" title="posfie" class="svelte-abgng1">posfie(toggeter)</a></div> <div class="link link_right svelte-abgng1"><a class="a_button svelte-abgng1" role="button" tabindex="0">TOPへ戻る</a> <a href="/stk_ygo_svelte/note.html" target="_blank" rel="noopener noreferrer" title="repository" class="svelte-abgng1">現時点とこの先のこと</a></div> <!> <div class="debug_info svelte-abgng1"><span class="svelte-abgng1"> </span> <span class="user_agent_info svelte-abgng1"> </span> <span class="screen_info svelte-abgng1"> </span></div> <!></main>');function $n(o,i){st(i,!1);const t=new _r("stk_ygo_svelte",rn,an);let v=we(0),_=we(0),c=we(),b=we("FtkChallenge"),d=we("None"),q=we(0),P=we(""),w=we(void 0);const l="https://setta238.github.io/stk_ygo_svelte/",L="遊戯王deそりてあ",I="ninja_no",R=ur.getOrCreateNew(t).then(p=>(D(b,Ta.includes(p.previousGameMode)?p.previousGameMode:"FtkChallenge"),V(p.previousNpcId),p)),W=p=>{var x;const T=p.find(F=>F.lastUsedAt.getTime()===Math.max(...p.map(h=>h.lastUsedAt.getTime())))??p[0];D(q,T.id),e(b)==="FtkChallenge"&&T.deckType!=="Preset"&&D(q,((x=$t.find(F=>F.deckType==="Preset"))==null?void 0:x.id)??e(q))};let A=we(ft.getAllDeckInfo(t).then(p=>(Promise.all(p.filter(T=>!T.lastUsedAt).map(T=>{T.saveDeckInfo()})),W(p),p)));const Y=async()=>{const p=e(q);let T=(await e(A)).find(F=>F.id===p)??(await ne()).find(F=>F.id===p);T&&await T.updateTimestamp();let x=T;if(x||(x=$t.find(F=>F.id===p)),!x)throw new Error("illegal state");return x},te=async()=>{(await R).save({previousGameMode:e(b)})},ne=()=>(D(A,ft.getAllDeckInfo(t).then(p=>(W(p),p))),e(A)),Te=async()=>{(await e(A)).length||(await ft.prepareSampleDeck(),ne())},j=async()=>{await Promise.all([te(),Te()]);const p=await Y(),T=await R;let x=qt.find(g=>g.id===Number.MIN_SAFE_INTEGER)??qt[0],F=$t.find(g=>g.id===Number.MIN_SAFE_INTEGER)??$t[0],h="PlayFirst";e(b)==="FtkChallenge"?x=qt.filter(g=>g.npcType==="FtkChallenge").find(g=>g.difficulty===T.previousDifficulty)??x:e(b)==="Free"&&(x=qt.find(g=>g.id===T.previousNpcId)??x,F=$t.slice(-1)[0],h=T.previousStartMode),x.npcType!=="FtkChallenge"&&T.previousNpcDeckId>-1?F=(await e(A)).find(g=>g.id===T.previousNpcDeckId)??F:F=$t.find(g=>g.id===x.id)??F,D(c,new pr(T,"Player",p,[],x,"NPC",F,[],h)),e(c).onDuelEnd.append(()=>(D(c,e(c)),"RemoveMe"))},k=async()=>{await Promise.all([te(),Te()]),D(d,"DeckEdit")},K=async p=>{await te(),p.key==="Enter"&&!p.repeat&&(await R).save()},ae=()=>{D(A,ne()),D(c,void 0),D(d,"None")};let xe=Date.now();const Z=p=>{Date.now()-xe<200||(xe=Date.now(),D(b,p),ne())},_e=p=>{V(Number(p.currentTarget.value))},V=p=>{var T;D(w,qt.find(x=>x.id===p)),D(P,((T=e(w))==null?void 0:T.description)??"")};Te(),it();var pe=Dn(),X=s(a(pe),2),z=a(X),re=s(X,2);{var ve=p=>{var T=Me(),x=H(T);ht(x,()=>R,null,(F,h)=>{ri(F,{get duel(){return e(c)},get userProfile(){return e(h)}})}),r(p,T)},be=p=>{var T=Me(),x=H(T);{var F=g=>{tn(g,{})},h=g=>{var Q=hn(),he=a(Q),Se=a(he),ge=a(Se);ht(ge,()=>R,ue=>{var $=bn();r(ue,$)},(ue,$)=>{var N=mn(),ye=H(N),$e=a(ye),Re=a($e),Ye=s($e),Be=a(Ye),Ie=a(Be),ze=s(ye,2);ht(ze,()=>e(A),m=>{var B=pn();r(m,B)},(m,B)=>{var me=fn(),je=H(me),O=a(je),Ce=a(O),Ne=s(O),We=a(Ne);ie(We,5,()=>Ta,oe,(Fe,Pe)=>{var Xe=sn(),Qe=H(Xe),_t=s(Qe,2),kt=a(_t);u(gt=>{pt(Qe,"id",`game_mode_radio_${gt??""}`),gr(Qe,e(Pe)),mr(Qe,e(b)===e(Pe)),Ae(_t,`game_mode_tab_label game_mode_tab_${gt??""} svelte-abgng1`),pt(_t,"for",`game_mode_radio_${gt??""}`),f(kt,e(Pe))},[()=>e(Pe).toLowerCase()],ce),ke("change",Qe,()=>Z(e(Pe))),r(Fe,Xe)});var Ue=s(je,2),Ke=a(Ue),vt=a(Ke),dt=s(Ke),tt=a(dt),De=a(tt);u(()=>{e(q),At(()=>{e(b),e(B)})}),ie(De,5,()=>e(b)==="FtkChallenge"?$t.filter(Fe=>Fe.deckType==="Preset"):e(B),oe,(Fe,Pe)=>{var Xe=nn(),Qe={},_t=a(Xe);u(()=>{Qe!==(Qe=e(Pe).id)&&(Xe.value=(Xe.__value=e(Pe).id)==null?"":e(Pe).id),f(_t,e(Pe).name)}),r(Fe,Xe)});var He=s(Ue,2);{var qe=Fe=>{var Pe=cn(),Xe=H(Pe),Qe=a(Xe),_t=a(Qe),kt=s(Qe),gt=a(kt),jt=a(gt);u(()=>{e($),At(()=>{})}),ie(jt,5,()=>qt,oe,(ut,et)=>{var ot=ln(),Ct={},Et=a(ot);u(()=>{Ct!==(Ct=e(et).id)&&(ot.value=(ot.__value=e(et).id)==null?"":e(et).id),f(Et,e(et).name)}),r(ut,ot)});var Ht=s(jt,2),Pt=a(Ht),Nt=s(Xe,2);{var It=ut=>{var et=vn(),ot=a(et),Ct=a(ot),Et=s(ot),ga=a(Et),ma=a(ga);u(()=>{e($),At(()=>{e(B)})});var ea=a(ma);ea.value=(ea.__value=Number.MIN_SAFE_INTEGER)==null?"":Number.MIN_SAFE_INTEGER;var Ua=s(ea);ie(Ua,1,()=>e(B),oe,(ta,Rt)=>{var Wt=on(),ba={},Fa=a(Wt);u(()=>{ba!==(ba=e(Rt).id)&&(Wt.value=(Wt.__value=e(Rt).id)==null?"":e(Rt).id),f(Fa,e(Rt).name)}),r(ta,Wt)}),ee(3,Ct,()=>fe,()=>({duration:200})),ee(3,ot,()=>fe,()=>({duration:200})),Yt(ma,()=>e($).previousNpcDeckId,ta=>e($).previousNpcDeckId=ta),ee(3,ga,()=>fe,()=>({duration:200})),ee(3,Et,()=>fe,()=>({duration:200})),ee(3,et,()=>fe,()=>({duration:200})),r(ut,et)};y(Nt,ut=>{var et;((et=e(w))==null?void 0:et.npcType)!=="FtkChallenge"&&ut(It)})}var xt=s(Nt,2),wt=a(xt),Ot=a(wt),Lt=s(wt),fa=a(Lt),pa=a(fa);u(()=>{e($),At(()=>{})}),ie(pa,5,()=>oa(ja),oe,(ut,et)=>{var ot=dn(),Ct={},Et=a(ot);u(()=>{Ct!==(Ct=e(et))&&(ot.value=(ot.__value=e(et))==null?"":e(et)),f(Et,ja[e(et)])}),r(ut,ot)}),u(()=>f(Pt,`※${e(P)??""}`)),ee(3,_t,()=>fe,()=>({duration:200})),ee(3,Qe,()=>fe,()=>({duration:200})),ke("change",jt,_e),Yt(jt,()=>e($).previousNpcId,ut=>e($).previousNpcId=ut),ee(3,gt,()=>fe,()=>({duration:200})),ee(3,kt,()=>fe,()=>({duration:200})),ee(3,Xe,()=>fe,()=>({duration:200})),ee(3,Ot,()=>fe,()=>({duration:200})),ee(3,wt,()=>fe,()=>({duration:200})),Yt(pa,()=>e($).previousStartMode,ut=>e($).previousStartMode=ut),ee(3,fa,()=>fe,()=>({duration:200})),ee(3,Lt,()=>fe,()=>({duration:200})),ee(3,xt,()=>fe,()=>({duration:200})),r(Fe,Pe)},Ve=Fe=>{var Pe=Me(),Xe=H(Pe);{var Qe=_t=>{var kt=un(),gt=a(kt),jt=a(gt),Ht=s(gt),Pt=a(Ht),Nt=a(Pt);u(()=>{e($),At(()=>{})}),ie(Nt,5,()=>br,oe,(It,xt)=>{var wt=_n(),Ot={},Lt=a(wt);u(()=>{Ot!==(Ot=e(xt))&&(wt.value=(wt.__value=e(xt))==null?"":e(xt)),f(Lt,e(xt))}),r(It,wt)}),ee(3,jt,()=>fe,()=>({duration:200})),ee(3,gt,()=>fe,()=>({duration:200})),Yt(Nt,()=>e($).previousDifficulty,It=>e($).previousDifficulty=It),ee(3,Pt,()=>fe,()=>({duration:200})),ee(3,Ht,()=>fe,()=>({duration:200})),ee(3,kt,()=>fe,()=>({duration:200})),r(_t,kt)};y(Xe,_t=>{e(b)==="FtkChallenge"&&_t(Qe)},!0)}r(Fe,Pe)};y(He,Fe=>{e(b)==="Free"?Fe(qe):Fe(Ve,!1)})}var Je=s(He,2),lt=a(Je),yt=a(lt),Ge=a(yt);ee(3,Ce,()=>fe,()=>({duration:200})),ee(3,O,()=>fe,()=>({duration:200})),ee(3,We,()=>fe,()=>({duration:200})),ee(3,Ne,()=>fe,()=>({duration:200})),ee(3,je,()=>fe,()=>({duration:200})),ee(3,vt,()=>fe,()=>({duration:200})),ee(3,Ke,()=>fe,()=>({duration:200})),Yt(De,()=>e(q),Fe=>D(q,Fe)),ee(3,tt,()=>fe,()=>({duration:200})),ee(3,dt,()=>fe,()=>({duration:200})),ee(3,Ue,()=>fe,()=>({duration:200})),ke("click",Ge,j),ee(3,yt,()=>fe,()=>({duration:200})),r(m,me)});var E=s(ze,2);{var C=m=>{var B=gn(),me=a(B),je=a(me),O=a(je);ke("click",O,k),ee(3,je,()=>fe,()=>({duration:200})),ee(3,me,()=>fe,()=>({duration:200})),ee(3,B,()=>fe,()=>({duration:200})),r(m,B)};y(E,m=>{e(b)==="Free"&&m(C)})}ee(3,Re,()=>fe,()=>({duration:200})),ee(3,$e,()=>fe,()=>({duration:200})),sa(Ie,()=>e($).name,m=>e($).name=m),ke("keypress",Ie,K),ee(3,Be,()=>fe,()=>({duration:200})),ee(3,Ye,()=>fe,()=>({duration:200})),ee(3,ye,()=>fe,()=>({duration:200})),r(ue,N)}),r(g,Q)};y(x,g=>{e(d)==="DeckEdit"?g(F):g(h,!1)},!0)}r(p,T)};y(re,p=>{e(c)?p(ve):p(be,!1)})}var U=s(re,2),M=a(U),G=a(M),J=s(M,2),Ee=a(J),S=s(J,2),le=a(S),de=s(U,2);{var se=p=>{var T=Cn(),x=a(T);{var F=$=>{var N=Me(),ye=H(N);{var $e=Ye=>{var Be=yn();r(Ye,Be)},Re=Ye=>{var Be=Me(),Ie=H(Be);{var ze=E=>{var C=kn();r(E,C)};y(Ie,E=>{e(c).winner.seat==="Above"&&E(ze)},!0)}r(Ye,Be)};y(ye,Ye=>{e(c).winner.seat==="Below"?Ye($e):Ye(Re,!1)})}r($,N)},h=$=>{var N=wn();r($,N)};y(x,$=>{e(c).winner?$(F):$(h,!1)})}var g=s(x,2),Q=a(g),he=s(g,2);{var Se=$=>{var N=xn(),ye=a(N);u(()=>pt(ye,"href",`https://x.com/share?url=${l}&text=${e(c).twitterShareText??""}&hashtags=${L}&via=${I}`)),r($,N)};y(he,$=>{e(c).twitterShareText&&$(Se)})}var ge=s(he,2),ue=a(ge);u(()=>f(Q,e(c).reasonOfEnd)),ke("click",ue,ae),ee(3,T,()=>kr,()=>({delay:200,duration:200})),r(p,T)};y(de,p=>{e(c)&&e(c).isEnded&&p(se)})}u(()=>{f(G,"build at: 20251130_215506"),f(Ee,fr.text),f(le,`w:${e(v)??""}px h:${e(_)??""}px`)}),Kt("innerWidth",p=>D(v,p)),Kt("innerHeight",p=>D(_,p)),ke("click",z,ae),r(o,pe),nt()}hr($n,{target:document.getElementById("app")});
