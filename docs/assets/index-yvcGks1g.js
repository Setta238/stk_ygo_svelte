var Ua=Object.defineProperty;var ba=o=>{throw TypeError(o)};var ja=(o,i,t)=>i in o?Ua(o,i,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[i]=t;var Qe=(o,i,t)=>ja(o,typeof i!="symbol"?i+"":i,t),ya=(o,i,t)=>i.has(o)||ba("Cannot "+t);var rt=(o,i,t)=>(ya(o,i,"read from private field"),t?t.call(o):i.get(o)),Ht=(o,i,t)=>i.has(o)?ba("Cannot add the same private member more than once"):i instanceof WeakSet?i.add(o):i.set(o,t),aa=(o,i,t,c)=>(ya(o,i,"write to private field"),c?c.call(o,t):i.set(o,t),t);import{s as wa,r as Oa,a as x,b as La,l as Ra,g as e,d as Ia,p as it,c as Re,m as we,i as lt,t as l,e as a,f as y,h as u,j as he,k as Ye,n as gt,o as ye,q as r,u as nt,v as Le,S as Wa,w as Ae,x as W,y as s,z as oe,D as $t,A as J,B as ve,C as f,E as Ka,F as st,G as oa,H as za,I as Ga,J as St,K as ht,L as va,M as Vt,N as da,O as Qt,P as ca,Q as Zt,R as Jt,T as Xa,U as Va,V as Qa,W as Za,X as Ja,Y as er,Z as tr,_ as Kt,$ as bt,a0 as zt,a1 as ra,a2 as Fa,a3 as ar,a4 as rr,a5 as sr,a6 as ir,a7 as lr,a8 as ut,a9 as nr,aa as or,ab as vr,ac as ka,ad as xa,ae as Ca,af as Da,ag as $a,ah as Sa,ai as Yt,aj as Nt,ak as sa,al as Ma,am as dr,an as Ct,ao as cr,ap as _r,aq as Ta,ar as At,as as Dt,at as ur,au as fr,av as pr,aw as gr,ax as Ea,ay as mr,az as hr}from"../chunk/entity_proc_20250610_223538.js";import"../chunk/json_20250610_223538.js";(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const _ of document.querySelectorAll('link[rel="modulepreload"]'))c(_);new MutationObserver(_=>{for(const v of _)if(v.type==="childList")for(const g of v.addedNodes)g.tagName==="LINK"&&g.rel==="modulepreload"&&c(g)}).observe(document,{childList:!0,subtree:!0});function t(_){const v={};return _.integrity&&(v.integrity=_.integrity),_.referrerPolicy&&(v.referrerPolicy=_.referrerPolicy),_.crossOrigin==="use-credentials"?v.credentials="include":_.crossOrigin==="anonymous"?v.credentials="omit":v.credentials="same-origin",v}function c(_){if(_.ep)return;_.ep=!0;const v=t(_);fetch(_.href,v)}})();const br=o=>o;function _a(o){const i=o-1;return i*i*i+1}function qa(o){const i=typeof o=="string"&&o.match(/^\s*(-?[\d.]+)([^\s]*)\s*$/);return i?[parseFloat(i[1]),i[2]||"px"]:[o,"px"]}function yr(o,{delay:i=0,duration:t=400,easing:c=br}={}){const _=+getComputedStyle(o).opacity;return{delay:i,duration:t,easing:c,css:v=>`opacity: ${v*_}`}}function wr(o,{delay:i=0,duration:t=400,easing:c=_a,x:_=0,y:v=0,opacity:g=0}={}){const d=getComputedStyle(o),S=+d.opacity,H=d.transform==="none"?"":d.transform,w=S*(1-g),[n,U]=qa(_),[I,j]=qa(v);return{delay:i,duration:t,easing:c,css:(O,q)=>`
			transform: ${H} translate(${(1-O)*n}${U}, ${(1-O)*I}${j});
			opacity: ${S-w*q}`}}function ue(o,{delay:i=0,duration:t=400,easing:c=_a,axis:_="y"}={}){const v=getComputedStyle(o),g=+v.opacity,d=_==="y"?"height":"width",S=parseFloat(v[d]),H=_==="y"?["top","bottom"]:["left","right"],w=H.map(A=>`${A[0].toUpperCase()}${A.slice(1)}`),n=parseFloat(v[`padding${w[0]}`]),U=parseFloat(v[`padding${w[1]}`]),I=parseFloat(v[`margin${w[0]}`]),j=parseFloat(v[`margin${w[1]}`]),O=parseFloat(v[`border${w[0]}Width`]),q=parseFloat(v[`border${w[1]}Width`]);return{delay:i,duration:t,easing:c,css:A=>`overflow: hidden;opacity: ${Math.min(A*20,1)*g};${d}: ${A*S}px;padding-${H[0]}: ${A*n}px;padding-${H[1]}: ${A*U}px;margin-${H[0]}: ${A*I}px;margin-${H[1]}: ${A*j}px;border-${H[0]}-width: ${A*O}px;border-${H[1]}-width: ${A*q}px;min-${d}: 0`}}function Aa(o,i){for(const t in i)o[t]=i[t];return o}function kr({fallback:o,...i}){const t=new Map,c=new Map;function _(g,d,S){const{delay:H=0,duration:w=b=>Math.sqrt(b)*30,easing:n=_a}=Aa(Aa({},i),S),U=g.getBoundingClientRect(),I=d.getBoundingClientRect(),j=U.left-I.left,O=U.top-I.top,q=U.width/I.width,A=U.height/I.height,ee=Math.sqrt(j*j+O*O),ie=getComputedStyle(d),Te=ie.transform==="none"?"":ie.transform,D=+ie.opacity;return{delay:H,duration:typeof w=="function"?w(ee):w,easing:n,css:(b,L)=>`
			   opacity: ${b*D};
			   transform-origin: top left;
			   transform: ${Te} translate(${L*j}px,${L*O}px) scale(${b+(1-b)*q}, ${b+(1-b)*A});
		   `}}function v(g,d,S){return(H,w)=>(g.set(w.key,H),()=>{if(d.has(w.key)){const n=d.get(w.key);return d.delete(w.key),_(n,H,w)}return g.delete(w.key),o&&o(H,w,S)})}return[v(c,t,!1),v(t,c,!0)]}function Ya(o){return Object.prototype.toString.call(o)==="[object Date]"}function xr(o){return o}function ia(o){const i=o-1;return i*i*i+1}function la(o,i){if(o===i||o!==o)return()=>o;const t=typeof o;if(t!==typeof i||Array.isArray(o)!==Array.isArray(i))throw new Error("Cannot interpolate values of different type");if(Array.isArray(o)){const c=i.map((_,v)=>la(o[v],_));return _=>c.map(v=>v(_))}if(t==="object"){if(!o||!i)throw new Error("Object cannot be null");if(Ya(o)&&Ya(i)){const v=o.getTime(),d=i.getTime()-v;return S=>new Date(v+S*d)}const c=Object.keys(i),_={};return c.forEach(v=>{_[v]=la(o[v],i[v])}),v=>{const g={};return c.forEach(d=>{g[d]=_[d](v)}),g}}if(t==="number"){const c=i-o;return _=>o+_*c}return()=>i}var mt,Bt,Pt,Mt;const ua=class ua{constructor(i,t={}){Ht(this,mt,wa(void 0));Ht(this,Bt,wa(void 0));Ht(this,Pt);Ht(this,Mt,null);rt(this,mt).v=rt(this,Bt).v=i,aa(this,Pt,t)}static of(i,t){const c=new ua(i(),t);return Oa(()=>{c.set(i())}),c}set(i,t){var n;x(rt(this,Bt),i);let{delay:c=0,duration:_=400,easing:v=xr,interpolate:g=la}={...rt(this,Pt),...t};if(_===0)return(n=rt(this,Mt))==null||n.abort(),x(rt(this,mt),i),Promise.resolve();const d=La.now()+c;let S,H=!1,w=rt(this,Mt);return aa(this,Mt,Ra(U=>{if(U<d)return!0;if(!H){H=!0;const j=rt(this,mt).v;S=g(j,i),typeof _=="function"&&(_=_(j,i)),w==null||w.abort()}const I=U-d;return I>_?(x(rt(this,mt),i),!1):(x(rt(this,mt),S(v(I/_))),!0)})),rt(this,Mt).promise}get current(){return e(rt(this,mt))}get target(){return e(rt(this,Bt))}set target(i){this.set(i)}};mt=new WeakMap,Bt=new WeakMap,Pt=new WeakMap,Mt=new WeakMap;let Gt=ua;var Cr=l('<div class="phase_display svelte-1ycsdg6"><span class="svelte-1ycsdg6"> </span> </div>'),Dr=l('<div class="lifepoint_display svelte-1ycsdg6"><div class="svelte-1ycsdg6"> </div> <div class="svelte-1ycsdg6"> </div></div>'),$r=(o,i,t)=>i(e(t)),Sr=l('<div class="svelte-1ycsdg6"><button class="phase_button svelte-1ycsdg6"> </button></div>'),Mr=l("<div><!></div>"),Tr=l('<div class="svelte-1ycsdg6"><!></div>'),Er=l("<div><!></div>"),qr=l('<div class="config_button_wrapper svelte-1ycsdg6"><button id="config_button" class="svelte-1ycsdg6">⚙</button></div>'),Ar=l("<!> <!> <!> <!>",1),Yr=l('<div style="position: absolute;" class="card_animation_receiver svelte-1ycsdg6"><!></div>'),Nr=l('<div style="position: absolute; top:0rem" class="svelte-1ycsdg6">｛効果対象｝</div>'),Br=l('<!> <div style="position: absolute; display:flex;justify-content: center;"><!></div>',1),Ir=l(" <!> 】",1),Fr=l('<div style="position: absolute; bottom:0rem" class="svelte-1ycsdg6"> <!></div>'),Hr=l("<!> <!>",1),Pr=l('<div class="badge svelte-1ycsdg6"> </div>'),Ur=l('<div class="card_animation_receiver svelte-1ycsdg6"><!></div>'),jr=l("<!> <!> <!> <!>",1),Or=l('<td><div role="listitem"><!></div></td>');function Lr(o,i){it(i,!1);let t=Re(i,"view",12),c=Re(i,"row",8),_=Re(i,"column",8),v=Re(i,"selectedEntities",28,()=>[]),g=Re(i,"selectedCells",28,()=>[]),d=we(t().getCell(c(),_())),S=we(new Gt(e(d).field.duel.duelists.Above.lp,{duration:400,easing:ia})),H=we(new Gt(e(d).field.duel.duelists.Below.lp,{duration:400,easing:ia}));const w=()=>{x(d,t().getCell(c(),_())),Le(S,e(S).target=e(d).field.duel.duelists.Above.lp),Le(H,e(H).target=e(d).field.duel.duelists.Below.lp)};e(d).onUpdate.append(w),t().onDuelUpdate.append(w),t().modalController.onUpdate.append(w);let n,U=we([]),I=()=>console.log("hoge"),j,O=we([]),q=we(!1),A=we(!1),ee=!1;const ie=$=>{var Z,ne;x(_e,[]),v().reset(),n=$.activator,I=$.resolve,x(U,$.dummyActionInfos),x(O,$.chainBlockInfos.flatMap(Ee=>Ee.selectedEntities).getDistinct()),j=$.entitiesChoices,x(q,!1),x(A,((Z=$.cellsChoices)==null?void 0:Z.selectables.includes(e(d)))??!1),ee=e(A)&&((ne=$.cellsChoices)==null?void 0:ne.qty)===1,w()};t().onWaitStart.append(ie);const Te=()=>{n=void 0,x(U,[]),I=()=>{console.log("hoge")},j=void 0,x(O,[]),x(q,!1),x(A,!1),ee=!1};t().onWaitEnd.append(Te);let D=we(!1),b=[];const L=$=>{b=$.filter(Z=>Z.dests.includes(e(d))),x(D,b.length>0),w()},te=()=>{b=[],x(D,!1),w()};t().onDragStart.append(L),t().onDragEnd.append(te);const[xe,Q]=js;let _e=we([]);const X=$=>{if(n=void 0,e(d)===$.to||e(d).entities.includes($.entity)){x(_e,[...e(_e),$]);const Z=$.resolve;x(d,e(d)),setTimeout(()=>{x(_e,e(_e).filter(ne=>ne!==$)),$.count++,$.count>1&&Z()},600)}};t().onAnimation.append(X);const fe=$=>{I({phaseChange:$})},K=()=>e(d).isStackCell&&e(d).entities.flatMap($=>$.actions).filter($=>e(U).map(Z=>Z.action.seq).some(Z=>Z===$.seq)).length>0,R=$=>{var Z;if(((Z=$.target)==null?void 0:Z.id)==="config_button"){t(t().infoBoardState="Config",!0),t().requireUpdate();return}if(t(t().infoBoardState="Default",!0),ee)I({selectedCells:[e(d)]});else if(e(A))x(q,!e(q)),g(e(q)?[...g(),e(d)]:g().filter(ne=>ne!==e(d)));else if(e(d).isStackCell){t(t().infoBoardState="CellInfo",!0),t(t().infoBoardCell=e(d),!0),t().requireUpdate();const ne=e(d).entities.flatMap(m=>m.actions).map(m=>m.seq),Ee=e(U).filter(m=>ne.includes(m.action.seq));if(Ee.length){if(!n)return;t().modalController.actionSelector.show({title:"カードを選択。",position:"Bottom",activator:n,dummyActionInfos:Ee,cancelable:!0}).then(m=>{m&&I({actionInfo:m})});return}}t().requireUpdate(),console.info(e(d),pe(...e(d).visibleEntities))},re=$=>{$.preventDefault(),$.dataTransfer&&($.dataTransfer.dropEffect="move")},le=$=>{$.preventDefault(),console.info("drop",$,e(D),b),$.dataTransfer&&($.dataTransfer.dropEffect="move");try{if(e(D)&&b){if(b.length===1){const Z=b[0];I({actionInfo:{...Z,dest:e(d)}})}else if(b.length>1){if(!n)throw new Wa("想定されない状態");e(d).field.duel.view.modalController.terminateAll(),e(d).field.duel.view.modalController.actionSelector.show({title:"選択",position:"Bottom",activator:n,dummyActionInfos:b.map(Z=>({...Z,dest:e(d)})),cancelable:!1}).then(Z=>{I({actionInfo:Z})})}}}finally{t().removeDraggingActions()}},pe=(...$)=>{if(t().waitMode==="Animation")return"Disabled";if(j&&j.selectables.find(ne=>$.find(Ee=>ne===Ee)))return"Selectable";if(!e(U)||e(U).length===0||t().waitMode!=="Free"||Object.values(t().modalController.modals).some(ne=>ne.state==="Shown"))return"Disabled";const Z=e(U).filter(ne=>$.includes(ne.action.entity));return Z.length===0?"Disabled":e(d).isStackCell||Z[0].action.entity!==$[0]?"Clickable":Z.some(ne=>ne.dests.length)?"Draggable":"Clickable"};lt();var z=Or(),M=a(z);M.__click=R;var G=a(M);{var ae=$=>{var Z=Ae(),ne=W(Z);{var Ee=m=>{var T=Ae(),k=W(T);{var P=h=>{var ge=Cr(),be=a(ge),Me=a(be),me=s(be,1,!0);u((Ce,E)=>{f(Me,Ce),f(me,E)},[()=>String(e(d).field.duel.clock.turn).padStart(2,"0"),()=>e(d).field.duel.phase.toUpperCase()],he),r(h,ge)},p=h=>{var ge=Ae(),be=W(ge);{var Me=Ce=>{var E=Dr(),B=a(E),de=a(B),Se=s(B,2),Ke=a(Se);u((De,V)=>{f(de,De),f(Ke,V)},[()=>Math.floor(e(S).current),()=>Math.floor(e(H).current)],he),r(Ce,E)},me=Ce=>{var E=Ae(),B=W(E);{var de=Se=>{var Ke=Ae(),De=W(Ke);{var V=ce=>{var Ne=Ae(),C=W(Ne);{var Y=N=>{var se=Ae(),Be=W(se);oe(Be,1,()=>t().duel.nextPhaseList,ve,(He,F)=>{var ke=Sr(),qe=a(ke);qe.__click=[$r,fe,F];var We=a(qe);u(Pe=>f(We,Pe),[()=>e(F).toUpperCase()],he),r(He,ke)}),r(N,se)};y(C,N=>{t().duel.isEnded||N(Y)})}r(ce,Ne)};y(De,ce=>{t().waitMode==="Free"&&ce(V)})}r(Se,Ke)};y(B,Se=>{e(d).column===5&&Se(de)},!0)}r(Ce,E)};y(be,Ce=>{e(d).column===3?Ce(Me):Ce(me,!1)},!0)}r(h,ge)};y(k,h=>{e(d).column===1?h(P):h(p,!1)})}r(m,T)};y(ne,m=>{e(d).row===3&&m(Ee)})}r($,Z)},Ie=$=>{var Z=Ae(),ne=W(Z);{var Ee=T=>{var k=Ar();const P=he(()=>e(_e).find(E=>E.to===e(d)));var p=W(k);{var h=E=>{var B=Mr(),de=a(B);$t(de,{get entity(){return e(P).entity},state:"Disabled",dummyActionInfos:[],cardActionResolve:void 0}),u(()=>Ye(B,`card_animation_receiver ${e(d).cellType??""} svelte-1ycsdg6`)),J(1,B,()=>Q,()=>({key:e(P).entity.seq})),r(E,B)};y(p,E=>{e(P)&&e(P).index==="Top"&&E(h)})}var ge=s(p,2);oe(ge,1,()=>e(d).visibleEntities,ve,(E,B)=>{var de=Ae(),Se=W(de);{var Ke=De=>{var V=Tr(),ce=a(V);const Ne=he(()=>pe(e(B))),C=he(()=>e(U).filter(Y=>Y.action.entity===e(B)));$t(ce,{get entity(){return e(B)},get state(){return e(Ne)},get dummyActionInfos(){return e(C)},cardActionResolve:void 0,get selectedList(){return v()},set selectedList(Y){v(Y)},$$legacy:!0}),J(2,V,()=>xe,()=>({key:e(B).seq})),r(De,V)};y(Se,De=>{e(_e).every(V=>V.entity.seq!==e(B).seq)&&De(Ke)})}r(E,de)});var be=s(ge,2);{var Me=E=>{var B=Er(),de=a(B);$t(de,{get entity(){return e(P).entity},state:"Disabled",dummyActionInfos:[],cardActionResolve:void 0}),u(()=>Ye(B,`card_animation_receiver ${e(d).cellType??""} svelte-1ycsdg6`)),J(1,B,()=>Q,()=>({key:e(P).entity.seq})),r(E,B)};y(be,E=>{e(P)&&e(P).index!=="Top"&&E(Me)})}var me=s(be,2);{var Ce=E=>{var B=qr();r(E,B)};y(me,E=>{e(d).owner.seat==="Below"&&E(Ce)})}r(T,k)},m=T=>{var k=jr();const P=he(()=>e(_e).find(B=>B.to===e(d)));var p=W(k);{var h=B=>{var de=Yr(),Se=a(de);$t(Se,{get entity(){return e(P).entity},state:"Disabled",dummyActionInfos:[],cardActionResolve:void 0}),J(1,de,()=>Q,()=>({key:e(P).entity.seq})),r(B,de)};y(p,B=>{e(P)&&e(P).index!=="Top"&&B(h)})}var ge=s(p,2);{var be=B=>{var de=Hr(),Se=W(de);oe(Se,1,()=>e(d).visibleEntities.map((V,ce)=>({index:ce,entity:V})).toReversed(),ve,(V,ce)=>{var Ne=Ae(),C=W(Ne);{var Y=N=>{var se=Br();const Be=he(()=>!e(d).isStackCell&&e(ce).index===0?pe(...e(d).visibleEntities):void 0);var He=W(se);{var F=Pe=>{var ze=Nr();r(Pe,ze)};y(He,Pe=>{e(O).includes(e(ce).entity)&&Pe(F)})}var ke=s(He,2),qe=a(ke);const We=he(()=>e(ce).index===0?e(U).filter(Pe=>e(d).visibleEntities.includes(Pe.action.entity)):void 0);$t(qe,{get entity(){return e(ce).entity},get state(){return e(Be)},get dummyActionInfos(){return e(We)},cardActionResolve:void 0,get selectedList(){return v()},set selectedList(Pe){v(Pe)},$$legacy:!0}),u(()=>Ye(ke,`duel_card_wrapper ${(e(ce).entity.exist?"duel_card_wrapper_exists":"")??""} svelte-1ycsdg6`)),J(2,ke,()=>xe,()=>({key:e(ce).entity.seq})),r(N,se)};y(C,N=>{e(_e).every(se=>se.entity.seq!==e(ce).entity.seq)&&N(Y)})}r(V,Ne)});var Ke=s(Se,2);{var De=V=>{var ce=Fr(),Ne=a(ce),C=s(Ne);oe(C,1,()=>oa(e(d).visibleEntities[0].status.maxCounterQty),ve,(Y,N)=>{var se=Ir(),Be=W(se),He=s(Be);{var F=ke=>{var qe=st();u(()=>f(qe,`/${e(d).visibleEntities[0].status.maxCounterQty[e(N)]??""}`)),r(ke,qe)};y(He,ke=>{(e(d).visibleEntities[0].status.maxCounterQty[e(N)]??9999)<100&&ke(F)})}u((ke,qe)=>f(Be,`【
              ${ke??""}${qe??""} `),[()=>Ka(e(N)),()=>e(d).visibleEntities[0].counterHolder.getQty(e(N))],he),r(Y,se)}),u(()=>f(Ne,`【${e(d).visibleEntities[0].battlePositionName??""}】 `)),r(V,ce)};y(Ke,V=>{e(d).visibleEntities[0].battlePosition&&V(De)})}r(B,de)};y(ge,B=>{e(d).visibleEntities.length>0&&B(be)})}var Me=s(ge,2);{var me=B=>{var de=Pr(),Se=a(de);u(()=>f(Se,e(d).visibleEntities.length)),r(B,de)};y(Me,B=>{e(d).isStackCell&&B(me)})}var Ce=s(Me,2);{var E=B=>{var de=Ur(),Se=a(de);$t(Se,{get entity(){return e(P).entity},state:"Disabled",dummyActionInfos:[],cardActionResolve:void 0}),J(1,de,()=>Q,()=>({key:e(P).entity.seq})),r(B,de)};y(Ce,B=>{e(P)&&e(P).index==="Top"&&B(E)})}r(T,k)};y(ne,T=>{e(d).cellType==="Hand"?T(Ee):T(m,!1)},!0)}r($,Z)};y(G,$=>{e(d).isDisabledCell?$(ae):$(Ie,!1)})}u($=>{Ye(z,`${`duel_field_cell duel_field_cell_${e(d).cellType} ${e(d).linkArrowSources.length===0?"":"duel_field_cell_linked"}`??""} svelte-1ycsdg6`),gt(z,"colspan",e(d).cellType==="Hand"?7:1),Ye(M,`${$??""} svelte-1ycsdg6`)},[()=>`duel_field_cell_inner_box ${e(d).cellType} ${e(D)?"can_accept_drop":""} ${K()?"can_action":""} ${e(q)?"is_selected":e(A)?"is_selectable":""} `],he),ye("dragover",M,re),ye("drop",M,le),r(o,z),nt()}Ia(["click"]);var Rr=l('<div class="title svelte-14z6bdh"> </div>'),Wr=l('<div class="title svelte-14z6bdh"> </div>'),Kr=l('<div class="duel_log_chain_number svelte-14z6bdh"> </div>'),zr=l("<div><!></div>"),Gr=l('<div><div style="display: flex;    justify-content: space-between;"><div style=" white-space: nowrap;text-align: center;"> </div> <!></div> <!></div>'),Xr=l("<div><!> <!></div>"),Vr=l("<div><!> <!></div>"),Qr=l('<div class="duel_log svelte-14z6bdh"><div class="duel_log_header svelte-14z6bdh"></div> <div class="duel_log_body svelte-14z6bdh"></div> <div class="duel_log_footer svelte-14z6bdh"></div></div>');function Zr(o,i){it(i,!1);let t=we(void 0),c=Re(i,"log",8),_,v=we([]);const g=()=>{const w=((_==null?void 0:_.seq)??-1)+1;c().records.slice(w).forEach(n=>{if(!_){x(v,[[[[n]]]]),_=n;return}if(!e(v)[n.clock.turn]){Le(v,e(v)[n.clock.turn]=[[[n]]]),_=n;return}if(!e(v)[n.clock.turn][n.clock.phaseSeq]){Le(v,e(v)[n.clock.turn][n.clock.phaseSeq]=[[n]]),_=n;return}if(_.clock.chainSeq===n.clock.chainSeq&&_.clock.chainBlockSeq===n.clock.chainBlockSeq&&_.duelist===n.duelist){e(v)[n.clock.turn][n.clock.phaseSeq].slice(-1)[0].push(n),_=n;return}e(v)[n.clock.turn][n.clock.phaseSeq].push([n]),_=n}),x(v,e(v)),za().then(()=>e(t)&&e(t).scroll(0,e(t).clientHeight*990))};c().onUpdate.append(g),c().duel.view.onDuelUpdate.append(g),g(),lt();var d=Ae(),S=W(d);{var H=w=>{var n=Qr(),U=s(a(n),2);oe(U,5,()=>e(v),ve,(I,j)=>{var O=Vr(),q=a(O);{var A=ie=>{var Te=Rr(),D=a(Te);u(()=>f(D,`ターン：${e(j)[0][0][0].clock.turn??""}`)),r(ie,Te)};y(q,ie=>{e(j)[0][0][0].clock.turn>0&&ie(A)})}var ee=s(q,2);oe(ee,1,()=>e(j),ve,(ie,Te)=>{var D=Xr(),b=a(D);{var L=xe=>{var Q=Wr(),_e=a(Q);u(()=>f(_e,e(Te)[0][0].clock.period.name)),r(xe,Q)};y(b,xe=>{e(Te)[0][0].clock.turn>0&&xe(L)})}var te=s(b,2);oe(te,1,()=>e(Te),ve,(xe,Q)=>{var _e=Gr();const X=he(()=>{var z;return((z=e(Q).find(M=>M.chainNumber!==void 0))==null?void 0:z.chainNumber)??0});var fe=a(_e),K=a(fe),R=a(K),re=s(K,2);{var le=z=>{var M=Kr(),G=a(M);u(()=>f(G,`チェーン：${e(X)??""}`)),r(z,M)};y(re,z=>{e(X)&&z(le)})}var pe=s(fe,2);oe(pe,1,()=>e(Q),ve,(z,M)=>{var G=zr(),ae=a(G);{var Ie=Z=>{var ne=st();u(()=>f(ne,e(M).text)),r(Z,ne)},$=Z=>{var ne=Ae(),Ee=W(ne);{var m=k=>{var P=st();u((p,h,ge)=>f(P,`移動：${p??""} ${h??""} ⇒ ${ge??""}`),[()=>{var p;return(p=e(M).mainEntity)==null?void 0:p.toString()},()=>{var p;return(p=e(M).from)==null?void 0:p.toString()},()=>{var p;return(p=e(M).to)==null?void 0:p.toString()}],he),r(k,P)},T=k=>{var P=Ae(),p=W(P);{var h=be=>{var Me=st();u((me,Ce)=>f(Me,`生成：${me??""} void ⇒ ${Ce??""}`),[()=>{var me;return(me=e(M).mainEntity)==null?void 0:me.toString()},()=>{var me;return(me=e(M).to)==null?void 0:me.toString()}],he),r(be,Me)},ge=be=>{var Me=Ae(),me=W(Me);{var Ce=B=>{var de=st();u((Se,Ke)=>f(de,`消滅：${Se??""} ${Ke??""} ⇒ void`),[()=>{var Se;return(Se=e(M).mainEntity)==null?void 0:Se.toString()},()=>{var Se;return(Se=e(M).from)==null?void 0:Se.toString()}],he),r(B,de)},E=B=>{var de=st();u(()=>f(de,e(M).text)),r(B,de)};y(me,B=>{e(M).type==="EntityDisappear"?B(Ce):B(E,!1)},!0)}r(be,Me)};y(p,be=>{e(M).type==="EntityAppear"?be(h):be(ge,!1)},!0)}r(k,P)};y(Ee,k=>{e(M).type==="EntityMove"?k(m):k(T,!1)},!0)}r(Z,ne)};y(ae,Z=>{e(M).type==="ChainBlockHeader"?Z(Ie):Z($,!1)})}u(Z=>Ye(G,`duel_log_record duel_log_record_${Z??""} svelte-14z6bdh`),[()=>e(M).type.toSnakeCase()],he),r(z,G)}),u(()=>{var z,M,G;Ye(_e,`duel_log_block_duelist duel_log_block_duelist_${((z=e(Q)[0].duelist)==null?void 0:z.seat)??"system"} svelte-14z6bdh`),Ye(K,`duelist ${((M=e(Q)[0].duelist)==null?void 0:M.seat)??""} svelte-14z6bdh`),f(R,((G=e(Q)[0].duelist)==null?void 0:G.profile.name)||"SYSTEM")}),r(xe,_e)}),u(()=>Ye(D,`duel_log_block_phase duel_log_block_phase_${e(Te)[0][0].clock.period.key??""} svelte-14z6bdh`)),r(ie,D)}),u(()=>Ye(O,`duel_log_block_turn duel_log_block_turn_${e(j)[0][0][0].clock.turn??""} svelte-14z6bdh`)),r(I,O)}),Ga(U,I=>x(t,I),()=>e(t)),r(w,n)};y(S,w=>{(c().duel.view.infoBoardState==="Log"||c().duel.view.infoBoardState==="Default")&&w(H)})}r(o,d),nt()}var Jr=l("<div><div> </div> <div> </div></div>");function Na(o,i){it(i,!1);let t=Re(i,"duelist",12),c=we(0),_=we();const v=async()=>{const U=t().lp-e(c);if(!e(_)||Math.abs(U)<10){x(c,t().lp),e(_)&&(e(_)(),x(_,void 0));return}x(c,e(c)+Math.floor(Math.random()*U)),await St(100),v()},g=()=>{t(t()),!e(_)&&t().lp!==e(c)&&new Promise(U=>{x(_,U),Math.abs(t().lp-e(c)),v()})};t().duel.log.onUpdate.append(g),v(),lt();var d=Jr(),S=a(d),H=a(S),w=s(S,2),n=a(w);u(U=>{Ye(d,`duelist duelist_${U??""} svelte-1sy3trd`),Ye(S,`duelist_name duelist_${U??""}_name svelte-1sy3trd`),f(H,t().profile.name),Ye(w,`duelist_lp ${(e(_)?"vibration":"")??""} svelte-1sy3trd`),f(n,e(c))},[()=>t().seat.toLowerCase()],he),r(o,d),nt()}const es=(o,i,t)=>(i(i()==="Normal"?"Debug":"Normal"),console.info(t()),!0);var ts=l('<div class="duel_card_info_row svelte-19vwcsh" style=" justify-content: space-between;"><div class="svelte-19vwcsh"> </div> <div class="svelte-19vwcsh"> </div></div>'),as=l('<div></div> <div class="svelte-19vwcsh"> </div>',1),rs=l("<div> </div>"),ss=l("<div> </div>"),is=l('<div class="duel_card_info_row svelte-19vwcsh"><!> <!></div> <div class="duel_card_info_row svelte-19vwcsh"></div>',1),ls=l('<div class="duel_card_row svelte-19vwcsh"><div class="svelte-19vwcsh"></div> <div class="svelte-19vwcsh"> </div></div>'),ns=l('<div class="duel_card_row svelte-19vwcsh"><div class="svelte-19vwcsh"></div> <div class="svelte-19vwcsh"> </div></div>'),os=l("<!> <!>",1),vs=l('<div class="duel_card_info_row svelte-19vwcsh" style="border-style: solid; border-width: 1px;"><pre class="description svelte-19vwcsh"> </pre></div>'),ds=l('<!> <div class="duel_card_info_row svelte-19vwcsh"><pre class="description svelte-19vwcsh"> </pre></div>',1),cs=l("[ <!> ],",1),_s=l('<div class="svelte-19vwcsh"> <!></div>'),us=l('<div class="svelte-19vwcsh"> </div> <!> <div class="svelte-19vwcsh"></div>',1),fs=l('<div class="svelte-19vwcsh"> </div>'),ps=l('<div class="svelte-19vwcsh"> </div>'),gs=l('<div class="svelte-19vwcsh"> </div>'),ms=l('<div class="svelte-19vwcsh"> </div>'),hs=l('<div class="svelte-19vwcsh"> </div>'),bs=l('<div class="svelte-19vwcsh"> </div>'),ys=l('<div class="duel_card_info_row svelte-19vwcsh"><div class="svelte-19vwcsh"><!> <div class="svelte-19vwcsh"></div> <!> <div class="svelte-19vwcsh"></div> <div class="svelte-19vwcsh"></div> <!> <div class="svelte-19vwcsh"></div> <div class="svelte-19vwcsh"></div> <!> <div class="svelte-19vwcsh"></div> <div class="svelte-19vwcsh"></div> <!> <div class="svelte-19vwcsh"></div> <div class="svelte-19vwcsh"></div> <!> <div class="svelte-19vwcsh"></div> <div class="svelte-19vwcsh"></div> <!> <div class="svelte-19vwcsh"></div> <div class="svelte-19vwcsh"></div> <div class="svelte-19vwcsh"> </div> <div class="svelte-19vwcsh"> </div> <div class="svelte-19vwcsh"> </div> <div class="svelte-19vwcsh"></div></div></div>'),ws=l('<div class="svelte-19vwcsh">※テスト用カードです</div>'),ks=l('<div class="duel_card_info_links svelte-19vwcsh"><a target="_blank" rel="noopener noreferrer" title="遊戯王カードWiki" class="svelte-19vwcsh">⇒遊戯王カードWiki</a> <a target="_blank" rel="noopener noreferrer" title="コナミカードデータベース" class="svelte-19vwcsh"> </a></div>'),xs=l('<div role="contentinfo"><div class="duel_card_info_header svelte-19vwcsh"><div class="duel_card_info_row svelte-19vwcsh"><div class="svelte-19vwcsh"> </div></div> <div class="duel_card_info_row svelte-19vwcsh" style="position:sticky; top:0;"><div class="svelte-19vwcsh"> </div> <div class="svelte-19vwcsh"> </div></div> <!></div> <div class="duel_card_info_body svelte-19vwcsh"><!></div> <div class="duel_card_info_footer svelte-19vwcsh"><!></div></div>');function Cs(o,i){it(i,!1);let t=Re(i,"entity",8,void 0);const c=()=>t()?ht[t().origin.name]:void 0,_=()=>{var H;return t()&&(t().origin.cardId??!1)?`https://www.db.yugioh-card.com/yugiohdb/card_search.action?ope=2&cid=${t().origin.cardId}`:`https://www.db.yugioh-card.com/yugiohdb/card_search.action?ope=1&sess=1&rp=10&mode=&sort=1&keyword=${(H=c())==null?void 0:H.name}&stype=1&ctype=&othercon=2&starfr=&starto=&pscalefr=&pscaleto=&linkmarkerfr=&linkmarkerto=&link_m=2&atkfr=&atkto=&deffr=&defto=&releaseDStart=1&releaseMStart=1&releaseYStart=1999&releaseDEnd=&releaseMEnd=&releaseYEnd=`};let v=Re(i,"mode",12,"Normal");lt();var g=Ae(),d=W(g);{var S=H=>{var w=xs();w.__contextmenu=[es,v,t];var n=a(w),U=a(n),I=a(U),j=a(I),O=s(U,2),q=a(O),A=a(q),ee=s(q,2),ie=a(ee),Te=s(O,2);{var D=K=>{var R=os(),re=W(R);{var le=G=>{var ae=ts(),Ie=a(ae),$=a(Ie),Z=s(Ie,2),ne=a(Z);u(()=>{f($,`◀ ${t().psL??""}`),f(ne,`${t().psR??""} ▶`)}),r(G,ae)};y(re,G=>{var ae;(ae=t().status.monsterCategories)!=null&&ae.includes("Pendulum")&&G(le)})}var pe=s(re,2);{var z=G=>{var ae=is(),Ie=W(ae),$=a(Ie);oe($,1,()=>t().attr,ve,(Ee,m)=>{var T=as(),k=W(T),P=s(k,2),p=a(P);u(()=>{Ye(k,`monster_attr ${e(m)??""} svelte-19vwcsh`),f(p,`${va[e(m)]??""}属性`)}),r(Ee,T)});var Z=s($,2);oe(Z,1,()=>t().types,ve,(Ee,m)=>{var T=rs(),k=a(T);u(()=>{Ye(T,`monster_cat ${e(m)??""} svelte-19vwcsh`),f(k,`${Vt[e(m)]??""}${da[e(m)]??""}族`)}),r(Ee,T)});var ne=s(Ie,2);oe(ne,5,()=>t().status.monsterCategories??[],ve,(Ee,m)=>{var T=ss(),k=a(T);u(()=>{Ye(T,`monster_cat ${e(m)??""} svelte-19vwcsh`),f(k,`${Qt[e(m)]??""}${ca[e(m)]??""}`)}),r(Ee,T)}),r(G,ae)},M=G=>{var ae=Ae(),Ie=W(ae);{var $=ne=>{var Ee=ls(),m=s(a(Ee),2),T=a(m);u(()=>f(T,`${Zt[t().status.spellCategory]??""}魔法`)),r(ne,Ee)},Z=ne=>{var Ee=Ae(),m=W(Ee);{var T=k=>{var P=ns(),p=s(a(P),2),h=a(p);u(()=>f(h,`${Jt[t().status.trapCategory]??""}罠`)),r(k,P)};y(m,k=>{t().kind==="Trap"&&t().status.trapCategory&&k(T)},!0)}r(ne,Ee)};y(Ie,ne=>{t().kind==="Spell"&&t().status.spellCategory?ne($):ne(Z,!1)},!0)}r(G,ae)};y(pe,G=>{t().kind==="Monster"?G(z):G(M,!1)})}r(K,R)};y(Te,K=>{v()==="Normal"&&K(D)})}var b=s(n,2),L=a(b);{var te=K=>{var R=ds(),re=W(R);{var le=G=>{var ae=vs(),Ie=a(ae),$=a(Ie);u(()=>f($,ht[t().origin.name].pendulumDescription)),r(G,ae)};y(re,G=>{var ae;(ae=t().status.monsterCategories)!=null&&ae.includes("Pendulum")&&G(le)})}var pe=s(re,2),z=a(pe),M=a(z);u(G=>f(M,G),[()=>{var G;return(G=c())==null?void 0:G.description}],he),r(K,R)},xe=K=>{var R=ys(),re=a(R),le=a(re);oe(le,0,()=>["info","status"],ve,(De,V)=>{var ce=us(),Ne=W(ce),C=a(Ne),Y=s(Ne,2);oe(Y,1,()=>Object.entries(t()[V]),ve,(se,Be)=>{let He=()=>e(Be)[0],F=()=>e(Be)[1];var ke=_s(),qe=a(ke),We=s(qe);{var Pe=Je=>{var tt=cs(),Xe=s(W(tt));oe(Xe,1,F,ve,($e,Ue)=>{var Fe=st();u(at=>f(Fe,`${at??""},`),[()=>e(Ue).toString()],he),r($e,Fe)}),r(Je,tt)},ze=Je=>{var tt=st();u(Xe=>f(tt,`${Xe??""},`),[()=>{var Xe;return(Xe=F())==null?void 0:Xe.toString()}],he),r(Je,tt)};y(We,Je=>{Array.isArray(F())?Je(Pe):Je(ze,!1)})}u(()=>f(qe,`"${He()??""}" : `)),r(se,ke)});var N=s(Y,2);N.textContent="},",u(()=>f(C,`"${V??""}" :{`)),r(De,ce)});var pe=s(le,2);pe.textContent='"actions" :[';var z=s(pe,2);oe(z,1,()=>t().actions,ve,(De,V)=>{var ce=fs(),Ne=a(ce);u(()=>f(Ne,`"${e(V).playType??""} ${e(V).title??""}",`)),r(De,ce)});var M=s(z,2);M.textContent="],";var G=s(M,2);G.textContent='"substituteEffects" :[';var ae=s(G,2);oe(ae,1,()=>t().substituteEffects,ve,(De,V)=>{var ce=ps(),Ne=a(ce);u(()=>f(Ne,`"${e(V).title??""}",`)),r(De,ce)});var Ie=s(ae,2);Ie.textContent="],";var $=s(Ie,2);$.textContent='"continuousEffects" :[';var Z=s($,2);oe(Z,1,()=>t().continuousEffects,ve,(De,V)=>{var ce=gs(),Ne=a(ce);u(()=>f(Ne,`"${e(V).isStarted??""}",`)),r(De,ce)});var ne=s(Z,2);ne.textContent="],";var Ee=s(ne,2);Ee.textContent='"procFilters" :[';var m=s(Ee,2);oe(m,1,()=>t().procFilterBundle.operators,ve,(De,V)=>{var ce=ms(),Ne=a(ce);u(C=>f(Ne,`"${C??""} ${e(V).title??""} ${e(V).isEffective??""} ",`),[()=>e(V).isSpawnedBy.toString()],he),r(De,ce)});var T=s(m,2);T.textContent="],";var k=s(T,2);k.textContent='"numericStateOperators" :[';var P=s(k,2);oe(P,1,()=>t().numericOprsBundle.operators,ve,(De,V)=>{var ce=hs(),Ne=a(ce);u(C=>f(Ne,`"${C??""} ${e(V).title??""} ${e(V).isEffective??""} ${e(V).isContinuous??""} ${e(V).targetState??""} ${e(V).targetStateGen??""} ",`),[()=>e(V).isSpawnedBy.toString()],he),r(De,ce)});var p=s(P,2);p.textContent="],";var h=s(p,2);h.textContent='"stateOperators" :[';var ge=s(h,2);oe(ge,1,()=>t().statusOperatorBundle.operators,ve,(De,V)=>{var ce=bs(),Ne=a(ce);u(C=>f(Ne,`"${C??""} ${e(V).title??""} ${e(V).isEffective??""} ",`),[()=>e(V).isSpawnedBy.toString()],he),r(De,ce)});var be=s(ge,2);be.textContent="],";var Me=s(be,2);Me.textContent='"lastMoveLogRecord" :{';var me=s(Me,2),Ce=a(me),E=s(me,2),B=a(E),de=s(E,2),Se=a(de),Ke=s(de,2);Ke.textContent="},",u((De,V)=>{f(Ce,`"movedBy":"${De??""}",`),f(B,`"movedAs":"${V??""}",`),f(Se,`"movedAt":"${t().moveLog.latestRecord.movedAt.totalProcSeq??""}",`)},[()=>{var De;return(De=t().moveLog.latestRecord.movedBy)==null?void 0:De.toString()},()=>t().moveLog.latestRecord.movedAs.join(" ")],he),r(K,R)};y(L,K=>{v()==="Normal"?K(te):K(xe,!1)})}var Q=s(b,2),_e=a(Q);{var X=K=>{var R=ws();r(K,R)},fe=K=>{var R=ks(),re=a(R),le=s(re,2),pe=a(le);u(z=>{var M;gt(re,"href",`https://yugioh-wiki.net/index.php?${t().origin.wikiEncodedName}`),gt(le,"href",z),f(pe,`⇒${((M=t())!=null&&M.origin.cardId?"公式カードページ":"公式で検索")??""}`)},[_],he),r(K,R)};y(_e,K=>{var R;(R=t())!=null&&R.origin.isForTest?K(X):K(fe,!1)})}u((K,R,re)=>{Ye(w,`duel_card duel_card_info ${t().origin.kind??""} ${K??""} svelte-19vwcsh`),f(j,t().nm),f(A,R),f(ie,re)},[()=>{var K;return(K=t().origin.monsterCategories)==null?void 0:K.join(" ")},()=>"★".repeat(t().lvl||0),()=>"☆".repeat(t().rank||0)],he),r(H,w)};y(d,H=>{t()&&H(S)})}r(o,g),nt()}Ia(["contextmenu"]);var Ds=l('<div class="duel_field_cell_info_item svelte-1xj7qf1"><!></div>'),$s=l('<div class="duel_field_cell_info_box svelte-1xj7qf1"><div class="duel_field_cell_info_label svelte-1xj7qf1"> </div> <!></div>'),Ss=l('<div class="duel_field_cell_info svelte-1xj7qf1"><div class="duel_field_cell_info_header item_btn svelte-1xj7qf1"><div class="svelte-1xj7qf1"> </div> <div class="svelte-1xj7qf1"> </div></div> <div class="duel_field_cell_info_body svelte-1xj7qf1"></div></div>');function Ms(o,i){it(i,!1);let t=Re(i,"cell",12);const c=()=>{t(t())},_=S=>t().cardEntities.filter(H=>H.face===S);t().field.duel.view.onDuelUpdate.append(c),lt();var v=Ae(),g=W(v);{var d=S=>{var H=Ss(),w=a(H),n=a(w),U=a(n),I=s(n,2),j=a(I),O=s(w,2);oe(O,4,()=>["FaceUp","FaceDown"],ve,(q,A)=>{var ee=Ae(),ie=W(ee);{var Te=D=>{var b=$s(),L=a(b),te=a(L),xe=s(L,2);oe(xe,1,()=>_(A).toSorted(Xa),ve,(Q,_e)=>{var X=Ds(),fe=a(X);const K=he(()=>t().owner===t().field.duel.duelists.Below);$t(fe,{get entity(){return e(_e)},get isVisibleForcibly(){return e(K)},isWideMode:!0,cardActionResolve:void 0}),r(Q,X)}),u(()=>f(te,A==="FaceUp"?"表向き":"裏向き")),r(D,b)};y(ie,D=>{_(A).length&&D(Te)})}r(q,ee)}),u(()=>{var q;f(U,(q=t().owner)==null?void 0:q.profile.name),f(j,t().cellType)}),r(S,H)};y(g,S=>{t().field.duel.view.infoBoardState==="CellInfo"&&S(d)})}r(o,v),nt()}var Ts=l('<div class="duel_config_item svelte-y4u26k"><label class="toggle svelte-y4u26k"><input type="checkbox" class="svelte-y4u26k"></label> <span class="svelte-y4u26k"> </span></div>'),Es=l('<div class="duel_config svelte-y4u26k"><div class="duel_config_title svelte-y4u26k">デュエル設定</div> <div class="duel_config_group svelte-y4u26k"><div class="duel_config_group_title svelte-y4u26k">チェーン設定</div> <!></div></div>');function qs(o,i){it(i,!1);let t=Re(i,"viewController",8),c=Re(i,"userProfile",12);lt();var _=Ae(),v=W(_);{var g=d=>{var S=Es(),H=s(a(S),2),w=s(a(H),2);oe(w,1,()=>Za,ve,(n,U)=>{var I=Ts(),j=a(I),O=a(j),q=s(j,2),A=a(q);u(()=>f(A,Va[e(U)])),Qa(O,()=>c().chainConfig[e(U)],ee=>c(c().chainConfig[e(U)]=ee,!0)),ye("change",O,()=>c().save()),r(n,I)}),r(d,S)};y(v,d=>{t().infoBoardState==="Config"&&d(g)})}r(o,_),nt()}function As(o,{from:i,to:t},c={}){var{delay:_=0,duration:v=b=>Math.sqrt(b)*120,easing:g=ia}=c,d=getComputedStyle(o),S=d.transform==="none"?"":d.transform,[H,w]=d.transformOrigin.split(" ").map(parseFloat);H/=o.clientWidth,w/=o.clientHeight;var n=Ys(o),U=o.clientWidth/t.width/n,I=o.clientHeight/t.height/n,j=i.left+i.width*H,O=i.top+i.height*w,q=t.left+t.width*H,A=t.top+t.height*w,ee=(j-q)*U,ie=(O-A)*I,Te=i.width/t.width,D=i.height/t.height;return{delay:_,duration:typeof v=="function"?v(Math.sqrt(ee*ee+ie*ie)):v,easing:g,css:(b,L)=>{var te=L*ee,xe=L*ie,Q=b+L*Te,_e=b+L*D;return`transform: ${S} translate(${te}px, ${xe}px) scale(${Q}, ${_e});`}}}function Ys(o){if("currentCSSZoom"in o)return o.currentCSSZoom;for(var i=o,t=1;i!==null;)t*=+getComputedStyle(i).zoom,i=i.parentElement;return t}var Ns=l('<div class="chain_number svelte-d2f52m"> </div>'),Bs=l('<div class="duel_card_row svelte-d2f52m"> </div>'),Is=l('<div class="appendix svelte-d2f52m"> </div>'),Fs=l('<div class="appendix_wrapper svelte-d2f52m"></div>'),Hs=l('<div><div><!> <div> </div> <div><!> <div class="duel_card_row svelte-d2f52m"><div> </div> <!></div></div></div></div>'),Ps=l("<div></div>");function Us(o,i){it(i,!1);let t=Re(i,"duel",8),c=Re(i,"position",8,"left");const _=-100,v=()=>c()==="left"?-100:100;let g=we([]),d=Promise.resolve(),S=Promise.resolve();const H=1e3,w=500,n=400,U=j=>{const O={...j};O.isKnown=j.chainBlockInfo.action.entity.controller.duelistType==="Player"||j.chainBlockInfo.action.entity.face==="FaceUp",O.chainBlockInfo.onStateChange.append(q=>{if(q==="done"||q==="failed"||q==="nagated")return d=d.then(async()=>{const A=new Date().getTime()-O.chainBlockInfo.wasSpawnedAt.getTime();A<H&&await St(H-A),x(g,e(g).filter(ee=>ee.seq!==O.seq)),await St(w+n)}).then(),"RemoveMe";x(g,e(g))}),S=S.then(async()=>{x(g,[O,...e(g)].sort((q,A)=>Ja.isSameChain(q.clock,A.clock)&&q.chainBlockInfo.action.isWithChainBlock&&A.chainBlockInfo.action.isWithChainBlock?A.clock.totalProcSeq-q.clock.totalProcSeq:q.clock.totalProcSeq-A.clock.totalProcSeq)),await St(300)}),d=d.then(()=>St(1e3))};t().chainBlockLog.onInsert.append(U),lt();var I=Ps();oe(I,13,()=>e(g),j=>j.seq,(j,O)=>{var q=Hs();const A=he(()=>{const{activator:R,action:re,appendix:le}=e(O).chainBlockInfo;return{activator:R,action:re,appendix:le}});var ee=a(q),ie=a(ee);{var Te=R=>{var re=Ns(),le=a(re);u(()=>f(le,`チェーン：${e(O).chainBlockInfo.chainNumber??""}`)),r(R,re)};y(ie,R=>{e(O).chainBlockInfo.chainNumber&&R(Te)})}var D=s(ie,2),b=a(D),L=s(D,2),te=a(L);{var xe=R=>{var re=Bs(),le=a(re);u(()=>f(le,e(O).isKnown?e(A).action.entity.nm:"？？？")),r(R,re)};y(te,R=>{(e(A).action.entity.entityType==="Card"||e(A).action.entity.entityType==="Token")&&R(xe)})}var Q=s(te,2),_e=a(Q),X=a(_e),fe=s(_e,2);{var K=R=>{var re=Fs();oe(re,5,()=>e(A).appendix,ve,(le,pe)=>{var z=Is(),M=a(z);u(()=>f(M,e(pe))),r(le,z)}),r(R,re)};y(fe,R=>{e(A).appendix&&R(K)})}u((R,re,le)=>{Ye(q,`cut_in_row ${(!e(O).chainBlockInfo.chainNumber||e(O).chainBlockInfo.chainNumber===1?"cut_in_row_first":"")??""} svelte-d2f52m`),Ye(ee,`cut_in_item cut_in_item_${R??""} cut_in_item_${e(O).chainBlockInfo.state??""} svelte-d2f52m`),Ye(D,`duelist_name duelist_${R??""}_name svelte-d2f52m`),f(b,e(A).activator.profile.name),Ye(L,`duel_card duel_card_${R??""} ${re??""} ${(e(O).isKnown?e(A).action.entity.origin.kind:"")??""} ${e(A).action.entity.entityType??""}  svelte-d2f52m`),f(X,le)},[()=>e(A).activator.seat.toLowerCase(),()=>e(O).isKnown?(e(A).action.entity.status.monsterCategories??[]).join(" "):"Token",()=>e(A).action.toString()],he),J(3,ee,()=>wr,()=>new Date().getTime()-e(O).chainBlockInfo.wasSpawnedAt.getTime()<H?{x:v(),duration:n}:{y:_,duration:n}),er(q,()=>As,()=>({duration:w})),r(j,q)}),u(()=>Ye(I,`cut_in_container cut_in_container_${c()??""} svelte-d2f52m`)),r(o,I),nt()}const js=kr({duration:400});var Os=l('<div class="duel_desk_left v_flex svelte-1i63tk9"><!> <!> <!></div>'),Ls=l('<button class="duel_field_header_message svelte-1i63tk9"> </button> <div class="duel_field_header_buttons svelte-1i63tk9"><button class="svelte-1i63tk9">サレンダー</button></div>',1),Rs=l("<tr></tr>"),Ws=l('<table class="duel_field svelte-1i63tk9"><tbody class="svelte-1i63tk9"></tbody></table>'),Ks=l('<button class="svelte-1i63tk9">OK</button>'),zs=l('<button class="svelte-1i63tk9">cancel</button>'),Gs=l("<!> <!>",1),Xs=l('<button class="svelte-1i63tk9"> </button>'),Vs=l('<div style="text-align: left;"><!> <!> <!></div>'),Qs=l('<div><!> <div class=" duel_desk_center v_flex svelte-1i63tk9"><div class="duel_field_header svelte-1i63tk9"><!></div> <div class="duel_field_body svelte-1i63tk9"><!></div> <div class="duel_field_footer svelte-1i63tk9"><!></div></div> <!></div> <div style="position:fixed;left:0;bottom:0"> </div> <!> <div><!></div>',1);function Zs(o,i){it(i,!1);let t=Re(i,"duel",12),c=Re(i,"userProfile",8),_=we(0),v=we(0),g=we([]),d=we([]),S=()=>{},H=we([]),w=we(),n=we(),U=we(()=>!1),I=we(!1);const j=p=>{S=p.resolve,x(H,p.dummyActionInfos.filter(h=>h.action.entity.entityType==="Duelist").filter(h=>h.action.entity.controller.seat==="Below")),x(w,void 0),x(n,void 0),x(d,[]),x(g,[]),x(I,!1),p.entitiesChoices&&(x(w,p.entitiesChoices),x(U,()=>{var h;return((h=p.entitiesChoices)==null?void 0:h.validator(e(g)))??!1}),x(I,p.entitiesChoices.cancelable),e(w).selectables.every(h=>h.cell.isPlayFieldCell&&h.getIndexInCell()===0||h.cell.cellType==="Hand"&&h.controller.duelistType==="Player"||h.entityType==="Duelist")||t().view.modalController.entitySelector.show({title:t().view.message,position:"Middle",entitiesChoices:p.entitiesChoices,chainBlockInfos:p.chainBlockInfos,cancelable:p.entitiesChoices.cancelable}).then(h=>{S({selectedEntities:h})})),p.cellsChoices&&(x(n,p.cellsChoices),x(U,()=>{var h;return((h=p.cellsChoices)==null?void 0:h.validator(e(d)))??!1}),x(I,p.cellsChoices.cancelable))};t().view.onWaitStart.append(j);const O=()=>{S=()=>{},x(n,void 0),x(w,void 0),x(d,[]),x(g,[]),x(U,()=>!1),x(I,!1)};t().view.onWaitEnd.append(O);let q=we(void 0),A=we("Normal");const ee=({card:p,mode:h})=>{x(q,p),x(A,h)};t().view.onShowCardEntity.append(ee);const ie=()=>{t(t())};t().view.onDuelUpdate.append(ie),t().log.onUpdate.append(ie);const Te=()=>{e(w)&&e(w).validator(e(g))&&S({selectedEntities:e(g)}),e(n)&&e(n).validator(e(d))&&S({selectedCells:e(d)})},D=()=>{S({})},b=p=>{S({actionInfo:p})},L=()=>{S({surrender:!0})};t().main();const te=()=>e(_)<=1400?"compact":"wide";lt();var xe=Qs(),Q=W(xe),_e=a(Q);{var X=p=>{var h=Os(),ge=a(h);Na(ge,{get duelist(){return t().duelists.Above}});var be=s(ge,2);Cs(be,{get entity(){return e(q)},get mode(){return e(A)}});var Me=s(be,2);Na(Me,{get duelist(){return t().duelists.Below}}),r(p,h)};y(_e,p=>{te()==="wide"&&p(X)})}var fe=s(_e,2),K=a(fe),R=a(K);{var re=p=>{var h=Ls(),ge=W(h),be=a(ge),Me=s(ge,2),me=a(Me);u(()=>f(be,`[TURN:${t().clock.turn}][PHASE:${t().phase}] ${t().view.message}`)),ye("click",ge,()=>{t(t().view.infoBoardState="Log",!0)}),ye("click",me,L),r(p,h)};y(R,p=>{t().isEnded||p(re)})}var le=s(K,2),pe=a(le);{var z=p=>{var h=Ws(),ge=a(h);oe(ge,5,()=>t().field.cells,ve,(be,Me,me)=>{var Ce=Rs();Ye(Ce,`${`duel_desk_row_${me}`??""} svelte-1i63tk9`),oe(Ce,5,()=>e(Me),ve,(E,B,de)=>{Lr(E,{get view(){return t().view},row:me,column:de,get selectedEntities(){return e(g)},set selectedEntities(Se){x(g,Se)},get selectedCells(){return e(d)},set selectedCells(Se){x(d,Se)},$$legacy:!0})}),r(be,Ce)}),r(p,h)};y(pe,p=>{t().clock.turn>0&&p(z)})}var M=s(le,2),G=a(M);{var ae=p=>{var h=Gs(),ge=W(h);{var be=Ce=>{var E=Ks();u(B=>E.disabled=B,[()=>!e(U)()],he),ye("click",E,Te),r(Ce,E)};y(ge,Ce=>{((e(w)&&e(w).qty)??(e(n)&&e(n).qty)??9999)>1&&Ce(be)})}var Me=s(ge,2);{var me=Ce=>{var E=zs();ye("click",E,D),r(Ce,E)};y(Me,Ce=>{e(I)&&Ce(me)})}r(p,h)},Ie=p=>{var h=Ae(),ge=W(h);oe(ge,1,()=>e(H),ve,(be,Me)=>{var me=Xs(),Ce=a(me);u(()=>f(Ce,e(Me).action.title)),ye("click",me,()=>b(e(Me))),r(be,me)}),r(p,h)};y(G,p=>{e(w)&&e(w).selectables.length||e(n)&&e(n).selectables?p(ae):p(Ie,!1)})}var $=s(fe,2);{var Z=p=>{var h=Vs(),ge=a(h);Zr(ge,{get log(){return t().log}});var be=s(ge,2);Ms(be,{get cell(){return t().view.infoBoardCell}});var Me=s(be,2);qs(Me,{get userProfile(){return c()},get viewController(){return t().view}}),u(me=>Ye(h,`duel_desk_right duel_desk_right_${me??""}  svelte-1i63tk9`),[()=>t().view.infoBoardState.toLowerCase()],he),J(3,h,()=>ue,()=>({duration:e(_)>1400?0:200,axis:"x"})),r(p,h)};y($,p=>{(e(_)>1400||t().view.infoBoardState!=="Default")&&p(Z)})}var ne=s(Q,2),Ee=a(ne),m=s(ne,2);tr(m,{get modalController(){return t().view.modalController}});var T=s(m,2),k=a(T);const P=he(()=>te()==="wide"?"right":"left");Us(k,{get duel(){return t()},get position(){return e(P)}}),u((p,h)=>{Ye(Q,`flex duel_desk ${p??""}_mode svelte-1i63tk9`),f(Ee,h),Ye(T,`cutin ${p??""}_mode svelte-1i63tk9`)},[te,()=>t().clock.toFullString()],he),Kt("innerWidth",p=>x(_,p)),Kt("innerHeight",p=>x(v,p)),r(o,xe),nt()}var Js=l('<div class="svelte-swqq02"><button class="button_style_reset svelte-swqq02" title="※shiftキー同時押しで一括外し">クリア</button></div>'),ei=l('<div class="svelte-swqq02"><button class="button_style_reset svelte-swqq02" title="※shiftキー同時押しで一括外し">クリア</button></div>'),ti=l("<div></div>"),ai=l("<!> <!> <!> <!> <!>",1),ri=l('<span> </span> / <span style="display: inline-block;width:2rem;text-align: right;"> </span>',1),si=l('<li class="deck_editor_item svelte-swqq02"><div role="listitem"><div class="svelte-swqq02"><div class="svelte-swqq02"> </div> <div style="display:flex" class="svelte-swqq02"><div class="svelte-swqq02"><!> <!> <!></div> <div style="flex-grow: 1; width:0.1rem" class="svelte-swqq02"></div> <div class="svelte-swqq02"><!></div></div></div></div> <button class="button_style_reset svelte-swqq02" title="※shiftキー同時押しで一括投入">+</button> <button class="button_style_reset svelte-swqq02" title="※shiftキー同時押しで一括外し">-</button></li>'),ii=l('<div class="deck_editor_card_kind svelte-swqq02"><div class="deck_editor_card_kind_header svelte-swqq02"><div class="svelte-swqq02"> </div> <!></div> <ul class="svelte-swqq02"></ul></div>'),li=l('<div class="deck_editor_deck_type svelte-swqq02"><div class="deck_editor_deck_type_header svelte-swqq02"><div class="svelte-swqq02"> </div> <!></div> <!></div>'),ni=l('<div class="svelte-swqq02">読み込み中...</div>'),oi=l('<div class="deck_editor_card_list svelte-swqq02"><!></div>');function Ba(o,i){it(i,!1);let t=Re(i,"allCardInfos",8),c=Re(i,"deckCardInfos",12),_=Re(i,"mode",8),v=Re(i,"onAttention",8),g=Re(i,"searchCondition",8,void 0);const d={Deck:["Monster","Spell","Trap"],ExtraDeck:["Monster"]},S={Deck:{Monster:[],Spell:[],Trap:[]},ExtraDeck:{Monster:[],Spell:[],Trap:[]}},H=D=>{var b;return(b=D.monsterCategories)!=null&&b.union(zt).length?"ExtraDeck":"Deck"},w=D=>{Object.values(S).forEach(b=>Object.values(b).forEach(L=>L.reset())),D.filter(b=>b.isImplemented).filter(b=>b.kind!=="XyzMaterial").forEach(b=>{var te;if(b.kind==="XyzMaterial")return;const L=(te=b.monsterCategories)!=null&&te.union(zt).length?"ExtraDeck":"Deck";S[L][b.kind].push(b)}),Object.values(S).forEach(b=>Object.values(b).forEach(L=>L.sort(ra)))},n=_()==="List"?new Promise(D=>{w(t()),D()}):Promise.resolve(),U=()=>(_()==="Deck"&&(w(c()),x(q,c().length)),S),I=(D,b,L)=>{c(c().filter(te=>H(te)!==b||te.kind!==L&&L))},j=(D,b)=>{try{if(D.ctrlKey){c().push(b);return}const L=c().filter(xe=>xe.name===b.name).length;if(L>2)return;const te=D.shiftKey?3-L:1;if(te<1)return;c().push(...Array(te).fill(b))}finally{c().sort(ra),c(c())}},O=(D,b)=>{let L=0;c(c().filter(te=>te.name!==b.name?!0:(L++,!D.shiftKey&&L>1))),c().sort(ra)};let q=we(100);const A=()=>{e(q)>t().length+c().length||(x(q,e(q)+10),St(100).then(A))};St(100).then(A);const ee=(D,b)=>{if(!g())return!0;if(!g().cardKinds.includes(D.kind)||g().name.trim().length&&[D.name,...D.nameTags??[],...D.textTags??[]].every(te=>!te.includes(g().name))||D.isForTest&&!g().others.includes("test"))return!1;if(D.kind==="Monster")return D.attributes&&!g().monsterAttributes.union(D.attributes).length||D.types&&!g().monsterTypes.union(D.types).length||!D.monsterCategories?!1:D.monsterCategories.union(g().monsterCategories).length;if(D.kind==="Spell")return D.spellCategory&&g().spellCategories.includes(D.spellCategory);if(D.kind==="Trap")return D.trapCategory&&g().trapCategories.includes(D.trapCategory)};lt();var ie=oi(),Te=a(ie);bt(Te,()=>n,D=>{var b=ni();r(D,b)},D=>{var b=Ae();const L=he(U);var te=W(b);oe(te,1,()=>rr,ve,(xe,Q)=>{var _e=li();const X=he(()=>Object.values(e(L)[e(Q)]).flatMap(z=>z));var fe=a(_e),K=a(fe),R=a(K),re=s(K,2);{var le=z=>{var M=Js(),G=a(M);ye("click",G,ae=>I(ae,e(Q),void 0)),r(z,M)};y(re,z=>{_()==="Deck"&&e(X).some(ee)&&z(le)})}var pe=s(fe,2);oe(pe,1,()=>oa(e(L)[e(Q)]).filter(z=>d[e(Q)].includes(z)),ve,(z,M)=>{var G=ii();const ae=he(()=>e(L)[e(Q)][e(M)].filter(ee));var Ie=a(G),$=a(Ie),Z=a($),ne=s($,2);{var Ee=T=>{var k=ei(),P=a(k);ye("click",P,p=>I(p,e(Q),e(M))),r(T,k)};y(ne,T=>{_()==="Deck"&&e(ae).length&&T(Ee)})}var m=s(Ie,2);oe(m,5,()=>e(ae),ve,(T,k,P)=>{var p=Ae(),h=W(p);{var ge=be=>{var Me=si(),me=a(Me),Ce=a(me),E=a(Ce),B=a(E),de=s(E,2),Se=a(de),Ke=a(Se);{var De=F=>{var ke=ai(),qe=W(ke);{var We=$e=>{var Ue=st();u(()=>f(Ue,`★${e(k).level??""}`)),r($e,Ue)};y(qe,$e=>{e(k).level&&$e(We)})}var Pe=s(qe,2);{var ze=$e=>{var Ue=st();u(()=>f(Ue,`☆${e(k).rank??""}`)),r($e,Ue)};y(Pe,$e=>{e(k).rank&&$e(ze)})}var Je=s(Pe,2);oe(Je,1,()=>e(k).attributes??[],ve,($e,Ue)=>{var Fe=ti();u(()=>Ye(Fe,`monster_attr ${e(Ue)??""} svelte-swqq02`)),r($e,Fe)});var tt=s(Je,2);oe(tt,1,()=>e(k).types??[],ve,($e,Ue)=>{var Fe=st();u(()=>f(Fe,Vt[e(Ue)])),r($e,Fe)});var Xe=s(tt,2);oe(Xe,1,()=>e(k).monsterCategories??[],ve,($e,Ue)=>{var Fe=st();u(()=>f(Fe,Qt[e(Ue)])),r($e,Fe)}),r(F,ke)};y(Ke,F=>{e(k).kind==="Monster"&&F(De)})}var V=s(Ke,2);{var ce=F=>{var ke=st();u(()=>f(ke,`${Zt[e(k).spellCategory]??""}魔法`)),r(F,ke)};y(V,F=>{e(k).spellCategory!==void 0&&F(ce)})}var Ne=s(V,2);{var C=F=>{var ke=st();u(()=>f(ke,`${Jt[e(k).trapCategory]??""}罠`)),r(F,ke)};y(Ne,F=>{e(k).trapCategory!==void 0&&F(C)})}var Y=s(Se,4),N=a(Y);{var se=F=>{var ke=ri(),qe=W(ke),We=a(qe),Pe=s(qe,2),ze=a(Pe);u(()=>{f(We,e(k).attack??"?"),f(ze,e(k).defense??"?")}),r(F,ke)};y(N,F=>{e(k).kind==="Monster"&&F(se)})}var Be=s(me,2),He=s(Be,2);u(F=>{Ye(me,`${F??""} svelte-swqq02`),f(B,e(k).name)},[()=>{var F,ke;return`deck_editor_card duel_card ${e(k).kind} ${(ke=(F=e(k))==null?void 0:F.monsterCategories)==null?void 0:ke.join(" ")} ${e(k).isImplemented?"is_implemented":"is_not_implemented"}`}],he),ye("mouseenter",me,()=>v()(e(k))),ye("click",Be,F=>j(F,e(k))),ye("click",He,F=>O(F,e(k))),r(be,Me)};y(h,be=>{P<e(q)&&be(ge)})}r(T,p)}),u(()=>f(Z,`${Fa[e(M)]??""}（${e(ae).length??""} / ${e(L)[e(Q)][e(M)].length??""}枚）`)),r(z,G)}),u(z=>f(R,`${ar[e(Q)]??""}（${z??""} / ${e(X).length??""}枚）`),[()=>e(X).filter(ee).length],he),r(xe,_e)}),r(D,b)}),r(o,ie),nt()}var vi=l('<div class="duel_card_info_row svelte-rccxcp" style="position:sticky; top:0;"><div class="svelte-rccxcp"> </div> <div class="svelte-rccxcp"> </div></div>'),di=l('<div class="duel_card_info_row svelte-rccxcp"><div class="svelte-rccxcp"><pre class="description svelte-rccxcp"> </pre></div></div> <div class="duel_card_info_row svelte-rccxcp" style=" justify-content: space-between;"><div class="svelte-rccxcp"> </div> <div class="svelte-rccxcp"> </div></div>',1),ci=l('<div></div> <div class="svelte-rccxcp"> </div>',1),_i=l("<div> </div>"),ui=l("<div> </div>"),fi=l('<div class="duel_card_info_row svelte-rccxcp"><!> <!></div> <div class="duel_card_info_row svelte-rccxcp"></div>',1),pi=l('<div class="duel_card_row svelte-rccxcp"><div class="svelte-rccxcp"></div> <div class="svelte-rccxcp"> </div></div>'),gi=l('<div class="duel_card_row svelte-rccxcp"><div class="svelte-rccxcp"></div> <div class="svelte-rccxcp"> </div></div>'),mi=l('<div class="duel_card_info_row svelte-rccxcp"><div class="svelte-rccxcp">※テスト用カードです</div></div>'),hi=l('<div class="duel_card_info_links svelte-rccxcp"><a target="_blank" rel="noopener noreferrer" title="遊戯王カードWiki" class="svelte-rccxcp">⇒遊戯王カードWiki</a> <a target="_blank" rel="noopener noreferrer" title="コナミカードデータベース" class="svelte-rccxcp"> </a></div>'),bi=l('<div><div class="duel_card_info_header svelte-rccxcp"><div class="duel_card_info_row svelte-rccxcp"><div class="svelte-rccxcp"> </div></div> <!></div> <div class="duel_card_info_body svelte-rccxcp"><!> <!> <div class="duel_card_info_row description svelte-rccxcp"><div class="svelte-rccxcp"><pre class="description svelte-rccxcp"> </pre></div></div> <!></div></div>');function yi(o,i){it(i,!1);let t=Re(i,"cardInfo",8,void 0);const c=()=>t()?ht[t().name]:void 0;lt();var _=Ae(),v=W(_);{var g=d=>{var S=bi(),H=a(S),w=a(H),n=a(w),U=a(n),I=s(w,2);{var j=X=>{var fe=vi(),K=a(fe),R=a(K),re=s(K,2),le=a(re);u((pe,z)=>{f(R,pe),f(le,z)},[()=>"★".repeat(t().level||0),()=>"☆".repeat(t().rank||0)],he),r(X,fe)};y(I,X=>{t().kind==="Monster"&&X(j)})}var O=s(H,2),q=a(O);{var A=X=>{var fe=di(),K=W(fe),R=a(K),re=a(R),le=a(re),pe=s(K,2),z=a(pe),M=a(z),G=s(z,2),ae=a(G);u(()=>{f(le,ht[t().name].pendulumDescription),f(M,`◀ ${t().pendulumScaleL??""}`),f(ae,`${t().pendulumScaleR??""} ▶`)}),r(X,fe)};y(q,X=>{var fe;(fe=t().monsterCategories)!=null&&fe.includes("Pendulum")&&X(A)})}var ee=s(q,2);{var ie=X=>{var fe=fi(),K=W(fe),R=a(K);{var re=M=>{var G=ci(),ae=W(G),Ie=s(ae,2),$=a(Ie);u(()=>{Ye(ae,`monster_attr ${t().attributes[0]??""} svelte-rccxcp`),f($,`${va[t().attributes[0]]??""}属性`)}),r(M,G)};y(R,M=>{t().attributes&&M(re)})}var le=s(R,2);{var pe=M=>{var G=_i(),ae=a(G);u(()=>{Ye(G,`monster_cat ${t().types[0]??""} svelte-rccxcp`),f(ae,`${Vt[t().types[0]]??""}${da[t().types[0]]??""}族`)}),r(M,G)};y(le,M=>{t().types&&M(pe)})}var z=s(K,2);oe(z,5,()=>t().monsterCategories??[],ve,(M,G)=>{var ae=ui(),Ie=a(ae);u(()=>{Ye(ae,`monster_cat ${e(G)??""} svelte-rccxcp`),f(Ie,`${Qt[e(G)]??""}${ca[e(G)]??""}`)}),r(M,ae)}),r(X,fe)},Te=X=>{var fe=Ae(),K=W(fe);{var R=le=>{var pe=pi(),z=s(a(pe),2),M=a(z);u(()=>f(M,`${Zt[t().spellCategory]??""}魔法`)),r(le,pe)},re=le=>{var pe=Ae(),z=W(pe);{var M=G=>{var ae=gi(),Ie=s(a(ae),2),$=a(Ie);u(()=>f($,`${Jt[t().trapCategory]??""}罠`)),r(G,ae)};y(z,G=>{t().kind==="Trap"&&t().trapCategory&&G(M)},!0)}r(le,pe)};y(K,le=>{t().kind==="Spell"&&t().spellCategory?le(R):le(re,!1)},!0)}r(X,fe)};y(ee,X=>{t().kind==="Monster"?X(ie):X(Te,!1)})}var D=s(ee,2),b=a(D),L=a(b),te=a(L),xe=s(D,2);{var Q=X=>{var fe=mi();r(X,fe)},_e=X=>{var fe=hi(),K=a(fe),R=s(K,2),re=a(R);u(le=>{gt(K,"href",`https://yugioh-wiki.net/index.php?${t().wikiEncodedName}`),gt(R,"href",le),f(re,`⇒${(t().cardId?"公式カードページ":"公式で検索")??""}`)},[()=>sr(t())],he),r(X,fe)};y(xe,X=>{t().isForTest?X(Q):X(_e,!1)})}u((X,fe)=>{Ye(S,`duel_card duel_card_info ${t().kind??""} ${X??""} svelte-rccxcp`),f(U,t().name),f(te,fe)},[()=>{var X;return(X=t().monsterCategories)==null?void 0:X.join(" ")},()=>{var X;return(X=c())==null?void 0:X.description}],he),r(d,S)};y(v,d=>{t()&&d(g)})}r(o,_),nt()}const wi={0:{aaa:"日",aaaa:"日曜日",ddd:"Sun",dddd:"Sunday"},1:{aaa:"月",aaaa:"月曜日",ddd:"Mon",dddd:"Monday"},2:{aaa:"火",aaaa:"火曜日",ddd:"Tue",dddd:"Tuesday"},3:{aaa:"水",aaaa:"水曜日",ddd:"Wed",dddd:"Wednesday"},4:{aaa:"木",aaaa:"木曜日",ddd:"Thu",dddd:"Thursday"},5:{aaa:"金",aaaa:"金曜日",ddd:"Fri",dddd:"Friday"},6:{aaa:"土",aaaa:"土曜日",ddd:"Sat",dddd:"Saturday"}};class ki{constructor(){Qe(this,"DefaultSeparator1","/");Qe(this,"DefaultSeparator2"," ");Qe(this,"DefaultSeparator3",":");Qe(this,"createDate",i=>{if(!i)return;const t=new Date(i);if(!isNaN(t.getTime()))return t});Qe(this,"createDateOr",(i,t)=>this.createDate(i)||t||new Date);Qe(this,"truncateDate",i=>{const t=i||new Date;return new Date(t.getFullYear(),t.getMonth(),t.getDate())});Qe(this,"addDate",(i,t)=>{const c=this.createDateOr(i);return c.setDate(c.getDate()+t),c});Qe(this,"addMonth",(i,t)=>{const c=this.createDateOr(i);return c.setMonth(c.getMonth()+t),c});Qe(this,"addYear",(i,t)=>{const c=this.createDateOr(i);return c.setFullYear(c.getFullYear()+t),c});Qe(this,"getDayOfWeek",(i,t="dddd")=>{const c=this.createDate(i);return c?wi[c.getDay()][t]:""});Qe(this,"formatToYYYYMMDD",(i,t=this.DefaultSeparator1)=>{const c=this.createDate(i);if(!c)return"";const _=c.getFullYear().toString(),v=("0"+(c.getMonth()+1)).slice(-2),g=("0"+c.getDate()).slice(-2);return _+t+v+t+g});Qe(this,"formatToYYYYMM",(i,t=this.DefaultSeparator1)=>{const c=this.createDate(i);if(!c)return"";t||(t="");const _=c.getFullYear().toString(),v=("0"+(c.getMonth()+1)).slice(-2);return _+t+v});Qe(this,"formatToHHMMSS",(i,t=this.DefaultSeparator3)=>{const c=this.createDate(i);if(!c)return"";t||(t="");const _=c.getHours(),v=c.getMinutes(),g=c.getSeconds();return("0"+_).slice(-2)+t+("0"+v).slice(-2)+t+("0"+g).slice(-2)});Qe(this,"formatToHHMM",(i,t=this.DefaultSeparator3)=>{const c=this.createDate(i);if(!c)return"";t||(t="");const _=("0"+c.getHours()).slice(-2),v=("0"+c.getMinutes()).slice(-2);return _+t+v});Qe(this,"formatToYYYYMMDD_HHMM",(i,t=this.DefaultSeparator1,c=this.DefaultSeparator2,_=this.DefaultSeparator3)=>{const v=this.createDate(i);return v?this.formatToYYYYMMDD(v,t)+c+this.formatToHHMM(v,_):""});Qe(this,"formatToYYYYMMDD_HHMMSS",(i,t=this.DefaultSeparator1,c=this.DefaultSeparator2,_=this.DefaultSeparator3)=>{const v=this.createDate(i);return v?this.formatToYYYYMMDD(v,t)+c+this.formatToHHMMSS(v,_):""})}}const vt=new ki;Date.prototype.truncateDate=function(){return vt.truncateDate(this)};Date.prototype.getCloneOr=function(o){return vt.createDateOr(this,o)};Date.prototype.addDate=function(o){return vt.addDate(this,o)};Date.prototype.addMonth=function(o){return vt.addDate(this,o)};Date.prototype.addYear=function(o){return vt.addDate(this,o)};Date.prototype.getDayOfWeek=function(o="dddd"){return vt.getDayOfWeek(this,o)};Date.prototype.formatToYYYYMM=function(o){return vt.formatToYYYYMM(this,o)};Date.prototype.formatToYYYYMMDD=function(o){return vt.formatToYYYYMMDD(this,o)};Date.prototype.formatToYYYYMMDD_HHMM=function(o,i,t){return vt.formatToYYYYMMDD_HHMM(this,o,i,t)};Date.prototype.formatToYYYYMMDD_HHMMSS=function(o,i,t){return vt.formatToYYYYMMDD_HHMMSS(this,o,i,t)};Date.prototype.formatToHHMM=function(o){return vt.formatToHHMM(this,o)};Date.prototype.formatToHHMMSS=function(o){return vt.formatToHHMMSS(this,o)};var xi=l('<li class="deck_info_list_item svelte-2wdgc8"><div class="svelte-2wdgc8"> </div> <div class="svelte-2wdgc8"> </div> <div class="svelte-2wdgc8"> </div></li>'),Ci=l('<ul class="deck_info_list svelte-2wdgc8"></ul>'),Di=l('<label for="file_selector" class="upload_area svelte-2wdgc8" role="region" aria-label="ファイルアップロードエリア"><div class="upload_area_message svelte-2wdgc8">ここにファイルをドロップ</div> <div class="upload_area_footer svelte-2wdgc8"><input type="file" id="file_selector" name="file_selector" accept=".json" multiple></div></label>'),$i=l('<div slot="body" class="modal_body svelte-2wdgc8"><!></div>'),Si=l('<button class="svelte-2wdgc8">追加</button> <button class="svelte-2wdgc8">削除して追加</button> <button class="svelte-2wdgc8">戻る</button>',1),Mi=l('<button class="svelte-2wdgc8">Cancel</button>'),Ti=l('<div slot="footer" class="modal_window_footer svelte-2wdgc8"><!></div>');function Ei(o,i){it(i,!1);let t=Re(i,"eventHolder",8),c=Re(i,"args",8),_=Re(i,"resolve",8),v=we(Promise.resolve([])),g=we();const d=()=>{x(g,new DataTransfer().files),x(v,Promise.resolve([]))},S=async I=>{I.preventDefault(),console.log("hoge",I)},H=async I=>{I.preventDefault(),I.dataTransfer&&n(I.dataTransfer.files)},w=()=>{n(e(g))},n=async I=>{if(!I.length)return;const j=[],O=[];for(const q of I)try{O.push(...await ut.createfromJson(q))}catch(A){A instanceof Error&&j.push(A.message)}if(j.length){console.log(...j);return}x(v,e(v).then(()=>O))},U=d;lt(),ir(o,{get eventHolder(){return t()},get args(){return c()},$$slots:{body:(I,j)=>{var O=$i(),q=a(O);bt(q,()=>e(v),null,(A,ee)=>{var ie=Ae(),Te=W(ie);{var D=L=>{var te=Ci();oe(te,5,()=>e(ee),ve,(xe,Q)=>{var _e=xi(),X=a(_e),fe=a(X),K=s(X,2),R=a(K),re=s(K,2),le=a(re);u((pe,z,M)=>{f(fe,e(Q).name),f(R,`${pe??""}
                /
                ${z??""}`),f(le,`最終使用日時 ： ${M??""}`)},[()=>e(Q).cardNames.filter(pe=>c().mainCardNames.includes(pe)).length,()=>e(Q).cardNames.filter(pe=>c().exCardNames.includes(pe)).length,()=>e(Q).lastUsedAt.formatToYYYYMMDD_HHMM("/"," ",":")],he),r(xe,_e)}),r(L,te)},b=L=>{var te=Di(),xe=s(a(te),2),Q=a(xe);lr(Q,()=>e(g),_e=>x(g,_e)),ye("change",Q,w),ye("cancel",Q,U),ye("drop",te,H),ye("dragover",te,S),r(L,te)};y(Te,L=>{e(ee).length?L(D):L(b,!1)})}r(A,ie)}),r(I,O)},footer:(I,j)=>{var O=Ti(),q=a(O);bt(q,()=>e(v),null,(A,ee)=>{var ie=Ae(),Te=W(ie);{var D=L=>{var te=Si(),xe=W(te),Q=s(xe,2),_e=s(Q,2);u(()=>{xe.disabled=e(ee).length===0,Q.disabled=e(ee).length===0}),ye("click",xe,()=>_()({deckInfos:e(ee),replaceAll:!1})),ye("click",Q,()=>_()({deckInfos:e(ee),replaceAll:!0})),ye("click",_e,U),r(L,te)},b=L=>{var te=Ae(),xe=W(te);{var Q=_e=>{var X=Mi();ye("click",X,()=>_()(void 0)),r(_e,X)};y(xe,_e=>{c().cancelable&&_e(Q)},!0)}r(L,te)};y(Te,L=>{e(ee).length?L(D):L(b,!1)})}r(A,ie)}),r(I,O)}}}),nt()}const Xt=class Xt extends or{constructor(i,t){super(i,...Object.values(t))}};Qe(Xt,"createModalController",i=>{const t={deckUploader:new vr({title:"デッキ情報をアップロード",position:"Middle",cancelable:!1,mainCardNames:[],exCardNames:[]})};return Object.assign(new Xt(i,t),t)});let na=Xt;function qi(o,i){it(i,!1);let t=Re(i,"modalController",8);lt(),nr(o,{get modalController(){return t()},children:(c,_)=>{var v=Ae(),g=W(v);{var d=S=>{Ei(S,{get eventHolder(){return t().eventHolder},get args(){return t().deckUploader.args},get resolve(){return t().deckUploader.resolve}})};y(g,S=>{t().deckUploader.state==="Shown"&&S(d)})}r(c,v)},$$slots:{default:!0}}),nt()}var Ai=l('<label><input type="checkbox"> </label>'),Yi=l('<label><input type="checkbox"> </label>'),Ni=l('<label><input type="checkbox"> <div style="display: inline-block;"></div> </label>'),Bi=l('<label><input type="checkbox"> </label>'),Ii=l('<div class="deck_editor_search_box_row svelte-1s1plv5"><div class="svelte-1s1plv5"><button class="search_condition_title black_button svelte-1s1plv5">モンスター</button></div> <div class="svelte-1s1plv5"></div></div> <div class="deck_editor_search_box_row svelte-1s1plv5"><div class="svelte-1s1plv5"><button class="search_condition_title black_button svelte-1s1plv5">属性</button></div> <div class="svelte-1s1plv5"></div></div> <div class="deck_editor_search_box_row svelte-1s1plv5"><div class="svelte-1s1plv5"><button class="search_condition_title black_button svelte-1s1plv5">種族</button></div> <div class="svelte-1s1plv5"></div></div>',1),Fi=l('<label><input type="checkbox"> </label>'),Hi=l('<div class="deck_editor_search_box_row svelte-1s1plv5"><div class="svelte-1s1plv5"><button class="search_condition_title black_button svelte-1s1plv5">魔法</button></div> <div class="svelte-1s1plv5"></div></div>'),Pi=l('<label><input type="checkbox"> </label>'),Ui=l('<div class="deck_editor_search_box_row svelte-1s1plv5"><div class="svelte-1s1plv5"><button class="search_condition_title black_button svelte-1s1plv5">罠</button></div> <div class="svelte-1s1plv5"></div></div>'),ji=l('<label><input type="checkbox"> </label>'),Oi=l("<option> </option>"),Li=l('<div class="svelte-1s1plv5"><a class="white_button svelte-1s1plv5" download="SVS_DeckInfos.json">ダウンロード</a></div>'),Ri=l('<div class="svelte-1s1plv5"></div>'),Wi=l('<div class="svelte-1s1plv5"><a class="white_button svelte-1s1plv5" download="SVS_DeckInfos.json">ダウンロード(一括)</a></div>'),Ki=l('<div class="svelte-1s1plv5"></div>'),zi=l('<div class="deck_editor_body_right_header svelte-1s1plv5"><div class="deck_editor_body_right_header_row svelte-1s1plv5"><div class="svelte-1s1plv5">編集対象 <select></select></div> <div class="svelte-1s1plv5"></div> <div class="svelte-1s1plv5">新規名称 <input type="text"></div></div> <div class="deck_editor_body_right_header_row svelte-1s1plv5"></div> <div class="deck_editor_body_right_header_row svelte-1s1plv5"><div class="svelte-1s1plv5">基本操作</div> <div class="svelte-1s1plv5"><button class="white_button svelte-1s1plv5">デッキを保存</button></div> <div class="svelte-1s1plv5"></div> <div class="svelte-1s1plv5"><button class="white_button svelte-1s1plv5">デッキを複製</button></div> <div class="svelte-1s1plv5"><button class="white_button svelte-1s1plv5" title="shiftキー押下で確認メッセージスキップ">デッキを削除</button></div></div> <div class="deck_editor_body_right_header_row svelte-1s1plv5"><div class="svelte-1s1plv5">DL/UL</div> <!> <!> <div class="svelte-1s1plv5"><button class="white_button svelte-1s1plv5">アップロード</button></div></div></div> <!>',1),Gi=l("<div>デッキ情報読込中</div>"),Xi=l('<div class="deck_editor svelte-1s1plv5"><div class="deck_editor_header"></div> <div class="deck_editor_body svelte-1s1plv5"><div class="deck_editor_body_left svelte-1s1plv5"><div role="contentinfo"><div class="deck_editor_search_box_header svelte-1s1plv5"><div>検索条件</div> <div><button class="white_button svelte-1s1plv5">条件クリア</button></div></div> <div class="deck_editor_search_box_row svelte-1s1plv5"><div class="svelte-1s1plv5">名称</div> <div class="svelte-1s1plv5"><input type="text" style="width:70%"> <button class="white_button svelte-1s1plv5">クリア</button> <span>※ルビには対応していません</span></div></div> <div class="deck_editor_search_box_row svelte-1s1plv5"><div class="svelte-1s1plv5"><button class="search_condition_title black_button svelte-1s1plv5">種類</button></div> <div class="svelte-1s1plv5"></div></div> <!> <!> <!> <div class="deck_editor_search_box_row svelte-1s1plv5"><div class="svelte-1s1plv5"><button class="search_condition_title black_button svelte-1s1plv5">その他</button></div> <div class="svelte-1s1plv5"></div></div></div> <!></div> <div class="deck_editor_body_center svelte-1s1plv5"><!></div> <div class="deck_editor_body_right svelte-1s1plv5"><!></div></div> <div class="footer svelte-1s1plv5"></div></div> <!>',1);function Vi(o,i){it(i,!1);const t=[],c=[],_=[],v=[],g=[],d=[],S=[],H=na.createModalController({onDragStart:{append:()=>{},remove:()=>{}},onDragEnd:{append:()=>{},remove:()=>{}}}),w={name:"",cardKinds:ka.filter(C=>C!=="XyzMaterial"),monsterCategories:[...Sa],monsterAttributes:[...$a],monsterTypes:[...Da],spellCategories:[...Ca],trapCategories:[...xa],others:["test"]},n=we(structuredClone(w));Le(n,e(n).others=[]);let U=we("SearchCondition");const I=async()=>{Le(n,e(n).name=""),Le(n,e(n).cardKinds=[]),Le(n,e(n).monsterCategories=[]),Le(n,e(n).monsterAttributes=[]),Le(n,e(n).monsterTypes=[]),Le(n,e(n).spellCategories=[]),Le(n,e(n).trapCategories=[]),Le(n,e(n).others=[])},j=async C=>{Array.isArray(e(n)[C])&&Array.isArray(w[C])&&Le(n,e(n)[C]=e(n)[C].length?[]:[...w[C]])},O=(C,Y,N)=>{Array.isArray(e(n)[Y])&&Array.isArray(w[Y])&&Le(n,e(n)[Y]=[N])},q=async()=>{const Y=(await e(ie)).find(N=>N.id===e(ee));Y&&x(b,{...Y,cardInfos:Y.cardNames.map(N=>ht[N])})},A=()=>ut.getAllDeckInfo().then(C=>(x(ee,(C.find(Y=>Y.lastUsedAt.getTime()===Math.max(...C.map(N=>N.lastUsedAt.getTime())))??C[0]).id),C));let ee=we(-1),ie=we(A()),Te=we(e(ie).then(C=>ut.convertToObjectURL(C)));e(ie).then(q);const D=()=>{x(ie,A()),x(Te,e(ie).then(C=>ut.convertToObjectURL(C))),q()};let b=we({id:-Number.MAX_VALUE,name:"",description:"",lastUsedAt:new Date,cardInfos:[]}),L=we(ht.ゾンビーノ);const te=C=>{x(U,"CardDetail"),x(L,C)},xe=async()=>{const Y=(await e(ie)).find(N=>N.id===e(ee));if(!Y)throw new Error("illegal state");return Y},Q=async()=>{const C=await xe();await C.saveDeckInfo({...C,name:e(b).name,cardNames:e(b).cardInfos.map(Y=>Y.name),lastUsedAt:new Date}),D()},_e=async()=>{(await ut.createNewDeck(`デッキ_${new Date().formatToYYYYMMDD_HHMMSS("","","")}`,`コピー日時：${new Date().formatToYYYYMMDD_HHMMSS("-"," ",":")}`,e(b).cardInfos.map(Y=>Y.name))).saveDeckInfo(),D()},X=async C=>{const Y=await xe();!C.shiftKey&&!confirm(`デッキ【${Y.name}】を削除します。
よろしいですか？`)||(await Y.delete(),D())},fe=async()=>{const C=await H.deckUploader.show({title:"デッキ情報アップロード",position:"Middle",cancelable:!0,mainCardNames:Object.values(ht).filter(N=>{var se;return!((se=N.monsterCategories)!=null&&se.union(zt).length)}).map(N=>N.name),exCardNames:Object.values(ht).filter(N=>{var se;return(se=N.monsterCategories)==null?void 0:se.union(zt).length}).map(N=>N.name)});if(!C)return;const Y=[];if(C.replaceAll){if(!confirm(`既存デッキ情報を全て削除し、アップロードしたファイルに置き換えます。
よろしいですか？`))return;Y.push(...(await e(ie)).map(N=>N.id))}await Promise.all(C.deckInfos.map(N=>ut.createNewDeck(N.name,N.description,N.cardNames,N.lastUsedAt))),Y.length&&await Promise.all(Y.map(ut.remove)),D()};lt();var K=Xi(),R=W(K),re=s(a(R),2),le=a(re),pe=a(le),z=a(pe),M=s(a(z),2),G=a(M),ae=s(z,2),Ie=s(a(ae),2),$=a(Ie),Z=s($,2),ne=s(ae,2),Ee=a(ne),m=a(Ee),T=s(Ee,2);oe(T,5,()=>ka.filter(C=>C!=="XyzMaterial"),ve,(C,Y)=>{var N=Ai(),se=a(N),Be,He=s(se);u(()=>{Be!==(Be=e(Y))&&(se.value=(se.__value=e(Y))==null?"":e(Y)),f(He,` ${Fa[e(Y)]??""}`)}),Ct(t,[],se,()=>(e(Y),e(n).cardKinds),F=>Le(n,e(n).cardKinds=F)),r(C,N)});var k=s(ne,2);{var P=C=>{var Y=Ii(),N=W(Y),se=a(N),Be=a(se),He=s(se,2);oe(He,5,()=>Sa,ve,(Xe,$e)=>{var Ue=Yi(),Fe=a(Ue),at,ft=s(Fe);u(()=>{at!==(at=e($e))&&(Fe.value=(Fe.__value=e($e))==null?"":e($e)),f(ft,` ${Qt[e($e)]??""}${ca[e($e)]??""}`)}),Ct(c,[],Fe,()=>(e($e),e(n).monsterCategories),dt=>Le(n,e(n).monsterCategories=dt)),r(Xe,Ue)});var F=s(N,2),ke=a(F),qe=a(ke),We=s(ke,2);oe(We,5,()=>$a,ve,(Xe,$e)=>{var Ue=Ni(),Fe=a(Ue),at,ft=s(Fe,2),dt=s(ft);u(()=>{at!==(at=e($e))&&(Fe.value=(Fe.__value=e($e))==null?"":e($e)),Ye(ft,`monster_attr ${e($e)??""} svelte-1s1plv5`),f(dt,` ${va[e($e)]??""}`)}),Ct(_,[],Fe,()=>(e($e),e(n).monsterAttributes),Tt=>Le(n,e(n).monsterAttributes=Tt)),r(Xe,Ue)});var Pe=s(F,2),ze=a(Pe),Je=a(ze),tt=s(ze,2);oe(tt,5,()=>Da,ve,(Xe,$e)=>{var Ue=Bi(),Fe=a(Ue),at,ft=s(Fe);u(()=>{at!==(at=e($e))&&(Fe.value=(Fe.__value=e($e))==null?"":e($e)),f(ft,` ${Vt[e($e)]??""}
                  ${da[e($e)]??""}`)}),Ct(v,[],Fe,()=>(e($e),e(n).monsterTypes),dt=>Le(n,e(n).monsterTypes=dt)),ye("dblclick",Ue,dt=>O(dt,"monsterTypes",e($e))),r(Xe,Ue)}),ye("click",Be,()=>j("monsterCategories")),J(3,N,()=>ue,()=>({delay:0,duration:100})),ye("click",qe,()=>j("monsterAttributes")),J(3,F,()=>ue,()=>({delay:0,duration:100})),ye("click",Je,()=>j("monsterTypes")),J(3,Pe,()=>ue,()=>({delay:0,duration:100})),r(C,Y)};y(k,C=>{e(n).cardKinds.includes("Monster")&&C(P)})}var p=s(k,2);{var h=C=>{var Y=Hi(),N=a(Y),se=a(N),Be=s(N,2);oe(Be,5,()=>Ca,ve,(He,F)=>{var ke=Fi(),qe=a(ke),We,Pe=s(qe);u(()=>{We!==(We=e(F))&&(qe.value=(qe.__value=e(F))==null?"":e(F)),f(Pe,` ${Zt[e(F)]??""}`)}),Ct(g,[],qe,()=>(e(F),e(n).spellCategories),ze=>Le(n,e(n).spellCategories=ze)),r(He,ke)}),ye("click",se,()=>j("spellCategories")),J(3,Y,()=>ue,()=>({delay:0,duration:100})),r(C,Y)};y(p,C=>{e(n).cardKinds.includes("Spell")&&C(h)})}var ge=s(p,2);{var be=C=>{var Y=Ui(),N=a(Y),se=a(N),Be=s(N,2);oe(Be,5,()=>xa,ve,(He,F)=>{var ke=Pi(),qe=a(ke),We,Pe=s(qe);u(()=>{We!==(We=e(F))&&(qe.value=(qe.__value=e(F))==null?"":e(F)),f(Pe,` ${Jt[e(F)]??""}`)}),Ct(d,[],qe,()=>(e(F),e(n).trapCategories),ze=>Le(n,e(n).trapCategories=ze)),r(He,ke)}),ye("click",se,()=>j("trapCategories")),J(3,Y,()=>ue,()=>({delay:0,duration:100})),r(C,Y)};y(ge,C=>{e(n).cardKinds.includes("Trap")&&C(be)})}var Me=s(ge,2),me=a(Me),Ce=a(me),E=s(me,2);oe(E,4,()=>[{key:"test",text:"テスト用カードを表示する"}],ve,(C,Y)=>{var N=ji(),se=a(N),Be,He=s(se);u(()=>{Be!==(Be=Y.key)&&(se.value=(se.__value=Y.key)==null?"":Y.key),f(He,` ${Y.text??""}`)}),Ct(S,[],se,()=>(Y.key,e(n).others),F=>Le(n,e(n).others=F)),r(C,N)});var B=s(pe,2);yi(B,{get cardInfo(){return e(L)}});var de=s(le,2),Se=a(de);const Ke=he(()=>Object.values(ht));Ba(Se,{mode:"List",get allCardInfos(){return e(Ke)},onAttention:te,get searchCondition(){return e(n)},get deckCardInfos(){return e(b).cardInfos},set deckCardInfos(C){Le(b,e(b).cardInfos=C)},$$legacy:!0});var De=s(de,2),V=a(De);bt(V,()=>e(ie),C=>{var Y=Gi();r(C,Y)},(C,Y)=>{var N=zi(),se=W(N),Be=a(se),He=a(Be),F=s(a(He));u(()=>{e(ee),Yt(()=>{e(Y)})}),oe(F,5,()=>e(Y),ve,(Ze,je)=>{var Oe=Oi(),Ge={},Ve=a(Oe);u(()=>{Ge!==(Ge=e(je).id)&&(Oe.value=(Oe.__value=e(je).id)==null?"":e(je).id),f(Ve,e(je).name)}),r(Ze,Oe)});var ke=s(He,4),qe=s(a(ke)),We=s(Be,4),Pe=s(a(We),2),ze=a(Pe),Je=s(Pe,4),tt=a(Je),Xe=s(Je,2),$e=a(Xe),Ue=s(We,2),Fe=s(a(Ue),2);bt(Fe,xe,Ze=>{var je=Ri();r(Ze,je)},(Ze,je)=>{var Oe=Li(),Ge=a(Oe);u(Ve=>gt(Ge,"href",Ve),[()=>ut.convertToObjectURL([e(je)])],he),r(Ze,Oe)});var at=s(Fe,2);bt(at,()=>e(Te),Ze=>{var je=Ki();r(Ze,je)},(Ze,je)=>{var Oe=Wi(),Ge=a(Oe);u(()=>gt(Ge,"href",e(je))),r(Ze,Oe)});var ft=s(at,2),dt=a(ft),Tt=s(se,2);Ba(Tt,{mode:"Deck",allCardInfos:[],onAttention:te,get deckCardInfos(){return e(b).cardInfos},set deckCardInfos(Ze){Le(b,e(b).cardInfos=Ze)},$$legacy:!0}),Nt(F,()=>e(ee),Ze=>x(ee,Ze)),ye("change",F,q),sa(qe,()=>e(b).name,Ze=>Le(b,e(b).name=Ze)),ye("click",ze,Q),ye("click",tt,_e),ye("click",$e,X),ye("click",dt,fe),r(C,N)});var ce=s(re,2);ce.textContent=`実装済カード${dr+Ma}枚（内、効果のないモンスター${Ma??""}枚）`;var Ne=s(R,2);qi(Ne,{modalController:H}),u(()=>Ye(pe,`deck_editor_search_box ${(e(U)==="SearchCondition"?"":"minimum")??""} svelte-1s1plv5`)),ye("click",G,I),sa($,()=>e(n).name,C=>Le(n,e(n).name=C)),ye("click",Z,()=>Le(n,e(n).name="")),ye("click",m,()=>j("cardKinds")),ye("click",Ce,()=>j("others")),J(3,Me,()=>ue,()=>({delay:0,duration:100})),ye("mouseenter",pe,()=>x(U,"SearchCondition")),r(o,K),nt()}String.prototype.format=(o,...i)=>{for(const[t,c]of i.entries()){const _=new RegExp(`\\{${t}\\}`,"g");o=o.replace(_,c)}return o};String.prototype.toSnakeCase=function(){return this.split(/(?=[A-Z])/).join("_").toLowerCase()};const Qi=["TblDeckHeader","TblDeckDetail","TblDuelistProfile"],Zi=3;var Ji=l('<input class="game_mode_radio svelte-abgng1" type="radio" name="game_mode"> <label> </label>',1),el=l('<option class="svelte-abgng1"> </option>'),tl=l('<option class="svelte-abgng1"> </option>'),al=l('<option class="svelte-abgng1"> </option>'),rl=l('<tr class="config_row svelte-abgng1"><td class="svelte-abgng1"><div class="svelte-abgng1"><label for="npc_deck_selector" class="config_row_label deck_selector svelte-abgng1">デッキ：</label></div></td><td class="svelte-abgng1"><div class="svelte-abgng1"><select id="npc_deck_selector" class="deck_selector svelte-abgng1"><option class="svelte-abgng1">デフォルト</option><!></select></div></td></tr>'),sl=l('<option class="svelte-abgng1"> </option>'),il=l('<tr class="config_row svelte-abgng1"><td class="svelte-abgng1"><div class="svelte-abgng1"><label for="npc_selector" class="config_row_label npc_selector svelte-abgng1">対戦相手：</label></div></td><td class="svelte-abgng1"><div class="svelte-abgng1"><select id="npc_selector" class="npc_selector svelte-abgng1"></select> <div class="svelte-abgng1"> </div></div></td></tr> <!> <tr class="config_row svelte-abgng1"><td class="svelte-abgng1"><div class="svelte-abgng1"><label for="npc_selector" class="config_row_label npc_selector svelte-abgng1">先攻後攻：</label></div></td><td class="svelte-abgng1"><div class="svelte-abgng1"><select id="npc_selector" class="npc_selector svelte-abgng1"></select></div></td></tr>',1),ll=l('<option class="svelte-abgng1"> </option>'),nl=l('<tr class="config_row svelte-abgng1"><td class="svelte-abgng1"><div class="svelte-abgng1"><label for="difficulty_selector" class="config_row_label difficulty_selector svelte-abgng1">難易度：</label></div></td><td class="svelte-abgng1"><div class="svelte-abgng1"><select id="difficulty_selector" class="difficulty_selector svelte-abgng1"></select></div></td></tr>'),ol=l('<tr class="config_row svelte-abgng1"><td class="svelte-abgng1"><div class="svelte-abgng1"><label class="config_row_label svelte-abgng1" for="game_mode_radio_preset">ゲームモード：</label></div></td><td class="svelte-abgng1"><div class="svelte-abgng1"></div></td></tr> <tr class="config_row svelte-abgng1"><td class="svelte-abgng1"><div class="svelte-abgng1"><label for="deck_selector" class="config_row_label deck_selector svelte-abgng1">デッキ：</label></div></td><td class="svelte-abgng1"><div class="svelte-abgng1"><select id="deck_selector" class="deck_selector svelte-abgng1"></select></div></td></tr> <!> <tr><td colspan="2" class="svelte-abgng1"><div><button class="btn svelte-abgng1">duel start!</button></div></td></tr>',1),vl=l('<tr><td colspan="2" class="svelte-abgng1"><div>デッキ情報の読み込み、もしくは作成中...</div></td></tr>'),dl=l('<tr><td colspan="2" class="svelte-abgng1"><div><button class="btn svelte-abgng1">deck edit</button></div></td></tr>'),cl=l('<tr class="config_row svelte-abgng1"><td class="svelte-abgng1"><div class="svelte-abgng1"><label for="duelist_name" class="config_row_label duelist_name svelte-abgng1">名前：</label></div></td><td class="svelte-abgng1"><div class="svelte-abgng1"><input id="duelist_name" class="duelist_name svelte-abgng1" type="text"></div></td></tr> <!> <!>',1),_l=l('<tr><td colspan="2" class="svelte-abgng1"><div>デュエリスト情報の読み込み、もしくは作成中...</div></td></tr>'),ul=l('<div class="app_body svelte-abgng1"><table class="config_table svelte-abgng1"><tbody><!></tbody></table></div>'),fl=l('<div class="result_title result_win svelte-abgng1">YOU WIN</div>'),pl=l('<div class="result_title result_lose svelte-abgng1">YOU LOSE</div>'),gl=l('<div class="result_title result_draw svelte-abgng1">DRAW</div>'),ml=l('<div class="twitter_share_button_wrapper svelte-abgng1"><a rel="nofollow" target="_blank" class="twitter_share_button svelte-abgng1">X(twitter)でシェアする</a></div>'),hl=l('<div class="result svelte-abgng1"><!> <div class="reason_of_end svelte-abgng1"> </div> <!> <div class="svelte-abgng1"><button class="white_button svelte-abgng1">TOPへ戻る</button></div></div>'),bl=l('<main style="flex-direction: column; display :flex" class="svelte-abgng1"><div class="link link_left svelte-abgng1"><a href="https://github.com/Setta238/stk_ygo_svelte" target="_blank" rel="noopener noreferrer" title="repository" class="svelte-abgng1">repository</a> <a href="https://x.com/ninja_no" target="_blank" rel="noopener noreferrer" title="repository" class="svelte-abgng1">X(Twitter)</a> <a href="https://posfie.com/@ninja_no/p/Lx7FLj3" target="_blank" rel="noopener noreferrer" title="posfie" class="svelte-abgng1">posfie(toggeter)</a></div> <div class="link link_right svelte-abgng1"><a class="a_button svelte-abgng1" role="button" tabindex="0">TOPへ戻る</a> <a href="/stk_ygo_svelte/note.html" target="_blank" rel="noopener noreferrer" title="repository" class="svelte-abgng1">現時点とこの先のこと</a></div> <!> <div class="debug_info svelte-abgng1"><span class="svelte-abgng1"> </span> <span class="user_agent_info svelte-abgng1"> </span> <span class="screen_info svelte-abgng1"> </span></div> <!></main>');function yl(o,i){it(i,!1);const t=new cr("stk_ygo_svelte",Zi,Qi);let c=we(0),_=we(0),v=we(),g=we("FtkChallenge"),d=we("None"),S=we(0),H=we(""),w=we(void 0);const n="https://setta238.github.io/stk_ygo_svelte/",U="遊戯王deそりてあ",I="ninja_no",j=_r.getOrCreateNew(t).then(m=>(x(g,Ta.includes(m.previousGameMode)?m.previousGameMode:"FtkChallenge"),X(m.previousNpcId),m)),O=m=>{var k;const T=m.find(P=>P.lastUsedAt.getTime()===Math.max(...m.map(p=>p.lastUsedAt.getTime())))??m[0];x(S,T.id),e(g)==="FtkChallenge"&&T.deckType!=="Preset"&&x(S,((k=Dt.find(P=>P.deckType==="Preset"))==null?void 0:k.id)??e(S))};let q=we(ut.getAllDeckInfo(t).then(m=>(Promise.all(m.filter(T=>!T.lastUsedAt).map(T=>{T.saveDeckInfo()})),O(m),m)));const A=async()=>{const m=e(S);let T=(await e(q)).find(P=>P.id===m)??(await ie()).find(P=>P.id===m);T&&await T.updateTimestamp();let k=T;if(k||(k=Dt.find(P=>P.id===m)),!k)throw new Error("illegal state");return k},ee=async()=>{(await j).save({previousGameMode:e(g)})},ie=()=>(x(q,ut.getAllDeckInfo(t).then(m=>(O(m),m))),e(q)),Te=async()=>{(await e(q)).length||(await ut.prepareSampleDeck(),ie())},D=async()=>{await Promise.all([ee(),Te()]);const m=await A(),T=await j;let k=At.find(h=>h.id===Number.MIN_SAFE_INTEGER)??At[0],P=Dt.find(h=>h.id===Number.MIN_SAFE_INTEGER)??Dt[0],p="PlayFirst";e(g)==="FtkChallenge"?k=At.filter(h=>h.npcType==="FtkChallenge").find(h=>h.difficulty===T.previousDifficulty)??k:e(g)==="Free"&&(k=At.find(h=>h.id===T.previousNpcId)??k,P=Dt.slice(-1)[0],p=T.previousStartMode),k.npcType!=="FtkChallenge"&&T.previousNpcDeckId>-1?P=(await e(q)).find(h=>h.id===T.previousNpcDeckId)??P:P=Dt.find(h=>h.id===k.id)??P,x(v,new fr(T,"Player",m,[],k,"NPC",P,[],p)),e(v).onDuelEnd.append(()=>(x(v,e(v)),"RemoveMe"))},b=async()=>{await Promise.all([ee(),Te()]),x(d,"DeckEdit")},L=async m=>{await ee(),m.key==="Enter"&&!m.repeat&&(await j).save()},te=()=>{x(q,ie()),x(v,void 0),x(d,"None")};let xe=Date.now();const Q=m=>{Date.now()-xe<200||(xe=Date.now(),x(g,m),ie())},_e=m=>{X(Number(m.currentTarget.value))},X=m=>{var T;x(w,At.find(k=>k.id===m)),x(H,((T=e(w))==null?void 0:T.description)??"")};Te(),lt();var fe=bl(),K=s(a(fe),2),R=a(K),re=s(K,2);{var le=m=>{var T=Ae(),k=W(T);bt(k,()=>j,null,(P,p)=>{Zs(P,{get duel(){return e(v)},get userProfile(){return e(p)}})}),r(m,T)},pe=m=>{var T=Ae(),k=W(T);{var P=h=>{Vi(h,{})},p=h=>{var ge=ul(),be=a(ge),Me=a(be),me=a(Me);bt(me,()=>j,Ce=>{var E=_l();r(Ce,E)},(Ce,E)=>{var B=cl(),de=W(B),Se=a(de),Ke=a(Se),De=s(Se),V=a(De),ce=a(V),Ne=s(de,2);bt(Ne,()=>e(q),N=>{var se=vl();r(N,se)},(N,se)=>{var Be=ol(),He=W(Be),F=a(He),ke=a(F),qe=s(F),We=a(qe);oe(We,5,()=>Ta,ve,(je,Oe)=>{var Ge=Ji(),Ve=W(Ge),ct=s(Ve,2),yt=a(ct);u(pt=>{gt(Ve,"id",`game_mode_radio_${pt??""}`),pr(Ve,e(Oe)),gr(Ve,e(g)===e(Oe)),Ye(ct,`game_mode_tab_label game_mode_tab_${pt??""} svelte-abgng1`),gt(ct,"for",`game_mode_radio_${pt??""}`),f(yt,e(Oe))},[()=>e(Oe).toLowerCase()],he),ye("change",Ve,()=>Q(e(Oe))),r(je,Ge)});var Pe=s(He,2),ze=a(Pe),Je=a(ze),tt=s(ze),Xe=a(tt),$e=a(Xe);u(()=>{e(S),Yt(()=>{e(g),e(se)})}),oe($e,5,()=>e(g)==="FtkChallenge"?Dt.filter(je=>je.deckType==="Preset"):e(se),ve,(je,Oe)=>{var Ge=el(),Ve={},ct=a(Ge);u(()=>{Ve!==(Ve=e(Oe).id)&&(Ge.value=(Ge.__value=e(Oe).id)==null?"":e(Oe).id),f(ct,e(Oe).name)}),r(je,Ge)});var Ue=s(Pe,2);{var Fe=je=>{var Oe=il(),Ge=W(Oe),Ve=a(Ge),ct=a(Ve),yt=s(Ve),pt=a(yt),Et=a(pt);u(()=>{e(E),Yt(()=>{})}),oe(Et,5,()=>At,ve,(_t,et)=>{var ot=tl(),xt={},qt=a(ot);u(()=>{xt!==(xt=e(et).id)&&(ot.value=(ot.__value=e(et).id)==null?"":e(et).id),f(qt,e(et).name)}),r(_t,ot)});var Ut=s(Et,2),jt=a(Ut),It=s(Ge,2);{var Ft=_t=>{var et=rl(),ot=a(et),xt=a(ot),qt=s(ot),ga=a(qt),ma=a(ga);u(()=>{e(E),Yt(()=>{e(se)})});var ea=a(ma);ea.value=(ea.__value=Number.MIN_SAFE_INTEGER)==null?"":Number.MIN_SAFE_INTEGER;var Ha=s(ea);oe(Ha,1,()=>e(se),ve,(ta,Rt)=>{var Wt=al(),ha={},Pa=a(Wt);u(()=>{ha!==(ha=e(Rt).id)&&(Wt.value=(Wt.__value=e(Rt).id)==null?"":e(Rt).id),f(Pa,e(Rt).name)}),r(ta,Wt)}),J(3,xt,()=>ue,()=>({duration:200})),J(3,ot,()=>ue,()=>({duration:200})),Nt(ma,()=>e(E).previousNpcDeckId,ta=>e(E).previousNpcDeckId=ta),J(3,ga,()=>ue,()=>({duration:200})),J(3,qt,()=>ue,()=>({duration:200})),J(3,et,()=>ue,()=>({duration:200})),r(_t,et)};y(It,_t=>{var et;((et=e(w))==null?void 0:et.npcType)!=="FtkChallenge"&&_t(Ft)})}var kt=s(It,2),wt=a(kt),Ot=a(wt),Lt=s(wt),fa=a(Lt),pa=a(fa);u(()=>{e(E),Yt(()=>{})}),oe(pa,5,()=>oa(Ea),ve,(_t,et)=>{var ot=sl(),xt={},qt=a(ot);u(()=>{xt!==(xt=e(et))&&(ot.value=(ot.__value=e(et))==null?"":e(et)),f(qt,Ea[e(et)])}),r(_t,ot)}),u(()=>f(jt,`※${e(H)??""}`)),J(3,ct,()=>ue,()=>({duration:200})),J(3,Ve,()=>ue,()=>({duration:200})),ye("change",Et,_e),Nt(Et,()=>e(E).previousNpcId,_t=>e(E).previousNpcId=_t),J(3,pt,()=>ue,()=>({duration:200})),J(3,yt,()=>ue,()=>({duration:200})),J(3,Ge,()=>ue,()=>({duration:200})),J(3,Ot,()=>ue,()=>({duration:200})),J(3,wt,()=>ue,()=>({duration:200})),Nt(pa,()=>e(E).previousStartMode,_t=>e(E).previousStartMode=_t),J(3,fa,()=>ue,()=>({duration:200})),J(3,Lt,()=>ue,()=>({duration:200})),J(3,kt,()=>ue,()=>({duration:200})),r(je,Oe)},at=je=>{var Oe=Ae(),Ge=W(Oe);{var Ve=ct=>{var yt=nl(),pt=a(yt),Et=a(pt),Ut=s(pt),jt=a(Ut),It=a(jt);u(()=>{e(E),Yt(()=>{})}),oe(It,5,()=>mr,ve,(Ft,kt)=>{var wt=ll(),Ot={},Lt=a(wt);u(()=>{Ot!==(Ot=e(kt))&&(wt.value=(wt.__value=e(kt))==null?"":e(kt)),f(Lt,e(kt))}),r(Ft,wt)}),J(3,Et,()=>ue,()=>({duration:200})),J(3,pt,()=>ue,()=>({duration:200})),Nt(It,()=>e(E).previousDifficulty,Ft=>e(E).previousDifficulty=Ft),J(3,jt,()=>ue,()=>({duration:200})),J(3,Ut,()=>ue,()=>({duration:200})),J(3,yt,()=>ue,()=>({duration:200})),r(ct,yt)};y(Ge,ct=>{e(g)==="FtkChallenge"&&ct(Ve)},!0)}r(je,Oe)};y(Ue,je=>{e(g)==="Free"?je(Fe):je(at,!1)})}var ft=s(Ue,2),dt=a(ft),Tt=a(dt),Ze=a(Tt);J(3,ke,()=>ue,()=>({duration:200})),J(3,F,()=>ue,()=>({duration:200})),J(3,We,()=>ue,()=>({duration:200})),J(3,qe,()=>ue,()=>({duration:200})),J(3,He,()=>ue,()=>({duration:200})),J(3,Je,()=>ue,()=>({duration:200})),J(3,ze,()=>ue,()=>({duration:200})),Nt($e,()=>e(S),je=>x(S,je)),J(3,Xe,()=>ue,()=>({duration:200})),J(3,tt,()=>ue,()=>({duration:200})),J(3,Pe,()=>ue,()=>({duration:200})),ye("click",Ze,D),J(3,Tt,()=>ue,()=>({duration:200})),r(N,Be)});var C=s(Ne,2);{var Y=N=>{var se=dl(),Be=a(se),He=a(Be),F=a(He);ye("click",F,b),J(3,He,()=>ue,()=>({duration:200})),J(3,Be,()=>ue,()=>({duration:200})),J(3,se,()=>ue,()=>({duration:200})),r(N,se)};y(C,N=>{e(g)==="Free"&&N(Y)})}J(3,Ke,()=>ue,()=>({duration:200})),J(3,Se,()=>ue,()=>({duration:200})),sa(ce,()=>e(E).name,N=>e(E).name=N),ye("keypress",ce,L),J(3,V,()=>ue,()=>({duration:200})),J(3,De,()=>ue,()=>({duration:200})),J(3,de,()=>ue,()=>({duration:200})),r(Ce,B)}),r(h,ge)};y(k,h=>{e(d)==="DeckEdit"?h(P):h(p,!1)},!0)}r(m,T)};y(re,m=>{e(v)?m(le):m(pe,!1)})}var z=s(re,2),M=a(z),G=a(M),ae=s(M,2),Ie=a(ae),$=s(ae,2),Z=a($),ne=s(z,2);{var Ee=m=>{var T=hl(),k=a(T);{var P=E=>{var B=Ae(),de=W(B);{var Se=De=>{var V=fl();r(De,V)},Ke=De=>{var V=Ae(),ce=W(V);{var Ne=C=>{var Y=pl();r(C,Y)};y(ce,C=>{e(v).winner.seat==="Above"&&C(Ne)},!0)}r(De,V)};y(de,De=>{e(v).winner.seat==="Below"?De(Se):De(Ke,!1)})}r(E,B)},p=E=>{var B=gl();r(E,B)};y(k,E=>{e(v).winner?E(P):E(p,!1)})}var h=s(k,2),ge=a(h),be=s(h,2);{var Me=E=>{var B=ml(),de=a(B);u(()=>gt(de,"href",`https://x.com/share?url=${n}&text=${e(v).twitterShareText??""}&hashtags=${U}&via=${I}`)),r(E,B)};y(be,E=>{e(v).twitterShareText&&E(Me)})}var me=s(be,2),Ce=a(me);u(()=>f(ge,e(v).reasonOfEnd)),ye("click",Ce,te),J(3,T,()=>yr,()=>({delay:200,duration:200})),r(m,T)};y(ne,m=>{e(v)&&e(v).isEnded&&m(Ee)})}u(()=>{f(G,"build at: 20250610_223538"),f(Ie,ur.text),f(Z,`w:${e(c)??""}px h:${e(_)??""}px`)}),Kt("innerWidth",m=>x(c,m)),Kt("innerHeight",m=>x(_,m)),ye("click",R,te),r(o,fe),nt()}hr(yl,{target:document.getElementById("app")});
