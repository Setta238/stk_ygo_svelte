var Kt=Object.defineProperty;var Pt=(_,l,a)=>l in _?Kt(_,l,{enumerable:!0,configurable:!0,writable:!0,value:a}):_[l]=a;var Z=(_,l,a)=>Pt(_,typeof l!="symbol"?l+"":l,a);import{p as Je,o as Pe,q as Qe,t as c,r as X,u as s,v as t,w as e,x as G,y as rt,z as I,A as f,B as Se,C as n,E as Ee,F as b,G as ot,H as lt,J as Te,K as R,L as wt,M as Rt,O as nt,Q as dt,R as oe,T as Wt,U as Ze,V as mt,W as Le,X as Ie,Y as Ct,Z as It,_ as Ge,$ as jt,a0 as Yt,a1 as ft,a2 as fe,a3 as ht,a4 as bt,a5 as gt,a6 as Dt,a7 as kt,a8 as Ye,a9 as Oe,aa as P,ab as Be,ac as vt,ad as Bt,ae as q,af as Re,ag as We,ah as Vt,ai as qt,aj as Xt,ak as Gt,al as Jt,am as Qt,an as it,ao as yt,ap as Zt,aq as xt,ar as ea,as as ta}from"./duel.js";import"./entity_proc.js";import"./json.js";(function(){const l=document.createElement("link").relList;if(l&&l.supports&&l.supports("modulepreload"))return;for(const m of document.querySelectorAll('link[rel="modulepreload"]'))r(m);new MutationObserver(m=>{for(const u of m)if(u.type==="childList")for(const B of u.addedNodes)B.tagName==="LINK"&&B.rel==="modulepreload"&&r(B)}).observe(document,{childList:!0,subtree:!0});function a(m){const u={};return m.integrity&&(u.integrity=m.integrity),m.referrerPolicy&&(u.referrerPolicy=m.referrerPolicy),m.crossOrigin==="use-credentials"?u.credentials="include":m.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function r(m){if(m.ep)return;m.ep=!0;const u=a(m);fetch(m.href,u)}})();var aa=c("<div></div>"),sa=c('<span> </span> / <span style="display: inline-block;width:2rem;text-align: right;"> </span>',1),ra=c('<li class="deck_editor_item svelte-vivzk2"><div role="listitem"><div class="svelte-vivzk2"><div class="svelte-vivzk2"> </div> <div style="display:flex" class="svelte-vivzk2"><div class="svelte-vivzk2"><!> <!> <!> <!> <!> <!> <!></div> <div style="flex-grow: 1; width:0.1rem" class="svelte-vivzk2"></div> <div class="svelte-vivzk2"><!></div></div></div></div> <button class="button_style_reset svelte-vivzk2" title="※shiftキー同時押しで一括投入">+</button> <button class="button_style_reset svelte-vivzk2" title="※shiftキー同時押しで一括外し">-</button></li>'),ia=c('<div class="deck_editor_card_kind svelte-vivzk2"><span class="svelte-vivzk2"> </span> <ul class="svelte-vivzk2"></ul></div>'),va=c('<div class="deck_editor_deck_type svelte-vivzk2"><span class="svelte-vivzk2"> </span> <!></div>'),oa=c('<div class="deck_editor_card_list svelte-vivzk2"></div>');function Mt(_,l){Je(l,!1);let a=Pe(l,"allCardInfos",8),r=Pe(l,"deckCardInfos",12),m=Pe(l,"mode",8),u=Pe(l,"onAttention",8);const B={Deck:["Monster","Spell","Trap"],ExtraDeck:["Monster"]},J=(V,N)=>(m()==="List"?a():r()).filter(j=>j.isImplemented).filter(j=>!N||j.kind===N).filter(j=>{var E,W;return!V||V==="Deck"&&!((E=j==null?void 0:j.monsterCategories)!=null&&E.union(mt).length)||V==="ExtraDeck"&&((W=j==null?void 0:j.monsterCategories)==null?void 0:W.union(mt).length)}),ue=(V,N)=>{try{if(V.ctrlKey){r().push(N);return}const j=r().filter(W=>W.name===N.name).length;if(j>2)return;const E=V.shiftKey?3-j:1;if(E<1)return;r().push(...Array(E).fill(N))}finally{r().sort(rt),r(r())}},v=(V,N)=>{let j=0;r(r().filter(E=>E.name!==N.name?!0:(j++,!V.shiftKey&&j>1))),r().sort(rt)};Qe();var ie=oa();X(ie,5,()=>Wt,G,(V,N)=>{var j=va(),E=t(j),W=t(E),ke=s(E,2);X(ke,1,()=>B[e(N)],G,(le,L)=>{var pe=ia(),Me=t(pe),ye=t(Me),he=s(Me,2);X(he,5,()=>J(e(N),e(L)).toSorted(rt),G,(ee,w)=>{var we=ra(),be=t(we),Ce=t(be),je=t(Ce),p=t(je),g=s(je,2),d=t(g),D=t(d);{var Y=h=>{var M=Ee();f(()=>b(M,`★${e(w).level??""}`)),n(h,M)};I(D,h=>{e(w).level&&h(Y)})}var S=s(D,2);{var U=h=>{var M=Ee();f(()=>b(M,`☆${e(w).rank??""}`)),n(h,M)};I(S,h=>{e(w).rank&&h(U)})}var A=s(S,2);X(A,1,()=>e(w).attributes??[],G,(h,M)=>{var Q=aa();f(()=>Se(Q,`monster_attr ${e(M)??""} svelte-vivzk2`)),n(h,Q)});var z=s(A,2);X(z,1,()=>e(w).types??[],G,(h,M)=>{var Q=Ee();f(()=>b(Q,ot[e(M)])),n(h,Q)});var y=s(z,2);X(y,1,()=>e(w).monsterCategories??[],G,(h,M)=>{var Q=Ee();f(()=>b(Q,lt[e(M)])),n(h,Q)});var $=s(y,2);{var x=h=>{var M=Ee();f(()=>b(M,`${nt[e(w).spellCategory]??""}魔法`)),n(h,M)};I($,h=>{e(w).spellCategory!==void 0&&h(x)})}var T=s($,2);{var te=h=>{var M=Ee();f(()=>b(M,`${dt[e(w).trapCategory]??""}罠`)),n(h,M)};I(T,h=>{e(w).trapCategory!==void 0&&h(te)})}var me=s(d,4),xe=t(me);{var ne=h=>{var M=sa(),Q=oe(M),$e=t(Q),Ue=s(Q,2),He=t(Ue);f(()=>{b($e,e(w).attack??"?"),b(He,e(w).defense??"?")}),n(h,M)};I(xe,h=>{e(w).kind==="Monster"&&h(ne)})}var de=s(be,2),Ae=s(de,2);f(h=>{Se(be,`${h??""} svelte-vivzk2`),b(p,e(w).name)},[()=>{var h,M;return`deck_editor_card duel_card ${e(w).kind} ${(M=(h=e(w))==null?void 0:h.monsterCategories)==null?void 0:M.join(" ")} ${e(w).isImplemented?"is_implemented":"is_not_implemented"}`}],Te),R("mouseenter",be,()=>u()(e(w))),R("click",de,h=>ue(h,e(w))),R("click",Ae,h=>v(h,e(w))),n(ee,we)}),f(ee=>b(ye,`${wt[e(L)]??""}（${ee??""}枚）`),[()=>J(e(N),e(L)).length],Te),n(le,pe)}),f(le=>b(W,`${Rt[e(N)]??""}（${le??""}枚）`),[()=>J(e(N)).length],Te),n(V,j)}),n(_,ie),Ze()}var la=c('<div class="duel_card_info_row svelte-rccxcp"><div class="svelte-rccxcp"><pre class="description svelte-rccxcp"> </pre></div></div> <div class="duel_card_info_row svelte-rccxcp" style=" justify-content: space-between;"><div class="svelte-rccxcp"> </div> <div class="svelte-rccxcp"> </div></div>',1),na=c('<div></div> <div class="svelte-rccxcp"> </div>',1),da=c("<div> </div>"),ca=c("<div> </div>"),_a=c('<div class="duel_card_info_row svelte-rccxcp"><!> <!></div> <div class="duel_card_info_row svelte-rccxcp"></div>',1),ua=c('<div class="duel_card_row svelte-rccxcp"><div class="svelte-rccxcp"></div> <div class="svelte-rccxcp"> </div></div>'),pa=c('<div class="duel_card_row svelte-rccxcp"><div class="svelte-rccxcp"></div> <div class="svelte-rccxcp"> </div></div>'),ma=c('<div class="duel_card_info_row svelte-rccxcp"><div class="svelte-rccxcp">※テスト用カードです</div></div>'),fa=c('<div class="duel_card_info_links svelte-rccxcp"><a target="_blank" rel="noopener noreferrer" title="遊戯王カードWiki" class="svelte-rccxcp">⇒遊戯王カードWiki</a> <a target="_blank" rel="noopener noreferrer" title="コナミカードデータベース" class="svelte-rccxcp"> </a></div>'),ha=c('<div><div class="duel_card_info_header svelte-rccxcp"><div class="duel_card_info_row svelte-rccxcp"><div class="svelte-rccxcp"> </div></div> <div class="duel_card_info_row svelte-rccxcp" style="position:sticky; top:0;"><div class="svelte-rccxcp"> </div> <div class="svelte-rccxcp"> </div></div></div> <div class="duel_card_info_body svelte-rccxcp"><!> <!> <div class="duel_card_info_row description svelte-rccxcp"><div class="svelte-rccxcp"><pre class="description svelte-rccxcp"> </pre></div></div> <!></div></div>');function ba(_,l){Je(l,!1);let a=Pe(l,"cardInfo",8,void 0);const r=()=>a()?Ie[a().name]:void 0;Qe();var m=Le(),u=oe(m);{var B=J=>{var ue=ha(),v=t(ue),ie=t(v),V=t(ie),N=t(V),j=s(ie,2),E=t(j),W=t(E),ke=s(E,2),le=t(ke),L=s(v,2),pe=t(L);{var Me=d=>{var D=la(),Y=oe(D),S=t(Y),U=t(S),A=t(U),z=s(Y,2),y=t(z),$=t(y),x=s(y,2),T=t(x);f(()=>{b(A,Ie[a().name].pendulumDescription),b($,`◀ ${a().pendulumScaleL??""}`),b(T,`${a().pendulumScaleR??""} ▶`)}),n(d,D)};I(pe,d=>{var D;(D=a().monsterCategories)!=null&&D.includes("Pendulum")&&d(Me)})}var ye=s(pe,2);{var he=d=>{var D=_a(),Y=oe(D),S=t(Y);{var U=$=>{var x=na(),T=oe(x),te=s(T,2),me=t(te);f(()=>{Se(T,`monster_attr ${a().attributes[0]??""} svelte-rccxcp`),b(me,`${jt[a().attributes[0]]??""}属性`)}),n($,x)};I(S,$=>{a().attributes&&$(U)})}var A=s(S,2);{var z=$=>{var x=da(),T=t(x);f(()=>{Se(x,`monster_cat ${a().types[0]??""} svelte-rccxcp`),b(T,`${ot[a().types[0]]??""}${Yt[a().types[0]]??""}族`)}),n($,x)};I(A,$=>{a().types&&$(z)})}var y=s(Y,2);X(y,5,()=>a().monsterCategories??[],G,($,x)=>{var T=ca(),te=t(T);f(()=>{Se(T,`monster_cat ${e(x)??""} svelte-rccxcp`),b(te,`${lt[e(x)]??""}${Ct[e(x)]??""}`)}),n($,T)}),n(d,D)},ee=d=>{var D=Le(),Y=oe(D);{var S=A=>{var z=ua(),y=s(t(z),2),$=t(y);f(()=>b($,`${nt[a().spellCategory]??""}魔法`)),n(A,z)},U=A=>{var z=Le(),y=oe(z);{var $=x=>{var T=pa(),te=s(t(T),2),me=t(te);f(()=>b(me,`${dt[a().trapCategory]??""}罠`)),n(x,T)};I(y,x=>{a().kind==="Trap"&&a().trapCategory&&x($)},!0)}n(A,z)};I(Y,A=>{a().kind==="Spell"&&a().spellCategory?A(S):A(U,!1)},!0)}n(d,D)};I(ye,d=>{a().kind==="Monster"?d(he):d(ee,!1)})}var w=s(ye,2),we=t(w),be=t(we),Ce=t(be),je=s(w,2);{var p=d=>{var D=ma();n(d,D)},g=d=>{var D=fa(),Y=t(D),S=s(Y,2),U=t(S);f(A=>{Ge(Y,"href",`https://yugioh-wiki.net/index.php?${a().wikiEncodedName}`),Ge(S,"href",A),b(U,`⇒${(a().cardId?"公式カードページ":"公式で検索")??""}`)},[()=>It(a())],Te),n(d,D)};I(je,d=>{a().isForTest?d(p):d(g,!1)})}f((d,D,Y,S)=>{Se(ue,`duel_card duel_card_info ${a().kind??""} ${d??""} svelte-rccxcp`),b(N,a().name),b(W,D),b(le,Y),b(Ce,S)},[()=>{var d;return(d=a().monsterCategories)==null?void 0:d.join(" ")},()=>"★".repeat(a().level||0),()=>"☆".repeat(a().rank||0),()=>{var d;return(d=r())==null?void 0:d.description}],Te),n(J,ue)};I(u,J=>{a()&&J(B)})}n(_,m),Ze()}const ga={0:{aaa:"日",aaaa:"日曜日",ddd:"Sun",dddd:"Sunday"},1:{aaa:"月",aaaa:"月曜日",ddd:"Mon",dddd:"Monday"},2:{aaa:"火",aaaa:"火曜日",ddd:"Tue",dddd:"Tuesday"},3:{aaa:"水",aaaa:"水曜日",ddd:"Wed",dddd:"Wednesday"},4:{aaa:"木",aaaa:"木曜日",ddd:"Thu",dddd:"Thursday"},5:{aaa:"金",aaaa:"金曜日",ddd:"Fri",dddd:"Friday"},6:{aaa:"土",aaaa:"土曜日",ddd:"Sat",dddd:"Saturday"}};class Da{constructor(){Z(this,"DefaultSeparator1","/");Z(this,"DefaultSeparator2"," ");Z(this,"DefaultSeparator3",":");Z(this,"createDate",l=>{if(!l)return;const a=new Date(l);if(!isNaN(a.getTime()))return a});Z(this,"createDateOr",(l,a)=>this.createDate(l)||a||new Date);Z(this,"truncateDate",l=>{const a=l||new Date;return new Date(a.getFullYear(),a.getMonth(),a.getDate())});Z(this,"addDate",(l,a)=>{const r=this.createDateOr(l);return r.setDate(r.getDate()+a),r});Z(this,"addMonth",(l,a)=>{const r=this.createDateOr(l);return r.setMonth(r.getMonth()+a),r});Z(this,"addYear",(l,a)=>{const r=this.createDateOr(l);return r.setFullYear(r.getFullYear()+a),r});Z(this,"getDayOfWeek",(l,a="dddd")=>{const r=this.createDate(l);return r?ga[r.getDay()][a]:""});Z(this,"formatToYYYYMMDD",(l,a=this.DefaultSeparator1)=>{const r=this.createDate(l);if(!r)return"";const m=r.getFullYear().toString(),u=("0"+(r.getMonth()+1)).slice(-2),B=("0"+r.getDate()).slice(-2);return m+a+u+a+B});Z(this,"formatToYYYYMM",(l,a=this.DefaultSeparator1)=>{const r=this.createDate(l);if(!r)return"";a||(a="");const m=r.getFullYear().toString(),u=("0"+(r.getMonth()+1)).slice(-2);return m+a+u});Z(this,"formatToHHMMSS",(l,a=this.DefaultSeparator3)=>{const r=this.createDate(l);if(!r)return"";a||(a="");const m=r.getHours(),u=r.getMinutes(),B=r.getSeconds();return("0"+m).slice(-2)+a+("0"+u).slice(-2)+a+("0"+B).slice(-2)});Z(this,"formatToHHMM",(l,a=this.DefaultSeparator3)=>{const r=this.createDate(l);if(!r)return"";a||(a="");const m=("0"+r.getHours()).slice(-2),u=("0"+r.getMinutes()).slice(-2);return m+a+u});Z(this,"formatToYYYYMMDD_HHMM",(l,a=this.DefaultSeparator1,r=this.DefaultSeparator2,m=this.DefaultSeparator3)=>{const u=this.createDate(l);return u?this.formatToYYYYMMDD(u,a)+r+this.formatToHHMM(u,m):""});Z(this,"formatToYYYYMMDD_HHMMSS",(l,a=this.DefaultSeparator1,r=this.DefaultSeparator2,m=this.DefaultSeparator3)=>{const u=this.createDate(l);return u?this.formatToYYYYMMDD(u,a)+r+this.formatToHHMMSS(u,m):""})}}const _e=new Da;Date.prototype.truncateDate=function(){return _e.truncateDate(this)};Date.prototype.getCloneOr=function(_){return _e.createDateOr(this,_)};Date.prototype.addDate=function(_){return _e.addDate(this,_)};Date.prototype.addMonth=function(_){return _e.addDate(this,_)};Date.prototype.addYear=function(_){return _e.addDate(this,_)};Date.prototype.getDayOfWeek=function(_="dddd"){return _e.getDayOfWeek(this,_)};Date.prototype.formatToYYYYMM=function(_){return _e.formatToYYYYMM(this,_)};Date.prototype.formatToYYYYMMDD=function(_){return _e.formatToYYYYMMDD(this,_)};Date.prototype.formatToYYYYMMDD_HHMM=function(_,l,a){return _e.formatToYYYYMMDD_HHMM(this,_,l,a)};Date.prototype.formatToYYYYMMDD_HHMMSS=function(_,l,a){return _e.formatToYYYYMMDD_HHMMSS(this,_,l,a)};Date.prototype.formatToHHMM=function(_){return _e.formatToHHMM(this,_)};Date.prototype.formatToHHMMSS=function(_){return _e.formatToHHMMSS(this,_)};String.prototype.format=(_,...l)=>{for(const[a,r]of l.entries()){const m=new RegExp(`\\{${a}\\}`,"g");_=_.replace(m,r)}return _};var ka=c('<label><input type="checkbox"> </label>'),ya=c('<label><input type="checkbox"> </label>'),xa=c('<label><input type="checkbox"> <div style="display: inline-block;"></div> </label>'),Ma=c('<label><input type="checkbox"> </label>'),wa=c('<label><input type="checkbox"> </label>'),Ca=c('<label><input type="checkbox"> </label>'),ja=c("<option> </option>"),Ya=c('<div class="svelte-138s9ji"><a class="white_button svelte-138s9ji" download="SVS_DeckInfos.json">ダウンロード</a></div>'),Sa=c('<div class="svelte-138s9ji"></div>'),Ta=c('<div class="svelte-138s9ji"><a class="white_button svelte-138s9ji" download="SVS_DeckInfos.json">ダウンロード（一括）</a></div>'),$a=c('<div class="svelte-138s9ji"></div>'),Aa=c('<div class="deck_editor_body_right_header svelte-138s9ji"><div class="deck_editor_body_right_header_row svelte-138s9ji"><div class="svelte-138s9ji">編集対象 <select></select></div> <div class="svelte-138s9ji"></div> <div class="svelte-138s9ji">新規名称 <input type="text"></div></div> <div class="deck_editor_body_right_header_row svelte-138s9ji"></div> <div class="deck_editor_body_right_header_row svelte-138s9ji"><div class="svelte-138s9ji">基本操作</div> <div class="svelte-138s9ji"><button class="white_button svelte-138s9ji">デッキを保存</button></div> <div class="svelte-138s9ji"></div> <div class="svelte-138s9ji"><button class="white_button svelte-138s9ji">デッキを複製</button></div> <div class="svelte-138s9ji"><button class="white_button svelte-138s9ji" title="shiftキー押下で確認メッセージスキップ">デッキを削除</button></div></div> <div class="deck_editor_body_right_header_row svelte-138s9ji"><div class="svelte-138s9ji">DL/UL</div> <!> <!></div></div> <!>',1),Ha=c("<div>デッキ情報読込中</div>"),Na=c('<div class="deck_editor svelte-138s9ji"><div class="deck_editor_header"></div> <div class="deck_editor_body svelte-138s9ji"><div class="deck_editor_body_left svelte-138s9ji"><div role="contentinfo"><div class="deck_editor_search_box_header svelte-138s9ji"><div>検索条件</div> <div><button class="white_button svelte-138s9ji">条件クリア</button></div></div> <div class="deck_editor_search_box_row svelte-138s9ji"><div class="svelte-138s9ji">名称</div> <div class="svelte-138s9ji"><input type="text" style="width:70%">※ルビには対応していません</div></div> <div class="deck_editor_search_box_row svelte-138s9ji"><div class="svelte-138s9ji"><button class="search_condition_title black_button svelte-138s9ji">種類</button></div> <div class="svelte-138s9ji"></div></div> <div class="deck_editor_search_box_row svelte-138s9ji"><div class="svelte-138s9ji"><button class="search_condition_title black_button svelte-138s9ji">モンスター</button></div> <div class="svelte-138s9ji"></div></div> <div class="deck_editor_search_box_row svelte-138s9ji"><div class="svelte-138s9ji"><button class="search_condition_title black_button svelte-138s9ji">属性</button></div> <div class="svelte-138s9ji"></div></div> <div class="deck_editor_search_box_row svelte-138s9ji"><div class="svelte-138s9ji"><button class="search_condition_title black_button svelte-138s9ji">種族</button></div> <div class="svelte-138s9ji"></div></div> <div class="deck_editor_search_box_row svelte-138s9ji"><div class="svelte-138s9ji"><button class="search_condition_title black_button svelte-138s9ji">魔法</button></div> <div class="svelte-138s9ji"></div></div> <div class="deck_editor_search_box_row svelte-138s9ji"><div class="svelte-138s9ji"><button class="search_condition_title black_button svelte-138s9ji">罠</button></div> <div class="svelte-138s9ji"></div></div> <div class="deck_editor_search_box_row svelte-138s9ji"><div class="svelte-138s9ji">テスト用</div> <div class="svelte-138s9ji"><label><input type="checkbox"> テスト用カードを表示する</label></div></div></div> <!></div> <div class="deck_editor_body_center svelte-138s9ji"><!></div> <div class="deck_editor_body_right svelte-138s9ji"><!></div></div></div>');function Ea(_,l){Je(l,!1);const a=[],r=[],m=[],u=[],B=[],J=[],ue={name:"",cardKinds:ft.filter(i=>i!=="XyzMaterial"),monsterCategories:[...kt],monsterAttributes:[...Dt],monsterTypes:[...gt],spellCategories:[...bt],trapCategories:[...ht],isForTest:!1},v=fe(structuredClone(ue));let ie=fe("SearchCondition");const V=async()=>{P(v,e(v).name=""),P(v,e(v).cardKinds=[]),P(v,e(v).monsterCategories=[]),P(v,e(v).monsterAttributes=[]),P(v,e(v).monsterTypes=[]),P(v,e(v).spellCategories=[]),P(v,e(v).trapCategories=[]),P(v,e(v).isForTest=!1)},N=async()=>{const o=(await e(W)).find(C=>C.id===e(E));o&&q(L,{...o,cardInfos:o.cardNames.map(C=>Ie[C])})},j=()=>Ye.getAllDeckInfo().then(i=>(q(E,(i.find(o=>o.lastUsedAt.getTime()===Math.max(...i.map(C=>C.lastUsedAt.getTime())))??i[0]).id),i));let E=fe(-1),W=fe(j()),ke=fe(e(W).then(i=>Ye.convertToObjectURL(i)));e(W).then(N);const le=()=>{q(W,j()),q(ke,e(W).then(i=>Ye.convertToObjectURL(i))),N()};let L=fe({id:-Number.MAX_VALUE,name:"",description:"",lastUsedAt:new Date,cardInfos:[]}),pe=fe(Ie.ゾンビーノ);const Me=()=>Object.values(Ie).filter(i=>{if(!e(v).cardKinds.includes(i.kind)||e(v).name.trim().length&&!i.name.includes(e(v).name)||i.isForTest&&!e(v).isForTest)return!1;if(i.kind==="Monster")return i.attributes&&!e(v).monsterAttributes.union(i.attributes).length||i.types&&!e(v).monsterTypes.union(i.types).length||!i.monsterCategories?!1:i.monsterCategories.union(e(v).monsterCategories).length;if(i.kind==="Spell")return i.spellCategory&&e(v).spellCategories.includes(i.spellCategory);if(i.kind==="Trap")return i.trapCategory&&e(v).trapCategories.includes(i.trapCategory)}),ye=i=>{q(ie,"CardDetail"),q(pe,i)},he=async()=>{const o=(await e(W)).find(C=>C.id===e(E));if(!o)throw new Error("illegal state");return o},ee=async i=>{Array.isArray(e(v)[i])&&Array.isArray(ue[i])&&P(v,e(v)[i]=e(v)[i].length?[]:[...ue[i]])},w=async()=>{const i=await he();await i.saveDeckInfo({...i,name:e(L).name,cardNames:e(L).cardInfos.map(o=>o.name),lastUsedAt:new Date}),le()},we=async()=>{(await Ye.createNewDeck(`デッキ_${new Date().formatToYYYYMMDD_HHMMSS("","","")}`,`コピー日時：${new Date().formatToYYYYMMDD_HHMMSS("-"," ",":")}`,e(L).cardInfos.map(o=>o.name))).saveDeckInfo(),le()},be=async i=>{const o=await he();!i.shiftKey&&!confirm(`デッキ【${o.name}】を削除します。
よろしいですか？`)||(await o.delete(),le())};Qe();var Ce=Na(),je=s(t(Ce),2),p=t(je),g=t(p),d=t(g),D=s(t(d),2),Y=t(D),S=s(d,2),U=s(t(S),2),A=t(U),z=s(S,2),y=t(z),$=t(y),x=s(y,2);X(x,5,()=>ft.filter(i=>i!=="XyzMaterial"),G,(i,o)=>{var C=ka(),k=t(C),K,ae=s(k);f(()=>{K!==(K=e(o))&&(k.value=(k.__value=e(o))==null?"":e(o)),b(ae,` ${wt[e(o)]??""}`)}),Oe(a,[],k,()=>(e(o),e(v).cardKinds),se=>P(v,e(v).cardKinds=se)),n(i,C)});var T=s(z,2),te=t(T),me=t(te),xe=s(te,2);X(xe,5,()=>kt,G,(i,o)=>{var C=ya(),k=t(C),K,ae=s(k);f(()=>{K!==(K=e(o))&&(k.value=(k.__value=e(o))==null?"":e(o)),b(ae,` ${lt[e(o)]??""}${Ct[e(o)]??""}`)}),Oe(r,[],k,()=>(e(o),e(v).monsterCategories),se=>P(v,e(v).monsterCategories=se)),n(i,C)});var ne=s(T,2),de=t(ne),Ae=t(de),h=s(de,2);X(h,5,()=>Dt,G,(i,o)=>{var C=xa(),k=t(C),K,ae=s(k,2),se=s(ae);f(()=>{K!==(K=e(o))&&(k.value=(k.__value=e(o))==null?"":e(o)),Se(ae,`monster_attr ${e(o)??""} svelte-138s9ji`),b(se,` ${jt[e(o)]??""}`)}),Oe(m,[],k,()=>(e(o),e(v).monsterAttributes),at=>P(v,e(v).monsterAttributes=at)),n(i,C)});var M=s(ne,2),Q=t(M),$e=t(Q),Ue=s(Q,2);X(Ue,5,()=>gt,G,(i,o)=>{var C=Ma(),k=t(C),K,ae=s(k);f(()=>{K!==(K=e(o))&&(k.value=(k.__value=e(o))==null?"":e(o)),b(ae,` ${ot[e(o)]??""}
                ${Yt[e(o)]??""}`)}),Oe(u,[],k,()=>(e(o),e(v).monsterTypes),se=>P(v,e(v).monsterTypes=se)),n(i,C)});var He=s(M,2),ze=t(He),Ve=t(ze),Fe=s(ze,2);X(Fe,5,()=>bt,G,(i,o)=>{var C=wa(),k=t(C),K,ae=s(k);f(()=>{K!==(K=e(o))&&(k.value=(k.__value=e(o))==null?"":e(o)),b(ae,` ${nt[e(o)]??""}`)}),Oe(B,[],k,()=>(e(o),e(v).spellCategories),se=>P(v,e(v).spellCategories=se)),n(i,C)});var qe=s(He,2),Ke=t(qe),Xe=t(Ke),et=s(Ke,2);X(et,5,()=>ht,G,(i,o)=>{var C=Ca(),k=t(C),K,ae=s(k);f(()=>{K!==(K=e(o))&&(k.value=(k.__value=e(o))==null?"":e(o)),b(ae,` ${dt[e(o)]??""}`)}),Oe(J,[],k,()=>(e(o),e(v).trapCategories),se=>P(v,e(v).trapCategories=se)),n(i,C)});var tt=s(qe,2),O=s(t(tt),2),H=t(O),F=t(H),ve=s(g,2);ba(ve,{get cardInfo(){return e(pe)}});var ge=s(p,2),St=t(ge);const Tt=Te(Me);Mt(St,{mode:"List",get allCardInfos(){return e(Tt)},onAttention:ye,get deckCardInfos(){return e(L).cardInfos},set deckCardInfos(i){P(L,e(L).cardInfos=i)},$$legacy:!0});var $t=s(ge,2),At=t($t);Be(At,()=>e(W),i=>{var o=Ha();n(i,o)},(i,o)=>{var C=Aa(),k=oe(C),K=t(k),ae=t(K),se=s(t(ae));f(()=>{e(E),Re(()=>{e(o)})}),X(se,5,()=>e(o),G,(re,ce)=>{var De=ja(),Ne={},st=t(De);f(()=>{Ne!==(Ne=e(ce).id)&&(De.value=(De.__value=e(ce).id)==null?"":e(ce).id),b(st,e(ce).name)}),n(re,De)});var at=s(ae,4),Ht=s(t(at)),ct=s(K,4),_t=s(t(ct),2),Nt=t(_t),ut=s(_t,4),Et=t(ut),Ot=s(ut,2),Lt=t(Ot),Ut=s(ct,2),pt=s(t(Ut),2);Be(pt,he,re=>{var ce=Sa();n(re,ce)},(re,ce)=>{var De=Ya(),Ne=t(De);f(st=>Ge(Ne,"href",st),[()=>Ye.convertToObjectURL([e(ce)])],Te),n(re,De)});var zt=s(pt,2);Be(zt,()=>e(ke),re=>{var ce=$a();n(re,ce)},(re,ce)=>{var De=Ta(),Ne=t(De);f(()=>Ge(Ne,"href",e(ce))),n(re,De)});var Ft=s(k,2);Mt(Ft,{mode:"Deck",allCardInfos:[],onAttention:ye,get deckCardInfos(){return e(L).cardInfos},set deckCardInfos(re){P(L,e(L).cardInfos=re)},$$legacy:!0}),We(se,()=>e(E),re=>q(E,re)),R("change",se,N),vt(Ht,()=>e(L).name,re=>P(L,e(L).name=re)),R("click",Nt,w),R("click",Et,we),R("click",Lt,be),n(i,C)}),f(()=>Se(g,`deck_editor_search_box ${(e(ie)==="SearchCondition"?"":"minimum")??""} svelte-138s9ji`)),R("click",Y,V),vt(A,()=>e(v).name,i=>P(v,e(v).name=i)),R("click",$,()=>ee("cardKinds")),R("click",me,()=>ee("monsterCategories")),R("click",Ae,()=>ee("monsterAttributes")),R("click",$e,()=>ee("monsterTypes")),R("click",Ve,()=>ee("spellCategories")),R("click",Xe,()=>ee("trapCategories")),Bt(F,()=>e(v).isForTest,i=>P(v,e(v).isForTest=i)),R("mouseenter",g,()=>q(ie,"SearchCondition")),n(_,Ce),Ze()}const Oa="2025-05-04 20:01:53",La={timestamp:Oa},Ua=["TblDeckHeader","TblDeckDetail","TblDuelistProfile"],za=3;var Fa=c("<option> </option>"),Ka=c("<option> </option>"),Pa=c("<option> </option>"),Ra=c("<option> </option>"),Wa=c('<div class="svelte-1tmphfm"><label for="deck_selector" class="deck_selector svelte-1tmphfm">デッキ：</label> <select id="deck_selector" class="deck_selector svelte-1tmphfm"></select></div> <div class="svelte-1tmphfm"><label for="npc_selector" class="npc_selector svelte-1tmphfm">対戦相手：</label> <select id="npc_selector" class="npc_selector svelte-1tmphfm"></select> <div> </div></div> <div class="svelte-1tmphfm"><label for="npc_deck_selector" class="deck_selector svelte-1tmphfm">対戦相手のデッキ：</label> <select id="npc_deck_selector" class="deck_selector svelte-1tmphfm"><option>デフォルト</option><!></select></div> <div class="svelte-1tmphfm"><label for="npc_selector" class="npc_selector svelte-1tmphfm">先攻後攻：</label> <select id="npc_selector" class="npc_selector svelte-1tmphfm"></select></div> <div class="svelte-1tmphfm"><button class="btn svelte-1tmphfm">duel start!</button></div>',1),Ia=c('<div class="svelte-1tmphfm">デッキ情報の読み込み、もしくは作成中...</div>'),Ba=c('<div class="svelte-1tmphfm"><label for="duelist_name" class="duelist_name svelte-1tmphfm">名前：</label> <input id="duelist_name" class="duelist_name svelte-1tmphfm" type="text"></div> <!> <div class="svelte-1tmphfm"><button class="btn svelte-1tmphfm">deck edit</button></div>',1),Va=c('<div class="svelte-1tmphfm">デュエリスト情報の読み込み、もしくは作成中...</div>'),qa=c('<div class="app_body svelte-1tmphfm"><!></div>'),Xa=c('<div class="result_title result_win svelte-1tmphfm">YOU WIN</div>'),Ga=c('<div class="result_title result_lose svelte-1tmphfm">YOU LOSE</div>'),Ja=c('<div class="result_title result_draw svelte-1tmphfm">DRAW</div>'),Qa=c('<div class="result svelte-1tmphfm"><!> <button class="white_button svelte-1tmphfm">TOPへ戻る</button></div>'),Za=c('<main class="svelte-1tmphfm"><div class="link link_left svelte-1tmphfm"><a href="https://github.com/Setta238/stk_ygo_svelte" target="_blank" rel="noopener noreferrer" title="repository" class="svelte-1tmphfm">repository</a> <a href="https://x.com/ninja_no" target="_blank" rel="noopener noreferrer" title="repository" class="svelte-1tmphfm">X(Twitter)</a> <a href="https://posfie.com/@ninja_no/p/Lx7FLj3" target="_blank" rel="noopener noreferrer" title="posfie" class="svelte-1tmphfm">posfie(toggeter)</a></div> <div class="link link_right svelte-1tmphfm"><a class="a_button svelte-1tmphfm" role="button" tabindex="0">TOPへ戻る</a> <a href="/stk_ygo_svelte/note.html" target="_blank" rel="noopener noreferrer" title="repository" class="svelte-1tmphfm">現時点とこの先のこと</a></div> <!> <div class="debug_info svelte-1tmphfm"><span> </span> <span class="user_agent_info"> </span> <span class="screen_info"></span></div> <!></main>');function es(_,l){Je(l,!1);const a=new Vt("stk_ygo_svelte",za,Ua);let r=fe(),m=fe("None"),u=fe(0);const B=qt.getOrCreateNew(a);let J=fe(Ye.getAllDeckInfo(a).then(p=>(Promise.all(p.filter(g=>!g.lastUsedAt).map(g=>{g.saveDeckInfo()})),q(u,(p.find(g=>g.lastUsedAt.getTime()===Math.max(...p.map(d=>d.lastUsedAt.getTime())))??p[0]).id),p)));const ue=async()=>{let p=(await e(J)).find(g=>g.id===e(u));if(p||(p=(await ie()).find(g=>g.id===e(u))),!p)throw new Error("illegal state");return p},v=async()=>{(await B).save()},ie=()=>(q(J,Ye.getAllDeckInfo(a).then(p=>(q(u,(p.find(g=>g.lastUsedAt.getTime()===Math.max(...p.map(d=>d.lastUsedAt.getTime())))??p[0]).id),p))),e(J)),V=async()=>{(await e(J)).length||(await Ye.prepareSampleDeck(),ie())},N=async()=>{await Promise.all([v(),V()]);const p=await ue(),g=await B;await p.updateTimestamp();const d=it.find(Y=>Y.id===g.previousNpcId);let D=xt.slice(-1)[0];d&&(g.previousNpcDeckId>-1?D=(await e(J)).find(Y=>Y.id===g.previousNpcDeckId)??D:d.id===-1&&(D=xt.find(Y=>Y.id===-1)??D),q(r,new ea(g,"Player",p,[],d,"NPC",D,[],g.previousStartMode)),e(r).onDuelEnd.append(()=>(q(r,e(r)),"RemoveMe")))},j=async()=>{await Promise.all([v(),V()]),q(m,"DeckEdit")},E=async p=>{await v(),p.key==="Enter"&&!p.repeat&&(await B).save()},W=()=>{q(J,ie()),q(r,void 0),q(m,"None")};V(),Qe();var ke=Za(),le=s(t(ke),2),L=t(le),pe=s(le,2);{var Me=p=>{Xt(p,{get duel(){return e(r)}})},ye=p=>{var g=Le(),d=oe(g);{var D=S=>{Ea(S,{})},Y=S=>{var U=qa(),A=t(U);Be(A,()=>B,z=>{var y=Va();n(z,y)},(z,y)=>{var $=Ba(),x=oe($),T=s(t(x),2),te=s(x,2);Be(te,()=>e(J),ne=>{var de=Ia();n(ne,de)},(ne,de)=>{var Ae=Wa(),h=oe(Ae),M=s(t(h),2);f(()=>{e(u),Re(()=>{e(de)})}),X(M,5,()=>e(de),G,(O,H)=>{var F=Fa(),ve={},ge=t(F);f(()=>{ve!==(ve=e(H).id)&&(F.value=(F.__value=e(H).id)==null?"":e(H).id),b(ge,e(H).name)}),n(O,F)});var Q=s(h,2),$e=s(t(Q),2);f(()=>{e(y),Re(()=>{})}),X($e,5,()=>it,G,(O,H)=>{var F=Ka(),ve={},ge=t(F);f(()=>{ve!==(ve=e(H).id)&&(F.value=(F.__value=e(H).id)==null?"":e(H).id),b(ge,e(H).name)}),n(O,F)});var Ue=s($e,2),He=t(Ue),ze=s(Q,2),Ve=s(t(ze),2);f(()=>{e(y),Re(()=>{e(de)})});var Fe=t(Ve);Fe.value=(Fe.__value=Number.MIN_SAFE_INTEGER)==null?"":Number.MIN_SAFE_INTEGER;var qe=s(Fe);X(qe,1,()=>e(de),G,(O,H)=>{var F=Pa(),ve={},ge=t(F);f(()=>{ve!==(ve=e(H).id)&&(F.value=(F.__value=e(H).id)==null?"":e(H).id),b(ge,e(H).name)}),n(O,F)});var Ke=s(ze,2),Xe=s(t(Ke),2);f(()=>{e(y),Re(()=>{})}),X(Xe,5,()=>Zt(yt),G,(O,H)=>{var F=Ra(),ve={},ge=t(F);f(()=>{ve!==(ve=e(H))&&(F.value=(F.__value=e(H))==null?"":e(H)),b(ge,yt[e(H)])}),n(O,F)});var et=s(Ke,2),tt=t(et);f(O=>b(He,`※${O??""}`),[()=>{var O;return(O=it.find(H=>H.id===e(y).previousNpcId))==null?void 0:O.description}],Te),We(M,()=>e(u),O=>q(u,O)),We($e,()=>e(y).previousNpcId,O=>e(y).previousNpcId=O),We(Ve,()=>e(y).previousNpcDeckId,O=>e(y).previousNpcDeckId=O),We(Xe,()=>e(y).previousStartMode,O=>e(y).previousStartMode=O),R("click",tt,N),n(ne,Ae)});var me=s(te,2),xe=t(me);vt(T,()=>e(y).name,ne=>e(y).name=ne),R("keypress",T,E),R("click",xe,j),n(z,$)}),n(S,U)};I(d,S=>{e(m)==="DeckEdit"?S(D):S(Y,!1)},!0)}n(p,g)};I(pe,p=>{e(r)?p(Me):p(ye,!1)})}var he=s(pe,2),ee=t(he),w=t(ee),we=s(ee,2),be=t(we),Ce=s(he,2);{var je=p=>{var g=Qa(),d=t(g);{var D=U=>{var A=Le(),z=oe(A);{var y=x=>{var T=Xa();n(x,T)},$=x=>{var T=Le(),te=oe(T);{var me=xe=>{var ne=Ga();n(xe,ne)};I(te,xe=>{e(r).winner.seat==="Above"&&xe(me)},!0)}n(x,T)};I(z,x=>{e(r).winner.seat==="Below"?x(y):x($,!1)})}n(U,A)},Y=U=>{var A=Ja();n(U,A)};I(d,U=>{e(r).winner?U(D):U(Y,!1)})}var S=s(d,2);R("click",S,W),Gt(3,g,()=>Jt,()=>({delay:200,duration:2e3})),n(p,g)};I(Ce,p=>{e(r)&&e(r).isEnded&&p(je)})}f(()=>{b(w,`build at: ${La.timestamp}`),b(be,Qt.text)}),R("click",L,W),n(_,ke),Ze()}ta(es,{target:document.getElementById("app")});
