var Al=Object.defineProperty;var pr=(t,e)=>(e=Symbol[t])?e:Symbol.for("Symbol."+t),gr=t=>{throw TypeError(t)};var Pl=(t,e,i)=>e in t?Al(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i;var c=(t,e,i)=>Pl(t,typeof e!="symbol"?e+"":e,i);var hr=(t,e,i)=>{if(e!=null){typeof e!="object"&&typeof e!="function"&&gr("Object expected");var a,r;i&&(a=e[pr("asyncDispose")]),a===void 0&&(a=e[pr("dispose")],i&&(r=a)),typeof a!="function"&&gr("Object not disposable"),r&&(a=function(){try{r.call(this)}catch(n){return Promise.reject(n)}}),t.push([i,a,e])}else i&&t.push([i]);return e},yr=(t,e,i)=>{var a=typeof SuppressedError=="function"?SuppressedError:function(s,l,o,u){return u=Error(o),u.name="SuppressedError",u.error=s,u.suppressed=l,u},r=s=>e=i?new a(s,e,"An error was suppressed during disposal"):(i=!0,s),n=s=>{for(;s=t.pop();)try{var l=s[1]&&s[1].call(s[2]);if(s[0])return Promise.resolve(l).then(n,o=>(r(o),n()))}catch(o){r(o)}if(i)throw e};return n()};import{j as Ml}from"./json_20250608_171917.js";const ka=!1;var Wa=Array.isArray,Fl=Array.prototype.indexOf,Qa=Array.from,Ol=Object.defineProperty,At=Object.getOwnPropertyDescriptor,Xr=Object.getOwnPropertyDescriptors,Nl=Object.prototype,Bl=Array.prototype,Xa=Object.getPrototypeOf;function Ll(t){return typeof t=="function"}const Qt=()=>{};function ql(t){return typeof(t==null?void 0:t.then)=="function"}function Rl(t){return t()}function Da(t){for(var e=0;e<t.length;e++)t[e]()}const be=2,Kr=4,Ji=8,Ii=16,Ke=32,li=64,xi=128,Ee=256,Ai=512,pe=1024,Ye=2048,Lt=4096,Qe=8192,ea=16384,Yr=32768,ta=65536,Jr=1<<17,Hl=1<<19,Ir=1<<20,Xe=Symbol("$state"),Zl=Symbol("legacy props"),Gl=Symbol("");function en(t){return t===this.v}function $l(t,e){return t!=t?e==e:t!==e||t!==null&&typeof t=="object"||typeof t=="function"}function Ka(t){return!$l(t,this.v)}function Ul(t){throw new Error("https://svelte.dev/e/effect_in_teardown")}function jl(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function zl(t){throw new Error("https://svelte.dev/e/effect_orphan")}function Vl(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function Wl(t){throw new Error("https://svelte.dev/e/props_invalid_value")}function Ql(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function Xl(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function Kl(){throw new Error("https://svelte.dev/e/state_unsafe_local_read")}function Yl(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}let oi=!1,Jl=!1;function Il(){oi=!0}const Ya=1,Ja=2,tn=4,eo=8,to=16,io=1,ao=2,ro=4,no=8,so=16,lo=1,oo=2,co=4,uo=1,fo=2,se=Symbol();let W=null;function Pi(t){W=t}function ut(t,e=!1,i){W={p:W,c:null,e:null,m:!1,s:t,x:null,l:null},oi&&!e&&(W.l={s:null,u:null,r1:[],r2:ue(!1)})}function dt(t){const e=W;if(e!==null){const s=e.e;if(s!==null){var i=G,a=U;e.e=null;try{for(var r=0;r<s.length;r++){var n=s[r];De(n.effect),ke(n.reaction),Ht(n.fn)}}finally{De(i),ke(a)}}W=e.p,e.m=!0}return{}}function qt(){return!oi||W!==null&&W.l===null}function ue(t,e){var i={f:0,v:t,reactions:null,equals:en,rv:0,wv:0};return i}function po(t){return an(ue(t))}function Jt(t,e=!1){var a;const i=ue(t);return e||(i.equals=Ka),oi&&W!==null&&W.l!==null&&((a=W.l).s??(a.s=[])).push(i),i}function Mi(t,e=!1){return an(Jt(t,e))}function an(t){return U!==null&&!Be&&U.f&be&&(Le===null?Eo([t]):Le.push(t)),t}function Fp(t,e){return Y(t,qe(()=>P(t))),e}function Y(t,e){return U!==null&&!Be&&qt()&&U.f&(be|Ii)&&(Le===null||!Le.includes(t))&&Yl(),at(t,e)}function at(t,e){return t.equals(e)||(t.v,t.v=e,t.wv=Tn(),rn(t,Ye),qt()&&G!==null&&G.f&pe&&!(G.f&(Ke|li))&&(Ve===null?bo([t]):Ve.push(t))),e}function rn(t,e){var i=t.reactions;if(i!==null)for(var a=qt(),r=i.length,n=0;n<r;n++){var s=i[n],l=s.f;l&Ye||!a&&s===G||(Re(s,e),l&(pe|Ee)&&(l&be?rn(s,Lt):sa(s)))}}let nn=!1;function et(t,e=null,i){if(typeof t!="object"||t===null||Xe in t)return t;const a=Xa(t);if(a!==Nl&&a!==Bl)return t;var r=new Map,n=Wa(t),s=ue(0);n&&r.set("length",ue(t.length));var l;return new Proxy(t,{defineProperty(o,u,d){(!("value"in d)||d.configurable===!1||d.enumerable===!1||d.writable===!1)&&Ql();var f=r.get(u);return f===void 0?(f=ue(d.value),r.set(u,f)):Y(f,et(d.value,l)),!0},deleteProperty(o,u){var d=r.get(u);if(d===void 0)u in o&&r.set(u,ue(se));else{if(n&&typeof u=="string"){var f=r.get("length"),p=Number(u);Number.isInteger(p)&&p<f.v&&Y(f,p)}Y(d,se),vr(s)}return!0},get(o,u,d){var y;if(u===Xe)return t;var f=r.get(u),p=u in o;if(f===void 0&&(!p||(y=At(o,u))!=null&&y.writable)&&(f=ue(et(p?o[u]:se,l)),r.set(u,f)),f!==void 0){var h=P(f);return h===se?void 0:h}return Reflect.get(o,u,d)},getOwnPropertyDescriptor(o,u){var d=Reflect.getOwnPropertyDescriptor(o,u);if(d&&"value"in d){var f=r.get(u);f&&(d.value=P(f))}else if(d===void 0){var p=r.get(u),h=p==null?void 0:p.v;if(p!==void 0&&h!==se)return{enumerable:!0,configurable:!0,value:h,writable:!0}}return d},has(o,u){var h;if(u===Xe)return!0;var d=r.get(u),f=d!==void 0&&d.v!==se||Reflect.has(o,u);if(d!==void 0||G!==null&&(!f||(h=At(o,u))!=null&&h.writable)){d===void 0&&(d=ue(f?et(o[u],l):se),r.set(u,d));var p=P(d);if(p===se)return!1}return f},set(o,u,d,f){var x;var p=r.get(u),h=u in o;if(n&&u==="length")for(var y=d;y<p.v;y+=1){var v=r.get(y+"");v!==void 0?Y(v,se):y in o&&(v=ue(se),r.set(y+"",v))}p===void 0?(!h||(x=At(o,u))!=null&&x.writable)&&(p=ue(void 0),Y(p,et(d,l)),r.set(u,p)):(h=p.v!==se,Y(p,et(d,l)));var g=Reflect.getOwnPropertyDescriptor(o,u);if(g!=null&&g.set&&g.set.call(f,d),!h){if(n&&typeof u=="string"){var m=r.get("length"),C=Number(u);Number.isInteger(C)&&C>=m.v&&Y(m,C+1)}vr(s)}return!0},ownKeys(o){P(s);var u=Reflect.ownKeys(o).filter(p=>{var h=r.get(p);return h===void 0||h.v!==se});for(var[d,f]of r)f.v!==se&&!(d in o)&&u.push(d);return u},setPrototypeOf(){Xl()}})}function vr(t,e=1){Y(t,t.v+e)}function mr(t){return t!==null&&typeof t=="object"&&Xe in t?t[Xe]:t}function sn(t,e){return Object.is(mr(t),mr(e))}var Sr,ln,on,cn;function go(){if(Sr===void 0){Sr=window,ln=/Firefox/.test(navigator.userAgent);var t=Element.prototype,e=Node.prototype;on=At(e,"firstChild").get,cn=At(e,"nextSibling").get,t.__click=void 0,t.__className="",t.__attributes=null,t.__styles=null,t.__e=void 0,Text.prototype.__t=void 0}}function ia(t=""){return document.createTextNode(t)}function Fi(t){return on.call(t)}function aa(t){return cn.call(t)}function q(t,e){return Fi(t)}function Ne(t,e){{var i=Fi(t);return i instanceof Comment&&i.data===""?aa(i):i}}function Q(t,e=1,i=!1){let a=t;for(;e--;)a=aa(a);return a}function ho(t){t.textContent=""}function It(t){var e=be|Ye,i=U!==null&&U.f&be?U:null;return G===null||i!==null&&i.f&Ee?e|=Ee:G.f|=Ir,{ctx:W,deps:null,effects:null,equals:en,f:e,fn:t,reactions:null,rv:0,v:null,wv:0,parent:i??G}}function rt(t){const e=It(t);return e.equals=Ka,e}function un(t){var e=t.effects;if(e!==null){t.effects=null;for(var i=0;i<e.length;i+=1)st(e[i])}}function yo(t){for(var e=t.parent;e!==null;){if(!(e.f&be))return e;e=e.parent}return null}function vo(t){var e,i=G;De(yo(t));try{un(t),e=wn(t)}finally{De(i)}return e}function dn(t){var e=vo(t),i=(it||t.f&Ee)&&t.deps!==null?Lt:pe;Re(t,i),t.equals(e)||(t.v=e,t.wv=Tn())}function fn(t){G===null&&U===null&&zl(),U!==null&&U.f&Ee&&G===null&&jl(),tr&&Ul()}function mo(t,e){var i=e.last;i===null?e.last=e.first=t:(i.next=t,t.prev=i,e.last=t)}function Rt(t,e,i,a=!0){var r=(t&li)!==0,n=G,s={ctx:W,deps:null,nodes_start:null,nodes_end:null,f:t|Ye,first:null,fn:e,last:null,next:null,parent:r?null:n,prev:null,teardown:null,transitions:null,wv:0};if(i){var l=Pt;try{Tr(!0),ir(s),s.f|=Yr}catch(d){throw st(s),d}finally{Tr(l)}}else e!==null&&sa(s);var o=i&&s.deps===null&&s.first===null&&s.nodes_start===null&&s.teardown===null&&(s.f&(Ir|xi))===0;if(!o&&!r&&a&&(n!==null&&mo(s,n),U!==null&&U.f&be)){var u=U;(u.effects??(u.effects=[])).push(s)}return s}function Ia(t){const e=Rt(Ji,null,!1);return Re(e,pe),e.teardown=t,e}function _r(t){fn();var e=G!==null&&(G.f&Ke)!==0&&W!==null&&!W.m;if(e){var i=W;(i.e??(i.e=[])).push({fn:t,effect:G,reaction:U})}else{var a=Ht(t);return a}}function So(t){return fn(),Zt(t)}function _o(t){const e=Rt(li,t,!0);return(i={})=>new Promise(a=>{i.outro?mt(e,()=>{st(e),a(void 0)}):(st(e),a(void 0))})}function Ht(t){return Rt(Kr,t,!1)}function Zt(t){return Rt(Ji,t,!0)}function te(t,e=[],i=It){const a=e.map(i);return ra(()=>t(...a.map(P)))}function ra(t,e=0){return Rt(Ji|Ii|e,t,!0)}function _t(t,e=!0){return Rt(Ji|Ke,t,!0,e)}function pn(t){var e=t.teardown;if(e!==null){const i=tr,a=U;Cr(!0),ke(null);try{e.call(null)}finally{Cr(i),ke(a)}}}function gn(t,e=!1){var i=t.first;for(t.first=t.last=null;i!==null;){var a=i.next;st(i,e),i=a}}function To(t){for(var e=t.first;e!==null;){var i=e.next;e.f&Ke||st(e),e=i}}function st(t,e=!0){var i=!1;if((e||t.f&Hl)&&t.nodes_start!==null){for(var a=t.nodes_start,r=t.nodes_end;a!==null;){var n=a===r?null:aa(a);a.remove(),a=n}i=!0}gn(t,e&&!i),Bi(t,0),Re(t,ea);var s=t.transitions;if(s!==null)for(const o of s)o.stop();pn(t);var l=t.parent;l!==null&&l.first!==null&&hn(t),t.next=t.prev=t.teardown=t.ctx=t.deps=t.fn=t.nodes_start=t.nodes_end=null}function hn(t){var e=t.parent,i=t.prev,a=t.next;i!==null&&(i.next=a),a!==null&&(a.prev=i),e!==null&&(e.first===t&&(e.first=a),e.last===t&&(e.last=i))}function mt(t,e){var i=[];er(t,i,!0),yn(i,()=>{st(t),e&&e()})}function yn(t,e){var i=t.length;if(i>0){var a=()=>--i||e();for(var r of t)r.out(a)}else e()}function er(t,e,i){if(!(t.f&Qe)){if(t.f^=Qe,t.transitions!==null)for(const s of t.transitions)(s.is_global||i)&&e.push(s);for(var a=t.first;a!==null;){var r=a.next,n=(a.f&ta)!==0||(a.f&Ke)!==0;er(a,e,n?i:!1),a=r}}}function Nt(t){vn(t,!0)}function vn(t,e){if(t.f&Qe){t.f^=Qe,t.f&pe||(t.f^=pe),ci(t)&&(Re(t,Ye),sa(t));for(var i=t.first;i!==null;){var a=i.next,r=(i.f&ta)!==0||(i.f&Ke)!==0;vn(i,r?e:!1),i=a}if(t.transitions!==null)for(const n of t.transitions)(n.is_global||e)&&n.in()}}let Oi=!1,xa=[];function mn(){Oi=!1;const t=xa.slice();xa=[],Da(t)}function Tt(t){Oi||(Oi=!0,queueMicrotask(mn)),xa.push(t)}function Co(){Oi&&mn()}const Sn=0,wo=1;let bi=!1,ki=Sn,ei=!1,ti=null,Pt=!1,tr=!1;function Tr(t){Pt=t}function Cr(t){tr=t}let yt=[],Mt=0;let U=null,Be=!1;function ke(t){U=t}let G=null;function De(t){G=t}let Le=null;function Eo(t){Le=t}let de=null,ve=0,Ve=null;function bo(t){Ve=t}let _n=1,Ni=0,it=!1,tt=null;function Tn(){return++_n}function ci(t){var f;var e=t.f;if(e&Ye)return!0;if(e&Lt){var i=t.deps,a=(e&Ee)!==0;if(i!==null){var r,n,s=(e&Ai)!==0,l=a&&G!==null&&!it,o=i.length;if(s||l){var u=t,d=u.parent;for(r=0;r<o;r++)n=i[r],(s||!((f=n==null?void 0:n.reactions)!=null&&f.includes(u)))&&(n.reactions??(n.reactions=[])).push(u);s&&(u.f^=Ai),l&&d!==null&&!(d.f&Ee)&&(u.f^=Ee)}for(r=0;r<o;r++)if(n=i[r],ci(n)&&dn(n),n.wv>t.wv)return!0}(!a||G!==null&&!it)&&Re(t,pe)}return!1}function ko(t,e){for(var i=e;i!==null;){if(i.f&xi)try{i.fn(t);return}catch{i.f^=xi}i=i.parent}throw bi=!1,t}function Do(t){return(t.f&ea)===0&&(t.parent===null||(t.parent.f&xi)===0)}function na(t,e,i,a){if(bi){if(i===null&&(bi=!1),Do(e))throw t;return}i!==null&&(bi=!0);{ko(t,e);return}}function Cn(t,e,i=!0){var a=t.reactions;if(a!==null)for(var r=0;r<a.length;r++){var n=a[r];n.f&be?Cn(n,e,!1):e===n&&(i?Re(n,Ye):n.f&pe&&Re(n,Lt),sa(n))}}function wn(t){var h;var e=de,i=ve,a=Ve,r=U,n=it,s=Le,l=W,o=Be,u=t.f;de=null,ve=0,Ve=null,U=u&(Ke|li)?null:t,it=(u&Ee)!==0&&(!Pt||r===null||o),Le=null,Pi(t.ctx),Be=!1,Ni++;try{var d=(0,t.fn)(),f=t.deps;if(de!==null){var p;if(Bi(t,ve),f!==null&&ve>0)for(f.length=ve+de.length,p=0;p<de.length;p++)f[ve+p]=de[p];else t.deps=f=de;if(!it)for(p=ve;p<f.length;p++)((h=f[p]).reactions??(h.reactions=[])).push(t)}else f!==null&&ve<f.length&&(Bi(t,ve),f.length=ve);if(qt()&&Ve!==null&&!Be&&f!==null&&!(t.f&(be|Lt|Ye)))for(p=0;p<Ve.length;p++)Cn(Ve[p],t);return r!==null&&Ni++,d}finally{de=e,ve=i,Ve=a,U=r,it=n,Le=s,Pi(l),Be=o}}function xo(t,e){let i=e.reactions;if(i!==null){var a=Fl.call(i,t);if(a!==-1){var r=i.length-1;r===0?i=e.reactions=null:(i[a]=i[r],i.pop())}}i===null&&e.f&be&&(de===null||!de.includes(e))&&(Re(e,Lt),e.f&(Ee|Ai)||(e.f^=Ai),un(e),Bi(e,0))}function Bi(t,e){var i=t.deps;if(i!==null)for(var a=e;a<i.length;a++)xo(t,i[a])}function ir(t){var e=t.f;if(!(e&ea)){Re(t,pe);var i=G,a=W;G=t;try{e&Ii?To(t):gn(t),pn(t);var r=wn(t);t.teardown=typeof r=="function"?r:null,t.wv=_n;var n=t.deps,s;ka&&Jl&&t.f&Ye}catch(l){na(l,t,i,a||t.ctx)}finally{G=i}}}function En(){if(Mt>1e3){Mt=0;try{Vl()}catch(t){if(ti!==null)na(t,ti,null);else throw t}}Mt++}function bn(t){var e=t.length;if(e!==0){En();var i=Pt;Pt=!0;try{for(var a=0;a<e;a++){var r=t[a];r.f&pe||(r.f^=pe);var n=Mo(r);Ao(n)}}finally{Pt=i}}}function Ao(t){var e=t.length;if(e!==0)for(var i=0;i<e;i++){var a=t[i];if(!(a.f&(ea|Qe)))try{ci(a)&&(ir(a),a.deps===null&&a.first===null&&a.nodes_start===null&&(a.teardown===null?hn(a):a.fn=null))}catch(r){na(r,a,null,a.ctx)}}}function Po(){if(ei=!1,Mt>1001)return;const t=yt;yt=[],bn(t),ei||(Mt=0,ti=null)}function sa(t){ki===Sn&&(ei||(ei=!0,queueMicrotask(Po))),ti=t;for(var e=t;e.parent!==null;){e=e.parent;var i=e.f;if(i&(li|Ke)){if(!(i&pe))return;e.f^=pe}}yt.push(e)}function Mo(t){var e=[],i=t.first;e:for(;i!==null;){var a=i.f,r=(a&Ke)!==0,n=r&&(a&pe)!==0,s=i.next;if(!n&&!(a&Qe)){if(a&Kr)e.push(i);else if(r)i.f^=pe;else{var l=U;try{U=i,ci(i)&&ir(i)}catch(d){na(d,i,null,i.ctx)}finally{U=l}}var o=i.first;if(o!==null){i=o;continue}}if(s===null){let d=i.parent;for(;d!==null;){if(t===d)break e;var u=d.next;if(u!==null){i=u;continue e}d=d.parent}}i=s}return e}function ar(t){var e=ki,i=yt;try{En();const r=[];ki=wo,yt=r,ei=!1,bn(i);var a=t==null?void 0:t();return Co(),(yt.length>0||r.length>0)&&ar(),Mt=0,ti=null,a}finally{ki=e,yt=i}}async function Op(){await Promise.resolve(),ar()}function P(t){var e=t.f,i=(e&be)!==0;if(tt!==null&&tt.add(t),U!==null&&!Be){Le!==null&&Le.includes(t)&&Kl();var a=U.deps;t.rv<Ni&&(t.rv=Ni,de===null&&a!==null&&a[ve]===t?ve++:de===null?de=[t]:(!it||!de.includes(t))&&de.push(t))}else if(i&&t.deps===null&&t.effects===null){var r=t,n=r.parent;n!==null&&!(n.f&Ee)&&(r.f^=Ee)}return i&&(r=t,ci(r)&&dn(r)),t.v}function Fo(t){var e=tt;tt=new Set;var i=tt,a;try{if(qe(t),e!==null)for(a of tt)e.add(a)}finally{tt=e}return i}function Np(t){var e=Fo(()=>qe(t));for(var i of e)if(i.f&Jr)for(const a of i.deps||[])a.f&be||at(a,a.v);else at(i,i.v)}function qe(t){var e=Be;try{return Be=!0,t()}finally{Be=e}}const Oo=-7169;function Re(t,e){t.f=t.f&Oo|e}function No(t){if(!(typeof t!="object"||!t||t instanceof EventTarget)){if(Xe in t)Aa(t);else if(!Array.isArray(t))for(let e in t){const i=t[e];typeof i=="object"&&i&&Xe in i&&Aa(i)}}}function Aa(t,e=new Set){if(typeof t=="object"&&t!==null&&!(t instanceof EventTarget)&&!e.has(t)){e.add(t),t instanceof Date&&t.getTime();for(let a in t)try{Aa(t[a],e)}catch{}const i=Xa(t);if(i!==Object.prototype&&i!==Array.prototype&&i!==Map.prototype&&i!==Set.prototype&&i!==Date.prototype){const a=Xr(i);for(let r in a){const n=a[r].get;if(n)try{n.call(t)}catch{}}}}}const Bo=["touchstart","touchmove"];function Lo(t){return Bo.includes(t)}let wr=!1;function qo(){wr||(wr=!0,document.addEventListener("reset",t=>{Promise.resolve().then(()=>{var e;if(!t.defaultPrevented)for(const i of t.target.elements)(e=i.__on_r)==null||e.call(i)})},{capture:!0}))}function Ro(t,e,i,a=!0){a&&i();for(var r of e)t.addEventListener(r,i);Ia(()=>{for(var n of e)t.removeEventListener(n,i)})}function la(t){var e=U,i=G;ke(null),De(null);try{return t()}finally{ke(e),De(i)}}function ui(t,e,i,a=i){t.addEventListener(e,()=>la(i));const r=t.__on_r;r?t.__on_r=()=>{r(),a(!0)}:t.__on_r=()=>a(!0),qo()}const kn=new Set,Pa=new Set;function Ho(t,e,i,a={}){function r(n){if(a.capture||Xt.call(e,n),!n.cancelBubble)return la(()=>i==null?void 0:i.call(this,n))}return t.startsWith("pointer")||t.startsWith("touch")||t==="wheel"?Tt(()=>{e.addEventListener(t,r,a)}):e.addEventListener(t,r,a),r}function pt(t,e,i,a,r){var n={capture:a,passive:r},s=Ho(t,e,i,n);(e===document.body||e===window||e===document)&&Ia(()=>{e.removeEventListener(t,s,n)})}function oa(t){for(var e=0;e<t.length;e++)kn.add(t[e]);for(var i of Pa)i(t)}function Xt(t){var C;var e=this,i=e.ownerDocument,a=t.type,r=((C=t.composedPath)==null?void 0:C.call(t))||[],n=r[0]||t.target,s=0,l=t.__root;if(l){var o=r.indexOf(l);if(o!==-1&&(e===document||e===window)){t.__root=e;return}var u=r.indexOf(e);if(u===-1)return;o<=u&&(s=o)}if(n=r[s]||t.target,n!==e){Ol(t,"currentTarget",{configurable:!0,get(){return n||i}});var d=U,f=G;ke(null),De(null);try{for(var p,h=[];n!==null;){var y=n.assignedSlot||n.parentNode||n.host||null;try{var v=n["__"+a];if(v!==void 0&&!n.disabled)if(Wa(v)){var[g,...m]=v;g.apply(n,[t,...m])}else v.call(n,t)}catch(x){p?h.push(x):p=x}if(t.cancelBubble||y===e||y===null)break;n=y}if(p){for(let x of h)queueMicrotask(()=>{throw x});throw p}}finally{t.__root=e,delete t.currentTarget,ke(d),De(f)}}}function Zo(t){var e=document.createElement("template");return e.innerHTML=t,e.content}function Li(t,e){var i=G;i.nodes_start===null&&(i.nodes_start=t,i.nodes_end=e)}function $(t,e){var i=(e&uo)!==0,a=(e&fo)!==0,r,n=!t.startsWith("<!>");return()=>{r===void 0&&(r=Zo(n?t:"<!>"+t),i||(r=Fi(r)));var s=a||ln?document.importNode(r,!0):r.cloneNode(!0);if(i){var l=Fi(s),o=s.lastChild;Li(l,o)}else Li(s,s);return s}}function Bp(t=""){{var e=ia(t+"");return Li(e,e),e}}function vt(){var t=document.createDocumentFragment(),e=document.createComment(""),i=ia();return t.append(e,i),Li(e,i),t}function N(t,e){t!==null&&t.before(e)}let Ma=!0;function he(t,e){var i=e==null?"":typeof e=="object"?e+"":e;i!==(t.__t??(t.__t=t.nodeValue))&&(t.__t=i,t.nodeValue=i+"")}function Lp(t,e){return Go(t,e)}const bt=new Map;function Go(t,{target:e,anchor:i,props:a={},events:r,context:n,intro:s=!0}){go();var l=new Set,o=f=>{for(var p=0;p<f.length;p++){var h=f[p];if(!l.has(h)){l.add(h);var y=Lo(h);e.addEventListener(h,Xt,{passive:y});var v=bt.get(h);v===void 0?(document.addEventListener(h,Xt,{passive:y}),bt.set(h,1)):bt.set(h,v+1)}}};o(Qa(kn)),Pa.add(o);var u=void 0,d=_o(()=>{var f=i??e.appendChild(ia());return _t(()=>{if(n){ut({});var p=W;p.c=n}r&&(a.$$events=r),Ma=s,u=t(f,a)||{},Ma=!0,n&&dt()}),()=>{var y;for(var p of l){e.removeEventListener(p,Xt);var h=bt.get(p);--h===0?(document.removeEventListener(p,Xt),bt.delete(p)):bt.set(p,h)}Pa.delete(o),f!==i&&((y=f.parentNode)==null||y.removeChild(f))}});return $o.set(u,d),u}let $o=new WeakMap;const ga=0,Ti=1,ha=2;function qp(t,e,i,a,r){var n=t,s=qt(),l=W,o=se,u,d,f,p=(s?ue:Jt)(void 0),h=(s?ue:Jt)(void 0),y=!1;function v(m,C){y=!0,C&&(De(g),ke(g),Pi(l));try{m===ga&&i&&(u?Nt(u):u=_t(()=>i(n))),m===Ti&&a&&(d?Nt(d):d=_t(()=>a(n,p))),m!==ga&&u&&mt(u,()=>u=null),m!==Ti&&d&&mt(d,()=>d=null),m!==ha&&f&&mt(f,()=>f=null)}finally{C&&(Pi(null),ke(null),De(null),ar())}}var g=ra(()=>{if(o!==(o=e())){if(ql(o)){var m=o;y=!1,m.then(C=>{m===o&&(at(p,C),v(Ti,!0))},C=>{if(m===o)throw at(h,C),v(ha,!0),h.v}),Tt(()=>{y||v(ga,!0)})}else at(p,o),v(Ti,!1);return()=>o=se}})}function X(t,e,i=!1){var a=t,r=null,n=null,s=se,l=i?ta:0,o=!1;const u=(f,p=!0)=>{o=!0,d(p,f)},d=(f,p)=>{s!==(s=f)&&(s?(r?Nt(r):p&&(r=_t(()=>p(a))),n&&mt(n,()=>{n=null})):(n?Nt(n):p&&(n=_t(()=>p(a))),r&&mt(r,()=>{r=null})))};ra(()=>{o=!1,e(u),o||d(null,null)},l)}let Di=null;function ii(t,e){return e}function Uo(t,e,i,a){for(var r=[],n=e.length,s=0;s<n;s++)er(e[s].e,r,!0);var l=n>0&&r.length===0&&i!==null;if(l){var o=i.parentNode;ho(o),o.append(i),a.clear(),Je(t,e[0].prev,e[n-1].next)}yn(r,()=>{for(var u=0;u<n;u++){var d=e[u];l||(a.delete(d.k),Je(t,d.prev,d.next)),st(d.e,!l)}})}function ai(t,e,i,a,r,n=null){var s=t,l={flags:e,items:new Map,first:null},o=(e&tn)!==0;if(o){var u=t;s=u.appendChild(ia())}var d=null,f=!1,p=rt(()=>{var h=i();return Wa(h)?h:h==null?[]:Qa(h)});ra(()=>{var h=P(p),y=h.length;f&&y===0||(f=y===0,jo(h,l,s,r,e,a,i),n!==null&&(y===0?d?Nt(d):d=_t(()=>n(s)):d!==null&&mt(d,()=>{d=null})),P(p))})}function jo(t,e,i,a,r,n,s){var xe,Te,Vt,mi;var l=(r&eo)!==0,o=(r&(Ya|Ja))!==0,u=t.length,d=e.items,f=e.first,p=f,h,y=null,v,g=[],m=[],C,x,w,A;if(l)for(A=0;A<u;A+=1)C=t[A],x=n(C,A),w=d.get(x),w!==void 0&&((xe=w.a)==null||xe.measure(),(v??(v=new Set)).add(w));for(A=0;A<u;A+=1){if(C=t[A],x=n(C,A),w=d.get(x),w===void 0){var J=p?p.e.nodes_start:i;y=Vo(J,e,y,y===null?e.first:y.next,C,x,A,a,r,s),d.set(x,y),g=[],m=[],p=y.next;continue}if(o&&zo(w,C,A,r),w.e.f&Qe&&(Nt(w.e),l&&((Te=w.a)==null||Te.unfix(),(v??(v=new Set)).delete(w))),w!==p){if(h!==void 0&&h.has(w)){if(g.length<m.length){var ge=m[0],R;y=ge.prev;var B=g[0],E=g[g.length-1];for(R=0;R<g.length;R+=1)Er(g[R],ge,i);for(R=0;R<m.length;R+=1)h.delete(m[R]);Je(e,B.prev,E.next),Je(e,y,B),Je(e,E,ge),p=ge,y=E,A-=1,g=[],m=[]}else h.delete(w),Er(w,p,i),Je(e,w.prev,w.next),Je(e,w,y===null?e.first:y.next),Je(e,y,w),y=w;continue}for(g=[],m=[];p!==null&&p.k!==x;)p.e.f&Qe||(h??(h=new Set)).add(p),m.push(p),p=p.next;if(p===null)continue;w=p}g.push(w),y=w,p=w.next}if(p!==null||h!==void 0){for(var ie=h===void 0?[]:Qa(h);p!==null;)p.e.f&Qe||ie.push(p),p=p.next;var I=ie.length;if(I>0){var ye=r&tn&&u===0?i:null;if(l){for(A=0;A<I;A+=1)(Vt=ie[A].a)==null||Vt.measure();for(A=0;A<I;A+=1)(mi=ie[A].a)==null||mi.fix()}Uo(e,ie,ye,d)}}l&&Tt(()=>{var Si;if(v!==void 0)for(w of v)(Si=w.a)==null||Si.apply()}),G.first=e.first&&e.first.e,G.last=y&&y.e}function zo(t,e,i,a){a&Ya&&at(t.v,e),a&Ja?at(t.i,i):t.i=i}function Vo(t,e,i,a,r,n,s,l,o,u){var d=Di,f=(o&Ya)!==0,p=(o&to)===0,h=f?p?Jt(r):ue(r):r,y=o&Ja?ue(s):s,v={i:y,v:h,k:n,a:null,e:null,prev:i,next:a};Di=v;try{return v.e=_t(()=>l(t,h,y,u),nn),v.e.prev=i&&i.e,v.e.next=a&&a.e,i===null?e.first=v:(i.next=v,i.e.next=v.e),a!==null&&(a.prev=v,a.e.prev=v.e),v}finally{Di=d}}function Er(t,e,i){for(var a=t.next?t.next.e.nodes_start:i,r=e?e.e.nodes_start:i,n=t.e.nodes_start;n!==a;){var s=aa(n);r.before(n),n=s}}function Je(t,e,i){e===null?t.first=i:(e.next=i,e.e.next=i&&i.e),i!==null&&(i.prev=e,i.e.prev=e&&e.e)}function Fa(t,e,i,a,r){var l;var n=(l=e.$$slots)==null?void 0:l[i],s=!1;n===!0&&(n=e[i==="default"?"children":i],s=!0),n===void 0||n(t,s?()=>a:a)}function Dn(t){var e,i,a="";if(typeof t=="string"||typeof t=="number")a+=t;else if(typeof t=="object")if(Array.isArray(t)){var r=t.length;for(e=0;e<r;e++)t[e]&&(i=Dn(t[e]))&&(a&&(a+=" "),a+=i)}else for(i in t)t[i]&&(a&&(a+=" "),a+=i);return a}function Wo(){for(var t,e,i=0,a="",r=arguments.length;i<r;i++)(t=arguments[i])&&(e=Dn(t))&&(a&&(a+=" "),a+=e);return a}function gt(t){return typeof t=="object"?Wo(t):t??""}function Rp(t,e){var i=t.__attributes??(t.__attributes={});i.value===(i.value=e??void 0)||t.value===e&&(e!==0||t.nodeName!=="PROGRESS")||(t.value=e??"")}function Hp(t,e){var i=t.__attributes??(t.__attributes={});i.checked!==(i.checked=e??void 0)&&(t.checked=e)}function br(t,e,i,a){var r=t.__attributes??(t.__attributes={});r[e]!==(r[e]=i)&&(e==="style"&&"__styles"in t&&(t.__styles={}),e==="loading"&&(t[Gl]=i),i==null?t.removeAttribute(e):typeof i!="string"&&Qo(t).includes(e)?t[e]=i:t.setAttribute(e,i))}var kr=new Map;function Qo(t){var e=kr.get(t.nodeName);if(e)return e;kr.set(t.nodeName,e=[]);for(var i,a=t,r=Element.prototype;r!==a;){i=Xr(a);for(var n in i)i[n].set&&e.push(n);a=Xa(a)}return e}function ae(t,e,i){var a=t.__className,r=Xo(e,i);(a!==r||nn)&&(e==null&&!i?t.removeAttribute("class"):t.className=r,t.__className=r)}function Xo(t,e){return(t??"")+(e?" "+e:"")}const Ko=()=>performance.now(),We={tick:t=>requestAnimationFrame(t),now:()=>Ko(),tasks:new Set};function xn(){const t=We.now();We.tasks.forEach(e=>{e.c(t)||(We.tasks.delete(e),e.f())}),We.tasks.size!==0&&We.tick(xn)}function Yo(t){let e;return We.tasks.size===0&&We.tick(xn),{promise:new Promise(i=>{We.tasks.add(e={c:t,f:i})}),abort(){We.tasks.delete(e)}}}function Ci(t,e){la(()=>{t.dispatchEvent(new CustomEvent(e))})}function Jo(t){if(t==="float")return"cssFloat";if(t==="offset")return"cssOffset";if(t.startsWith("--"))return t;const e=t.split("-");return e.length===1?e[0]:e[0]+e.slice(1).map(i=>i[0].toUpperCase()+i.slice(1)).join("")}function Dr(t){const e={},i=t.split(";");for(const a of i){const[r,n]=a.split(":");if(!r||n===void 0)break;const s=Jo(r.trim());e[s]=n.trim()}return e}const Io=t=>t;function Zp(t,e,i){var a=Di,r,n,s,l=null;a.a??(a.a={element:t,measure(){r=this.element.getBoundingClientRect()},apply(){if(s==null||s.abort(),n=this.element.getBoundingClientRect(),r.left!==n.left||r.right!==n.right||r.top!==n.top||r.bottom!==n.bottom){const o=e()(this.element,{from:r,to:n},i==null?void 0:i());s=qi(this.element,o,void 0,1,()=>{s==null||s.abort(),s=void 0})}},fix(){if(!t.getAnimations().length){var{position:o,width:u,height:d}=getComputedStyle(t);if(o!=="absolute"&&o!=="fixed"){var f=t.style;l={position:f.position,width:f.width,height:f.height,transform:f.transform},f.position="absolute",f.width=u,f.height=d;var p=t.getBoundingClientRect();if(r.left!==p.left||r.top!==p.top){var h=`translate(${r.left-p.left}px, ${r.top-p.top}px)`;f.transform=f.transform?`${f.transform} ${h}`:h}}}},unfix(){if(l){var o=t.style;o.position=l.position,o.width=l.width,o.height=l.height,o.transform=l.transform}}}),a.a.element=t}function Gp(t,e,i,a){var r=(t&lo)!==0,n=(t&oo)!==0,s=r&&n,l=(t&co)!==0,o=s?"both":r?"in":"out",u,d=e.inert,f=e.style.overflow,p,h;function y(){var x=U,w=G;ke(null),De(null);try{return u??(u=i()(e,(a==null?void 0:a())??{},{direction:o}))}finally{ke(x),De(w)}}var v={is_global:l,in(){var x;if(e.inert=d,!r){h==null||h.abort(),(x=h==null?void 0:h.reset)==null||x.call(h);return}n||p==null||p.abort(),Ci(e,"introstart"),p=qi(e,y(),h,1,()=>{Ci(e,"introend"),p==null||p.abort(),p=u=void 0,e.style.overflow=f})},out(x){if(!n){x==null||x(),u=void 0;return}e.inert=!0,Ci(e,"outrostart"),h=qi(e,y(),p,0,()=>{Ci(e,"outroend"),x==null||x()})},stop:()=>{p==null||p.abort(),h==null||h.abort()}},g=G;if((g.transitions??(g.transitions=[])).push(v),r&&Ma){var m=l;if(!m){for(var C=g.parent;C&&C.f&ta;)for(;(C=C.parent)&&!(C.f&Ii););m=!C||(C.f&Yr)!==0}m&&Ht(()=>{qe(()=>v.in())})}}function qi(t,e,i,a,r){var n=a===1;if(Ll(e)){var s,l=!1;return Tt(()=>{if(!l){var g=e({direction:n?"in":"out"});s=qi(t,g,i,a,r)}}),{abort:()=>{l=!0,s==null||s.abort()},deactivate:()=>s.deactivate(),reset:()=>s.reset(),t:()=>s.t()}}if(i==null||i.deactivate(),!(e!=null&&e.duration))return r(),{abort:Qt,deactivate:Qt,reset:Qt,t:()=>a};const{delay:o=0,css:u,tick:d,easing:f=Io}=e;var p=[];if(n&&i===void 0&&(d&&d(0,1),u)){var h=Dr(u(0,1));p.push(h,h)}var y=()=>1-a,v=t.animate(p,{duration:o});return v.onfinish=()=>{var g=(i==null?void 0:i.t())??1-a;i==null||i.abort();var m=a-g,C=e.duration*Math.abs(m),x=[];if(C>0){var w=!1;if(u)for(var A=Math.ceil(C/16.666666666666668),J=0;J<=A;J+=1){var ge=g+m*f(J/A),R=Dr(u(ge,1-ge));x.push(R),w||(w=R.overflow==="hidden")}w&&(t.style.overflow="hidden"),y=()=>{var B=v.currentTime;return g+m*f(B/C)},d&&Yo(()=>{if(v.playState!=="running")return!1;var B=y();return d(B,1-B),!0})}v=t.animate(x,{duration:C,fill:"forwards"}),v.onfinish=()=>{y=()=>a,d==null||d(a,1-a),r()}},{abort:()=>{v&&(v.cancel(),v.effect=null,v.onfinish=Qt)},deactivate:()=>{r=Qt},reset:()=>{a===0&&(d==null||d(1,0))},t:()=>y()}}function $p(t,e,i=e){var a=qt();ui(t,"input",r=>{var n=r?t.defaultValue:t.value;if(n=va(t)?ma(n):n,i(n),a&&n!==(n=e())){var s=t.selectionStart,l=t.selectionEnd;t.value=n??"",l!==null&&(t.selectionStart=s,t.selectionEnd=Math.min(l,t.value.length))}}),qe(e)==null&&t.value&&i(va(t)?ma(t.value):t.value),Zt(()=>{var r=e();va(t)&&r===ma(t.value)||t.type==="date"&&!r&&!t.value||r!==t.value&&(t.value=r??"")})}const ya=new Set;function Up(t,e,i,a,r=a){var n=i.getAttribute("type")==="checkbox",s=t;if(e!==null)for(var l of e)s=s[l]??(s[l]=[]);s.push(i),ui(i,"change",()=>{var o=i.__value;n&&(o=ec(s,o,i.checked)),r(o)},()=>r(n?[]:null)),Zt(()=>{var o=a();n?(o=o||[],i.checked=o.includes(i.__value)):i.checked=sn(i.__value,o)}),Ia(()=>{var o=s.indexOf(i);o!==-1&&s.splice(o,1)}),ya.has(s)||(ya.add(s),Tt(()=>{s.sort((o,u)=>o.compareDocumentPosition(u)===4?-1:1),ya.delete(s)})),Tt(()=>{})}function jp(t,e,i=e){ui(t,"change",a=>{var r=a?t.defaultChecked:t.checked;i(r)}),qe(e)==null&&i(t.checked),Zt(()=>{var a=e();t.checked=!!a})}function ec(t,e,i){for(var a=new Set,r=0;r<t.length;r+=1)t[r].checked&&a.add(t[r].__value);return i||a.delete(e),Array.from(a)}function va(t){var e=t.type;return e==="number"||e==="range"}function ma(t){return t===""?null:+t}function zp(t,e,i=e){ui(t,"change",()=>{i(t.files)}),Zt(()=>{t.files=e()})}function An(t,e,i){if(t.multiple)return ic(t,e);for(var a of t.options){var r=Kt(a);if(sn(r,e)){a.selected=!0;return}}(!i||e!==void 0)&&(t.selectedIndex=-1)}function tc(t,e){Ht(()=>{var i=new MutationObserver(()=>{var a=t.__value;An(t,a)});return i.observe(t,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),()=>{i.disconnect()}})}function Vp(t,e,i=e){var a=!0;ui(t,"change",r=>{var n=r?"[selected]":":checked",s;if(t.multiple)s=[].map.call(t.querySelectorAll(n),Kt);else{var l=t.querySelector(n)??t.querySelector("option:not([disabled])");s=l&&Kt(l)}i(s)}),Ht(()=>{var r=e();if(An(t,r,a),a&&r===void 0){var n=t.querySelector(":checked");n!==null&&(r=Kt(n),i(r))}t.__value=r,a=!1}),tc(t)}function ic(t,e){for(var i of t.options)i.selected=~e.indexOf(Kt(i))}function Kt(t){return"__value"in t?t.__value:t.value}function xr(t,e){return t===e||(t==null?void 0:t[Xe])===e}function Wp(t={},e,i,a){return Ht(()=>{var r,n;return Zt(()=>{r=n,n=[],qe(()=>{t!==i(...n)&&(e(t,...n),r&&xr(i(...r),t)&&e(null,...r))})}),()=>{Tt(()=>{n&&xr(i(...n),t)&&e(null,...n)})}}),t}function Qp(t,e){Ro(window,["resize"],()=>la(()=>e(window[t])))}function Gt(t=!1){const e=W,i=e.l.u;if(!i)return;let a=()=>No(e.s);if(t){let r=0,n={};const s=It(()=>{let l=!1;const o=e.s;for(const u in o)o[u]!==n[u]&&(n[u]=o[u],l=!0);return l&&r++,r});a=()=>P(s)}i.b.length&&So(()=>{Ar(e,a),Da(i.b)}),_r(()=>{const r=qe(()=>i.m.map(Rl));return()=>{for(const n of r)typeof n=="function"&&n()}}),i.a.length&&_r(()=>{Ar(e,a),Da(i.a)})}function Ar(t,e){if(t.l.s)for(const i of t.l.s)P(i);e()}let wi=!1;function ac(t){var e=wi;try{return wi=!1,[t(),wi]}finally{wi=e}}function K(t,e,i,a){var ge;var r=(i&io)!==0,n=!oi||(i&ao)!==0,s=(i&no)!==0,l=(i&so)!==0,o=!1,u;s?[u,o]=ac(()=>t[e]):u=t[e];var d=Xe in t||Zl in t,f=s&&(((ge=At(t,e))==null?void 0:ge.set)??(d&&e in t&&(R=>t[e]=R)))||void 0,p=a,h=!0,y=!1,v=()=>(y=!0,h&&(h=!1,l?p=qe(a):p=a),p);u===void 0&&a!==void 0&&(f&&n&&Wl(),u=v(),f&&f(u));var g;if(n)g=()=>{var R=t[e];return R===void 0?v():(h=!0,y=!1,R)};else{var m=(r?It:rt)(()=>t[e]);m.f|=Jr,g=()=>{var R=P(m);return R!==void 0&&(p=void 0),R===void 0?p:R}}if(!(i&ro))return g;if(f){var C=t.$$legacy;return function(R,B){return arguments.length>0?((!n||!B||C||o)&&f(B?g():R),R):g()}}var x=!1,w=!1,A=Jt(u),J=It(()=>{var R=g(),B=P(A);return x?(x=!1,w=!0,B):(w=!1,A.v=R)});return r||(J.equals=Ka),function(R,B){if(tt!==null&&(x=w,g(),P(A)),arguments.length>0){const E=B?P(J):n&&s?et(R):R;return J.equals(E)||(x=!0,Y(A,E),y&&p!==void 0&&(p=E),qe(()=>P(J))),R}return P(J)}}const rc="5";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(rc);Il();class Xp{constructor(e,i,a){c(this,"_dbname");c(this,"_dbversion");c(this,"dbPromise");c(this,"getTran",async(e,i)=>(await this.dbPromise).transaction(e,i));c(this,"reset",async()=>(await indexedDB.databases().then(e=>{console.log(e)}),await new Promise((e,i)=>{const a=indexedDB.deleteDatabase(this._dbname);a.onsuccess=()=>{console.log("onsuccess"),e()},a.onerror=r=>{console.log("onerror"),i(r)}})));c(this,"getAll",async e=>{const i=await this.dbPromise;return new Promise((a,r)=>{const l=i.transaction([e],"readonly").objectStore(e).getAll();l.onsuccess=()=>{a(l.result)},l.onerror=o=>{r(o)}})});c(this,"get",async(e,i)=>{const a=await this.dbPromise;return new Promise((r,n)=>{const o=a.transaction([e],"readonly").objectStore(e).get(i);o.onsuccess=()=>{r(o.result)},o.onerror=u=>{n(u)}})});c(this,"getMany",async(e,i)=>{const n=(await this.dbPromise).transaction([e],"readonly").objectStore(e),s=i.map(l=>new Promise((o,u)=>{const d=n.get(l);d.onsuccess=()=>{o(d.result)},d.onerror=f=>{u(f)}}));return await Promise.all(s)});c(this,"putRecords",async(e,i)=>{const r=(await this.dbPromise).transaction([e],"readwrite"),n=r.objectStore(e),s=i.map(l=>({record:l,request:n.put(l)}));return new Promise((l,o)=>{r.oncomplete=()=>l(s.map(u=>Object.assign({id:u.request.result},u.record))),r.onerror=u=>o(u)})});c(this,"deleteRecords",async(e,i)=>{const r=(await this.dbPromise).transaction([e],"readwrite"),n=r.objectStore(e),s=i.map(l=>({key:l,request:n.delete(l)}));return new Promise((l,o)=>{r.oncomplete=()=>{console.log(s.map(u=>u.request.result)),l()},r.onerror=u=>o(u)})});this._dbname=e,this._dbversion=i,this.dbPromise=new Promise((r,n)=>{const s=indexedDB.open(e,i);s.onsuccess=l=>{if(console.log(l),!l.target){console.log("event.target is undefined"),n("event.target is undefined");return}const o=l.target.result;if(!o){console.log("event.target.result is undefined"),n("event.target.result is undefined");return}o.onversionchange=u=>{console.log(u),o.close()},r(o)},s.onupgradeneeded=l=>{console.log("onupgradeneeded");const o=l.target.result;a.filter(u=>!o.objectStoreNames.contains(u)).map(u=>o.createObjectStore(u,{keyPath:"id",autoIncrement:!0}))},s.onerror=l=>{console.log(l),n(l)},s.onblocked=l=>{console.log(l),n(l)}}),console.log(this.dbPromise)}get dbversion(){return this._dbversion}}class V{constructor(){c(this,"handlers",[])}get length(){return this.handlers.length}append(e){this.handlers.push(e)}remove(e){this.handlers=this.handlers.filter(i=>i!==e)}trigger(e){this.handlers.slice(0).filter(i=>i(e)==="RemoveMe").forEach(i=>this.remove(i))}clear(){this.handlers.splice(0)}expose(){return this}}class Pr{constructor(){c(this,"handler")}set(e){this.handler=e}async call(e){if(!this.handler)throw Error("illegal state error");return await this.handler(e)}expose(){return this}}class rr{constructor(e,i,a,r){c(this,"_name");c(this,"_createVersion");c(this,"mountResolver",()=>{});c(this,"_indexedDb");c(this,"onInsertEvent",new V);c(this,"onBeforeInsertEvent",new Pr);c(this,"onUpdateEvent",new V);c(this,"onBeforeUpdateEvent",new Pr);c(this,"onDeleteEvent",new V);c(this,"prepareInitialRecords",()=>{const e=new Date;return this._prepareInitialRecords().map(i=>Object.assign(i,{createdAt:e,updatedAt:e,dbVersion:this._createVersion}))});c(this,"resolveMount",()=>this.mountResolver());c(this,"patchForInsert",(e,i)=>{e.newRecords.forEach(a=>{i[a.id]=a})});c(this,"patchForUpdate",(e,i)=>{e.recordPairs.forEach(a=>{i[a.newRecord.id]={...a.newRecord}})});c(this,"patchForDelete",(e,i)=>{e.oldRecords.forEach(a=>{delete i[a.id]})});this._indexedDb=e,this._name=i,this._createVersion=e.dbversion,this.getAll().then(n=>n.reduce((s,l)=>(s[l.id]=l,s),{})).then(n=>{console.log(this.name,n),this.onBeforeInsertEvent.set(a??(()=>Promise.resolve())),this.onBeforeUpdateEvent.set(r??(()=>Promise.resolve()))})}get name(){return this._name}get createVersion(){return this._createVersion}get oninsert(){return this.onInsertEvent.expose()}get onbeforeinsert(){return this.onBeforeInsertEvent.expose()}get onupdate(){return this.onUpdateEvent.expose()}get onbeforeupdate(){return this.onBeforeUpdateEvent.expose()}get ondelete(){return this.onDeleteEvent.expose()}getAll(){return this._indexedDb.getAll(this.name)}get(e){return this._indexedDb.get(this.name,e)}async insertMany(e){const i=new Date,a=e.map(n=>{const s={createdAt:i,updatedAt:i,dbVersion:this._createVersion};return Object.assign(n,s)});await this.onBeforeInsertEvent.call({sender:this,newRecords:a,timestamp:i});const r=await this._indexedDb.putRecords(this.name,a);return this.onInsertEvent.trigger({sender:this,newRecords:r,timestamp:i}),r}async insert(e){return(await this.insertMany([e]))[0]}async updateMany(e,i){const a=new Date,r=[];return(await this._indexedDb.getMany(this.name,e)).forEach(s=>{const l={...s},o={...l};r.push({newRecord:Object.assign(i(o),{updatedAt:a,dbVersion:this._createVersion}),oldRecord:l})}),await this.onBeforeUpdateEvent.call({sender:this,recordPairs:r,timestamp:a}),await this._indexedDb.putRecords(this.name,r.map(s=>s.newRecord)),this.onUpdateEvent.trigger({sender:this,recordPairs:r,timestamp:a}),r.map(s=>s.newRecord)}async update(e,i){return(await this.updateMany([e],i))[0]}async delete(e){const i=new Date,a=await this._indexedDb.getMany(this.name,e);await this._indexedDb.deleteRecords(this.name,e),this.onDeleteEvent.trigger({sender:this,oldRecords:a,timestamp:i})}}const Kp=["Deck","ExtraDeck"],Yp={Deck:"ãƒ¡ã‚¤ãƒ³ãƒ‡ãƒƒã‚­",ExtraDeck:"ã‚¨ã‚¯ã‚¹ãƒˆãƒ©ãƒ‡ãƒƒã‚­"},nc=["Monster","Spell","Trap","XyzMaterial"],Jp={Monster:"ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼",Spell:"é­”æ³•",Trap:"ç½ ",XyzMaterial:"XYZç´ æ"},Ri=["Fusion","Synchro","Xyz","Link"],Pn=[...Ri,"SpecialSummon","Ritual"],Mn=[...Pn,"NormalSummonOnly","RegularSpecialSummonOnly","FreeReborn"],sc=["Toon","Spirit","Union","Gemini","FlipEffect"],lc=["Tuner","Effect","Normal","Pendulum","Token"],Ip=[...sc,...lc,...Mn],oc={Synchro:"ã‚·ãƒ³ã‚¯ãƒ­",Fusion:"èžåˆ",Xyz:"ã‚¨ã‚¯ã‚·ãƒ¼ã‚º",Link:"ãƒªãƒ³ã‚¯",Ritual:"å„€å¼",SpecialSummon:"ç‰¹æ®Šå¬å–š",Toon:"ãƒˆã‚¥ãƒ¼ãƒ³",Spirit:"ã‚¹ãƒ”ãƒªãƒƒãƒˆ",Union:"ãƒ¦ãƒ‹ã‚ªãƒ³",Gemini:"ãƒ‡ãƒ¥ã‚¢ãƒ«",FlipEffect:"ãƒªãƒãƒ¼ã‚¹",Tuner:"ãƒãƒ¥ãƒ¼ãƒŠãƒ¼",Effect:"åŠ¹æžœ",Normal:"é€šå¸¸",Pendulum:"ãƒšãƒ³ãƒ‡ãƒ¥ãƒ©ãƒ ",Token:"ãƒˆãƒ¼ã‚¯ãƒ³",FreeReborn:"ç‰¹æ®Šå¬å–šãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ï¼ˆè˜‡ç”Ÿåˆ¶é™ãªã—ï¼‰",NormalSummonOnly:"ç‰¹æ®Šå¬å–šä¸å¯",RegularSpecialSummonOnly:"æ­£è¦ã®æ–¹æ³•ä»¥å¤–ã§ã®ç‰¹æ®Šå¬å–šä¸å¯"},cc={Synchro:"ðŸŽµ",Fusion:"ðŸŒ€",Xyz:"ðŸ“°",Link:"â›“ï¸",Ritual:"ðŸ“œ",SpecialSummon:"ðŸ”¯",Toon:"ðŸ“–",Spirit:"ðŸ‘»",Union:"ðŸš—",Gemini:"ðŸ‘«",FlipEffect:"ðŸ”„",Tuner:"ðŸŽ¶",Effect:"âœ¨",Normal:"ðŸ”˜",Pendulum:"ðŸ’ ",Token:"ðŸ",FreeReborn:"ðŸ†“",NormalSummonOnly:"ðŸ”²",RegularSpecialSummonOnly:"â—"},uc=["Light","Dark","Earth","Water","Fire","Wind","Divine"],eg={Light:"å…‰",Dark:"é—‡",Earth:"åœ°",Water:"æ°´",Fire:"ç‚Ž",Wind:"é¢¨",Divine:"ç¥ž"},tg=["Aqua","Beast","BeastWarrior","CreatorGod","Cyberse","Dinosaur","DivineBeast","Dragon","Fairy","Fiend","Fish","Insect","Illusion","Machine","Plant","Psychic","Pyro","Reptile","Rock","SeaSerpent","Spellcaster","Thunder","Warrior","WingedBeast","Wyrm","Zombie"],ig=["Normal","Continuous","Field","QuickPlay","Equip","Ritual","PendulumScale"],dc={Normal:"é€šå¸¸",Continuous:"æ°¸ç¶š",Field:"ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰",QuickPlay:"é€Ÿæ”»",Equip:"è£…å‚™",Ritual:"å„€å¼",PendulumScale:"ãƒšãƒ³ãƒ‡ãƒ¥ãƒ©ãƒ "},ag=["Normal","Continuous","Counter"],fc={Normal:"é€šå¸¸",Continuous:"æ°¸ç¶š",Counter:"ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼"},k=["Attack","Defense"],Ei={Attack:"æ”»æ’ƒè¡¨ç¤º",Defense:"å®ˆå‚™è¡¨ç¤º",Set:"è£å´å®ˆå‚™è¡¨ç¤º"},Fn=["level","rank","attack","defense","pendulumScaleR","pendulumScaleL"],pc={Aqua:"æ°´",Beast:"ç£",BeastWarrior:"ç£æˆ¦å£«",CreatorGod:"å‰µé€ ç¥ž",Cyberse:"ã‚µã‚¤ãƒãƒ¼ã‚¹",Dinosaur:"æç«œ",DivineBeast:"å¹»ç£ç¥ž",Dragon:"ãƒ‰ãƒ©ã‚´ãƒ³",Fairy:"å¤©ä½¿",Fiend:"æ‚ªé­”",Fish:"é­š",Insect:"æ˜†è™«",Illusion:"å¹»æƒ³é­”",Machine:"æ©Ÿæ¢°",Plant:"æ¤ç‰©",Psychic:"ã‚µã‚¤ã‚­ãƒƒã‚¯",Pyro:"ç‚Ž",Reptile:"çˆ¬è™«é¡ž",Rock:"å²©çŸ³",SeaSerpent:"æµ·ç«œ",Spellcaster:"é­”æ³•ä½¿ã„",Thunder:"é›·",Warrior:"æˆ¦å£«",WingedBeast:"é³¥ç£",Wyrm:"å¹»ç«œ",Zombie:"ã‚¢ãƒ³ãƒ‡ãƒƒãƒˆ"},gc={Aqua:"ðŸš°",Beast:"ðŸ…",BeastWarrior:"ðŸ¦",CreatorGod:"ðŸ”†",Cyberse:"ðŸ’»ï¸",Dinosaur:"ðŸ¦–",DivineBeast:"ðŸ’«",Dragon:"ðŸ²",Fairy:"ðŸ‘¼",Fiend:"ðŸ‘¿",Fish:"ðŸŸï¸",Insect:"ðŸ¦‹",Illusion:"ðŸ¤¡",Machine:"ðŸ¤–",Plant:"ðŸŒ±",Psychic:"ðŸ‘ï¸",Pyro:"ðŸ”¥",Reptile:"ðŸ¦Ž",Rock:"â›°",SeaSerpent:"ðŸ",Spellcaster:"ðŸ§™",Thunder:"âš¡ï¸",Warrior:"âš”ï¸",WingedBeast:"ðŸ¦…",Wyrm:"ðŸ‰",Zombie:"ðŸ¦´"},hc=["TopLeft","TopCenter","TopRight","MiddleLeft","MiddleRight","BottomLeft","BottomCenter","BottomRight"],On={TopLeft:{name:"å·¦ä¸Š",linkArrow:{offsetRow:-1,offsetColumn:-1}},TopCenter:{name:"ä¸Š",linkArrow:{offsetRow:-1,offsetColumn:0}},TopRight:{name:"å³ä¸Š",linkArrow:{offsetRow:-1,offsetColumn:1}},MiddleLeft:{name:"å·¦",linkArrow:{offsetRow:0,offsetColumn:-1}},MiddleRight:{name:"å³",linkArrow:{offsetRow:0,offsetColumn:1}},BottomLeft:{name:"å·¦ä¸‹",linkArrow:{offsetRow:1,offsetColumn:-1}},BottomCenter:{name:"ä¸‹",linkArrow:{offsetRow:1,offsetColumn:0}},BottomRight:{name:"å³ä¸‹",linkArrow:{offsetRow:1,offsetColumn:1}}};hc.reduce((t,e)=>(t[On[e].name]=e,t),{});const rg=t=>t.cardId??!1?`https://www.db.yugioh-card.com/yugiohdb/card_search.action?ope=2&cid=${t.cardId}`:`https://www.db.yugioh-card.com/yugiohdb/card_search.action?ope=1&sess=1&rp=10&mode=&sort=1&keyword=${t.name}&stype=1&ctype=&othercon=2&starfr=&starto=&pscalefr=&pscaleto=&linkmarkerfr=&linkmarkerto=&link_m=2&atkfr=&atkto=&deffr=&defto=&releaseDStart=1&releaseMStart=1&releaseYStart=1999&releaseDEnd=&releaseMEnd=&releaseYEnd=`,Nn=(t,e)=>{const i=t.monsterCategories??[],a=e.monsterCategories??[];for(const r of Ri.toReversed()){if(i.includes(r)&&!a.includes(r))return 1;if(!i.includes(r)&&a.includes(r))return-1}if(t.kind===e.kind){if(t.kind==="Monster"){if((t.link??0)!==(e.link??0))return(t.link??0)-(e.link??0);if((t.rank??0)!==(e.rank??0))return(t.rank??0)-(e.rank??0);if((t.level??0)!==(e.level??0))return(t.level??0)-(e.level??0);if((t.attack??0)!==(e.attack??0))return(t.attack??0)-(e.attack??0);if((t.defense??0)!==(e.defense??0))return(t.defense??0)-(e.defense??0)}return t.name.localeCompare(e.name,"Ja")}for(const r of nc){if(t.kind===r)return-1;if(e.kind===r)return 1}return t.name.localeCompare(e.name,"Ja")},Bn=["Deck","ExtraDeck"],ca=["Graveyard","Banished"],Ln=[...Bn,...ca],yc=[...Ln,"Hand"],H=["MonsterZone","ExtraMonsterZone"],Hi=["SpellAndTrapZone","FieldSpellZone"],Se=[...H,...Hi],qn=["XyzMaterialZone","WaitingRoom"],Me=[...yc,...Se,...qn],vc={Deck:"ãƒ‡ãƒƒã‚­",ExtraDeck:"EXãƒ‡ãƒƒã‚­",Graveyard:"å¢“åœ°",Banished:"é™¤å¤–",Hand:"æ‰‹æœ­",MonsterZone:"å ´",ExtraMonsterZone:"å ´",SpellAndTrapZone:"å ´",FieldSpellZone:"å ´",XyzMaterialZone:"XYZç´ æ",WaitingRoom:"è™šç„¡"},mc={Deck:"Random",ExtraDeck:"Bottom",Graveyard:"Top",Banished:"Top",Hand:"Bottom",MonsterZone:"Top",ExtraMonsterZone:"Top",SpellAndTrapZone:"Top",FieldSpellZone:"Top",XyzMaterialZone:"Bottom",WaitingRoom:"Bottom"},Sc={Deck:"FaceDown",ExtraDeck:"FaceDown",Graveyard:"FaceUp",Banished:"FaceUp",Hand:"FaceDown",MonsterZone:"FaceUp",ExtraMonsterZone:"FaceUp",SpellAndTrapZone:"FaceUp",FieldSpellZone:"FaceUp",XyzMaterialZone:"FaceUp",WaitingRoom:"FaceUp"},Oa={0:{0:"Hand"},1:{0:"Deck",1:"SpellAndTrapZone",2:"SpellAndTrapZone",3:"SpellAndTrapZone",4:"SpellAndTrapZone",5:"SpellAndTrapZone",6:"ExtraDeck"},2:{0:"Graveyard",1:"MonsterZone",2:"MonsterZone",3:"MonsterZone",4:"MonsterZone",5:"MonsterZone",6:"FieldSpellZone"},3:{0:"Banished",1:"XyzMaterialZone",2:"ExtraMonsterZone",3:"WaitingRoom",4:"ExtraMonsterZone",5:"XyzMaterialZone",6:"Banished"},4:{0:"FieldSpellZone",1:"MonsterZone",2:"MonsterZone",3:"MonsterZone",4:"MonsterZone",5:"MonsterZone",6:"Graveyard"},5:{0:"ExtraDeck",1:"SpellAndTrapZone",2:"SpellAndTrapZone",3:"SpellAndTrapZone",4:"SpellAndTrapZone",5:"SpellAndTrapZone",6:"Deck"},6:{0:"Hand"}};class _c{constructor(e,i,a,r){c(this,"onUpdateEvent",new V);c(this,"field");c(this,"row");c(this,"column");c(this,"cellType");c(this,"_owner");c(this,"_requiresRecalcLinkArrows");c(this,"_linkArrowSources");c(this,"_needsShuffle",!1);c(this,"recalcLinkArrows",()=>{this.isMonsterZoneLikeCell&&(this._requiresRecalcLinkArrows=!1,this._linkArrowSources=this.neighbors.filter(e=>e.isMonsterZoneLikeCell).filter(e=>e.cardEntities.length).filter(e=>e.cardEntities[0].linkArrows.some(i=>this.row===e.row+i.offsetRow&&this.column===e.column+i.offsetColumn)).map(e=>e.cardEntities[0]))});c(this,"_entities");c(this,"releaseEntities",e=>{var i;return this._entities=this._entities.filter(a=>a!==e),this.isMonsterZoneLikeCell&&((i=e.origin.monsterCategories)!=null&&i.includes("Link"))&&(this._requiresRecalcLinkArrows=!0),this.onUpdateEvent.trigger(),e});c(this,"acceptEntities",(e,i)=>{var a;if(i==="Fix"){if(!this._entities.includes(e))throw new S("å¼•æ•°ã¨ã‚»ãƒ«ã®çŠ¶æ…‹ãŒçŸ›ç›¾ã—ã¦ã„ã‚‹ã€‚",this,e,i)}else i==="Top"?this._entities.unshift(e):this._entities.push(e),i==="Random"&&(this._needsShuffle=!0),this._entities.forEach(r=>{r.cell=this}),this.isMonsterZoneLikeCell&&((a=e.origin.monsterCategories)!=null&&a.includes("Link"))&&(this._requiresRecalcLinkArrows=!0);this.onUpdateEvent.trigger()});c(this,"shuffle",()=>{this._entities=this.entities.shuffle(),this._needsShuffle=!1,this.field.duel.log.info("ãƒ‡ãƒƒã‚­ã‚’ã‚·ãƒ£ãƒƒãƒ•ãƒ«ã€‚",this.owner)});c(this,"toString",()=>this.isMonsterZoneLikeCell||this.cellType==="SpellAndTrapZone"?`${this.cellType}(${this.row},${this.column})`:this.cellType);this.field=e,this.row=i,this.column=a,this.cellType=Oa[i][a],this._owner=r,this._entities=[],this._linkArrowSources=[],this._requiresRecalcLinkArrows=!1}get onUpdate(){return this.onUpdateEvent.expose()}get owner(){var e;return this._owner||((e=this.cardEntities[0])==null?void 0:e.owner)}get requiresRecalcLinkArrows(){return this._requiresRecalcLinkArrows}get linkArrowSources(){return this._linkArrowSources}get needsShuffle(){return this._needsShuffle}get entities(){return this._entities}get visibleEntities(){return this._entities.filter(e=>Br.find(i=>i===e.entityType))}get cardEntities(){return this._entities.filter(e=>Br.find(i=>i===e.entityType)).filter(e=>e.kind!=="XyzMaterial")}get xyzMaterials(){return this._entities.filter(e=>e.kind==="XyzMaterial")}get targetForAttack(){return this.cellType==="Hand"?this._entities.find(e=>e.entityType==="Duelist"):this.cardEntities[0]}get isAvailable(){return this.cardEntities.length===0&&this._entities.filter(e=>ou.find(i=>i===e.entityType)).length===0}get isAvailableForPendulum(){return this.isAvailable&&this.isSpellTrapZoneLikeCell&&(this.column===1||this.column===5)}get isStackCell(){return Ln.some(e=>e===this.cellType)}get isPlayFieldCell(){return Se.some(e=>e===this.cellType)}get isMonsterZoneLikeCell(){return H.some(e=>e===this.cellType)}get isSpellTrapZoneLikeCell(){return Hi.some(e=>e===this.cellType)}get isDisabledCell(){return qn.some(e=>e===this.cellType)}get isTrashCell(){return ca.some(e=>e===this.cellType)}get neighbors(){const e=[this.row-1,this.row,this.row+1].filter(a=>a>=0&&a<=6),i=[this.column-1,this.column,this.column+1].filter(a=>a>=0&&a<=6);return e.flatMap(a=>i.map(r=>this.field.cells[a][r])).filter(a=>a.isMonsterZoneLikeCell).filter(a=>a!==this)}get shortName(){return vc[this.cellType]}}const Rn=["NormalSummon","SpecialSummon","FlipSummon"],nr=["IgnitionEffect","TriggerEffect","QuickEffect","CardActivation"],Tc=[...Rn,...nr,"DeclareAttack"],Cc=t=>t==="CardActivation"?"CardActivation":nr.some(e=>e===t)?"EffectActivation":"NonActivate",Vi=class Vi{constructor(e,i,a){c(this,"seq");c(this,"entity");c(this,"_definition");c(this,"validateDuelist",e=>this.entity.controller===e?this.executableDuelistTypes.includes("Controller"):this.executableDuelistTypes.includes("Opponent"));c(this,"canExecute",e=>this.executableCells.includes(this.entity.cell.cellType)&&this.executableFaces.includes(this.entity.face)&&this.executablePeriods.includes(this.entity.duel.clock.period.key)&&this.validateDuelist(e??this.entity.controller));this.seq=e==="AutoSeq"?Vi.nextSeq++:e,this.entity=i,this._definition=a}get definition(){return this._definition}get title(){return this.definition.title}get playType(){return this.definition.playType}get isMandatory(){return this.definition.isMandatory}get executableCells(){return this.definition.executableCells}get executablePeriods(){return this.definition.executablePeriods}get executableFaces(){return this.definition.executableFaces??sr}get executableDuelistTypes(){return this.definition.executableDuelistTypes??["Controller"]}get isOnlyNTimesPerDuel(){return this.definition.isOnlyNTimesPerDuel??0}get isOnlyNTimesPerTurn(){return this.definition.isOnlyNTimesPerTurn??0}get isOnlyNTimesPerTurnIfFaceup(){return this.definition.isOnlyNTimesPerTurnIfFaceup??0}get isOnlyNTimesIfFaceup(){return this.definition.isOnlyNTimesIfFaceup??0}get isOnlyNTimesPerChain(){return this.definition.isOnlyNTimesPerChain??0}get actionGroupName(){return this.definition.actionGroupName}get duel(){return this.entity.duel}};c(Vi,"nextSeq",0);let ri=Vi;class di{constructor(){c(this,"pooledOperators",[]);c(this,"bundles",[]);c(this,"excludesExpired",()=>{this.bundles.forEach(e=>e.excludesExpired()),this.pooledOperators=this.pooledOperators.filter(e=>e.validateAlive())});c(this,"append",e=>{this.bundles.push(e)});c(this,"push",e=>{if(!e.isContinuous)throw new S("staticã¸ã®è¿½åŠ ã¯æ°¸ç¶šä»¥å¤–ä¸å¯",e);this.excludesExpired(),this.distribute(e),this.pooledOperators.push(e)});c(this,"distributeAll",e=>(this.excludesExpired(),this.pooledOperators.flatMap(this.distribute).getDistinct().forEach(i=>i.operators.sort((a,r)=>a.seq-r.seq)),this.afterDistributeAll(e)));c(this,"distribute",e=>this.bundles.filter(i=>i.entity.exist).filter(i=>i.operators.every(a=>a.seq!==e.seq)).filter(i=>e.isApplicableTo(i.entity)).filter(i=>i.entity.canBeEffected(e.effectOwner,e.isSpawnedBy,e.actionAttr)).map(i=>(i.push(e),i)));c(this,"removeItem",e=>{this.pooledOperators=this.pooledOperators.filter(i=>i.seq!==e)})}}class fi{constructor(e,i){c(this,"pool");c(this,"entity");c(this,"_operators");c(this,"excludesExpired",()=>{this._operators=this._operators.filter(e=>{const i=e.validateAlive()&&e.isApplicableTo(this.entity);return i||(console.info(`before remove ${this.entity.toString} ${e.title}`),e.beforeRemove(this)),i})});c(this,"push",e=>this.entity.procFilterBundle.filter(["Effect"],e.effectOwner,e.isSpawnedBy,e.actionAttr,[])?(this.beforePush(e),this._operators.push(e),this.afterPush(e),!0):!1);c(this,"removeItem",e=>{this._operators=this._operators.filter(i=>i.seq!==e?!0:(i.beforeRemove(this),!1))});this.pool=e,this.entity=i,this._operators=[],this.pool.append(this)}get operators(){return this._operators}get effectiveOperators(){return this.operators.filter(e=>e.isSpawnedBy.isEffective||!e.isContinuous)}}const Wi=class Wi{constructor(e){c(this,"seq");c(this,"title");c(this,"validateAlive");c(this,"isContinuous");c(this,"isSpawnedBy");c(this,"isSpawnedAt");c(this,"activateType");c(this,"actionAttr");c(this,"isApplicableTo");c(this,"effectOwner");this.seq=Wi.nextSeq++,this.title=e.title,this.validateAlive=()=>e.validateAlive(this),this.isContinuous=e.isContinuous,this.isSpawnedBy=e.isSpawnedBy,this.isSpawnedAt=e.isSpawnedBy.duel.clock.getClone(),this.isApplicableTo=i=>e.isApplicableTo(this,i),this.actionAttr=e.actionAttr,this.activateType=this.actionAttr.playType?Cc(this.actionAttr.playType):"NonActivate",this.effectOwner=this.isSpawnedBy.controller}get duel(){return this.effectOwner.duel}get isEffective(){return!this.isContinuous||this.activateType==="NonActivate"?!0:this.isSpawnedBy.isEffective}};c(Wi,"nextSeq",0);let Ct=Wi;class wc extends di{constructor(){super(...arguments);c(this,"afterDistributeAll",()=>this.bundles.every(i=>i.applyEffectFilter()))}}class Ec extends fi{constructor(){super(...arguments);c(this,"applyEffectFilter",()=>{const i=this.entity.allStickyEffectOperators.length,a=[];for(;;){const r=this.effectiveOperators.filter(n=>n.procTypes.includes("Effect")).filter(n=>n.isContinuous).find(n=>!a.includes(n.seq));if(!r)break;a.push(r.seq),r.eraseOperators(this.entity)}return this.entity.allStickyEffectOperators.length===i});c(this,"filter",(i,a,r,n,s)=>this.effectiveOperators.filter(l=>l.procTypes.union(i).length).every(l=>l.filter(this.entity,a,r,n,s)));c(this,"beforePush",i=>i.eraseOperators(this.entity));c(this,"afterPush",()=>{})}}const xt=class xt extends Ct{constructor(i){super(i);c(this,"beforeRemove",()=>{});c(this,"procTypes");c(this,"filter");c(this,"eraseOperators",i=>{if(!this.procTypes.includes("Effect"))return 0;const a=i.allStickyEffectOperators.filter(r=>r.isContinuous).filter(r=>!this.filter(i,r.effectOwner,r.isSpawnedBy,r.actionAttr,[])).map(r=>r.seq);return a.forEach(i.procFilterBundle.removeItem),a.forEach(i.statusOperatorBundle.removeItem),a.forEach(i.numericOprsBundle.removeItem),a.length});this.procTypes=i.procTypes,this.filter=i.filter}};c(xt,"createContinuous",(i,a,r,n,s,l)=>new xt({title:i,validateAlive:a,isContinuous:!0,isSpawnedBy:r,actionAttr:{},isApplicableTo:n,procTypes:s,filter:l})),c(xt,"createLingering",(i,a,r,n,s,l,o)=>new xt({title:i,validateAlive:a,isContinuous:!1,isSpawnedBy:r,actionAttr:n,isApplicableTo:s,procTypes:l,filter:o}));let He=xt;const Mr={level:1,rank:1,attack:0,defense:0,pendulumScaleR:0,pendulumScaleL:0};class bc extends di{constructor(){super(...arguments);c(this,"afterDistributeAll",i=>{if(this.bundles.forEach(r=>r.calcStateAll()),i.field.getMonstersOnFieldStrictly().flatMap(r=>r.numericOprsBundle).flatMap(r=>r.effectiveOperators).some(r=>r.targetStateGen==="calculated")){const n=i.field.getMonstersOnFieldStrictly().filter(s=>(s.atk??0)>=0).map(s=>s.atk??0).reduce((s,l)=>s>l?s:l,0);i.field.getMonstersOnFieldStrictly().forEach(s=>{s.numericOprsBundle.effectiveOperators.filter(l=>l.targetStateGen==="calculated").forEach(l=>{var o;if(!((o=s.status.monsterCategories)!=null&&o.includes("Link")&&l.targetState==="defense")){if(l.stateOperationType==="THE_DEVILS_AVATAR"){s.numericStatus.calculated[l.targetState]=n+100;return}s.numericStatus.calculated[l.targetState]=l.calcValue(s,s.numericStatus.calculated[l.targetState]??0)}})})}return!0})}}class kc extends fi{constructor(){super(...arguments);c(this,"beforePush",i=>{const a=this.effectiveOperators.filter(n=>n.targetState===i.targetState).filter(n=>n.isEffective);if(i.kind==="O-L-F"||i.kind==="O-C-F"?(a.filter(n=>n.kind==="O-L-F").forEach(n=>n.negate()),a.filter(n=>n.kind==="L-F").forEach(n=>n.negate())):i.kind==="L-F"||i.kind==="C-F"?a.filter(n=>n.kind==="L-F"||n.kind==="L-A").forEach(n=>n.negate()):i.kind==="X-C-X"&&a.filter(n=>!n.isContinuous).forEach(n=>n.negate()),a.filter(n=>n.isEffective).some(n=>n.kind==="X-C-X")&&!i.isContinuous)return;if(i.stateOperationType!=="Addition"&&i.targetStateGen==="wip"&&a.filter(n=>!n.isContinuous).forEach(n=>n.negate()),i.stateOperationType==="THE_DEVILS_AVATAR"||i.stateOperationType==="Gradius'_Option"){this.entity.numericStatus.calculated[i.targetState]=-Number.MAX_VALUE;return}const r=this.entity.numericStatus.calculated[i.targetState]??0;if(i.stateOperationType==="THE_DEVILS_DREAD-ROOT"){this.entity.numericStatus.calculated[i.targetState]=i.calcValue(this.entity,r);return}if(i.kind==="L-F"){this.entity.numericStatus.wip[i.targetState]=i.calcValue(this.entity,r);return}});c(this,"afterPush",()=>{});c(this,"calcStateAll",()=>Fn.forEach(this.calcState));c(this,"calcState",i=>{if(!this.entity.isPendulumScale&&!this.entity.isMonster){this.entity.numericStatus.calculated[i]=void 0;return}if(!this.entity.status.monsterCategories){this.entity.numericStatus.calculated[i]=void 0;return}if(this.entity.status.monsterCategories.includes("Link")&&i!=="attack"){this.entity.numericStatus.calculated[i]=void 0;return}if(this.entity.status.monsterCategories.includes("Xyz")&&i==="level"){this.entity.numericStatus.calculated[i]=void 0;return}if(!this.entity.status.monsterCategories.includes("Xyz")&&i==="rank"){this.entity.numericStatus.calculated[i]=void 0;return}if(!this.entity.status.monsterCategories.includes("Pendulum")&&(i==="pendulumScaleL"||i==="pendulumScaleR")){this.entity.numericStatus.calculated[i]=void 0;return}if(i!=="level"&&!this.entity.isOnFieldStrictly){this.entity.numericStatus.origin[i]=this.entity.origin[i],this.entity.numericStatus.wip[i]=this.entity.origin[i],this.entity.numericStatus.calculated[i]=this.entity.origin[i];return}const a=this.entity.origin[i]??0,r=this.entity.numericStatus.wip[i]??0,n=this._operators.filter(d=>d.targetState===i).filter(d=>d.isEffective);if(n.some(d=>d.stateOperationType==="THE_DEVILS_AVATAR"||d.stateOperationType==="Gradius'_Option")&&this.entity.isEffective){this.entity.numericStatus.calculated[i]=-Number.MAX_VALUE;return}const s=n.filter(d=>d.targetState===i).findLast(d=>d.targetStateGen==="origin"),l=s?s.calcValue(this.entity,a??0):a;this.entity.numericStatus.origin[i]=l;let o=l;const u=n.filter(d=>d.targetState===i).filter(d=>d.targetStateGen==="wip").findLast(d=>d.stateOperationType==="Fixation");if(!u)o=n.filter(d=>d.stateOperationType==="Addition").reduce((d,f)=>f.calcValue(this.entity,d),o),this.entity.numericStatus.wip[i]=o;else if(u.isContinuous)o=u.calcValue(this.entity,o),o=n.filter(d=>d.stateOperationType==="Addition").reduce((d,f)=>f.calcValue(this.entity,d),o),this.entity.numericStatus.wip[i]=o;else{let d=!1;o=n.filter(f=>(d=d||f===u,d&&f!==u)).filter(f=>f.stateOperationType==="Addition").reduce((f,p)=>p.calcValue(this.entity,f),r)}o<Mr[i]&&(o=Mr[i]),this.entity.numericStatus.calculated[i]=o})}}const Oe=class Oe extends Ct{constructor(i){super(i);c(this,"beforeRemove",()=>{});c(this,"targetState");c(this,"targetStateGen");c(this,"stateOperationType");c(this,"calcValue");c(this,"_isEffective");c(this,"negate",()=>{this._isEffective=!1});this._isEffective=!0,this.targetState=i.targetState,this.targetStateGen=i.targetStateGen,this.stateOperationType=i.stateOperationType,this.calcValue=(a,r)=>i.calcValue(this.isSpawnedBy,a,r)}get isEffective(){return this._isEffective&&super.isEffective}get kind(){if(this.targetStateGen==="origin"){if(this.stateOperationType==="Fixation")return this.isContinuous?"O-C-F":"O-L-F";throw new S("çŸ›ç›¾ã—ãŸãƒ—ãƒ­ãƒ‘ãƒ†ã‚£",this)}if(this.targetStateGen==="wip"){if(this.stateOperationType==="Addition")return this.isContinuous?"C-A":"L-A";if(this.stateOperationType==="Fixation")return this.isContinuous?"C-F":"L-F";throw new S("çŸ›ç›¾ã—ãŸãƒ—ãƒ­ãƒ‘ãƒ†ã‚£",this)}if(this.stateOperationType==="THE_DEVILS_DREAD-ROOT")return"X-C-F";if(this.stateOperationType==="THE_DEVILS_AVATAR"||this.stateOperationType==="Gradius'_Option")return"X-C-X";throw new S("çŸ›ç›¾ã—ãŸãƒ—ãƒ­ãƒ‘ãƒ†ã‚£",this)}};c(Oe,"createContinuous",(i,a,r,n,s,l,o,u)=>new Oe({title:i,validateAlive:a,isContinuous:!0,isSpawnedBy:r,actionAttr:{},isApplicableTo:n,targetState:s,targetStateGen:l,stateOperationType:o,calcValue:u})),c(Oe,"createLingering",(i,a,r,n,s,l,o)=>new Oe({title:i,validateAlive:a,isContinuous:!1,isSpawnedBy:r,actionAttr:n,isApplicableTo:(u,d)=>d.isOnFieldAsMonsterStrictly,targetState:s,targetStateGen:"wip",stateOperationType:l,calcValue:o})),c(Oe,"createLingeringFixation",(i,a,r,n,s,l)=>Oe.createLingering(i,a,r,n,s,"Fixation",l)),c(Oe,"createLingeringAddition",(i,a,r,n,s,l)=>Oe.createLingering(i,a,r,n,s,"Addition",l));let ne=Oe;const Dc=t=>t!==null&&(typeof t=="object"||typeof t=="function"),Hn=t=>Object.keys(t),xc={draw:"ãƒ‰ãƒ­ãƒ¼ãƒ•ã‚§ã‚¤ã‚º",standby:"ã‚¹ã‚¿ãƒ³ãƒã‚¤ãƒ•ã‚§ã‚¤ã‚º",main1:"ãƒ¡ã‚¤ãƒ³ãƒ•ã‚§ã‚¤ã‚ºï¼‘",battle1:"ãƒãƒˆãƒ«ãƒ•ã‚§ã‚¤ã‚º",battle2:"ãƒãƒˆãƒ«ãƒ•ã‚§ã‚¤ã‚ºï¼ˆè¿½åŠ ï¼‰",main2:"ãƒ¡ã‚¤ãƒ³ãƒ•ã‚§ã‚¤ã‚ºï¼’",end:"ã‚¨ãƒ³ãƒ‰ãƒ•ã‚§ã‚¤ã‚º"},Ac={start:"ã‚¹ã‚¿ãƒ¼ãƒˆã‚¹ãƒ†ãƒƒãƒ—",battle:"ãƒãƒˆãƒ«ã‚¹ãƒ†ãƒƒãƒ—",damage:"ãƒ€ãƒ¡ãƒ¼ã‚¸ã‚¹ãƒ†ãƒƒãƒ—",end:"ã‚¨ãƒ³ãƒ‰ã‚¹ãƒ†ãƒƒãƒ—"},Pc={start:"ãƒ€ãƒ¡ãƒ¼ã‚¸ã‚¹ãƒ†ãƒƒãƒ—é–‹å§‹æ™‚",beforeDmgCalc:"ãƒ€ãƒ¡ãƒ¼ã‚¸è¨ˆç®—å‰",dmgCalc:"ãƒ€ãƒ¡ãƒ¼ã‚¸è¨ˆç®—æ™‚",afterDmgCalc:"ãƒ€ãƒ¡ãƒ¼ã‚¸è¨ˆç®—å¾Œ",end:"ãƒ€ãƒ¡ãƒ¼ã‚¸ã‚¹ãƒ†ãƒƒãƒ—çµ‚äº†æ™‚"},D=["draw","stanby","main1","b1Start","b1Battle","b1End","b2Start","b2Battle","b2End","main2","end"],O=["b1DStart","b1DBeforeDmgCalc","b1DAfterDmgCalc","b1DEnd","b2DStart","b2DBeforeDmgCalc","b2DAfterDmgCalc","b2DEnd"],Mc=["b1DDmgCalc","b2DDmgCalc"],le=[...D,...O,...Mc],Fr={draw:{phase:"draw",step:void 0,stage:void 0},stanby:{phase:"standby",step:void 0,stage:void 0},main1:{phase:"main1",step:void 0,stage:void 0},b1Start:{phase:"battle1",step:"start",stage:void 0},b1Battle:{phase:"battle1",step:"battle",stage:void 0},b1DStart:{phase:"battle1",step:"battle",stage:"start"},b1DBeforeDmgCalc:{phase:"battle1",step:"battle",stage:"beforeDmgCalc"},b1DDmgCalc:{phase:"battle1",step:"battle",stage:"dmgCalc"},b1DAfterDmgCalc:{phase:"battle1",step:"battle",stage:"afterDmgCalc"},b1DEnd:{phase:"battle1",step:"battle",stage:"end"},b1End:{phase:"battle1",step:"end",stage:void 0},b2Start:{phase:"battle2",step:"start",stage:void 0},b2Battle:{phase:"battle2",step:"battle",stage:void 0},b2DStart:{phase:"battle2",step:"battle",stage:"start"},b2DBeforeDmgCalc:{phase:"battle2",step:"battle",stage:"beforeDmgCalc"},b2DDmgCalc:{phase:"battle2",step:"battle",stage:"dmgCalc"},b2DAfterDmgCalc:{phase:"battle2",step:"battle",stage:"afterDmgCalc"},b2DEnd:{phase:"battle2",step:"battle",stage:"end"},b2End:{phase:"battle2",step:"end",stage:void 0},main2:{phase:"main2",step:void 0,stage:void 0},end:{phase:"end",step:void 0,stage:void 0}},Fc=t=>t.stage?Pc[t.stage]:t.step?Ac[t.step]:xc[t.phase],ht=Hn(Fr).reduce((t,e)=>(t[e].key=e,t[e].name=Fc(t[e]),t),Fr),Qi=class Qi{constructor(e,i){c(this,"entity");c(this,"isRegular");c(this,"_isStarted");c(this,"info");c(this,"continuousEffectBase");c(this,"updateState",async()=>{if(this.hasToStart!==this.isStarted){if(this.isStarted){if(!this.info)throw new S("illegal state");this._isStarted=!1,await this.continuousEffectBase.finish(this.entity,this.info),this.info=void 0;return}this.info=await this.continuousEffectBase.start(this.entity),this._isStarted=!0}});this._isStarted=!1,this.entity=e,this.continuousEffectBase=i,this.isRegular=this.appliableCellTypes.every(a=>Se.find(r=>r===a))&&this.faceList.length===1&&this.faceList[0]==="FaceUp"}get isStarted(){return this._isStarted}get appliableCellTypes(){return this.continuousEffectBase.appliableCellTypes}get appliableDuelPeriodKeys(){return this.continuousEffectBase.appliableDuelPeriodKeys}get faceList(){return this.continuousEffectBase.faceList}get hasToStart(){return!this.appliableCellTypes.includes(this.entity.cell.cellType)||!this.appliableDuelPeriodKeys.includes(this.entity.duel.clock.period.key)||!this.faceList.includes(this.entity.face)?!1:this.continuousEffectBase.canStart(this.entity)}};c(Qi,"createNew",(e,i)=>new Qi(e,i));let Na=Qi;const Zn=(t,e,i,a)=>({title:t,appliableCellTypes:e==="Monster"?["MonsterZone","ExtraMonsterZone"]:["FieldSpellZone","SpellAndTrapZone"],appliableDuelPeriodKeys:le,faceList:["FaceUp"],canStart:r=>!r.info.isPending&&!r.info.isDying,start:async r=>{const n=i(r);return n.forEach(a(r).push),n.map(s=>s.seq)},finish:async(r,n)=>{n.forEach(s=>a(r).removeItem(s))}}),ua=(t,e,i,a,r)=>({title:t,appliableCellTypes:e==="Monster"?["MonsterZone","ExtraMonsterZone"]:["FieldSpellZone","SpellAndTrapZone"],appliableDuelPeriodKeys:le,faceList:["FaceUp"],canStart:n=>!n.info.isPending&&!n.info.isDying,start:async n=>{const s=a(n),l=i(n);return console.info(`start : ${n.toString()} â‡’ ${l.map(o=>o.toString()).join(" ")} (${s.map(o=>o.title).join(" ")})`),l.map(r).forEach(o=>s.forEach(o.push)),{targets:l,seqList:s.map(o=>o.seq)}},finish:async(n,s)=>{s.targets.map(r).forEach(l=>s.seqList.forEach(o=>l.removeItem(o)))}}),Gn=(t,e,i)=>Zn(t,e,i,a=>a.field.procFilterPool),da=(t,e,i,a)=>ua(t,e,i,a,r=>r.procFilterBundle),Zi=(t,e,i)=>Zn(t,e,i,a=>a.field.numericStateOperatorPool),pi=(t,e,i,a)=>ua(t,e,i,a,r=>r.numericOprsBundle),ni=(t,e,i,a)=>ua(t,e,i,a,r=>r.statusOperatorBundle),Oc=(t,e,i,a)=>ua(t,e,i,a,r=>r.damageFilterBundle),$n=t=>!isNaN(Number(t)),Nc=(...t)=>t.length?t.reduce((e,i)=>e<i?e:i):Number.MAX_VALUE,kt=(t,e)=>{if((t[0]??Number.MAX_VALUE)>e)return 0;if(t.slice(-1)[0]<e)return t.length;let i=0,a=t.length-1;for(;;){const r=Math.round((i+a)/2);if(r===a||r===i)return t[i]<e?a:i;if(t[r]<e){i=r;continue}a=r}},Fe=[3,5,5,6,6,6,7,8,9,10,11,11,11,12,12,13,13,14,15,15,15,15,15,15,16,16,16,17,18,18,18,21,21,21,22,23,25,25,26,28,28,28,30,30,31,32,32,33,33,34,35,35,36,36,36,37,37,38,38,38,39,41,42,42,43,45,45,45,45,48,48,48,50,51,52,54,54,54,54,56,57,58,59,59,59,59,60,61,63,65,65,65,65,66,67,67,67,69,69,71,71,72,73,73,73,73,73,74,75,75,76,76,77,78,79,80,80,80,80,84,84,84,84,84,84,85,85,85,87,90,91,94,96,96,97,98,101,101,101,101,101];Fe.forEach((t,e)=>{((Fe[kt(Fe,e)-1]||-Number.MAX_VALUE)>=e||(Fe[kt(Fe,e)]||Number.MAX_VALUE)<e)&&console.log(e,kt(Fe,e),(Fe[kt(Fe,e)-1]||-Number.MAX_VALUE)<e,(Fe[kt(Fe,e)]||Number.MAX_VALUE)>=e)});const Bc=["seq","entityType","origin","cell","kind","nm","lvl","rank","attr","types","atk","def"],Or=t=>{if(!t)return;const e={};for(const i of Bc)e[i]=t[i];return e};class Lc{constructor(e){c(this,"_field");c(this,"_records",[]);c(this,"getIndexOfStartPoint",e=>kt(this._records.map(i=>i.movedAt.totalProcSeq),e));c(this,"push",e=>{this._records.push(e)});c(this,"getCurrentTurnLog",()=>this.getTermLog("Current","turn"));c(this,"getPriviousChainLog",()=>this.getTermLog("Previous","chainSeq"));this._field=e}*getTermLog(e,i){const a=e==="Current"?this._field.duel.clock.currentStartPoints[i]:this._field.duel.clock.previousStartPoints[i];for(let r=this.getIndexOfStartPoint(a);r<this._records.length;r++)yield this._records[r]}}class qc{constructor(e){c(this,"entity");c(this,"_records");c(this,"_push",e=>{this.entity.field.moveLog.push(e),this._records.push(e)});c(this,"pushForRuleAction",e=>{this._push({entity:this.entity,kind:this.entity.origin.kind,cell:this.entity.cell,face:this.entity.face,orientation:this.entity.orientation,isPending:this.entity.info.isPending,movedAt:this.entity.duel.clock.getClone(),movedAs:[...e,"Rule"]})});c(this,"push",(e,i,a,r,n)=>{let s=this.entity.cell;this.entity.kind==="XyzMaterial"&&(s=this.entity.controller.getXyzMaterialZone()),this._push({entity:this.entity,kind:e,cell:s,face:this.entity.face,orientation:this.entity.orientation,isPending:this.entity.info.isPending,movedAt:this.entity.duel.clock.getClone(),movedAs:i.getDistinct(),movedBy:Or(a),actionOwner:r,chooser:n??r})});c(this,"finalize",()=>{if(!this.latestRecord.isPending)throw new S("æƒ³å®šã•ã‚Œãªã„çŠ¶æ³");if(this.entity.info.isPending)throw new S("æƒ³å®šã•ã‚Œãªã„çŠ¶æ³");this._push({...this.latestRecord,isPending:!1,movedAt:this.entity.duel.clock.getClone()})});c(this,"negateSummon",(e,i)=>{const a=this.records.slice(-1)[0];a.cell=this.entity.field.getWaitingRoomCell(),a.movedBy=Or(e),a.movedAs=["SummonNegated"],a.actionOwner=i});this.entity=e,this._records=[]}get records(){return this._records}get latestRecord(){return this.records.slice(-1)[0]}get previousPlaceRecord(){return this.records.findLast(e=>e.cell.cellType!==this.entity.cell.cellType)??this._records[0]}get currentProcRecords(){return this.records.filter(e=>e.movedAt.totalProcSeq===this.entity.duel.clock.totalProcSeq)}get latestArrivalRecord(){if(this.entity.isOnFieldAsMonsterStrictly)return this.records.findLast(e=>e.movedAs.union(["NormalSummon","SpecialSummon","FlipSummon","Flip","ComeBackAlive"]).length)}}const Rc={name:"SpellCounter",type:"Actual",text:"é­”åŠ›ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼",emoji:"ðŸ”®",sticky:!1,temporary:!1,isOnlyOnField:!0},Hc={name:"KaijuCounter",type:"Actual",text:"å£Šç£ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼",emoji:"â˜¢",sticky:!1,temporary:!1,isOnlyOnField:!0},Zc={name:"NamelessCounter",type:"Actual",text:"ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼",emoji:"ðŸ’ ",sticky:!1,temporary:!1,isOnlyOnField:!0},Gc={name:"IceCounter",type:"Actual",text:"ã‚¢ã‚¤ã‚¹ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼",emoji:"â„",sticky:!1,temporary:!1,isOnlyOnField:!0},$c={name:"Curfew",type:"System",text:"è‡ªç™ºå¸°é‚„",emoji:"",sticky:!1,temporary:!1,isOnlyOnField:!0},Uc={name:"SelfDestruction",type:"System",text:"è‡ªå£Š",emoji:"",sticky:!1,temporary:!1,isOnlyOnField:!0},jc={name:"CycleFlip",type:"System",text:"ã‚µã‚¤ã‚¯ãƒ«ãƒªãƒãƒ¼ã‚¹",emoji:"",sticky:!0,temporary:!0,isOnlyOnField:!0},zc={name:"SonicBarrier",type:"System",text:"æ³¢å‹•éŸ³å£",emoji:"",sticky:!0,temporary:!0,isOnlyOnField:!0},Vc={name:"SonicVerse",type:"System",text:"æ³¢å‹•è–å¥ï¼ˆé©ç”¨æ¸ˆï¼‰",emoji:"",sticky:!0,temporary:!0,isOnlyOnField:!0},Wc={name:"IntoTheVoid",type:"System",text:"ç„¡ã®ç…‰ç„",emoji:"",sticky:!0,temporary:!0,isOnlyOnField:!1},Qc={name:"GoldSarcophagus",type:"System",text:"å°å°ã®é»„é‡‘æ«ƒ",emoji:"",sticky:!0,temporary:!1,isOnlyOnField:!1},Xc={SpellCounter:Rc,KaijuCounter:Hc,NamelessCounter:Zc,IceCounter:Gc,Curfew:$c,SelfDestruction:Uc,CycleFlip:jc,SonicBarrier:zc,SonicVerse:Vc,IntoTheVoid:Wc,GoldSarcophagus:Qc},Dt=Xc,Nr=Object.values(Dt).filter(t=>t.type==="Actual").filter(t=>t.sticky||t.temporary||!t.isOnlyOnField);if(Nr.length)throw new Error(`ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼ã®è¨­å®šèª¤ã‚Šã€‚${Nr.map(t=>t.name).join(", ")}`);const ng=t=>Dt[t].emoji;class Kc{constructor(e){c(this,"dic");c(this,"temporaryCounterNames");c(this,"entity");c(this,"add",(e,i=1,a)=>{this.dic[e]=[...this.dic[e]??[],...Array(i).fill(a)];const r=this.entity.status.maxCounterQty[e]??0;return r&&(this.dic[e]=this.dic[e].slice(0,r)),this.dic[e]});c(this,"setQty",(e,i=1,a)=>(this.dic[e]=[...Array(i).fill(a)],this.dic[e]));c(this,"remove",(e,i=1,a)=>{const r=this.dic[e].length;if(r===void 0)return[];if(i>=r)return delete this.dic[e],[];if(a){const n=this.dic[e].filter(l=>l===a),s=this.dic[e].filter(l=>l!==a);this.dic[e]=[...n.slice(i),...s]}else this.dic[e]=this.dic[e].slice(i);return this.dic[e]});c(this,"removeAll",(e,i)=>{if(i){const r=this.dic[e].filter(n=>n===i).length;return this.dic[e]=this.dic[e].filter(n=>n!==i),r}const a=this.dic[e];return delete this.dic[e],a});c(this,"getQty",(e,i)=>this.dic[e]?i?this.dic[e].filter(a=>a===i).length:this.dic[e].length??0:0);c(this,"setSelfDestructionFlg",e=>{this.add("SelfDestruction",1,e)});c(this,"getSelfDestructionFlg",e=>this.getQty("SelfDestruction",e)>0);c(this,"setCurfewFlg",e=>{this.add("Curfew",1,e)});c(this,"getCurfewFlg",e=>this.getQty("Curfew",e)>0);c(this,"incrementActionCountPerTurn",e=>{this.temporaryCounterNames.push(e.title),this.incrementActionCount(e)});c(this,"incrementActionCount",e=>{this.dic[e.title]=[e.entity,...this.dic[e.title]??[]]});c(this,"getActionCount",e=>this.dic[e.title]?this.dic[e.title].filter(i=>i===e.entity).length:0);c(this,"corpseDisposal",()=>{this.temporaryCounterNames.forEach(e=>delete this.dic[e]),this.temporaryCounterNames.reset(),Object.values(Dt).filter(e=>e.temporary).forEach(e=>delete this.dic[e.name])});c(this,"removeAllActualCounters",()=>{Object.values(Dt).filter(e=>e.type==="Actual").forEach(e=>delete this.dic[e.name])});c(this,"removeAllWhenfaceDown",()=>{this.temporaryCounterNames.forEach(e=>delete this.dic[e]),this.temporaryCounterNames.reset(),Object.values(Dt).filter(e=>!e.sticky).forEach(e=>delete this.dic[e.name])});c(this,"clear",()=>{this.temporaryCounterNames.forEach(e=>delete this.dic[e]),this.temporaryCounterNames.reset(),Object.values(Dt).filter(e=>e.isOnlyOnField).forEach(e=>delete this.dic[e.name])});this.dic={},this.temporaryCounterNames=[],this.entity=e}}class Yc extends di{constructor(){super(...arguments);c(this,"afterDistributeAll",i=>i.field.getAllEntities().map(a=>a.statusOperatorBundle).every(a=>a.calcStatus()))}}class Jc extends fi{constructor(){super(...arguments);c(this,"calcStatus",()=>{const i=this.entity.isEffective;return this.entity.resetStatus(),this.entity.status=this._operators.filter(a=>a.isSpawnedBy.isEffective||!a.isContinuous).reduce((a,r)=>({...a,...r.statusCalculator(this.entity,r,a)}),this.entity.status),this.entity.isEffective===i});c(this,"beforePush",()=>{});c(this,"afterPush",()=>{this.calcStatus()})}}class oe extends Ct{constructor(i){super(i);c(this,"beforeRemove",()=>{});c(this,"statusCalculator");this.statusCalculator=i.statusCalculator}}const Yt=class Yt extends ri{constructor(){super(...arguments);c(this,"isApplicableTo",(...i)=>{const a=this.entity.counterHolder.getActionCount(this);return this.isOnlyNTimesPerTurnIfFaceup>0&&a>=this.isOnlyNTimesPerTurnIfFaceup?this.entity.counterHolder.incrementActionCountPerTurn(this):this.isOnlyNTimesIfFaceup>0&&a>=this.isOnlyNTimesIfFaceup&&this.entity.counterHolder.incrementActionCount(this),this.definition.isApplicableTo(this,...i)});c(this,"substitute",async(i,a,r)=>{const n=await this.definition.substitute(this,i,a,r);return this.isOnlyNTimesPerTurnIfFaceup>0?this.entity.counterHolder.incrementActionCountPerTurn(this):this.isOnlyNTimesIfFaceup>0&&this.entity.counterHolder.incrementActionCount(this),n});c(this,"getClone",()=>new Yt(this.seq,this.entity,this.definition))}get definition(){return super.definition}};c(Yt,"createNew",(i,a)=>new Yt("AutoSeq",i,a));let Ba=Yt;class Ic extends di{constructor(){super(...arguments);c(this,"afterDistributeAll",()=>!0)}}class eu extends fi{constructor(){super(...arguments);c(this,"beforePush",()=>{});c(this,"afterPush",()=>{});c(this,"filter",(i,a,r,n,s,l,o)=>this.effectiveOperators.filter(u=>u.summonKinds.includes(a)).reduce((u,d)=>({...u,...d.filter(this.entity,i,s.summoner,[a,...r],n,s.monster,l,u.posList,u.cells,o)}),s))}}class tu extends Ct{constructor(i){super(i);c(this,"beforeRemove",()=>{});c(this,"summonKinds");c(this,"filter");this.summonKinds=i.summonKinds,this.filter=(...a)=>i.filter(this,...a)}}const L=class L{constructor(){}};c(L,"_tryMarkForDestroy",(e,i)=>{if(e.info.isDying||e.kind==="XyzMaterial"||!e.isOnFieldStrictly&&e.cell.cellType!=="Deck"&&e.cell.cellType!=="Hand")return!1;const a=i.action.playType==="Battle"?"Battle":"Effect",r=a==="Battle"&&i.action.entity===e?i.selectedEntities[0]:i.action.entity;return e.info.isDying=e.validateDestroy(a,i.activator,r,i.action),e.info.isDying&&(e.info.causeOfDeath=[a,"Destroy"],e.info.isKilledBy=r,e.info.isKilledByWhom=i.activator,a==="Battle"&&(e.info.isKilledByWhom=r.controller)),e.info.isDying}),c(L,"excavateFromDeck",async(e,i,a,r)=>{const n=await L.excavateManyFromDeck(e,1,i,a,r);return n.length?n[0]:void 0}),c(L,"excavateManyFromDeck",async(e,i,a,r,n)=>{const s=e.getDeckCell().cardEntities.slice(0,i);return await Z.moveMany(s.map(l=>({entity:l,to:l.cell,kind:l.kind,face:"FaceUp",orientation:l.orientation,pos:"Fix",movedAs:["Excavate",...a],movedBy:r,actionOwner:n,chooser:void 0}))),s}),c(L,"releaseManyForTheSameReason",(e,i,a,r)=>e.length?(i.includes("Cost")&&r.writeInfoLog(`${e.map(n=>n.toString()).join(" ")}ã‚’ãƒªãƒªãƒ¼ã‚¹ã—â€•â€•ã€`),L.bringManyToSameCellForTheSameReason("Graveyard","Top",e,"FaceUp","Vertical",["Release",...i],a,r)):Promise.resolve([])),c(L,"sendManyToGraveyardForTheSameReason",(e,i,a,r)=>e.length?(r&&i.includes("Cost")&&(i.includes("FusionMaterial")?r.writeInfoLog(`${e.map(n=>n.toString()).join(" ")}ã‚’èžåˆç´ æã¨ã—â€•â€•ã€`):i.includes("SynchroMaterial")?r.writeInfoLog(`${e.map(n=>n.toString()).join(" ")}ã‚’ã‚·ãƒ³ã‚¯ãƒ­ã¨ç´ æã—â€•â€•ã€`):i.includes("LinkMaterial")?r.writeInfoLog(`${e.map(n=>n.toString()).join(" ")}ã‚’ãƒªãƒ³ã‚¯ãƒžãƒ¼ã‚«ãƒ¼ã«ã‚»ãƒƒãƒ†ã‚£ãƒ³ã‚°â€•â€•ã€`):r.writeInfoLog(`${e.map(n=>n.toString()).join(" ")}ã‚’å¢“åœ°ã«é€ã‚Šâ€•â€•ã€`)),L.bringManyToSameCellForTheSameReason("Graveyard","Top",e,"FaceUp","Vertical",i,a,r)):Promise.resolve([])),c(L,"addManyToHand",(e,i,a,r)=>e.length?L.bringManyToSameCellForTheSameReason("Hand","Bottom",e,"FaceDown","Vertical",i,a,r):Promise.resolve([])),c(L,"discardManyForTheSameReason",(e,i,a,r)=>e.length?(r&&i.includes("Cost")&&r.writeInfoLog(`${e.map(n=>n.toString()).join(" ")}ã‚’æ‰‹æœ­ã‹ã‚‰æ¨ã¦â€•â€•ã€`),L.bringManyToSameCellForTheSameReason("Graveyard","Top",e,"FaceUp","Vertical",["Discard",...i],a,r)):Promise.resolve([])),c(L,"banishManyForTheSameReason",(e,i,a,r)=>e.length?(r&&i.includes("Cost")&&r.writeInfoLog(`${e.map(n=>n.toString()).join(" ")}ã‚’ã‚²ãƒ¼ãƒ ã‹ã‚‰é™¤å¤–ã—â€•â€•ã€`),L.bringManyToSameCellForTheSameReason("Banished","Top",e,"FaceUp","Vertical",i,a,r)):Promise.resolve([])),c(L,"returnManyToDeckForTheSameReason",(e,i,a,r,n)=>i.length?(n&&a.includes("Cost")&&n.writeInfoLog(`${i.map(s=>s.toString()).join(" ")}ã‚’ãƒ‡ãƒƒã‚­ã«æˆ»ã—â€•â€•ã€`),L.bringManyToSameCellForTheSameReason("Deck",e,i,"FaceDown","Vertical",a,r,n)):Promise.resolve([])),c(L,"returnManyToHandForTheSameReason",(e,i,a,r)=>e.length?(r&&i.includes("Cost")&&r.writeInfoLog(`${e.map(n=>n.toString()).join(" ")}ã‚’æ‰‹æœ­ã«æˆ»ã—â€•â€•ã€`),L.bringManyToSameCellForTheSameReason("Hand","Bottom",e,"FaceDown","Vertical",i,a,r)):Promise.resolve([])),c(L,"convertManyToXyzMaterials",(e,i,a,r)=>e.length?(r&&i.includes("Cost")&&r.writeInfoLog(`${e.map(n=>n.toString()).join(" ")}ã«ã‚ˆã£ã¦ã€ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚’æ§‹ç¯‰â€•â€•ã€`),Z.moveMany(e.map(n=>({entity:n,to:n.cell,kind:"XyzMaterial",face:"FaceUp",orientation:"Vertical",pos:"Top",movedAs:i,movedBy:a,actionOwner:r,chooser:r})))):Promise.resolve()),c(L,"moveToXyzOwner",async(e,i,a,r,n,s)=>{a.length&&(await Z.moveMany(a.map(l=>({entity:l,to:e,kind:"XyzMaterial",face:"FaceUp",orientation:"Vertical",pos:"Top",movedAs:r,movedBy:n,actionOwner:s,chooser:s}))),a.forEach(l=>l.info.xyzOwner=i))}),c(L,"banishMany",(e,i)=>Z.bringManyToSameCell("Banished","Top",e.map(a=>({...a,face:"FaceUp",orientation:"Vertical"})),i)),c(L,"bringManyToSameCellForTheSameReason",(e,i,a,r,n,s,l,o)=>Z.bringManyToSameCell(e,i,a.map(u=>({entity:u,face:r,orientation:n,movedAs:s,movedBy:l,activator:o})))),c(L,"tryDestroy",async(e,i)=>{const a=await L.tryMarkForDestroy(e,i);return await L.waitCorpseDisposal(i.activator.duel),a}),c(L,"waitCorpseDisposal",(e,i={})=>{const a=i.excludedList??[];return Z.sendManyToGraveyard(e.field.getDyingCardsOnField().filter(r=>r.info.isDying).filter(r=>!a.includes(r)).map(r=>({entity:r,movedAs:r.info.causeOfDeath??[],movedBy:r.info.isKilledBy,activator:r.info.isKilledByWhom})))}),c(L,"tryMarkForDestroy",async(e,i)=>{let a=e.filter(l=>L._tryMarkForDestroy(l,i));if(!a.length)return[];const r=i.action.playType==="Battle"?"Battle":"Effect";(await Promise.all(e[0].field.getAllEntities().flatMap(l=>l.substituteEffects.filter(o=>o.isMandatory).filter(o=>o.executableCells.includes(l.cell.cellType)).filter(o=>o.isApplicableTo(r,e,i).length).flatMap(o=>o.substitute(r,e,i))))).flatMap(l=>l).forEach(l=>{l.resetCauseOfDeath()}),a=a.filter(l=>l.info.isDying);let n=e[0].field.getAllEntities().flatMap(l=>l.substituteEffects.filter(o=>!o.isMandatory).filter(o=>o.executableCells.includes(l.cell.cellType)).filter(o=>o.isApplicableTo(r,e,i).length).map(o=>({chooser:l.owner,effect:o,sacrifice:l})));for(const l of n.map(o=>o.sacrifice.controller).getDistinct()){const o=n.filter(d=>d.sacrifice.controller===l),u=await l.duel.view.waitSelectAction(l,o.map(d=>({entity:d.sacrifice,title:d.effect.title,origin:d.effect})),"èº«ä»£ã‚ã‚ŠåŠ¹æžœã‚’é©ç”¨ã™ã‚‹ï¼Ÿ",!0);if(u){if((await u.substitute(r,a,i)).forEach(d=>{d.resetCauseOfDeath()}),a=a.filter(d=>d.info.isDying),!a.length)return[];n=n.filter(d=>d.effect.isApplicableTo(r,e,i).length)}}const s=a.filter(l=>l.info.isDying);return s.forEach(l=>l.duel.log.info(`${l.toString()}ã‚’${r==="Battle"?"æˆ¦é—˜":r==="Effect"?"åŠ¹æžœ":"ãƒ«ãƒ¼ãƒ«"}ç ´å£Šã€‚`,l.info.isKilledByWhom)),s}),c(L,"tryBanish",async(e,i,a)=>{const r=i.filter(n=>n.canBeBanished(e,a.activator,a.action.entity,a.action));return await L.banishManyForTheSameReason(r,["Effect"],a.action.entity,a.activator),r.filter(n=>n.cell.cellType==="Banished").filter(n=>n.moveLog.latestRecord.movedBy===a.action.entity)}),c(L,"negateSummonMany",(e,i)=>{const a=i.duel.field.getPendingMonstersOnField();return a.forEach(r=>{r.info.summonKinds=[],r.info.materials=[],r.moveLog.negateSummon(e,i)}),i.writeInfoLog(`${a.map(r=>r.toString()).join(" ")}.ã®å¬å–šã¯ç„¡åŠ¹ã«ã•ã‚ŒãŸã€‚`),a}),c(L,"drawAtSameTime",async(e,i,a,r)=>{const n=[],s=[],l=[e.draw(a,i,e),e.getOpponentPlayer().draw(r,i,e)].map(o=>o.catch(u=>{u instanceof re?u.winner&&n.push(u.winner):s.push(u)}));if(await Promise.all(l),s.length)throw new S("ãƒ‰ãƒ­ãƒ¼å‡¦ç†ã§æƒ³å®šã•ã‚Œãªã„ä¾‹å¤–ãŒç™ºç”Ÿã—ãŸã€‚",e,a,r,i,...s);if(n.length!==0)throw n.length===1?new re(n[0],`${n[0].getOpponentPlayer().name}ãŒãƒ‡ãƒƒã‚­ã‹ã‚‰ãƒ‰ãƒ­ãƒ¼ã§ããªã‹ã£ãŸã€‚`):new re(void 0,"ãŠäº’ã„ã«ãƒ‡ãƒƒã‚­ã‹ã‚‰ã‚«ãƒ¼ãƒ‰ã‚’ãƒ‰ãƒ­ãƒ¼ã§ããªã‹ã£ãŸã€‚")});let _=L;class iu extends di{constructor(){super(...arguments);c(this,"afterDistributeAll",()=>!0)}}class au extends fi{constructor(){super(...arguments);c(this,"beforePush",()=>{});c(this,"afterPush",()=>{})}}class Un extends Ct{constructor(i){super(i);c(this,"beforeRemove",()=>{});c(this,"calcType");c(this,"filter");this.calcType=i.calcType,this.filter=(...a)=>i.filter(this,...a)}}const Sa=(t,e,...i)=>t.filter(a=>e.includes(a.calcType)).reduce((a,r)=>({...a,...r.filter(...i)}),{}),jn=(...t)=>{const[e,i,a,r,n,s,l]=t,o=[a.entity,r,n].filter(f=>!!f).flatMap(f=>f.damageFilterBundle.effectiveOperators);let u=Sa(o,["double_typeA","eachOther_typeA","eachOther_typeB","asEffectDamage"],...t);const d={point:e,damageToOpponent1:0,damageToOpponent2:0,damageType:s};return u.double_typeA&&(d.point*=2),u.asEffectDamage&&(d.damageType="EffectDamage"),u={...Sa(o,["heal","zero_typeA","half","double_typeB","fix"],d.point,i,a,r,n,d.damageType,l),...u},u.fix!==void 0?d.point=u.fix:u.zero_typeA?d.point=0:(u.half&&(d.point=Math.round(d.point/2)),u.double_typeA&&(d.point*=2)),u={...Sa(o,["zero_typeB"],d.point,i,a,r,n,d.damageType,l),...u},u.zero_typeB&&(d.point=0),u.heal?d.damageType="Heal":(u.eachOther_typeA&&(d.damageToOpponent1=d.point),u.eachOther_typeB&&(d.damageToOpponent2=d.point,u.eachOther_typeB==="Substitude"&&(d.point=0))),d},ru=(t,e,i)=>jn(t,e.activator,i,e.action.entity,void 0,"EffectDamage",e.action),nu=(t,e,i,a,r,n)=>jn(t,e,i,a,r.entityType==="Duelist"?void 0:r,"BattleDamage",n),Gi=t=>new Promise(e=>setTimeout(e,t)),zn=()=>{let t=()=>{},e=()=>{};return{promise:new Promise((a,r)=>{t=a,e=r}),resolve:t,reject:e}},Xi=class Xi extends ri{constructor(i,a,r){super(i,a,{...r,playType:"ContinuousEffect",isMandatory:!1,executableDuelistTypes:["Controller"]});c(this,"toString",()=>this.title);c(this,"toFullString",()=>`${this.entity.toString()}ã®${this.toString()}`);c(this,"execute",async(i,a)=>{if(!this.canExecute())return;const r=await this.definition.execute(this,i,a);return r==="RemoveMe"&&this.entity.immediatelyActions.reset(...this.entity.immediatelyActions.filter(n=>n!==this)),r})}get definition(){return super.definition}get playType(){return this.definition.playType}};c(Xi,"createNew",(i,a)=>new Xi("AutoSeq",i,a));let La=Xi;const sr=["FaceUp","FaceDown"],Vn=["FusionSummon","SynchroSummon","XyzSummon","PendulumSummon","LinkSummon","RitualSummon","FlipSummon"],su={FusionSummon:"èžåˆå¬å–š",SynchroSummon:"ã‚·ãƒ³ã‚¯ãƒ­å¬å–š",XyzSummon:"ã‚¨ã‚¯ã‚·ãƒ¼ã‚ºå¬å–š",PendulumSummon:"ãƒšãƒ³ãƒ‡ãƒ¥ãƒ©ãƒ å¬å–š",LinkSummon:"ãƒªãƒ³ã‚¯å¬å–š",RitualSummon:"å„€å¼å¬å–š",FlipSummon:"åè»¢å¬å–š"},Wn=[...Vn,"AdvanceSummon","NormalSummon","SpecialSummon"];[...Wn];const lu=t=>t+"Summon",Br=["Card","Token"],ou=["Duelist","Squatter"],cu=(t,e)=>Nn(t.origin,e.origin),z=class z{constructor(e,i,a,r,n,s,l){c(this,"seq");c(this,"origin");c(this,"entityType");c(this,"summonFilterBundle");c(this,"procFilterBundle");c(this,"numericOprsBundle");c(this,"statusOperatorBundle");c(this,"damageFilterBundle");c(this,"moveLog");c(this,"counterHolder");c(this,"parent");c(this,"face");c(this,"orientation");c(this,"owner");c(this,"cell");c(this,"_status");c(this,"_numericStatus");c(this,"_info");c(this,"actions",[]);c(this,"immediatelyActions",[]);c(this,"continuousEffects",[]);c(this,"substituteEffects",[]);c(this,"canBeReleased",(e,i,a,r)=>!this.isInTrashCell&&this.procFilterBundle.filter(a,e,i,r,[this]));c(this,"canBeSentToGraveyard",(e,i,a,r)=>!this.status.willBeBanished&&!this.status.willReturnToDeck&&this.procFilterBundle.filter([a],e,i,r,[this]));c(this,"_exists",!0);c(this,"validateFusionMaterials",e=>this.definition.fusionMaterialInfos?this.definition.validateFusionMaterials?this.definition.validateFusionMaterials(e):!0:!1);c(this,"definition");c(this,"toString",()=>{let e=this.nm;return this.nm!==this.origin.name&&(e=`${e}(${this.origin.name})`),this.entityType==="Card"?`ã€Š${e}ã€‹`:e});c(this,"onUsedAsMaterial",(e,i)=>{this.definition.onUsedAsMaterial&&this.definition.onUsedAsMaterial(this,e,i)});c(this,"setBattlePosition",async(e,i,a,r)=>{let n=`è¡¨ç¤ºå½¢å¼ã®å¤‰æ›´ï¼š${this.toString()}ï¼ˆ${this.battlePositionName}â‡’${Ei[e]}ï¼‰`;const s=[...i];this.battlePosition==="Set"&&(s.push("Flip"),i.includes("Rule")&&(this.info.isPending=!0,n=`${this.toString()}ã‚’åè»¢å¬å–š`,this.info.summonKinds.push("FlipSummon"),s.push("FlipSummon"),s.push("AttackSummon"))),this.duel.log.info(n,r),await this.moveAlone(this.cell,"Monster",e==="Set"?"FaceDown":"FaceUp",e==="Attack"?"Vertical":"Horizontal","Top",s,a,r,r)});c(this,"activateAsPendulumScale",(e,i,a,r)=>this.moveAlone(e,"Spell","FaceUp","Vertical","Top",["CardActivation",...i],a,r,r));c(this,"setNonFieldMonsterPosition",async(e,i,a,r,n)=>{this.moveAlone(this.cell,e,i==="FaceUp"?"FaceUp":"FaceDown","Vertical","Top",a,r,n,n)});c(this,"setAsSpellTrap",async(e,i,a,r,n)=>{await this.moveAlone(e,i,"FaceDown","Vertical","Top",[...a,"SpellTrapSet"],r,n,n)});c(this,"activateSpellTrapFromHand",async(e,i,a,r,n)=>{await this.moveAlone(e,i,"FaceUp","Vertical","Top",[...a,"CardActivation"],r,n,n)});c(this,"putDirectly",async(e,i,a,r,n)=>{await this.moveAlone(e,i,"FaceUp","Vertical","Top",[...a,"PutDirectly"],r,n,n)});c(this,"activateSpellTrapOnField",async(e,i,a,r)=>{await this.moveAlone(this.cell,e,"FaceUp","Vertical","Top",[...i,"CardActivation"],a,r,r)});c(this,"draw",async(e,i,a)=>await this.addToHand([...e,"Draw"],i,a));c(this,"addToHand",async(e,i,a)=>await this.moveAlone(this.owner.getHandCell(),this.origin.kind,"FaceDown","Vertical","Bottom",[...e],i,a,a));c(this,"summon",(e,i,a,r,n,s,l)=>z.summonMany([{monster:this,dest:e,summoner:l??s,pos:i}],a,r,n,s));c(this,"moveForcibly",async(e,i,a,r,n,s,l)=>{await this.moveAlone(e,this.origin.kind,i,a,r,["Rule",...n],s,l,l)});c(this,"excavate",async(e,i,a)=>this.moveAlone(this.cell,this.kind,"FaceUp",this.orientation,"Fix",["Excavate",...e],i,a,void 0));c(this,"moveAlone",async(e,i,a,r,n,s,l,o,u)=>(await z.moveMany([{entity:this,to:e,kind:i,face:a,orientation:r,pos:n,movedAs:s,movedBy:l,actionOwner:o,chooser:u}],void 0),this.cell));c(this,"determine",async()=>{this.info.isPending&&(this.info.isPending=!1,this.moveLog.finalize(),this.continuousEffects.forEach(e=>e.updateState()),await this.fireImmediatelyActions(),await _.waitCorpseDisposal(this.duel))});c(this,"_move",async e=>{var n,s;if(!e.to)throw new Error("illegal argument: to");const i={cell:this.cell,status:this.status,info:this.info};this.face=e.face,this.orientation=e.orientation;let a=!1,r=e.actionOwner;if(!r&&e.movedAs.includes("LostDestinyBond")){console.log(this.toString(),(n=this.info.equipedBy)==null?void 0:n.toString(),(s=this.info.xyzOwner)==null?void 0:s.toString());const l=this.info.equipedBy??this.info.xyzOwner;l&&(r=l.moveLog.latestRecord.actionOwner)}return e.to!==this.cell&&(this.duel.log.pushMoveLog(r,this,this.cell,e.to),this.cell.cellType==="WaitingRoom"?a=!0:e.to.cellType==="WaitingRoom"?(this._exists=!1,await this.duel.view.waitTokenAnimation()):this.field.duel.clock.turn&&await this.field.duel.view.waitAnimation({entity:this,to:e.to,index:e.pos,count:0})),(e.to!==this.cell||e.pos==="Random")&&(this.cell.releaseEntities(this),this.cell.isPlayFieldCell&&!e.to.isPlayFieldCell&&(this.counterHolder.clear(),this.resetCauseOfDeath()),this.cell.isMonsterZoneLikeCell&&!e.to.isMonsterZoneLikeCell||e.kind!=="Monster"?(this.resetNumericStatus(),this.info.isEffectiveIn.push(...Se),this.info.equipEntities.filter(l=>l.isOnFieldAsSpellTrapStrictly).forEach(l=>{l.info.isDying=!0,l.info.causeOfDeath=["Rule","Destroy","LostEquipOwner","LostDestinyBond"],this.controller.writeInfoLog(`è£…å‚™å¯¾è±¡${this.toString()}ä¸åœ¨ã«ã‚ˆã‚Š${l.toString()}ã¯ç ´å£Šã•ã‚ŒãŸã€‚`)}),this.info.equipEntities=[],this.kind!=="XyzMaterial"&&this.cell.xyzMaterials.forEach(l=>{l.info.isDying=!0,l.info.causeOfDeath=["LostXyzOwner","LostDestinyBond"],this.controller.writeInfoLog(`${this.toString()}ä¸åœ¨ã«ã‚ˆã‚Šã€XYZç´ æ${l.toString()}ã¯å¢“åœ°ã«é€ã‚‰ã‚ŒãŸã€‚`)})):this.cell.cellType==="SpellAndTrapZone"&&e.to.cellType!=="SpellAndTrapZone"&&(this.info.equipedBy=void 0,this.info.equipedAs=void 0,this.info.isEffectiveIn.push(...Se)),e.to.acceptEntities(this,e.pos),a&&(await Gi(1),this._exists=!0,await this.duel.view.waitTokenAnimation()),(e.to===this.isBelongTo||e.to.cellType==="Hand"||e.to.cellType==="Banished"&&this.face==="FaceDown")&&(this.counterHolder.clear(),this.resetInfoAll(),this.resetStatusAll())),(this.isOnFieldStrictly&&this.face==="FaceDown"||e.kind==="XyzMaterial")&&(this.info.equipEntities.forEach(l=>{l.info.isDying=!0,l.info.causeOfDeath=["Rule","Destroy","LostEquipOwner","LostDestinyBond"],this.controller.writeInfoLog(`è£…å‚™å¯¾è±¡${this.toString()}ä¸åœ¨ã«ã‚ˆã‚Š${l.toString()}ã¯ç ´å£Šã•ã‚ŒãŸã€‚`)}),this.counterHolder.removeAllWhenfaceDown(),this.info.materials=[],this.status={...this._status,isEffective:!0},this.info.isEffectiveIn=[...Me],this.resetNumericStatus(),this.info.isSettingSickness=this.kind==="Trap"||this.status.spellCategory==="QuickPlay"),this._info.kind=e.kind,this.moveLog.push(e.kind,e.movedAs,e.movedBy,e.actionOwner,e.chooser),await this.fireImmediatelyActions(i),e.to});c(this,"fireImmediatelyActions",async e=>{for(const i of[this,...this.field.getCardsOnFieldStrictly()].getDistinct().filter(a=>a.immediatelyActions.length).toSorted((a,r)=>a.hadArrivedToFieldAt().totalProcSeq-r.hadArrivedToFieldAt().totalProcSeq).flatMap(a=>a.immediatelyActions))await i.execute(this,e)});c(this,"initForTurn",()=>{this.info.isSettingSickness=!1,this.info.attackDeclareCount=0,this.info.battlePotisionChangeCount=0,this.counterHolder.corpseDisposal()});c(this,"resetInfoIfLeavesTheField",()=>{this._info={...this._info,isDying:!1,isPending:!1,causeOfDeath:[],isKilledBy:void 0,isKilledByWhom:void 0,effectTargets:{},attackDeclareCount:0,battlePotisionChangeCount:0,materials:[],equipedBy:void 0,equipedAs:void 0,equipEntities:[]},this._info.isEffectiveIn.push(...Se),this._info.isEffectiveIn.distinct()});c(this,"resetInfoAll",()=>{var e;this._info={kind:this.origin.kind,isDying:!1,isPending:!1,isEffectiveIn:[...Me],causeOfDeath:[],isKilledBy:void 0,isKilledByWhom:void 0,isVanished:!1,isRebornable:((e=this.origin.monsterCategories)==null?void 0:e.union(Pn).length)===0,isSettingSickness:!1,summonKinds:[],materials:[],effectTargets:{},attackDeclareCount:0,battlePotisionChangeCount:0,equipedBy:void 0,equipedAs:void 0,validateEquipOwner:()=>!0,equipEntities:[],xyzOwner:void 0,battleLog:[]},this.counterHolder.clear()});c(this,"resetNumericStatus",()=>{const e=Fn.reduce((i,a)=>(i[a]=this.origin[a],i),{});this._numericStatus={origin:{...e},wip:{...e},calculated:{...e}}});c(this,"resetStatus",()=>{this.status={...this.origin,canBattlePositionChange:!0,canAttack:!0,canDirectAttack:!1,canActivateEffect:!0,isEffective:!0,isFaithful:!1,isSelectableForAttack:!0,allowHandSynchro:!1,allowHandLink:!1,willBeBanished:!1,willReturnToDeck:void 0,fusionSubstitute:!1,maxCounterQty:{},piercingTo:[]}});c(this,"resetStatusAll",()=>{this.resetNumericStatus(),this.resetStatus()});c(this,"resetCauseOfDeath",()=>{this.info.isDying=!1,this.info.causeOfDeath=[],this.info.isKilledBy=void 0,this.info.isKilledByWhom=void 0});this.seq=z.nextEntitySeq++,this.counterHolder=new Kc(this),this.definition=r,this.owner=e,this.cell=i,this.entityType=a,this.parent=l,this.origin=r.staticInfo,this._status=JSON.parse(JSON.stringify(r.staticInfo)),this._numericStatus=JSON.parse(JSON.stringify(r.staticInfo)),this.resetStatusAll(),this._info={kind:this.origin.kind,isEffectiveIn:[...Me],attackDeclareCount:0,battlePotisionChangeCount:0,isDying:!1,isPending:!1,causeOfDeath:[],isKilledBy:void 0,isKilledByWhom:void 0,isVanished:!1,isRebornable:!0,isSettingSickness:!1,summonKinds:[],materials:[],effectTargets:{},equipedBy:void 0,equipedAs:void 0,validateEquipOwner:()=>!0,equipEntities:[],xyzOwner:void 0,battleLog:[]},this.resetInfoAll(),this.face=n,this.orientation=s,this.summonFilterBundle=new eu(i.field.summonFilterPool,this),this.procFilterBundle=new Ec(i.field.procFilterPool,this),this.numericOprsBundle=new kc(i.field.numericStateOperatorPool,this),this.statusOperatorBundle=new Jc(i.field.statusOperatorPool,this),this.damageFilterBundle=new au(i.field.damageFilterPool,this),this._exists=this.entityType==="Card",i.acceptEntities(this,"Top"),this.moveLog=new qc(this),this.moveLog.pushForRuleAction(["Spawn"]);let o=[];o=r.continuousEffects??[],this.substituteEffects.push(...(r.substituteEffects??[]).map(u=>Ba.createNew(this,u))),this.origin.kind==="Monster"&&this.entityType==="Card"&&r.summonFilter&&this.summonFilterBundle.push(new tu({title:"default",validateAlive:()=>!0,isContinuous:!0,isSpawnedBy:this,actionAttr:{},isApplicableTo:()=>!0,summonKinds:Wn,filter:r.summonFilter})),r.defaultStatus&&this.statusOperatorBundle.push(new oe({title:"default",validateAlive:()=>!0,isContinuous:!0,isSpawnedBy:this,actionAttr:{},isApplicableTo:()=>!0,statusCalculator:()=>r.defaultStatus??{}})),this.actions.push(...r.actions.map(u=>St.createNew(this,u))),this.immediatelyActions.push(...(r.immediatelyActions??[]).map(u=>La.createNew(this,u))),this.continuousEffects.push(...o.map(u=>Na.createNew(this,u)))}get isUnderControl(){return this.face==="FaceUp"||Bn.every(e=>e!==this.cell.cellType)}get controller(){return this.cell.owner??this.owner}get field(){return this.owner.duel.field}get duel(){return this.owner.duel.field.duel}get actionLogRecords(){return this.duel.chainBlockLog.records.filter(e=>e.chainBlockInfo.action.entity===this)}get status(){return this._status}set status(e){this._status={...e}}get numericStatus(){return this._numericStatus}get info(){return this._info}get kind(){return this.info.kind}get nm(){return this.status.name}get atk(){return this._numericStatus.calculated.attack}get def(){return this._numericStatus.calculated.defense}get lvl(){return this._numericStatus.calculated.level}get rank(){return this._numericStatus.calculated.rank}get attr(){return this.status.attributes??[]}get types(){return this.status.types??[]}get psL(){return this._numericStatus.calculated.pendulumScaleL}get psR(){return this._numericStatus.calculated.pendulumScaleR}get linkArrows(){let e=(this.origin.linkArrowKeys??[]).map(i=>On[i].linkArrow);return this.controller.seat==="Above"&&(e=e.map(i=>({offsetColumn:i.offsetColumn*-1,offsetRow:i.offsetRow*-1}))),e}get linkArrowDests(){var e;return(e=this.origin.monsterCategories)!=null&&e.includes("Link")?this.isOnFieldAsMonsterStrictly?this.linkArrows.map(i=>[this.cell.row+i.offsetRow,this.cell.column+i.offsetColumn]).map(([i,a])=>this.field.cells[i][a]).filter(i=>i.isMonsterZoneLikeCell):[]:[]}get linkedEntities(){return this.isOnFieldAsMonsterStrictly?[...this.linkArrowDests.map(e=>e.cardEntities[0]).map(e=>e),...this.cell.linkArrowSources].getDistinct():[]}get coLinkedEntities(){var e;return this.isOnFieldAsMonsterStrictly?(e=this.origin.monsterCategories)!=null&&e.includes("Link")?this.linkArrowDests.map(i=>i.cardEntities[0]).filter(i=>i).union(this.cell.linkArrowSources):[]:[]}get isEffective(){return this.status.isEffective&&this.info.isEffectiveIn.includes(this.cell.cellType)}get canBeSet(){var e;return this.entityType==="Card"&&!((e=this.status.monsterCategories)!=null&&e.includes("Link"))}get isEffectiveWeakly(){return this.status.isEffective}get battlePosition(){if(this.isOnFieldStrictly&&this.kind==="Monster")return this.orientation==="Vertical"?"Attack":this.face==="FaceUp"?"Defense":"Set"}get battlePositionName(){const e=this.battlePosition;if(e)return Ei[e]}get wasMovedAtCurrentProc(){return this.field.duel.clock.totalProcSeq===this.moveLog.latestRecord.movedAt.totalProcSeq}get wasMovedAtPreviousProc(){return this.field.duel.clock.totalProcSeq===this.moveLog.latestRecord.movedAt.totalProcSeq+1}get wasMovedAtCurrentTurn(){return this.field.duel.clock.isSameTurn(this.moveLog.latestRecord.movedAt)}get wasMovedAtCurrentChain(){return this.field.duel.clock.isSameChain(this.moveLog.latestRecord.movedAt)}get wasMovedAtPreviousChain(){return this.field.duel.clock.isPreviousChain(this.moveLog.latestRecord.movedAt)}get wasMovedAtPreviousTurn(){return this.field.duel.clock.isPreviousTurn(this.moveLog.latestRecord.movedAt)}get wasMovedFrom(){return this.moveLog.previousPlaceRecord.cell}get isPendulumScale(){var e;return!(!((e=this.origin.monsterCategories)!=null&&e.includes("Pendulum"))||!this.isOnField||!this.cell.isSpellTrapZoneLikeCell||this.status.spellCategory)}get isOnField(){return this.cell.isPlayFieldCell}get isOnFieldStrictly(){return this.isOnField&&!this.info.isPending&&!this.info.isDying&&this.kind!=="XyzMaterial"}get isOnFieldAsMonsterStrictly(){return this.cell.isMonsterZoneLikeCell&&this.isOnFieldStrictly}get isMonster(){return this.isOnFieldAsMonsterStrictly||this.kind==="Monster"}get isOnFieldAsSpellTrapStrictly(){return this.isOnFieldStrictly&&(this.kind==="Spell"||this.kind==="Trap")}get isInTrashCell(){return this.cell.isTrashCell}get isLikeContinuousSpell(){return this.status.spellCategory==="Continuous"||this.status.spellCategory==="Field"||this.status.spellCategory==="Equip"||this.status.trapCategory==="Continuous"||(this.status.monsterCategories??[]).includes("Pendulum")}get isBelongTo(){return this.origin.monsterCategories&&this.origin.monsterCategories.union(Ri).length?this.owner.getExtraDeck():this.owner.getDeckCell()}get exist(){return this._exists}get allStickyEffectOperators(){return[...this.procFilterBundle.effectiveOperators,...this.numericOprsBundle.effectiveOperators]}get fusionMaterialInfos(){return this.definition.fusionMaterialInfos??[]}};c(z,"nextEntitySeq",0),c(z,"splitBattlePos",e=>({face:e==="Set"?"FaceDown":"FaceUp",orientation:e==="Attack"?"Vertical":"Horizontal"})),c(z,"recreateArray",(e,i)=>{if(!i.length)return[];const a=e.getAllCells().flatMap(r=>r.entities);return i.map(r=>r.seq).map(r=>a.find(n=>n.seq===r)).filter(r=>r!==void 0)}),c(z,"createPlayerEntity",e=>{const i=e.getHandCell();return new z(e,i,"Duelist",bp(e),"FaceUp","Vertical")}),c(z,"createCardEntity",(e,i)=>{const a=i.staticInfo.monsterCategories&&i.staticInfo.monsterCategories.union(Ri).length?e.getExtraDeck():e.getDeckCell();return new z(e,a,"Card",i,"FaceDown","Vertical")}),c(z,"createTokenEntity",(e,i,a)=>new z(e,e.duel.field.getWaitingRoomCell(),"Token",a,"FaceUp","Vertical",i)),c(z,"moveMany",async(e,i)=>{if(!e.length)return;const a=e[0].entity.duel,n=[...e.filter(l=>l.entity.cell!==l.to).map(l=>l.entity).filter(l=>!(i??[]).includes(l)),...a.field.getCardsOnFieldStrictly().filter(l=>l.info.isDying)],s=new Map;for(e.forEach(({entity:l,to:o,kind:u,face:d,orientation:f,pos:p,...h})=>{var x;let y=o,v=u,g=d,m=p,C=f;l.status.willBeBanished?(y=l.owner.getBanished(),g="FaceUp",C="Vertical"):l.status.willReturnToDeck?(y=l.isBelongTo,g="FaceDown",m=l.status.willReturnToDeck,C="Vertical"):(x=l.status.monsterCategories)!=null&&x.includes("Pendulum")&&l.isOnField&&!l.info.isPending&&l.kind!=="XyzMaterial"&&l.face==="FaceUp"&&o.isTrashCell&&(y=l.owner.getExtraDeck(),g="FaceUp",m="Top",C="Vertical"),y.cellType==="ExtraDeck"&&(m=g==="FaceUp"?"Top":"Bottom"),l.isBelongTo.cellType==="ExtraDeck"&&(y.cellType==="Hand"||y.cellType==="Deck")&&(y=l.isBelongTo,g="FaceDown",C="Vertical"),y.isPlayFieldCell||(v=l.origin.kind,l.entityType==="Token"&&(y=l.field.getWaitingRoomCell())),y.isMonsterZoneLikeCell||(C="Vertical"),s.set(y,[{entity:l,to:y,kind:v,face:g,orientation:C,pos:m,...h},...s.get(y)??[]])});;){const l=Array.from(s.values()).map(o=>o.pop()).filter(o=>o!==void 0).map(o=>o.entity._move(o));if(!l.length)break;await Promise.all(l),await _.waitCorpseDisposal(a,{excludedList:n})}z.settleEntityMove(a)}),c(z,"summonMany",async(e,i,a,r,n)=>{if(!e.length)return;const s=n.duel,l={Attack:"AttackSummon",Defense:"DefenseSummon",Set:"SetSummon"},o=e.map(({monster:u,dest:d,pos:f,summoner:p})=>{if(u.info.summonKinds=[i],i==="NormalSummon"||i==="AdvanceSummon"){u.info.summonKinds.push("NormalSummon");const v=i==="AdvanceSummon"?"ã‚¢ãƒ‰ãƒãƒ³ã‚¹":"";f==="Attack"?u.field.duel.log.info(`${u.toString()}ã‚’${v}å¬å–š`,p):u.duel.log.info(`${u.toString()}ã‚’${v}ã‚»ãƒƒãƒˆ`,p),a.includes("Rule")?p.info.ruleNormalSummonCountQty++:p.info.effectNormalSummonCountQty++}else i==="SpecialSummon"?u.duel.log.info(`${u.toString()}ã‚’${Ei[f]}ã§ç‰¹æ®Šå¬å–š`,p):(u.info.summonKinds.push("SpecialSummon"),u.duel.log.info(`${u.toString()}ã‚’${Ei[f]}ã§${su[i]}ï¼`,p)),p.info.specialSummonCountQty++;u.info.summonKinds=u.info.summonKinds.getDistinct(),u.info.battlePotisionChangeCount=1;const{face:h,orientation:y}=z.splitBattlePos(f);return a.includes("Rule")&&(u.info.isPending=!0),{entity:u,args:{to:d,kind:"Monster",face:h,orientation:y,pos:"Top",movedAs:[i,l[f],...a],movedBy:r,actionOwner:n,chooser:p}}}).map(u=>u.entity._move(u.args));await Promise.all(o),e.map(u=>u.summoner).forEach(u=>{i==="NormalSummon"||i==="AdvanceSummon"?a.includes("Rule")?u.info.ruleNormalSummonCount++:u.info.effectNormalSummonCount++:u.info.specialSummonCount++}),await _.waitCorpseDisposal(s),z.settleEntityMove(e[0].monster.duel)}),c(z,"sendManyToGraveyard",(e,i)=>z.bringManyToSameCell("Graveyard","Top",e.map(a=>({...a,face:"FaceUp",orientation:"Vertical"})),i)),c(z,"bringManyToSameCell",async(e,i,a,r)=>(await z.moveMany(a.map(n=>({...n,to:n.entity.field.getCells(e).filter(s=>s.owner===n.entity.owner)[0],kind:n.entity.origin.kind,pos:i,chooser:n.activator,actionOwner:n.activator})),r),a.map(n=>n.entity).filter(n=>n.cell.cellType===e))),c(z,"settleEntityMove",e=>{e.field.recalcLinkArrows(),e.field.distributeOperators(e.clock);const i=e.field.getAllEntities().filter(a=>a.wasMovedAtCurrentProc);i.filter(a=>!a.isOnFieldStrictly&&!a.info.isPending).forEach(a=>a.resetInfoIfLeavesTheField()),i.filter(a=>a.face==="FaceDown").filter(a=>a.cell===a.isBelongTo).forEach(a=>{a.resetInfoAll(),a.resetStatusAll()}),i.flatMap(a=>a.continuousEffects).forEach(a=>a.updateState()),e.field.getAllCells().filter(a=>a.needsShuffle).map(a=>a.shuffle())});let Z=z;Z.prototype.hasBeenArrivalNow=function(t,e=k,i=!1){const a=e.map(lu),r=this.moveLog.latestArrivalRecord;if(!r)return!1;if(this.field.duel.clock.isPreviousChain(r.movedAt)){if(i&&!this.field.duel.clock.isPreviousProc(r.movedAt))return!1}else return!1;const n=r.movedAs;return!(!n.union(t).length||!n.union(a).length)};Z.prototype.getAttackTargets=function(){const t=this.controller.getOpponentPlayer().getMonstersOnField().filter(e=>e.status.isSelectableForAttack);return(this.status.canDirectAttack||!t.length)&&t.push(this.controller.getOpponentPlayer().entity),t.filter(e=>e.canBeTargetOfBattle(this.controller,this)).filter(e=>this.procFilterBundle.filter(["BattleTarget"],this.controller,this,{},[e]))};Z.prototype.canBeEffected=function(t,e,i){return this.procFilterBundle.filter(["Effect"],t,e,i,[this])};const uu=(t,e,i,a,r)=>t.canBeEffected(i,a,r)&&t.procFilterBundle.filter([e],i,a,r,[t]);Z.prototype.canBeTargetOfEffect=function(t){return this.procFilterBundle.filter(["EffectTarget"],t.activator,t.action.entity,t.action,[this])};Z.prototype.canBeBanished=function(t,e,i,a){return this.cell.cellType==="Banished"?!1:uu(this,t,e,i,a)};Z.prototype.canBeTargetOfBattle=function(t,e){return this.procFilterBundle.filter(["BattleTarget"],t,e,{},[this])};Z.prototype.validateDestroy=function(t,e,i,a){let r=this.procFilterBundle.filter([t==="Battle"?"BattleDestroy":"EffectDestroy"],e,i,a??{},[this]);return r&&t==="Effect"&&(r=this.canBeEffected(e,i,a)),r};Z.prototype.getIndexInCell=function(){const t=this;if(t.info.isVanished||t.kind==="XyzMaterial")return-1;const e=t.cell.cardEntities.indexOf(t);if(e<0)throw new S("ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã¨ã‚»ãƒ«ã®çŠ¶æ…‹ãŒçŸ›ç›¾ã—ã¦ã„ã‚‹ã€‚",[t,t.cell]);return e};Z.prototype.getXyzMaterials=function(){const t=this;return(t.status.monsterCategories??[]).includes("Xyz")?t.cell.xyzMaterials:[]};Z.prototype.wasMovedAfter=function(t){return this.moveLog.latestRecord.movedAt.totalProcSeq>t.totalProcSeq};Z.prototype.hadArrivedToFieldAt=function(){let t=this.moveLog.latestRecord.movedAt;return this.moveLog.records.findLast(e=>!e.cell.isPlayFieldCell||e.isPending||e.kind!==this.kind||e.face==="FaceDown"?!0:(t=e.movedAt,!1)),t};Z.prototype.release=async function(t,e,i){return await this.sendToGraveyard([...t,"Release"],e,i),this.info.isVanished?void 0:this.cell};Z.prototype.ruleDestroy=async function(){return await this.sendToGraveyard(["Rule","Destroy"],void 0,void 0),this.info.isVanished?void 0:this.cell};Z.prototype.sendToGraveyard=async function(t,e,i){await _.sendManyToGraveyardForTheSameReason([this],t,e,i)};Z.prototype.discard=async function(t,e,i){await _.discardManyForTheSameReason([this],t,e,i)};Z.prototype.returnToDeck=async function(t,e,i,a){await _.returnManyToDeckForTheSameReason(t,[this],e,i,a)};Z.prototype.banish=async function(t,e,i){await _.banishManyForTheSameReason([this],t,e,i)};class du{constructor(e){c(this,"cells");c(this,"duel");c(this,"summonFilterPool");c(this,"procFilterPool");c(this,"numericStateOperatorPool");c(this,"statusOperatorPool");c(this,"damageFilterPool");c(this,"moveLog");c(this,"distributeOperators",e=>{console.info(`[totalProcSeq]:${e.totalProcSeq}`);let i=0;for(;;){if(i++,i>10)throw new S("ç„¡é™ãƒ«ãƒ¼ãƒ—ç™ºç”Ÿ");let a=!0;for(const r of this.stickyOperatorPools)if(!r.distributeAll(this.duel)){a=!1;break}if(a)return}});c(this,"getAllCells",()=>this.cells.flat());c(this,"getCells",(...e)=>this.getAllCells().filter(i=>e.includes(i.cellType)));c(this,"getAvailableExtraMonsterZones",()=>this.getCells("ExtraMonsterZone").filter(e=>e.isAvailable));c(this,"getWaitingRoomCell",()=>this.getCells("WaitingRoom")[0]);c(this,"getAllEntities",()=>this.getAllCells().map(e=>e.entities).flat());c(this,"getAllCardEntities",()=>this.getAllCells().map(e=>e.cardEntities).flat());c(this,"getCardsOnFieldStrictly",()=>this.getCells(...Se).map(e=>e.cardEntities).filter(e=>e.length>0).map(e=>e[0]).filter(e=>e.isOnFieldStrictly));c(this,"getMonstersOnFieldStrictly",()=>this.getCardsOnFieldStrictly().filter(e=>e.isOnFieldAsMonsterStrictly));c(this,"getSpellTrapsOnFieldStrictly",()=>this.getCardsOnFieldStrictly().filter(e=>e.isOnFieldAsSpellTrapStrictly));c(this,"getPendulumScalesOnFieldStrictly",()=>this.getCardsOnFieldStrictly().filter(e=>{var i;return(i=e.origin.monsterCategories)==null?void 0:i.includes("Pendulum")}).filter(e=>e.isOnFieldAsSpellTrapStrictly).filter(e=>!e.status.spellCategory));c(this,"getPendingCardsOnField",()=>this.getCells(...Se).map(e=>e.cardEntities).filter(e=>e.length>0).map(e=>e[0]).filter(e=>e.info.isPending));c(this,"getDyingCardsOnField",()=>this.getCells(...Se).flatMap(e=>[...e.cardEntities,...e.xyzMaterials]).filter(e=>e.info.isDying));c(this,"getPendingMonstersOnField",()=>this.getPendingCardsOnField().filter(e=>e.kind==="Monster"));c(this,"getEntities",e=>this.getAllEntities().filter(i=>i.controller===e));c(this,"recalcLinkArrows",()=>{const e=this.getAllCells().filter(i=>i.isMonsterZoneLikeCell);e.some(i=>i.recalcLinkArrows)&&e.forEach(i=>i.recalcLinkArrows())});c(this,"canExtraLink",(e,i)=>{if(!e.linkArrows.length)return!1;const a=i.map(u=>u.material),r=this.getCells("ExtraMonsterZone").filter(u=>u.isAvailable||a.includes(u.cardEntities[0]));if(r.length!==1)return!1;const n=r[0],s=e.linkArrows.map(u=>this.cells[n.row+u.offsetRow][n.column+u.offsetColumn]);let l=n.linkArrowSources.filter(u=>!a.includes(u)).filter(u=>s.includes(u.cell));if(!l.length)return!1;let o=-1;for(;o!==l.length;){const u=l.flatMap(d=>d.coLinkedEntities).filter(d=>!a.includes(d));if(u.some(d=>d.cell.cellType==="ExtraMonsterZone"))return!0;l=[...l,...u].getDistinct(),o=l.length}return!1});c(this,"drawAtSameTime",async(e,i,a,r,n,s)=>{const l=[],o=[],u=[e.draw(i,n,s),a.draw(r,n,s)].map(d=>d.catch(f=>{f instanceof re?f.winner&&l.push(f.winner):o.push(f)}));if(await Promise.all(u),o.length)throw new S("ãƒ‰ãƒ­ãƒ¼å‡¦ç†ã§æƒ³å®šã•ã‚Œãªã„ä¾‹å¤–ãŒç™ºç”Ÿã—ãŸã€‚",e,i,a,r,n,...o);if(l.length!==0)throw l.length===1?new re(l[0],`${l[0].getOpponentPlayer().name}ãŒãƒ‡ãƒƒã‚­ã‹ã‚‰ãƒ‰ãƒ­ãƒ¼ã§ããªã‹ã£ãŸã€‚`):new re(void 0,"ãŠäº’ã„ã«ãƒ‡ãƒƒã‚­ã‹ã‚‰ã‚«ãƒ¼ãƒ‰ã‚’ãƒ‰ãƒ­ãƒ¼ã§ããªã‹ã£ãŸã€‚")});c(this,"sendToGraveyard",async(e,i,a,r,n,s,l,o)=>{if(r>0&&a.length<r)return;const u=await this.duel.view.waitSelectEntities(i,{selectables:a,qty:r,validator:n,cancelable:o??!1},e);if(u)return await Z.sendManyToGraveyard(u.map(d=>({entity:d,movedAs:s,movedBy:l,activator:i}))),this.duel.log.info(`${u.map(d=>d.status.name).join(", ")}ã‚’å¢“åœ°ã«é€ã£ãŸï¼ˆ${s.getDistinct().join(", ")}ï¼‰ã€‚`,i),u});this.duel=e,this.cells=[...Array(7)].map(()=>[]);for(const i of Object.keys(Oa).map(Number))for(const a of Object.keys(Oa[i]).map(Number))this.cells[i][a]=new _c(this,i,a,i<3?e.duelists.Above:i>3?e.duelists.Below:a<2?e.duelists.Above:a>4?e.duelists.Below:void 0);this.summonFilterPool=new Ic,this.procFilterPool=new wc,this.numericStateOperatorPool=new bc,this.statusOperatorPool=new Yc,this.damageFilterPool=new iu,this.moveLog=new Lc(this),this.duel.clock.onStageChange.append(this.distributeOperators)}get stickyOperatorPools(){return[this.procFilterPool,this.statusOperatorPool,this.numericStateOperatorPool,this.summonFilterPool,this.damageFilterPool]}}const Lr=t=>{let e=[];do{const i=t.qty&&t.qty>0?t.qty:Math.floor(Math.random()*t.selectables.length+1);e=t.selectables.randomPickMany(i)}while(!t.validator(e));return e};class fu{constructor(e){c(this,"onStateChangeEvent",new V);c(this,"_stateLog",[]);c(this,"_state");this._stateLog.push({state:e,timestamp:new Date}),this._state=e}get stateLog(){return this._stateLog}get wasSpawnedAt(){return this.stateLog[0].timestamp}get onStateChange(){return this.onStateChangeEvent.expose()}get state(){return this._state}set state(e){this._stateLog.push({state:e,timestamp:new Date}),this._state=e,this.onStateChangeEvent.trigger(e)}}class qr{constructor(e,i){c(this,"_dispose");c(this,"_commit");c(this,"commit",()=>this._commit());this._dispose=e,this._commit=i}[Symbol.dispose](){this._dispose()}[Symbol.for("Symbol.dispose")](){this._dispose()}}class pu{constructor(e){c(this,"onUpdateEvent",new V);c(this,"nextSeq");c(this,"records",[]);c(this,"_state","Opened");c(this,"pooledRecords",[]);c(this,"duel");c(this,"openTransaction",()=>this._state!=="Opened"?(console.info("ãƒ­ã‚°ã®äºŒé‡ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã‚’é–‹å§‹ã—ã‚ˆã†ã¨ã—ãŸãŸã‚ã€ãƒ€ãƒŸãƒ¼ã‚’è¿”ã™ã€‚"),new qr(()=>{},()=>{})):(this._state="Pending",new qr(this.closeTransaction,this.commit)));c(this,"commit",()=>{if(this._state!=="Pending")throw new S("DuelLog is not in Pending state.");this.records.push(...this.pooledRecords),this.pooledRecords=[],this.onUpdateEvent.trigger(this.nextSeq-1)});c(this,"closeTransaction",()=>{this._state="Opened",this.pooledRecords=[],this.onUpdateEvent.trigger(this.nextSeq-1)});c(this,"dispose",()=>{this.onUpdateEvent.clear()});c(this,"error",e=>{const i=["ã‚¨ãƒ©ãƒ¼ç™ºç”Ÿ"];e instanceof Error?(i.push("-- ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ --"),i.push(e.message),e instanceof S&&(i.push("-- é–¢é€£ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ --"),e.items.forEach(a=>i.push(JSON.stringify(a)))),i.push("-- ã‚¨ãƒ©ãƒ¼åç§° --"),i.push(e.name||"ã‚¨ãƒ©ãƒ¼åç§°å–å¾—å¤±æ•—"),i.push("-- ã‚¹ã‚¿ãƒƒã‚¯ãƒˆãƒ¬ãƒ¼ã‚¹ --"),i.push(e.stack||"ã‚¹ã‚¿ãƒƒã‚¯ãƒˆãƒ¬ãƒ¼ã‚¹å–å¾—å¤±æ•—")):(i.push("-- ã‚¨ãƒ©ãƒ¼åž‹ç‰¹å®šå¤±æ•— --"),i.push(JSON.stringify(e))),console.error(e),console.error(i),this.write("error","System",i,void 0)});c(this,"warn",e=>{this.write("warn","System",["ã€æ³¨æ„ã€‘",e],void 0)});c(this,"info",(e,i)=>{this.write("info","Others",[e],i)});c(this,"pushChainBlockHeaderLog",(e,i,a)=>{this.write("info","ChainBlockHeader",[a],e,{chainNumber:i})});c(this,"pushMoveLog",(e,i,a,r)=>{const n=a.cellType==="WaitingRoom"?void 0:a,s=r.cellType==="WaitingRoom"?void 0:r;if(!n&&!s)throw new S("ç§»å‹•å…ƒã€ç§»å‹•å…ˆã¨ã‚‚ã«WaitingRoomãŒæŒ‡å®šã•ã‚Œã¦ã„ã‚‹ã€‚",e,i,a,r);const l=n&&s?"EntityMove":s?"EntityAppear":"EntityDisappear";this.write("info",l,[],e,{mainEntity:i,from:n,to:s})});c(this,"write",(e,i,a,r,n={})=>{const s=a.join(`
`),l={seq:this.nextSeq++,lvl:e,type:i,clock:this.duel.clock.getClone(),text:s,duelist:r,subEntities:[],...n};this._state==="Opened"||e!=="info"?(this.records.push(l),this.onUpdateEvent.trigger(this.nextSeq-1)):this.pooledRecords.push(l)});this.nextSeq=0,this.duel=e}get onUpdate(){return this.onUpdateEvent.expose()}get lastRecord(){return this.records.slice(-1)[0]}}class qa{constructor(e){c(this,"onUpdateEvent",new V);c(this,"_state","Disable");c(this,"defaultArgs");c(this,"_args");c(this,"resolve",()=>{});c(this,"show",e=>{this._args=e,this._state="Shown",console.log(this,this.onUpdateEvent),this.onUpdateEvent.trigger();const{promise:i,resolve:a}=zn();return this.resolve=r=>{this._state="Disable",a(r),this.resolve=()=>{},this.onUpdateEvent.trigger()},i});c(this,"cancel",()=>{console.log(this),this.args.cancelable&&(this._state!=="Disable"&&this.resolve(void 0),this.terminate())});c(this,"terminate",()=>{this._state="Disable",this._args=this.defaultArgs,this.resolve=()=>{}});this.defaultArgs=e,this._args=e}get onUpdate(){return this.onUpdateEvent.expose()}get state(){return this._state}get args(){return this._args}}class gu{constructor(e,...i){c(this,"textSelector",new qa({title:"é¸æŠžã€‚",position:"Middle",choises:[],cancelable:!1}));c(this,"onUpdateEvent",new V);c(this,"modals");c(this,"eventHolder");c(this,"terminateAll",()=>{this.modals.forEach(e=>e.terminate()),this.onUpdateEvent.trigger()});this.modals=[this.textSelector,...i],this.eventHolder=e,this.modals.forEach(a=>a.onUpdate.append(()=>{this.onUpdateEvent.trigger()}))}get onUpdate(){return this.onUpdateEvent.expose()}}var hu=$("<div></div>"),yu=$('<div class="duel_card_row svelte-1qeuyz"><div> </div> <div> </div></div>'),vu=$('<div class="duel_card_row svelte-1qeuyz"><div class="svelte-1qeuyz"></div> <div class="svelte-1qeuyz"> </div></div>'),mu=$('<div class="duel_card_row svelte-1qeuyz"><div class="svelte-1qeuyz"></div> <div class="svelte-1qeuyz"> </div></div>'),Su=$('<div class="duel_card_row svelte-1qeuyz"><div> </div> <div> </div></div>'),_u=$('<div class="duel_card_row svelte-1qeuyz"><div class="svelte-1qeuyz"></div> <div class="svelte-1qeuyz">ãƒšãƒ³ãƒ‡ãƒ¥ãƒ©ãƒ </div></div>'),Tu=$('<div class="duel_card_row duel_card_detail svelte-1qeuyz"><div class="svelte-1qeuyz"> </div></div> <div class="duel_card_row duel_card_detail svelte-1qeuyz"><div class="svelte-1qeuyz"></div> <div class="svelte-1qeuyz"><span> </span> / <span> </span></div></div>',1),Cu=$('<button><div class="duel_card_body svelte-1qeuyz"><div class="duel_card_row svelte-1qeuyz" style="position:relative"><div> </div> <div class="svelte-1qeuyz"></div> <!></div> <!> <!> <!> <!></div></button>'),wu=$('<button><div class="svelte-1qeuyz">è£å®ˆå‚™</div></button>'),Eu=$('<button><div class="svelte-1qeuyz">ã‚»ãƒƒãƒˆ</div></button>');function Qn(t,e){ut(e,!1);let i=K(e,"entity",8),a=K(e,"state",8,"Disabled"),r=K(e,"selectedList",28,()=>[]),n=K(e,"isVisibleForcibly",8,!1),s=K(e,"isWideMode",8,!1),l=K(e,"dummyActionInfos",24,()=>[]),o=K(e,"cardActionResolve",8),u=K(e,"entitySelectResolve",8,()=>{}),d,f=Mi(!1),p=()=>{},h=K(e,"qty",12,void 0);const y=B=>{var E;d=B.activator,Y(f,!1),h((E=B.entitiesChoices)==null?void 0:E.qty),p=B.resolve};i().field.duel.view.onWaitStart.append(y);let v=Mi(!1);const g=B=>{(i().face==="FaceUp"||i().owner===i().field.duel.duelists.Below&&(i().isUnderControl||n()))&&i().field.duel.view.showCardInfo(i(),B??"Normal")},m=()=>{if(g(),console.log(i().toString(),a(),l().length,o(),h(),p),a()==="Disabled")return;if(a()==="Selectable"){if(Y(f,!P(f)),h()===1){u()&&u()([i()]),p&&p({selectedEntities:[i()]});return}r(P(f)?[...r(),i()]:r().filter(E=>E!==i()));return}if(l().length===0)return;if(l().length===1){const E=l()[0];if(o()){o()(E);return}console.log(i().toString(),a(),l().length,p),p({actionInfo:E});return}if(!d)return;i().field.duel.view.modalController.actionSelector.show({title:"è¡Œå‹•ã‚’é¸æŠžã€‚",position:"Bottom",activator:d,dummyActionInfos:l(),cancelable:!0}).then(E=>{E&&p({actionInfo:E})})},C=B=>{var E;window.getSelection&&((E=window.getSelection())==null||E.removeAllRanges()),console.info("drag start",B,l()),i().field.duel.view.setDraggingActions(l()),Y(v,!0)},x=B=>{console.info("drag end",B,l()),i().field.duel.view.removeDraggingActions(),B.dataTransfer&&Y(v,!1)},w=()=>(g("Debug"),!1);Gt();var A=vt(),J=Ne(A);{var ge=B=>{var E=Cu(),ie=q(E),I=q(ie),ye=q(I),xe=q(ye),Te=Q(ye,4);ai(Te,1,()=>i().attr,ii,(j,ee)=>{var ce=hu();te(()=>ae(ce,`monster_attr ${P(ee)??""} svelte-1qeuyz`)),N(j,ce)});var Vt=Q(I,2);{var mi=j=>{var ee=yu(),ce=q(ee),ft=q(ce),Ge=Q(ce,2),Ce=q(Ge);te(($e,Ue)=>{ae(ce,gt(i().lvl!==i().origin.level?"different_from_its_origin":""),"svelte-1qeuyz"),he(ft,$e),ae(Ge,gt(i().rank!==i().origin.rank?"different_from_its_origin":""),"svelte-1qeuyz"),he(Ce,Ue)},[()=>"â˜…".repeat(i().lvl||0),()=>"â˜†".repeat(i().rank||0)],rt),N(j,ee)},Si=j=>{var ee=vt(),ce=Ne(ee);{var ft=Ce=>{var $e=vu(),Ue=Q(q($e),2),Wt=q(Ue);te(()=>he(Wt,`${dc[i().status.spellCategory]??""}é­”æ³•`)),N(Ce,$e)},Ge=Ce=>{var $e=vt(),Ue=Ne($e);{var Wt=wt=>{var _i=mu(),je=Q(q(_i),2),Et=q(je);te(()=>he(Et,`${fc[i().status.trapCategory]??""}ç½ `)),N(wt,_i)};X(Ue,wt=>{i().kind==="Trap"&&i().status.trapCategory&&wt(Wt)},!0)}N(Ce,$e)};X(ce,Ce=>{i().kind==="Spell"&&i().status.spellCategory?Ce(ft):Ce(Ge,!1)},!0)}N(j,ee)};X(Vt,j=>{i().isMonster?j(mi):j(Si,!1)})}var dr=Q(Vt,2);{var bl=j=>{var ee=Su(),ce=q(ee),ft=q(ce),Ge=Q(ce,2),Ce=q(Ge);te(()=>{ae(ce,gt(i().psL!==i().origin.pendulumScaleL?"different_from_its_origin":""),"svelte-1qeuyz"),he(ft,`â—€ ${i().psL??""}`),ae(Ge,gt(i().psR!==i().origin.pendulumScaleR?"different_from_its_origin":""),"svelte-1qeuyz"),he(Ce,`${i().psR??""} â–¶`)}),N(j,ee)};X(dr,j=>{var ee;(ee=i().status.monsterCategories)!=null&&ee.includes("Pendulum")&&j(bl)})}var fr=Q(dr,2);{var kl=j=>{var ee=_u();N(j,ee)};X(fr,j=>{i().kind==="Spell"&&i().isPendulumScale&&j(kl)})}var Dl=Q(fr,2);{var xl=j=>{var ee=Tu(),ce=Ne(ee),ft=q(ce),Ge=q(ft),Ce=Q(ce,2),$e=Q(q(Ce),2),Ue=q($e),Wt=q(Ue),wt=Q(Ue,2),_i=q(wt);te((je,Et)=>{he(Ge,`${je??""}
            ${Et??""}`),ae(Ue,gt(i().atk!==i().origin.attack?"different_from_its_origin":""),"svelte-1qeuyz"),he(Wt,i().atk??"?"),ae(wt,gt(i().def!==i().origin.defense?"different_from_its_origin":""),"svelte-1qeuyz"),he(_i,i().def??"?")},[()=>i().types.map(je=>gc[je]+(s()?pc[je]:"")).join(),()=>{var je;return(je=i().status.monsterCategories)==null?void 0:je.map(Et=>cc[Et]+(s()?oc[Et]:"")).join()}],rt),N(j,ee)};X(Dl,j=>{i().isMonster&&j(xl)})}te(j=>{ae(E,`duel_card button_style_reset ${i().origin.kind??""} ${j??""} ${(P(f)?"duel_card_selected":"")??""} ${a()??""} duel_card_${i().orientation??""} ${(P(v)?"isDragging":"")??""} ${(s()?"duel_card_wide":"")??""} duel_card_${i().face??""} ${(i().isOnField?"duel_card_is_on_field":"")??""} svelte-1qeuyz`),br(E,"draggable",a()==="Draggable"),br(E,"title",i().nm),ae(ye,gt(i().nm!==i().origin.name?"different_from_its_origin":""),"svelte-1qeuyz"),he(xe,i().nm)},[()=>{var j;return((j=i().status.monsterCategories)==null?void 0:j.join(" "))||""}],rt),pt("dragstart",E,C),pt("dragend",E,x),pt("click",E,m),pt("mouseenter",E,()=>g()),pt("contextmenu",E,w),N(B,E)},R=B=>{var E=vt(),ie=Ne(E);{var I=xe=>{var Te=wu();te(()=>ae(Te,`duel_card duel_card_face_down duel_card_face_down_defense ${a()??""}  ${(P(f)?"duel_card_selected":"")??""} svelte-1qeuyz`)),pt("click",Te,m),N(xe,Te)},ye=xe=>{var Te=Eu();te(()=>ae(Te,`duel_card duel_card_face_down ${a()??""}  ${(P(f)?"duel_card_selected":"")??""} svelte-1qeuyz`)),pt("click",Te,m),N(xe,Te)};X(ie,xe=>{i().battlePosition==="Set"?xe(I):xe(ye,!1)},!0)}N(B,E)};X(J,B=>{i().face==="FaceUp"||n()||i().controller.duelistType==="Player"&&i().isUnderControl?B(ge):B(R,!1)})}N(t,A),dt()}var bu=$('<div class="modal_window_header svelte-2kmgt1"> </div>'),ku=$('<div><!> <div class="modal_window_body svelte-2kmgt1"><!></div> <div class="modal_window_footer svelte-2kmgt1"><!></div></div>');function lr(t,e){ut(e,!1);let i=K(e,"args",8),a=K(e,"eventHolder",8),r=Mi(!1);const n=()=>{Y(r,!0)},s=()=>{Y(r,!1)};a().onDragStart.append(n),a().onDragEnd.append(s),Gt();var l=ku(),o=q(l);{var u=y=>{var v=bu(),g=q(v);te(()=>he(g,i().title)),N(y,v)};X(o,y=>{P(r)||y(u)})}var d=Q(o,2),f=q(d);Fa(f,e,"body",{});var p=Q(d,2),h=q(p);Fa(h,e,"footer",{}),te(y=>ae(l,`modal_window modal_window_${y??""} ${(P(r)?"modal_window_is_dragging":"")??""} svelte-2kmgt1`),[()=>i().position.toLowerCase()],rt),N(t,l),dt()}const Du=(t,e,i)=>e.resolve(P(i));var xu=$('<div><!> <div class="cell_type_name svelte-p7db7v"> </div></div>'),Au=$("<div></div>"),Pu=$('<div slot="body"></div>'),Mu=$('<button class="svelte-p7db7v">OK</button>'),Fu=(t,e)=>e.resolve(void 0),Ou=$('<button class="cancel_button svelte-p7db7v">Cancel</button>'),Nu=$('<div slot="footer" class="modal_window_footer svelte-p7db7v"><!> <!></div>');function Bu(t,e){ut(e,!0);let i=po(et([])),a=e.args.chainBlockInfos.flatMap(l=>l.selectedEntities).getDistinct();var r=vt(),n=Ne(r);{var s=l=>{lr(l,{get eventHolder(){return e.eventHolder},get args(){return e.args},$$slots:{body:(o,u)=>{var d=Pu();ai(d,21,()=>e.args.entitiesChoices.selectables.map(f=>f.controller.seat).getDistinct(),ii,(f,p)=>{var h=Au();ai(h,21,()=>e.args.entitiesChoices.selectables.filter(y=>y.controller.seat===P(p)).toSorted(cu),ii,(y,v)=>{var g=xu(),m=q(g);Qn(m,{get entity(){return P(v)},isVisibleForcibly:!0,state:"Selectable",entitySelectResolve:w=>e.resolve(w),get qty(){return e.args.entitiesChoices.qty},cardActionResolve:void 0,get selectedList(){return P(i)},set selectedList(w){Y(i,et(w))}});var C=Q(m,2),x=q(C);te(w=>{ae(g,`entities_list_item ${w??""} svelte-p7db7v`),he(x,`ã€ˆ${P(v).cell.shortName??""}ã€‰`)},[()=>a.includes(P(v))?"effect_target":""]),N(y,g)}),te(()=>ae(h,`entities_list ${P(p)??""} svelte-p7db7v`)),N(f,h)}),N(o,d)},footer:(o,u)=>{var d=Nu(),f=q(d);{var p=v=>{var g=Mu();g.__click=[Du,e,i],te(m=>g.disabled=m,[()=>!e.args.entitiesChoices.validator(P(i))]),N(v,g)};X(f,v=>{(e.args.entitiesChoices.qty??1e3)>1&&v(p)})}var h=Q(f,2);{var y=v=>{var g=Ou();g.__click=[Fu,e],N(v,g)};X(h,v=>{e.args.cancelable&&v(y)})}N(o,d)}}})};X(n,l=>{l(s)})}N(t,r),dt()}oa(["click"]);var Lu=$('<div class="duel_card_wrapper svelte-1pg50l9"><!> <div> </div></div>'),qu=$('<div class="action_list" slot="body" style="display: flex; justify-content: space-around;"></div>'),Ru=(t,e)=>e()(void 0),Hu=$('<button class="cancel_button svelte-1pg50l9">Cancel</button>'),Zu=$('<div slot="footer"><!></div>');function Gu(t,e){ut(e,!1);let i=K(e,"eventHolder",8),a=K(e,"args",8),r=K(e,"resolve",8);Gt();var n=vt(),s=Ne(n);{var l=o=>{lr(o,{get eventHolder(){return i()},get args(){return a()},$$slots:{body:(u,d)=>{var f=qu();ai(f,5,()=>a().dummyActionInfos,ii,(p,h)=>{var y=Lu(),v=q(y);const g=rt(()=>P(h).dests.length?"Draggable":"Clickable"),m=rt(()=>a().dragAndDropOnly?[]:[P(h)]);Qn(v,{get entity(){return P(h).action.entity},isVisibleForcibly:!0,get state(){return P(g)},get dummyActionInfos(){return P(m)},get cardActionResolve(){return r()}});var C=Q(v,2),x=q(C);te(()=>he(x,`Â«${P(h).action.title??""}Â»`)),N(p,y)}),N(u,f)},footer:(u,d)=>{var f=Zu(),p=q(f);{var h=y=>{var v=Hu();v.__click=[Ru,r],N(y,v)};X(p,y=>{a().cancelable&&y(h)})}N(u,f)}}})};X(s,o=>{o(l)})}N(t,n),dt()}oa(["click"]);var $u=(t,e,i)=>e()(i()),Uu=$('<li><button class="svelte-1rzyf4u"> </button></li>'),ju=$('<ui slot="body" class="text_list svelte-1rzyf4u"></ui>'),zu=(t,e)=>e()(void 0),Vu=$('<button class="cancel_button svelte-1rzyf4u">Cancel</button>'),Wu=$('<div slot="footer"><!></div>');function Qu(t,e){ut(e,!1);let i=K(e,"eventHolder",8),a=K(e,"args",8),r=K(e,"resolve",8);Gt();var n=vt(),s=Ne(n);{var l=o=>{lr(o,{get eventHolder(){return i()},get args(){return a()},$$slots:{body:(u,d)=>{var f=ju();ai(f,5,()=>a().choises,ii,(p,h)=>{let y=()=>P(h).seq,v=()=>P(h).text;var g=Uu(),m=q(g);m.__click=[$u,r,y];var C=q(m);te(()=>{ae(g,`text_item ${y()??""} svelte-1rzyf4u`),he(C,v())}),N(p,g)}),N(u,f)},footer:(u,d)=>{var f=Wu(),p=q(f);{var h=y=>{var v=Vu();v.__click=[zu,r],N(y,v)};X(p,y=>{a().cancelable&&y(h)})}N(u,f)}}})};X(s,o=>{o(l)})}N(t,n),dt()}oa(["click"]);const Xu=(t,e)=>e().modals.filter(i=>i.args.cancelable).forEach(i=>i.cancel());var Ku=$("<button>â˜†</button> <!> <!>",1),Yu=$("<div><!></div>");function Ju(t,e){ut(e,!1);let i=K(e,"modalController",12),a=Mi(!1);const r=()=>{i(i())},n=()=>{console.log("hoge"),Y(a,!0),r()},s=()=>{Y(a,!1),r()};i().eventHolder.onDragStart.append(n),i().eventHolder.onDragEnd.append(s),i().onUpdate.append(r),Gt();var l=Yu(),o=q(l);{var u=d=>{var f=Ku(),p=Ne(f);p.__click=[Xu,i];var h=Q(p,2);Fa(h,e,"default",{});var y=Q(h,2);{var v=g=>{Qu(g,{get eventHolder(){return i().eventHolder},get args(){return i().textSelector.args},get resolve(){return i().textSelector.resolve}})};X(y,g=>{i().textSelector.state==="Shown"&&g(v)})}te(()=>ae(p,`overlay ${(P(a)?"pointer_events_none":"")??""} svelte-xqm104`)),N(d,f)};X(o,d=>{i().modals.some(f=>f.state==="Shown")&&d(u)})}te(()=>ae(l,`base ${(P(a)?"base_is_dragging":"")??""} svelte-xqm104`)),N(t,l),dt()}oa(["click"]);const Ki=class Ki extends gu{constructor(e,i){super(e,...Object.values(i))}};c(Ki,"createModalController",e=>{const i={actionSelector:new qa({title:"ã‚«ãƒ¼ãƒ‰æ“ä½œã‚’é¸æŠžã€‚",position:"Bottom",activator:void 0,dummyActionInfos:[],cancelable:!1}),entitySelector:new qa({title:"å¯¾è±¡ã‚’é¸æŠž",position:"Middle",entitiesChoices:{selectables:[],validator:()=>!0,cancelable:!1},cancelable:!1,chainBlockInfos:[]})};return Object.assign(new Ki(e,i),i)});let Ra=Ki;var Iu=$("<!> <!>",1);function sg(t,e){ut(e,!1);let i=K(e,"modalController",8);Gt(),Ju(t,{get modalController(){return i()},children:(a,r)=>{var n=Iu(),s=Ne(n);{var l=d=>{Bu(d,{get eventHolder(){return i().eventHolder},get args(){return i().entitySelector.args},get resolve(){return i().entitySelector.resolve}})};X(s,d=>{i().entitySelector.state==="Shown"&&d(l)})}var o=Q(s,2);{var u=d=>{Gu(d,{get eventHolder(){return i().eventHolder},get args(){return i().actionSelector.args},get resolve(){return i().actionSelector.resolve}})};X(o,d=>{i().actionSelector.state==="Shown"&&d(u)})}N(a,n)},$$slots:{default:!0}}),dt()}const ed=[{seq:10,name:"Internet Explorer",key:"msie"},{seq:20,name:"Internet Explorer",key:"trident"},{seq:30,name:"Edge",key:"edge"},{seq:40,name:"Google Chrome",key:"chrome"},{seq:50,name:"Safari",key:"safari"},{seq:60,name:"Mozilla Firefox",key:"firefox"},{seq:70,name:"Opera",key:"opera"}],td=[{seq:10,name:"Microsoft Windows",key:"windows nt"},{seq:20,name:"Android",key:"android"},{seq:30,name:"iOS",key:"iphone"},{seq:40,name:"iOS",key:"ipad"},{seq:50,name:"macOS",key:"mac os x"}],si=window.navigator.userAgent.toLowerCase();var Wr;const id=((Wr=ed.find(t=>si.indexOf(t.key)!==-1))==null?void 0:Wr.name)??"Unknown Browser";var Qr;const or=((Qr=td.find(t=>si.indexOf(t.key)!==-1))==null?void 0:Qr.name)??"Unknown OS",Xn=si.indexOf("iphone")!==-1||or==="Android"&&si.indexOf("mobile")!==-1,ad=si.indexOf("ipad")!==-1||or==="Android"&&!Xn,Rr=Xn?"Smart Phone":ad?"Tablet Device":"PC",_a={canDragElement:Rr==="PC",text:`${Rr} ${or} ${id}`};class rd{constructor(e){c(this,"onDuelUpdateEvent",new V);c(this,"requireUpdate",()=>{this.onDuelUpdateEvent.trigger()});c(this,"onWaitStartEvent",new V);c(this,"onWaitEndEvent",new V);c(this,"onDragStartEvent",new V);c(this,"onDragEndEvent",new V);c(this,"onAnimationStartEvent",new V);c(this,"onShowCardEntityEvent",new V);c(this,"duel");c(this,"modalController");c(this,"_message");c(this,"waitMode");c(this,"infoBoardState");c(this,"infoBoardCell");c(this,"getCell",(e,i)=>this.duel.field.cells[e][i]);c(this,"showCardInfo",(e,i)=>{this.onShowCardEntityEvent.trigger({card:e,mode:i})});c(this,"dispose",()=>{this.onDragStartEvent.clear(),this.onDragEndEvent.clear(),this.onDuelUpdateEvent.clear(),this.onWaitStartEvent.clear(),this.onWaitEndEvent.clear()});c(this,"waitFieldAction",async e=>{if(this.duel.getTurnPlayer().duelistType==="NPC"){const n=this.duel.getTurnPlayer().selectActionForNPC(e,[]);return n?{actionInfo:n}:{phaseChange:this.duel.nextPhaseList[0]}}const i=await this._waitDuelistAction(this.duel.getTurnPlayer(),e,"Free","",void 0,void 0,!1);if(!i.actionInfo)return{...i,actionInfo:void 0};const a={...i.actionInfo},r=e.find(n=>{var s;return((s=i.actionInfo)==null?void 0:s.originSeq)===n.originSeq});if(!r)throw new S("æƒ³å®šã•ã‚Œãªã„çŠ¶æ…‹",e,i);return{...i,actionInfo:{dest:a.dest,battlePosition:a.battlePosition,action:r.action,originSeq:r.originSeq}}});c(this,"waitQuickEffect",async(e,i,a,r,n)=>{if(i.length===0)return;if(e.duelistType==="NPC")return e.selectActionForNPC(i,a);const s=[this.modalController.actionSelector.show({title:r,position:"Bottom",activator:e,dummyActionInfos:i,cancelable:n}),this._waitDuelistAction(e,i,"Modal",this.message,void 0,void 0,!1).then(u=>u.actionInfo)],l=await Promise.any(s);if(!l)return;this.infoBoardState="Default";const o=i.find(u=>l.originSeq===u.originSeq);if(!o)throw new S("æƒ³å®šã•ã‚Œãªã„çŠ¶æ…‹",l);return{...o,dest:l.dest}});c(this,"waitSubAction",async(e,i,a,r=!1)=>{if(e.duelistType==="NPC")throw Error("Not implemented");const n=await this._waitDuelistAction(e,i,"Modal",a,void 0,void 0,r);if(n&&n.actionInfo)return n.actionInfo});c(this,"waitSelectEntities",async(e,i,a)=>{if(!i.selectables.length)return;if(i.qty&&i.selectables.length===i.qty)return[...i.selectables];if(e.duelistType==="NPC")return Lr(i);let r;i.selectables.some(s=>s.entityType==="Duelist")&&(r={...i,selectables:i.selectables.filter(s=>s.entityType==="Duelist").map(s=>s.cell),qty:1,validator:s=>s.length===1}),console.log(i);const n=await this._waitDuelistAction(e,[],"Modal",a,i,r,i.cancelable);return(n.selectedEntities||n.selectedCells)&&[...n.selectedEntities??[],...(n.selectedCells??[]).flatMap(s=>s.entities).filter(s=>s.entityType==="Duelist")]});c(this,"waitSelectNumber",async(e,i,a,r)=>{const n=await this.waitSelectText(e,a.getDistinct().toSorted().map(s=>({seq:s,text:s.toString()})),i,r);if(n)return n.seq});c(this,"waitYesOrNo",async(e,i)=>{const a=await this.waitSelectText(e,[{seq:0,text:"Yes"},{seq:1,text:"No"}],i,!1);return(a==null?void 0:a.seq)===0});c(this,"waitSelectText",async(e,i,a,r=!1)=>{if(e.duelistType==="NPC")return i.randomPick();const n=await this.modalController.textSelector.show({title:a,position:"Middle",choises:i,cancelable:r});if(n===void 0){if(!r)throw new F(e,i,a,r);return}return i.find(s=>s.seq===n)});c(this,"waitAnimation",async e=>{var i;return this._message="",this.waitMode="Animation",window.getSelection&&((i=window.getSelection())==null||i.removeAllRanges()),this.onDuelUpdateEvent.trigger(),new Promise(a=>this.onAnimationStartEvent.trigger({...e,resolve:a}))});c(this,"waitTokenAnimation",async()=>{this.requireUpdate(),await Gi(450)});c(this,"setDraggingActions",e=>{this.onDragStartEvent.trigger(e),this.requireUpdate()});c(this,"removeDraggingActions",()=>{this.onDragEndEvent.trigger()});c(this,"waitSelectAction",async(e,i,a,r)=>{var o;const n=i.map(u=>St.createDummyAction(u.entity,u.title,[],void 0,u.origin)),s=await this._waitDammyAction(e,n,a,r);if(!s)return;const l=(o=i.find(u=>u.origin.seq===s.originSeq))==null?void 0:o.origin;if(!l)throw new S("æƒ³å®šã•ã‚Œãªã„çŠ¶æ…‹",i,s);return l});c(this,"waitSelectSummonDestination",async(e,i,a,r,n)=>{const s=a.length>1&&_a.canDragElement?"ã‚«ãƒ¼ãƒ‰ã‚’å¬å–šå…ˆã¸ãƒ‰ãƒ©ãƒƒã‚°ã€‚":"è¡¨ç¤ºå½¢å¼ã‚’é¸æŠžã€‚";if(!a.length&&!r.length){if(n)return;throw new S("æƒ³å®šã•ã‚Œãªã„çŠ¶æ…‹",e,i,a,r,n)}let l=[...r];for(;;){const o={dest:a.randomPick(),battlePosition:l[0]};if(l.length===1&&!_a.canDragElement){const f=await this.waitSelectCell(e,a,n,"å¬å–šå…ˆã‚’é¸æŠžã€‚");return f?{...o,dest:f}:void 0}const u=l.map(f=>St.createDummyAction(i,f,a,f)),d=await this._waitDammyAction(e,u,s,n);if(!d)return;if(d.battlePosition&&(l=[d.battlePosition]),!(a.length>1&&!d.dest))return o.dest=d.dest??o.dest,o.battlePosition=d.battlePosition??o.battlePosition,o}});c(this,"waitSelectDestination",async(e,i,a,r,n,s=!1)=>{if(!a.length)return;if(a.length===1)return a[0];if(!_a.canDragElement)return await this.waitSelectCell(e,a,s,r);let l=a.randomPick();const o=[St.createDummyAction(i,n,a,void 0)],u=await this._waitDammyAction(e,o,r,s);if(u)return l=u.dest??l,l});c(this,"_waitDammyAction",async(e,i,a,r=!1)=>{if(!i.length)return;const n=i.randomPick();let s={...n,dest:n.dest??n.dests.randomPick()};if(e.duelistType!=="NPC"){const l=[this.modalController.actionSelector.show({title:a,position:"Bottom",activator:e,dummyActionInfos:i,cancelable:r}),this.duel.view.waitSubAction(e,i,a,r)],o=await Promise.any(l);if(!o&&!r)throw new F(o,l);if(!o)return;s=o??s}return s});c(this,"waitSelectCell",async(e,i,a,r)=>i.length?e.duelistType==="NPC"?i.randomPick():(await this.waitSelectCells(e,{selectables:i,qty:1,validator:s=>s.length===1,cancelable:a},r)??[])[0]:void 0);c(this,"waitSelectCells",async(e,i,a)=>{if(!i.selectables.length)return;if(e.duelistType==="NPC")return Lr(i);const r=await this._waitDuelistAction(e,[],"Modal",a,void 0,i,i.cancelable);if((!r||!r.selectedCells)&&!i.cancelable)throw new F(e,i,a);return r.selectedCells});c(this,"_waitDuelistAction",async(e,i,a,r,n,s,l=!1)=>{for(this.waitMode=a,this._message=r;this.onDuelUpdateEvent.length<38;)console.log("this.onDuelUpdateEvent.length",this.onDuelUpdateEvent.length),await Gi(1);this.onDuelUpdateEvent.trigger();const o=zn();console.log(n);const u={resolve:o.resolve,activator:e,dummyActionInfos:i,chainBlockInfos:e.duel.chainBlockInfos,entitiesChoices:n,cellsChoices:s};console.info("wait start",u),this.onWaitStartEvent.trigger(u);const d=await o.promise;if(console.info("response",d),this.modalController.terminateAll(),this.waitMode="None",this.onWaitEndEvent.trigger(),d.surrender)throw new re(e.getOpponentPlayer(),`${e.profile.name}ãŒã‚µãƒ¬ãƒ³ãƒ€ãƒ¼ã—ãŸã€‚`);if(!l&&d.cancel)throw new S("ã‚­ãƒ£ãƒ³ã‚»ãƒ«ä¸å¯ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãŒã‚­ãƒ£ãƒ³ã‚»ãƒ«ã•ã‚ŒãŸã€‚",d,i,a,n,s);return this.infoBoardState="Default",d});this.duel=e,this._message="",this.waitMode="None",this.infoBoardState="Default",this.infoBoardCell=e.duelists.Below.getExtraDeck(),this.modalController=Ra.createModalController(this)}get onDuelUpdate(){return this.onDuelUpdateEvent.expose()}get onWaitStart(){return this.onWaitStartEvent.expose()}get onWaitEnd(){return this.onWaitEndEvent.expose()}get onDragStart(){return this.onDragStartEvent.expose()}get onDragEnd(){return this.onDragEndEvent.expose()}get onAnimation(){return this.onAnimationStartEvent.expose()}get onShowCardEntity(){return this.onShowCardEntityEvent.expose()}get message(){var e;return(this._message||((e=this.duel.log.records.filter(i=>i.type==="Others"||i.type==="System").slice(-1)[0])==null?void 0:e.text))??""}}const Ha=["turn","phaseSeq","stepSeq","stageSeq","chainSeq","chainBlockSeq","procSeq"];[...Ha];const Yi=class Yi{constructor(){c(this,"onClockChangeEvents",{turn:new V,phaseSeq:new V,stepSeq:new V,stageSeq:new V,chainSeq:new V,chainBlockSeq:new V,procSeq:new V});c(this,"_turn",0);c(this,"_phaseSeq",0);c(this,"_stepSeq",0);c(this,"_stageSeq",0);c(this,"_chainSeq",0);c(this,"_chainBlockSeq",0);c(this,"_procSeq",0);c(this,"_totalProcSeq",0);c(this,"_periodKey");c(this,"_previousStartPoints",{turn:0,phaseSeq:0,stepSeq:0,stageSeq:0,chainSeq:0,chainBlockSeq:0,procSeq:0});c(this,"_currentStartPoints",{turn:0,phaseSeq:0,stepSeq:0,stageSeq:0,chainSeq:0,chainBlockSeq:0,procSeq:0});c(this,"setPhase",(e,i)=>{const a=Object.values(ht).filter(r=>r.phase===i).find(r=>(r.step??"start")==="start");if(!a)throw new S("æƒ³å®šã•ã‚Œãªã„çŠ¶æ…‹",this.period,i,ht);i==="draw"?(this.turn>0&&e.log.info("ã‚¿ãƒ¼ãƒ³çµ‚äº†ã€‚",e.getTurnPlayer()),this._turn++,this._phaseSeq=0):(e.log.info(`ãƒ•ã‚§ã‚¤ã‚ºç§»è¡Œï¼ˆ${this.period.name}â†’${a.name}ï¼‰`,e.getTurnPlayer()),this._phaseSeq++),this._stepSeq=0,this._stageSeq=0,this.periodKey=a.key});c(this,"setStep",(e,i)=>{const a=this.period.phase,r=Object.values(ht).filter(n=>n.phase===a).find(n=>(n.step??"")===i);if(!r)throw new S("æƒ³å®šã•ã‚Œãªã„çŠ¶æ…‹",this.period,i,ht);this.period.name!==r.name&&(e.log.info(`ã‚¹ãƒ†ãƒƒãƒ—ç§»è¡Œï¼ˆ${this.period.name}â†’${r.name}ï¼‰`,e.getTurnPlayer()),this._stepSeq++,this._stageSeq=0,this.periodKey=r.key)});c(this,"setStage",(e,i)=>{const a=this.period,r=Object.values(ht).filter(n=>n.phase===a.phase).filter(n=>n.step===a.step).find(n=>(n.stage??"")===i);if(!r)throw new S("æƒ³å®šã•ã‚Œãªã„çŠ¶æ…‹",this.period,i,ht);e.log.info(`ã‚¿ã‚¤ãƒŸãƒ³ã‚°ç§»è¡Œï¼ˆ${this.period.name}â†’${r.name}ï¼‰`,e.getTurnPlayer()),this._stageSeq++,this.periodKey=r.key});c(this,"incrementChainSeq",()=>{this._chainSeq++,this._chainBlockSeq=0,this._procSeq=0,this.incrementTotalProcSeq()});c(this,"incrementChainBlockSeq",()=>{this._chainBlockSeq++,this._procSeq=0,this.incrementTotalProcSeq()});c(this,"incrementProcSeq",()=>{this._procSeq++,this.incrementTotalProcSeq()});c(this,"incrementTotalProcSeq",()=>{this._totalProcSeq++;let e=!0;Ha.toReversed().forEach(i=>{e&&(this._previousStartPoints[i]=this.currentStartPoints[i],this._currentStartPoints[i]=this.totalProcSeq),e=e&&this[i]===0}),Ha.toReversed().filter(i=>this._currentStartPoints[i]===this.totalProcSeq).filter(i=>i!=="procSeq").forEach(i=>this.onClockChangeEvents[i].trigger(this)),this.onClockChangeEvents.procSeq.trigger(this)});c(this,"toFullString",()=>`${this.totalProcSeq}(t${this.turn}-phs${this.phaseSeq}-stp${this.stepSeq}-stg${this.stepSeq}-c${this.chainSeq}-cb${this.chainBlockSeq}-prc${this.procSeq})`);c(this,"getClone",()=>({turn:this.turn,phaseSeq:this.phaseSeq,stepSeq:this.stepSeq,stageSeq:this.stageSeq,chainSeq:this.chainSeq,chainBlockSeq:this.chainBlockSeq,procSeq:this.procSeq,totalProcSeq:this.totalProcSeq,period:this.period}));c(this,"isSameTurn",e=>this.turn===e.turn);c(this,"isSameChain",e=>Yi.isSameChain(this,e));c(this,"isPreviousChain",e=>this.turn===e.turn&&this.phaseSeq===e.phaseSeq&&this.stepSeq===e.stepSeq&&this.stageSeq===e.stageSeq&&this.chainSeq===e.chainSeq+1);c(this,"isPreviousStage",e=>this.turn===e.turn&&this.phaseSeq===e.phaseSeq&&this.stepSeq===e.stepSeq&&this.stageSeq===e.stageSeq+1);c(this,"isPreviousTurn",e=>this.turn===e.turn+1);c(this,"isPreviousProc",e=>this.totalProcSeq===e.totalProcSeq+1);this._periodKey="end"}get onTurnChange(){return this.onClockChangeEvents.turn.expose()}get onStageChange(){return this.onClockChangeEvents.stageSeq.expose()}get onProcSeqChange(){return this.onClockChangeEvents.procSeq.expose()}get previousStartPoints(){return this._previousStartPoints}get currentStartPoints(){return this._currentStartPoints}set periodKey(e){this._periodKey!==e&&(this._periodKey=e,this._chainSeq=0,this._chainBlockSeq=0,this._procSeq=0,this.incrementTotalProcSeq())}get periodKey(){return this._periodKey}get period(){return ht[this.periodKey]}get turn(){return this._turn}get phaseSeq(){return this._phaseSeq}get stepSeq(){return this._stepSeq}get stageSeq(){return this._stageSeq}get chainSeq(){return this._chainSeq}get chainBlockSeq(){return this._chainBlockSeq}get procSeq(){return this._procSeq}get totalProcSeq(){return this._totalProcSeq}get isFirstChain(){return this.chainSeq===0}};c(Yi,"isSameChain",(e,i)=>e.turn===i.turn&&e.phaseSeq===i.phaseSeq&&e.stepSeq===i.stepSeq&&e.stageSeq===i.stageSeq&&e.chainSeq===i.chainSeq);let Za=Yi;class nd{constructor(e){c(this,"onInsertEvent",new V);c(this,"nextSeq");c(this,"records",[]);c(this,"duel");c(this,"push",e=>{const i={seq:this.nextSeq++,clock:this.duel.clock.getClone(),chainBlockInfo:e};this.records.push(i),this.onInsertEvent.trigger(i)});this.nextSeq=0,this.duel=e}get onInsert(){return this.onInsertEvent.expose()}}class gi{constructor(e,i){c(this,"duel");c(this,"phase");c(this,"_priorityHolder");c(this,"turnPlayer");c(this,"_chainBlockInfos",[]);c(this,"proceed",async()=>await this._proceed());c(this,"procSpellSpeed1",async()=>{this.priorityHolder=this.turnPlayer;let e=0;const i={Above:Number.MAX_VALUE,Below:Number.MAX_VALUE};for(;;){const a=this.priorityHolder.getEnableActions(["IgnitionEffect","QuickEffect","CardActivation","LingeringEffect"],["Normal","Quick","Counter"],[]);if(i[this.priorityHolder.seat]=a.filter(l=>l.action.isMandatory).length,Object.values(i).every(l=>l===0)&&e>1)break;const r=a.find(l=>l.action.isMandatory);let n=r?{action:r.action,originSeq:r.action.seq}:void 0,s=!n;if(this.priorityHolder.isTurnPlayer?e===0&&(s=!0):i[this.turnPlayer.seat]&&(s=!0),a.length&&(a.length>1||!n)&&(this.priorityHolder.chainConfig.noticeFreeChain||a.some(l=>l.action.isNoticedForcibly))&&(n=await this.duel.view.waitQuickEffect(this.priorityHolder,a,[],this.duel.clock.period.name,s)),n){if(await this.procChain({activator:this.priorityHolder,actionInfo:n},void 0)==="cancel")continue;if(!await this.procFreeChain())return!1;this.priorityHolder=this.turnPlayer,e=0;continue}this.priorityHolder=this.priorityHolder.getOpponentPlayer(),e++}return!0});c(this,"procFreeChain",async(e=()=>!0)=>{const i=this.duel.clock.period.key;for(;await this.procChain(void 0,void 0)!=="pass";)if(this.duel.clock.period.key!==i||!e())return!1;return!0});c(this,"procTriggerEffects",async()=>{for(;await this.procChain(void 0,void 0,!0)==="done";);});c(this,"procChain",async(e,i,a)=>{const r=this.chainBlockInfos.length===0;let n=e?[]:i??Object.values(this.duel.duelists).flatMap(l=>l.getEnableActions(["TriggerEffect"],[this.chainBlockInfos.length?"Quick":"Normal"],this.chainBlockInfos).map(o=>({activator:l,actionInfo:o,targetChainBlock:this.chainBlockInfos.slice(-1)[0]}))),s;if(e)s={activator:e.activator,action:e.actionInfo.action,dest:e.actionInfo.dest,targetChainBlock:void 0},this.priorityHolder=s.activator;else if(n.length>0){const l=await this.selectTriggerEffect(n);l?(n=n.filter(o=>o!==l),s={...l,action:l.actionInfo.action},this.priorityHolder=s.activator):n=[]}if(!s){if(a)return"pass";let l=0;for(;l<2;){this.priorityHolder=this.priorityHolder.getOpponentPlayer();const o=["Counter"];this.chainBlockInfos.every(f=>f.action.spellSpeed!=="Counter")&&o.push("Quick");let d=this.priorityHolder.getEnableActions(["QuickEffect","CardActivation"],o,this.chainBlockInfos).some(f=>f.action.isNoticedForcibly)||!!this.attackingMonster;if(d||(this.chainBlockInfos.length?d=this.priorityHolder.chainConfig.noticeSelfChain||this.chainBlockInfos.slice(-1)[0].activator!==this.priorityHolder:d=this.priorityHolder.chainConfig.noticeFreeChain),d){const f=this.chainBlockInfos.some(h=>h.action.isWithChainBlock)?"ãƒã‚§ãƒ¼ãƒ³ã—ã¦åŠ¹æžœã‚’ç™ºå‹•ã—ã¾ã™ã‹ï¼Ÿ":"ã‚¯ã‚¤ãƒƒã‚¯ã‚¨ãƒ•ã‚§ã‚¯ãƒˆç™ºå‹•ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã€‚åŠ¹æžœã‚’ç™ºå‹•ã—ã¾ã™ã‹ï¼Ÿ",p=await this.duel.view.waitQuickEffect(this.priorityHolder,this.priorityHolder.getEnableActions(["QuickEffect","CardActivation"],o,this.chainBlockInfos),this.chainBlockInfos,f,!0);if(p){s={...p,activator:this.priorityHolder,targetChainBlock:this.chainBlockInfos.slice(-1)[0]};break}}l++}}if(console.info("selected action: ",s),s){const l=s.activator,o=await s.action.prepare(l,s.dest,s.targetChainBlock,this.chainBlockInfos,r,!1);if(!o)return"cancel";if(this.duel.chainBlockLog.push(o),this._chainBlockInfos.push(o),this.duel.clock.incrementProcSeq(),this.duel.clock.incrementChainBlockSeq(),n=n.filter(u=>u.actionInfo.action.seq!==(s==null?void 0:s.action.seq)).filter(u=>u.actionInfo.action.validateCount(u.activator,this.chainBlockInfos)),o.action.isChainable&&await this.procChain(void 0,n.length?n:void 0),await o.action.execute(o,this.chainBlockInfos),o.state==="done"||o.state==="failed")for(const u of[this.turnPlayer,this.nonTurnPlayer]){for(const d of u.getEnableActions(["Exodia"],["Normal"],[o]))await d.action.directExecute(u,o,!1);for(const d of u.getEnableActions(["AfterChainBlock"],["Normal"],[o])){await d.action.directExecute(u,o,!1);for(const f of u.getEnableActions(["Exodia"],["Normal"],[o]))await f.action.directExecute(u,o,!1)}}r?(await _.sendManyToGraveyardForTheSameReason(this._chainBlockInfos.filter(u=>u.action.playType==="CardActivation").filter(u=>!u.action.isLikeContinuousSpell).map(u=>u.action.entity).filter(u=>u.isOnFieldStrictly).filter(u=>u.face==="FaceUp"),["Rule"],void 0,void 0),this._chainBlockInfos.reset(),o.nextActionInfo&&await this.procChain({activator:o.activator,actionInfo:o.nextActionInfo},void 0),this.duel.clock.incrementChainSeq()):(o.nextActionInfo&&await o.nextActionInfo.action.directExecute(o.activator,void 0,!1),this.duel.clock.incrementChainBlockSeq())}return s?"done":"pass"});c(this,"selectTriggerEffect",async e=>{if(e.length>0)for(const i of[!0,!1])for(const a of[this.turnPlayer,this.nonTurnPlayer]){const r=e.filter(s=>s.actionInfo.action.isMandatory===i&&s.activator===a);if(r.length===0)continue;if(r.length===1&&i)return r[0];const n=await this.duel.view.waitQuickEffect(a,r.map(s=>s.actionInfo),this.chainBlockInfos,"ãƒˆãƒªã‚¬ãƒ¼ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã‚’é¸æŠžã€‚",!i);if(n)return r.find(s=>s.actionInfo.action===n.action)}});this.duel=e,this.phase=i,this.duel.clock.setPhase(this.duel,this.phase),this.turnPlayer=this.duel.getTurnPlayer(),this._priorityHolder=this.turnPlayer}set priorityHolder(e){this._priorityHolder=e}get priorityHolder(){return this._priorityHolder}get nonTurnPlayer(){return this.turnPlayer.getOpponentPlayer()}get chainBlockInfos(){return this._chainBlockInfos}}class sd extends gi{constructor(i,a){super(i,a);c(this,"_attackingMonster");c(this,"_targetForAttack");c(this,"declareAttack",(i,a,r=!1)=>{var l;this._attackingMonster=i,this._targetForAttack=a;let n=" ("+((l=a.battlePosition==="Attack"?a.atk:a.def)==null?void 0:l.toString())+")";a.face==="FaceDown"&&(n=" (????)"),a.entityType==="Duelist"&&(n="");const s=r?"æ”»æ’ƒå¯¾è±¡å†é¸æŠž":"æ”»æ’ƒå®£è¨€";r||i.info.attackDeclareCount++,this.duel.log.info(`${s}:${i.toString()} (${i.atk})â‡’ ${a.toString()}${n}`,i.controller)});c(this,"_proceed",async()=>(await this.procBattlePhaseStartStep()&&await this.procBattlePhaseBattleStep(),await this.procBattlePhaseEndStep(),new Kn(this.duel,"main2")));c(this,"procBattlePhaseStartStep",async()=>(this.setStep("start"),this.priorityHolder=this.turnPlayer,this._attackingMonster=void 0,this._targetForAttack=void 0,await this.procSpellSpeed1()));c(this,"procBattlePhaseBattleStep",async()=>{for(;;){this.setStep("battle"),this.priorityHolder=this.turnPlayer,this._attackingMonster=void 0,this._targetForAttack=void 0;const i=await this.duel.view.waitFieldAction(this.priorityHolder.getEnableActions(["DeclareAttack","QuickEffect","CardActivation"],["Normal","Quick","Counter"],[]));if(i.phaseChange)break;if(!(!i.actionInfo||await this.procChain({activator:this.priorityHolder,actionInfo:i.actionInfo},void 0)==="cancel")){if(!this.attackingMonster||!this.targetForAttack){await this.procTriggerEffects();continue}for(;this.attackingMonster&&this.targetForAttack;){const r=this.duel.clock.totalProcSeq,n=this.nonTurnPlayer.getMonstersOnField(),s=await this.procChain(void 0,void 0);if(await this.procTriggerEffects(),!this.attackingMonster)throw new S("æƒ³å®šã•ã‚Œãªã„çŠ¶æ…‹");if(!this.canContinueBattle())break;const l=this.attackingMonster.getAttackTargets();if(n.some(o=>!o.isOnFieldAsMonsterStrictly)||this.nonTurnPlayer.getMonstersOnField().flatMap(o=>o.moveLog.records).filter(o=>o.movedAt.totalProcSeq>r).some(o=>!o.cell.isMonsterZoneLikeCell)?(this.duel.log.info("ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã®æ•°ãŒå¢—æ¸›ã—ãŸãŸã‚ãƒãƒˆãƒ«ã‚¹ãƒ†ãƒƒãƒ—ã®å·»ãæˆ»ã—ãŒç™ºç”Ÿã€‚"),this._targetForAttack=void 0):this.targetForAttack.entityType==="Duelist"&&l.every(o=>o!==this.targetForAttack)&&!this.attackingMonster.status.canDirectAttack&&(this.duel.log.info(`${this.attackingMonster.toString()}ãŒç›´æŽ¥æ”»æ’ƒèƒ½åŠ›ã‚’å–ªå¤±ã—ãŸãŸã‚ã€ãƒãƒˆãƒ«ã‚¹ãƒ†ãƒƒãƒ—ã®å·»ãæˆ»ã—ãŒç™ºç”Ÿã€‚`),this._targetForAttack=void 0),!this.targetForAttack){if(!l.length){this.duel.log.info("æ”»æ’ƒå¯èƒ½ãªå¯¾è±¡ãŒå­˜åœ¨ã—ãªã„ãŸã‚ã€æ”»æ’ƒå¯¾è±¡é¸æŠžã‚’é¸æŠžè‚¢ã—ãªãŠã›ãªã„ã€‚");break}if(this.turnPlayer.duelistType==="Player"&&!await this.duel.view.waitYesOrNo(this.turnPlayer,"æ”»æ’ƒå¯¾è±¡é¸æŠžã‚’é¸æŠžã—ç›´ã™ï¼Ÿ")){this.turnPlayer.writeInfoLog(`${this.attackingMonster.toString()}ã®æ”»æ’ƒå®£è¨€ã‚’ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã€‚`);break}const o=await this.turnPlayer.waitSelectEntity(l,"æ”»æ’ƒå¯¾è±¡ã‚’é¸æŠžã€‚",!0);if(!o){this.turnPlayer.writeInfoLog(`${this.attackingMonster.toString()}ã®æ”»æ’ƒå®£è¨€ã‚’ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã€‚`);break}this.declareAttack(this.attackingMonster,o,!0);continue}if(s==="pass")break}this.attackingMonster&&this.targetForAttack&&await this.procBattlePhaseDamageStep()}}});c(this,"procBattlePhaseDamageStep",async()=>{if(!this.attackingMonster||!this.targetForAttack)throw new S("æƒ³å®šã•ã‚Œãªã„çŠ¶æ…‹",this.attackingMonster,this.targetForAttack);if(this.targetForAttack.entityType!=="Duelist"&&!this.targetForAttack.isOnFieldAsMonsterStrictly)throw new S("æƒ³å®šã•ã‚Œãªã„çŠ¶æ…‹",this.attackingMonster,this.targetForAttack);for(const i of[this.procBattlePhaseDamageStep1,this.procBattlePhaseDamageStep2,this.procBattlePhaseDamageStep3,this.procBattlePhaseDamageStep4,this.procBattlePhaseDamageStep5])if(!await i())return});c(this,"procBattlePhaseDamageStep1",async()=>(this.setStage("start"),await this.procFreeChain(this.canContinueBattle)));c(this,"procBattlePhaseDamageStep2",async()=>{if(!this.attackingMonster)throw new S("æƒ³å®šã•ã‚Œãªã„çŠ¶æ…‹",this.attackingMonster);if(!this.targetForAttack)throw new S("æƒ³å®šã•ã‚Œãªã„çŠ¶æ…‹",this.targetForAttack);const i=this.attackingMonster,a=this.targetForAttack;return this.setStage("beforeDmgCalc"),a.battlePosition==="Set"&&a.setBattlePosition("Defense",["Flip","Battle"],i,i.controller),await this.procFreeChain(this.canContinueBattle)});c(this,"procBattlePhaseDamageStep3",async()=>{if(!this.attackingMonster)throw new S("æƒ³å®šã•ã‚Œãªã„çŠ¶æ…‹",this.attackingMonster);if(!this.targetForAttack)throw new S("æƒ³å®šã•ã‚Œãªã„çŠ¶æ…‹",this.targetForAttack);const i=this.attackingMonster,a=this.targetForAttack;if(i.atk===void 0)throw new S("æƒ³å®šã•ã‚Œãªã„çŠ¶æ…‹",this.attackingMonster,this.targetForAttack);if(this.setStage("dmgCalc"),!await this.procFreeChain(this.canContinueBattle))return!1;const r=i.atk,n=(a.battlePosition==="Attack"?a.atk:a.def)??0,s=this.turnPlayer,l=i.actions.find(d=>d.playType==="Battle");if(!l)throw new S(`${i.toString()}ã«æˆ¦é—˜ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãŒå®šç¾©ã•ã‚Œã¦ã„ãªã„ã€‚`);const o=await l.prepare(s,a.cell,void 0,[],!1,!1);if(!o)throw new F("æˆ¦é—˜ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãŒã‚­ãƒ£ãƒ³ã‚»ãƒ«ã•ã‚ŒãŸã€‚");if(this.duel.chainBlockLog.push(o),a.entityType==="Duelist")s.writeInfoLog(`ãƒ€ãƒ¡ãƒ¼ã‚¸è¨ˆç®—ï¼š${i.toString()} (${r}) â‡’ ${a.toString()}`),i.controller.getOpponentPlayer().battleDamage(r-n,i,a,o);else{s.writeInfoLog(`ãƒ€ãƒ¡ãƒ¼ã‚¸è¨ˆç®—ï¼š${i.toString()} (${r}) â‡’ ${a.toString()} (${n})`),r>0&&r>n?a.battlePosition==="Attack"?i.controller.getOpponentPlayer().battleDamage(r-n,i,a,o):i.status.piercingTo.getDistinct().forEach(f=>f.battleDamage(r-n,i,a,o)):r<n&&i.controller.battleDamage(n-r,a,i,o);const d=[];r>0&&(r>n||r===n&&a.battlePosition==="Attack")&&d.push(a),a.battlePosition==="Attack"&&r<=n&&d.push(i),await _.tryMarkForDestroy(d,o)}o.state=r>n?"done":"failed",i.info.battleLog.push({enemy:a,timestamp:this.duel.clock.getClone()}),a.info.battleLog.push({enemy:i,timestamp:this.duel.clock.getClone()});const u=Object.values(this.duel.duelists).filter(d=>d.lp<=0);if(u.length)throw u.length===1?new re(u[0].getOpponentPlayer(),`æˆ¦é—˜ãƒ€ãƒ¡ãƒ¼ã‚¸ã«ã‚ˆã£ã¦ã€${u[0].name}ã®ãƒ©ã‚¤ãƒ•ãƒã‚¤ãƒ³ãƒˆãŒã‚¼ãƒ­ã«ãªã£ãŸã€‚`):new re(void 0,"æˆ¦é—˜ãƒ€ãƒ¡ãƒ¼ã‚¸ã«ã‚ˆã£ã¦ã€ãŠäº’ã„ã®ãƒ©ã‚¤ãƒ•ãƒã‚¤ãƒ³ãƒˆãŒã‚¼ãƒ­ã«ãªã£ãŸã€‚");return!0});c(this,"procBattlePhaseDamageStep4",async()=>(this.setStage("afterDmgCalc"),!!await this.procFreeChain()));c(this,"procBattlePhaseDamageStep5",async()=>(this.setStage("end"),await _.waitCorpseDisposal(this.duel),this.duel.clock.incrementChainSeq(),!!await this.procFreeChain()));c(this,"procBattlePhaseEndStep",async()=>{this.setStep("end"),this.priorityHolder=this.turnPlayer,await this.procSpellSpeed1()});c(this,"canContinueBattle",()=>this.attackingMonster?(this.attackingMonster.isOnFieldStrictly?this.attackingMonster.face==="FaceDown"?(this.duel.log.info(`${this.attackingMonster.toString()}ãŒè£å´å®ˆå‚™è¡¨ç¤ºã«ãªã£ãŸãŸã‚ã€æˆ¦é—˜ãŒä¸­æ–­ã•ã‚ŒãŸã€‚`),this._attackingMonster=void 0):this.attackingMonster.orientation==="Horizontal"&&(this.duel.log.info(`${this.attackingMonster.toString()}ãŒå®ˆå‚™è¡¨ç¤ºã«ãªã£ãŸãŸã‚ã€æˆ¦é—˜ãŒä¸­æ–­ã•ã‚ŒãŸã€‚`),this._attackingMonster=void 0):(this.duel.log.info(`${this.attackingMonster.toString()}ãŒãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«å­˜åœ¨ã—ãªããªã£ãŸã‚ã€æˆ¦é—˜ãŒä¸­æ–­ã•ã‚ŒãŸã€‚`),this._attackingMonster=void 0),!!this.attackingMonster):!1);c(this,"setStep",i=>{this.duel.clock.setStep(this.duel,i)});c(this,"setStage",i=>{this.duel.clock.setStage(this.duel,i)})}get nextPhaseList(){return["main2"]}get attackingMonster(){return this._attackingMonster}get targetForAttack(){return this._targetForAttack}}class Kn extends gi{constructor(i,a){super(i,a);c(this,"declareAttack",()=>{throw new S(`ãƒãƒˆãƒ«ãƒ•ã‚§ã‚¤ã‚ºä»¥å¤–ã§æ”»æ’ƒå®£è¨€ã‚’å®Ÿè¡Œã—ãŸã€‚${this.duel.clock.period.key}`)});c(this,"_proceed",async()=>{for(;;){this.priorityHolder=this.turnPlayer;const i=await this.duel.view.waitFieldAction(this.priorityHolder.getEnableActions(["NormalSummon","SpellTrapSet","SpecialSummon","FlipSummon","ChangeBattlePosition","IgnitionEffect","QuickEffect","CardActivation","LingeringEffect"],["Normal","Quick","Counter"],[]));if(i.actionInfo){if(await this.procChain({activator:this.priorityHolder,actionInfo:i.actionInfo},void 0)==="cancel")continue;await this.procFreeChain();continue}const a=i.phaseChange;if(a){this.priorityHolder=this.nonTurnPlayer;let r="done";for(;;){const n=await this.duel.view.waitQuickEffect(this.priorityHolder,this.priorityHolder.getEnableActions(["QuickEffect","CardActivation"],["Quick","Counter"],[]),[],"ç›¸æ‰‹ãŒãƒ•ã‚§ã‚¤ã‚ºã‚’çµ‚äº†ã—ã‚ˆã†ã¨ã—ã¦ã„ã‚‹ã€‚",!0);if(n&&(r=await this.procChain({activator:this.priorityHolder,actionInfo:n},void 0),r==="done")){await this.procTriggerEffects();break}return a==="battle1"?new sd(this.duel,a):new Yn(this.duel)}if(r==="done"){await this.procFreeChain();continue}}}})}get nextPhaseList(){return this.duel.phase==="main1"&&this.duel.clock.turn>1?["battle1","end"]:["end"]}get attackingMonster(){}get targetForAttack(){}}class ld extends gi{constructor(i){super(i,"standby");c(this,"declareAttack",()=>{throw new S(`ãƒãƒˆãƒ«ãƒ•ã‚§ã‚¤ã‚ºä»¥å¤–ã§æ”»æ’ƒå®£è¨€ã‚’å®Ÿè¡Œã—ãŸã€‚${this.duel.clock.period.key}`)});c(this,"_proceed",async()=>(await this.procSpellSpeed1(),new Kn(this.duel,"main1")))}get nextPhaseList(){return["main1"]}get attackingMonster(){}get targetForAttack(){}}class od extends gi{constructor(i){super(i,"draw");c(this,"declareAttack",()=>{throw new S(`ãƒãƒˆãƒ«ãƒ•ã‚§ã‚¤ã‚ºä»¥å¤–ã§æ”»æ’ƒå®£è¨€ã‚’å®Ÿè¡Œã—ãŸã€‚${this.duel.clock.period.key}`)});c(this,"_proceed",async()=>{if(Object.values(this.duel.duelists).forEach(i=>i.initForDrawPhase()),this.turnPlayer.writeInfoLog("ãƒ‰ãƒ­ãƒ¼ãƒ•ã‚§ã‚¤ã‚ºé–‹å§‹ã€‚"),this.duel.clock.turn===1)this.turnPlayer.writeInfoLog("å…ˆæ”»ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã¯ãƒ‰ãƒ­ãƒ¼ã§ããªã„ã€‚");else{await this.turnPlayer.draw(1,void 0,void 0);for(const i of this.turnPlayer.getEnableActions(["Exodia"],["Normal"],[]))await i.action.directExecute(this.turnPlayer,void 0,!1)}return this.duel.field.getCardsOnFieldStrictly().forEach(i=>i.initForTurn()),await this.procSpellSpeed1(),new ld(this.duel)})}get nextPhaseList(){return["standby"]}get attackingMonster(){}get targetForAttack(){}}class Yn extends gi{constructor(i){super(i,"end");c(this,"declareAttack",()=>{throw new S(`ãƒãƒˆãƒ«ãƒ•ã‚§ã‚¤ã‚ºä»¥å¤–ã§æ”»æ’ƒå®£è¨€ã‚’å®Ÿè¡Œã—ãŸã€‚${this.duel.clock.period.key}`)});c(this,"_proceed",async()=>{for(await this.procSpellSpeed1();;){const a=this.turnPlayer.getHandCell().cardEntities.length;if(a<7)break;await this.turnPlayer.discard(a-6,"Rule")}return this.turnPlayer.writeInfoLog("ã‚¿ãƒ¼ãƒ³çµ‚äº†ã€‚"),new od(this.duel)})}get nextPhaseList(){return["draw"]}get attackingMonster(){}get targetForAttack(){}}const cd=["PlayFirst","DrawFirst","Random"],lg={PlayFirst:"å…ˆæ”»",DrawFirst:"å¾Œæ”»",Random:"ãƒ©ãƒ³ãƒ€ãƒ "};class re extends Error{constructor(i,a){super(i?`ãƒ‡ãƒ¥ã‚¨ãƒ«ãŒçµ‚äº†ã—ãŸã€‚å‹è€…ï¼š${i.profile.name}`:"ãƒ‡ãƒ¥ã‚¨ãƒ«ãŒçµ‚äº†ã—ãŸã€‚ãƒ‰ãƒ­ãƒ¼ã€‚");c(this,"winner");c(this,"message");this.winner=i,this.message=a}}class S extends Error{constructor(i,...a){super(i);c(this,"message");c(this,"items");this.message=i,this.items=a}}class F extends S{constructor(...e){super("ã‚­ãƒ£ãƒ³ã‚»ãƒ«ä¸å¯ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãŒã‚­ãƒ£ãƒ³ã‚»ãƒ«ã•ã‚ŒãŸã€‚",...e)}}class og{constructor(e,i,a,r=[],n,s,l,o=[],u="Random"){c(this,"onDuelEndEvent",new V);c(this,"view");c(this,"log");c(this,"chainBlockLog");c(this,"field");c(this,"clock");c(this,"duelists");c(this,"_facilitator");c(this,"isEnded");c(this,"winner");c(this,"reasonOfEnd","");c(this,"coin",!1);c(this,"startMode");c(this,"declareAttack",(...e)=>this._facilitator.declareAttack(...e));c(this,"getTurnPlayer",()=>this.clock.turn%2===0?this.secondPlayer:this.firstPlayer);c(this,"getNonTurnPlayer",()=>this.clock.turn%2===0?this.firstPlayer:this.secondPlayer);c(this,"main",async()=>{console.info("main start!"),this.coin=this.startMode==="PlayFirst"?!0:this.startMode==="DrawFirst"?!1:Math.random()>.5;const e=Ep(...Object.values(this.duelists).flatMap(i=>i.deckInfo.cardNames).getDistinct()).reduce((i,a)=>(i[a.name]=a,{...i}),{});for(const i of Object.values(this.duelists))i.pushDeck(e),i.getDeckCell().shuffle(),i.initHand.length&&i.initHand.forEach(a=>{const r=i.getDeckCell().cardEntities.find(n=>n.origin.name===a);if(!r){this.log.info(`åˆæ‰‹æ“ä½œã«ã‚ˆã‚Š${a}ã‚’æ‰‹æœ­ã«åŠ ãˆã‚ˆã†ã¨ã—ãŸãŒã€ãƒ‡ãƒƒã‚­ã«å­˜åœ¨ã—ãªã„ã€‚`);return}r.addToHand(["System"],void 0,void 0),this.log.info(`åˆæ‰‹æ“ä½œã«ã‚ˆã‚Š${r.toString()}ã‚’æ‰‹æœ­ã«åŠ ãˆãŸ`,i)}),await i.draw(5-i.getHandCell().cardEntities.length,void 0,void 0);this.log.info(`ã€ãƒ‡ãƒ¥ã‚¨ãƒ«é–‹å§‹ã€‘${this.firstPlayer.profile.name} V.S. ${this.secondPlayer.profile.name}`),this.log.info(`å…ˆæ”»ï¼š${this.firstPlayer.profile.name} å¾Œæ”»ï¼š${this.secondPlayer.profile.name}`);try{for(const i of Object.values(this.duelists))for(const a of i.getEnableActions(["Exodia"],["Normal"],[]))await a.action.directExecute(i,void 0,!1);for(;!this.isEnded&&(this._facilitator=await this._facilitator.proceed(),!(this.clock.turn>1e3)););}catch(i){i instanceof re?(this.chainBlockLog.records.forEach(a=>{a.chainBlockInfo.state==="ready"?a.chainBlockInfo.state="failed":a.chainBlockInfo.state==="processing"&&(a.chainBlockInfo.state="done")}),this.clock.incrementChainSeq(),console.info(i),this.isEnded=!0,this.winner=i.winner,this.reasonOfEnd=i.message,this.log.info(i.winner?`ãƒ‡ãƒ¥ã‚¨ãƒ«çµ‚äº†ã€‚å‹è€…${i.winner.profile.name}ã€‚${i.message}`:`ãƒ‡ãƒ¥ã‚¨ãƒ«çµ‚äº†ã€‚å¼•ãåˆ†ã‘ã€‚${i.message}`),this.view.requireUpdate(),this.onDuelEndEvent.trigger()):i instanceof Error&&this.log.error(i)}finally{this.log.dispose()}});c(this,"executeSystemPeriodActions",()=>{Object.values(this.duelists).forEach(e=>e.getEnableActions(["SystemPeriodAction"],["Normal"],[]))});this.clock=new Za,this.isEnded=!1,this.startMode=u,this.duelists={Below:new $i(this,"Below",e,i,a,r),Above:new $i(this,"Above",n,s,l,o)},this.field=new du(this),this.clock.onStageChange.append(this.executeSystemPeriodActions),this.view=new rd(this),this.log=new pu(this),this.chainBlockLog=new nd(this),this._facilitator=new Yn(this)}get onDuelEnd(){return this.onDuelEndEvent.expose()}get phase(){return this.clock.period.phase}get step(){return this.clock.period.step}get stage(){return this.clock.period.stage}get nextPhaseList(){return this.facilitator.nextPhaseList}get chainBlockInfos(){return this.facilitator.chainBlockInfos}get attackingMonster(){return this.facilitator.attackingMonster}get targetForAttack(){return this.facilitator.targetForAttack}get firstPlayer(){return this.coin?this.duelists.Below:this.duelists.Above}get secondPlayer(){return this.coin?this.duelists.Above:this.duelists.Below}get facilitator(){return this._facilitator}}const cg=["FtkChallenge","Free"],ug=["Normal","Hard"],we=class we{constructor(e){c(this,"id");c(this,"name");c(this,"description");c(this,"chainConfig");c(this,"previousGameMode");c(this,"previousNpcId");c(this,"previousNpcDeckId");c(this,"previousStartMode");c(this,"previousDifficulty");c(this,"npcLvl",Number.MAX_VALUE);c(this,"npcType","None");c(this,"save",async e=>{const i={id:this.id,name:this.name,description:this.description,chainConfig:this.chainConfig??{noticeSelfChain:!1,noticeFreeChainPhase:!1,noticeFreeChainStep:!1,noticeAfterChainInMainPhase:!1},previousGameMode:this.previousGameMode??"Preset",previousNpcId:this.previousNpcId??Number.MIN_SAFE_INTEGER,previousStartMode:this.previousStartMode,previousNpcDeckId:this.previousNpcDeckId>-1?this.previousNpcDeckId:Number.MIN_SAFE_INTEGER,...e},a=await we.tblHeader.update(this.id,r=>({...r,...i}));return console.log(this.previousNpcDeckId,Number.MIN_SAFE_INTEGER,i,a),new we(a)});var i;this.id=e.id,this.name=e.name,this.description=e.description,this.chainConfig=e.chainConfig,this.previousGameMode=e.previousGameMode,this.previousNpcId=((i=Zr.find(a=>a.id===e.previousNpcId))==null?void 0:i.id)??Zr.map(a=>a.id).min()??0,this.previousStartMode=cd.includes(e.previousStartMode)?e.previousStartMode:"Random",this.previousNpcDeckId=e.previousNpcDeckId,this.previousDifficulty=e.previousDifficulty}};c(we,"tblHeader"),c(we,"getOrCreateNew",async e=>{we.tblHeader||(we.tblHeader=new ud(e));const i=await we.tblHeader.getAll();if(i.length){let r=i[0];return r.chainConfig||(r={...r,chainConfig:{noticeSelfChain:!1,noticeFreeChain:!1}}),new we(r)}const a=await we.tblHeader.insert({name:"ã‚ãªãŸ",description:"ã“ã“ã®æ–‡å­—åˆ—ã‚’ä½•ã«ä½¿ã†ã‹ã¯æœªå®šã€‚",chainConfig:{noticeSelfChain:!1,noticeFreeChain:!1},previousGameMode:"FtkChallenge",previousDifficulty:"Normal",previousNpcId:0,previousNpcDeckId:Number.MIN_SAFE_INTEGER,previousStartMode:"Random"});return new we(a)});let Hr=we;class ud extends rr{constructor(i){super(i,"TblDuelistProfile");c(this,"_prepareInitialRecords",()=>[])}}let Ta=-1;const Zr=[{id:Ta--,name:"ã‚µãƒ³ãƒ‰ãƒãƒƒã‚°ãã‚“æ£’ç«‹ã¡",description:"æ”»æ’ƒå®£è¨€ãªã—ã€å¼·åˆ¶åŠ¹æžœä»¥å¤–ã®åŠ¹æžœã®ç™ºå‹•ãªã—ã€‚",npcLvl:0,npcType:"Normal"},{id:Ta--,name:"ã‚µãƒ³ãƒ‰ãƒãƒƒã‚°ãã‚“éžæš´åŠ›",description:"æ”»æ’ƒå®£è¨€ãªã—ã€‚",npcLvl:100,npcType:"Normal"},{id:Ta--,name:"ã‚µãƒ³ãƒ‰ãƒãƒƒã‚°ãã‚“ç™½å¸¯",description:"ã¨ãã«åˆ¶é™ãªã—ã€‚",npcLvl:200,npcType:"Normal"},{id:Number.MIN_SAFE_INTEGER,name:"FTK or Die",description:"FTKã«å¤±æ•—ã™ã‚‹ã¨æ•—åŒ—ã€‚",npcLvl:Number.MIN_SAFE_INTEGER,npcType:"FtkChallenge",difficulty:"Normal"},{id:Number.MIN_SAFE_INTEGER+1,name:"FTK or Die[HARD]",description:"FTKã«å¤±æ•—ã™ã‚‹ã¨æ•—åŒ—ã€‚æ‰‹æœ­èª˜ç™ºã‚ã‚Šã€‚",npcLvl:Number.MAX_SAFE_INTEGER,npcType:"FtkChallenge",difficulty:"Hard"}],dd=(t,e)=>Array.from({length:e-t},(i,a)=>t+a);Array.prototype.shuffle=function(){return this.map(e=>({item:e,seq:Math.random()})).toSorted((e,i)=>e.seq-i.seq).map(e=>e.item)};Array.prototype.randomPickMany=function(t){return this.shuffle().slice(0,t)};Array.prototype.randomPick=function(){return this.shuffle().slice(0,1)[0]};Array.prototype.reset=function(...t){this.splice(0),this.push(...t)};Array.prototype.union=function(t){return this.filter(e=>t.find(i=>e===i))};Array.prototype.getAllOnOffPattern=function*(){const t=[[]];yield[];for(const e of this){const i=t.map(a=>[...a,e]);yield*i,t.push(...i)}};Array.prototype.getDistinct=function(){return Array.from(new Set(this))};Array.prototype.distinct=function(){this.reset(...this.getDistinct())};Array.prototype.max=function(t){if(this.length)return this.reduce((e,i)=>t?t(i,e)>0?i:e:i>e?i:e)};Array.prototype.min=function(t){if(this.length)return this.reduce((e,i)=>t?t(i,e)<0?i:e:i<e?i:e)};const dg=["noticeSelfChain","noticeFreeChain"],fg={noticeSelfChain:"ã‚»ãƒ«ãƒ•ãƒã‚§ãƒ¼ãƒ³",noticeFreeChain:"ãƒ•ãƒªãƒ¼ãƒã‚§ãƒ¼ãƒ³"},ze=class ze{constructor(e,i,a,r,n,s=[]){c(this,"duel");c(this,"seat");c(this,"profile");c(this,"deckInfo");c(this,"info");c(this,"infoOrigin");c(this,"status");c(this,"statusOrigin");c(this,"duelistType");c(this,"lifeLog");c(this,"actionBlackListForNPC");c(this,"_lp");c(this,"initHand");c(this,"chainConfig");c(this,"writeInfoLog",e=>this.duel.log.info(e,this));c(this,"writeChainBlockHeaderLog",(e,i)=>this.duel.log.pushChainBlockHeaderLog(this,e,i));c(this,"initForDrawPhase",()=>{this.info={...this.infoOrigin}});c(this,"canDiscard",e=>(this.status.canDiscardAsCost&&console.log(e),!0));c(this,"canSendToGraveyard",e=>(console.log(e),!0));c(this,"canRelease",e=>(console.log(e),!0));c(this,"canTryBanish",(e,i,a)=>this.entity.procFilterBundle.filter([i],this,this.entity,a,[e]));c(this,"battleDamage",(e,i,a,r)=>{const n=nu(e,r.activator,this,i,a,r.action);return this.damage(i,n)});c(this,"effectDamage",(e,i)=>ze.effectDamage([{to:this,point:e}],i));c(this,"_effectDamage",(e,i)=>this.damage(i.action.entity,ru(e,i,this)));c(this,"damage",(e,i)=>{const a=[];if(i.point){const r=i.damageType==="Heal"?i.point:i.point*-1;a.push(this.setLp(this._lp+r,e,i.damageType))}return i.damageToOpponent1&&a.push(this.getOpponentPlayer().setLp(this._lp-i.damageToOpponent1,e,i.damageType)),i.damageToOpponent2&&a.push(this.getOpponentPlayer().setLp(this._lp-i.damageToOpponent2,e,i.damageType)),a});c(this,"lostLp",(e,i)=>this.setLp(this._lp-e,i,"Lost"));c(this,"payLp",(e,i)=>{const a=this.setLp(this._lp-e,i,"Pay");if(this.lp<=0)throw new re(this.getOpponentPlayer(),`${i.toString()}ã¸ã®ãƒ©ã‚¤ãƒ•ãƒã‚¤ãƒ³ãƒˆæ”¯æ‰•ã„ã«ã‚ˆã‚Šã€${this.name}ã®ãƒ©ã‚¤ãƒ•ãƒã‚¤ãƒ³ãƒˆãŒ0ã«ãªã£ãŸã€‚`);return a});c(this,"heal",(e,i)=>this.setLp(this._lp+e,i,"Heal"));c(this,"setLp",(e,i,a)=>{const r={duelist:this,clock:this.duel.clock.getClone(),reason:a||"Set",beforeLp:this._lp,afterLp:e,entity:i};return this.lifeLog.push(r),this._lp=e,this.writeInfoLog(`ãƒ©ã‚¤ãƒ•ãƒã‚¤ãƒ³ãƒˆå¤‰å‹•ï¼š${r.afterLp-r.beforeLp}ï¼ˆ${r.beforeLp} â‡’ ${r.afterLp}ï¼‰`),r});c(this,"getOpponentPlayer",()=>this.duel.firstPlayer===this?this.duel.secondPlayer:this.duel.firstPlayer);c(this,"getCells",(...e)=>this.duel.field.getCells(...e).filter(i=>{var a;return i.owner===this||((a=i.cardEntities[0])==null?void 0:a.controller)===this}));c(this,"getHandCell",()=>this.getCells("Hand")[0]);c(this,"getDeckCell",()=>this.getCells("Deck")[0]);c(this,"getExtraDeck",()=>this.getCells("ExtraDeck")[0]);c(this,"getGraveyard",()=>this.getCells("Graveyard")[0]);c(this,"getFieldZone",()=>this.getCells("FieldSpellZone")[0]);c(this,"getBanished",()=>this.getCells("Banished")[0]);c(this,"getMonsterZones",()=>this.getCells("MonsterZone"));c(this,"getExtraMonsterZones",()=>this.getCells("ExtraMonsterZone"));c(this,"getSpellTrapZones",()=>this.getCells("SpellAndTrapZone"));c(this,"getXyzMaterialZone",()=>this.getCells("XyzMaterialZone")[0]);c(this,"getEmptyMonsterZones",()=>this.getMonsterZones().filter(e=>e.cardEntities.length===0));c(this,"getAvailableMonsterZones",()=>this.getMonsterZones().filter(e=>e.isAvailable));c(this,"getAvailableExtraMonsterZones",()=>this.getExtraMonsterZones().length===0?this.duel.field.getCells("ExtraMonsterZone").filter(e=>e.isAvailable):[]);c(this,"getAvailableSpellTrapZones",()=>this.getSpellTrapZones().filter(e=>e.isAvailable));c(this,"getMonstersOnField",()=>this.duel.field.getMonstersOnFieldStrictly().filter(e=>e.controller===this));c(this,"getSpellTrapsOnField",()=>this.duel.field.getSpellTrapsOnFieldStrictly().filter(e=>e.controller===this));c(this,"getPendingMonstersOnField",()=>this.duel.field.getPendingMonstersOnField().filter(e=>e.controller===this));c(this,"getPendulumScaleMonsters",()=>this.duel.field.getCardsOnFieldStrictly().filter(e=>e.isPendulumScale).filter(e=>e.controller===this));c(this,"getPendulumScales",()=>{const e=this.getPendulumScaleMonsters();if(e.length<2)return;const i=e.find(s=>s.cell.column===(this.seat==="Below"?1:5)),a=e.find(s=>s.cell.column===(this.seat==="Below"?5:1));if(!i||!a)throw new S("æƒ³å®šã•ã‚Œãªã„çŠ¶æ…‹",e);const r=i.psR,n=a.psL;if(r===void 0||n===void 0)throw new S("æƒ³å®šã•ã‚Œãªã„çŠ¶æ…‹",e);return r>n?{upperBound:r,lowerBound:n}:{upperBound:n,lowerBound:r}});c(this,"getEntiteisOnField",()=>this.duel.field.getCardsOnFieldStrictly().filter(e=>e.controller===this));c(this,"pushDeck",e=>{this.deckInfo.cardNames.map(i=>e[i]).filter(i=>i).forEach(i=>Z.createCardEntity(this,i)),this.duel.log.info(`ãƒ‡ãƒƒã‚­ã‚’ã‚»ãƒƒãƒˆã€‚ãƒ¡ã‚¤ãƒ³${this.getDeckCell().cardEntities.length}æžšã€‚ã‚¨ã‚¯ã‚¹ãƒˆãƒ©${this.getExtraDeck().cardEntities.length}æžšã€‚`,this)});c(this,"draw",async(e,i,a)=>{var s;if(e<1)return;const r=this.getDeckCell(),n=[];this.writeInfoLog(`ãƒ‡ãƒƒã‚­ã‹ã‚‰ã‚«ãƒ¼ãƒ‰ã‚’${e}æžšãƒ‰ãƒ­ãƒ¼ã€‚`);for(const l of Array(e)){if(!r.cardEntities.length)throw this.writeInfoLog(n.length>0?`ãƒ‡ãƒƒã‚­ã‹ã‚‰ã‚«ãƒ¼ãƒ‰ã‚’${e}æžšãƒ‰ãƒ­ãƒ¼ã—ã‚ˆã†ã¨ã—ãŸãŒã€${n.length}æžšã—ã‹ãƒ‰ãƒ­ãƒ¼ã§ããªã‹ã£ãŸã€‚${n}`:"ãƒ‡ãƒƒã‚­ã‹ã‚‰ã‚«ãƒ¼ãƒ‰ã‚’ãƒ‰ãƒ­ãƒ¼ã§ããªã‹ã£ãŸã€‚"),new re(this.getOpponentPlayer(),`${this.name}ãŒãƒ‡ãƒƒã‚­ã‹ã‚‰ã‚«ãƒ¼ãƒ‰ã‚’ãƒ‰ãƒ­ãƒ¼ã§ããªã‹ã£ãŸã€‚`);const o=r.cardEntities[0];await o.draw(i?["Effect"]:["Rule"],i,a),n.push(((s=o.origin)==null?void 0:s.name)||"!åç§°å–å¾—å¤±æ•—!")}});c(this,"summon",async(e,i,a,r,n,s,l,o)=>(await this.summonMany(this,e,i,a,[{monster:r,posList:n,cells:s}],l,!1,1,d=>d.length===1,o)??[])[0]);c(this,"waitSelectNumberFromRange",(e,i,a,r)=>this.waitSelectNumber(e,dd(i,a),r));c(this,"waitSelectNumber",(e,i,a)=>this.duel.view.waitSelectNumber(this,e,i,a));c(this,"waitSelectEntities",(e,i,a,r,n=!1)=>this.duel.view.waitSelectEntities(this,{selectables:e,qty:i,validator:a,cancelable:n},r));c(this,"waitSelectEntity",async(e,i,a=!1)=>{const r=await this.waitSelectEntities(e,1,n=>n.length===1,i,a);return r?r[0]:void 0});c(this,"waitYesNo",e=>this.duel.view.waitYesOrNo(this,e));c(this,"waitSelectText",(e,i,a=!1)=>this.duel.view.waitSelectText(this,e,i,a));c(this,"getEnableActions",(e,i,a)=>{var n;const r=((n=a.slice(-1)[0])==null?void 0:n.nextChainBlockFilter)??(()=>!0);return[...this.duel.field.getAllCardEntities(),this.entity].flatMap(s=>s.actions).filter(s=>s.canExecute(this)).filter(s=>i.includes(s.spellSpeed)).filter(s=>e.includes(s.playType)).filter(s=>r(this,s)).map(s=>s.validate(this,a)).filter(s=>s!==void 0)});c(this,"discard",async(e,i,a=()=>!0,r,n,s,l=!1)=>{const o=this.getHandCell().cardEntities.filter(a);if(o.length<e)return[];let u=[];if(o.length===e)u=o;else if((s||this).duelistType==="NPC")u=o.randomPickMany(e);else{const d=await this.duel.view.waitSelectEntities(s||this,{selectables:o,qty:e,validator:f=>f.length===e,cancelable:l},`${e}æžšã‚«ãƒ¼ãƒ‰ã‚’æ¨ã¦ã‚‹ã€‚`);if(!d)return;u=d}return this.writeInfoLog(`æ‰‹æœ­ã‹ã‚‰ã‚«ãƒ¼ãƒ‰ã‚’${u.length}æžšæ¨ã¦ãŸã€‚${u.map(d=>d.toString())}ã€‚`),await _.discardManyForTheSameReason(u,["Discard",i],r,n),u});c(this,"getEnableSummonList",(e,i,a,r,n,s,l)=>{const o=this.duel.field.getCells("ExtraMonsterZone"),u=o.filter(f=>!s.map(p=>p.material).includes(f.cardEntities[0])).filter(f=>f.owner===this),d=[];return u.length&&d.push(...o.filter(f=>!u.includes(f)).filter(f=>f.isAvailable)),n.map(f=>({...f,summoner:this})).map(f=>{var p;return(i!=="LinkSummon"||!this.duel.field.canExtraLink(f.monster,s))&&(f.cells=f.cells.filter(h=>!d.includes(h))),(p=f.monster.status.monsterCategories)!=null&&p.includes("Link")&&(f.posList=f.posList.filter(h=>h==="Attack")),f}).map(f=>({...f,cells:f.cells.filter(p=>p.cardEntities.length===0||s.some(h=>h.material===p.cardEntities[0]))})).map(f=>{var p,h;if(f.monster.cell.cellType==="ExtraDeck"){if((p=f.monster.status.monsterCategories)!=null&&p.includes("Link")||(h=f.monster.status.monsterCategories)!=null&&h.includes("Pendulum"))return{...f,cells:f.cells.filter(y=>y.cellType==="ExtraMonsterZone"||y.linkArrowSources.filter(v=>!s.map(g=>g.material).includes(v)).length)}}else return{...f,cells:f.cells.filter(y=>y.cellType!=="ExtraMonsterZone")};return f}).filter(f=>f.cells.length&&f.posList.length).map(f=>this.entity.summonFilterBundle.filter(e,i,a,r,f,s,l)).filter(f=>f.cells.length&&f.posList.length).map(f=>f.monster.summonFilterBundle.filter(e,i,a,r,f,s,l)).filter(f=>f.cells.length&&f.posList.length).map(f=>s.map(p=>p.material.summonFilterBundle).reduce((p,h)=>h.filter(e,i,a,r,p,s,l),f)).filter(f=>f.cells.length&&f.posList.length)});c(this,"prepareToSummonMany",async(e,i,a,r,n,s,l,o,u,d,f="ç‰¹æ®Šå¬å–šã™ã‚‹ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã‚’é¸æŠžã€‚")=>{const p=this.getEnableSummonList(e,i,a,r,n,s,l);if(!p.length)return[];let h=p.map(v=>({...v,cells:[...v.cells],posList:[...v.posList]}));const y=[];for(;h.length&&y.length<(o??Number.MAX_SAFE_INTEGER);){const v=d&&!y.length||u(y.map(w=>w.monster));let g=h.randomPick();if(h.length>1){const w=await this.waitSelectEntity(h.map(A=>A.monster),f,v);if(!w)return y;g=h.find(A=>A.monster===w)??g}let m=[...g.posList].randomPick(),C=[...g.cells].randomPick();if((g.cells.length||g.posList.length)&&this.duelistType!=="NPC"){const w=await this.duel.view.waitSelectSummonDestination(g.summoner,g.monster,g.cells,g.posList,v);if(!w)return y;C=w.dest,m=w.battlePosition}y.push({summoner:this,monster:g.monster,pos:m,dest:C});const x=C.cellType==="ExtraMonsterZone";h.forEach(w=>{w.cells=w.cells.filter(A=>!y.map(J=>J.dest).includes(A)),x&&(w.cells=w.cells.filter(A=>A.cellType!=="ExtraMonsterZone"))}),h=h.filter(w=>w!==g).filter(w=>w.cells.length)}return y});c(this,"summonAll",(e,i,a,r,n,s,l,o,u)=>this.summonMany(e,i,a,r,n,s,l,n.length,d=>d.length===n.length,o,u));c(this,"summonOne",async(e,i,a,r,n,s,l,o,u)=>{const d=await this.summonMany(e,i,a,r,n,s,l,1,f=>f.length===1,o,u);if(d)return d[0]});c(this,"summonMany",(e,i,a,r,n,s,l,o,u,d,f)=>ze.summonMany(e,i,a,r,n.map(p=>({...p,summoner:this})),s,l,o,u,d,f));c(this,"summonEachFields",(e,i,a,r,n,s,l,o,u,d)=>ze._summonMany(e,i,a,r,[{duelist:this,msg:"è‡ªåˆ†"},{duelist:this.getOpponentPlayer(),msg:"ç›¸æ‰‹"}].map(f=>({summoner:this,msg:`${f.msg}ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«ç‰¹æ®Šå¬å–šã™ã‚‹ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã‚’é¸æŠžã€‚`,summonChoices:n.map(p=>({...p,cells:p.cells.filter(h=>h.owner===f.duelist)}))})),s,l,o,u,d));c(this,"selectAttackTargetForNPC",(e,i)=>{const a=e.atk??0,r=e.getAttackTargets();if(!r.length)return;const n=r.find(s=>s.entityType==="Duelist");return n&&(a>=Nc(1600,this.getOpponentPlayer().lp)||e.info.battlePotisionChangeCount>0)?n:r.find(s=>s.battlePosition==="Attack"?a>=(s.atk??0):a<(s.battlePosition==="Set"?1e3:s.def??0)?!1:s.validateDestroy("Battle",this,e,i))});c(this,"selectActionForNPC",(e,i)=>{if(!e.length)return;const a=e.filter(g=>g.action.isMandatory);if(a.length)return a.randomPick();let r=e.filter(g=>!this.actionBlackListForNPC.includes(g.action.playType));const n=r.filter(g=>!Number.isNaN(g.action.priorityForNPC)).shuffle().sort((g,m)=>g.action.priorityForNPC-m.action.priorityForNPC);if(n.length)return n[0];const s=r.filter(g=>g.action.playType==="TriggerEffect");if(s.length)return s.randomPick();if(this.duel.phase!=="main1"&&this.duel.phase!=="main2"){const g=r.filter(m=>m.action.playType==="IgnitionEffect");if(g.length)return g.randomPick()}const l=r.filter(g=>g.action.playType==="DeclareAttack").sort((g,m)=>(g.action.entity.atk??0)-(m.action.entity.atk??0));if(l.length)return l.find(g=>this.selectAttackTargetForNPC(g.action.entity,g.action));r=r.filter(g=>g.action.playType!=="DeclareAttack");const o=r.length?i.slice(-1)[0]:void 0,u=r.filter(g=>g.action.negatePreviousBlock);if(o&&o.activator!==this&&u.length)return u.randomPick();if(r=r.filter(g=>!g.action.negatePreviousBlock),!r.length)return;const d=this.getOpponentPlayer().getMonstersOnField().filter(g=>g.battlePosition==="Attack").map(g=>g.atk??0).max()??1600,f=this.getOpponentPlayer().getMonstersOnField().map(g=>g.battlePosition==="Set"?1500:(g.battlePosition==="Attack"?g.atk:g.def)??0).min()??1500,h=this.getMonstersOnField().filter(g=>g.battlePosition==="Attack").map(g=>g.atk??0).max()??0;let y=r.filter(g=>g.action.playType!=="ChangeBattlePosition").filter(g=>g.action.entity.battlePosition!=="Attack").filter(g=>(g.action.entity.atk??0)>=d||(g.action.entity.atk??0)>f&&(g.action.entity.atk??0)>2300);if(y.length)return y.randomPick();r=r.filter(g=>g.action.playType!=="ChangeBattlePosition").filter(g=>g.action.playType!=="SpellTrapSet").filter(g=>g.action.entity.actions.filter(m=>m.playType!=="NormalSummon"&&m.playType!=="SpecialSummon").flatMap(m=>m.executableCells).every(m=>m!=="Hand")||g.action.playType!=="NormalSummon"&&g.action.playType!=="SpecialSummon");const v=[...r.filter(g=>g.action.playType==="NormalSummon").filter(g=>(g.action.entity.lvl??12)<5),...r.filter(g=>g.action.playType==="SpecialSummon"),...r.filter(g=>g.action.playType==="NormalSummon").filter(g=>(g.action.entity.atk??0)>2600||(g.action.entity.atk??0)>2300&&(g.action.entity.lvl??12)<7).filter(g=>(g.action.entity.atk??0)>=h),...r.filter(g=>g.action.entity.face==="FaceUp").filter(g=>g.action.entity.isOnFieldStrictly)];if(v.length)return v.randomPick();if(r=r.filter(g=>g.action.playType!=="NormalSummon").filter(g=>g.action.playType!=="SpecialSummon"),this.duel.phase==="main2"){if(y=e.filter(g=>g.action.playType==="ChangeBattlePosition").filter(g=>g.action.entity.battlePosition==="Attack").filter(g=>(g.action.entity.atk??0)<d||(g.action.entity.atk??0)>f&&(g.action.entity.atk??0)>2300),y.length)return y.randomPick();if(this.getAvailableSpellTrapZones().length>1)return e.filter(g=>g.action.playType==="SpellTrapSet").filter(g=>g.action.entity.kind!=="Spell"||g.action.entity.status.spellCategory==="QuickPlay").randomPick()}if(console.log(r),Math.random()<r.length/4)return r.randomPick()});this.duel=e,this.seat=i,this.profile=a,this.chainConfig=a.chainConfig??{noticeSelfChain:!0,noticeFreeChain:!0},this.duelistType=r,this.deckInfo=n,this.initHand=s,this.lifeLog=[],this.infoOrigin={maxRuleNormalSummonCount:1,ruleNormalSummonCount:0,ruleNormalSummonCountQty:0,effectNormalSummonCount:0,effectNormalSummonCountQty:0,specialSummonCount:0,specialSummonCountQty:0},this.info={...this.infoOrigin},this.statusOrigin={maxSpecialSummonCount:Number.MAX_VALUE,canDrawByEffect:!0,canSearchFromDeck:!0,canDiscardAsCost:!0,canDiscardAsEffect:!0},this.status={...this.statusOrigin},this._lp=8e3;const l=[];this.duelistType==="NPC"&&(this.profile.npcLvl<0&&l.push("NormalSummon","SpecialSummon","SpellTrapSet"),this.profile.npcLvl<1&&l.push("CardActivation","IgnitionEffect","TriggerEffect","QuickEffect"),this.profile.npcLvl<101&&l.push("DeclareAttack"),this.profile.npcLvl===Number.MAX_SAFE_INTEGER&&l.push("NormalSummon","SpecialSummon","SpellTrapSet","DeclareAttack")),this.actionBlackListForNPC=l}get entity(){const e=this.getHandCell().entities.find(i=>i.entityType==="Duelist");return e||Z.createPlayerEntity(this)}get name(){return this.profile.name}get lp(){return this._lp}get isTurnPlayer(){return this.duel.getTurnPlayer()===this}get canDraw(){return!0}get canAddToHandFromDeck(){return!0}get canAddToHandFromGraveyard(){return!0}get canSet(){return!0}};c(ze,"summonMany",async(e,i,a,r,n,s,l,o,u,d,f="ç‰¹æ®Šå¬å–šã™ã‚‹ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã‚’é¸æŠžã€‚")=>ze._summonMany(e,i,a,r,n.map(p=>p.summoner).getDistinct().map(p=>({summoner:p,summonChoices:n.filter(h=>h.summoner===p)})),s,l,o,u,d,f)),c(ze,"_summonMany",async(e,i,a,r,n,s,l,o,u,d,f="ç‰¹æ®Šå¬å–šã™ã‚‹ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã‚’é¸æŠžã€‚")=>{const p=[];for(const h of n){const y={...h};y.summonChoices=y.summonChoices.filter(g=>!p.map(m=>m.monster).includes(g.monster));const v=await y.summoner.prepareToSummonMany(e,i,a,r,y.summonChoices.map(g=>({...g,summoner:y.summoner})),s,l,o,u,d,y.msg??f);p.push(...v)}if(p.length)return p.forEach(h=>h.monster.info.materials.reset(...s)),await _.moveToXyzOwner(p[0].dest,p[0].monster,s.map(h=>h.material).filter(h=>h.kind==="XyzMaterial"),["XyzMaterial","Rule"],p[0].monster,e),await Z.summonMany(p,i,a,r.entity,e),p.map(h=>h.monster)}),c(ze,"effectDamage",(e,i)=>{if(!e.length)return[];const a=e.flatMap(n=>n.to._effectDamage(n.point,i)),r=Object.values(e[0].to.duel.duelists).filter(n=>n.lp>0);if(r.length===1)throw new re(r[0],`${i.action.toFullString()}ã«ã‚ˆã‚Šã€${r[0].getOpponentPlayer().name}ã®ãƒ©ã‚¤ãƒ•ãƒã‚¤ãƒ³ãƒˆãŒ0ã«ãªã£ãŸã€‚`);if(!r.length)throw new re(void 0,`${i.action.toFullString()}ã«ã‚ˆã‚Šã€ãŠäº’ã„ã®ãƒ©ã‚¤ãƒ•ãƒã‚¤ãƒ³ãƒˆãŒ0ã«ãªã£ãŸã€‚`);return a});let $i=ze;const $t=["Controller","Opponent"],fd=["IfNormarlSummonSucceed","IfAdvanceSummonSucceed","IfSpecialSummonSucceed","IfFusionSummonSucceed","IfRitualSummonSucceed","IfSynchroSummonSucceed","IfXyzSummonSucceed","IfPendulumSummonSucceed","IfLinkSummonSucceed","IfFlipSummonSucceed","IfFlip"],pd=[...fd,"IfDestroyed","IfDoneByBattle","IfDoneByEffect"],Gr=["NormalSummon","AdvanceSummon","SpecialSummon","SpecialSummonFromDeck","SendToGraveyardFromDeck","Draw","SearchFromDeck","BanishFromDeck","BanishFromGraveyard","AddToHandFromGraveyard","ReturnToDeckFromGraveyard","SpecialSummonFromGraveyard","SpecialSummonFromBanished","ReturnToHandFromGraveyard","ReturnToHandFromField","BanishFromField","BanishFromHand","Destroy","DestroyMultiple","DestroyOnField","DestroyMultipleOnField","DestroyOnOpponentField","DestroyMultipleOnOpponentField","DestroyMonsterOnField","DestroyMonstersOnField","DestroySpellTrapOnField","DestroySpellTrapsOnField","SpecialSummonFromHand","SpecialSummonFromExtraDeck","SpecialSummonToken","DamageToOpponent","DamageToSelf","PayLifePoint","DiscordAsCost","DiscordAsEffect","RollDice","BounceToHand","NegateCardEffect","NegateCardActivation","NegateNormalSummon","NegateSpecialSummon","DelegateAnotherEffect",...pd],Ui=["discard","banish","release","returnToDeck","returnToHand","sendToGraveyard","xyzMaterial"],gd=t=>t.triggerType==="Arrival",hd=t=>t.triggerType==="Departure",Ae=class Ae extends ri{constructor(i,a,r,n){super(i,a,r);c(this,"getTargetableEntities",(i,a)=>{if(this.definition.hasToTargetCards&&!this.definition.getTargetableEntities)throw new S(`å‡¦ç†å®šç¾©ãŒçŸ›ç›¾ã—ã¦ã„ã‚‹ã€‚${this.toFullString()}`,this);return this.definition.getTargetableEntities?this.definition.getTargetableEntities(i,a):[]});c(this,"toString",()=>this.playType==="CardActivation"?"ã‚«ãƒ¼ãƒ‰ã®ç™ºå‹•":this.isWithChainBlock?`Â«${this.title}Â»`:this.title);c(this,"toFullString",()=>`${this.entity.toString()}ã®${this.toString()}`);c(this,"addhocMaterialLimitation");c(this,"getClone",i=>new Ae(this.seq,this.entity,this.definition,i));c(this,"validate",(i,a,r=[],n)=>{const s=r.includes("IgnoreRegularCosts"),l=r.includes("IgnoreConditions"),o=r.includes("CopyEffectOnly");if(this.isWithChainBlock&&!this.entity.status.canActivateEffect||s&&this.needsToPayRegularCosts||!this.validateCount(i,a,n))return;const u=a.map(p=>p.chainNumber??-1).max()??0,d={index:a.length,chainNumber:this.isWithChainBlock?u+1:void 0,action:this,activator:i,targetChainBlock:a.slice(-1)[0],state:"unloaded",dest:void 0,ignoreCosts:!1};if(this.definition.canPayCosts&&!s&&!this.definition.canPayCosts(d,this.playType==="AfterChainBlock"?[]:a))return;if(this.definition.triggerPattern){if(gd(this.definition.triggerPattern)){if(!Ae.validateArrivalTrigger(this.entity,this.definition.triggerPattern))return}else if(hd(this.definition.triggerPattern)&&!Ae.validateDepartureTrigger(this.entity,this.definition.triggerPattern))return}if(this.definition.meetsConditions&&!l&&!this.definition.meetsConditions(d,this.playType==="AfterChainBlock"?[]:a))return;if(this.definition.canExecute){const p=this.definition.canExecute(d,this.playType==="AfterChainBlock"?[]:a,n);if(p==="RemoveMe"){this.entity.actions.reset(...this.entity.actions.filter(h=>h.seq!==this.seq));return}if(!p)return}const f=[];if(this.definition.getDests&&f.push(...this.definition.getDests(d,this.playType==="AfterChainBlock"?[]:a)),this.playType==="CardActivation"&&!o){const p=this.getDestForCardActivation(i);if(!p)return;f.push(...p)}else this.playType==="SpellTrapSet"&&(this.entity.status.spellCategory==="Field"?f.push(i.getFieldZone()):f.push(...i.getAvailableSpellTrapZones()));return{action:this,dests:f,originSeq:this.seq}});c(this,"validateCount",(i,a,r)=>{if(r)return!0;const n=a.filter(l=>this.isSameGroup(l.action)).length;if(this.isOnlyNTimesPerDuel>0&&this.entity.field.duel.chainBlockLog.records.filter(l=>!l.chainBlockInfo.isNegatedActivationBy).filter(l=>this.isSameGroup(l.chainBlockInfo.action)).filter(l=>l.chainBlockInfo.activator===i).length+n>=this.isOnlyNTimesPerDuel||this.isOnlyNTimesPerTurn>0&&this.entity.field.duel.chainBlockLog.records.filter(l=>!l.chainBlockInfo.isNegatedActivationBy).filter(l=>this.isSameGroup(l.chainBlockInfo.action)).filter(l=>l.clock.turn===this.entity.field.duel.clock.turn).filter(l=>l.chainBlockInfo.activator===i).length+n>=this.isOnlyNTimesPerTurn||this.isOnlyNTimesPerChain>0&&n>=this.isOnlyNTimesPerChain)return!1;const s=n+this.entity.counterHolder.getActionCount(this);return!(this.isOnlyNTimesPerTurnIfFaceup>0&&s>=this.isOnlyNTimesPerTurnIfFaceup||this.isOnlyNTimesIfFaceup>0&&s>=this.isOnlyNTimesIfFaceup)});c(this,"getDestForCardActivation",i=>{var r;if(this.entity.info.isPending||this.entity.info.isDying||this.entity.info.isSettingSickness)return;if(this.entity.isOnFieldAsSpellTrapStrictly)return this.entity.face==="FaceDown"?[]:void 0;if(this.entity.cell.cellType!=="Hand"||this.definition.canActivateCardDirectly||!i.isTurnPlayer)return;if(this.entity.status.spellCategory==="Field")return[i.getFieldZone()];let a=i.getAvailableSpellTrapZones();return(r=this.entity.status.monsterCategories)!=null&&r.includes("Pendulum")&&(a=a.filter(n=>n.isAvailableForPendulum)),a});c(this,"prepare",async(i,a,r,n,s,l)=>{var w,A;var J=[];try{let o=a;let u=s;const d=this.isWithChainBlock?(n.map(E=>E.chainNumber??-1).max()??0)+1:void 0;let f="";const p=[];if(this.playType==="CardActivation"||this.playType==="SpellTrapSet")if(this.entity.cell.cellType==="Hand"){let E=this.entity.status.spellCategory==="Field"?[i.getFieldZone()]:i.getAvailableSpellTrapZones();if((w=this.entity.status.monsterCategories)!=null&&w.includes("Pendulum")&&(E=E.filter(I=>I.isAvailableForPendulum)),o&&E.includes(o)&&(E=[o],o=void 0),this.entity.status.spellCategory==="Field"){const I=i.getFieldZone().cardEntities;if(I.length){const ye=I[0];p.push(async()=>{await ye.sendToGraveyard(["Rule"],this.entity,i),i.writeInfoLog(`ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰é­”æ³•ã®ä¸Šæ›¸ãã«ã‚ˆã‚Šã€${ye.toString()}ã¯å¢“åœ°ã«é€ã‚‰ã‚ŒãŸã€‚`)}),u=!1}}let ie=E[0];if(E.length>1){ie=E.randomPick();const I=this.playType==="SpellTrapSet"?"ã‚»ãƒƒãƒˆ":"ã‚«ãƒ¼ãƒ‰ã®ç™ºå‹•",ye=await this.duel.view.waitSelectDestination(i,this.entity,E,"ã‚«ãƒ¼ãƒ‰ã‚’ç§»å‹•å…ˆã¸ãƒ‰ãƒ©ãƒƒã‚°",I,u);if(!ye)return;ie=ye}f+="æ‰‹æœ­ã‹ã‚‰",this.playType==="SpellTrapSet"?f+="é­”æ³•ãƒ»ç½ ã‚«ãƒ¼ãƒ‰ã‚’ã‚»ãƒƒãƒˆã€‚":f+=`${this.entity.toString()}ã‚’ç™ºå‹•ã€‚`,u=!1,this.playType==="CardActivation"&&(this.entity.info.isPending=!0),(A=this.entity.status.monsterCategories)!=null&&A.includes("Pendulum")?p.push(()=>this.entity.activateAsPendulumScale(ie,["CardActivation"],this.entity,i)):this.playType==="CardActivation"?p.push(()=>this.entity.activateSpellTrapFromHand(ie,this.entity.kind,["CardActivation"],this.entity,i)):p.push(()=>this.entity.setAsSpellTrap(ie,this.entity.kind,["SpellTrapSet"],this.entity,i))}else this.entity.isOnField&&this.entity.face==="FaceDown"?(f+=`ã‚»ãƒƒãƒˆã•ã‚Œã¦ã„ãŸ${this.entity.toString()}ã‚’ç™ºå‹•ã€‚`,u=!1,this.playType==="CardActivation"&&(this.entity.info.isPending=!0),p.push(()=>this.entity.setNonFieldMonsterPosition(this.entity.origin.kind,"FaceUp",["Rule"]))):f="";else d!==void 0&&(f+=`${this.toFullString()}ã‚’ç™ºå‹•ã€‚`);const h=hr(J,this.duel.log.openTransaction());f&&d&&i.writeChainBlockHeaderLog(d,f);for(const E of p)await E();const y={index:n.length,chainNumber:d,action:this,activator:i,targetChainBlock:r,isActivatedIn:this.entity.cell,isActivatedAt:this.duel.clock.getClone(),enableCellTypes:[...this.entity.info.isEffectiveIn],costInfo:{},state:"ready",dest:o,ignoreCosts:!1};if(this.definition.payCosts&&!l){const E=await this.definition.payCosts(y,n,u);if(!E)return;y.costInfo=E,u=!1}const v=await this.definition.prepare(y,n,u);if(v===void 0)return;const g={...v};g.selectedEntities=g.selectedEntities??[];g.chainBlockTags=[...g.chainBlockTags??[],...this.definition.fixedTags??[]];g.chainBlockTags.some(E=>E.startsWith("SpecialSummon"))&&g.chainBlockTags.push("SpecialSummon");g.chainBlockTags=g.chainBlockTags.getDistinct();if(Rn.some(E=>E===this.playType)){const E=v.nextChainBlockFilter??(()=>!0);g.nextChainBlockFilter=(ie,I)=>I.negateSummon&&E(ie,I)}const m=new fu(y.state);const C={...g,...y};Object.keys(C).filter(E=>E!=="state").forEach(E=>{m[E]=C[E]});const x=m;h.commit();return x}catch(ge){var R=ge,B=!0}finally{yr(J,R,B)}});c(this,"execute",async(i,a,r)=>{const n=(r==null?void 0:r.indirectly)??!1;if(i.action.isLikeContinuousSpell&&(i.action.entity.face==="FaceDown"||!i.action.entity.isOnField))return this.entity.info.isPending=!1,i.state="failed",!1;i.state="processing";let s=!1;if(!n&&i.chainNumber&&i.activator.writeChainBlockHeaderLog(i.chainNumber,`${i.action.toFullString()}ã®åŠ¹æžœå‡¦ç†ã€‚`),i.isNegatedActivationBy)i.state="nagated",i.chainNumber&&i.activator.writeInfoLog(`ãƒã‚§ãƒ¼ãƒ³${i.chainNumber}: ${i.action.toFullString()}ã‚’${i.isNegatedActivationBy.toFullString()}ã«ã‚ˆã£ã¦ç™ºå‹•ãŒç„¡åŠ¹ã«ã•ã‚ŒãŸã€‚`);else{let l=i.action.entity.isEffective,o="";if(l){if(i.isNegatedEffectBy)o=`ãƒã‚§ãƒ¼ãƒ³${i.chainNumber}: ${i.action.toFullString()}ã‚’${i.isNegatedEffectBy.toFullString()}ã«ã‚ˆã£ã¦åŠ¹æžœã‚’ç„¡åŠ¹ã«ã—ãŸã€‚`,l=!1;else if(this.isWithChainBlock&&!i.enableCellTypes.includes(i.isActivatedIn.cellType)){const u=i.action.entity.moveLog.records.findLast(d=>d.face==="FaceDown"&&d.orientation==="Horizontal");l=(u&&i.activator.duel.clock.isSameChain(u.movedAt))??!1}}l?(s=await this.definition.execute(i,a),i.state=s?"done":"failed"):(i.state="nagated",i.chainNumber&&(o=o||`ãƒã‚§ãƒ¼ãƒ³${i.chainNumber}: ã‚«ãƒ¼ãƒ‰ã®åŠ¹æžœãŒç„¡åŠ¹ã¨ãªã£ã¦ã„ã‚‹ãŸã‚${i.action.toFullString()}ã®åŠ¹æžœå‡¦ç†ã‚’è¡Œãˆãªã„ã€‚`),i.activator.writeInfoLog(o)),await this.entity.determine(),n||(this.isOnlyNTimesPerTurnIfFaceup>0?this.entity.counterHolder.incrementActionCountPerTurn(this):this.isOnlyNTimesIfFaceup>0&&this.entity.counterHolder.incrementActionCount(this),this.definition.settle(i,a))}return s});c(this,"directSettle",(...i)=>this.definition.settle(...i));c(this,"directExecute",async(i,a,r)=>{const n=await this.prepare(i,void 0,a,[],!1,r);if(!n)throw new S("æƒ³å®šã•ã‚Œãªã„çŠ¶æ…‹",this,i,r);return i.duel.chainBlockLog.push(n),await this.execute(n,[])});c(this,"isSame",i=>this.entity.origin.name===i.entity.origin.name&&this.title===i.title);c(this,"isSameGroup",i=>this.actionGroupName?this.entity.origin.name===i.entity.origin.name&&this.actionGroupName===i.actionGroupName:this.isSame(i));c(this,"calcChainBlockTagsForDestroy",(i,a)=>{if(!Gr.length)return[];const r=["Destroy"];Gr.length>1&&r.push("DestroyMultiple");const n=a.filter(u=>u.isOnFieldStrictly);n.length&&(r.push("DestroyOnField"),n.length>1&&r.push("DestroyMultipleOnField"));const s=n.filter(u=>u.kind==="Monster");s.length&&(r.push("DestroyMonsterOnField"),s.length>1&&r.push("DestroyMonstersOnField")),n.filter(u=>u.kind!=="Monster").length&&(r.push("DestroySpellTrapOnField"),s.length>1&&r.push("DestroySpellTrapsOnField"));const o=n.filter(u=>u.controller!==i);return o.length&&(r.push("DestroyOnOpponentField"),o.length>1&&r.push("DestroyMultipleOnOpponentField")),r});this.addhocMaterialLimitation=n??(()=>!0)}get definition(){return super.definition}get playType(){return this.definition.playType}get spellSpeed(){return this.definition.spellSpeed}get needsToPayRegularCosts(){return this.definition.needsToPayRegularCost??!1}get hasToTargetCards(){return this.definition.hasToTargetCards??!1}get fixedTags(){return this.definition.fixedTags??[]}get isWithChainBlock(){return nr.some(i=>i===this.playType)}get isChainable(){return Tc.some(i=>i===this.playType)}get isLikeContinuousSpell(){return this.definition.isLikeContinuousSpell||this.entity.isLikeContinuousSpell&&this.playType==="CardActivation"}get isNoticedForcibly(){return this.definition.isNoticedForcibly||this.isMandatory||this.definition.playType==="TriggerEffect"||this.definition.playType==="LingeringEffect"||this.negatePreviousBlock||this.negateSummon}get negatePreviousBlock(){return this.definition.negatePreviousBlock??!1}get negateSummon(){return this.definition.negateSummon??!1}get priorityForNPC(){return this.definition.priorityForNPC??Number.NaN}*getEnableMaterialPatterns(i){this.definition.getEnableMaterialPatterns&&(yield*this.definition.getEnableMaterialPatterns(i).filter(this.addhocMaterialLimitation))}};c(Ae,"createNew",(i,a)=>new Ae("AutoSeq",i,a)),c(Ae,"validateArrivalTrigger",(i,a)=>{const r=a.needsJustNow??!1;if(!i.hasBeenArrivalNow(a.arrivalReasons,a.battlePositions??k,r))return!1;const n=i.moveLog.latestArrivalRecord;if(!n)throw new S("æƒ³å®šã•ã‚Œãªã„çŠ¶æ…‹");return!(a.needsByOpponent&&n.chooser===i.controller||a.needsByEffect&&!n.movedAs.includes("Effect")||a.causerFilter&&(!n.movedBy||!a.causerFilter(i,n.movedBy)))}),c(Ae,"validateDepartureTrigger",(i,a)=>{const r=a.needsJustNow??!1,n=i.moveLog.latestRecord;if(console.log(i.toString(),i.duel.clock.toFullString(),n.movedAt),!i.duel.clock.isPreviousChain(n.movedAt)||r&&!i.duel.clock.isPreviousProc(n.movedAt)||a.from&&!a.from.includes(i.wasMovedFrom.cellType)||i.cell.cellType==="Graveyard"&&i.wasMovedFrom.cellType==="Banished"||a.needsByDestory&&!n.movedAs.includes("Destroy"))return!1;if(a.needsByBattle||a.needsByEffect){let s=!1;if((a.needsByBattle&&n.movedAs.includes("Battle")||a.needsByEffect&&n.movedAs.includes("Effect"))&&(s=!0),!s)return!1}return!(a.needsByOpponent&&(i.wasMovedFrom.owner===i.controller.getOpponentPlayer()||n.actionOwner===i.controller&&!n.movedAs.includes("Battle"))||a.causerFilter&&(!n.movedBy||!a.causerFilter(i,n.movedBy)))}),c(Ae,"createDummyAction",(i,a,r,n,s)=>({action:Ae.createNew(i,{title:a,isMandatory:!1,executableCells:[],executablePeriods:[],executableDuelistTypes:[],playType:"Dammy",spellSpeed:"Dammy",getDests:()=>r,prepare:async()=>{},execute:async()=>!1,settle:async()=>!1}),dests:r,battlePosition:n,originSeq:(s==null?void 0:s.seq)??-1}));let St=Ae;const T=async()=>({selectedEntities:[]}),Ut=async(t,e,i)=>(t.activator.payLp(i,t.action.entity),{lifePoint:i}),$r=async t=>{const e=Math.floor(t.activator.lp/2);return t.activator.payLp(e,t.action.entity),{lifePoint:e}},yd=t=>t.activator.canSendToGraveyard([t.action.entity])&&t.action.entity.canBeSentToGraveyard(t.activator,t.action.entity,"SendToGraveyardAsCost",t.action),vd=async t=>(await t.action.entity.sendToGraveyard(["Cost"],t.action.entity,t.activator),{sendToGraveyard:[t.action.entity]}),Bt=t=>t.activator.canTryBanish(t.action.entity,"BanishAsCost",t.action)&&t.action.entity.canBeBanished("BanishAsCost",t.activator,t.action.entity,t.action),hi=async t=>(await t.action.entity.banish(["Cost"],t.action.entity,t.activator),{banish:[t.action.entity]}),md=(t,e,i=1)=>e.filter(a=>t.activator.canTryBanish(a,"BanishAsCost",t.action)).filter(a=>a.canBeBanished("BanishAsCost",t.activator,t.action.entity,t.action)).length>=i,Sd=async(t,e,i,a=1,r=1)=>{const n=e.filter(o=>t.activator.canTryBanish(o,"BanishAsCost",t.action)).filter(o=>o.canBeBanished("BanishAsCost",t.activator,t.action.entity,t.action)),s=a===r?a:void 0,l=await t.activator.waitSelectEntities(n,s,o=>i(o,t),"ã‚³ã‚¹ãƒˆã¨ã—ã¦é™¤å¤–ã™ã‚‹ã‚«ãƒ¼ãƒ‰ã‚’é¸æŠž",!1)??[];return await _.banishManyForTheSameReason(l,["Cost"],t.action.entity,t.activator),{banish:l}},cr=(t,e=()=>!0,i=1,a=1)=>({canPayCosts:(...r)=>md(r[0],t(...r),i),payCosts:(...r)=>Sd(r[0],t(r[0],r[1]),e,i,a)}),jt=(t,e,i=()=>!0,a=1)=>t.activator.getHandCell().cardEntities.filter(i).filter(r=>t.activator.canDiscard([r])).length>=a,zt=async(t,e,i=!1,a=()=>!0,r=1)=>({discard:await t.activator.discard(r,"Cost",a,t.action.entity,t.activator,t.activator,i)}),_d=(t,e)=>jt(t,e,i=>t.action.entity===i,1),Td=(t,e,i=!1)=>zt(t,e,i,a=>t.action.entity===a),Cd=(t,e)=>t.action.getTargetableEntities(t,e).filter(i=>i.isOnField).map(i=>i.cell),Jn=(t,e,...i)=>{const[a,r,n]=i;return t.activator.getCells(...r??Se).flatMap(l=>l.cardEntities).filter(l=>l.kind==="Monster").filter(l=>l.canBeReleased(t.activator,t.action.entity,["ReleaseAsCost"],t.action)).filter(l=>!a||a(t,e,l)).length>=(n??1)},wd=(t=()=>!0,e=Se,i=1)=>({canPayCosts:(...a)=>Jn(...a,t,e,i),payCosts:async(a,r,n)=>{const s=a.activator.getCells(...e).flatMap(o=>o.cardEntities).filter(o=>o.kind==="Monster").filter(o=>o.canBeReleased(a.activator,a.action.entity,["ReleaseAsCost"],a.action)).filter(o=>t(a,r,o)),l=await a.activator.waitSelectEntities(s,i,o=>o.length===i,"ã‚³ã‚¹ãƒˆã¨ã™ã‚‹ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã‚’é¸æŠž",n);if(l)return await _.releaseManyForTheSameReason(l,["Cost"],a.action.entity,a.activator),{release:l}}}),Ur=(t,e,i,a={})=>{const{posList:r,cells:n}={posList:k,cells:t.activator.getMonsterZones(),...a};return t.activator.getEnableSummonList(t.activator,"SpecialSummon",["Effect"],t.action,i(t,e).filter(s=>s.kind==="Monster").filter(s=>s.canBeTargetOfEffect(t)).map(s=>({monster:s,posList:r,cells:n})),[],!1)},Ed=async(t,e,i=k,a=n=>n.length===1,r=1)=>{const n=t.activator.getMonsterZones(),s=t.activator.getEnableSummonList(t.activator,"SpecialSummon",["Effect"],t.action,e.filter(u=>u.kind==="Monster").filter(u=>u.canBeTargetOfEffect(t)).map(u=>({monster:u,posList:i,cells:n})),[],!1),l=await t.activator.waitSelectEntities(s.map(u=>u.monster),r,a,"ç‰¹æ®Šå¬å–šã™ã‚‹ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã‚’é¸æŠž",!1)??[];if(!l.length)throw new F(t);const o=l.map(u=>u.cell.cellType).getDistinct().filter(u=>u==="Graveyard"||u==="Banished").map(u=>u==="Graveyard"?"SpecialSummonFromGraveyard":"SpecialSummonFromBanished");return{selectedEntities:l,chainBlockTags:o}},In=async(t,e,i)=>{const{posList:a,allOrNothing:r,cells:n}={posList:k,allOrNothing:!0,cells:t.activator.getMonsterZones(),...i},s=t.selectedEntities.filter(l=>!l.wasMovedAfter(t.isActivatedAt)).map(l=>({monster:l,posList:a,cells:n}));return r&&(s.length!==t.selectedEntities.length||n.length<s.length)?!1:(await t.activator.summonAll(t.activator,"SpecialSummon",["Effect"],t.action,s,[],!1,!1),!0)},es=async(t,e,i)=>{const a=(i==null?void 0:i.cells)??t.activator.getMonsterZones(),r=(i==null?void 0:i.posList)??k,n=e.map(s=>({monster:s,posList:r,cells:a}));return await t.activator.summonAll(t.activator,"SpecialSummon",["Effect"],t.action,n,[],!1,!1),!0},Ze=(t,e={})=>{const i=e.qty??1;return{hasToTargetCards:!0,getTargetableEntities:t,canExecute:(a,r,n)=>(!e.canExecute||e.canExecute(a,r,n))&&Ur(a,r,t,e).length>=i,prepare:async(a,r,n)=>{const s=e.tags??[],l=e.message??"ç‰¹æ®Šå¬å–šã™ã‚‹ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã‚’é¸æŠžã€‚",o=Ur(a,r,t,e),u=await a.activator.waitSelectEntities(o.map(d=>d.monster),i,d=>d.length===i,l,n);if(u)return s.push(...u.map(d=>d.cell.cellType).getDistinct().filter(d=>d==="Graveyard"||d==="Banished").map(d=>d==="Graveyard"?"SpecialSummonFromGraveyard":"SpecialSummonFromBanished")),{selectedEntities:u,chainBlockTags:s,appendix:[`å¯¾è±¡ï¼š${u.map(d=>d.toString()).join(", ")}`]}},execute:async(...a)=>{const r=await In(...a,e);return e.afterExecute?e.afterExecute(r,...a):r}}},_e=(t,e={})=>{const i=(a,r,n)=>t(a,r,n).filter(s=>s.canBeTargetOfEffect(a));return{hasToTargetCards:!0,getTargetableEntities:t,canExecute:(...a)=>i(...a).length>0&&(!e.canExecute||e.canExecute(...a)),getDests:Cd,prepare:async(a,r,n)=>{let s=[];const l=e.tags??[],o=e.message??(e.do==="Destroy"?"ç ´å£Šã™ã‚‹ã‚«ãƒ¼ãƒ‰ã‚’é¸æŠžã€‚":"å¯¾è±¡ã¨ã™ã‚‹ã‚«ãƒ¼ãƒ‰ã‚’é¸æŠžã€‚");if(a.dest)s=[a.dest.cardEntities[0]];else{const u=await a.activator.waitSelectEntity(i(a,r),o,n);if(!u)return;s=[u]}return e.do==="Destroy"&&l.push(...a.action.calcChainBlockTagsForDestroy(a.activator,s)),{selectedEntities:s,chainBlockTags:l,appendix:[`å¯¾è±¡ï¼š${s.map(u=>u.toString()).join(", ")}`]}}}},Ga=async(t,e,i)=>{const a=(i==null?void 0:i.qty)??1,r=(i==null?void 0:i.targets)??["Opponent"],n=[];return r.includes("Self")&&n.push(...t.activator.getDeckCell().cardEntities.slice(0,a)),r.includes("Opponent")&&n.push(...t.activator.getOpponentPlayer().getDeckCell().cardEntities.slice(0,a)),await _.sendManyToGraveyardForTheSameReason(n,["Effect"],t.action.entity,t.activator),!0},ur=t=>({prepare:T,execute:(...e)=>Ga(...e,t)}),bd=(t,e,i)=>({title:t,playType:"SystemPeriodAction",spellSpeed:"Normal",executableCells:Me,executablePeriods:e,executableDuelistTypes:$t,isMandatory:!0,canExecute:a=>(i(a),!1),prepare:T,execute:async()=>!0,settle:async()=>!0}),b={title:"ã‚»ãƒƒãƒˆ",playType:"SpellTrapSet",spellSpeed:"Normal",executableCells:["Hand"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],isMandatory:!1,prepare:T,execute:async()=>!0,settle:async()=>!0},lt={title:"ç™ºå‹•",isMandatory:!1,playType:"CardActivation",spellSpeed:"Normal",executableCells:["Hand","SpellAndTrapZone","FieldSpellZone"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],prepare:T,execute:async()=>!0,settle:async()=>!0},kd=async(t,e,i,a,r)=>{const n=t.action.getTargetableEntities(t,e);if(!n)throw new S("CardActionå®šç¾©ãŒæ­£ã—ããªã„",t);const s=await t.activator.waitSelectEntity(n,"è£…å‚™å¯¾è±¡ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã‚’é¸æŠž",i);if(s)return t.action.entity.info.equipedBy=s,t.action.entity.info.effectTargets[t.action.seq]=[s],{chainBlockTags:a??[],selectedEntities:[s],prepared:r}},ts=async(t,e,i=()=>!0)=>{const a=t.selectedEntities[0];return t.action.entity.info.equipedBy=a,t.action.entity.info.effectTargets[t.action.seq]=[a],i(a,t.action.entity)?(t.action.entity.info.equipedBy=a,t.action.entity.info.validateEquipOwner=i,a.info.equipEntities.push(t.action.entity),!0):(await t.action.entity.ruleDestroy(),t.activator.writeInfoLog(`${a.toString()}ãŒè£…å‚™æ¡ä»¶ã‚’æº€ãŸã•ãªããªã£ãŸãŸã‚ã€${t.action.entity.toString()}ã¯ç ´å£Šã•ã‚ŒãŸã€‚`),!1)},Ft=(t=()=>!0)=>({title:"ç™ºå‹•",isMandatory:!1,playType:"CardActivation",spellSpeed:"Normal",executableCells:["Hand","SpellAndTrapZone"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],getTargetableEntities:e=>e.action.entity.field.getMonstersOnFieldStrictly().filter(i=>i.face==="FaceUp").filter(i=>i.canBeTargetOfEffect(e)).filter(i=>t(i,e.action.entity)),getDests:(e,i)=>e.action.getTargetableEntities(e,i).filter(a=>a.isOnFieldAsMonsterStrictly).map(a=>a.cell),prepare:(e,i,a)=>kd(e,i,a,[],void 0),execute:ts,settle:async()=>!0});function*Dd(){yield{name:"é€£åˆè»",actions:[lt,b],continuousEffects:[Zi("ç™ºå‹•","Spell",t=>[ne.createContinuous("ç™ºå‹•",e=>e.isSpawnedBy.isOnFieldStrictly&&e.isSpawnedBy.face==="FaceUp",t,(e,i)=>i.controller===e.isSpawnedBy.controller&&i.types.includes("Warrior")&&i.isOnFieldStrictly&&i.face==="FaceUp","attack","wip","Addition",(e,i,a)=>{if(!e.isEffective||i.face==="FaceDown")return a;const r=e.controller.getMonstersOnField().filter(n=>n.face==="FaceUp").filter(n=>n.types.includes("Warrior")||n.types.includes("Spellcaster")).length;return a+r*200})])]}}const is=Object.freeze(Object.defineProperty({__proto__:null,default:Dd},Symbol.toStringTag,{value:"Module"}));function*xd(){const t=[{name:"ãƒªãƒ“ãƒ³ã‚°ãƒ‡ãƒƒãƒ‰ã®å‘¼ã³å£°",pos:"Attack",filter:()=>!0},{name:"ã‚¨ãƒ³ã‚¸ã‚§ãƒ«ãƒ»ãƒªãƒ•ãƒˆ",pos:"Attack",filter:e=>(e.lvl??12)<3},{name:"æ­£çµ±ãªã‚‹è¡€çµ±",pos:"Attack",filter:e=>{var i;return!!((i=e.status.monsterCategories)!=null&&i.includes("Normal"))}},{name:"è˜‡ã‚Šã—é­‚",pos:"Defense",filter:e=>{var i;return!!((i=e.status.monsterCategories)!=null&&i.includes("Normal"))}},{name:"ãƒªãƒŸãƒƒãƒˆãƒ»ãƒªãƒãƒ¼ã‚¹",pos:"Attack",filter:e=>(e.atk??9999)<=1e3,targetImmdAction:async(e,i)=>{if(i){if(!i.isOnFieldAsMonsterStrictly||i.face==="FaceDown")return"RemoveMe";if(e.entity.isEffective&&i.battlePosition==="Defense")return e.entity.controller.writeInfoLog(`${i.toString()}ãŒå®ˆå‚™è¡¨ç¤ºã«ãªã£ãŸãŸã‚ã€${e.entity.toString()}ã¨ã¨ã‚‚ã«ç ´å£Šã•ã‚Œã‚‹ã€‚`),await _.tryMarkForDestroy([i,e.entity],{action:e,activator:e.entity.controller,selectedEntities:[i]}),"RemoveMe"}}}];for(const e of t)yield{name:e.name,actions:[{title:"ç™ºå‹•",isMandatory:!1,playType:"CardActivation",spellSpeed:"Quick",executableCells:["SpellAndTrapZone"],executablePeriods:D,executableDuelistTypes:["Controller"],fixedTags:["SpecialSummonFromGraveyard","SpecialSummon"],...Ze(i=>i.activator.getGraveyard().cardEntities.filter(a=>a.kind==="Monster").filter(e.filter).filter(a=>a.canBeTargetOfEffect(i)),{posList:["Attack"],afterExecute:async(i,a)=>!i||!a.selectedEntities.length?!1:(a.action.entity.info.effectTargets[a.action.seq]=a.selectedEntities,!0)}),settle:async()=>!0},b],immediatelyActions:[{title:"è‡ªå£Š",executableCells:Me,executablePeriods:le,executableFaces:sr,execute:async(i,a,r)=>{if(e.targetImmdAction&&a&&Object.values(i.entity.info.effectTargets).flatMap(l=>l).includes(a)){e.targetImmdAction(i,a,r);return}if(console.log(i.entity.toString(),i,a,r),a!==i.entity||(console.log(i.entity.toString(),i,a,r),!r))return;console.log(i.entity.toString(),i,a,r);const n=Object.values(r.info.effectTargets).flatMap(l=>l);if(!n.length)return;console.log(i.entity.toString(),i,a,r);const s=n[0];s.isOnFieldAsMonsterStrictly&&s.face==="FaceUp"&&r.status.isEffective&&r.info.isEffectiveIn.includes(r.cell.cellType)&&(i.entity.controller.writeInfoLog(`${i.entity.toString()}ãŒãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’é›¢ã‚ŒãŸãŸã‚ã€å¯¾è±¡ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼${s.toString()}ã‚’ç ´å£Šã€‚`),await _.tryMarkForDestroy([s],{action:i,activator:i.entity.controller,selectedEntities:n}))}}]}}const as=Object.freeze(Object.defineProperty({__proto__:null,default:xd},Symbol.toStringTag,{value:"Module"}));function*Ad(){yield{name:"æ˜‡å¤©ã®é»’è§’ç¬›",actions:[{title:"ç™ºå‹•",isMandatory:!1,playType:"CardActivation",spellSpeed:"Counter",executableCells:["SpellAndTrapZone"],executablePeriods:le,executableDuelistTypes:["Controller"],negateSummon:!0,fixedTags:["NegateSpecialSummon"],canExecute:t=>(t.targetChainBlock&&t.targetChainBlock.action.playType==="SpecialSummon"&&t.targetChainBlock.activator!==t.activator&&t.activator.duel.field.getPendingMonstersOnField().length===1)??!1,prepare:async()=>({selectedEntities:[]}),execute:async t=>{const e=_.negateSummonMany(t.action.entity,t.activator);return await _.tryDestroy(e,t),!0},settle:async()=>!0},b]}}const rs=Object.freeze(Object.defineProperty({__proto__:null,default:Ad},Symbol.toStringTag,{value:"Module"}));function*Pd(){yield*[{name:"å›£çµã®åŠ›",filter:t=>t.isMonster&&t.face==="FaceUp",rate:800},{name:"é­”å°Žå¸«ã®åŠ›",filter:t=>t.kind==="Spell"||t.kind==="Trap",rate:500}].map(t=>({name:t.name,actions:[Ft(),b],continuousEffects:[pi(t.name,"Spell",e=>e.info.equipedBy?[e.info.equipedBy]:[],e=>["attack","defense"].map(i=>ne.createContinuous("ç™ºå‹•",a=>a.isSpawnedBy.isOnFieldStrictly&&a.isSpawnedBy.face==="FaceUp",e,(a,r)=>r.isOnFieldStrictly&&r.face==="FaceUp",i,"wip","Addition",(a,r,n)=>{if(!a.isEffective)return n;const s=a.controller.getEntiteisOnField().filter(t.filter).length;return n+s*t.rate})))]})),yield{name:"æ—©ã™ãŽãŸåŸ‹è‘¬",actions:[{title:"ç™ºå‹•",isMandatory:!1,playType:"CardActivation",spellSpeed:"Normal",executableCells:["Hand","SpellAndTrapZone"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],fixedTags:["SpecialSummonFromGraveyard","PayLifePoint"],canPayCosts:t=>t.activator.lp>=800,payCosts:(t,e)=>Ut(t,e,800),...Ze(t=>t.activator.getGraveyard().cardEntities.filter(e=>e.kind==="Monster").filter(e=>e.canBeTargetOfEffect(t)),{posList:["Attack"],afterExecute:async(t,e,i)=>t?ts(e,i,(a,r)=>{var n;return(n=r.info.effectTargets[e.action.seq])==null?void 0:n.includes(a)}):(await e.action.entity.ruleDestroy(),!1)}),settle:async()=>!0},b],immediatelyActions:[{title:"è‡ªå£Š",executableCells:["SpellAndTrapZone",...ca],executablePeriods:le,executableFaces:["FaceUp"],execute:async(t,e,i)=>{if(e!==t.entity||!i)return;const a=i.info.equipedBy;a&&a.isOnFieldStrictly&&a.face==="FaceUp"&&i.status.isEffective&&i.info.isEffectiveIn.includes(i.cell.cellType)&&!e.cell.isSpellTrapZoneLikeCell&&e.moveLog.latestRecord.movedAs.some(r=>r.endsWith("Destroy"))&&(t.entity.controller.writeInfoLog(`${t.entity.toString()}ãŒç ´å£Šã•ã‚ŒãŸãŸã‚ã€å¯¾è±¡ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼${a.toString()}ã‚’ç ´å£Šã€‚`),await _.tryMarkForDestroy([a],{action:t,activator:t.entity.controller,selectedEntities:[a]}))}}]},yield{name:"å¹»æƒ‘ã®å·»ç‰©",actions:[Ft(),b],continuousEffects:[]}}const ns=Object.freeze(Object.defineProperty({__proto__:null,default:Pd},Symbol.toStringTag,{value:"Module"}));function*Md(){yield*[{name:"ä¼èª¬ã®å‰£",attr:void 0,monType:"Warrior",atk:200,def:200},{name:"ç§˜è¡“ã®æ›¸",attr:void 0,monType:"Spellcaster",atk:200,def:200},{name:"ãƒã‚»ã‚¤ãƒ‰ãƒ³ã®åŠ›",attr:void 0,monType:"Aqua",atk:200,def:200},{name:"ç´«æ°´æ™¶",attr:void 0,monType:"Zombie",atk:200,def:200},{name:"çŒ›ç£ã®æ­¯",attr:void 0,monType:"Beast",atk:200,def:200},{name:"æ©Ÿæ¢°æ”¹é€ å·¥å ´",attr:void 0,monType:"Machine",atk:200,def:200},{name:"ä½“æ¸©ã®ä¸Šæ˜‡",attr:void 0,monType:"Reptile",atk:200,def:200},{name:"é­”èŒ",attr:void 0,monType:"Plant",atk:200,def:200},{name:"é—‡ãƒ»ã‚¨ãƒãƒ«ã‚®ãƒ¼",attr:void 0,monType:"Fiend",atk:200,def:200},{name:"ãƒ¬ãƒ¼ã‚¶ãƒ¼ç ²æ©Ÿç”²éŽ§",attr:void 0,monType:"Insect",atk:200,def:200},{name:"éŠ€ã®å¼“çŸ¢",attr:void 0,monType:"Fairy",atk:200,def:200},{name:"é›»æ’ƒéž­",attr:void 0,monType:"Thunder",atk:200,def:200},{name:"ãƒ‰ãƒ©ã‚´ãƒ³ã®ç§˜å®",attr:void 0,monType:"Dragon",atk:200,def:200},{name:"ãƒ•ã‚©ãƒ­ãƒ¼ãƒ»ã‚¦ã‚£ãƒ³ãƒ‰",attr:void 0,monType:"WingedBeast",atk:200,def:200},{name:"é­”æ€§ã®æœˆ",attr:void 0,monType:"BeastWarrior",atk:200,def:200},{name:"ã‚¨ãƒ«ãƒ•ã®å…‰",attr:"Light",monType:void 0,atk:400,def:-200},{name:"è¦šé†’",attr:"Earth",monType:void 0,atk:400,def:-200},{name:"ç¼ç†±ã®æ§",attr:"Fire",monType:void 0,atk:400,def:-200},{name:"çªé¢¨ã®æ‰‡",attr:"Wind",monType:void 0,atk:400,def:-200},{name:"ã¯ãŒã­ã®ç”²ç¾…",attr:"Water",monType:void 0,atk:400,def:-200},{name:"é—‡ã®ç ´ç¥žå‰£",attr:"Dark",monType:void 0,atk:400,def:-200},{name:"ç«å™¨ä»˜æ©Ÿç”²éŽ§",attr:void 0,monType:"Insect",atk:700,def:0},{name:"ã‚µãƒ©ãƒžãƒ³ãƒ‰ãƒ©",attr:"Fire",monType:void 0,atk:700,def:0},{name:"ã‚·ãƒ£ã‚¤ãƒ³ãƒ»ã‚­ãƒ£ãƒƒã‚¹ãƒ«",attr:"Light",monType:void 0,atk:700,def:0}].map(t=>({name:t.name,actions:[Ft(e=>(!t.attr||e.attr.includes(t.attr))&&(!t.monType||e.types.includes(t.monType))),b],continuousEffects:[pi(t.name,"Spell",e=>e.info.equipedBy?[e.info.equipedBy]:[],e=>{const i=[];return t.atk!==0&&i.push(["attack",t.atk]),t.def!==0&&i.push(["defense",t.def]),i.map(([a,r])=>ne.createContinuous("ç™ºå‹•",n=>n.isSpawnedBy.isOnFieldStrictly&&n.isSpawnedBy.face==="FaceUp",e,(n,s)=>s.isOnFieldStrictly&&s.face==="FaceUp"&&(!t.monType||s.types.includes(t.monType))&&(!t.attr||s.attr.includes(t.attr)),a,"wip","Addition",(n,s,l)=>n.isEffective?l+r:l))})]}))}const ss=Object.freeze(Object.defineProperty({__proto__:null,default:Md},Symbol.toStringTag,{value:"Module"}));function*Fd(){yield{name:"ãƒã‚­ãƒ³ãƒ¬ãƒ¼ã‚¹",actions:[lt,b,{title:"â‘¡åŠ¹æžœç™ºå‹•",isMandatory:!1,playType:"IgnitionEffect",spellSpeed:"Normal",executableCells:["FieldSpellZone"],executablePeriods:["main1","main2"],executableDuelistTypes:$t,executableFaces:["FaceUp"],isOnlyNTimesPerTurnIfFaceup:1,canPayCosts:t=>t.activator.lp>=1e3,canExecute:t=>t.action.entity.face==="FaceUp",payCosts:(t,e)=>Ut(t,e,1e3),prepare:async(t,e,i)=>{let a=[{seq:0,text:"â—ãƒ‡ãƒƒã‚­ã‹ã‚‰ï¼‘æžšãƒ‰ãƒ­ãƒ¼ã™ã‚‹ã€‚",tags:["Draw"]},{seq:1,text:"â—ã“ã®ã‚«ãƒ¼ãƒ‰ã‚’ç ´å£Šã™ã‚‹ã€‚",tags:t.action.calcChainBlockTagsForDestroy(t.activator,[t.action.entity])},{seq:2,text:"â—ç›¸æ‰‹ã¯1000LPå›žå¾©ã™ã‚‹ã€‚",tags:[]}];t.activator.getDeckCell().cardEntities.length||(a=a.filter(n=>n.seq));const r=await t.activator.waitSelectText(a,"ä½¿ç”¨ã™ã‚‹åŠ¹æžœã‚’é¸æŠž",i);if(r!==void 0)return t.data=r.seq,{selectedEntities:[],chainBlockTags:r.tags,nextChainBlockFilter:()=>!1}},execute:async t=>{if(t.data===0)await t.activator.draw(1,t.action.entity,t.activator);else if(t.data===1)await _.tryDestroy([t.action.entity],t);else if(t.data===2)t.activator.getOpponentPlayer().heal(1e3,t.action.entity);else throw new S("å€¤ãŒæ­£ã—ããªã„ã€‚",t,t.data);return!0},settle:async()=>!0}],continuousEffects:[Oc("â‘ ãƒ€ãƒ¡ãƒ¼ã‚¸ç„¡åŠ¹","Spell",t=>[t.controller,t.controller.getOpponentPlayer()].map(e=>e.entity),t=>[new Un({title:"â‘ ãƒ€ãƒ¡ãƒ¼ã‚¸ç„¡åŠ¹",validateAlive:()=>!0,isContinuous:!0,isSpawnedBy:t,actionAttr:{},isApplicableTo:()=>!0,calcType:"zero_typeA",filter:(e,i,a,r)=>e.isSpawnedBy.cell.cellType!=="FieldSpellZone"?{}:r.lp>=r.getOpponentPlayer().lp?{}:(a.writeInfoLog(`${r.profile.name}ã¯ãƒã‚­ãƒ³ãƒ¬ãƒ¼ã‚¹ã®åŠ¹æžœã§ãƒ€ãƒ¡ãƒ¼ã‚¸ã‚’å—ã‘ãªã„ã€‚`),{zero_typeA:!0})})])]}}const ls=Object.freeze(Object.defineProperty({__proto__:null,default:Fd},Symbol.toStringTag,{value:"Module"}));function*Od(){yield*[{name:"è‰åŽŸ",up:["Warrior","BeastWarrior"],down:[]},{name:"æ£®",up:["Insect","Plant","Beast","BeastWarrior"],down:[]},{name:"å±±",up:["Dragon","WingedBeast","Thunder"],down:[]},{name:"è’é‡Ž",up:["Dinosaur","Zombie","Rock"],down:[]},{name:"æµ·",up:["Aqua","SeaSerpent","Fish"],down:["Machine","Pyro"]},{name:"é—‡",up:["Fiend","Spellcaster"],down:["Fairy"]}].map(t=>({name:t.name,actions:[lt,b],continuousEffects:[Zi("ç™ºå‹•","Spell",e=>["attack","defense"].flatMap(i=>["up","down"].map(a=>ne.createContinuous("ç™ºå‹•",r=>r.isSpawnedBy.isOnFieldStrictly&&r.isSpawnedBy.face==="FaceUp",e,(r,n)=>n.isOnFieldStrictly&&n.face==="FaceUp"&&(n.status.monsterCategories??!1)&&t[a].union(n.types).length>0,i,"wip","Addition",(r,n,s)=>!r.isEffective||n.face==="FaceDown"?s:s+(a==="up"?200:-200)))))]})),yield*[{name:"ãƒãƒ¼ãƒ‹ãƒ³ã‚°ãƒ–ãƒ©ãƒƒãƒ‰",attr:"Fire"},{name:"ã‚¦ã‚©ãƒ¼ã‚¿ãƒ¼ãƒ¯ãƒ¼ãƒ«ãƒ‰",attr:"Water"},{name:"ã‚¬ã‚¤ã‚¢ãƒ‘ãƒ¯ãƒ¼",attr:"Earth"},{name:"ã‚·ãƒ£ã‚¤ãƒ³ã‚¹ãƒ‘ãƒ¼ã‚¯",attr:"Light"},{name:"ãƒ€ãƒ¼ã‚¯ã‚¾ãƒ¼ãƒ³",attr:"Dark"},{name:"ãƒ‡ã‚¶ãƒ¼ãƒˆã‚¹ãƒˆãƒ¼ãƒ ",attr:"Wind"}].map(t=>({name:t.name,actions:[lt,b],continuousEffects:[Zi("ç™ºå‹•","Spell",e=>["attack","defense"].flatMap(i=>ne.createContinuous("ç™ºå‹•",a=>a.isSpawnedBy.isOnFieldStrictly&&a.isSpawnedBy.face==="FaceUp",e,(a,r)=>r.isOnFieldStrictly&&r.face==="FaceUp"&&r.attr.includes(t.attr),i,"wip","Addition",(a,r,n)=>!a.isEffective||r.face==="FaceDown"?n:n+(i==="attack"?500:-400))))]}))}const os=Object.freeze(Object.defineProperty({__proto__:null,default:Od},Symbol.toStringTag,{value:"Module"}));function*Nd(){const t=[{name:"ã‚«ãƒ«ãƒœãƒŠãƒ¼ãƒ©æˆ¦å£«",materialInfos:[{type:"Name",cardName:"ãƒžã‚°ãƒãƒƒãƒ„ï¼‘å·"},{type:"Name",cardName:"ãƒžã‚°ãƒãƒƒãƒ„ï¼’å·"}]},{name:"ã‚¯ãƒªãƒƒãƒãƒ¼",materialInfos:[{type:"Name",cardName:"ã‚¯ãƒªãƒƒã‚¿ãƒ¼"},{type:"Name",cardName:"é»’ãæ£®ã®ã‚¦ã‚£ãƒƒãƒ"}]},{name:"ã‚¹ã‚±ãƒ«ã‚´ãƒ³",materialInfos:[{type:"Name",cardName:"ãƒ¡ãƒ‡ãƒ¥ãƒ¼ã‚µã®äº¡éœŠ"},{type:"Name",cardName:"æš—é»’ã®ç«œçŽ‹"}]},{name:"ã‚¹ãƒãƒ¼ãƒ ã‚¸ãƒ£ã‚¤ãƒ­ã‚¤ãƒ‰",materialInfos:[{type:"Name",cardName:"ã‚¸ãƒ£ã‚¤ãƒ­ã‚¤ãƒ‰"},{type:"Name",cardName:"ã‚¹ãƒãƒ¼ãƒ ãƒ­ã‚¤ãƒ‰"}]},{name:"ãƒãƒ©ã«æ£²ã‚€æ‚ªéœŠ",materialInfos:[{type:"Name",cardName:"ã‚°ãƒ¬ãƒ ãƒªãƒ³"},{type:"Name",cardName:"ã‚¹ãƒãƒ¼ã‚¯ãƒ»ãƒ‘ãƒ¼ãƒ "}]},{name:"ãƒãƒ­ãƒƒã‚¯ã‚¹",materialInfos:[{type:"Name",cardName:"ã‚­ãƒ©ãƒ¼ãƒ‘ãƒ³ãƒ€"},{type:"Name",cardName:"ã‚¬ãƒ¼ã‚´ã‚¤ãƒ«"}]},{name:"ãƒ•ãƒ¥ãƒ¼ã‚¸ãƒ§ãƒ‹ã‚¹ãƒˆ",materialInfos:[{type:"Name",cardName:"ãƒ—ãƒãƒ†ãƒ³ã‚·"},{type:"Name",cardName:"ã‚¹ãƒªãƒ¼ãƒ”ã‚£"}]},{name:"ãƒ–ãƒ©ã‚­ã‚ªãƒ¬ã‚¤ãƒ‰ã‚¹",materialInfos:[{type:"Name",cardName:"äºŒé ­ã‚’æŒã¤ã‚­ãƒ³ã‚°ãƒ»ãƒ¬ãƒƒã‚¯ã‚¹"},{type:"Name",cardName:"å±ã‚’è²ªã‚‹ç«œ"}]},{name:"ãƒ—ãƒ©ã‚°ãƒ†ã‚£ã‚«ãƒ«",materialInfos:[{type:"Name",cardName:"ãƒˆãƒ©ã‚³ãƒ‰ãƒ³"},{type:"Name",cardName:"ãƒ•ãƒ¬ã‚¤ãƒ ãƒ»ãƒ´ã‚¡ã‚¤ãƒ‘ãƒ¼"}]},{name:"ãƒžãƒ–ãƒ©ã‚¹",materialInfos:[{type:"Name",cardName:"ã‚¿ã‚¤ãƒ›ãƒ¼ãƒ³"},{type:"Name",cardName:"é‚ªç‚Žã®ç¿¼"}]},{name:"ãƒŸãƒŽã‚±ãƒ³ã‚¿ã‚¦ãƒ­ã‚¹",materialInfos:[{type:"Name",cardName:"ãƒŸãƒŽã‚¿ã‚¦ãƒ«ã‚¹"},{type:"Name",cardName:"ã‚±ãƒ³ã‚¿ã‚¦ãƒ­ã‚¹"}]},{name:"æš—é»’ç«ç‚Žé¾",materialInfos:[{type:"Name",cardName:"ç«ç‚Žè‰"},{type:"Name",cardName:"ãƒ—ãƒãƒªãƒ¥ã‚¦"}]},{name:"ç‚Žã®é¨Žå£« ã‚­ãƒ©ãƒ¼",materialInfos:[{type:"Name",cardName:"ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ãƒ»ã‚¨ãƒƒã‚°"},{type:"Name",cardName:"ã‚¹ãƒ†ã‚£ãƒ³ã‚°"}]},{name:"ç‚Žã®å‰£å£«",materialInfos:[{type:"Name",cardName:"ç‚Žã‚’æ“ã‚‹è€…"},{type:"Name",cardName:"ä¼èª¬ã®å‰£è±ª ï¼­ï¼¡ï¼³ï¼¡ï¼«ï¼©"}]},{name:"éŸ³æ¥½å®¶ã®å¸çŽ‹",materialInfos:[{type:"Name",cardName:"é»’ãæ£®ã®ã‚¦ã‚£ãƒƒãƒ"},{type:"Name",cardName:"ãƒã‚¤ãƒ»ãƒ—ãƒªãƒ¼ã‚¹ãƒ†ã‚¹"}]},{name:"é‡‘è‰²ã®é­”è±¡",materialInfos:[{type:"Name",cardName:"ãƒ¡ãƒ‡ãƒ¥ãƒ¼ã‚µã®äº¡éœŠ"},{type:"Name",cardName:"ãƒ‰ãƒ©ã‚´ãƒ³ãƒ»ã‚¾ãƒ³ãƒ“"}]},{name:"ç´…é™½é³¥",materialInfos:[{type:"Name",cardName:"ã‚»ã‚¤ãƒ³ãƒˆãƒ»ãƒãƒ¼ãƒ‰"},{type:"Name",cardName:"ã‚¹ã‚«ã‚¤ãƒ»ãƒãƒ³ã‚¿ãƒ¼"}]},{name:"è½Ÿãã®å¤§æµ·è›‡",materialInfos:[{type:"Name",cardName:"é­”æ³•ã®ãƒ©ãƒ³ãƒ—"},{type:"Name",cardName:"ã²ã‚‡ã†ã™ã¹"}]},{name:"é»’ãäººé£Ÿã„é®«",materialInfos:[{type:"Name",cardName:"ã‚·ãƒ¼ã‚«ãƒ¼ãƒ¡ãƒ³"},{type:"Name",cardName:"ã‚­ãƒ©ãƒ¼ãƒ»ãƒ–ãƒ­ãƒƒãƒ–"},{type:"Name",cardName:"æµ·åŽŸã®å¥³æˆ¦å£«"}]},{name:"ç ‚ã®é­”å¥³",materialInfos:[{type:"Name",cardName:"å²©çŸ³ã®å·¨å…µ"},{type:"Name",cardName:"ã‚¨ãƒ³ã‚·ã‚§ãƒ³ãƒˆãƒ»ã‚¨ãƒ«ãƒ•"}]},{name:"è£ãã®é·¹",materialInfos:[{type:"Name",cardName:"å† ã‚’æˆ´ãè’¼ãç¿¼"},{type:"Name",cardName:"ã‚³ã‚±"}]},{name:"è£ãã‚’ä¸‹ã™å¥³å¸",materialInfos:[{type:"Name",cardName:"å¥³çŽ‹ã®å½±æ­¦è€…"},{type:"Name",cardName:"éŸ¿å¥³"}]},{name:"æœ±é›€",materialInfos:[{type:"Name",cardName:"èµ¤ãå‰£ã®ãƒ©ã‚¤ãƒ ãƒ³ãƒ‰ã‚¹"},{type:"Name",cardName:"ç‚Žã®é­”ç¥ž"}]},{name:"æ·±æµ·ã«æ½œã‚€ã‚µãƒ¡",materialInfos:[{type:"Name",cardName:"ç¥žé­š"},{type:"Name",cardName:"èˆŒé­š"}]},{name:"æ°´é™¸ä¸¡ç”¨ãƒã‚°ãƒ­ã‚¹",materialInfos:[{type:"Name",cardName:"é™¸æˆ¦åž‹ ãƒã‚°ãƒ­ã‚¹"},{type:"Name",cardName:"æµ·ã‚’å®ˆã‚‹æˆ¦å£«"}]},{name:"æˆ¦å ´ã®æ­»è£…æŸ",materialInfos:[{type:"Name",cardName:"éŸ³å¥³"},{type:"Name",cardName:"æ–¬é¦–ã®ç¾Žå¥³"}]},{name:"é­”è£…é¨Žå£«ãƒ‰ãƒ©ã‚´ãƒã‚¹",materialInfos:[{type:"Name",cardName:"ã‚¢ãƒ¼ãƒ¡ã‚¤ãƒ«"},{type:"Name",cardName:"ä¸€çœ¼ã®ç›¾ç«œ"}]},{name:"é­”å°Žé¨Žå£«ã‚®ãƒ«ãƒ†ã‚£ã‚¢",materialInfos:[{type:"Name",cardName:"å†¥ç•Œã®ç•ªäºº"},{type:"Name",cardName:"çŽ‹åº§ã®å®ˆè­·è€…"}]},{name:"é›·ç¥žã®æ€’ã‚Š",materialInfos:[{type:"Name",cardName:"ã‚¨ãƒ³ã‚¼ãƒ«ãƒ»ã‚¤ãƒ¤ãƒ¼ã‚º"},{type:"Name",cardName:"ãƒ¡ã‚¬ãƒ»ã‚µãƒ³ãƒ€ãƒ¼ãƒœãƒ¼ãƒ«"}]},{name:"ã‚«ã‚¤ã‚¶ãƒ¼ãƒ»ãƒ‰ãƒ©ã‚´ãƒ³",materialInfos:[{type:"Name",cardName:"ç ¦ã‚’å®ˆã‚‹ç¿¼ç«œ"},{type:"Name",cardName:"ãƒ•ã‚§ã‚¢ãƒªãƒ¼ãƒ»ãƒ‰ãƒ©ã‚´ãƒ³"}]},{name:"ã‚¹ã‚«ãƒ«ãƒ“ã‚·ãƒ§ãƒƒãƒ—",materialInfos:[{type:"Name",cardName:"æ‚ªé­”ã®çŸ¥æµ"},{type:"Name",cardName:"é­”å¤©è€"}]},{name:"ãƒ‡ãƒ“ãƒ«ãƒ»ãƒœãƒƒã‚¯ã‚¹",materialInfos:[{type:"Name",cardName:"ãƒžãƒ¼ãƒ€ãƒ¼ã‚µãƒ¼ã‚«ã‚¹"},{type:"Name",cardName:"ãƒ‰ãƒªãƒ¼ãƒ ãƒ»ãƒ”ã‚¨ãƒ­"}]},{name:"ãƒ’ãƒ¥ãƒ¼ãƒžãƒŽã‚¤ãƒ‰ãƒ»ãƒ‰ãƒ¬ã‚¤ã‚¯",materialInfos:[{type:"Name",cardName:"ãƒ¯ãƒ¼ãƒ ãƒ‰ãƒ¬ã‚¤ã‚¯"},{type:"Name",cardName:"ãƒ’ãƒ¥ãƒ¼ãƒžãƒŽã‚¤ãƒ‰ãƒ»ã‚¹ãƒ©ã‚¤ãƒ "}]},{name:"ãƒ–ãƒ©ãƒƒã‚¯ãƒ»ãƒ‡ãƒ¼ãƒ¢ãƒ³ã‚ºãƒ»ãƒ‰ãƒ©ã‚´ãƒ³",materialInfos:[{type:"Name",cardName:"ãƒ‡ãƒ¼ãƒ¢ãƒ³ã®å¬å–š"},{type:"Name",cardName:"çœŸç´…çœ¼ã®é»’ç«œ"}]},{name:"ãƒžã‚¹ã‚¿ãƒ¼ãƒ»ã‚ªãƒ–ãƒ»ï¼¯ï¼º",materialInfos:[{type:"Name",cardName:"ãƒ“ãƒƒã‚°ãƒ»ã‚³ã‚¢ãƒ©"},{type:"Name",cardName:"ãƒ‡ã‚¹ãƒ»ã‚«ãƒ³ã‚¬ãƒ«ãƒ¼"}]},{name:"ãƒ¡ãƒ†ã‚ªãƒ»ãƒ–ãƒ©ãƒƒã‚¯ãƒ»ãƒ‰ãƒ©ã‚´ãƒ³",materialInfos:[{type:"Name",cardName:"çœŸç´…çœ¼ã®é»’ç«œ"},{type:"Name",cardName:"ãƒ¡ãƒ†ã‚ªãƒ»ãƒ‰ãƒ©ã‚´ãƒ³"}]},{name:"å¬å–šç£ãƒ¡ã‚¬ãƒ©ãƒ‹ã‚«",materialInfos:[{type:"Name",cardName:"å¬å–šå¸«ã‚¢ãƒ¬ã‚¤ã‚¹ã‚¿ãƒ¼"},{type:"Name",cardName:"åœ°å±žæ€§ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼"}]},{name:"è–å¥³ã‚¸ãƒ£ãƒ³ãƒŒ",materialInfos:[{type:"Name",cardName:"æ…ˆæ‚²æ·±ãä¿®é“å¥³"},{type:"Name",cardName:"å •å¤©ä½¿ãƒžãƒªãƒ¼"}]},{name:"é’çœ¼ã®ç©¶æ¥µç«œ",materialInfos:[{type:"Name",cardName:"é’çœ¼ã®ç™½é¾"},{type:"Name",cardName:"é’çœ¼ã®ç™½é¾"},{type:"Name",cardName:"é’çœ¼ã®ç™½é¾"}]},{name:"åƒå¹´ç«œ",materialInfos:[{type:"Name",cardName:"æ™‚ã®é­”è¡“å¸«"},{type:"Name",cardName:"ãƒ™ãƒ“ãƒ¼ãƒ‰ãƒ©ã‚´ãƒ³"}]},{name:"åŒé ­ã®é›·é¾",materialInfos:[{type:"Name",cardName:"ã‚µãƒ³ãƒ€ãƒ¼ãƒ»ãƒ‰ãƒ©ã‚´ãƒ³"},{type:"Name",cardName:"ã‚µãƒ³ãƒ€ãƒ¼ãƒ»ãƒ‰ãƒ©ã‚´ãƒ³"}]},{name:"è¿·å®®ã®é­”æˆ¦è»Š",materialInfos:[{type:"Name",cardName:"ã‚®ã‚¬ãƒ†ãƒƒã‚¯ãƒ»ã‚¦ãƒ«ãƒ•"},{type:"Name",cardName:"ã‚­ãƒ£ãƒŽãƒ³ãƒ»ã‚½ãƒ«ã‚¸ãƒ£ãƒ¼"}]},{name:"ç«œé¨Žå£«ã‚¬ã‚¤ã‚¢",materialInfos:[{type:"Name",cardName:"æš—é»’é¨Žå£«ã‚¬ã‚¤ã‚¢"},{type:"Name",cardName:"ã‚«ãƒ¼ã‚¹ãƒ»ã‚ªãƒ–ãƒ»ãƒ‰ãƒ©ã‚´ãƒ³"}]},{name:"ã‚¢ã‚¯ã‚¢ãƒ»ãƒ‰ãƒ©ã‚´ãƒ³",materialInfos:[{type:"Name",cardName:"ãƒ•ã‚§ã‚¢ãƒªãƒ¼ãƒ»ãƒ‰ãƒ©ã‚´ãƒ³"},{type:"Name",cardName:"æµ·åŽŸã®å¥³æˆ¦å£«"}]},{name:"ã‚¢ãƒ³ãƒ‡ãƒƒãƒˆãƒ»ã‚¦ã‚©ãƒ¼ãƒªã‚¢ãƒ¼",materialInfos:[{type:"Name",cardName:"ãƒ¯ã‚¤ãƒˆ"},{type:"Name",cardName:"æ ¼é—˜æˆ¦å£«ã‚¢ãƒ«ãƒ†ã‚£ãƒ¡ãƒ¼ã‚¿ãƒ¼"}]},{name:"ã‚«ã‚ªã‚¹ãƒ»ã‚¦ã‚£ã‚¶ãƒ¼ãƒ‰",materialInfos:[{type:"Name",cardName:"ãƒ›ãƒ¼ãƒªãƒ¼ãƒ»ã‚¨ãƒ«ãƒ•"},{type:"Name",cardName:"é»’é­”æ—ã®ã‚«ãƒ¼ãƒ†ãƒ³"}]},{name:"ã‚¯ãƒ¯ã‚¬ãƒ¼ãƒ»ãƒ˜ãƒ©ã‚¯ãƒ¬ã‚¹",materialInfos:[{type:"Name",cardName:"ã‚¯ãƒ¯ã‚¬ã‚¿ãƒ»ã‚¢ãƒ«ãƒ•ã‚¡"},{type:"Name",cardName:"ãƒ˜ãƒ©ã‚¯ãƒ¬ã‚¹ãƒ»ãƒ“ãƒ¼ãƒˆãƒ«"}]},{name:"ã‚½ã‚¦ãƒ«ãƒ»ãƒãƒ³ã‚¿ãƒ¼",materialInfos:[{type:"Name",cardName:"ãƒ©ãƒ³ãƒ—ã®é­”äºº"},{type:"Name",cardName:"ç•°æ¬¡å…ƒã‹ã‚‰ã®ä¾µç•¥è€…"}]},{name:"ãƒ‡ã‚¹ãƒ»ãƒãƒ¼ãƒ‰",materialInfos:[{type:"Name",cardName:"ã‚¿ã‚¯ãƒ’"},{type:"Name",cardName:"é«‘é«ã®å¯ºé™¢"}]},{name:"ãƒ•ãƒ©ãƒ¯ãƒ¼ãƒ»ã‚¦ãƒ«ãƒ•",materialInfos:[{type:"Name",cardName:"ã‚·ãƒ«ãƒãƒ¼ãƒ»ãƒ•ã‚©ãƒ³ã‚°"},{type:"Name",cardName:"é­”ç•Œã®ã‚¤ãƒãƒ©"}]},{name:"ãƒ•ãƒ¬ã‚¤ãƒ ãƒ»ã‚´ãƒ¼ã‚¹ãƒˆ",materialInfos:[{type:"Name",cardName:"ãƒ¯ã‚¤ãƒˆ"},{type:"Name",cardName:"ãƒžã‚°ãƒžãƒ³"}]},{name:"ãƒžãƒªãƒ³ãƒ»ãƒ“ãƒ¼ã‚¹ãƒˆ",materialInfos:[{type:"Name",cardName:"æ°´ã®é­”å°Žå¸«"},{type:"Name",cardName:"ãƒ™ãƒ’ã‚´ãƒ³"}]},{name:"ãƒ¡ã‚«ãƒ»ã‚¶ã‚¦ãƒ«ã‚¹",materialInfos:[{type:"Name",cardName:"ãƒŸã‚¹ã‚¿ãƒ¼ãƒ»ãƒœãƒ³ãƒãƒ¼"},{type:"Name",cardName:"äºŒé ­ã‚’æŒã¤ã‚­ãƒ³ã‚°ãƒ»ãƒ¬ãƒƒã‚¯ã‚¹"}]},{name:"ãƒ¡ã‚¿ãƒ«ãƒ»ãƒ‰ãƒ©ã‚´ãƒ³",materialInfos:[{type:"Name",cardName:"é‹¼é‰„ã®å·¨ç¥žåƒ"},{type:"Name",cardName:"ãƒ¬ãƒƒã‚µãƒ¼ãƒ»ãƒ‰ãƒ©ã‚´ãƒ³"}]},{name:"ãƒ¬ã‚¢ãƒ»ãƒ•ã‚£ãƒƒã‚·ãƒ¥",materialInfos:[{type:"Name",cardName:"ãƒ•ãƒ¥ãƒ¼ã‚¸ãƒ§ãƒ‹ã‚¹ãƒˆ"},{type:"Name",cardName:"ææƒšã®äººé­š"}]},{name:"ç„¡ã®ç•¢ç«Ÿ ã‚ªãƒ¼ãƒ«ãƒ´ã‚§ã‚¤ãƒ³",materialInfos:[{type:"Filter",filter:e=>{var i;return((i=e.status.monsterCategories)==null?void 0:i.includes("Normal"))??!1}},{type:"Filter",filter:e=>{var i;return((i=e.status.monsterCategories)==null?void 0:i.includes("Normal"))??!1}}]},{name:"ãƒ†ã‚»ã‚¦ã‚¹ã®é­”æ£²ç‰©",materialInfos:[{type:"Filter",filter:e=>{var i;return((i=e.status.monsterCategories)==null?void 0:i.includes("Tuner"))??!1}},{type:"Filter",filter:e=>{var i;return((i=e.status.monsterCategories)==null?void 0:i.includes("Tuner"))??!1}}]},{name:"ã‚¸ã‚§ãƒ ãƒŠã‚¤ãƒˆãƒ»ã‚¸ãƒ«ã‚³ãƒ‹ã‚¢",materialInfos:[{type:"Filter",filter:e=>{var i;return((i=e.status.nameTags)==null?void 0:i.includes("ã‚¸ã‚§ãƒ ãƒŠã‚¤ãƒˆ"))??!1}},{type:"Filter",filter:e=>e.types.includes("Rock")??!1}]},{name:"ãƒ¡ã‚¿ãƒ«ãƒ•ã‚©ãƒ¼ã‚¼ãƒ»ã‚¢ãƒ€ãƒžãƒ³ãƒ†",materialInfos:[{type:"Filter",filter:e=>{var i;return((i=e.status.nameTags)==null?void 0:i.includes("ãƒ¡ã‚¿ãƒ«ãƒ•ã‚©ãƒ¼ã‚¼"))??!1}},{type:"Filter",filter:e=>(e.atk??9999)<=2500}]},{name:"ãƒ¡ã‚¿ãƒ«ãƒ•ã‚©ãƒ¼ã‚¼ãƒ»ã‚«ãƒ¼ãƒ‡ã‚£ãƒŠãƒ«",materialInfos:[{type:"Filter",filter:e=>{var i;return((i=e.status.nameTags)==null?void 0:i.includes("ãƒ¡ã‚¿ãƒ«ãƒ•ã‚©ãƒ¼ã‚¼"))??!1}},{type:"Filter",filter:e=>(e.atk??9999)<=3e3},{type:"Filter",filter:e=>(e.atk??9999)<=3e3}]}];for(const e of t)yield{name:e.name,actions:[],fusionMaterialInfos:e.materialInfos}}const cs=Object.freeze(Object.defineProperty({__proto__:null,default:Nd},Symbol.toStringTag,{value:"Module"})),Bd=async(t,e,i=!1)=>{if(!t.action.entity.lvl)return;if(t.action.entity.lvl<5)return{};const a=t.activator.getAvailableMonsterZones();let r=t.activator.getMonstersOnField().filter(u=>u.canBeReleased(t.activator,t.action.entity,["AdvanceSummonRelease"],t.action));const n=t.activator.getExtraMonsterZones(),s=t.action.entity.lvl<7?1:2;n.length>=s&&(r=r.filter(u=>u.cell.cellType!=="ExtraMonsterZone"));const l=await t.activator.waitSelectEntities(r,s,u=>(i||u.length>0)&&(s<0||u.length===s)&&(a.length>0||u.some(d=>d.cell.cellType==="ExtraMonsterZone")),"ãƒªãƒªãƒ¼ã‚¹ã™ã‚‹ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã‚’é¸æŠž",i)??[];return l.length?(await _.releaseManyForTheSameReason(l,["Cost","AdvanceSummonRelease","Rule"],t.action.entity,t.activator),{summonMaterialInfos:l.map(u=>({material:u,cell:u.cell}))}):void 0},Ld=async t=>{var r;const e=["Rule","NormalSummon"];let i="NormalSummon";(r=t.costInfo.summonMaterialInfos)!=null&&r.length&&(i="AdvanceSummon",e.push("AdvanceSummon"));const a=t.dest?[t.dest]:t.activator.getAvailableMonsterZones();return ot(t,i,e,["Attack","Set"],a)},ot=async(t,e,i,a,r)=>{let n=t.dest?[t.dest]:r;return n||(n=t.activator.getMonsterZones(),t.action.entity.cell.cellType==="ExtraDeck"&&n.push(...t.activator.duel.field.getCells("ExtraMonsterZone"))),await t.activator.summon(e,i,t.action,t.action.entity,a,n,t.costInfo.summonMaterialInfos??[],!1),{selectedEntities:[]}},ct=async t=>{var e,i;return t.action.entity.info.isRebornable=!((e=t.action.entity.origin.monsterCategories)!=null&&e.includes("RegularSpecialSummonOnly")),await t.action.entity.determine(),(i=t.costInfo.summonMaterialInfos)==null||i.map(a=>a.material).forEach(a=>a.onUsedAsMaterial(t,t.action.entity)),!0},qd={title:"é€šå¸¸å¬å–š",isMandatory:!1,playType:"NormalSummon",spellSpeed:"Normal",executableCells:["Hand"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],canPayCosts:t=>{if(!t.action.entity.lvl)return!1;if(t.action.entity.lvl<5)return t.activator.getEnableSummonList(t.activator,"NormalSummon",["Rule"],t.action,[{monster:t.action.entity,posList:["Attack","Set"],cells:t.activator.getMonsterZones()}],[],!1).length>0;const e=t.activator.getMonstersOnField().filter(r=>r.canBeReleased(t.activator,t.action.entity,["AdvanceSummonRelease"],t.action)),i=t.action.entity.lvl<7?1:2;return e.length<i?!1:e.getAllOnOffPattern().filter(r=>r.length===i).some(r=>t.activator.getEnableSummonList(t.activator,"AdvanceSummon",["Rule","NormalSummon"],t.action,[{monster:t.action.entity,posList:["Attack","Set"],cells:t.activator.getMonsterZones()}],r.map(n=>({material:n,cell:n.cell})),!1).length)},meetsConditions:t=>t.activator.info.ruleNormalSummonCount<t.activator.info.maxRuleNormalSummonCount&&!!t.action.entity.lvl,getDests:t=>t.action.entity.lvl?t.action.entity.lvl>4?[]:t.activator.getEnableSummonList(t.activator,"NormalSummon",["Rule"],t.action,[{monster:t.action.entity,posList:["Attack","Set"],cells:t.activator.getMonsterZones()}],[],!1).flatMap(i=>i.cells).getDistinct():[],payCosts:Bd,prepare:Ld,execute:ct,settle:async()=>!0},Ot=(t,e,i,a)=>{const r=t.activator.getMonsterZones();return t.action.entity.cell.cellType==="ExtraDeck"&&r.push(...t.activator.getAvailableExtraMonsterZones()),t.activator.getEnableSummonList(t.activator,"SpecialSummon",a,t.action,[{monster:t.action.entity,posList:e,cells:r}],i,!1).flatMap(s=>s.cells)},fe=(...t)=>Ot(...t).length>0,Rd={title:"æ”»æ’ƒå®£è¨€",isMandatory:!1,playType:"DeclareAttack",spellSpeed:"Normal",executableCells:["MonsterZone","ExtraMonsterZone"],executablePeriods:["b1Battle","b2Battle"],executableDuelistTypes:["Controller"],hasToTargetCards:!0,getTargetableEntities:t=>t.action.entity.getAttackTargets(),canExecute:(t,e)=>!t.activator.isTurnPlayer||!t.action.entity.isMonster||!t.action.entity.status.canAttack||t.action.entity.info.attackDeclareCount>0||t.action.entity.battlePosition!=="Attack"?!1:t.action.getTargetableEntities(t,e).length>0,getDests:(t,e)=>t.action.getTargetableEntities(t,e).map(i=>i.cell),prepare:async(t,e)=>{var r,n;if(t.action.entity.info.attackDeclareCount>0||t.action.entity.battlePosition!=="Attack")return;const i=t.action.getTargetableEntities(t,e);if(i.length===0)throw new S("æ”»æ’ƒå¯¾è±¡ã®é¸æŠžè‚¢ãŒãªã„çŠ¶æ…‹ã§å®Ÿè¡Œã•ã‚ŒãŸã€‚",t);let a=i[0];for(;i.length!==1;){if((r=t.dest)!=null&&r.targetForAttack){a=t.dest.entities.find(o=>o.entityType==="Duelist")??((n=t.dest)==null?void 0:n.targetForAttack);break}if(t.activator.duelistType==="NPC"){let l=t.activator.selectAttackTargetForNPC(t.action.entity,t.action);l||(t.activator.duel.log.warn("NPCã®æ”»æ’ƒå¯¾è±¡é¸æŠžã«å¤±æ•—ã—ãŸãŸã‚ã€ãƒ©ãƒ³ãƒ€ãƒ ã«æ”»æ’ƒå¯¾è±¡ã‚’é¸æŠžã€‚"),l=i.randomPick());break}const s=await t.activator.waitSelectEntity(i,"æ”»æ’ƒå¯¾è±¡ã‚’é¸æŠžã€‚",!0);if(!s)return;a=s;break}return t.action.entity.field.duel.declareAttack(t.action.entity,a,!1),{selectedEntities:[a]}},execute:async()=>!0,settle:async()=>!0},Hd={title:"æˆ¦é—˜",isMandatory:!1,playType:"Battle",spellSpeed:"Normal",executableCells:["MonsterZone","ExtraMonsterZone"],executablePeriods:["b1DDmgCalc","b2DDmgCalc"],executableDuelistTypes:["Controller"],hasToTargetCards:!0,canExecute:t=>!!t.activator.duel.targetForAttack&&t.activator.duel.attackingMonster===t.action.entity&&t.action.entity.isMonster,prepare:async t=>{if(t.activator.duel.attackingMonster!==t.action.entity)throw new S("canExecuteã®åˆ¤å®šãŒæ­£ã—ãè¡Œã‚ã‚Œãªã‹ã£ãŸ",t,t.activator.duel.attackingMonster,t.activator.duel.targetForAttack);if(!t.activator.duel.targetForAttack)throw new S("canExecuteã®åˆ¤å®šãŒæ­£ã—ãè¡Œã‚ã‚Œãªã‹ã£ãŸ",t,t.activator.duel.attackingMonster,t.activator.duel.targetForAttack);return{selectedEntities:[t.activator.duel.targetForAttack]}},execute:async()=>!0,settle:async()=>!0},us=async t=>{if(!(t.action.entity.info.battlePotisionChangeCount>0||!t.activator.isTurnPlayer))return await t.action.entity.setBattlePosition(t.action.entity.battlePosition==="Attack"?"Defense":"Attack",["Rule"],t.action.entity,t.activator),t.action.entity.info.battlePotisionChangeCount++,{selectedEntities:[]}},Zd={title:"åè»¢å¬å–š",isMandatory:!1,playType:"FlipSummon",spellSpeed:"Normal",executableCells:["MonsterZone","ExtraMonsterZone"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],canExecute:t=>t.action.entity.info.battlePotisionChangeCount===0&&t.action.entity.info.attackDeclareCount===0&&t.activator.isTurnPlayer&&t.action.entity.face==="FaceDown"&&t.action.entity.isMonster,prepare:us,execute:async t=>(await t.action.entity.determine(),!0),settle:async()=>!0},Gd={title:"è¡¨ç¤ºå½¢å¼å¤‰æ›´",isMandatory:!1,playType:"ChangeBattlePosition",spellSpeed:"Normal",executableCells:["MonsterZone","ExtraMonsterZone"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],meetsConditions:t=>t.action.entity.info.battlePotisionChangeCount===0&&t.action.entity.info.attackDeclareCount===0&&t.action.entity.status.canBattlePositionChange,canExecute:t=>t.activator.isTurnPlayer&&t.action.entity.face==="FaceUp"&&t.action.entity.isOnFieldAsMonsterStrictly,prepare:us,execute:async t=>(await t.action.entity.determine(),!0),settle:async()=>!0},Pe=async(t,e,i=["Attack","Defense"])=>{const a=t.activator.getMonsterZones();return t.action.entity.wasMovedAfter(t.isActivatedAt)?!1:!!await t.activator.summon("SpecialSummon",["Effect"],t.action,t.action.entity,i,a,[],!1)},ds=[Rd,Hd],ji=[...ds,Gd,Zd],jr=[qd,...ji],$a=(t,e,i,a,r,n,s,l,o,u,d)=>{const f={posList:o,cells:u},p={posList:[],cells:[]};return e!==s||!s.isMonster||!s.origin.monsterCategories?f:s.origin.monsterCategories.includes("NormalSummonOnly")?r.includes("NormalSummon")||r.includes("AdvanceSummon")?f:p:s.origin.monsterCategories.includes("SpecialSummon")?s.origin.monsterCategories.includes("FreeReborn")?r.includes("Effect")?f:p:s.isInTrashCell&&!s.origin.monsterCategories.includes("RegularSpecialSummonOnly")?s.info.isRebornable?f:p:r.union(Vn).length?f:s.origin.monsterCategories.includes("RegularSpecialSummonOnly")?d?f:p:f:f},Ca={},$d=t=>(Ca[t]||(Ca[t]={title:`æˆ¦é—˜ç ´å£Šè€æ€§(${t})`,playType:"ContinuousEffect",isMandatory:!0,executableCells:["MonsterZone"],executablePeriods:["b1DDmgCalc","b2DDmgCalc"],executableDuelistTypes:["Controller"],isOnlyNTimesPerTurnIfFaceup:t,isApplicableTo:(e,i,a)=>a.includes(e.entity)?i!=="Battle"?[]:[e.entity]:[],substitute:async(e,i,a)=>a.includes(e.entity)?i!=="Battle"?[]:e.entity.isEffective?(e.entity.controller.writeInfoLog(`${e.entity.toString()}ã¯ï¼‘ã‚¿ãƒ¼ãƒ³ã«ï¼‘åº¦ã ã‘æˆ¦é—˜ã§ã¯ç ´å£Šã•ã‚Œãªã„ã€‚`),[e.entity]):[]:[]}),Ca[t]),fa=t=>t.activator.canRelease([t.action.entity])&&t.action.entity.canBeReleased(t.activator,t.action.entity,["ReleaseAsCost"],t.action),pa=async t=>(await t.action.entity.release(["Cost"],t.action.entity,t.activator),{release:[t.action.entity]}),fs=t=>({title:"ã‚·ãƒ³ã‚¯ãƒ­å¬å–š",isMandatory:!1,playType:"QuickEffect",spellSpeed:"Quick",executableCells:H,executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],isOnlyNTimesPerChain:1,meetsConditions:e=>!e.activator.isTurnPlayer,canExecute:e=>e.activator.getExtraDeck().cardEntities.filter(i=>{var a;return(a=i.status.monsterCategories)==null?void 0:a.includes("Synchro")}).flatMap(i=>i.actions).filter(i=>i.playType==="SpecialSummon").map(i=>({index:-1,chainNumber:void 0,action:i,activator:e.activator,targetChainBlock:void 0,isActivatedIn:i.entity.cell,costInfo:{},state:"unloaded",dest:void 0,ignoreCosts:!1})).some(i=>i.action.getEnableMaterialPatterns(i).some(a=>{const r=a.map(n=>n.material);return r.every(n=>n.controller===e.activator)&&r.every(n=>n.isOnFieldAsMonsterStrictly)&&r.includes(e.action.entity)})),prepare:T,execute:async e=>{if(e.activator!==e.action.entity.controller||e.activator.getMonstersOnField().filter(s=>s.lvl!==void 0).length<2)return!1;const i=e.activator.getExtraDeck().cardEntities.filter(s=>{var l;return(l=s.status.monsterCategories)==null?void 0:l.includes("Synchro")}).flatMap(s=>s.actions).filter(s=>s.playType==="SpecialSummon").map(s=>({index:-1,chainNumber:void 0,action:s,activator:e.activator,targetChainBlock:void 0,isActivatedIn:s.entity.cell,isActivatedAt:e.isActivatedAt,costInfo:{},state:"unloaded",dest:void 0,ignoreCosts:!1})).filter(s=>s.action.getEnableMaterialPatterns(s).some(l=>{const o=l.map(u=>u.material);return o.every(u=>u.controller===e.activator)&&o.every(u=>u.isOnFieldAsMonsterStrictly)&&o.includes(e.action.entity)})).map(s=>s.action.entity).getDistinct();if(!i.length)return!1;const a=await e.activator.waitSelectEntities(i,1,s=>s.length===1,"ã‚·ãƒ³ã‚¯ãƒ­å¬å–šã™ã‚‹ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã‚’é¸æŠžã€‚",!1)??[];if(!a.length)throw new S("æƒ³å®šã•ã‚Œãªã„çŠ¶æ…‹",e);const r=a[0].actions.find(s=>s.playType==="SpecialSummon");if(!r)throw new S("æƒ³å®šã•ã‚Œãªã„çŠ¶æ…‹",e);const n=r.getClone(s=>{const l=s.map(o=>o.material);return l.every(o=>o.controller===e.activator)&&l.every(o=>o.isOnFieldAsMonsterStrictly)&&l.includes(e.action.entity)});return e.nextActionInfo={action:n,originSeq:n.seq},!0},settle:async()=>!0,...t}),Ud=ni("ç›´æŽ¥æ”»æ’ƒ","Monster",t=>[t],t=>[new oe({title:"ç›´æŽ¥æ”»æ’ƒ",validateAlive:()=>!0,isContinuous:!0,isSpawnedBy:t,actionAttr:{},isApplicableTo:(e,i)=>e.isSpawnedBy===i,statusCalculator:()=>({canDirectAttack:!0})})]),wa={title:"èžåˆç´ æä»£ç”¨",appliableCellTypes:["MonsterZone","ExtraMonsterZone","Hand","Graveyard "],appliableDuelPeriodKeys:le,faceList:["FaceUp","FaceDown"],canStart:()=>!0,start:async t=>{const e=new oe({title:"èžåˆç´ æä»£ç”¨",validateAlive:()=>!0,isContinuous:!0,isSpawnedBy:t,actionAttr:{},isApplicableTo:()=>!0,statusCalculator:(i,a,r)=>(a.isSpawnedBy.isEffective&&(r.fusionSubstitute=!0),r)});return t.statusOperatorBundle.push(e),{targets:[t],seq:e.seq}},finish:async(t,e)=>{e.targets.forEach(i=>i.statusOperatorBundle.removeItem(e.seq))}},jd=(t,e,i,a)=>{if(!t.action.entity.origin.link||t.action.entity.origin.link<i.length)return;let r=i.map(s=>({material:s,cell:s.cell,link:1}));if(t.action.entity.origin.link>i.length){if(i.every(o=>(o.origin.link??1)<2))return;const s=[r];i.filter(o=>(o.origin.link??1)>1).forEach(o=>{[...s].forEach(u=>{s.push([...u.filter(d=>d.material!==o),{material:o,cell:o.cell,link:o.origin.link??1}])})});const l=s.find(o=>o.reduce((u,d)=>u+d.link,0)===t.action.entity.origin.link);if(!l)return;r=l}if(!a(i)||!t.activator.getEnableSummonList(t.activator,"LinkSummon",["Rule","SpecialSummon"],t.action,[{monster:t.action.entity,posList:["Attack"],cells:e}],r,!1).length)return;if(t.activator.getAvailableExtraMonsterZones().length)return r;const n=t.activator.duel.field.getCells("ExtraMonsterZone").map(s=>s.cardEntities[0]).filter(s=>s);if(n.filter(s=>s.controller===t.activator).length&&n.filter(s=>s.controller===t.activator).length===i.filter(s=>s.cell.cellType==="ExtraMonsterZone").length||t.activator.getMonsterZones().flatMap(s=>s.linkArrowSources).some(s=>!i.includes(s))||t.activator.duel.field.canExtraLink(t.action.entity,r))return r};function*zd(t,e=()=>!0){let i=[...t.activator.getMonstersOnField().filter(r=>r.battlePosition!=="Set"),...t.activator.getHandCell().entities.filter(r=>r.origin.kind==="Monster")];if(i.every(r=>!r.status.allowHandLink)&&(i=i.filter(r=>r.cell.isPlayFieldCell)),i.length<1)return;const a=[...t.activator.getMonsterZones(),...t.activator.duel.field.getAvailableExtraMonsterZones()];yield*i.getAllOnOffPattern().filter(r=>r.some(n=>n.status.allowHandLink)||r.every(n=>n.isOnFieldAsMonsterStrictly)).map(r=>jd(t,a,r,e)??[]).filter(r=>r.length)}const Vd=async(t,e,i)=>{var o;const a=t.action.getEnableMaterialPatterns(t).toArray(),r=a.map(u=>({infos:u,materialSeqList:u.map(d=>d.material.seq).sort()}));let n=a[0].map(u=>u.material);if(a.length>1){const u=a.flatMap(f=>f.map(p=>p.material)).getDistinct(),d=await t.activator.waitSelectEntities(u,void 0,f=>{const p=f.map(h=>h.seq).sort();return r.some(h=>p.length===h.materialSeqList.length&&p.every((y,v)=>y===h.materialSeqList[v]))},"ãƒªãƒ³ã‚¯ç´ æã¨ã™ã‚‹ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã‚’é¸æŠž",i);if(console.log(d),!d)return;n=d}const s=n.map(u=>u.seq).sort(),l=(o=r.find(u=>s.length===u.materialSeqList.length&&s.every((d,f)=>d===u.materialSeqList[f])))==null?void 0:o.infos;if(!l)throw new S("æƒ³å®šã•ã‚Œãªã„çŠ¶æ…‹",t,n);return await _.sendManyToGraveyardForTheSameReason(n,["LinkMaterial","Cost","Rule","SpecialSummonMaterial"],t.action.entity,t.activator),{summonMaterialInfos:l}},yi=(t=()=>!0)=>({title:"ãƒªãƒ³ã‚¯å¬å–š",isMandatory:!1,playType:"SpecialSummon",spellSpeed:"Normal",executableCells:["ExtraDeck"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],getEnableMaterialPatterns:e=>zd(e,t),canPayCosts:e=>e.action.getEnableMaterialPatterns(e).some(i=>i.length),canExecute:e=>!e.ignoreCosts||e.activator.getAvailableExtraMonsterZones().length+e.activator.getAvailableMonsterZones().length>0,payCosts:Vd,prepare:e=>ot(e,"LinkSummon",["Rule","SpecialSummon","LinkSummon"],["Attack"]),execute:ct,settle:async()=>!0});function*Wd(){yield*[{name:"ï¼¬ï¼¡ï¼®ãƒ•ã‚©ãƒªãƒ³ã‚¯ã‚¹",validator:t=>t.length===2},{name:"ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ã‚´ãƒ¼ã‚¹ãƒˆ",validator:t=>t.length===3},{name:"å¤©å¨ã®é¬¼ç¥ž",validator:t=>t.length>1&&t.some(e=>{var i;return(i=e.status.monsterCategories)==null?void 0:i.includes("Link")})},{name:"å¤©å¨ã®æ‹³åƒ§",validator:t=>t.every(e=>{var i,a;return((i=e.status.nameTags)==null?void 0:i.includes("å¤©å¨"))&&!((a=e.status.monsterCategories)!=null&&a.includes("Link"))})},{name:"é›»å½±ã®é¨Žå£«ã‚¬ã‚¤ã‚¢ã‚»ã‚¤ãƒãƒ¼",validator:t=>t.length>1}].map(t=>({name:t.name,actions:[yi(t.validator)]}))}const ps=Object.freeze(Object.defineProperty({__proto__:null,default:Wd},Symbol.toStringTag,{value:"Module"}));function*Qd(){yield*["ã‚µã‚¤ãƒãƒ¼ãƒ»ãƒ‰ãƒ©ã‚´ãƒ³","å…­æ­¦è¡†ã®ã”éš å±…","ã‚¢ãƒ³ãƒŽã‚¦ãƒ³ãƒ»ã‚·ãƒ³ã‚¯ãƒ­ãƒ³"].map(t=>({name:t,actions:[{title:"ç‰¹æ®Šå¬å–š",isMandatory:!1,playType:"SpecialSummon",spellSpeed:"Normal",executableCells:["Hand"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],isOnlyNTimesPerDuel:t==="ã‚¢ãƒ³ãƒŽã‚¦ãƒ³ãƒ»ã‚·ãƒ³ã‚¯ãƒ­ãƒ³"?1:void 0,canExecute:e=>{const i=e.action.entity.field.getMonstersOnFieldStrictly();return i.length>0&&i.every(a=>a.controller!==e.activator)&&fe(e,k,[],["Rule"])},getDests:e=>Ot(e,k,[],["Rule"]),prepare:e=>ot(e,"SpecialSummon",["SpecialSummon","Rule"],k),execute:ct,settle:async()=>!0}]})),yield{name:"ã‚¸ãƒ£ãƒ³ã‚¯ãƒ»ãƒ•ã‚©ã‚¢ãƒ¼ãƒ‰",actions:[{title:"ç‰¹æ®Šå¬å–š",isMandatory:!1,playType:"SpecialSummon",spellSpeed:"Normal",executableCells:["Hand"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],canExecute:t=>t.activator.getMonstersOnField().length===0&&fe(t,k,[],["Rule"]),getDests:t=>Ot(t,k,[],["Rule"]),prepare:t=>ot(t,"SpecialSummon",["SpecialSummon","Rule"],k),execute:ct,settle:async()=>!0}]},yield{name:"ã‚¾ãƒ³ãƒ“ã‚­ãƒ£ãƒªã‚¢",actions:[{title:"â‘ è‡ªå·±å†ç”Ÿ",isMandatory:!1,playType:"IgnitionEffect",spellSpeed:"Normal",executableCells:["Graveyard"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],executableFaces:["FaceUp"],fixedTags:["SpecialSummonFromGraveyard"],canPayCosts:t=>t.activator.getHandCell().cardEntities.length>0,canExecute:t=>fe(t,k,[],["Effect"]),payCosts:async(t,e,i)=>{const a=t.activator.getHandCell().cardEntities,r=await t.activator.waitSelectEntity(a,"ãƒ‡ãƒƒã‚­ãƒˆãƒƒãƒ—ã«æˆ»ã™ã‚«ãƒ¼ãƒ‰ã‚’ä¸€æžšé¸æŠžã€‚",i);if(!r)throw new F(t);return await r.returnToDeck("Top",["Cost"],t.action.entity,t.activator),{returnToDeck:[r]}},prepare:async()=>({selectedEntities:[]}),execute:async t=>await Pe(t)?(t.action.entity.statusOperatorBundle.push(new oe({title:"é™¤å¤–äºˆå®š",validateAlive:()=>!0,isContinuous:!1,isSpawnedBy:t.action.entity,actionAttr:t.action,isApplicableTo:(e,i)=>i.isOnFieldAsMonsterStrictly&&i.face==="FaceUp",statusCalculator:()=>({willBeBanished:!0})})),!0):!1,settle:async()=>!0}]},yield{name:"ã‚°ãƒ­ãƒ¼ã‚¢ãƒƒãƒ—ãƒ»ãƒãƒ«ãƒ–",actions:[{title:"â‘ è‡ªå·±å†ç”Ÿ",isMandatory:!1,playType:"IgnitionEffect",spellSpeed:"Normal",executableCells:["Graveyard"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],executableFaces:["FaceUp"],isOnlyNTimesPerDuel:1,fixedTags:["SpecialSummonFromGraveyard"],canPayCosts:t=>t.activator.getDeckCell().cardEntities.length>0,getDests:t=>Ot(t,k,[],["Effect"]),canExecute:t=>fe(t,k,[],["Effect"]),payCosts:async t=>{const e=t.activator.getDeckCell().cardEntities[0];return await t.activator.getDeckCell().cardEntities[0].sendToGraveyard(["Cost"],t.action.entity,t.activator),{sendToGraveyard:[e]}},prepare:async()=>({selectedEntities:[]}),execute:t=>Pe(t),settle:async()=>!0}]},yield{name:"çµ‚æœ«ã®é¨Žå£«",actions:[{title:"â‘ å¢“åœ°é€ã‚Š",isMandatory:!1,playType:"TriggerEffect",spellSpeed:"Normal",executableCells:["MonsterZone"],executablePeriods:[...D,...O],executableDuelistTypes:["Controller"],triggerPattern:{triggerType:"Arrival",arrivalReasons:["NormalSummon","SpecialSummon","FlipSummon"]},canExecute:t=>t.activator.getDeckCell().cardEntities.some(e=>e.attr.includes("Dark")),prepare:async t=>{const e=["SendToGraveyardFromDeck"];return t.action.entity.moveLog.latestRecord.movedAs.includes("NormalSummon")?e.push("IfNormarlSummonSucceed"):t.action.entity.moveLog.latestRecord.movedAs.includes("SpecialSummon")&&e.push("IfSpecialSummonSucceed"),{selectedEntities:[],chainBlockTags:e}},execute:async t=>{const e=t.activator.getDeckCell().cardEntities.filter(a=>a.attr.includes("Dark"));if(e.length===0)return!1;const i=await t.activator.waitSelectEntity(e,"å¢“åœ°ã«é€ã‚‹ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã‚’é¸æŠž",!1);if(!i)throw new F(t);return await i.sendToGraveyard(["Effect"],t.action.entity,t.activator),t.activator.getDeckCell().shuffle(),!0},settle:async()=>!0}]},yield{name:"ãƒžã‚¹ãƒžãƒ†ã‚£ã‚·ãƒ£ãƒ³",actions:[{title:"â‘ å¢“åœ°é€ã‚Š",isMandatory:!1,playType:"TriggerEffect",spellSpeed:"Normal",executableCells:["MonsterZone"],executablePeriods:[...D,...O],executableDuelistTypes:["Controller"],triggerPattern:{triggerType:"Arrival",arrivalReasons:["NormalSummon"]},fixedTags:["IfNormarlSummonSucceed","SendToGraveyardFromDeck"],canExecute:t=>t.activator.getDeckCell().cardEntities.some(e=>e.lvl&&e.lvl<5),prepare:async()=>({selectedEntities:[]}),execute:async t=>{const e=t.activator.getDeckCell().cardEntities.filter(a=>a.lvl&&a.lvl<5);if(e.length===0)return!1;const i=await t.activator.waitSelectEntity(e,"å¢“åœ°ã«é€ã‚‹ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã‚’é¸æŠž",!1);if(!i)throw new F(t);return await i.sendToGraveyard(["Effect"],t.action.entity,t.activator),t.activator.getDeckCell().shuffle(),!0},settle:async()=>!0},{title:"â‘¡ãƒ‰ãƒ­ãƒ¼",isMandatory:!1,playType:"TriggerEffect",spellSpeed:"Normal",executableCells:["Graveyard"],executablePeriods:[...D,...O],executableDuelistTypes:["Controller"],triggerPattern:{triggerType:"Departure",needsByBattle:!0,needsByDestory:!0},fixedTags:["Draw"],canExecute:t=>t.activator.getDeckCell().cardEntities.length>0&&t.activator.canDraw,prepare:async()=>({selectedEntities:[]}),execute:async t=>(await t.activator.draw(1,t.action.entity,t.activator),!0),settle:async()=>!0}]},yield{name:"ä¼èª¬ã®ç™½çŸ³",actions:[{title:"â‘ ã‚µãƒ¼ãƒ",isMandatory:!0,playType:"TriggerEffect",spellSpeed:"Normal",executableCells:["Graveyard"],executablePeriods:le,executableDuelistTypes:["Controller"],triggerPattern:{triggerType:"Departure"},fixedTags:["SearchFromDeck"],canExecute:t=>t.activator.getDeckCell().cardEntities.some(e=>e.nm==="é’çœ¼ã®ç™½é¾")&&t.activator.canAddToHandFromDeck,prepare:async()=>({selectedEntities:[]}),execute:async t=>{const e=t.activator.getDeckCell().cardEntities.find(i=>i.nm==="é’çœ¼ã®ç™½é¾");return e?(await e.addToHand(["Effect"],t.action.entity,t.activator),t.activator.getDeckCell().shuffle(),!0):!1},settle:async()=>!0}]};for(const t of[{name:"ç°æµã†ã‚‰ã‚‰",chainBlockTags:["Draw","SearchFromDeck","SendToGraveyardFromDeck","SpecialSummonFromDeck"]},{name:"å±‹æ•·ã‚ã‚‰ã—",chainBlockTags:["BanishFromGraveyard","SpecialSummonFromGraveyard","AddToHandFromGraveyard"]}])yield{name:t.name,actions:[{title:"â‘ ç„¡åŠ¹åŒ–",isMandatory:!1,playType:"QuickEffect",spellSpeed:"Quick",executableCells:["Hand"],executablePeriods:D,executableDuelistTypes:["Controller"],isOnlyNTimesPerTurn:1,negatePreviousBlock:!0,fixedTags:["NegateCardEffect"],canPayCosts:e=>e.activator.canDiscard([e.action.entity]),canExecute:e=>(e.targetChainBlock&&e.targetChainBlock.chainBlockTags.union(t.chainBlockTags).length>0)??!1,payCosts:async e=>(await e.action.entity.discard(["Cost"],e.action.entity,e.activator),{sendToGraveyard:[e.action.entity]}),prepare:T,execute:async(e,i)=>{const a=i[e.index-1];return a.isNegatedEffectBy=e.action,!0},settle:async()=>!0}]};for(const t of["ç¿»å¼„ã™ã‚‹ã‚¨ãƒ«ãƒ•ã®å‰£å£«","ãƒ­ãƒ¼ãƒ‰ãƒ©ãƒ³ãƒŠãƒ¼","æ°·çµç•Œã®ä¿®é¨“è€…"])yield{name:t,actions:[],continuousEffects:[da("â‘ æˆ¦é—˜ç ´å£Šè€æ€§","Monster",e=>[e],e=>[He.createContinuous("â‘ æˆ¦é—˜ç ´å£Šè€æ€§",()=>!0,e,()=>!0,["BattleDestroy"],(i,a,r)=>!e.isEffective||(r.atk??0)<1900?!0:(e.duel.log.info(`${e.toString()}ã¯æ”»æ’ƒåŠ›1900ä»¥ä¸Šã®ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã¨ã®å…ˆé ­ã§ã¯ç ´å£Šã•ã‚Œãªã„ã€‚`,e.controller),!1))])]}}const gs=Object.freeze(Object.defineProperty({__proto__:null,default:Qd},Symbol.toStringTag,{value:"Module"})),Xd=(t,e,i,a,r,n)=>{if(!t.action.entity.origin.level||a.some(u=>!u.lvl)||a.map(u=>u.lvl??0).reduce((u,d)=>u+d,0)!==t.action.entity.origin.level)return;const s=a.filter(u=>{var d;return(d=u.status.monsterCategories)==null?void 0:d.some(f=>f==="Tuner")}),l=a.filter(u=>{var d;return(d=u.status.monsterCategories)==null?void 0:d.every(f=>f!=="Tuner")});if(!r(s)||!n(l))return;const o=[...s.map(u=>({material:u,cell:u.cell,isAsTuner:!0})),...l.map(u=>({material:u,cell:u.cell,isAsTuner:!1}))];if(t.activator.getEnableSummonList(t.activator,"SynchroSummon",["Rule","SpecialSummon"],t.action,[{monster:t.action.entity,posList:e,cells:i}],o,!1).length)return o};function*Kd(t,e=a=>a.length===1,i=a=>a.length>0){let a=[...t.activator.getMonstersOnField().filter(s=>s.battlePosition!=="Set"),...t.activator.getHandCell().cardEntities.filter(s=>s.origin.kind==="Monster")];if(a.every(s=>!s.status.allowHandSynchro)&&(a=a.filter(s=>s.cell.isPlayFieldCell)),a.length<2)return;const r=[...t.activator.getMonsterZones(),...t.activator.duel.field.getCells("ExtraMonsterZone")],n=["Attack","Defense"];yield*a.getAllOnOffPattern().filter(s=>s.some(l=>l.status.allowHandSynchro)||s.every(l=>l.isOnFieldAsMonsterStrictly)).map(s=>Xd(t,n,r,s,e,i)??[]).filter(s=>s.length)}const Yd=async(t,e,i)=>{var o;const a=t.action.getEnableMaterialPatterns(t).toArray(),r=a.map(u=>({infos:u,materialSeqList:u.map(d=>d.material.seq).sort()}));let n=a[0].map(u=>u.material);if(a.length>1){const u=a.flatMap(f=>f.map(p=>p.material)).getDistinct(),d=await t.activator.waitSelectEntities(u,void 0,f=>{const p=f.map(h=>h.seq).sort();return r.some(h=>p.length===h.materialSeqList.length&&p.every((y,v)=>y===h.materialSeqList[v]))},"ã‚·ãƒ³ã‚¯ãƒ­ç´ æã¨ã™ã‚‹ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã‚’é¸æŠž",i);if(!d)return;n=d}const s=n.map(u=>u.seq).sort(),l=(o=r.find(u=>s.length===u.materialSeqList.length&&s.every((d,f)=>d===u.materialSeqList[f])))==null?void 0:o.infos;if(!l)throw new S("æƒ³å®šã•ã‚Œãªã„çŠ¶æ…‹",t,n);return await _.sendManyToGraveyardForTheSameReason(n,["SynchroMaterial","Cost","Rule","SpecialSummonMaterial"],t.action.entity,t.activator),{summonMaterialInfos:l}},me=(t=i=>i.length===1,e=i=>i.length>0)=>({title:"ã‚·ãƒ³ã‚¯ãƒ­å¬å–š",isMandatory:!1,playType:"SpecialSummon",spellSpeed:"Normal",executableCells:["ExtraDeck"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],getEnableMaterialPatterns:i=>Kd(i,t,e),canPayCosts:i=>i.action.getEnableMaterialPatterns(i).some(a=>a.length),canExecute:i=>!i.ignoreCosts||i.activator.getAvailableExtraMonsterZones().length+i.activator.getAvailableMonsterZones().length>0,payCosts:Yd,prepare:i=>ot(i,"SynchroSummon",["Rule","SpecialSummon","SynchroSummon"],["Attack","Defense"]),execute:ct,settle:async()=>!0}),zr=t=>({title:"å°„å‡º",isMandatory:!1,playType:"IgnitionEffect",spellSpeed:"Normal",executableCells:H,executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],executableFaces:["FaceUp"],needsToPayRegularCost:!0,fixedTags:["DamageToOpponent"],canPayCosts:e=>e.activator.getMonstersOnField().filter(t.filter).some(i=>i.canBeReleased(e.activator,e.action.entity,["ReleaseAsCost"],e.action)),payCosts:async(e,i,a)=>{const r=await e.activator.waitSelectEntities(e.activator.getMonstersOnField().filter(t.filter).filter(n=>n.canBeReleased(e.activator,e.action.entity,["ReleaseAsCost"],e.action)),t.qty,n=>n.length===t.qty,"ãƒªãƒªãƒ¼ã‚¹ã™ã‚‹ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã‚’é¸æŠžã€‚",a);if(r)return e.data=t.calcDamage(e,r),await _.releaseManyForTheSameReason(r,["Cost","Release"],e.action.entity,e.activator),{release:r}},prepare:T,execute:async e=>{if(!$n(e.data))throw new S("å€¤ãŒæ­£ã—ããªã„ã€‚",e,e.data);return e.activator.getOpponentPlayer().effectDamage(e.data,e),!0},settle:async()=>!0,...t.otherActionProps});function*Jd(){const t=[{name:"ã‚­ãƒ£ãƒŽãƒ³ãƒ»ã‚½ãƒ«ã‚¸ãƒ£ãƒ¼",qty:1,filter:()=>!0,calcDamage:()=>500,otherActionProps:{},otherActions:[]},{name:"ã‚¢ãƒžã‚¾ãƒã‚¹ã®å°„æ‰‹",qty:2,filter:()=>!0,calcDamage:()=>1200,otherActionProps:{},otherActions:[]},{name:"ãƒ¡ã‚¬ã‚­ãƒ£ãƒŽãƒ³ãƒ»ã‚½ãƒ«ã‚¸ãƒ£ãƒ¼",qty:2,filter:()=>!0,calcDamage:()=>1500,otherActionProps:{},otherActions:[]},{name:"ãƒ—ãƒªãƒ¼ã‚¹ãƒ†ã‚¹ãƒ»ã‚ªãƒ¼ãƒ ",qty:1,filter:e=>e.attr.includes("Dark"),calcDamage:()=>800,otherActionProps:{},otherActions:[]},{name:"å¯¾ç©ºæ”¾èŠ±",qty:1,filter:e=>e.types.includes("Insect"),calcDamage:()=>800,otherActionProps:{},otherActions:[]},{name:"äººæŠ•ã’ãƒˆãƒ­ãƒ¼ãƒ«",qty:1,filter:e=>{var i,a;return!!((i=e.status.monsterCategories)!=null&&i.includes("Normal")&&!((a=e.status.monsterCategories)!=null&&a.includes("Token")))},calcDamage:()=>800,otherActionProps:{},otherActions:[]},{name:"å¢“å®ˆã®å¤§ç­’æŒã¡",qty:1,filter:e=>{var i;return!!((i=e.status.nameTags)!=null&&i.includes("å¢“å®ˆ")&&e.nm!=="å¢“å®ˆã®å¤§ç­’æŒã¡")},calcDamage:()=>700,otherActionProps:{},otherActions:[]},{name:"ã‚«ã‚¿ãƒ‘ãƒ«ãƒˆãƒ»ã‚¦ã‚©ãƒªã‚¢ãƒ¼",qty:1,filter:e=>{var i;return!!((i=e.status.nameTags)!=null&&i.includes("ã‚¸ãƒ£ãƒ³ã‚¯"))},calcDamage:(e,i)=>i.map(a=>a.origin.attack??0).reduce((a,r)=>a+r,0),otherActionProps:{isOnlyNTimesPerTurnIfFaceup:1},otherActions:[me()]},{name:"ãƒ€ãƒ¼ã‚¯ãƒ»ãƒ€ã‚¤ãƒ–ãƒ»ãƒœãƒ³ãƒãƒ¼",qty:1,filter:e=>!!(e.lvl&&e.lvl>0),calcDamage:(e,i)=>i.map(a=>a.lvl??0).reduce((a,r)=>a+r,0)*200,otherActionProps:{isOnlyNTimesPerTurn:1,executablePeriods:["main1"]},otherActions:[me()]}];for(const e of t)yield{name:e.name,actions:[zr(e),...e.otherActions]};yield{name:"ãƒˆã‚¥ãƒ¼ãƒ³ãƒ»ã‚­ãƒ£ãƒŽãƒ³ãƒ»ã‚½ãƒ«ã‚¸ãƒ£ãƒ¼",actions:[zr({qty:1,filter:()=>!0,calcDamage:()=>500,otherActionProps:{}})],immediatelyActions:[{title:"è‡ªå£Š",executableCells:["MonsterZone"],executablePeriods:le.filter(e=>e!=="b1DBeforeDmgCalc"&&e!=="b2DBeforeDmgCalc"&&e!=="b1DDmgCalc"&&e!=="b2DDmgCalc"),execute:async(e,i,a)=>{i&&a&&a.status.name==="ãƒˆã‚¥ãƒ¼ãƒ³ãƒ»ãƒ¯ãƒ¼ãƒ«ãƒ‰"&&(i.moveLog.latestRecord.movedAs.every(r=>!r.endsWith("Destroy"))||(e.entity.controller.writeInfoLog(`${i.toString()}ãŒç ´å£Šã•ã‚ŒãŸãŸã‚ã€${e.entity.toString()}ã¯ç ´å£Šã•ã‚Œã‚‹ã€‚`),_.tryMarkForDestroy([e.entity],{activator:e.entity.controller,action:e,selectedEntities:[]}),e.entity.info.isDying=!0,e.entity.info.causeOfDeath=["Effect","Destroy"]))}}],continuousEffects:[ni("å¬å–šé…”ã„","Monster",e=>[e],e=>[new oe({title:"å¬å–šé…”ã„",validateAlive:i=>{const a=i.isSpawnedBy.moveLog.latestArrivalRecord;return!a||!i.duel.clock.isSameTurn(a.movedAt)?!1:a.movedAs.union(["NormalSummon","FlipSummon","SpecialSummon"]).length>0},isContinuous:!0,isSpawnedBy:e,actionAttr:{},isApplicableTo:()=>!0,statusCalculator:()=>({canAttack:!1})})]),ni("ç›´æŽ¥æ”»æ’ƒ","Monster",e=>[e],e=>[new oe({title:"ç›´æŽ¥æ”»æ’ƒ",validateAlive:()=>!0,isContinuous:!0,isSpawnedBy:e,actionAttr:{},isApplicableTo:()=>!0,statusCalculator:i=>i.controller.getEntiteisOnField().filter(a=>a.nm==="ãƒˆã‚¥ãƒ¼ãƒ³ãƒ»ãƒ¯ãƒ¼ãƒ«ãƒ‰").some(a=>a.face==="FaceUp")?i.controller.getOpponentPlayer().getMonstersOnField().filter(a=>{var r;return(r=a.status.monsterCategories)==null?void 0:r.includes("Toon")}).some(a=>a.face==="FaceUp")?{}:{canDirectAttack:!0}:{}})])]}}const hs=Object.freeze(Object.defineProperty({__proto__:null,default:Jd},Symbol.toStringTag,{value:"Module"}));function*Id(){yield*["ãƒ©ãƒ¼ã‚¸ãƒžã‚¦ã‚¹","ãƒ¬ã‚¤ãƒ³ãƒœãƒ¼ãƒ»ãƒ•ãƒ©ãƒ¯ãƒ¼","ãƒ¬ãƒƒã‚°ãƒ«","å¥³çŽ‹ã®å½±æ­¦è€…","äººé€ äººé–“ï¼—å·"].map(t=>({name:t,actions:[],continuousEffects:[Ud]}))}const ys=Object.freeze(Object.defineProperty({__proto__:null,default:Id},Symbol.toStringTag,{value:"Module"}));function*ef(){yield*[{name:"ã‚­ãƒ©ãƒ¼ãƒ»ãƒãƒ†ãƒˆ",filter:t=>t.attr.includes("Dark")&&(t.atk??9999)<=1500,qtyList:[1],posList:["Attack"],destroyTypes:["Effect"],executableCells:["Graveyard"]},{name:"ã‚­ãƒ©ãƒ¼ãƒ»ãƒˆãƒžãƒˆ",filter:t=>t.attr.includes("Dark")&&(t.atk??9999)<=1500,qtyList:[1],posList:["Attack"],destroyTypes:["Battle"],executableCells:["Graveyard"]},{name:"å·¨å¤§ãƒã‚ºãƒŸ",filter:t=>t.attr.includes("Earth")&&(t.atk??9999)<=1500,qtyList:[1],posList:["Attack"],destroyTypes:["Battle"],executableCells:["Graveyard"]},{name:"ã‚°ãƒªã‚ºãƒªãƒ¼ãƒžã‚¶ãƒ¼",filter:t=>t.attr.includes("Water")&&(t.atk??9999)<=1500,qtyList:[1],posList:["Attack"],destroyTypes:["Battle"],executableCells:["Graveyard"]},{name:"ã‚·ãƒ£ã‚¤ãƒ³ã‚¨ãƒ³ã‚¸ã‚§ãƒ«",filter:t=>t.attr.includes("Light")&&(t.atk??9999)<=1500,qtyList:[1],posList:["Attack"],destroyTypes:["Battle"],executableCells:["Graveyard"]},{name:"ãƒ‰ãƒ©ã‚´ãƒ³ãƒ•ãƒ©ã‚¤",filter:t=>t.attr.includes("Wind")&&(t.atk??9999)<=1500,qtyList:[1],posList:["Attack"],destroyTypes:["Battle"],executableCells:["Graveyard"]},{name:"ï¼µï¼¦ï¼¯ã‚¿ãƒ¼ãƒˆãƒ«",filter:t=>t.attr.includes("Fire")&&(t.atk??9999)<=1500,qtyList:[1],posList:["Attack"],destroyTypes:["Battle"],executableCells:["Graveyard"]},{name:"è’é‡Žã®å¥³æˆ¦å£«",filter:t=>t.attr.includes("Earth")&&t.types.includes("Warrior")&&(t.atk??9999)<=1500,qtyList:[1],posList:["Attack"],destroyTypes:["Battle"],executableCells:["Graveyard"]},{name:"ãƒªãƒˆãƒ«ãƒ»ãƒˆãƒ«ãƒ¼ãƒ‘ãƒ¼",filter:t=>t.types.includes("Warrior")&&(t.lvl??9999)<3,qtyList:[1],posList:["Set"],destroyTypes:["Battle"],executableCells:["Graveyard","Banished"]},{name:"ç ´é¢ç«œ",filter:t=>t.types.includes("Warrior")&&(t.def??9999)<=1500,qtyList:[1],posList:["Attack","Defense"],destroyTypes:["Battle"],executableCells:["Graveyard"]},{name:"å…±é³´è™«",filter:t=>t.types.includes("Insect")&&(t.atk??9999)<=1500,qtyList:[1],posList:["Attack","Defense"],destroyTypes:["Battle"],executableCells:["Graveyard"]},{name:"ãƒ”ãƒ©ãƒŸãƒƒãƒ‰ãƒ»ã‚¿ãƒ¼ãƒˆãƒ«",filter:t=>t.types.includes("Zombie")&&(t.def??9999)<=2e3,qtyList:[1],posList:["Attack","Defense"],destroyTypes:["Battle"],executableCells:["Graveyard"]},{name:"ãƒ¦ãƒ¼ãƒ•ã‚©ãƒ­ã‚¤ãƒ‰",filter:t=>t.types.includes("Machine")&&(t.atk??9999)<=1500,qtyList:[1],posList:["Attack"],destroyTypes:["Battle"],executableCells:["Graveyard"]},{name:"ãƒ˜ãƒ«ãƒ»ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£",filter:t=>t.types.includes("Fiend")&&(t.lvl??9999)===1,qtyList:[1],posList:["Attack","Defense"],destroyTypes:["Battle"],executableCells:["Graveyard"]},{name:"ã‚¬ã‚¹ã‚¿ãƒ»ã‚¤ã‚°ãƒ«",filter:t=>(t.status.nameTags??[]).includes("ã‚¬ã‚¹ã‚¿")&&(t.status.monsterCategories??[]).includes("Tuner"),qtyList:[1],posList:["Attack","Defense"],destroyTypes:["Battle"],executableCells:["Graveyard"]},{name:"å¹»å½±ã®é­”è¡“å£«",filter:t=>(t.status.nameTags??[]).includes("ï¼¨ï¼¥ï¼²ï¼¯")&&(t.atk??9999)<=1e3,qtyList:[1],posList:["Defense"],destroyTypes:["Battle"],executableCells:["Graveyard"]},{name:"ã‚¸ã‚§ãƒã‚¯ã‚¹ãƒ»ã‚µãƒ¼ãƒãƒ£ãƒ¼",filter:t=>(t.status.nameTags??[]).includes("ã‚¸ã‚§ãƒã‚¯ã‚¹")&&(t.atk??9999)<=1500,qtyList:[1],posList:["Attack"],destroyTypes:["Battle"],executableCells:["Graveyard"]},{name:"ç´«ç‚Žã®è¶³è»½",filter:t=>(t.status.nameTags??[]).includes("å…­æ­¦è¡†")&&(t.lvl??12)<=3,qtyList:[1],posList:["Attack","Defense"],destroyTypes:["Battle"],executableCells:["Graveyard"]},{name:"ã‚¹ãƒ¬ã‚¤ãƒ–ãƒ»ã‚¨ã‚¤ãƒ—",filter:t=>(t.status.nameTags??[]).includes("å‰£é—˜ç£")&&(t.lvl??12)<=4,qtyList:[1],posList:["Attack","Defense"],destroyTypes:["Battle"],executableCells:["Graveyard"]},{name:"ã‚¼ãƒ³ãƒžã‚¤ãƒãƒ‹ãƒ¼",filter:t=>(t.status.nameTags??[]).includes("ã‚¼ãƒ³ãƒžã‚¤")&&(t.lvl??12)<=4,qtyList:[1],posList:["Attack","Defense"],destroyTypes:["Battle"],executableCells:["Graveyard"]},{name:"ï¼¸ï¼¸ï¼ã‚»ã‚¤ãƒãƒ¼ ã‚¨ãƒžãƒ¼ã‚ºãƒ–ãƒ¬ã‚¤ãƒ‰",filter:t=>(t.status.nameTags??[]).includes("ï¼¸ï¼ã‚»ã‚¤ãƒãƒ¼")&&(t.lvl??12)<=4,qtyList:[1],posList:["Attack","Defense"],destroyTypes:["Battle"],executableCells:["Graveyard"]},{name:"è»éšŠç«œ",filter:t=>t.nm==="è»éšŠç«œ",qtyList:[1],posList:["Attack","Defense"],destroyTypes:["Battle"],executableCells:["Graveyard"]},{name:"ã‚¢ã‚µãƒ«ãƒˆãƒ»ã‚¬ãƒ³ãƒ‰ãƒƒã‚°",filter:t=>t.nm==="ã‚¢ã‚µãƒ«ãƒˆãƒ»ã‚¬ãƒ³ãƒ‰ãƒƒã‚°",qtyList:[1,2,3,4,5],posList:["Attack","Defense"],destroyTypes:["Battle"],executableCells:["Graveyard"]},{name:"ãƒã‚¤ã‚¨ãƒŠ",filter:t=>t.nm==="ãƒã‚¤ã‚¨ãƒŠ",qtyList:[1,2,3,4,5],posList:["Attack","Defense"],destroyTypes:["Battle"],executableCells:["Graveyard"]}].map(t=>({name:t.name,actions:[{title:"â‘ ãƒªã‚¯ãƒ«ãƒ¼ãƒˆ",isMandatory:!1,playType:"TriggerEffect",spellSpeed:"Normal",executableCells:t.executableCells,executablePeriods:t.destroyTypes.includes("Effect")?[...D,...O]:["b1DEnd","b2DEnd"],executableDuelistTypes:["Controller"],fixedTags:["SpecialSummonFromDeck"],meetsConditions:e=>e.action.entity.wasMovedAtPreviousChain&&e.action.entity.moveLog.latestRecord.movedAs.includes("Destroy")&&e.action.entity.moveLog.latestRecord.movedAs.union(t.destroyTypes).length>0,canExecute:e=>{const i=e.activator.getMonsterZones();return e.activator.getEnableSummonList(e.activator,"SpecialSummon",["Effect"],e.action,e.activator.getDeckCell().cardEntities.filter(t.filter).filter(r=>r.kind==="Monster").filter(r=>r.canBeTargetOfEffect(e)).map(r=>({monster:r,posList:t.posList,cells:i})),[],!1).length>0},prepare:async()=>({selectedEntities:[]}),execute:async e=>{const i=e.activator.getDeckCell().cardEntities.filter(t.filter),a=e.activator.getMonsterZones();return e.activator.summonMany(e.activator,"SpecialSummon",["Effect"],e.action,i.map(n=>({monster:n,posList:t.posList,cells:a})),[],!1,t.qtyList.length>1?void 0:t.qtyList[0],n=>t.qtyList.includes(n.length),!1)?(e.activator.getDeckCell().shuffle(),!0):!1},settle:async()=>!0}]}))}const vs=Object.freeze(Object.defineProperty({__proto__:null,default:ef},Symbol.toStringTag,{value:"Module"}));function*tf(){yield{name:"æ­»è€…è˜‡ç”Ÿ",actions:[{title:"ç™ºå‹•",isMandatory:!1,playType:"CardActivation",spellSpeed:"Normal",executableCells:["Hand","SpellAndTrapZone"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],fixedTags:["SpecialSummonFromGraveyard"],...Ze(e=>e.activator.getGraveyard().cardEntities.filter(i=>i.kind==="Monster").filter(i=>i.canBeTargetOfEffect(e))),settle:async()=>!0},b]};for(const e of[{name:"å¤§åµ",cellTypes:Hi,isOnlyEnemies:!1},{name:"ãƒãƒ¼ãƒ”ã‚£ã®ç¾½æ ¹å¸š",cellTypes:Hi,isOnlyEnemies:!0},{name:"ãƒ–ãƒ©ãƒƒã‚¯ãƒ»ãƒ›ãƒ¼ãƒ«",cellTypes:H,isOnlyEnemies:!1},{name:"ã‚µãƒ³ãƒ€ãƒ¼ãƒ»ãƒœãƒ«ãƒˆ",cellTypes:H,isOnlyEnemies:!0}])yield{name:e.name,actions:[{title:"ç™ºå‹•",isMandatory:!1,playType:"CardActivation",spellSpeed:"Normal",executableCells:["Hand","SpellAndTrapZone"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],fixedTags:["DestroyOnField"],canExecute:i=>{let a=i.action.entity.field.getCells(...e.cellTypes).flatMap(r=>r.cardEntities).filter(r=>r!==i.action.entity);return e.isOnlyEnemies&&(a=a.filter(r=>r.controller!==i.activator)),a.length>0},prepare:async i=>{let a=i.action.entity.field.getCells(...e.cellTypes).flatMap(r=>r.cardEntities).filter(r=>r!==i.action.entity);return e.isOnlyEnemies&&(a=a.filter(r=>r.controller!==i.activator)),{selectedEntities:[],chainBlockTags:i.action.calcChainBlockTagsForDestroy(i.activator,a)}},execute:async i=>{let a=i.action.entity.field.getCells(...e.cellTypes).flatMap(r=>r.cardEntities).filter(r=>r!==i.action.entity);return e.isOnlyEnemies&&(a=a.filter(r=>r.controller!==i.activator)),await _.tryDestroy(a,i),!0},settle:async()=>!0},b]};yield{name:"ãƒãƒªã‚±ãƒ¼ãƒ³",actions:[{title:"ç™ºå‹•",isMandatory:!1,playType:"CardActivation",spellSpeed:"Normal",executableCells:["Hand","SpellAndTrapZone"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],fixedTags:["BounceToHand"],canExecute:e=>e.action.entity.field.getCells("SpellAndTrapZone","FieldSpellZone").flatMap(i=>i.cardEntities).some(i=>i!==e.action.entity),prepare:async()=>({selectedEntities:[]}),execute:async(e,i)=>{const a=i.map(n=>n.action).filter(n=>n.playType==="CardActivation").map(n=>n.entity).filter(n=>n.face==="FaceUp"),r=e.action.entity.field.getCells("SpellAndTrapZone","FieldSpellZone").flatMap(n=>n.cardEntities).filter(n=>!a.includes(n));return await _.returnManyToHandForTheSameReason(r,["Effect"],e.action.entity,e.activator),!0},settle:async()=>!0},b]};const t=e=>e.activator.duel.field.getWaitingRoomCell().cardEntities.find(i=>i.parent===e.action.entity)??Z.createTokenEntity(e.activator,e.action.entity,{name:"ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒˆãƒ¼ã‚¯ãƒ³",actions:ji,staticInfo:{name:"ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒˆãƒ¼ã‚¯ãƒ³",kind:"Monster",monsterCategories:["Normal","Token"],level:4,attack:2e3,defense:2e3,attributes:["Light"],types:["Cyberse"],wikiEncodedName:"%A5%BB%A5%AD%A5%E5%A5%EA%A5%C6%A5%A3%A5%C8%A1%BC%A5%AF%A5%F3"}});yield{name:"ãƒ¯ãƒ³ã‚¿ã‚¤ãƒ ãƒ»ãƒ‘ã‚¹ã‚³ãƒ¼ãƒ‰",actions:[{title:"ç™ºå‹•",isMandatory:!1,playType:"CardActivation",spellSpeed:"Normal",executableCells:["Hand","SpellAndTrapZone"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],isOnlyNTimesPerTurn:1,fixedTags:["SpecialSummon","SpecialSummonToken"],canExecute:e=>{const i=t(e),a=e.activator.getMonsterZones();return e.activator.getEnableSummonList(e.activator,"SpecialSummon",["Effect"],e.action,[{monster:i,posList:["Defense"],cells:a}],[],!1).length>0},prepare:async()=>({selectedEntities:[]}),execute:async e=>{const i=t(e),a=e.activator.getMonsterZones();return!!await e.activator.summon("SpecialSummon",["Effect"],e.action,i,["Defense"],a,[],!1)},settle:async()=>!0},b]},yield{name:"ãƒ¯ãƒ³ãƒ»ãƒ•ã‚©ãƒ¼ãƒ»ãƒ¯ãƒ³",actions:[{title:"ç™ºå‹•",isMandatory:!1,playType:"CardActivation",spellSpeed:"Normal",executableCells:["Hand","SpellAndTrapZone"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],fixedTags:["SpecialSummonFromDeck"],priorityForNPC:40,canPayCosts:e=>{if(e.activator.getDeckCell().cardEntities.every(i=>(i.lvl??12)>1)){if(e.activator.getHandCell().cardEntities.every(i=>(i.lvl??12)>1)||e.activator.getHandCell().cardEntities.filter(i=>i.kind==="Monster").length<2)return!1}else if(e.activator.getHandCell().cardEntities.filter(i=>i.kind==="Monster").length===0)return!1;return!0},canExecute:e=>{let i=[...e.activator.getDeckCell().cardEntities.filter(s=>(s.lvl??12)===1),...e.activator.getHandCell().cardEntities.filter(s=>(s.lvl??12)===1)];const a=e.activator.getHandCell().cardEntities;(a.length<2||!e.ignoreCosts)&&(i=i.filter(s=>!a.includes(s)));const r=e.activator.getMonsterZones();return e.activator.getEnableSummonList(e.activator,"SpecialSummon",["Effect"],e.action,i.map(s=>({monster:s,posList:k,cells:r})),[],!1).length>0},payCosts:async(e,i,a)=>{const r=[...e.activator.getDeckCell().cardEntities.filter(u=>(u.lvl??12)===1),...e.activator.getHandCell().cardEntities.filter(u=>(u.lvl??12)===1)],n=e.activator.getMonsterZones(),s=e.activator.getEnableSummonList(e.activator,"SpecialSummon",["Effect"],e.action,r.map(u=>({monster:u,posList:k,cells:n})),[],!1);let l=e.activator.getHandCell().cardEntities.filter(u=>u.kind==="Monster");s.length===1&&(l=l.filter(u=>!s.map(d=>d.monster).includes(u)));const o=await e.activator.waitSelectEntity(l,"å¢“åœ°ã¸é€ã‚‹ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã‚’é¸æŠž",a);if(!o)throw new F(e);return await o.sendToGraveyard(["Cost"],e.action.entity,e.activator),{sendToGraveyard:[o]}},prepare:async()=>({selectedEntities:[]}),execute:async e=>{const i=[...e.activator.getDeckCell().cardEntities.filter(n=>n.lvl===1),...e.activator.getHandCell().cardEntities.filter(n=>n.lvl===1)],a=e.activator.getMonsterZones();return await e.activator.summonOne(e.activator,"SpecialSummon",["Effect"],e.action,i.map(n=>({monster:n,posList:k,cells:a})),[],!1,!1)?(e.activator.getDeckCell().shuffle(),!0):!1},settle:async()=>!0},b]},yield{name:"å°å°ã®é»„é‡‘æ«ƒ",actions:[{title:"ç™ºå‹•",isMandatory:!1,playType:"CardActivation",spellSpeed:"Normal",executableCells:["Hand","SpellAndTrapZone"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],fixedTags:["BanishFromDeck"],canExecute:e=>e.activator.getDeckCell().cardEntities.some(i=>e.activator.canTryBanish(i,"BanishAsEffect",e.action)),prepare:async()=>({selectedEntities:[]}),execute:async e=>{const i=e.activator.getDeckCell().cardEntities.filter(n=>e.activator.canTryBanish(n,"BanishAsEffect",e.action)),a=await e.activator.waitSelectEntity(i,"é™¤å¤–ã™ã‚‹ã‚«ãƒ¼ãƒ‰ã‚’é¸æŠžã€‚",!1);if(!a)throw new F(e);return(await _.tryBanish("BanishAsEffect",[a],e)).forEach(n=>n.counterHolder.removeAll("GoldSarcophagus")),!0},settle:async()=>!0},bd("å›žåŽã‚«ã‚¦ãƒ³ãƒˆé€²è¡Œ",["stanby"],e=>{e.activator.isTurnPlayer&&e.action.entity.field.getCells("Banished").flatMap(i=>i.cardEntities).filter(i=>i.moveLog.latestRecord.movedBy===e.action.entity).filter(i=>i.moveLog.latestRecord.actionOwner===e.activator).forEach(i=>{i.counterHolder.add("GoldSarcophagus",1,e.action.entity);const a=i.counterHolder.getQty("GoldSarcophagus",e.action.entity);a<3&&e.activator.duel.log.info(`${i.toString()}ã®ã‚¿ãƒ¼ãƒ³ã‚«ã‚¦ãƒ³ãƒˆï¼š${a-1}â‡’${a}`)})}),{title:"å›žåŽ",isMandatory:!0,playType:"LingeringEffect",spellSpeed:"Normal",executableCells:Me,executablePeriods:["stanby"],executableDuelistTypes:$t,canExecute:e=>e.activator.isTurnPlayer&&e.action.entity.field.getCells("Banished").flatMap(i=>i.cardEntities).filter(i=>i.moveLog.latestRecord.movedBy===e.action.entity).filter(i=>i.moveLog.latestRecord.actionOwner===e.activator).some(i=>i.counterHolder.getQty("GoldSarcophagus")===2),prepare:T,execute:async e=>{const i=e.action.entity.field.getCells("Banished").flatMap(r=>r.cardEntities).filter(r=>r.moveLog.latestRecord.movedBy===e.action.entity).filter(r=>r.moveLog.latestRecord.actionOwner===e.activator).filter(r=>r.counterHolder.getQty("GoldSarcophagus")===2);if(!i.length)throw new S("æƒ³å®šã•ã‚Œãªã„çŠ¶æ…‹",e);let a=i[0];if(i.length>1){const r=await e.activator.waitSelectEntity(i,"å›žåŽã™ã‚‹ã‚«ãƒ¼ãƒ‰ã‚’é¸æŠžã€‚",!1);if(!r)throw new F(e);a=r}return await a.addToHand(["Effect"],e.action.entity,e.activator),!0},settle:async()=>!0},b]},yield{name:"é­”ã®è©¦ç€éƒ¨å±‹",actions:[{title:"ç™ºå‹•",isMandatory:!1,playType:"CardActivation",spellSpeed:"Normal",executableCells:["Hand","SpellAndTrapZone"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],fixedTags:["SpecialSummonFromDeck"],canPayCosts:e=>e.activator.lp>=800,canExecute:e=>e.activator.getDeckCell().cardEntities.length>0&&e.activator.getEnableSummonList(e.activator,"SpecialSummon",["Effect"],e.action,e.activator.getDeckCell().cardEntities.filter(i=>i.kind==="Monster").filter(i=>{var a;return(a=i.status.monsterCategories)==null?void 0:a.includes("Normal")}).filter(i=>(i.lvl??12)<4).map(i=>({monster:i,posList:k,cells:e.activator.getMonsterZones()})),[],!1).length>0,payCosts:(e,i)=>Ut(e,i,800),prepare:async()=>({selectedEntities:[]}),execute:async e=>{if(e.activator.getDeckCell().cardEntities.length<4)return!1;const i=await _.excavateManyFromDeck(e.activator,4,["Effect"],e.action.entity,e.activator),a=i.filter(r=>r.kind==="Monster").filter(r=>{var n;return(n=r.status.monsterCategories)==null?void 0:n.includes("Normal")}).filter(r=>(r.lvl??12)<4);if(a.length){const r=e.activator.getMonsterZones(),n=a.length>r.length?r.length:a.length;await e.activator.summonMany(e.activator,"SpecialSummon",["Effect","Excavate"],e.action,a.map(s=>({monster:s,cells:r,posList:k})),[],!1,n,s=>s.length===n,!1)}return await _.sendManyToGraveyardForTheSameReason(a.filter(r=>!r.isOnFieldAsMonsterStrictly),["Effect","Excavate"],e.action.entity,e.activator),await _.returnManyToDeckForTheSameReason("Random",i.filter(r=>r.cell.cellType==="Deck"),["Effect"],e.action.entity,e.activator),!0},settle:async()=>!0},b]}}const ms=Object.freeze(Object.defineProperty({__proto__:null,default:tf},Symbol.toStringTag,{value:"Module"}));function*af(){yield{name:"å¼·æ¬²ãªå£º",actions:[{title:"ç™ºå‹•",isMandatory:!1,playType:"CardActivation",spellSpeed:"Normal",executableCells:["Hand","SpellAndTrapZone"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],priorityForNPC:20,fixedTags:["Draw"],canExecute:t=>t.activator.getDeckCell().cardEntities.length>1&&t.activator.canDraw&&t.activator.canAddToHandFromDeck,prepare:async()=>({selectedEntities:[]}),execute:async t=>(await t.activator.draw(2,t.action.entity,t.activator),!0),settle:async()=>!0},b]},yield{name:"è²ªæ¬²ãªå£º",actions:[{title:"ç™ºå‹•",isMandatory:!1,playType:"CardActivation",spellSpeed:"Normal",executableCells:["Hand","SpellAndTrapZone"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],fixedTags:["Draw","ReturnToDeckFromGraveyard"],priorityForNPC:30,canExecute:t=>t.activator.getGraveyard().cardEntities.filter(e=>e.kind==="Monster").filter(e=>e.canBeTargetOfEffect(t)).length>4&&t.activator.canDraw&&t.activator.canAddToHandFromDeck,prepare:async t=>{const e=await t.activator.waitSelectEntities(t.activator.getGraveyard().cardEntities.filter(i=>i.kind==="Monster").filter(i=>i.canBeTargetOfEffect(t)),5,i=>i.length===5,"ãƒ‡ãƒƒã‚­ã«æˆ»ã™ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã‚’é¸æŠžã€‚",!1);if(e)return{selectedEntities:e}},execute:async t=>t.selectedEntities.some(e=>e.wasMovedAtCurrentChain)?!1:(await _.returnManyToDeckForTheSameReason("Random",t.selectedEntities,["Effect"],t.action.entity,t.activator),await t.activator.draw(2,t.action.entity,t.activator),!0),settle:async()=>!0},b]},yield{name:"å¤©ä½¿ã®æ–½ã—",actions:[{title:"ç™ºå‹•",isMandatory:!1,playType:"CardActivation",spellSpeed:"Normal",executableCells:["Hand","SpellAndTrapZone"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],fixedTags:["Draw","DiscordAsEffect"],priorityForNPC:30,canExecute:t=>t.activator.getDeckCell().cardEntities.length>2&&t.activator.canDraw&&t.activator.canAddToHandFromDeck&&t.activator.status.canDiscardAsEffect,prepare:async()=>({selectedEntities:[]}),execute:async t=>(await t.activator.draw(3,t.action.entity,t.activator),await t.activator.discard(2,"Effect",()=>!0,t.action.entity,t.activator),!0),settle:async()=>!0},b]},yield{name:"æˆé‡‘ã‚´ãƒ–ãƒªãƒ³",actions:[{title:"ç™ºå‹•",isMandatory:!1,playType:"CardActivation",spellSpeed:"Normal",executableCells:["Hand","SpellAndTrapZone"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],fixedTags:["Draw"],priorityForNPC:20,canExecute:t=>t.activator.getDeckCell().cardEntities.length>0&&t.activator.canDraw&&t.activator.canAddToHandFromDeck,prepare:async()=>({selectedEntities:[]}),execute:async t=>(await t.activator.draw(1,t.action.entity,t.activator),t.action.entity.field.duel.clock.incrementProcSeq(),t.activator.getOpponentPlayer().heal(1e3,t.action.entity),!0),settle:async()=>!0},b]},yield{name:"æ‰‹æœ­æŠ¹æ®º",actions:[{title:"ç™ºå‹•",isMandatory:!1,playType:"CardActivation",spellSpeed:"Normal",executableCells:["Hand","SpellAndTrapZone"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],fixedTags:["Draw","DiscordAsEffect"],canExecute:t=>t.activator.getDeckCell().cardEntities.length>=t.activator.getHandCell().cardEntities.filter(e=>e.seq!==t.action.entity.seq).length&&t.activator.canDraw&&t.activator.canAddToHandFromDeck&&t.activator.getOpponentPlayer().canDraw&&t.activator.getOpponentPlayer().canAddToHandFromDeck&&t.action.entity.field.getAllCells().filter(e=>e.cellType==="Hand").flatMap(e=>e.cardEntities).some(e=>e.seq!==t.action.entity.seq),prepare:async()=>({selectedEntities:[]}),execute:async t=>{const e=t.activator.getHandCell().cardEntities.length,i=t.activator.getOpponentPlayer().getHandCell().cardEntities.length;return await _.sendManyToGraveyardForTheSameReason(t.action.entity.field.getCells("Hand").flatMap(a=>a.cardEntities),["Effect","Discard"],t.action.entity,t.activator),t.activator.duel.clock.incrementProcSeq(),await _.drawAtSameTime(t.activator,t.action.entity,e,i),!0},settle:async()=>!0},b]},yield{name:"ä¸€æ™‚ä¼‘æˆ¦",actions:[{title:"ç™ºå‹•",isMandatory:!1,playType:"CardActivation",spellSpeed:"Normal",executableCells:["Hand","SpellAndTrapZone"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],fixedTags:["Draw"],canExecute:t=>t.activator.getDeckCell().cardEntities.length>0&&t.activator.canDraw&&t.activator.getOpponentPlayer().getDeckCell().cardEntities.length>0&&t.activator.getOpponentPlayer().canDraw,prepare:T,execute:async t=>(await _.drawAtSameTime(t.activator,t.action.entity,1,1),[t.activator,t.activator.getOpponentPlayer()].forEach(e=>e.entity.damageFilterBundle.push(new Un({title:"ãƒ€ãƒ¡ãƒ¼ã‚¸ç„¡åŠ¹",validateAlive:i=>i.duel.clock.turn-i.isSpawnedAt.turn<2,isContinuous:!1,isSpawnedBy:t.action.entity,actionAttr:t.action,isApplicableTo:()=>!0,calcType:"zero_typeA",filter:(i,a,r,n)=>(r.writeInfoLog(`${n.profile.name}ã¯${i.isSpawnedBy}ã®åŠ¹æžœã§ãƒ€ãƒ¡ãƒ¼ã‚¸ã‚’å—ã‘ãªã„ã€‚`),{zero_typeA:!0})}))),!0),settle:async()=>!0},b]},yield{name:"æ‰“ã¡å‡ºã®å°æ§Œ",actions:[{title:"ç™ºå‹•",isMandatory:!1,playType:"CardActivation",spellSpeed:"Normal",executableCells:["Hand","SpellAndTrapZone"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],fixedTags:["Draw"],canExecute:t=>t.activator.canDraw,prepare:async()=>({selectedEntities:[]}),execute:async t=>{const e=t.activator.getHandCell().cardEntities;if(!e.length)return!1;let i=[...e];if(i.length>1&&!await t.activator.waitYesNo("å…¨ã¦ã®æ‰‹æœ­ã‚’å…¥ã‚Œæ›¿ãˆã‚‹ï¼Ÿ")){const a=await t.activator.waitSelectEntities(e,void 0,r=>r.length>0,"ãƒ‡ãƒƒã‚­ã«æˆ»ã™ã‚«ãƒ¼ãƒ‰ã‚’é¸æŠžã€‚",!1);if(!a)throw new F(t);i=a}return await _.returnManyToDeckForTheSameReason("Random",i,["Effect"],t.action.entity,t.activator),t.activator.duel.clock.incrementProcSeq(),await t.activator.draw(i.length,t.action.entity,t.activator),!0},settle:async()=>!0},b]}}const Ss=Object.freeze(Object.defineProperty({__proto__:null,default:af},Symbol.toStringTag,{value:"Module"}));function*rf(){yield{name:"ãŠã‚ã‹ãªåŸ‹è‘¬",actions:[{title:"ç™ºå‹•",isMandatory:!1,playType:"CardActivation",spellSpeed:"Normal",executableCells:["Hand","SpellAndTrapZone"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],priorityForNPC:40,fixedTags:["SendToGraveyardFromDeck"],canExecute:t=>t.activator.getDeckCell().cardEntities.some(e=>e.kind==="Monster"),prepare:T,execute:async t=>{const e=t.activator.getDeckCell().cardEntities.filter(a=>a.kind==="Monster");if(e.length===0)return!1;const i=await t.activator.waitSelectEntity(e,"å¢“åœ°ã«é€ã‚‹ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã‚’é¸æŠž",!1);if(!i)throw new F(t);return await i.sendToGraveyard(["Effect"],t.action.entity,t.activator),t.activator.getDeckCell().shuffle(),!0},settle:async()=>!0},b]},yield{name:"ãŠã‚ã‹ãªå‰¯è‘¬",actions:[{title:"ç™ºå‹•",isMandatory:!1,playType:"CardActivation",spellSpeed:"Normal",executableCells:["Hand","SpellAndTrapZone"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],isOnlyNTimesPerTurn:1,priorityForNPC:40,fixedTags:["SendToGraveyardFromDeck"],canExecute:t=>t.activator.getDeckCell().cardEntities.some(e=>e.kind!=="Monster"),prepare:T,execute:async t=>{const e=t.activator.getDeckCell().cardEntities.filter(a=>a.kind!=="Monster");if(e.length===0)return!1;const i=await t.activator.waitSelectEntity(e,"å¢“åœ°ã«é€ã‚‹é­”æ³•ç½ ã‚’é¸æŠž",!1);if(!i)throw new F(t);return await i.sendToGraveyard(["Effect"],t.action.entity,t.activator),t.activator.getDeckCell().shuffle(),!0},settle:async()=>!0},b]},yield{name:"è‹¦æ¸‹ã®é¸æŠž",actions:[{title:"ç™ºå‹•",isMandatory:!1,playType:"CardActivation",spellSpeed:"Normal",executableCells:["Hand","SpellAndTrapZone"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],priorityForNPC:40,fixedTags:["SendToGraveyardFromDeck","SearchFromDeck"],canExecute:t=>t.activator.getDeckCell().cardEntities.length>4,prepare:T,execute:async t=>{const e=t.activator.getDeckCell().cardEntities;if(e.length<5)return!1;const i=await t.activator.waitSelectEntities(e,5,r=>r.length===5,"ç›¸æ‰‹ã«è¦‹ã›ã‚‹ã‚«ãƒ¼ãƒ‰ã‚’é¸æŠžã€‚",!1);if(!i)throw new F(t);const a=await t.activator.getOpponentPlayer().waitSelectEntity(i,"æ‰‹æœ­ã«åŠ ãˆã•ã›ã‚‹ã‚«ãƒ¼ãƒ‰ã‚’é¸æŠžã€‚",!1);if(!a)throw new F(t,i);return t.activator.writeInfoLog(`${t.activator.getOpponentPlayer().name}ã¯${a.toString()}ã‚’é¸æŠžã€‚`),await a.addToHand(["Effect"],t.action.entity,t.activator),await _.sendManyToGraveyardForTheSameReason(i.filter(r=>r!==a),["Effect"],t.action.entity,t.activator),t.activator.getDeckCell().shuffle(),!0},settle:async()=>!0},b]};for(const t of["ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã‚²ãƒ¼ãƒˆ","åæŽ¨ç†"]){let e={title:"ç™ºå‹•",isMandatory:!1,playType:"CardActivation",spellSpeed:"Normal",executableCells:["Hand","SpellAndTrapZone"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],fixedTags:["SpecialSummonFromDeck","SendToGraveyardFromDeck","SpecialSummon"],canExecute:i=>i.activator.getDeckCell().cardEntities.filter(a=>a.kind==="Monster").some(a=>{var r;return!((r=a.status.monsterCategories)!=null&&r.includes("SpecialSummon"))}),prepare:T,execute:async i=>{var n,s;if(!i.activator.getDeckCell().cardEntities.length||!i.activator.getAvailableMonsterZones().length)return!1;let a=-1;if(t==="åæŽ¨ç†"){const l=await i.activator.getOpponentPlayer().waitSelectNumberFromRange("ãƒ¬ãƒ™ãƒ«ã‚’é¸æŠž",1,12,!1);if(l===void 0)throw new F(i);a=l,i.activator.writeInfoLog(`${i.activator.getOpponentPlayer().name}ã¯${a}ã‚’é¸æŠžã€‚`)}const r=[...i.activator.getDeckCell().cardEntities];for(const l of i.activator.getDeckCell().cardEntities){if(await l.excavate(["Effect"],i.action.entity,i.activator),l.kind!=="Monster"){await l.sendToGraveyard(["Effect","Excavate"],i.action.entity,i.activator);continue}if((n=l.status.monsterCategories)!=null&&n.includes("SpecialSummon")){await l.sendToGraveyard(["Effect","Excavate"],i.action.entity,i.activator);continue}return(s=l.status.monsterCategories)!=null&&s.includes("NormalSummonOnly")?(await l.sendToGraveyard(["Effect","Excavate"],i.action.entity,i.activator),i.activator.writeInfoLog(`${l.toString()}ã¯é€šå¸¸å¬å–šå¯èƒ½ã ãŒç‰¹æ®Šå¬å–šã§ããªã„ãŸã‚ã€å¢“åœ°ã«é€ã‚‰ã‚ŒãŸã€‚`),!1):l.lvl===a?(await l.sendToGraveyard(["Effect","Excavate"],i.action.entity,i.activator),i.activator.writeInfoLog(`${l.toString()}ã®ãƒ¬ãƒ™ãƒ«ã¯${a}ã®ãŸã‚ã€å¢“åœ°ã«é€ã‚‰ã‚ŒãŸã€‚`),!1):!!await i.activator.summon("SpecialSummon",["Effect","Excavate"],i.action,l,k,i.activator.getAvailableMonsterZones(),[],!1)}return i.activator.writeInfoLog("é€šå¸¸å¬å–šå¯èƒ½ãªãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ãŒã‚ãã‚‰ã‚Œãªã‹ã£ãŸãŸã‚ã€å…¨ã¦ã®ã‚«ãƒ¼ãƒ‰ã‚’ãƒ‡ãƒƒã‚­ã«æˆ»ã™ã€‚"),await _.returnManyToDeckForTheSameReason("Random",r,["Effect"],i.action.entity,i.activator),!1},settle:async()=>!0};t==="ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã‚²ãƒ¼ãƒˆ"&&(e={...e,...wd()}),yield{name:t,actions:[e,b]}}}const _s=Object.freeze(Object.defineProperty({__proto__:null,default:rf},Symbol.toStringTag,{value:"Module"}));function*nf(){const t=[{name:"é­”æ³•çŸ³ã®æŽ¡æŽ˜",filter:()=>!0,discard:!0},{name:"é­”æ³•å†ç”Ÿ",filter:e=>e.kind==="Spell",discard:!1}];for(const e of t)yield{name:e.name,actions:[{title:"ç™ºå‹•",isMandatory:!1,playType:"CardActivation",spellSpeed:"Normal",executableCells:["Hand","SpellAndTrapZone"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],fixedTags:["AddToHandFromGraveyard"],canPayCosts:i=>i.activator.getHandCell().cardEntities.filter(e.filter).length>1,payCosts:async(i,a,r)=>{const n=i.activator.getHandCell().cardEntities.filter(e.filter),s=await i.activator.waitSelectEntities(n,2,l=>l.length===2,"ã‚³ã‚¹ãƒˆã¨ã™ã‚‹ã‚«ãƒ¼ãƒ‰ã‚’é¸æŠž",r);if(s)return e.discard?(await _.discardManyForTheSameReason(s,["Cost"],i.action.entity,i.activator),{discard:s}):(await _.sendManyToGraveyardForTheSameReason(s,["Cost"],i.action.entity,i.activator),{sendToGraveyard:s})},..._e(i=>i.activator.getGraveyard().cardEntities.filter(a=>a.kind==="Spell"),{message:"æ‰‹æœ­ã«åŠ ãˆã‚‹é­”æ³•ã‚«ãƒ¼ãƒ‰ã‚’é¸æŠž"}),execute:async i=>{if(!i.selectedEntities.length)throw new S("æƒ³å®šã•ã‚Œãªã„çŠ¶æ…‹",i);const a=i.selectedEntities[0];return a.wasMovedAfter(i.isActivatedAt)?!1:(await a.addToHand(["Effect"],i.action.entity,i.activator),!0)},settle:async()=>!0},b]}}const Ts=Object.freeze(Object.defineProperty({__proto__:null,default:nf},Symbol.toStringTag,{value:"Module"}));function*sf(){for(const t of[{name:"ãƒˆã‚²ãƒˆã‚²ç¥žã®æ®ºè™«å‰¤",type:"Insect"},{name:"æˆ¦å£«æŠ¹æ®º",type:"Warrior"},{name:"é…¸ã®åµ",type:"Machine"},{name:"æ°¸é ã®æ¸‡æ°´",type:"Fish"},{name:"ç¥žã®æ¯å¹",type:"Rock"},{name:"é­”å¥³ç‹©ã‚Š",type:"Spellcaster"},{name:"æ‚ªé­”æ‰•ã„",type:"Fiend"}])yield{name:t.name,actions:[{title:"ç™ºå‹•",isMandatory:!1,playType:"CardActivation",spellSpeed:"Normal",executableCells:["Hand","SpellAndTrapZone"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],canExecute:e=>e.action.entity.field.getMonstersOnFieldStrictly().some(i=>i.types.includes(t.type)),prepare:async e=>{const i=e.action.entity.field.getMonstersOnFieldStrictly().filter(a=>a.types.includes(t.type));return{selectedEntities:[],chainBlockTags:e.action.calcChainBlockTagsForDestroy(e.activator,i)}},execute:async e=>{const i=e.action.entity.field.getMonstersOnFieldStrictly().filter(a=>a.types.includes(t.type));return await _.tryDestroy(i,e),!0},settle:async()=>!0},b]};yield*[{name:"å¢—æ´",filter:t=>t.origin.kind==="Monster"&&t.types.includes("Warrior")&&(t.origin.level??5)<5},{name:"åŒ–çŸ³èª¿æŸ»",filter:t=>t.origin.kind==="Monster"&&t.types.includes("Dinosaur")&&(t.origin.level??6)<6},{name:"ï¼¥ï¼ã‚¨ãƒžãƒ¼ã‚¸ã‚§ãƒ³ã‚·ãƒ¼ã‚³ãƒ¼ãƒ«",filter:t=>t.origin.kind==="Monster"&&(t.origin.nameTags??[]).includes("ï¼¥ãƒ»ï¼¨ï¼¥ï¼²ï¼¯")},{name:"å¬é›†ã®è–åˆ»å°",filter:t=>t.origin.kind==="Monster"&&(t.origin.nameTags??[]).includes("è–åˆ»")},{name:"å¬å–šå¸«ã®ã‚¹ã‚­ãƒ«",filter:t=>t.origin.kind==="Monster"&&(t.origin.monsterCategories??[]).includes("Normal")&&(t.origin.level??4)>4},{name:"ãƒˆã‚¥ãƒ¼ãƒ³ã®ã‚‚ãã˜",filter:t=>(t.origin.nameTags??[]).includes("ãƒˆã‚¥ãƒ¼ãƒ³")},{name:"èžåˆè³¢è€…",filter:t=>t.origin.name==="èžåˆ"},{name:"è™¹ã®æž¶ã‘æ©‹",filter:t=>t.origin.kind!=="Monster"&&(t.origin.nameTags??[]).includes("å®çŽ‰")},{name:"ç´«ç‚Žã®ç‹¼ç…™",filter:t=>t.origin.kind==="Monster"&&(t.origin.nameTags??[]).includes("å…­æ­¦è¡†")&&(t.origin.level??4)<4},{name:"ãƒ†ãƒ©ãƒ»ãƒ•ã‚©ãƒ¼ãƒŸãƒ³ã‚°",filter:t=>t.origin.kind==="Spell"&&t.origin.spellCategory==="Field"},{name:"ã‚³ãƒ¼ãƒ«ãƒ»ãƒªã‚¾ãƒãƒ¼ã‚¿ãƒ¼",filter:t=>t.origin.kind==="Monster"&&(t.origin.nameTags??[]).includes("ãƒªã‚¾ãƒãƒ¼ã‚¿ãƒ¼")}].map(t=>({name:t.name,actions:[{title:"ç™ºå‹•",isMandatory:!1,playType:"CardActivation",spellSpeed:"Normal",executableCells:["Hand","SpellAndTrapZone"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],fixedTags:["SearchFromDeck"],priorityForNPC:40,canExecute:e=>e.activator.getDeckCell().cardEntities.some(t.filter)&&e.activator.canAddToHandFromDeck,prepare:T,execute:async e=>{const i=e.activator.getDeckCell().cardEntities.filter(t.filter);if(!i.length)return!1;const a=await e.activator.waitSelectEntity(i,"æ‰‹æœ­ã«åŠ ãˆã‚‹ã‚«ãƒ¼ãƒ‰ã‚’é¸æŠž",!1);return a?(await a.addToHand(["Effect"],e.action.entity,e.activator),e.activator.getDeckCell().shuffle(),!0):!1},settle:async()=>!0},b]})),yield*[{name:"æˆ¦å£«ã®ç”Ÿé‚„",filter:t=>t.kind==="Monster"&&t.types.includes("Warrior"),qty:1},{name:"ãƒ€ãƒ¼ã‚¯ãƒ»ãƒãƒ¼ã‚¹ãƒˆ",filter:t=>t.kind==="Monster"&&t.attr.includes("Dark")&&(t.atk??9999)<=1500,qty:1},{name:"æ‚ªå¤¢å†ã³",filter:t=>t.kind==="Monster"&&t.attr.includes("Dark")&&(t.def??9999)===0,qty:2},{name:"ã‚µãƒ«ãƒ™ãƒ¼ã‚¸",filter:t=>t.kind==="Monster"&&t.attr.includes("Water")&&(t.atk??9999)<=1500,qty:2},{name:"ãƒãƒƒãƒ†ãƒªãƒ¼ãƒªã‚µã‚¤ã‚¯ãƒ«",filter:t=>t.kind==="Monster"&&t.types.includes("Thunder")&&(t.atk??9999)<=1500,qty:2},{name:"é—‡ã®é‡ç”£å·¥å ´",filter:t=>t.kind==="Monster"&&(t.status.monsterCategories??[]).includes("Normal"),qty:2}].map(t=>({name:t.name,actions:[{title:"ç™ºå‹•",isMandatory:!1,playType:"CardActivation",spellSpeed:"Normal",executableCells:["Hand","SpellAndTrapZone"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],hasToTargetCards:!0,fixedTags:["AddToHandFromGraveyard"],priorityForNPC:40,canExecute:e=>e.activator.getGraveyard().cardEntities.filter(t.filter).length>=t.qty,prepare:T,execute:async e=>{const i=e.activator.getGraveyard().cardEntities.filter(t.filter);if(i.length===0)return!1;const a=await e.activator.waitSelectEntities(i,t.qty,r=>r.length===t.qty,"æ‰‹æœ­ã«åŠ ãˆã‚‹ã‚«ãƒ¼ãƒ‰ã‚’é¸æŠž",!1);for(const r of a??[])await r.addToHand(["Effect"],e.action.entity,e.activator);return!0},settle:async()=>!0},b]})),yield*[{name:"ãƒˆãƒ¬ãƒ¼ãƒ‰ãƒ»ã‚¤ãƒ³",filter:t=>t.kind==="Monster"&&(t.lvl??0)===8},{name:"èª¿å’Œã®å®æœ­",filter:t=>t.kind==="Monster"&&(t.origin.monsterCategories??[]).includes("Tuner")&&t.types.includes("Dragon")&&(t.atk??9999)<=1e3},{name:"ãƒ‡ã‚¹ãƒ†ãƒ‹ãƒ¼ãƒ»ãƒ‰ãƒ­ãƒ¼",filter:t=>t.kind==="Monster"&&(t.origin.nameTags??[]).includes("ï¼¤ï¼ï¼¨ï¼¥ï¼²ï¼¯")}].map(t=>({name:t.name,actions:[{title:"ç™ºå‹•",isMandatory:!1,playType:"CardActivation",spellSpeed:"Normal",executableCells:["Hand","SpellAndTrapZone"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],fixedTags:["Draw"],priorityForNPC:40,canPayCosts:(...e)=>jt(...e,t.filter),canExecute:e=>e.activator.getDeckCell().cardEntities.length>1,payCosts:async(...e)=>zt(...e,t.filter),prepare:async()=>({selectedEntities:[]}),execute:async e=>(await e.activator.draw(2,e.action.entity,e.activator),!0),settle:async()=>!0},b]})),yield*[{name:"ç«ã®ç²‰",calcHeal:()=>[0,-200]},{name:"é›·é³´",calcHeal:()=>[0,-300]},{name:"ãƒ•ã‚¡ã‚¤ãƒ¤ãƒ¼ãƒ»ãƒœãƒ¼ãƒ«",calcHeal:()=>[0,-500]},{name:"ç«ã‚ã¶ã‚Šã®åˆ‘",calcHeal:()=>[0,-600]},{name:"æ˜¼å¤œã®å¤§ç«äº‹",calcHeal:()=>[0,-800]},{name:"ç«ç‚Žåœ°ç„",calcHeal:()=>[-500,-1e3]},{name:"ç›—äººã‚´ãƒ–ãƒªãƒ³",calcHeal:()=>[500,-500]},{name:"ãƒ–ãƒ«ãƒ¼ãƒ»ãƒãƒ¼ã‚·ãƒ§ãƒ³",calcHeal:()=>[400,0]},{name:"ãƒ¬ãƒƒãƒ‰ãƒ»ãƒãƒ¼ã‚·ãƒ§ãƒ³",calcHeal:()=>[500,0]},{name:"ã‚´ãƒ–ãƒªãƒ³ã®ç§˜è–¬",calcHeal:()=>[600,0]},{name:"å¤©ä½¿ã®ç”Ÿãè¡€",calcHeal:()=>[800,0]},{name:"æ²»ç™‚ã®ç¥ž ãƒ‡ã‚£ã‚¢ãƒ³ãƒ»ã‚±ãƒˆ",calcHeal:()=>[1e3,0]},{name:"æµã¿ã®é›¨",calcHeal:()=>[1e3,1e3]}].map(t=>({name:t.name,actions:[{title:"ç™ºå‹•",isMandatory:!1,playType:"CardActivation",spellSpeed:"Normal",executableCells:["Hand","SpellAndTrapZone"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],prepare:async()=>{const[e,i]=t.calcHeal(),a=[];return e<0&&a.push("DamageToSelf"),i<0&&a.push("DamageToOpponent"),{selectedEntities:[],chainBlockTags:a}},execute:async e=>{const[i,a]=t.calcHeal();return a>0?e.activator.getOpponentPlayer().heal(a,e.action.entity):a<0&&e.activator.getOpponentPlayer().effectDamage(Math.abs(a),e),i>0?e.activator.heal(i,e.action.entity):i<0&&e.activator.effectDamage(Math.abs(i),e),!0},settle:async()=>!0},b]}))}const Cs=Object.freeze(Object.defineProperty({__proto__:null,default:sf},Symbol.toStringTag,{value:"Module"}));function*lf(){yield{name:"å¼·æ¬²ãªç“¶",actions:[b,{title:"ç™ºå‹•",isMandatory:!1,playType:"CardActivation",spellSpeed:"Quick",executableCells:["SpellAndTrapZone"],executablePeriods:D,executableDuelistTypes:["Controller"],fixedTags:["Draw"],canExecute:t=>t.activator.getDeckCell().cardEntities.length>1&&t.activator.canDraw&&t.activator.canAddToHandFromDeck,prepare:T,execute:async t=>(await t.activator.draw(1,t.action.entity,t.activator),!0),settle:async()=>!0}]},yield{name:"æˆ¦ç·šå¾©å¸°",actions:[{title:"ç™ºå‹•",isMandatory:!1,playType:"CardActivation",spellSpeed:"Quick",executableCells:["SpellAndTrapZone"],executablePeriods:D,executableDuelistTypes:["Controller"],fixedTags:["SpecialSummonFromGraveyard"],...Ze(t=>t.activator.getGraveyard().cardEntities.filter(e=>e.kind==="Monster").filter(e=>e.canBeTargetOfEffect(t)),{posList:["Defense"]}),settle:async()=>!0},b]},yield{name:"ã‚µãƒ³ãƒ€ãƒ¼ãƒ»ãƒ–ãƒ¬ã‚¤ã‚¯",actions:[{title:"ç™ºå‹•",isMandatory:!1,playType:"CardActivation",spellSpeed:"Quick",executableCells:["SpellAndTrapZone"],executablePeriods:D,executableDuelistTypes:["Controller"],canPayCosts:jt,payCosts:zt,..._e((t,e,i)=>t.action.entity.field.getCardsOnFieldStrictly().filter(a=>a!==t.action.entity).filter(a=>a.canBeTargetOfEffect(t)).filter(a=>{if(!i)return!0;const r=Ui.flatMap(n=>i.costInfo[n]??[]);return r.push(...r.flatMap(n=>n.info.equipEntities)),!r.includes(a)}),{message:"å¯¾è±¡ã¨ã™ã‚‹ã‚«ãƒ¼ãƒ‰ã‚’é¸æŠžã€‚",do:"Destroy"}),execute:async t=>t.selectedEntities.every(e=>!e.isOnField)?!1:(await _.tryDestroy(t.selectedEntities,t),!0),settle:async()=>!0},b]},yield{name:"ã‚®ãƒ–ï¼†ãƒ†ã‚¤ã‚¯",actions:[{title:"ç™ºå‹•",isMandatory:!1,playType:"CardActivation",spellSpeed:"Quick",executableCells:["SpellAndTrapZone"],executablePeriods:D,executableDuelistTypes:["Controller"],hasToTargetCards:!0,fixedTags:["SpecialSummonFromGraveyard"],canExecute:(e,i,a)=>{const r=e.activator.getOpponentPlayer().getMonsterZones();return e.activator.getEnableSummonList(e.activator,"SpecialSummon",["Effect"],e.action,e.activator.getGraveyard().cardEntities.filter(s=>s.lvl).filter(s=>s.canBeTargetOfEffect(e)).map(s=>({monster:s,posList:["Defense"],cells:r})),[],!1).length?e.activator.getMonstersOnField().filter(s=>s.lvl).filter(s=>{if(!a)return!0;const l=Ui.flatMap(o=>a.costInfo[o]??[]);return l.push(...l.flatMap(o=>o.info.equipEntities)),!l.includes(s)}).some(s=>s.canBeTargetOfEffect(e)):!1},prepare:async(e,i,a)=>{const r=await e.activator.waitSelectEntity(e.activator.getMonstersOnField().filter(l=>l.lvl),"ãƒ¬ãƒ™ãƒ«ã‚’ä¸Šã’ã‚‹ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã‚’é¸æŠžã€‚",a);if(!r)return;const n=await Ed(e,e.activator.getGraveyard().cardEntities.filter(l=>l.lvl).filter(l=>l.canBeTargetOfEffect(e)),["Defense"]),s=[r,...n.selectedEntities];return e.data={give:n.selectedEntities[0],take:r},{...n,selectedEntities:s}},execute:async e=>{if(!e.data)throw new S("æ­£ã—ããªã„å½¢ã§ã‚®ãƒ–ï¼†ãƒ†ã‚¤ã‚¯ã®åŠ¹æžœå‡¦ç†ã‚’å®Ÿè¡Œã—ã‚ˆã†ã¨ã—ãŸã€‚");const{give:i,take:a}=e.data;if(!a.isOnFieldAsMonsterStrictly||!await es(e,[i],{cells:e.activator.getOpponentPlayer().getMonsterZones(),posList:["Defense"]}))return!1;const n=i.lvl??0;return a.numericOprsBundle.push(ne.createLingeringAddition("ã‚®ãƒ–ï¼†ãƒ†ã‚¤ã‚¯",s=>s.duel.clock.isSameTurn(s.isSpawnedAt),e.action.entity,e.action,"level",(s,l,o)=>o+n)),!0},settle:async()=>!0},b]}}const ws=Object.freeze(Object.defineProperty({__proto__:null,default:lf},Symbol.toStringTag,{value:"Module"}));function*of(){for(const t of["ç‚¸è£‚è£…ç”²","æ¬¡å…ƒå¹½é–‰"])yield{name:t,actions:[b,{title:"ç™ºå‹•",playType:"CardActivation",spellSpeed:"Quick",isMandatory:!1,executableCells:["SpellAndTrapZone"],executablePeriods:["b1Battle","b2Battle"],executableDuelistTypes:["Controller"],hasToTargetCards:!0,isNoticedForcibly:!0,meetsConditions:(e,i)=>i.some(a=>a.action.playType==="DeclareAttack"),canExecute:e=>{if(e.activator.isTurnPlayer)return!1;const i=e.activator.duel.attackingMonster;return!(!i||!i.canBeTargetOfEffect(e)||!i.isOnFieldAsMonsterStrictly||t==="æ¬¡å…ƒå¹½é–‰"&&!e.activator.canTryBanish(i,"BanishAsEffect",e.action))},prepare:async e=>{const i=e.activator.duel.attackingMonster;if(!i)throw new S("æƒ³å®šã•ã‚Œãªã„çŠ¶æ…‹",e,i);const a=t==="ç‚¸è£‚è£…ç”²"?e.action.calcChainBlockTagsForDestroy(e.activator,[i]):["BanishFromField"];return{selectedEntities:[i],chainBlockTags:a}},execute:async e=>(t==="ç‚¸è£‚è£…ç”²"?await _.tryDestroy(e.selectedEntities,e):await _.tryBanish("BanishAsEffect",e.selectedEntities,e),!0),settle:async()=>!0}]}}const Es=Object.freeze(Object.defineProperty({__proto__:null,default:of},Symbol.toStringTag,{value:"Module"}));function*cf(){yield{name:"ã”éš å±…ã®çŒ›æ¯’è–¬",actions:[b,{title:"ç™ºå‹•",isMandatory:!1,playType:"CardActivation",spellSpeed:"Quick",executableCells:["Hand","SpellAndTrapZone"],executablePeriods:D,executableDuelistTypes:["Controller"],prepare:async(t,e,i)=>{const a=[{seq:0,text:"â—è‡ªåˆ†ã¯ï¼‘ï¼’ï¼ï¼ï¼¬ï¼°å›žå¾©ã™ã‚‹ã€‚",tags:[]},{seq:1,text:"â—ç›¸æ‰‹ã«ï¼˜ï¼ï¼ãƒ€ãƒ¡ãƒ¼ã‚¸ã‚’ä¸Žãˆã‚‹ã€‚",tags:["DamageToOpponent"]}],r=await t.activator.waitSelectText(a,"ä½¿ç”¨ã™ã‚‹åŠ¹æžœã‚’é¸æŠž",i);if(r!==void 0)return{selectedEntities:[],chainBlockTags:r.tags}},execute:async t=>{if(t.data===0)t.activator.heal(1200,t.action.entity);else if(t.data===1)t.activator.getOpponentPlayer().effectDamage(800,t);else throw new S("å€¤ãŒæ­£ã—ããªã„ã€‚",t,t.data);return!0},settle:async()=>!0}]},yield{name:"æœˆã®æ›¸",actions:[{title:"ç™ºå‹•",isMandatory:!1,playType:"CardActivation",spellSpeed:"Quick",executableCells:["Hand","SpellAndTrapZone"],executablePeriods:D,executableDuelistTypes:["Controller"],..._e(t=>t.action.entity.field.getMonstersOnFieldStrictly().filter(e=>e.canBeTargetOfEffect(t)).filter(e=>e.canBeSet).filter(e=>e.face==="FaceUp"),{message:"å¯¾è±¡ã¨ã™ã‚‹ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã‚’é¸æŠžã€‚"}),execute:async t=>{const e=t.selectedEntities[0];return!e.isOnFieldAsMonsterStrictly||e.battlePosition==="Set"?!1:e.canBeEffected(t.activator,t.action.entity,t.action)?(await e.setBattlePosition("Set",["Effect"],t.action.entity,t.activator),!0):(t.activator.duel.log.info(`${e.toString()}ã¯${t.action.entity.toString()}ã®åŠ¹æžœã‚’å—ã‘ãªã„ã€‚`),!1)},settle:async()=>!0},b]},yield{name:"çªé€²",actions:[{title:"ç™ºå‹•",isMandatory:!1,playType:"CardActivation",spellSpeed:"Quick",executableCells:["Hand","SpellAndTrapZone"],executablePeriods:[...D,...O],executableDuelistTypes:["Controller"],..._e(t=>t.action.entity.field.getMonstersOnFieldStrictly().filter(e=>e.face==="FaceUp").filter(e=>e.canBeTargetOfEffect(t)),{message:"å¯¾è±¡ã¨ã™ã‚‹ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã‚’é¸æŠžã€‚"}),execute:async t=>{const e=t.selectedEntities[0];return!e.isOnFieldAsMonsterStrictly||e.battlePosition==="Set"?!1:e.canBeEffected(t.activator,t.action.entity,t.action)?(e.numericOprsBundle.push(ne.createLingeringAddition("æ”»æ’ƒåŠ›ä¸Šæ˜‡",i=>i.duel.clock.isSameTurn(i.isSpawnedAt),t.action.entity,t.action,"attack",(i,a,r)=>r+700)),!0):(t.activator.duel.log.info(`${e.toString()}ã¯${t.action.entity.toString()}ã®åŠ¹æžœã‚’å—ã‘ãªã„ã€‚`),!1)},settle:async()=>!0},b]},yield{name:"æ‰‹æœ­æ–­æ®º",actions:[{title:"ç™ºå‹•",isMandatory:!1,playType:"CardActivation",spellSpeed:"Quick",executableCells:["Hand","SpellAndTrapZone"],executablePeriods:[...D,...O],executableDuelistTypes:["Controller"],fixedTags:["Draw"],canExecute:t=>{for(const e of[t.activator,t.activator.getOpponentPlayer()])if(!e.canDraw||e.getHandCell().cardEntities.filter(i=>i.canBeSentToGraveyard(t.activator,t.action.entity,"SendToGraveyardAsEffect",t.action)).filter(i=>i!==t.action.entity).length<2||e.getDeckCell().cardEntities.length<2)return!1;return!0},prepare:T,execute:async t=>{if(t.activator.getHandCell().cardEntities.length<2||t.activator.getOpponentPlayer().getHandCell().cardEntities.length<2)return!1;let e=0;for(const i of[t.activator,t.activator.getOpponentPlayer()]){const a=await i.waitSelectEntities(i.getHandCell().cardEntities,2,n=>n.length===2,"å¢“åœ°ã«é€ã‚‹ã‚«ãƒ¼ãƒ‰ã‚’ï¼’æžšé¸æŠžã€‚",!1);if(!a)throw new F(t,i);const r=await _.sendManyToGraveyardForTheSameReason(a,["Effect"],t.action.entity,t.activator);e+=r.length}return e?(t.activator.duel.clock.incrementProcSeq(),await _.drawAtSameTime(t.activator,t.action.entity,2,2),!0):!1},settle:async()=>!0},b]},yield{name:"ãƒªãƒ­ãƒ¼ãƒ‰",actions:[{title:"ç™ºå‹•",isMandatory:!1,playType:"CardActivation",spellSpeed:"Quick",executableCells:["Hand","SpellAndTrapZone"],executablePeriods:[...D,...O],executableDuelistTypes:["Controller"],fixedTags:["Draw"],hasToTargetCards:!0,canExecute:t=>t.activator.canDraw,prepare:T,execute:async t=>{const e=t.activator.getHandCell().cardEntities;return e.length?(await _.returnManyToDeckForTheSameReason("Random",e,["Effect"],t.action.entity,t.activator),t.activator.duel.clock.incrementProcSeq(),await t.activator.draw(e.length,t.action.entity,t.activator),!0):!1},settle:async()=>!0},b]}}const bs=Object.freeze(Object.defineProperty({__proto__:null,default:cf},Symbol.toStringTag,{value:"Module"})),uf=(t,e,i,a,r,n,s)=>{if(!t.lvl||r.some(d=>!d.lvl))return;const l=r.map(d=>d.lvl??0).reduce((d,f)=>d+f,0),o=r.map(d=>d.lvl??0).min()??0;if(l<t.lvl||s==="Equal"&&l!==t.lvl||s==="OrMore"&&l-o>=t.lvl||!n(r))return;const u=[...r.map(d=>({material:d,cell:d.cell}))];if(e.activator.getEnableSummonList(e.activator,"RitualSummon",["Effect","SpecialSummon"],e.action,[{monster:e.action.entity,posList:i,cells:a}],u,!1).length)return u};function*ks(t,...e){const[i,a,r,n,s]=e,l=t.activator.getCells(...i).flatMap(f=>f.cardEntities).filter(f=>{var p;return(p=f.status.monsterCategories)==null?void 0:p.includes("Ritual")}).filter(a);if(!l.length)return;const o=t.activator.getCells(...r).flatMap(f=>f.cardEntities).filter(f=>f.lvl).filter(f=>f.canBeReleased(t.activator,t.action.entity,["RitualMaterial","ReleaseAsEffect"],t.action));if(!o.length)return;const u=t.activator.getMonsterZones(),d=["Attack","Defense"];for(const f of l)for(const p of o.filter(h=>h!==f).getAllOnOffPattern()){const h=uf(f,t,d,u,p,n,s);h&&(yield{monster:f,materialInfos:h})}}const df=async(t,...e)=>{var d,f;const i=ks(t,...e).toArray(),a=i.map(p=>p.monster).getDistinct(),r=await t.activator.waitSelectEntity(a,"å„€å¼å¬å–šã™ã‚‹ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã‚’é¸æŠžã€‚");if(!r)return!1;const n=i.filter(p=>p.monster===r).map(p=>p.materialInfos),s=n.map(p=>({infos:p,materialSeqList:p.map(h=>h.material.seq).sort()}));let l=n[0].map(p=>p.material);if(n.length>1){const p=n.flatMap(h=>h.map(y=>y.material)).getDistinct();l=await t.activator.waitSelectEntities(p,void 0,h=>{const y=h.map(v=>v.seq).sort();return s.some(v=>y.length===v.materialSeqList.length&&y.every((g,m)=>g===v.materialSeqList[m]))},"ãƒªãƒªãƒ¼ã‚¹ã™ã‚‹ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã‚’é¸æŠž",!1)??l}const o=l.map(p=>p.seq).sort(),u=(d=s.find(p=>o.length===p.materialSeqList.length&&o.every((h,y)=>h===p.materialSeqList[y])))==null?void 0:d.infos;if(!u)throw new S("æƒ³å®šã•ã‚Œãªã„çŠ¶æ…‹",t,l);return await _.releaseManyForTheSameReason(l,["RitualMaterial","Effect","SpecialSummonMaterial"],t.action.entity,t.activator),await t.activator.summon("RitualSummon",["Effect","SpecialSummon"],t.action,r,k,t.activator.getMonsterZones(),u,!1),r.info.isRebornable=!((f=r.origin.monsterCategories)!=null&&f.includes("RegularSpecialSummonOnly")),u.map(p=>p.material).forEach(p=>p.onUsedAsMaterial(t,t.action.entity)),!0},ff=(t,e,i,a,r)=>({canExecute:n=>ks(n,t,e,i,a,r).some(s=>s.materialInfos.length),prepare:async()=>{const n=[];return t.includes("Hand")&&n.push("SpecialSummonFromHand"),t.includes("Graveyard")&&n.push("SpecialSummonFromGraveyard"),t.includes("ExtraDeck")&&n.push("SpecialSummonFromExtraDeck"),t.includes("Banished")&&n.push("SpecialSummonFromBanished"),t.includes("Deck")&&n.push("SpecialSummonFromDeck"),{selectedEntities:[],chainBlockTags:n}},execute:n=>df(n,t,e,i,a,r),settle:async()=>!0});function*pf(){for(const t of[{spellName:"ã‚«ã‚ªã‚¹ã®å„€å¼",monsterName:"ã‚«ã‚ªã‚¹ãƒ»ã‚½ãƒ«ã‚¸ãƒ£ãƒ¼"},{spellName:"ä»®é¢é­”ç£ã®å„€å¼",monsterName:"ä»®é¢é­”ç£ãƒžã‚¹ã‚¯ãƒ‰ãƒ»ãƒ˜ãƒ«ãƒ¬ã‚¤ã‚¶ãƒ¼"},{spellName:"äº€ã®èª“ã„",monsterName:"ã‚¯ãƒ©ãƒ–ãƒ»ã‚¿ãƒ¼ãƒˆãƒ«"},{spellName:"ã‚¸ãƒ£ãƒ™ãƒªãƒ³ãƒ“ãƒ¼ãƒˆãƒ«ã®å¥‘ç´„",monsterName:"ã‚¸ãƒ£ãƒ™ãƒªãƒ³ãƒ“ãƒ¼ãƒˆãƒ«"},{spellName:"ã‚¼ãƒ©ã®å„€å¼",monsterName:"ã‚¼ãƒ©"},{spellName:"ã‚«ã‚ªã‚¹ï¼é»’é­”è¡“ã®å„€å¼",monsterName:"ãƒžã‚¸ã‚·ãƒ£ãƒ³ãƒ»ã‚ªãƒ–ãƒ»ãƒ–ãƒ©ãƒƒã‚¯ã‚«ã‚ªã‚¹"},{spellName:"ã‚¬ãƒ«ãƒžã‚½ãƒ¼ãƒ‰ã®èª“ã„",monsterName:"ã‚¬ãƒ«ãƒžã‚½ãƒ¼ãƒ‰"},{spellName:"ãƒ©ã‚¤ã‚ªãƒ³ã®å„€å¼",monsterName:"ã‚¹ãƒ¼ãƒ‘ãƒ¼ãƒ»ã‚¦ã‚©ãƒ¼ãƒ»ãƒ©ã‚¤ã‚ªãƒ³"},{spellName:"ãƒãƒ£ã‚¯ãƒ©ã®å¾©æ´»",monsterName:"ãƒãƒ£ã‚¯ãƒ©"},{spellName:"è¦å¡žã‚¯ã‚¸ãƒ©ã®èª“ã„",monsterName:"è¦å¡žã‚¯ã‚¸ãƒ©"},{spellName:"ãƒ­ãƒ¼ã®ç¥ˆã‚Š",monsterName:"ãƒ­ãƒ¼ã‚¬ãƒ¼ãƒ‡ã‚£ã‚¢ãƒ³"},{spellName:"ã‚¹ã‚«ãƒ«ãƒ©ã‚¤ãƒ€ãƒ¼ã®å¾©æ´»",monsterName:"ã‚¹ã‚«ãƒ«ãƒ©ã‚¤ãƒ€ãƒ¼"},{spellName:"è¸Šã‚Šã«ã‚ˆã‚‹èª˜ç™º",monsterName:"ãƒ€ãƒ³ã‚·ãƒ³ã‚°ãƒ»ã‚½ãƒ«ã‚¸ãƒ£ãƒ¼"},{spellName:"æ‚ªé­”é¡ã®å„€å¼",monsterName:"ãƒ‡ãƒ“ãƒ«ã‚ºãƒ»ãƒŸãƒ©ãƒ¼"},{spellName:"ãƒãƒ³ãƒãƒ¼ã‚¬ãƒ¼ã®ãƒ¬ã‚·ãƒ”",monsterName:"ãƒãƒ³ã‚°ãƒªãƒ¼ãƒãƒ¼ã‚¬ãƒ¼"}])yield{name:t.spellName,actions:[{title:"ç™ºå‹•",isMandatory:!1,playType:"CardActivation",spellSpeed:"Normal",executableCells:["Hand","SpellAndTrapZone"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],...ff(["Hand"],e=>e.nm===t.monsterName,["Hand","MonsterZone","ExtraMonsterZone"],()=>!0,"OrMore")},b]}}const Ds=Object.freeze(Object.defineProperty({__proto__:null,default:pf},Symbol.toStringTag,{value:"Module"}));function*gf(){for(const t of["å¤§åœ°ã®é¨Žå£«ã‚¬ã‚¤ã‚¢ãƒŠã‚¤ãƒˆ","ã‚¹ã‚¯ãƒ©ãƒƒãƒ—ãƒ»ãƒ‡ã‚¹ãƒ‡ãƒ¼ãƒ¢ãƒ³"])yield{name:t,actions:[me()]};yield{name:"ãƒŠãƒãƒ¥ãƒ«ãƒ»ã‚¬ã‚ªãƒ‰ãƒ¬ã‚¤ã‚¯",actions:[me(t=>t.length===1&&t.every(e=>e.attr.some(i=>i==="Earth")),t=>t.length>0&&t.every(e=>e.attr.some(i=>i==="Earth")))]},yield{name:"ãƒžã‚¸ã‚«ãƒ«ãƒ»ã‚¢ãƒ³ãƒ‰ãƒ­ã‚¤ãƒ‰",actions:[me(),{title:"å›žå¾©",isMandatory:!0,playType:"IgnitionEffect",spellSpeed:"Normal",executableCells:["MonsterZone","ExtraMonsterZone"],executablePeriods:["end"],executableDuelistTypes:["Controller"],executableFaces:["FaceUp"],isOnlyNTimesPerTurnIfFaceup:1,meetsConditions:t=>t.activator.isTurnPlayer&&t.action.entity.face==="FaceUp",prepare:T,execute:async t=>(t.activator.heal(t.activator.getMonstersOnField().filter(e=>e.face==="FaceUp").filter(e=>e.types.includes("Psychic")).length*600,t.action.entity),!0),settle:async()=>!0}]}}const xs=Object.freeze(Object.defineProperty({__proto__:null,default:gf},Symbol.toStringTag,{value:"Module"}));function*hf(){yield{name:"ã«ã›ã‚¢ãƒã‚¿ãƒ¼",actions:[],continuousEffects:[pi("THE_DEVILS_AVATAR","Monster",t=>[t],t=>["attack","defense"].map(e=>ne.createContinuous("THE_DEVILS_AVATAR",i=>i.isSpawnedBy.isOnFieldStrictly&&i.isSpawnedBy.face==="FaceUp",t,(i,a)=>a.isOnFieldStrictly&&a.face==="FaceUp",e,"calculated","THE_DEVILS_AVATAR",()=>Number.MIN_VALUE)))]},yield{name:"ã«ã›ãƒ‰ãƒ¬ãƒƒãƒ‰ãƒ»ãƒ«ãƒ¼ãƒˆ",actions:[],continuousEffects:[Zi("THE_DEVILS_DREAD-ROOT","Monster",t=>["attack","defense"].map(e=>ne.createContinuous("THE_DEVILS_DREAD-ROOT",i=>i.isSpawnedBy.isOnFieldStrictly&&i.isSpawnedBy.face==="FaceUp",t,(i,a)=>a.isMonster&&a.isOnFieldStrictly&&a.face==="FaceUp"&&a!==i.isSpawnedBy,e,"calculated","THE_DEVILS_DREAD-ROOT",(i,a,r)=>Math.round(r/2))))]}}const As=Object.freeze(Object.defineProperty({__proto__:null,default:hf},Symbol.toStringTag,{value:"Module"})),yf=(t,e,i,a,r=2,n=2,s)=>{if(!t.action.entity.origin.rank||a.length<r||a.length>n||a.some(o=>!o.lvl)||a.some(o=>o.lvl!==t.action.entity.rank)||!s(a))return;const l=a.map(o=>({material:o,cell:o.cell,level:o.status.level}));if(t.activator.getEnableSummonList(t.activator,"XyzSummon",["Rule","XyzSummon","SpecialSummon"],t.action,[{monster:t.action.entity,posList:e,cells:i}],l,!1).length)return l};function*vf(t,e=2,i=2,a=r=>r.length>1){const r=t.activator.getMonstersOnField().filter(s=>s.battlePosition!=="Set");if(r.length<e)return;const n=[...t.activator.getMonsterZones(),...t.activator.getAvailableExtraMonsterZones()];yield*r.getAllOnOffPattern().filter(s=>s.length>=e).filter(s=>s.length<=i).map(s=>yf(t,k,n,s,e,i,a)??[]).filter(s=>s.length)}const mf=async(t,e,i)=>{var o;const a=t.action.getEnableMaterialPatterns(t).toArray(),r=a.map(u=>({infos:u,materialSeqList:u.map(d=>d.material.seq).sort()}));let n=a[0].map(u=>u.material);if(a.length>1){const u=a.flatMap(f=>f.map(p=>p.material)).getDistinct(),d=await t.activator.waitSelectEntities(u,void 0,f=>{const p=f.map(h=>h.seq).sort();return r.some(h=>p.length===h.materialSeqList.length&&p.every((y,v)=>y===h.materialSeqList[v]))},"ã‚¨ã‚¯ã‚·ãƒ¼ã‚ºç´ æã¨ã™ã‚‹ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã‚’é¸æŠž",i);if(!d)return;n=d}const s=n.map(u=>u.seq).sort(),l=(o=r.find(u=>s.length===u.materialSeqList.length&&s.every((d,f)=>d===u.materialSeqList[f])))==null?void 0:o.infos;if(!l)throw new S("æƒ³å®šã•ã‚Œãªã„çŠ¶æ…‹",t,n);return await _.convertManyToXyzMaterials(l.map(u=>u.material),["XyzMaterial","Rule","Cost"],t.action.entity,t.activator),{summonMaterialInfos:l}},Ps=(t=2,e=2,i=a=>a.length>1)=>({title:"ã‚¨ã‚¯ã‚·ãƒ¼ã‚ºå¬å–š",isMandatory:!1,playType:"SpecialSummon",spellSpeed:"Normal",executableCells:["ExtraDeck"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],getEnableMaterialPatterns:a=>vf(a,t,e,i),canPayCosts:a=>a.action.getEnableMaterialPatterns(a).some(r=>r.length),canExecute:a=>!a.ignoreCosts||a.activator.getAvailableExtraMonsterZones().length+a.activator.getAvailableMonsterZones().length>0,payCosts:mf,prepare:a=>ot(a,"XyzSummon",["Rule","SpecialSummon","XyzSummon"],["Attack","Defense"]),execute:ct,settle:async()=>!0}),Sf=(t=1,e=1,i=()=>!0)=>({canPayCosts:(...a)=>{const[r]=a;return r.action.entity.getXyzMaterials().filter(n=>i(...a,n)).length>=t},payCosts:async(a,r,n)=>{const s=a.action.entity.getXyzMaterials().filter(o=>i(a,r,o));let l=s.slice(0,t);if(s.length>t){const o=t===e?t:void 0,u=await a.activator.waitSelectEntities(s,o,d=>d.length>=t&&d.length<=e,"ã‚³ã‚¹ãƒˆã¨ã™ã‚‹XYZç´ æã‚’é¸æŠž",n);if(!u)return;l=u}return await _.releaseManyForTheSameReason(l,["Cost"],a.action.entity,a.activator),{xyzMaterial:l}}});function*_f(){yield*[{name:"ã‚¸ã‚§ãƒ ãƒŠã‚¤ãƒˆãƒ»ãƒ‘ãƒ¼ãƒ«",qty:2},{name:"è¦šé†’ã®å‹‡å£« ã‚¬ã‚¬ã‚®ã‚´",qty:3}].map(t=>({name:t.name,actions:[Ps(t.qty,t.qty)]}))}const Ms=Object.freeze(Object.defineProperty({__proto__:null,default:_f},Symbol.toStringTag,{value:"Module"}));function*Tf(){yield{name:"ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ãƒ»ãƒ©ã‚¤ã‚¶ãƒ¼ãƒ»ãƒ‰ãƒ©ã‚´ãƒ³",actions:[me(),{title:"â‘ å¢“åœ°é€ã‚Š",isMandatory:!1,playType:"TriggerEffect",spellSpeed:"Normal",executableCells:H,executablePeriods:[...D,...O],executableDuelistTypes:["Controller"],triggerPattern:{triggerType:"Arrival",arrivalReasons:["SynchroSummon"]},fixedTags:["SendToGraveyardFromDeck","IfSpecialSummonSucceed"],isOnlyNTimesPerTurn:1,canExecute:t=>t.activator.getDeckCell().cardEntities.some(e=>(e.lvl??12)<(t.action.entity.lvl??0)),prepare:T,execute:async t=>{const e=t.activator.getDeckCell().cardEntities.filter(r=>(r.lvl??12)<(t.action.entity.lvl??0));if(e.length===0)return!1;const i=await t.activator.waitSelectEntity(e,"å¢“åœ°ã«é€ã‚‹ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã‚’é¸æŠž",!1);if(!i)throw new S("æƒ³å®šã•ã‚Œãªã„çŠ¶æ³",t);await i.sendToGraveyard(["Effect"],t.action.entity,t.activator);const a=i.lvl??0;return t.action.entity.numericOprsBundle.push(ne.createLingeringAddition("ãƒ¬ãƒ™ãƒ«æ¸›å°‘",()=>!0,t.action.entity,t.action,"level",(r,n,s)=>s-a)),!0},settle:async()=>!0},fs({title:"â‘¡ã‚·ãƒ³ã‚¯ãƒ­å¬å–š",isOnlyNTimesPerChain:1})]}}const Fs=Object.freeze(Object.defineProperty({__proto__:null,default:Tf},Symbol.toStringTag,{value:"Module"})),Cf=(t,e,i,a,r,n)=>{const s=t.fusionMaterialInfos.filter(u=>u.type!=="Overmuch");if(!s.length||!r.length||s.length!==r.length||!n(e,t,r)||!t.validateFusionMaterials(r))return;const l=s.map(u=>{const d=[];return nt(u)?d.push(...r.filter(f=>u.cardName===f.nm||f.status.fusionSubstitute)):d.push(...r.filter(u.filter)),{require:u,materials:d}});if(l.some(u=>!u.materials.length)||l.flatMap(u=>u.materials).getDistinct().length<r.length)return;let o=[[]];for(const u of l)o=[...o.flatMap(d=>u.materials.map(f=>{if(d.some(h=>h.material===f))return[...d];const p={material:f,cell:f.cell};return nt(u.require)&&(p.name=u.require.cardName),[...d,p]}))];return o=o.filter(u=>u.length===r.length).filter(u=>u.filter(d=>d.name&&d.material.nm!==d.name).length<2),o.find(u=>e.activator.getEnableSummonList(e.activator,"FusionSummon",["Effect","SpecialSummon"],e.action,[{monster:e.action.entity,posList:i,cells:a}],u,!1).length)};function*Os(t,...e){const[i,a,r,n,s]=e,l=t.activator.getCells(...i).flatMap(f=>f.cardEntities).filter(f=>{var p;return(p=f.status.monsterCategories)==null?void 0:p.includes("Fusion")}).filter(f=>a(t,f));if(!l.length)return;const o=t.activator.getCells(...r).flatMap(f=>f.cardEntities).filter(f=>f.isMonster).filter(f=>f.face==="FaceUp"||f.cell.cellType!=="Banished").filter(f=>f.canBeEffected(t.activator,t.action.entity,t.action));if(s!=null&&s.requisitionFrom&&o.push(...t.activator.getOpponentPlayer().getCells(...s.requisitionFrom).flatMap(f=>f.cardEntities).filter(f=>f.isMonster).filter(f=>f.face==="FaceUp").filter(f=>f.canBeEffected(t.activator,t.action.entity,t.action))),!o.length)return;const u=[...t.activator.getMonsterZones(),...t.activator.duel.field.getCells("ExtraMonsterZone")],d=["Attack","Defense"];for(const f of l){const p=f.fusionMaterialInfos.filter(h=>h.type!=="Overmuch");if(p.length&&!(o.every(h=>!h.status.fusionSubstitute)&&p.filter(nt).some(h=>o.every(y=>y.nm!==h.cardName)))&&!p.filter(Tp).some(h=>o.every(y=>!h.filter(y))))for(const h of o.filter(y=>y!==f).getAllOnOffPattern().filter(y=>y.length===p.length)){const y=Cf(f,t,d,u,h,n);y&&(yield{monster:f,materialInfos:y},console.log(f,y))}}}const wf=async(t,...e)=>{var y;const i=Os(t,...e).toArray(),a=i.map(v=>v.monster).getDistinct(),r=await t.activator.waitSelectEntity(a,"èžåˆå¬å–šã™ã‚‹ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã‚’é¸æŠžã€‚");if(!r)return!1;const n=r.fusionMaterialInfos.filter(Cp),s=i.filter(v=>v.monster===r).map(v=>v.materialInfos),l=s.map(v=>({infos:v,requiredSeqList:v.map(g=>g.material.seq)}));let o=s[0].map(v=>v.material);if(s.length>1||n.length){const v=s.flatMap(g=>g.map(m=>m.material)).getDistinct();o=await t.activator.waitSelectEntities(v,void 0,g=>l.some(m=>m.requiredSeqList.every(C=>g.map(x=>x.seq).includes(C))&&g.filter(C=>!m.requiredSeqList.includes(C.seq)).every(C=>n.some(x=>x.filter(C)))),"èžåˆç´ æã¨ã™ã‚‹ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã‚’é¸æŠž",!1)??o}const u=l.find(v=>v.requiredSeqList.every(g=>o.map(m=>m.seq).includes(g))&&o.filter(g=>!v.requiredSeqList.includes(g.seq)).every(g=>n.some(m=>m.filter(g))));if(!u)throw new S("æƒ³å®šã•ã‚Œãªã„çŠ¶æ…‹",t,o);const d=u.infos;d.push(...o.filter(v=>!u.requiredSeqList.includes(v.seq)).map(v=>({material:v,cell:v.cell})));const[,,,,f]=e,p={...Me.reduce((v,g)=>{const m={...v};return m[g]=g==="Graveyard"?{to:"Banished"}:{to:"Graveyard"},m},{}),...f.materialDestMapper},h=Object.groupBy(o,v=>v.cell.cellType);for(const v of Hn(h)){const g=p[v].to,m=p[v].position??mc[g],C=Sc[g];h[v]&&await _.bringManyToSameCellForTheSameReason(g,m,h[v],C,"Vertical",["FusionMaterial","Effect","SpecialSummonMaterial"],t.action.entity,t.activator)}return await t.activator.summon("FusionSummon",["Effect","SpecialSummon"],t.action,r,k,[...t.activator.getMonsterZones(),...t.activator.duel.field.getCells("ExtraMonsterZone")],d,!1),r.info.isRebornable=!((y=r.origin.monsterCategories)!=null&&y.includes("RegularSpecialSummonOnly")),d.map(v=>v.material).forEach(v=>v.onUsedAsMaterial(t,t.action.entity)),!0},vi=(t,e,i,a,r={})=>({fixedTags:["SpecialSummonFromExtraDeck"],canExecute:n=>Os(n,t,e,i,a,r).some(s=>s.materialInfos.length),prepare:T,execute:n=>wf(n,t,e,i,a,r),settle:async()=>!0});function*Ef(){for(const t of["å¿ƒçœ¼ã®å¥³ç¥ž","æ²¼åœ°ã®é­”ç£çŽ‹","ã‚¤ãƒªãƒ¥ãƒ¼ã‚¸ãƒ§ãƒ³ãƒ»ã‚·ãƒ¼ãƒ—","ç ´å£Šç¥ž ãƒ´ã‚¡ã‚µãƒ¼ã‚´"])yield{name:t,actions:[],continuousEffects:[wa]};yield{name:"æ²¼åœ°ã®é­”ç¥žçŽ‹",actions:[{title:"èžåˆã‚µãƒ¼ãƒ",isMandatory:!1,playType:"IgnitionEffect",spellSpeed:"Normal",executableCells:["Hand"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],fixedTags:["SearchFromDeck"],canPayCosts:_d,canExecute:t=>t.activator.getDeckCell().cardEntities.some(e=>e.nm==="èžåˆ")&&t.activator.canAddToHandFromDeck,getDests:t=>[t.activator.getGraveyard()],payCosts:Td,prepare:T,execute:async t=>{const e=t.activator.getDeckCell().cardEntities.filter(a=>a.nm==="èžåˆ");if(!e.length)return!1;const i=await t.activator.waitSelectEntity(e,"æ‰‹æœ­ã«åŠ ãˆã‚‹ã‚«ãƒ¼ãƒ‰ã‚’é¸æŠž",!1);return i?(await i.addToHand(["Effect"],t.action.entity,t.activator),t.activator.getDeckCell().shuffle(),!0):!1},settle:async()=>!0}],continuousEffects:[wa]},yield{name:"ãƒ‘ãƒ©ã‚µã‚¤ãƒˆãƒ»ãƒ•ãƒ¥ãƒ¼ã‚¸ãƒ§ãƒŠãƒ¼",actions:[{title:"èžåˆ",isMandatory:!1,playType:"TriggerEffect",spellSpeed:"Normal",executableCells:["MonsterZone"],executablePeriods:D,executableDuelistTypes:["Controller"],triggerPattern:{triggerType:"Arrival",arrivalReasons:["SpecialSummon"]},...vi(["ExtraDeck"],()=>!0,["MonsterZone","ExtraMonsterZone"],(t,e,i)=>i.includes(t.action.entity)),settle:async()=>!0}],summonFilter:(t,e,i,a,r,n,s,l,o,u)=>{const d={posList:o,cells:u},f={posList:[],cells:[]};if(!r.includes("FusionSummon"))return d;const p=l.find(h=>h.material===t.isSpawnedBy);return p?p.name&&p.name!==t.isSpawnedBy.nm?d:f:d},continuousEffects:[wa]}}const Ns=Object.freeze(Object.defineProperty({__proto__:null,default:Ef},Symbol.toStringTag,{value:"Module"}));function*bf(){yield{name:"é­”å°Žã‚µã‚¤ã‚¨ãƒ³ãƒ†ã‚£ã‚¹ãƒˆ",actions:[{title:"ç‰¹æ®Šå¬å–š",isMandatory:!1,playType:"IgnitionEffect",spellSpeed:"Normal",executableCells:["MonsterZone"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],executableFaces:["FaceUp"],fixedTags:["SpecialSummonFromExtraDeck"],canPayCosts:t=>t.activator.lp>=1e3,canExecute:t=>{const e=t.activator.getMonsterZones();return t.activator.getEnableSummonList(t.activator,"SpecialSummon",["Effect"],t.action,t.activator.getExtraDeck().cardEntities.filter(a=>{var r;return(r=a.status.monsterCategories)==null?void 0:r.includes("Fusion")}).filter(a=>a.lvl&&a.lvl<7).map(a=>({monster:a,posList:k,cells:e})),[],!1).length>0},payCosts:(t,e)=>Ut(t,e,1e3),prepare:T,execute:async t=>{const e=t.activator.getMonsterZones(),i=await t.activator.summonOne(t.activator,"SpecialSummon",["Effect"],t.action,t.activator.getExtraDeck().cardEntities.filter(a=>{var r;return(r=a.status.monsterCategories)==null?void 0:r.includes("Fusion")}).filter(a=>a.lvl&&a.lvl<7).map(a=>({monster:a,posList:k,cells:e})),[],!1,!1);return i?(i.procFilterBundle.push(He.createLingering("ç›´æŽ¥æ”»æ’ƒä¸å¯",()=>!0,t.action.entity,t.action,(a,r)=>r.face==="FaceUp"&&r.isOnFieldAsMonsterStrictly,["BattleTarget"],(a,r,n,s,l)=>a!==n?!0:l.every(o=>o.entityType!=="Duelist"))),i.counterHolder.setCurfewFlg(t.action.entity),!0):!1},settle:async()=>!0},{title:"è‡ªç™ºå¸°é‚„",isMandatory:!0,playType:"LingeringEffect",spellSpeed:"Normal",executableCells:Me,executablePeriods:["end"],executableDuelistTypes:$t,canExecute:t=>t.action.entity.field.getMonstersOnFieldStrictly().some(e=>e.counterHolder.getCurfewFlg(t.action.entity)),prepare:T,execute:async t=>{const e=t.action.entity.field.getMonstersOnFieldStrictly().filter(a=>a.counterHolder.getCurfewFlg(t.action.entity));if(!e.length)throw new S("æƒ³å®šã•ã‚Œãªã„çŠ¶æ…‹",t);let i=e[0];if(e.length>1){const a=await t.activator.waitSelectEntity(e,"å¸°é‚„ã•ã›ã‚‹ã‚«ãƒ¼ãƒ‰ã‚’é¸æŠžã€‚",!1);if(!a)throw new F(t);i=a}return await i.returnToDeck("Bottom",["Effect"],t.action.entity,t.activator),!0},settle:async()=>!0}]}}const Bs=Object.freeze(Object.defineProperty({__proto__:null,default:bf},Symbol.toStringTag,{value:"Module"}));function*kf(){for(const t of[{name:"ãƒžãƒ³ã‚¸ãƒ¥ãƒ»ã‚´ãƒƒãƒ‰",kinds:["Monster","Spell"]},{name:"ã‚»ãƒ³ã‚¸ãƒ¥ãƒ»ã‚´ãƒƒãƒ‰",kinds:["Monster"]},{name:"ã‚½ãƒ‹ãƒƒã‚¯ãƒãƒ¼ãƒ‰",kinds:["Spell"]}])yield{name:t.name,actions:[{title:"â‘ å„€å¼ã‚µãƒ¼ãƒ",isMandatory:!1,playType:"TriggerEffect",spellSpeed:"Normal",executableCells:["MonsterZone"],executablePeriods:D,executableDuelistTypes:["Controller"],fixedTags:["SearchFromDeck"],meetsConditions:e=>e.action.entity.hasBeenArrivalNow(["NormalSummon","FlipSummon"]),canExecute:e=>e.activator.canAddToHandFromDeck&&e.activator.getDeckCell().cardEntities.filter(i=>t.kinds.includes(i.kind)).some(i=>{var a;return i.status.spellCategory==="Ritual"||((a=i.status.monsterCategories)==null?void 0:a.includes("Ritual"))}),prepare:T,execute:async e=>{if(!e.activator.canAddToHandFromDeck)return!1;const i=e.activator.getDeckCell().cardEntities.filter(r=>t.kinds.includes(r.kind)).filter(r=>{var n;return r.status.spellCategory==="Ritual"||((n=r.status.monsterCategories)==null?void 0:n.includes("Ritual"))});if(!i.length)return!1;const a=await e.activator.waitSelectEntity(i,"æ‰‹æœ­ã«åŠ ãˆã‚‹ã‚«ãƒ¼ãƒ‰ã‚’é¸æŠž",!1);if(!a)throw new F(e,i);return await a.addToHand(["Effect"],e.action.entity,e.activator),e.activator.getDeckCell().shuffle(),!0},settle:async()=>!0}]}}const Ls=Object.freeze(Object.defineProperty({__proto__:null,default:kf},Symbol.toStringTag,{value:"Module"}));function*Df(){yield{name:"å„€å¼ã®æº–å‚™",actions:[{title:"ç™ºå‹•",isMandatory:!1,playType:"CardActivation",spellSpeed:"Normal",executableCells:["Hand","SpellAndTrapZone"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],fixedTags:["SearchFromDeck","ReturnToHandFromGraveyard"],canExecute:t=>t.activator.getDeckCell().cardEntities.filter(e=>{var i;return(i=e.status.monsterCategories)==null?void 0:i.includes("Ritual")}).some(e=>e.lvl&&e.lvl<8)&&t.activator.canAddToHandFromDeck,prepare:T,execute:async t=>{if(!t.activator.canAddToHandFromDeck)return!1;const e=t.activator.getDeckCell().cardEntities.filter(n=>{var s;return(s=n.status.monsterCategories)==null?void 0:s.includes("Ritual")}).filter(n=>n.lvl&&n.lvl<8);if(!e.length)return!1;const i=await t.activator.waitSelectEntity(e,"æ‰‹æœ­ã«åŠ ãˆã‚‹ã‚«ãƒ¼ãƒ‰ã‚’é¸æŠž",!1);if(!i)return!1;if(await i.addToHand(["Effect"],t.action.entity,t.activator),t.activator.getDeckCell().shuffle(),!t.activator.canAddToHandFromGraveyard)return!0;const a=t.activator.getGraveyard().cardEntities.filter(n=>n.status.spellCategory==="Ritual");if(a.length===1&&!await t.activator.waitYesNo("å„€å¼ã‚«ãƒ¼ãƒ‰ã‚’ã‚µãƒ«ãƒ™ãƒ¼ã‚¸ã™ã‚‹ï¼Ÿ"))return!0;const r=await t.activator.waitSelectEntity(a,"æ‰‹æœ­ã«åŠ ãˆã‚‹ã‚«ãƒ¼ãƒ‰ã‚’é¸æŠž",!0);return r&&(t.activator.duel.clock.incrementProcSeq(),await r.addToHand(["Effect"],t.action.entity,t.activator)),!0},settle:async()=>!0},b]},yield{name:"å„€å¼ã®ä¸‹æº–å‚™",actions:[{title:"ç™ºå‹•",isMandatory:!1,playType:"CardActivation",spellSpeed:"Normal",executableCells:["Hand","SpellAndTrapZone"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],isOnlyNTimesPerTurn:1,fixedTags:["SearchFromDeck","ReturnToHandFromGraveyard"],canExecute:t=>{if(!t.activator.canAddToHandFromDeck)return!1;const e=t.activator.getDeckCell().cardEntities.filter(a=>a.status.spellCategory==="Ritual").flatMap(a=>a.status.textTags??[]),i=["Deck"];return t.activator.canAddToHandFromGraveyard&&i.push("Graveyard"),t.activator.getCells(...i).flatMap(a=>a.cardEntities).filter(a=>{var r;return(r=a.status.monsterCategories)==null?void 0:r.includes("Ritual")}).some(a=>e.includes(a.nm))},prepare:T,execute:async t=>{if(!t.activator.canAddToHandFromDeck)return!1;let e=t.activator.getDeckCell().cardEntities.filter(l=>l.status.spellCategory==="Ritual").flatMap(l=>l.status.textTags??[]);if(!e.length)return!1;const i=["Deck"];if(t.activator.canAddToHandFromGraveyard&&i.push("Graveyard"),e=t.activator.getCells(...i).flatMap(l=>l.cardEntities).filter(l=>{var o;return(o=l.status.monsterCategories)==null?void 0:o.includes("Ritual")}).filter(l=>e.includes(l.nm)).map(l=>l.nm),!e.length)return!1;const a=t.activator.getDeckCell().cardEntities.filter(l=>l.status.spellCategory==="Ritual").filter(l=>l.status.textTags&&l.status.textTags.union(e).length);if(!a.length)return!1;const r=await t.activator.waitSelectEntity(a,"æ‰‹æœ­ã«åŠ ãˆã‚‹ã‚«ãƒ¼ãƒ‰ã‚’é¸æŠž",!1);if(!r)throw new F(t);const n=t.activator.getCells(...i).flatMap(l=>l.cardEntities).filter(l=>{var o;return(o=l.status.monsterCategories)==null?void 0:o.includes("Ritual")}).filter(l=>{var o;return(o=r.status.textTags)==null?void 0:o.includes(l.nm)});if(!n.length)throw console.error(r.status.textTags),new S("æƒ³å®šã•ã‚Œãªã„çŠ¶æ…‹",t,r,r.status.textTags);const s=await t.activator.waitSelectEntity(n,"æ‰‹æœ­ã«åŠ ãˆã‚‹ã‚«ãƒ¼ãƒ‰ã‚’é¸æŠž",!1);if(!s)throw new F(t,a);return await _.addManyToHand([r,s],["Effect"],t.action.entity,t.activator),t.activator.getDeckCell().shuffle(),!0},settle:async()=>!0},b]}}const qs=Object.freeze(Object.defineProperty({__proto__:null,default:Df},Symbol.toStringTag,{value:"Module"}));function*xf(){yield{name:"æŠ˜ã‚Œç«¹å…‰",actions:[Ft(),b]},yield{name:"å¦–åˆ€ç«¹å…‰",actions:[Ft(),b,{title:"â‘¡ç›´æŽ¥æ”»æ’ƒä»˜ä¸Ž",isMandatory:!1,playType:"IgnitionEffect",spellSpeed:"Normal",executableCells:["SpellAndTrapZone"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],executableFaces:["FaceUp"],isOnlyNTimesPerTurn:1,..._e(t=>t.activator.getSpellTrapsOnField().filter(e=>{var i;return(i=e.status.nameTags)==null?void 0:i.includes("ç«¹å…‰")}).filter(e=>e!==t.action.entity).filter(e=>e.status.spellCategory==="Equip"),{message:"æ‰‹æœ­ã«æˆ»ã™ã‚«ãƒ¼ãƒ‰ã‚’é¸æŠžã€‚",tags:["BounceToHand"]}),execute:async t=>{const e=t.action.entity.info.equipedBy;return e?(await _.returnManyToHandForTheSameReason(t.selectedEntities,["Effect"],t.action.entity,t.activator),e.statusOperatorBundle.push(new oe({title:"ç›´æŽ¥æ”»æ’ƒ",validateAlive:i=>i.duel.clock.isSameTurn(i.isSpawnedAt),isContinuous:!1,isSpawnedBy:t.action.entity,actionAttr:t.action,isApplicableTo:(i,a)=>a.isOnFieldAsMonsterStrictly&&a.face==="FaceUp",statusCalculator:()=>({canDirectAttack:!0})})),!0):!1},settle:async()=>!0},{title:"â‘¢ã‚µãƒ¼ãƒ",isMandatory:!1,playType:"TriggerEffect",spellSpeed:"Normal",executableCells:["Graveyard"],executablePeriods:[...D,...O],executableDuelistTypes:["Controller"],fixedTags:["SearchFromDeck"],meetsConditions:t=>t.action.entity.wasMovedAtPreviousChain&&t.action.entity.wasMovedFrom.cellType!=="Banished",canExecute:t=>t.activator.canAddToHandFromDeck&&t.activator.getDeckCell().cardEntities.filter(e=>{var i;return(i=e.status.nameTags)==null?void 0:i.includes("ç«¹å…‰")}).some(e=>e.status.name!=="å¦–åˆ€ç«¹å…‰"),prepare:T,execute:async t=>{const e=t.activator.getDeckCell().cardEntities.filter(a=>{var r;return(r=a.status.nameTags)==null?void 0:r.includes("ç«¹å…‰")}).filter(a=>a.status.name!=="å¦–åˆ€ç«¹å…‰");if(!e.length)return!1;const i=await t.activator.waitSelectEntity(e,"æ‰‹æœ­ã«åŠ ãˆã‚‹ã‚«ãƒ¼ãƒ‰ã‚’é¸æŠžã€‚",!1);if(!i)throw new F(t);return await i.addToHand(["Effect"],t.action.entity,t.activator),t.activator.getDeckCell().shuffle(),!0},settle:async()=>!0}]},yield{name:"çœŸåˆ€ç«¹å…‰",actions:[Ft(),b,{title:"â‘¡ç›¸æ‰‹ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ç ´å£Š",isMandatory:!1,playType:"TriggerEffect",spellSpeed:"Normal",executableCells:["SpellAndTrapZone"],executablePeriods:["b1DAfterDmgCalc","b2DAfterDmgCalc"],executableDuelistTypes:["Controller"],canExecute:t=>{const e=t.action.entity.info.equipedBy;return!(!e||!e.info.battleLog.filter(i=>t.activator.duel.clock.isPreviousStage(i.timestamp)).some(i=>i.enemy.entityType==="Duelist")||!t.activator.getOpponentPlayer().getMonstersOnField().length||!t.activator.getOpponentPlayer().lifeLog.filter(i=>t.activator.duel.clock.isPreviousStage(i.clock)).some(i=>i.entity===e))},prepare:async t=>({selectedEntities:[],chainBlockTags:t.action.calcChainBlockTagsForDestroy(t.activator,t.activator.getOpponentPlayer().getMonstersOnField()),prepared:void 0}),execute:async t=>(await _.tryDestroy(t.activator.getOpponentPlayer().getMonstersOnField(),t)).length>0,settle:async()=>!0},{title:"â‘¢ç«¹å…‰å…¥æ›¿",isMandatory:!1,playType:"IgnitionEffect",spellSpeed:"Normal",executableCells:["SpellAndTrapZone"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],executableFaces:["FaceUp"],canPayCosts:t=>t.action.entity.info.equipedBy?yd(t):!1,canExecute:t=>!!(t.action.entity.info.equipedBy&&t.activator.getDeckCell().cardEntities.filter(e=>{var i;return(i=e.status.nameTags)==null?void 0:i.includes("ç«¹å…‰")}).filter(e=>e.status.name!=="çœŸåˆ€ç«¹å…‰").some(e=>e.status.spellCategory==="Equip"))&&t.activator.duel.field.getMonstersOnFieldStrictly().some(e=>e.canBeTargetOfEffect(t)),payCosts:vd,prepare:T,execute:async t=>{const e=t.activator.getDeckCell().cardEntities.filter(l=>{var o;return(o=l.status.nameTags)==null?void 0:o.includes("ç«¹å…‰")}).filter(l=>l.status.name!=="çœŸåˆ€ç«¹å…‰").filter(l=>l.status.spellCategory==="Equip");if(!e.length)return!1;const i=t.activator.getAvailableSpellTrapZones();if(!i.length)return!1;const a=t.activator.duel.field.getMonstersOnFieldStrictly().filter(l=>l.canBeTargetOfEffect(t));if(!a.length)return!1;const r=await t.activator.waitSelectEntity(e,"è£…å‚™ã™ã‚‹ã‚«ãƒ¼ãƒ‰ã‚’é¸æŠžã€‚",!1);if(!r)throw new F("ç«¹å…‰é¸æŠž",t);const n=await t.activator.duel.view.waitSelectDestination(t.activator,r,i,"è£…å‚™ã‚«ãƒ¼ãƒ‰ã‚’ç½®ãå ´æ‰€ã‚’é¸æŠžã€‚","è£…å‚™",!1);if(!n)throw new F("é…ç½®å ´æ‰€é¸æŠž",t);await r.putDirectly(n,"Spell",["Effect"],t.action.entity,t.activator),t.activator.getDeckCell().shuffle();const s=await t.activator.waitSelectEntity(a,"è£…å‚™ã™ã‚‹å¯¾è±¡ã‚’é¸æŠžã€‚",!1);if(!s)throw new F("è£…å‚™å¯¾è±¡é¸æŠž",t);return r.info.equipedBy=s,r.info.effectTargets[t.action.seq]=[s],s.info.equipEntities.push(r),!0},settle:async()=>!0}]}}const Rs=Object.freeze(Object.defineProperty({__proto__:null,default:xf},Symbol.toStringTag,{value:"Module"}));function*Af(){yield{name:"é»„é‡‘è‰²ã®ç«¹å…‰",actions:[{title:"ç™ºå‹•",isMandatory:!1,playType:"CardActivation",spellSpeed:"Normal",executableCells:["Hand","SpellAndTrapZone"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],priorityForNPC:20,fixedTags:["Draw"],meetsConditions:t=>t.activator.getSpellTrapsOnField().filter(e=>{var i;return(i=e.status.nameTags)==null?void 0:i.includes("ç«¹å…‰")}).filter(e=>e.face==="FaceUp").some(e=>e.status.spellCategory==="Equip"),canExecute:t=>t.activator.getDeckCell().cardEntities.length>0&&t.activator.canDraw,prepare:T,execute:async t=>(await t.activator.draw(2,t.action.entity,t.activator),!0),settle:async()=>!0},b]}}const Hs=Object.freeze(Object.defineProperty({__proto__:null,default:Af},Symbol.toStringTag,{value:"Module"}));function*Pf(){yield{name:"ï¼¢ï¼¦ï¼ç–¾é¢¨ã®ã‚²ã‚¤ãƒ«",actions:[{title:"â‘ ç‰¹æ®Šå¬å–š",isMandatory:!1,playType:"SpecialSummon",spellSpeed:"Normal",executableCells:["Hand"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],canExecute:t=>t.activator.getMonstersOnField().filter(e=>(e.status.nameTags??[]).includes("ï¼¢ï¼¦")).some(e=>e.nm!==t.action.entity.origin.name)&&fe(t,k,[],["Rule"]),getDests:t=>Ot(t,k,[],["Rule"]),prepare:t=>ot(t,"SpecialSummon",["SpecialSummon","Rule"],k),execute:ct,settle:async()=>!0},{title:"â‘¡æ”»å®ˆåŠæ¸›",isMandatory:!1,playType:"IgnitionEffect",spellSpeed:"Normal",executableCells:["MonsterZone"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],executableFaces:["FaceUp"],isOnlyNTimesPerTurnIfFaceup:1,..._e(t=>t.activator.getOpponentPlayer().getMonstersOnField().filter(e=>e.face==="FaceUp").filter(e=>e.canBeTargetOfEffect(t)),{message:"å¯¾è±¡ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã‚’é¸æŠžã€‚"}),execute:async t=>{const e=t.selectedEntities.filter(i=>i.isOnFieldAsMonsterStrictly).filter(i=>i.face==="FaceUp").find(i=>i.canBeEffected(t.activator,t.action.entity,t.action));return e?(["attack","defense"].map(i=>ne.createLingeringFixation("â‘¡æ”»å®ˆåŠæ¸›",()=>!0,t.action.entity,t.action,i,(a,r,n)=>Math.round(n/2))).forEach(i=>e.numericOprsBundle.push(i)),!0):!1},settle:async()=>!0}]}}const Zs=Object.freeze(Object.defineProperty({__proto__:null,default:Pf},Symbol.toStringTag,{value:"Module"}));function*Mf(){yield{name:"æ°´æ™¶æ©Ÿå·§ï¼ãƒãƒªãƒ•ã‚¡ã‚¤ãƒãƒ¼",actions:[yi(t=>t.length===2&&t.some(e=>{var i;return(i=e.status.monsterCategories)==null?void 0:i.includes("Tuner")})),{title:"â‘ ãƒªã‚¯ãƒ«ãƒ¼ãƒˆ",isMandatory:!1,playType:"TriggerEffect",spellSpeed:"Normal",executableCells:H,executablePeriods:[...D,...O],executableDuelistTypes:["Controller"],fixedTags:["SpecialSummonFromDeck"],meetsConditions:t=>t.action.entity.hasBeenArrivalNow(["LinkSummon"]),canExecute:t=>{const e=[t.activator.getHandCell(),t.activator.getDeckCell()].flatMap(r=>r.cardEntities).filter(r=>(r.lvl??12)<4).filter(r=>{var n;return(n=r.status.monsterCategories)==null?void 0:n.includes("Tuner")}),i=t.activator.getMonsterZones();return t.activator.getEnableSummonList(t.activator,"SpecialSummon",["Effect"],t.action,e.map(r=>({monster:r,cells:i,posList:["Defense"]})),[],!1).length>0},prepare:T,execute:async t=>{const e=[t.activator.getHandCell(),t.activator.getDeckCell()].flatMap(r=>r.cardEntities).filter(r=>(r.lvl??12)<4).filter(r=>{var n;return(n=r.status.monsterCategories)==null?void 0:n.includes("Tuner")}),i=t.activator.getMonsterZones(),a=await t.activator.summonOne(t.activator,"SpecialSummon",["Effect"],t.action,e.map(r=>({monster:r,cells:i,posList:["Defense"]})),[],!1,!1);if(!a)throw new F(t);return a.statusOperatorBundle.push(new oe({title:"åŠ¹æžœç™ºå‹•ä¸å¯",validateAlive:r=>r.duel.clock.isSameTurn(r.isSpawnedAt),isContinuous:!1,isSpawnedBy:t.action.entity,actionAttr:t.action,isApplicableTo:(r,n)=>r.duel.clock.isSameTurn(r.isSpawnedAt)&&n.isOnFieldAsMonsterStrictly&&n.face==="FaceUp",statusCalculator:()=>({canActivateEffect:!1})})),!0},settle:async()=>!0},{title:"â‘¡ã‚·ãƒ³ã‚¯ãƒ­å¬å–š",isMandatory:!1,playType:"QuickEffect",spellSpeed:"Quick",executableCells:H,executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],isOnlyNTimesPerChain:1,canPayCosts:Bt,meetsConditions:t=>!t.activator.isTurnPlayer,canExecute:t=>{const e=[...t.activator.getMonsterZones(),...t.activator.duel.field.getCells("ExtraMonsterZone")],i=t.activator.getExtraDeck().cardEntities.filter(r=>{var n;return(n=r.status.monsterCategories)==null?void 0:n.includes("Synchro")}).filter(r=>{var n;return(n=r.status.monsterCategories)==null?void 0:n.includes("Tuner")});return t.activator.getEnableSummonList(t.activator,"SynchroSummon",["SpecialSummon","Effect"],t.action,i.map(r=>({monster:r,cells:e,posList:k})),[{material:t.action.entity,cell:t.action.entity.cell}],!1).length>0},payCosts:hi,prepare:T,execute:async t=>{const e=[...t.activator.getMonsterZones(),...t.activator.duel.field.getCells("ExtraMonsterZone")],i=t.activator.getExtraDeck().cardEntities.filter(r=>{var n;return(n=r.status.monsterCategories)==null?void 0:n.includes("Synchro")}).filter(r=>{var n;return(n=r.status.monsterCategories)==null?void 0:n.includes("Tuner")});return!!await t.activator.summonOne(t.activator,"SynchroSummon",["SpecialSummon","Effect"],t.action,i.map(r=>({monster:r,cells:e,posList:k})),[],!1,!1)},settle:async()=>!0}]}}const Gs=Object.freeze(Object.defineProperty({__proto__:null,default:Mf},Symbol.toStringTag,{value:"Module"}));function*Ff(){yield{name:"ï¼¤ï¼ï¼¨ï¼¥ï¼²ï¼¯ ãƒ‡ã‚£ã‚¢ãƒœãƒªãƒƒã‚¯ã‚¬ã‚¤",actions:[{title:"â‘ ãƒªã‚¯ãƒ«ãƒ¼ãƒˆ",isMandatory:!1,playType:"IgnitionEffect",spellSpeed:"Normal",executableCells:["Graveyard"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],executableFaces:["FaceUp"],fixedTags:["SpecialSummonFromDeck"],priorityForNPC:10,canPayCosts:Bt,canExecute:t=>{const e=t.activator.getDeckCell().cardEntities.find(r=>r.nm==="ï¼¤ï¼ï¼¨ï¼¥ï¼²ï¼¯ ãƒ‡ã‚£ã‚¢ãƒœãƒªãƒƒã‚¯ã‚¬ã‚¤");if(!e)return!1;const i=t.activator.getMonsterZones();return t.activator.getEnableSummonList(t.activator,"SpecialSummon",["Effect"],t.action,[{monster:e,posList:k,cells:i}],[],!1).length>0},payCosts:hi,prepare:T,execute:async t=>{const e=t.activator.getDeckCell().cardEntities.find(i=>i.nm==="ï¼¤ï¼ï¼¨ï¼¥ï¼²ï¼¯ ãƒ‡ã‚£ã‚¢ãƒœãƒªãƒƒã‚¯ã‚¬ã‚¤");return e?es(t,[e]):!1},settle:async()=>!0}]},yield{name:"ï¼¤ï¼ï¼¨ï¼¥ï¼²ï¼¯ ãƒ€ã‚¤ãƒ¤ãƒ¢ãƒ³ãƒ‰ã‚¬ã‚¤",actions:[{title:"é­”æ³•åŠ¹æžœäºˆç´„",isMandatory:!1,playType:"IgnitionEffect",spellSpeed:"Normal",executableCells:["MonsterZone"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],executableFaces:["FaceUp"],isOnlyNTimesPerTurnIfFaceup:1,canExecute:t=>t.action.entity.face==="FaceUp"&&t.activator.getDeckCell().cardEntities.length>0,prepare:T,execute:async t=>{const e=await _.excavateFromDeck(t.activator,["Effect"],t.action.entity,t.activator);if(!e)return!1;if(e.kind!=="Spell"||e.status.spellCategory!=="Normal")return t.activator.duel.view.requireUpdate(),await Gi(500),t.activator.writeInfoLog(`${e.toString()}ã¯é€šå¸¸é­”æ³•ã§ã¯ãªã„ãŸã‚ã€ãƒ‡ãƒƒã‚­ãƒœãƒˆãƒ ã«æˆ»ã£ãŸã€‚`),await e.returnToDeck("Bottom",["Effect"],t.action.entity,t.activator),!1;await e.sendToGraveyard(["Effect"],t.action.entity,t.activator);const i=e.actions.filter(n=>n.playType==="CardActivation").find(n=>!n.needsToPayRegularCosts);if(!i)return t.activator.writeInfoLog(`${e.toString()}ã¯${t.action.entity.toString()}ã®åŠ¹æžœã§ã¯ç™ºå‹•ã§ããªã„ã€‚`),!0;const a=t.activator.duel.clock.getClone(),r={...i.definition};return r.title+=`(${t.action.entity.toString()})`,r.playType="IgnitionEffect",r.canExecute=(n,s)=>n.activator.duel.clock.turn>a.turn+2||n.action.entity.wasMovedAfter(a)?"RemoveMe":n.activator.duel.clock.turn<a.turn+2?!1:!i.definition.canExecute||i.definition.canExecute(n,s),r.executableCells=["Graveyard"],r.meetsConditions=void 0,r.canPayCosts=void 0,r.payCosts=void 0,r.settle=async()=>!0,r.isOnlyNTimesPerTurn=1,e.actions.push(St.createNew(e,r)),!0},settle:async()=>!0}]}}const $s=Object.freeze(Object.defineProperty({__proto__:null,default:Ff},Symbol.toStringTag,{value:"Module"}));function*Of(){yield{name:"ï¼¥ãƒ»ï¼¨ï¼¥ï¼²ï¼¯ ãƒ—ãƒªã‚ºãƒžãƒ¼",actions:[{title:"ãƒªãƒ•ãƒ¬ã‚¯ãƒˆãƒ»ãƒã‚§ãƒ³ã‚¸",isMandatory:!1,playType:"IgnitionEffect",spellSpeed:"Normal",executableCells:["MonsterZone"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],executableFaces:["FaceUp"],isOnlyNTimesPerTurnIfFaceup:1,needsToPayRegularCost:!0,canPayCosts:t=>{const e=t.activator.getExtraDeck().cardEntities.flatMap(i=>i.fusionMaterialInfos).filter(nt).map(i=>i.cardName).getDistinct();return t.activator.getDeckCell().cardEntities.filter(i=>e.includes(i.nm)).some(i=>i.canBeSentToGraveyard(t.activator,t.action.entity,"SendToGraveyardAsCost",t.action))},canExecute:t=>t.action.entity.face==="FaceUp",payCosts:async(t,e,i)=>{const a=t.activator.getExtraDeck().cardEntities.flatMap(o=>o.fusionMaterialInfos).filter(nt).map(o=>o.cardName).getDistinct(),r=t.activator.getDeckCell().cardEntities.filter(o=>a.includes(o.nm)).filter(o=>o.canBeSentToGraveyard(t.activator,t.action.entity,"SendToGraveyardAsCost",t.action));if(r.length===0)throw new S("æƒ³å®šã•ã‚Œãªã„çŠ¶æ…‹",t);const n=await t.activator.waitSelectEntity(r,"å¢“åœ°ã«é€ã‚‹ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã‚’é¸æŠž",i);if(!n){if(!i)throw new F(t);return}const s=t.activator.getExtraDeck().cardEntities.filter(o=>o.fusionMaterialInfos.filter(nt).some(u=>u.cardName===n.nm)),l=await t.activator.waitSelectEntity(s,"å…¬é–‹ã™ã‚‹ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã‚’é¸æŠž",i);if(!l)throw new S("æƒ³å®šã•ã‚Œãªã„çŠ¶æ…‹",t);return t.activator.writeInfoLog(`å…¬é–‹ï¼š${l.toString()}`),await n.sendToGraveyard(["Effect"],t.action.entity,t.activator),t.activator.getDeckCell().shuffle(),{sendToGraveyard:[n]}},prepare:T,execute:async t=>{const e=t.costInfo.sendToGraveyard;if(!e||!e.length)throw new S("ã‚³ã‚¹ãƒˆæƒ…å ±ãŒå–å¾—ã§ããªã„",t);const i=e[0];return t.action.entity.statusOperatorBundle.push(new oe({title:t.action.title,validateAlive:a=>a.duel.clock.isSameTurn(a.isSpawnedAt),isContinuous:!1,isSpawnedBy:t.action.entity,actionAttr:t.action,isApplicableTo:(a,r)=>r.isOnFieldAsMonsterStrictly&&r.face==="FaceUp",statusCalculator:()=>({name:i.origin.name})})),!0},settle:async()=>!0}]}}const Us=Object.freeze(Object.defineProperty({__proto__:null,default:Of},Symbol.toStringTag,{value:"Module"})),Ua=(t,e)=>{const i=e?`é­”åŠ›å……å¡«å¯èƒ½(${e})`:"é­”åŠ›å……å¡«å¯èƒ½";return ni(i,t,a=>[a],a=>[new oe({title:i,validateAlive:()=>!0,isContinuous:!0,isSpawnedBy:a,actionAttr:{},isApplicableTo:(r,n)=>r.isSpawnedBy===n,statusCalculator:(r,n,s)=>(s.maxCounterQty.SpellCounter=e??Number.MAX_VALUE,{maxCounterQty:s.maxCounterQty})})])},Ea={},Nf=(t,e=1)=>(Ea[e]||(Ea[e]={title:`é­”åŠ›å›žåŽ(${e})`,isMandatory:!0,playType:"AfterChainBlock",spellSpeed:"Normal",executableCells:["MonsterZone"],executablePeriods:le,executableDuelistTypes:["Controller"],canExecute:i=>!!(i.targetChainBlock&&i.targetChainBlock.action.playType==="CardActivation"&&i.targetChainBlock.action.entity.kind==="Spell"&&i.action.entity.isEffective&&i.action.entity.face==="FaceUp"&&i.action.entity.counterHolder.getQty("SpellCounter")<(i.action.entity.status.maxCounterQty.SpellCounter??0)&&i.action.entity.hadArrivedToFieldAt().totalProcSeq<=i.targetChainBlock.isActivatedAt.totalProcSeq),prepare:T,execute:async i=>i.action.entity.face==="FaceDown"||!i.action.entity.isOnFieldAsMonsterStrictly||!i.action.entity.isEffective?!1:(i.action.entity.counterHolder.add("SpellCounter",e,i.action.entity),!0),settle:async()=>!0}),{...Ea[e],title:`${t}é­”åŠ›å›žåŽ(${e})`}),Bf=(t,e,i)=>t.action.entity.counterHolder.getQty("SpellCounter")>=i,Lf=async(t,e,i,a)=>{const r=a.filter(s=>s<=t.action.entity.counterHolder.getQty("SpellCounter"));let n=r[0];if(!(r.length>1&&(n=await t.activator.waitSelectNumber("å–ã‚Šé™¤ãé­”åŠ›ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼ã®å€‹æ•°ã‚’é¸æŠžã€‚",r,i)??0,!n)))return t.action.entity.counterHolder.remove("SpellCounter",n),{counter:n}},ja=t=>({canPayCosts:(...e)=>Bf(...e,t.min()??0),payCosts:(...e)=>Lf(...e,t)});function*qf(){yield{name:"ç¥žè–é­”çš‡åŽã‚»ãƒ¬ãƒ¼ãƒ",actions:[yi(t=>t.flatMap(e=>e.types).includes("Spellcaster")&&t.length>1),{title:"â‘ é­”åŠ›å……å¡«",isMandatory:!0,playType:"TriggerEffect",spellSpeed:"Normal",executableCells:H,executablePeriods:[...D,...O],executableDuelistTypes:["Controller"],executableFaces:["FaceUp"],triggerPattern:{triggerType:"Arrival",arrivalReasons:["LinkSummon"]},fixedTags:["IfLinkSummonSucceed"],prepare:T,execute:async t=>{if(!t.action.entity.isOnFieldAsMonsterStrictly)return!1;const e=[...t.action.entity.field.getCardsOnFieldStrictly(),...t.action.entity.field.getCells("Graveyard").flatMap(i=>i.cardEntities)].filter(i=>i.face==="FaceUp").filter(i=>i.kind==="Spell").length;return t.action.entity.counterHolder.setQty("SpellCounter",e,t.action.entity),!0},settle:async()=>!0},{title:"â‘¢è˜‡ç”Ÿ",isMandatory:!0,playType:"QuickEffect",spellSpeed:"Quick",executableCells:H,executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],fixedTags:["SpecialSummon"],isOnlyNTimesIfFaceup:1,...ja([3]),canExecute:t=>{const e=t.activator.getCells("Graveyard","Hand").flatMap(r=>r.cardEntities).filter(r=>r.types.includes("Spellcaster")),i=t.action.entity.linkArrowDests;return t.activator.getEnableSummonList(t.activator,"SpecialSummon",["Effect"],t.action,e.map(r=>({monster:r,posList:["Defense"],cells:i})),[],!1).length>0},prepare:T,execute:async t=>{const e=t.activator.getCells("Graveyard","Hand").flatMap(r=>r.cardEntities).filter(r=>r.types.includes("Spellcaster")),i=t.action.entity.linkArrowDests;return!!await t.activator.summonOne(t.activator,"SpecialSummon",["Effect"],t.action,e.map(r=>({monster:r,posList:["Defense"],cells:i})),[],!1,!1)},settle:async()=>!0}],continuousEffects:[Ua("Monster"),da("â‘¡æ”»æ’ƒå¯¾è±¡è€æ€§","Monster",t=>[t],t=>[He.createContinuous("â‘¡æ”»æ’ƒå¯¾è±¡è€æ€§",()=>!0,t,()=>!0,["BattleTarget"],(e,i)=>e.controller===i?!0:e.controller.getEntiteisOnField().every(a=>{var r;return!((r=a.status.nameTags)!=null&&r.includes("ã‚¨ãƒ³ãƒ‡ã‚£ãƒŸã‚ªãƒ³"))}))])]}}const js=Object.freeze(Object.defineProperty({__proto__:null,default:qf},Symbol.toStringTag,{value:"Module"}));function*Rf(){yield{name:"å°å°ã•ã‚Œã—ã‚¨ã‚¯ã‚¾ãƒ‡ã‚£ã‚¢",actions:[{title:"å°å°é–‹æ”¾",isMandatory:!0,playType:"Exodia",spellSpeed:"Normal",executableCells:["Hand"],executablePeriods:le,executableDuelistTypes:["Controller"],canExecute:t=>t.activator.getHandCell().cardEntities.filter(i=>{var a;return(a=i.origin.nameTags)==null?void 0:a.includes("å°å°ã•ã‚Œã—")}).map(i=>i.origin.name).getDistinct().length===5,prepare:async t=>(await _.sendManyToGraveyardForTheSameReason(t.activator.duel.field.getCardsOnFieldStrictly(),["Rule"],t.action.entity,t.activator),{selectedEntities:[],chainBlockTags:[],nextChainBlockFilter:()=>!1}),execute:async t=>{const e=t.activator.getOpponentPlayer().getHandCell().cardEntities.filter(a=>{var r;return(r=a.origin.nameTags)==null?void 0:r.includes("å°å°ã•ã‚Œã—")}).map(a=>a.origin.name).getDistinct().length===5,i=[{name:"å°å°ã•ã‚Œã—è€…ã®å·¦è¶³",column:4},{name:"å°å°ã•ã‚Œã—è€…ã®å³è¶³",column:2},{name:"å°å°ã•ã‚Œã—è€…ã®å·¦è…•",column:5},{name:"å°å°ã•ã‚Œã—è€…ã®å³è…•",column:1},{name:"å°å°ã•ã‚Œã—ã‚¨ã‚¯ã‚¾ãƒ‡ã‚£ã‚¢",column:3}];for(const a of i){const r=[t.activator.getHandCell().cardEntities.find(n=>n.origin.name===a.name),t.activator.getOpponentPlayer().getHandCell().cardEntities.find(n=>n.origin.name===a.name)].filter(n=>n!==void 0);if(!r.length)throw new S("æƒ³å®šã•ã‚Œãªã„çŠ¶æ…‹",t.activator.getHandCell().cardEntities,a.name);await Z.moveMany(r.map(n=>({entity:n,to:n.controller.getMonsterZones().find(s=>s.column===(n.controller.seat==="Above"?6-a.column:a.column))??n.controller.getFieldZone(),kind:"Monster",face:"FaceUp",orientation:"Vertical",pos:"Top",movedAs:["Rule"],movedBy:void 0,actionOwner:void 0,chooser:void 0})))}throw e?new re(void 0,`ãŠäº’ã„ãŒã€${t.action.entity.toString()}ã®ç‰¹æ®Šå‹åˆ©æ¡ä»¶ã‚’åŒæ™‚ã«æº€ãŸã—ãŸã€‚`):new re(t.activator,`${t.activator.name}ãŒ${t.action.entity.toString()}ã®ç‰¹æ®Šå‹åˆ©æ¡ä»¶ã‚’æº€ãŸã—ãŸã€‚`)},settle:async()=>!0}]}}const zs=Object.freeze(Object.defineProperty({__proto__:null,default:Rf},Symbol.toStringTag,{value:"Module"}));function*Hf(){{const t=i=>{const a="selectedEntities"in i?i.selectedEntities:i.action.entity.field.getCells("Graveyard").flatMap(n=>n.cardEntities).filter(n=>n.isMonster).filter(n=>n.canBeTargetOfEffect(i));if(a.length<2)return;let r=[i.activator,i.activator.getOpponentPlayer()].map(n=>i.activator.getEnableSummonList(i.activator,"SpecialSummon",["Effect"],i.action,a.map(s=>({monster:s,cells:n.getMonsterZones(),posList:k})),[],!1));if(!r.some(n=>!n.length)){if(r.every(n=>n.length===1)){if(r.flat().map(n=>n.monster.seq).getDistinct().length===1)return}else if(r.some(n=>n.length===1)){const n=r.filter(s=>s.length===1).flat().map(s=>s.monster);r=r.map(s=>s.length<2?s:s.filter(l=>!n.includes(l.monster)))}return r}},e=i=>i.activator.duel.field.getCells(...H).filter(a=>a.row===3||a.column===3).filter(a=>a.cardEntities.length).map(a=>a.cardEntities[0]).filter(a=>a.canBeReleased(i.activator,i.action.entity,["ReleaseAsCost"],i.action));yield{name:"çœŸç‚Žç«œã‚¢ãƒ«ãƒ“ã‚ªãƒ³",fusionMaterialInfos:[{type:"Name",cardName:"ã‚¢ãƒ«ãƒã‚¹ã®è½èƒ¤"},{type:"Filter",filter:i=>i.attr.includes("Light")&&i.types.includes("Spellcaster")}],actions:[{title:"â‘¡è˜‡ç”Ÿ",isMandatory:!1,playType:"QuickEffect",spellSpeed:"Quick",executableCells:Se,executablePeriods:D,executableDuelistTypes:["Controller"],executableFaces:["FaceUp"],fixedTags:["SpecialSummonFromGraveyard"],isOnlyNTimesPerTurn:1,canExecute:i=>!i.activator.isTurnPlayer&&!!t(i),prepare:async(i,a,r)=>{const n=t(i);if(!n)throw new S("æƒ³å®šã•ã‚Œãªã„çŠ¶æ…‹");return{selectedEntities:await i.activator.waitSelectEntities(n.flat().map(l=>l.monster).getDistinct(),2,l=>l.length==2&&n.every(o=>o.map(u=>u.monster).some(u=>l.includes(u))),"è˜‡ç”Ÿã™ã‚‹ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã‚’é¸æŠžã€‚",r)}},execute:async i=>{if(i.selectedEntities.some(r=>r.wasMovedAfter(i.isActivatedAt)))return!1;const a=t(i);return a?(await i.activator.summonEachFields(i.activator,"SpecialSummon",["Effect"],i.action,a.flat(),[],!1,1,r=>r.length===1,!1),!0):!1},settle:async()=>!0},{title:"â‘¢è‡ªå·±å†ç”Ÿ",isMandatory:!1,playType:"IgnitionEffect",spellSpeed:"Normal",executableCells:["Graveyard"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],executableFaces:["FaceUp"],fixedTags:["SpecialSummonFromGraveyard"],isOnlyNTimesPerTurn:1,canPayCosts:i=>e(i).length===4,canExecute:i=>fe(i,k,e(i).map(a=>({material:a,cell:a.cell,isAsEffectCost:!0})),["Effect"]),payCosts:async i=>{const a=e(i);return await _.releaseManyForTheSameReason(a,["Release","Cost"],i.action.entity,i.activator),{release:a}},prepare:T,execute:Pe,settle:async()=>!0}],continuousEffects:[da("â‘ å¯¾è±¡è€æ€§","Monster",i=>[i],i=>[He.createContinuous("â‘ å¯¾è±¡è€æ€§",()=>!0,i,()=>!0,["EffectTarget"],(a,r)=>a.controller===r)])],summonFilter:(...i)=>{const[a,,,,r,,,n]=i,s={posList:[],cells:[]};return r.includes("FusionSummon")?n.some(l=>l.material===a.isSpawnedBy)?s:$a(...i):$a(...i)}}}}const Vs=Object.freeze(Object.defineProperty({__proto__:null,default:Hf},Symbol.toStringTag,{value:"Module"}));function*Zf(){{yield{name:"ã‚¢ãƒ«ãƒã‚¹ã®è½èƒ¤",actions:[{title:"èžåˆ",isMandatory:!1,playType:"TriggerEffect",spellSpeed:"Normal",executableCells:["MonsterZone"],executablePeriods:D,executableDuelistTypes:["Controller"],triggerPattern:{triggerType:"Arrival",arrivalReasons:["NormalSummon","SpecialSummon"]},canPayCosts:jt,payCosts:zt,...vi(["ExtraDeck"],()=>!0,["MonsterZone"],(t,e,i)=>i.includes(t.action.entity)&&i.every(a=>a===t.action.entity||a.controller!==t.activator),{requisitionFrom:H}),settle:async()=>!0}]};{const t=e=>{const i=[];return fe(e,k,[],["Effect"])&&i.push("Hand"),(e.activator.canDraw||e.action.entity.cell.cellType==="Graveyard")&&i.push("Deck"),e.activator.getCells(...i).flatMap(a=>a.cardEntities).filter(a=>{var r;return a.nm==="ã‚¢ãƒ«ãƒã‚¹ã®è½èƒ¤"||((r=a.status.nameTags)==null?void 0:r.includes("çƒ™å°"))&&a.kind!=="Monster"}).filter(a=>a.canBeSentToGraveyard(e.activator,e.action.entity,"SendToGraveyardAsCost",e.action))};yield{name:"é»’è¡£ç«œã‚¢ãƒ«ãƒ“ã‚ªãƒ³",actions:[{title:"â‘¡è‡ªå·±ç‰¹æ®Šå¬å–šorè‡ªå·±ãƒ‡ãƒƒã‚­ãƒã‚¦ãƒ³ã‚¹",isMandatory:!1,playType:"IgnitionEffect",spellSpeed:"Normal",executableCells:["Hand","Graveyard"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],isOnlyNTimesPerTurn:1,needsToPayRegularCost:!0,canPayCosts:e=>t(e).length>0,payCosts:async(e,i,a)=>{const r=await e.activator.waitSelectEntity(t(e),"å¢“åœ°ã«é€ã‚‹ã‚«ãƒ¼ãƒ‰ã‚’é¸æŠžã€‚",a);if(r)return e.data=r.cell.cellType,await r.sendToGraveyard(["Cost"],e.action.entity,e.activator),{sendToGraveyard:[r]}},prepare:async e=>{const i=[];return e.data==="Hand"?(i.push("SpecialSummon"),e.action.entity.cell.cellType==="Graveyard"&&i.push("SpecialSummonFromGraveyard")):e.data==="Deck"&&e.action.entity.cell.cellType==="Hand"&&i.push("Draw"),{chainBlockTags:i}},execute:async e=>{if(e.action.entity.wasMovedAfter(e.isActivatedAt))return!1;if(e.data==="Hand")return!!await e.activator.summon("SpecialSummon",["Effect"],e.action,e.action.entity,k,e.activator.getMonsterZones(),[],!1);if(e.data==="Deck"){const i=e.action.entity.cell.cellType==="Hand";return await e.action.entity.returnToDeck("Bottom",["Effect"],e.action.entity,e.activator),i&&await e.activator.draw(1,e.action.entity,e.activator),!0}throw new S(`${e.action.entity}ã®åŠ¹æžœã‚’ä¸æ­£ãªæ–¹æ³•ã§å®Ÿè¡Œã—ã‚ˆã†ã¨ã—ãŸã€‚${e.data}`)},settle:async()=>!0}],continuousEffects:[{title:"â‘ åç§°å¤‰æ›´",appliableCellTypes:["MonsterZone","Graveyard"],appliableDuelPeriodKeys:le,faceList:sr,canStart:e=>e.isEffective&&!e.info.isPending&&!e.info.isDying,start:async e=>{const i=[new oe({title:"â‘ åç§°å¤‰æ›´",validateAlive:()=>!0,isContinuous:!1,isSpawnedBy:e,actionAttr:{},isApplicableTo:()=>!0,statusCalculator:()=>({name:"ã‚¢ãƒ«ãƒã‚¹ã®è½èƒ¤"})})],a=[e];return console.info(`start : ${e.toString()} â‡’ ${a.map(r=>r.toString()).join(" ")} (${i.map(r=>r.title).join(" ")})`),a.forEach(r=>i.forEach(r.statusOperatorBundle.push)),{targets:a,seqList:i.map(r=>r.seq)}},finish:async(e,i)=>{i.targets.forEach(a=>i.seqList.forEach(a.statusOperatorBundle.removeItem))}}]}}}}const Ws=Object.freeze(Object.defineProperty({__proto__:null,default:Zf},Symbol.toStringTag,{value:"Module"})),ba={},Gf=t=>(ba[t]||(ba[t]={title:`${t}è‡ªå·±ã‚»ãƒƒãƒˆ`,isMandatory:!1,playType:"IgnitionEffect",spellSpeed:"Normal",executableCells:["Graveyard"],executablePeriods:["end"],executableDuelistTypes:["Controller"],executableFaces:["FaceUp"],isOnlyNTimesPerTurn:1,isNoticedForcibly:!0,meetsConditions:e=>{var a;const i=e.action.entity.moveLog.latestRecord;return!(!i.movedAs.includes("Cost")||((a=i.movedBy)==null?void 0:a.nm)!=="ã‚¢ãƒ«ãƒã‚¹ã®è½èƒ¤"||!e.activator.duel.clock.isSameTurn(i.movedAt))},canExecute:e=>e.activator.getAvailableSpellTrapZones().length?e.activator.canSet:!1,prepare:T,execute:async e=>{if(e.action.entity.wasMovedAfter(e.isActivatedAt))return!1;const i=e.activator.getAvailableSpellTrapZones();if(!i.length||!e.activator.canSet)return!1;const a=await e.activator.duel.view.waitSelectDestination(e.activator,e.action.entity,i,"ã‚»ãƒƒãƒˆã™ã‚‹å ´æ‰€ã‚’é¸æŠžã€‚","ã‚»ãƒƒãƒˆ",!1);if(!a)throw new F("é…ç½®å ´æ‰€é¸æŠž",e);return await e.action.entity.setAsSpellTrap(a,e.action.entity.origin.kind,["Effect"],e.action.entity,e.activator),!0},settle:async()=>!0}),ba[t]);function*$f(){yield{name:"ç™½ã®çƒ™å°",actions:[{title:"â‘ ç™ºå‹•",isMandatory:!1,playType:"CardActivation",spellSpeed:"Normal",executableCells:["Hand","SpellAndTrapZone"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],...vi(["ExtraDeck"],()=>!0,["Hand","MonsterZone","ExtraMonsterZone","Graveyard"],(t,e,i)=>i.flatMap(a=>a.types??[]).includes("Dragon")&&(i.map(a=>a.nm).includes("ã‚¢ãƒ«ãƒã‚¹ã®è½èƒ¤")||!i.map(a=>a.cell.cellType).includes("Graveyard")))},Gf("â‘¡"),b]}}const Qs=Object.freeze(Object.defineProperty({__proto__:null,default:$f},Symbol.toStringTag,{value:"Module"}));function*Uf(){{const t=i=>!!(i.share||i.takeAll),e=(i,a,r)=>{var d;const n=r||i.activator.duel.field.getCells("Graveyard","Banished").flatMap(f=>f.cardEntities).filter(f=>f.isMonster).filter(f=>{var p;return!((p=f.status.monsterCategories)!=null&&p.includes("Fusion"))}).filter(f=>f.canBeTargetOfEffect(i));if(n.length<2)return;const s=!!((d=a.release)!=null&&d.flatMap(f=>f.fusionMaterialInfos).filter(nt).map(f=>f.cardName).includes("ã‚¢ãƒ«ãƒã‚¹ã®è½èƒ¤")),l=Ui.flatMap(f=>a[f]??[]).map(f=>({material:f,isAsEffectCost:!0,cell:f.cell})),o={};if(s){const f=i.activator.getEnableSummonList(i.activator,"SpecialSummon",["Effect"],i.action,n.map(p=>({monster:p,cells:i.activator.getMonsterZones(),posList:["Defense"]})),l,!1);f.length>1&&f.flatMap(p=>p.cells).getDistinct().length>1&&(o.takeAll=f)}const u=[i.activator,i.activator.getOpponentPlayer()].map(f=>i.activator.getEnableSummonList(i.activator,"SpecialSummon",["Effect"],i.action,n.map(p=>({monster:p,cells:f.getMonsterZones(),posList:k})),l,!1));if(!u.some(f=>!f.length))if(u.every(f=>f.length===1))u.flat().map(f=>f.monster.seq).getDistinct().length!==1&&(o.share=u);else if(u.some(f=>f.length===1)){const f=u.filter(p=>p.length===1).flat().map(p=>p.monster);o.share=u.map(p=>p.length<2?p:p.filter(h=>!f.includes(h.monster)))}else o.share=u;return t(o)?o:void 0};yield{name:"åˆ†ã‹ã¤çƒ™å°",actions:[{title:"ç™ºå‹•",isMandatory:!1,playType:"CardActivation",spellSpeed:"Quick",executableCells:["SpellAndTrapZone"],executablePeriods:D,executableDuelistTypes:["Controller"],fixedTags:["SpecialSummonFromGraveyard"],isOnlyNTimesPerTurn:1,canPayCosts:(...i)=>Jn(...i,(a,r,n)=>{var s;return!!((s=n.status.monsterCategories)!=null&&s.includes("Fusion"))}),canExecute:(i,a,r)=>r?!!e(i,r.costInfo):i.activator.getMonstersOnField().filter(n=>{var s;return(s=n.status.monsterCategories)==null?void 0:s.includes("Fusion")}).filter(n=>n.canBeReleased(i.activator,i.action.entity,["ReleaseAsCost"],i.action)).some(n=>e(i,{release:[n]})),payCosts:async(i,a,r)=>{const n=await i.activator.waitSelectEntity(i.activator.getMonstersOnField().filter(s=>{var l;return(l=s.status.monsterCategories)==null?void 0:l.includes("Fusion")}).filter(s=>s.canBeReleased(i.activator,i.action.entity,["ReleaseAsCost"],i.action)).filter(s=>e(i,{release:[s]})),"ãƒªãƒªãƒ¼ã‚¹ã™ã‚‹ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã‚’é¸æŠžã€‚",r);if(n)return await n.release(["Cost"],i.action.entity,i.activator),{release:[n]}},prepare:async(i,a,r)=>{const n=e(i,i.costInfo);if(!n)throw new S("æƒ³å®šã•ã‚Œãªã„çŠ¶æ…‹");const s=[];return n.share&&s.push(...n.share.flat().map(o=>o.monster)),n.takeAll&&s.push(...n.takeAll.map(o=>o.monster)),{selectedEntities:await i.activator.waitSelectEntities(s.getDistinct(),2,o=>{if(o.length!==2)return!1;if(n.share&&n.share.every(u=>u.map(d=>d.monster).some(d=>o.includes(d))))return!0;if(n.takeAll){const u=n.takeAll;if(o.every(d=>u.map(f=>f.monster).includes(d)))return!0}return!1},"è˜‡ç”Ÿã™ã‚‹ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã‚’é¸æŠžã€‚",r)}},execute:async(i,a)=>{if(i.selectedEntities.some(s=>s.wasMovedAfter(i.isActivatedAt)))return!1;const r=e(i,i.costInfo,i.selectedEntities);if(!r)return!1;let n=!!r.takeAll;if(r.share&&r.takeAll&&(n=await i.activator.waitYesNo("è‡ªåˆ†ã®å ´ã«ä¸¡æ–¹ã®ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã‚’ç‰¹æ®Šå¬å–šã™ã‚‹ï¼Ÿ")),n)return In(i,a,{posList:["Defense"],allOrNothing:!0});if(!r.share)throw new S("æƒ³å®šã•ã‚Œãªã„çŠ¶æ…‹");return await i.activator.summonEachFields(i.activator,"SpecialSummon",["Effect"],i.action,r.share.flat(),Ui.flatMap(s=>i.costInfo[s]??[]).map(s=>({material:s,isAsEffectCost:!0,cell:s.cell})),!1,1,s=>s.length===1,!1),!0},settle:async()=>!0},b]}}}const Xs=Object.freeze(Object.defineProperty({__proto__:null,default:Uf},Symbol.toStringTag,{value:"Module"}));function*jf(){yield{name:"ãƒ•ã‚¡ã‚¤ã‚¢ã‚¦ã‚©ãƒ¼ãƒ«ãƒ»ãƒ‰ãƒ©ã‚´ãƒ³ãƒ»ã‚·ãƒ³ã‚®ãƒ¥ãƒ©ãƒªãƒ†ã‚£",actions:[yi(t=>t.length>2),{title:"â‘ ãƒã‚¦ãƒ³ã‚¹ï¼†è‡ªå·±å¼·åŒ–",isMandatory:!1,playType:"QuickEffect",spellSpeed:"Quick",executableCells:H,executablePeriods:[...D,...O],executableDuelistTypes:["Controller"],isOnlyNTimesPerTurn:1,hasToTargetCards:!0,fixedTags:["BounceToHand"],canExecute:t=>[...t.activator.getGraveyard().cardEntities,...t.activator.getMonstersOnField()].flatMap(r=>r.status.monsterCategories??[]).getDistinct().union(["Ritual","Fusion","Synchro","Xyz"]).length<1?!1:[...t.activator.getOpponentPlayer().getGraveyard().cardEntities,...t.activator.getOpponentPlayer().getEntiteisOnField()].filter(r=>r.canBeTargetOfEffect(t)).length>0,prepare:async(t,e,i)=>{const r=[...t.activator.getGraveyard().cardEntities,...t.activator.getMonstersOnField()].flatMap(o=>o.status.monsterCategories??[]).getDistinct().union(["Ritual","Fusion","Synchro","Xyz"]).length;if(r<1)return;const n=[...t.activator.getOpponentPlayer().getGraveyard().cardEntities,...t.activator.getOpponentPlayer().getEntiteisOnField()].filter(o=>o.canBeTargetOfEffect(t));if(n.length<1)return;const s=n.length===1?1:void 0,l=await t.activator.waitSelectEntities(n,s,o=>o.length>0&&o.length<=r,"æ‰‹æœ­ã«æˆ»ã™ã‚«ãƒ¼ãƒ‰ã‚’é¸æŠžã€‚",i);if(l)return{selectedEntities:l}},execute:async t=>{const e=t.selectedEntities.filter(a=>a.isOnFieldStrictly||a.cell.cellType==="Graveyard").filter(a=>a.canBeEffected(t.activator,t.action.entity,t.action));await _.returnManyToHandForTheSameReason(e,["Effect"],t.action.entity,t.activator);const i=e.filter(a=>a.cell.cellType==="Hand"||a.cell.cellType==="ExtraDeck").length;return t.action.entity.numericOprsBundle.push(ne.createLingeringAddition(t.action.title,a=>a.isSpawnedBy.isEffective,t.action.entity,t.action,"attack",(a,r,n)=>n+500*i)),!0},settle:async()=>!0},{title:"â‘¡è˜‡ç”Ÿ",isMandatory:!1,playType:"TriggerEffect",spellSpeed:"Normal",executableCells:H,executablePeriods:le,executableDuelistTypes:["Controller"],isOnlyNTimesPerTurn:1,fixedTags:["SpecialSummonFromGraveyard"],meetsConditions:t=>{const e=t.action.entity.moveLog.latestRecord.movedAt,i=t.action.duel.field.moveLog.getPriviousChainLog().filter(a=>a.entity.cell.cellType==="Graveyard"||a.movedAs.includes("Battle")&&a.movedAs.includes("Destroy")).filter(a=>a.movedAt.totalProcSeq>e.totalProcSeq).map(a=>a.entity.wasMovedFrom).toArray();return t.action.entity.linkArrowDests.union(i).length>0},...Ze(t=>t.activator.getGraveyard().cardEntities.filter(e=>e.kind==="Monster").filter(e=>e.types.includes("Cyberse")).filter(e=>e.canBeTargetOfEffect(t))),settle:async()=>!0}]}}const Ks=Object.freeze(Object.defineProperty({__proto__:null,default:jf},Symbol.toStringTag,{value:"Module"}));function*zf(){yield{name:"èžåˆ",actions:[{title:"ç™ºå‹•",isMandatory:!1,playType:"CardActivation",spellSpeed:"Normal",executableCells:["Hand","SpellAndTrapZone"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],...vi(["ExtraDeck"],()=>!0,["Hand","MonsterZone","ExtraMonsterZone"],()=>!0)},b]};for(const t of[{name:"ç°¡æ˜“èžåˆ",lvlUpperBound:5,filter:()=>!0},{name:"ç°¡ç´ èžåˆ",lvlUpperBound:6,filter:e=>{var i;return!((i=e.status.monsterCategories)!=null&&i.includes("Effect"))}}])yield{name:t.name,actions:[{title:"ç™ºå‹•",isMandatory:!1,playType:"CardActivation",spellSpeed:"Normal",executableCells:["Hand","SpellAndTrapZone"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],isOnlyNTimesPerTurn:1,fixedTags:["SpecialSummonFromExtraDeck"],canPayCosts:e=>e.activator.lp>=1e3,canExecute:e=>{const i=e.activator.getMonsterZones();return e.activator.getEnableSummonList(e.activator,"SpecialSummon",["Effect"],e.action,e.activator.getExtraDeck().cardEntities.filter(r=>{var n;return(n=r.status.monsterCategories)==null?void 0:n.includes("Fusion")}).filter(r=>r.lvl&&r.lvl<=t.lvlUpperBound).filter(t.filter).map(r=>({monster:r,posList:k,cells:i})),[],!1).length>0},payCosts:(e,i)=>Ut(e,i,1e3),prepare:T,execute:async e=>{var r;const i=e.activator.getMonsterZones(),a=await e.activator.summonOne(e.activator,"FusionSummon",["Effect"],e.action,e.activator.getExtraDeck().cardEntities.filter(n=>{var s;return(s=n.status.monsterCategories)==null?void 0:s.includes("Fusion")}).filter(n=>n.lvl&&n.lvl<=t.lvlUpperBound).filter(t.filter).map(n=>({monster:n,posList:k,cells:i})),[],!1,!1);return a?(a.statusOperatorBundle.push(new oe({title:"æ”»æ’ƒä¸å¯",validateAlive:()=>!0,isContinuous:!1,isSpawnedBy:e.action.entity,actionAttr:e.action,isApplicableTo:(n,s)=>s.face==="FaceUp"&&s.isOnFieldAsMonsterStrictly,statusCalculator:()=>({canAttack:!1})})),a.counterHolder.setSelfDestructionFlg(e.action.entity),a.info.isRebornable=!((r=a.origin.monsterCategories)!=null&&r.includes("RegularSpecialSummonOnly")),!0):!1},settle:async()=>!0},b,{title:"è‡ªå£Š",isMandatory:!0,playType:"LingeringEffect",spellSpeed:"Normal",executableCells:Me,executablePeriods:["end"],executableDuelistTypes:$t,canExecute:e=>e.action.entity.field.getMonstersOnFieldStrictly().some(i=>i.counterHolder.getSelfDestructionFlg(e.action.entity)),prepare:T,execute:async e=>{const i=e.action.entity.field.getMonstersOnFieldStrictly().filter(r=>r.counterHolder.getSelfDestructionFlg(e.action.entity));if(!i.length)throw new S("æƒ³å®šã•ã‚Œãªã„çŠ¶æ…‹",e);let a=i[0];if(i.length>1){const r=await e.activator.waitSelectEntity(i,"è‡ªå£Šã•ã›ã‚‹ã‚«ãƒ¼ãƒ‰ã‚’é¸æŠžã€‚",!1);if(!r)throw new F(e);a=r}return await _.tryDestroy([a],e),!0},settle:async()=>!0}]}}const Ys=Object.freeze(Object.defineProperty({__proto__:null,default:zf},Symbol.toStringTag,{value:"Module"}));function*Vf(){yield*["ã‚¤ã‚°ãƒŠã‚¤ãƒˆãƒ»ã‚¤ãƒ¼ã‚°ãƒ«","ã‚¤ã‚°ãƒŠã‚¤ãƒˆãƒ»ãƒžã‚°ãƒŠãƒ ","ã‚¤ã‚°ãƒŠã‚¤ãƒˆãƒ»ãƒ‰ãƒ©ã‚°ãƒŽãƒ•","ã‚¤ã‚°ãƒŠã‚¤ãƒˆãƒ»ãƒžã‚¹ã‚±ãƒƒãƒˆ","ã‚¤ã‚°ãƒŠã‚¤ãƒˆãƒ»ãƒ‡ãƒªãƒ³ã‚¸ãƒ£ãƒ¼","ã‚¤ã‚°ãƒŠã‚¤ãƒˆãƒ»ãƒ©ã‚¤ã‚ªãƒƒãƒˆ","ã‚¤ã‚°ãƒŠã‚¤ãƒˆãƒ»ã‚¦ãƒ¼ã‚¸ãƒ¼","ã‚¤ã‚°ãƒŠã‚¤ãƒˆãƒ»ã‚­ãƒ£ãƒªãƒãƒ¼"].map(t=>({name:t,actions:[lt,{title:"â‘ ã‚µãƒ¼ãƒ",isMandatory:!1,playType:"IgnitionEffect",spellSpeed:"Normal",executableCells:["SpellAndTrapZone"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],executableFaces:["FaceUp"],fixedTags:["Destroy","DestroyMultiple","DestroyMultipleOnField","DestroySpellTrapOnField","DestroySpellTrapsOnField"],meetsConditions:e=>{var a;const i=e.activator.getPendulumScaleMonsters().find(r=>r!==e.action.entity);return!(!i||!((a=i.status.nameTags)!=null&&a.includes("ã‚¤ã‚°ãƒŠã‚¤ãƒˆ")))},canExecute:e=>e.activator.getDeckCell().cardEntities.some(i=>{var a;return(a=i.status.nameTags)==null?void 0:a.includes("ã‚¤ã‚°ãƒŠã‚¤ãƒˆ")}),prepare:async e=>({selectedEntities:[],chainBlockTags:["SearchFromDeck",...e.action.calcChainBlockTagsForDestroy(e.activator,e.activator.getPendulumScaleMonsters())],prepared:void 0}),execute:async e=>{if(!(await _.tryDestroy(e.activator.getPendulumScaleMonsters(),e)).length)return!1;const a=e.activator.getDeckCell().cardEntities.filter(n=>{var s;return(s=n.status.nameTags)==null?void 0:s.includes("ã‚¤ã‚°ãƒŠã‚¤ãƒˆ")});if(!a.length)return!1;const r=await e.activator.waitSelectEntity(a,"æ‰‹æœ­ã«åŠ ãˆã‚‹ã‚«ãƒ¼ãƒ‰ã‚’é¸æŠžã€‚",!1);return r?(await r.addToHand(["Effect"],e.action.entity,e.activator),!0):!1},settle:async()=>!0}]}))}const Js=Object.freeze(Object.defineProperty({__proto__:null,default:Vf},Symbol.toStringTag,{value:"Module"}));function*Wf(){{const t=(e,i)=>{const a=i.opponent??!1,r=i.banish??!1,n=i.target??!1;let l=(a?e.activator.getOpponentPlayer():e.activator).getGraveyard().cardEntities.filter(o=>o.kind==="Trap").filter(o=>o.status.trapCategory==="Normal").filter(o=>!(i.costInfo.banish??[]).includes(o)).filter(o=>o!==e.action.entity);return r&&(l=l.filter(o=>e.activator.canTryBanish(o,"BanishAsCost",e.action)).filter(o=>o.canBeBanished("BanishAsCost",e.activator,e.action.entity,e.action))),n&&(l=l.filter(o=>o.canBeTargetOfEffect(e))),l.flatMap(o=>o.actions).filter(o=>o.playType==="CardActivation").filter(o=>!o.needsToPayRegularCosts).filter(o=>{const u=i.costInfo??{};return r&&(u.banish=[o.entity,...u.banish??[]]),o.validate(e.activator,[],["IgnoreRegularCosts","CopyEffectOnly"],{executeBy:e.action.entity,costInfo:u})})};yield{name:"ã‚¸ãƒ£ãƒ³ã‚¯ãƒ»ã‚³ãƒ¬ã‚¯ã‚¿ãƒ¼",actions:[{title:"ç½ ã‚³ãƒ”ãƒ¼",isMandatory:!1,playType:"QuickEffect",spellSpeed:"Quick",executableCells:H,executablePeriods:D,executableDuelistTypes:["Controller"],executableFaces:["FaceUp"],needsToPayRegularCost:!0,fixedTags:["DelegateAnotherEffect"],canPayCosts:e=>Bt(e)&&t(e,{banish:!0,costInfo:{banish:[e.action.entity]}}).length>0,payCosts:async(e,i,a)=>{const r=t(e,{banish:!0,costInfo:{banish:[e.action.entity]}}).map(l=>l.entity),n=await e.activator.waitSelectEntity(r,"ã‚³ãƒ”ãƒ¼ã™ã‚‹ç½ ã‚’é¸æŠžã€‚",a);if(!n)return;const s=[e.action.entity,n];return await _.banishManyForTheSameReason(s,["Cost"],e.action.entity,e.activator),{banish:s}},prepare:async(e,i)=>{var s;const a=(s=e.costInfo.banish)==null?void 0:s.find(l=>l!==e.action.entity);if(!a)throw new S("æ­£è¦ã®ã‚³ã‚¹ãƒˆã‚’æ”¯æ‰•ã‚ãšã«ã‚¸ãƒ£ãƒ³ã‚¯ãƒ»ã‚³ãƒ¬ã‚¯ã‚¿ãƒ¼ã®åŠ¹æžœå‡¦ç†ã‚’è¡ŒãŠã†ã¨ã—ãŸã€‚",e,e.costInfo);const r=a.actions.find(l=>l.playType==="CardActivation");if(!r)throw new S("ã‚«ãƒ¼ãƒ‰ã®åŠ¹æžœã®ç™ºå‹•ã‚’æŒãŸãªã„ã‚«ãƒ¼ãƒ‰ã‚’ã‚¸ãƒ£ãƒ³ã‚¯ãƒ»ã‚³ãƒ¬ã‚¯ã‚¿ãƒ¼ã§ã‚³ãƒ”ãƒ¼ã—ã‚ˆã†ã¨ã—ãŸã€‚",e,e.costInfo,a);const n={...await r.prepare(e.activator,void 0,void 0,i,!1,!0)};return n.appendix=[`ã‚³ãƒ”ãƒ¼å¯¾è±¡ï¼š${a.toString()}`,...n.appendix??[]],n.chainBlockTags=[],n},execute:async(e,i)=>{var n;const a=(n=e.costInfo.banish)==null?void 0:n.find(s=>s!==e.action.entity);if(!a)throw new S("æƒ³å®šã•ã‚Œãªã„çŠ¶æ³",e,e.costInfo);const r=a.actions.find(s=>s.playType==="CardActivation");if(!r)throw new S("æƒ³å®šã•ã‚Œãªã„çŠ¶æ³",e,e.costInfo,a);return await r.execute(e,i,{indirectly:!0})},settle:async()=>!0}]},yield{name:"ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ãƒ»ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯",actions:[b,{title:"ç™ºå‹•",isMandatory:!1,playType:"CardActivation",spellSpeed:"Quick",executableCells:["SpellAndTrapZone"],executablePeriods:D,executableDuelistTypes:["Controller"],isOnlyNTimesPerTurn:1,actionGroupName:"ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ãƒ»ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯",fixedTags:["DelegateAnotherEffect"],canExecute:e=>t(e,{opponent:!0,target:!0,costInfo:{}}).length>0,payCosts:$r,prepare:async(e,i,a)=>{const r=t(e,{opponent:!0,target:!0,costInfo:e.costInfo}).map(o=>o.entity),n=await e.activator.waitSelectEntity(r,"ã‚³ãƒ”ãƒ¼ã™ã‚‹ç½ ã‚’é¸æŠžã€‚",a);if(!n)return;const s=n.actions.find(o=>o.playType==="CardActivation");if(!s)throw new S(`ã‚«ãƒ¼ãƒ‰ã®åŠ¹æžœã®ç™ºå‹•ã‚’æŒãŸãªã„ã‚«ãƒ¼ãƒ‰ã‚’${e.action.entity.toString()}ã§ã‚³ãƒ”ãƒ¼ã—ã‚ˆã†ã¨ã—ãŸã€‚`,e,n);const l={...await s.prepare(e.activator,void 0,void 0,i,!1,!0)};return l.appendix=[`ã‚³ãƒ”ãƒ¼å¯¾è±¡ï¼š${n.toString()}`,...l.appendix??[]],l.selectedEntities=[...l.selectedEntities??[],n],l},execute:async(e,i)=>{const a=e.selectedEntities.pop();if(!a)throw new S("æƒ³å®šã•ã‚Œãªã„çŠ¶æ³",e,e.data);if(a.wasMovedAfter(e.isActivatedAt))return!1;const r=a.actions.find(n=>n.playType==="CardActivation");if(!r)throw new S("æƒ³å®šã•ã‚Œãªã„çŠ¶æ³",e,e.data);return await r.execute(e,i,{indirectly:!0})},settle:async(e,i)=>{const a=e.selectedEntities.pop();if(!a)throw new S("æƒ³å®šã•ã‚Œãªã„çŠ¶æ³",e,e.data);if(a.wasMovedAfter(e.isActivatedAt))return!1;const r=a.actions.find(n=>n.playType==="CardActivation");if(!r)throw new S("æƒ³å®šã•ã‚Œãªã„çŠ¶æ³",e,e.data);return await r.directSettle(e,i)}},{title:"â‘¡ç½ ã‚³ãƒ”ãƒ¼",isMandatory:!1,playType:"QuickEffect",spellSpeed:"Quick",executableCells:["Graveyard"],executablePeriods:D,executableDuelistTypes:["Controller"],isOnlyNTimesPerTurn:1,actionGroupName:"ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ãƒ»ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯",fixedTags:["DelegateAnotherEffect"],canExecute:e=>Bt(e)&&t(e,{target:!0,costInfo:{banish:[e.action.entity]}}).length>0,payCosts:async e=>{const i=await $r(e),a=await hi(e);return{...i,...a}},prepare:async(e,i,a)=>{const r=t(e,{target:!0,costInfo:e.costInfo}).map(o=>o.entity),n=await e.activator.waitSelectEntity(r,"ã‚³ãƒ”ãƒ¼ã™ã‚‹ç½ ã‚’é¸æŠžã€‚",a);if(!n)return;const s=n.actions.find(o=>o.playType==="CardActivation");if(!s)throw new S(`ã‚«ãƒ¼ãƒ‰ã®åŠ¹æžœã®ç™ºå‹•ã‚’æŒãŸãªã„ã‚«ãƒ¼ãƒ‰ã‚’${e.action.entity.toString()}ã§ã‚³ãƒ”ãƒ¼ã—ã‚ˆã†ã¨ã—ãŸã€‚`,e,n);const l={...await s.prepare(e.activator,void 0,void 0,i,!1,!0)};return l.appendix=[`ã‚³ãƒ”ãƒ¼å¯¾è±¡ï¼š${n.toString()}`,...l.appendix??[]],l.selectedEntities=[...l.selectedEntities??[],n],l},execute:async(e,i)=>{const a=e.selectedEntities.pop();if(!a)throw new S("æƒ³å®šã•ã‚Œãªã„çŠ¶æ³",e,e.data);if(a.wasMovedAfter(e.isActivatedAt))return!1;const r=a.actions.find(n=>n.playType==="CardActivation");if(!r)throw new S("æƒ³å®šã•ã‚Œãªã„çŠ¶æ³",e,e.data);return await r.execute(e,i,{indirectly:!0})},settle:async()=>!0}]}}}const Is=Object.freeze(Object.defineProperty({__proto__:null,default:Wf},Symbol.toStringTag,{value:"Module"}));function*Qf(){yield{name:"ãƒ©ã‚¤ãƒˆãƒ­ãƒ¼ãƒ‰ãƒ»ãƒ‰ãƒŸãƒ‹ã‚ªãƒ³ ã‚­ãƒ¥ãƒªã‚ªã‚¹",actions:[yi(t=>t.flatMap(e=>e.types).getDistinct().length===3&&uc.some(e=>t.every(i=>i.attr.includes(e)))),{title:"â‘ å¢“åœ°é€ã‚Š",isMandatory:!1,playType:"TriggerEffect",spellSpeed:"Normal",executableCells:H,executablePeriods:[...D,...O],executableDuelistTypes:["Controller"],executableFaces:["FaceUp"],isOnlyNTimesPerTurn:1,triggerPattern:{triggerType:"Arrival",arrivalReasons:["LinkSummon"]},fixedTags:["SendToGraveyardFromDeck"],canExecute:t=>t.activator.getDeckCell().cardEntities.length>0,prepare:T,execute:async t=>{const e=t.activator.getDeckCell().cardEntities;if(!e.length)return!1;const i=await t.activator.waitSelectEntity(e,"å¢“åœ°ã«é€ã‚‹ã‚«ãƒ¼ãƒ‰ã‚’é¸æŠž",!1);if(!i)throw new F(t);return await i.sendToGraveyard(["Effect"],t.action.entity,t.activator),t.activator.getDeckCell().shuffle(),!0},settle:async()=>!0},{title:"â‘¡å¢“åœ°é€ã‚Š",isMandatory:!0,playType:"TriggerEffect",spellSpeed:"Normal",executableCells:H,executablePeriods:[...D,...O],executableDuelistTypes:["Controller"],isOnlyNTimesPerTurn:1,fixedTags:["SpecialSummonFromGraveyard"],meetsConditions:t=>{const e=t.action.entity.moveLog.latestRecord.movedAt;return t.action.duel.field.moveLog.getPriviousChainLog().filter(i=>i.entity.cell.cellType==="Graveyard").filter(i=>i.movedAt.totalProcSeq>e.totalProcSeq).map(i=>i.entity.wasMovedFrom).filter(i=>i.owner===t.activator).some(i=>i.cellType==="Deck")},...ur({targets:["Self"],qty:3}),settle:async()=>!0},{title:"â‘¢ã‚µãƒ«ãƒ™ãƒ¼ã‚¸",isMandatory:!1,playType:"TriggerEffect",spellSpeed:"Normal",executableCells:["Graveyard","Banished"],executablePeriods:[...D,...O],executableDuelistTypes:["Controller"],triggerPattern:{triggerType:"Departure",needsByBattle:!0,needsByEffect:!0,needsByOpponent:!0,from:H},fixedTags:["ReturnToHandFromGraveyard"],..._e(t=>t.activator.getGraveyard().cardEntities,{message:"æ‰‹æœ­ã«åŠ ãˆã‚‹ã‚«ãƒ¼ãƒ‰ã‚’é¸æŠžã€‚"}),execute:async t=>t.selectedEntities.some(e=>e.wasMovedAfter(t.isActivatedAt))?!1:(await _.addManyToHand(t.selectedEntities,["Effect"],t.action.entity,t.activator),!0),settle:async()=>!0}]}}const el=Object.freeze(Object.defineProperty({__proto__:null,default:Qf},Symbol.toStringTag,{value:"Module"}));function*Xf(){yield{name:"ã‚½ãƒ¼ãƒ©ãƒ¼ãƒ»ã‚¨ã‚¯ã‚¹ãƒã‚§ãƒ³ã‚¸",actions:[{title:"ç™ºå‹•",isMandatory:!1,playType:"CardActivation",spellSpeed:"Normal",executableCells:["Hand","SpellAndTrapZone"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],fixedTags:["Draw","SendToGraveyardFromDeck","DiscordAsCost"],priorityForNPC:40,canPayCosts:(...t)=>jt(...t,e=>{var i;return e.kind==="Monster"&&!!((i=e.status.nameTags)!=null&&i.includes("ãƒ©ã‚¤ãƒˆãƒ­ãƒ¼ãƒ‰"))}),canExecute:t=>t.activator.getDeckCell().cardEntities.length>3,payCosts:(...t)=>zt(...t,e=>{var i;return e.kind==="Monster"&&!!((i=e.status.nameTags)!=null&&i.includes("ãƒ©ã‚¤ãƒˆãƒ­ãƒ¼ãƒ‰"))}),prepare:async()=>({selectedEntities:[]}),execute:async t=>{await t.activator.draw(2,t.action.entity,t.activator),t.activator.duel.clock.incrementProcSeq();const e=t.activator.getDeckCell().cardEntities.slice(0,2);return await _.sendManyToGraveyardForTheSameReason(e,["Effect"],t.action.entity,t.activator),!0},settle:async()=>!0},b]},yield{name:"å…‰ã®æ´è»",actions:[{title:"ç™ºå‹•",isMandatory:!1,playType:"CardActivation",spellSpeed:"Normal",executableCells:["Hand","SpellAndTrapZone"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],fixedTags:["SearchFromDeck","SendToGraveyardFromDeck"],priorityForNPC:40,canPayCosts:t=>t.activator.getDeckCell().cardEntities.length>3,canExecute:t=>t.activator.getDeckCell().cardEntities.filter(e=>e.kind==="Monster").filter(e=>(e.lvl??13)<5).some(e=>e.status.nameTags&&e.status.nameTags.includes("ãƒ©ã‚¤ãƒˆãƒ­ãƒ¼ãƒ‰")),payCosts:async t=>{const e=t.activator.getDeckCell().cardEntities.slice(0,3);return await _.sendManyToGraveyardForTheSameReason(e,["Cost"],t.action.entity,t.activator),{sendToGraveyard:e}},prepare:async()=>({selectedEntities:[]}),execute:async t=>{const e=t.activator.getDeckCell().cardEntities.filter(a=>a.kind==="Monster").filter(a=>(a.lvl??13)<5).filter(a=>a.status.nameTags&&a.status.nameTags.includes("ãƒ©ã‚¤ãƒˆãƒ­ãƒ¼ãƒ‰"));if(e.length===0)return!1;const i=await t.activator.waitSelectEntity(e,"æ‰‹æœ­ã«åŠ ãˆã‚‹ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã‚’é¸æŠž",!1);if(!i)throw new F(t);return await i.addToHand(["Effect"],t.action.entity,t.activator),t.activator.getDeckCell().shuffle(),!0},settle:async()=>!0},b]}}const tl=Object.freeze(Object.defineProperty({__proto__:null,default:Xf},Symbol.toStringTag,{value:"Module"}));function*Kf(){yield{name:"ãƒ©ã‚¤ãƒˆãƒ­ãƒ¼ãƒ‰ãƒ»ã‚»ã‚¤ãƒ³ãƒˆ ãƒŸãƒãƒ«ãƒ",actions:[Ps(2,2),{title:"â‘ å¢“åœ°é€ã‚Šï¼†ãƒ‰ãƒ­ãƒ¼",isMandatory:!1,playType:"IgnitionEffect",spellSpeed:"Normal",executableCells:H,executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],executableFaces:["FaceUp"],fixedTags:["SendToGraveyardFromDeck"],isOnlyNTimesPerTurn:1,...Sf(),canExecute:t=>t.activator.getDeckCell().cardEntities.length>2,prepare:T,execute:async t=>{const e=t.activator.getDeckCell().cardEntities.slice(0,3);await _.sendManyToGraveyardForTheSameReason(e,["Effect"],t.action.entity,t.activator);const i=e.filter(a=>a.kind==="Monster").filter(a=>{var r;return(r=a.status.nameTags)==null?void 0:r.includes("ãƒ©ã‚¤ãƒˆãƒ­ãƒ¼ãƒ‰")}).length;return i&&await t.activator.draw(i,t.action.entity,t.activator),!0},settle:async()=>!0},{title:"â‘¡å¢“åœ°é€ã‚Šï¼†ç ´å£Š",isMandatory:!1,playType:"TriggerEffect",spellSpeed:"Normal",executableCells:["Graveyard"],executablePeriods:[...D,...O],executableDuelistTypes:["Controller"],triggerPattern:{triggerType:"Departure",needsByBattle:!0,needsByEffect:!0,needsByOpponent:!0,needsByDestory:!0},fixedTags:["SendToGraveyardFromDeck"],canExecute:t=>t.activator.getDeckCell().cardEntities.length>2,prepare:T,execute:async t=>{const e=t.activator.getDeckCell().cardEntities.slice(0,3);await _.sendManyToGraveyardForTheSameReason(e,["Effect"],t.action.entity,t.activator);const i=e.filter(a=>a.kind==="Monster").filter(a=>{var r;return(r=a.status.nameTags)==null?void 0:r.includes("ãƒ©ã‚¤ãƒˆãƒ­ãƒ¼ãƒ‰")}).length;if(i){const a=i===1?1:void 0,r=await t.activator.waitSelectEntities(t.action.entity.field.getCardsOnFieldStrictly(),a,n=>n.length<=i,"ã‚«ãƒ¼ãƒ‰ã‚’ç ´å£Šã™ã‚‹å ´åˆã€ç ´å£Šã™ã‚‹ã‚«ãƒ¼ãƒ‰ã‚’é¸æŠžã€‚",!0)??[];r.length&&await _.tryDestroy(r,t)}return!0},settle:async()=>!0}]}}const il=Object.freeze(Object.defineProperty({__proto__:null,default:Kf},Symbol.toStringTag,{value:"Module"})),zi=(t,e)=>({title:`${t}å¢“åœ°é€ã‚Š(${e})`,isMandatory:!0,playType:"IgnitionEffect",spellSpeed:"Normal",executableCells:H,executablePeriods:["end"],executableDuelistTypes:["Controller"],executableFaces:["FaceUp"],fixedTags:["SendToGraveyardFromDeck"],isOnlyNTimesPerTurnIfFaceup:1,meetsConditions:i=>i.activator.isTurnPlayer,...ur({targets:["Self"],qty:e}),settle:async()=>!0}),Yf=(t,e)=>({title:`${t}å¢“åœ°é€ã‚Š(${e})`,isMandatory:!0,playType:"TriggerEffect",spellSpeed:"Normal",executableCells:H,executablePeriods:[...D,...O],executableDuelistTypes:["Controller"],executableFaces:["FaceUp"],isOnlyNTimesPerTurnIfFaceup:1,fixedTags:["SendToGraveyardFromDeck"],meetsConditions:i=>i.activator.duel.chainBlockLog.records.filter(a=>{var r;return(r=a.chainBlockInfo.action.entity.status.nameTags)==null?void 0:r.includes("ãƒ©ã‚¤ãƒˆãƒ­ãƒ¼ãƒ‰")}).filter(a=>a.chainBlockInfo.action.entity.kind==="Monster").filter(a=>a.chainBlockInfo.action.entity!==i.action.entity).filter(a=>a.chainBlockInfo.action.isWithChainBlock).filter(a=>i.activator.duel.clock.isPreviousChain(a.clock)).filter(a=>a.clock.totalProcSeq>i.action.entity.moveLog.latestRecord.movedAt.totalProcSeq).filter(a=>!a.chainBlockInfo.isNegatedActivationBy).some(a=>a.chainBlockInfo.activator===i.activator),...ur({targets:["Self"],qty:e}),settle:async()=>!0});function*Jf(){yield{name:"ãƒ©ã‚¤ãƒˆãƒ­ãƒ¼ãƒ‰ãƒ»ã‚µãƒ¢ãƒŠãƒ¼ ãƒ«ãƒŸãƒŠã‚¹",actions:[{title:"â‘ è˜‡ç”Ÿ",isMandatory:!1,playType:"IgnitionEffect",spellSpeed:"Normal",executableCells:H,executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],executableFaces:["FaceUp"],isOnlyNTimesPerTurnIfFaceup:1,fixedTags:["SpecialSummonFromGraveyard","DiscordAsCost"],canPayCosts:jt,payCosts:zt,...Ze(t=>t.activator.getGraveyard().cardEntities.filter(e=>e.kind==="Monster").filter(e=>(e.lvl??12)<5).filter(e=>{var i;return(i=e.status.nameTags)==null?void 0:i.includes("ãƒ©ã‚¤ãƒˆãƒ­ãƒ¼ãƒ‰")})),settle:async()=>!0},zi("â‘¡",3)]},yield{name:"ãƒˆãƒ¯ã‚¤ãƒ©ã‚¤ãƒˆãƒ­ãƒ¼ãƒ‰ãƒ»ã‚·ãƒ£ãƒ¼ãƒžãƒ³ ãƒ«ãƒŸãƒŠã‚¹",actions:[{title:"â‘ è˜‡ç”Ÿå¸°é‚„",isMandatory:!1,playType:"IgnitionEffect",spellSpeed:"Normal",executableCells:H,executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],executableFaces:["FaceUp"],isOnlyNTimesPerTurnIfFaceup:1,fixedTags:["SpecialSummonFromGraveyard","DiscordAsCost"],...cr(t=>t.activator.getCells("Hand","Graveyard").flatMap(e=>e.cardEntities).filter(e=>{var i;return(i=e.status.nameTags)==null?void 0:i.includes("ãƒ©ã‚¤ãƒˆãƒ­ãƒ¼ãƒ‰")}).filter(e=>e.kind==="Monster")),...Ze(t=>t.activator.getBanished().cardEntities.filter(e=>e.kind==="Monster").filter(e=>{var i;return(i=e.status.nameTags)==null?void 0:i.includes("ãƒ©ã‚¤ãƒˆãƒ­ãƒ¼ãƒ‰")})),settle:async()=>!0},Yf("â‘¡",3)]},yield{name:"ãƒ©ã‚¤ãƒˆãƒ­ãƒ¼ãƒ‰ãƒ»ãƒ¡ã‚¤ãƒ‡ãƒ³ ãƒŸãƒãƒ«ãƒ",actions:[{title:"â‘ ã‚µãƒ¼ãƒ",isMandatory:!1,playType:"IgnitionEffect",spellSpeed:"Normal",executableCells:H,executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],executableFaces:["FaceUp"],isOnlyNTimesPerTurnIfFaceup:1,triggerPattern:{triggerType:"Arrival",arrivalReasons:["NormalSummon"]},fixedTags:["SearchFromDeck"],canExecute:t=>t.activator.getDeckCell().cardEntities.filter(e=>e.attr.includes("Light")).filter(e=>e.types.includes("Dragon")).some(e=>e.lvl&&e.lvl<=t.activator.getGraveyard().cardEntities.filter(i=>{var a;return(a=i.status.nameTags)==null?void 0:a.includes("ãƒ©ã‚¤ãƒˆãƒ­ãƒ¼ãƒ‰")}).filter(i=>i.kind).map(i=>i.nm).getDistinct().length),prepare:T,execute:async t=>{if(!t.activator.canAddToHandFromDeck)return!1;const e=t.activator.getDeckCell().cardEntities.filter(a=>a.attr.includes("Light")).filter(a=>a.types.includes("Dragon")).filter(a=>a.lvl&&a.lvl<=t.activator.getGraveyard().cardEntities.filter(r=>{var n;return(n=r.status.nameTags)==null?void 0:n.includes("ãƒ©ã‚¤ãƒˆãƒ­ãƒ¼ãƒ‰")}).filter(r=>r.kind).map(r=>r.nm).getDistinct().length),i=await t.activator.waitSelectEntity(e,"æ‰‹æœ­ã«åŠ ãˆã‚‹ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã‚’é¸æŠž",!1);return i?(await i.addToHand(["Effect"],t.action.entity,t.activator),!0):!1},settle:async()=>!0},{title:"â‘¡å¢“åœ°é€ã‚Š",isMandatory:!0,playType:"TriggerEffect",spellSpeed:"Normal",executableCells:["Graveyard"],executablePeriods:[...D,...O],executableDuelistTypes:["Controller"],triggerPattern:{triggerType:"Departure",from:["Deck","Hand"]},fixedTags:["SendToGraveyardFromDeck"],prepare:T,execute:async t=>{const e=t.activator.getDeckCell().cardEntities[0];return e?(await e.sendToGraveyard(["Effect"],t.action.entity,t.activator),!0):!1},settle:async()=>!0},zi("â‘¢",2)]}}const al=Object.freeze(Object.defineProperty({__proto__:null,default:Jf},Symbol.toStringTag,{value:"Module"}));function*If(){yield{name:"ãƒ©ã‚¤ãƒˆãƒ­ãƒ¼ãƒ‰ãƒ»ã‚¢ã‚µã‚·ãƒ³ ãƒ©ã‚¤ãƒ‡ãƒ³",actions:[{title:"â‘ å¢“åœ°é€ã‚Šï¼†è‡ªå·±å¼·åŒ–",isMandatory:!1,playType:"IgnitionEffect",spellSpeed:"Normal",executableCells:H,executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],executableFaces:["FaceUp"],isOnlyNTimesPerTurn:1,fixedTags:["SendToGraveyardFromDeck"],canExecute:t=>t.activator.getDeckCell().cardEntities.length>1,prepare:T,execute:async t=>{const e=t.activator.getDeckCell().cardEntities.slice(0,2);await _.sendManyToGraveyardForTheSameReason(e,["Effect"],t.action.entity,t.activator);const i=e.filter(a=>a.kind==="Monster").filter(a=>{var r;return(r=a.status.nameTags)==null?void 0:r.includes("ãƒ©ã‚¤ãƒˆãƒ­ãƒ¼ãƒ‰")}).length;return i&&t.action.entity.numericOprsBundle.push(ne.createLingeringAddition(t.action.title,a=>a.isSpawnedBy.isEffective&&a.duel.clock.turn-a.isSpawnedAt.turn<2,t.action.entity,t.action,"attack",(a,r,n)=>n+200*i)),!0},settle:async()=>!0},zi("â‘¡",2)]},yield{name:"ãƒ©ã‚¤ãƒˆãƒ­ãƒ¼ãƒ‰ãƒ»ãƒ“ãƒ¼ã‚¹ãƒˆ ã‚¦ã‚©ãƒ«ãƒ•",actions:[{title:"â‘ è‡ªå·±å†ç”Ÿ",isMandatory:!0,playType:"TriggerEffect",spellSpeed:"Normal",executableCells:["Graveyard"],executablePeriods:[...D,...O],executableDuelistTypes:["Controller"],triggerPattern:{triggerType:"Departure",from:["Deck"]},fixedTags:["SpecialSummonFromGraveyard"],canExecute:t=>fe(t,k,[],["Effect"]),prepare:T,execute:Pe,settle:async()=>!0}]},yield{name:"ãƒ©ã‚¤ãƒˆãƒ­ãƒ¼ãƒ‰ãƒ»ã‚¢ãƒ¼ãƒãƒ£ãƒ¼ ãƒ•ã‚§ãƒªã‚¹",actions:[{title:"â‘ è‡ªå·±å†ç”Ÿ",isMandatory:!0,playType:"TriggerEffect",spellSpeed:"Normal",executableCells:["Graveyard"],executablePeriods:[...D,...O],executableDuelistTypes:["Controller"],triggerPattern:{triggerType:"Departure",from:["Deck"],needsByEffect:!0,causerFilter:(t,e)=>e.kind==="Monster"},fixedTags:["SpecialSummonFromGraveyard"],canExecute:t=>fe(t,k,[],["Effect"]),prepare:T,execute:Pe,settle:async()=>!0},{title:"â‘¡ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ç ´å£Šï¼†å¢“åœ°é€ã‚Š",isMandatory:!1,playType:"IgnitionEffect",spellSpeed:"Normal",executableCells:H,executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],executableFaces:["FaceUp"],fixedTags:["Destroy","DestroyMonsterOnField","DestroyOnOpponentField","DestroyOnField","SendToGraveyardFromDeck"],canPayCosts:fa,canExecute:t=>t.activator.getDeckCell().cardEntities.length>2,payCosts:pa,..._e(t=>t.activator.getOpponentPlayer().getMonstersOnField().filter(e=>e.canBeTargetOfEffect(t)),{do:"Destroy"}),execute:async(t,e)=>t.selectedEntities.every(a=>!a.isOnField)||!await _.tryDestroy(t.selectedEntities,t)?!1:(t.activator.duel.clock.incrementProcSeq(),Ga(t,e,{qty:3,targets:["Self"]})),settle:async()=>!0}]},yield{name:"å…‰é“ã®é¾",actions:[{title:"â‘ è‡ªå·±ç‰¹æ®Šå¬å–š",isMandatory:!1,playType:"IgnitionEffect",spellSpeed:"Normal",executableCells:["Hand"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],fixedTags:["SpecialSummonFromHand","SpecialSummon"],isOnlyNTimesPerTurn:1,canExecute:t=>t.activator.getGraveyard().cardEntities.filter(e=>e.kind==="Monster").some(e=>{var i;return(i=e.status.nameTags)==null?void 0:i.includes("ãƒ©ã‚¤ãƒˆãƒ­ãƒ¼ãƒ‰")}),prepare:T,execute:Pe,settle:async()=>!0},{title:"â‘¡å¢“åœ°é€ã‚Š",isMandatory:!1,playType:"TriggerEffect",spellSpeed:"Normal",executableCells:["MonsterZone"],executablePeriods:[...D,...O],executableDuelistTypes:["Controller"],isOnlyNTimesPerTurn:1,triggerPattern:{triggerType:"Arrival",arrivalReasons:["SpecialSummon"]},fixedTags:["SendToGraveyardFromDeck","IfSpecialSummonSucceed","SendToGraveyardFromDeck"],canExecute:t=>t.activator.getDeckCell().cardEntities.filter(e=>{var i;return(i=e.status.nameTags)==null?void 0:i.includes("ãƒ©ã‚¤ãƒˆãƒ­ãƒ¼ãƒ‰")}).some(e=>e.nm!=="å…‰é“ã®é¾"),prepare:T,execute:async t=>{const e=t.activator.getDeckCell().cardEntities.filter(a=>{var r;return(r=a.status.nameTags)==null?void 0:r.includes("ãƒ©ã‚¤ãƒˆãƒ­ãƒ¼ãƒ‰")}).filter(a=>a.nm!=="å…‰é“ã®é¾");if(e.length===0)return!1;const i=await t.activator.waitSelectEntity(e,"å¢“åœ°ã«é€ã‚‹ã‚«ãƒ¼ãƒ‰ã‚’é¸æŠž",!1);if(!i)throw new F(t);return await i.sendToGraveyard(["Effect"],t.action.entity,t.activator),t.activator.getDeckCell().shuffle(),!0},settle:async()=>!0},{title:"â‘¢ã‚µãƒ¼ãƒ",isMandatory:!1,playType:"TriggerEffect",spellSpeed:"Normal",executableCells:["Graveyard"],executablePeriods:[...D,...O],executableDuelistTypes:["Controller"],triggerPattern:{triggerType:"Departure"},isOnlyNTimesPerTurn:1,fixedTags:["SearchFromDeck"],canExecute:t=>t.activator.getDeckCell().cardEntities.some(e=>e.atk===3e3&&e.def===2600),prepare:T,execute:async t=>{const e=t.activator.getDeckCell().cardEntities.filter(a=>a.atk===3e3&&a.def===2600),i=await t.activator.waitSelectEntity(e,"æ‰‹æœ­ã«åŠ ãˆã‚‹ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã‚’é¸æŠž",!1);return i?(await i.addToHand(["Effect"],t.action.entity,t.activator),t.activator.getDeckCell().shuffle(),!0):!1},settle:async()=>!0}]},yield{name:"ãƒ©ã‚¤ãƒˆãƒ­ãƒ¼ãƒ‰ãƒ»ãƒ‡ãƒ¼ãƒ¢ãƒ³ ãƒ´ã‚¡ã‚¤ã‚¹",actions:[{title:"â‘ è‡ªå·±ç‰¹æ®Šå¬å–š",isMandatory:!1,playType:"IgnitionEffect",spellSpeed:"Normal",executableCells:["Hand"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],fixedTags:["SpecialSummonFromHand","SendToGraveyardFromDeck"],isOnlyNTimesPerTurn:1,canPayCosts:t=>t.activator.getHandCell().cardEntities.length>1,canExecute:t=>t.activator.getDeckCell().cardEntities.length>1&&fe(t,k,[],["Effect"]),payCosts:async(t,e,i)=>{const a=t.activator.getHandCell().cardEntities.filter(n=>n!==t.action.entity),r=await t.activator.waitSelectEntity(a,"ãƒ‡ãƒƒã‚­ãƒˆãƒƒãƒ—ã«æˆ»ã™ã‚«ãƒ¼ãƒ‰ã‚’ä¸€æžšé¸æŠžã€‚",i);if(!r)throw new F(t);return await r.returnToDeck("Top",["Cost"],t.action.entity,t.activator),{returnToDeck:[r]}},prepare:T,execute:async(t,e)=>await Pe(t)?(t.activator.duel.clock.incrementProcSeq(),Ga(t,e,{qty:2,targets:["Self"]})):!1,settle:async()=>!0},{title:"â‘¡è˜‡ç”Ÿ",isMandatory:!1,playType:"TriggerEffect",spellSpeed:"Normal",executableCells:["Graveyard"],executablePeriods:[...D,...O],executableDuelistTypes:["Controller"],isOnlyNTimesPerTurn:1,triggerPattern:{triggerType:"Departure",from:["Deck"]},fixedTags:["SpecialSummonFromGraveyard"],...Ze(t=>t.activator.getGraveyard().cardEntities.filter(e=>e.kind==="Monster").filter(e=>{var i;return(i=e.status.nameTags)==null?void 0:i.includes("ãƒ©ã‚¤ãƒˆãƒ­ãƒ¼ãƒ‰")}).filter(e=>e.nm!=="ãƒ©ã‚¤ãƒˆãƒ­ãƒ¼ãƒ‰ãƒ»ãƒ‡ãƒ¼ãƒ¢ãƒ³ ãƒ´ã‚¡ã‚¤ã‚¹")),settle:async()=>!0}]},yield{name:"ãƒ©ã‚¤ãƒˆãƒ­ãƒ¼ãƒ‰ãƒ»ãƒžã‚¸ã‚·ãƒ£ãƒ³ ãƒ©ã‚¤ãƒ©",actions:[{title:"â‘¢é­”æ³•ç½ ç ´å£Š",isMandatory:!1,playType:"IgnitionEffect",spellSpeed:"Normal",executableCells:["MonsterZone"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],executableFaces:["FaceUp"],fixedTags:["Destroy","DestroyOnField","DestroySpellTrapOnField"],..._e(t=>t.activator.getOpponentPlayer().getSpellTrapsOnField().filter(e=>e.canBeTargetOfEffect(t)),{message:"ç ´å£Šã™ã‚‹å¯¾è±¡ã‚’é¸æŠžã€‚",do:"Destroy",canExecute:t=>t.action.entity.battlePosition==="Attack"}),execute:async t=>(t.action.entity.battlePosition==="Attack"&&(await _.tryDestroy(t.selectedEntities,t),await t.action.entity.setBattlePosition("Defense",["Effect"],t.action.entity,t.activator)),t.action.entity.statusOperatorBundle.push(new oe({title:"è¡¨ç¤ºå½¢å¼å¤‰æ›´ä¸å¯",validateAlive:e=>e.duel.clock.turn-e.isSpawnedAt.turn<3,isContinuous:!1,isSpawnedBy:t.action.entity,actionAttr:t.action,isApplicableTo:()=>!0,statusCalculator:()=>({canBattlePositionChange:!1})})),!0),settle:async()=>!0},zi("â‘¡",3)]}}const rl=Object.freeze(Object.defineProperty({__proto__:null,default:If},Symbol.toStringTag,{value:"Module"}));function*ep(){yield{name:"ãƒ©ã‚¤ãƒˆãƒ­ãƒ¼ãƒ‰ãƒ»ã‚¢ãƒ†ãƒŠ ãƒŸãƒãƒ«ãƒ",actions:[me(),{title:"â‘ å¢“åœ°é€ã‚Š",isMandatory:!1,playType:"TriggerEffect",spellSpeed:"Normal",executableCells:H,executablePeriods:[...D,...O],executableDuelistTypes:["Controller"],executableFaces:["FaceUp"],isOnlyNTimesPerTurn:1,fixedTags:["SendToGraveyardFromDeck"],triggerPattern:{triggerType:"Arrival",arrivalReasons:["SynchroSummon"]},canExecute:t=>t.activator.getDeckCell().cardEntities.filter(e=>e.kind==="Monster").some(e=>{var i;return(i=e.status.nameTags)==null?void 0:i.includes("ãƒ©ã‚¤ãƒˆãƒ­ãƒ¼ãƒ‰")})&&t.action.entity.info.materials.map(e=>e.material).filter(e=>e.kind==="Monster").some(e=>{var i;return(i=e.status.nameTags)==null?void 0:i.includes("ãƒ©ã‚¤ãƒˆãƒ­ãƒ¼ãƒ‰")}),prepare:T,execute:async t=>{const e=t.activator.getDeckCell().cardEntities.filter(n=>n.kind==="Monster").filter(n=>{var s;return(s=n.status.nameTags)==null?void 0:s.includes("ãƒ©ã‚¤ãƒˆãƒ­ãƒ¼ãƒ‰")});if(!e.length)return!1;const i=t.action.entity.info.materials.map(n=>n.material).filter(n=>n.kind==="Monster").filter(n=>{var s;return(s=n.status.nameTags)==null?void 0:s.includes("ãƒ©ã‚¤ãƒˆãƒ­ãƒ¼ãƒ‰")}).length,a=i===1?1:void 0,r=await t.activator.waitSelectEntities(e,a,n=>n.length>0&&n.length<=i&&n.length===n.flatMap(s=>s.types).getDistinct().length,"å¢“åœ°ã«é€ã‚‹ã‚«ãƒ¼ãƒ‰ã‚’é¸æŠž",!1);if(!r)throw new F(t);return await _.sendManyToGraveyardForTheSameReason(r,["Effect"],t.action.entity,t.activator),t.activator.getDeckCell().shuffle(),!0},settle:async()=>!0},{title:"â‘¢å¢“åœ°é€ã‚Š",isMandatory:!1,playType:"IgnitionEffect",spellSpeed:"Normal",executableCells:H,executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],executableFaces:["FaceUp"],isOnlyNTimesPerTurn:1,needsToPayRegularCost:!0,fixedTags:["SendToGraveyardFromDeck"],...cr(t=>t.activator.getGraveyard().cardEntities.filter(e=>e.kind==="Monster").filter(e=>{var i;return(i=e.status.nameTags)==null?void 0:i.includes("ãƒ©ã‚¤ãƒˆãƒ­ãƒ¼ãƒ‰")}),(t,e)=>t.length>0&&t.length<5&&t.length<=e.activator.getDeckCell().cardEntities.length,1,4),canExecute:t=>t.activator.getDeckCell().cardEntities.length>0,prepare:T,execute:async t=>{var a;const e=((a=t.costInfo.banish)==null?void 0:a.length)??0;if(!e)throw new S(`${t.action.entity}ã®åŠ¹æžœã‚’ä¸æ­£ãªæ–¹æ³•ã§å®Ÿè¡Œã—ã‚ˆã†ã¨ã—ãŸã€‚${t.costInfo}`);const i=t.activator.getDeckCell().cardEntities.slice(0,e);return await _.sendManyToGraveyardForTheSameReason(i,["Effect"],t.action.entity,t.activator),!0},settle:async()=>!0}],continuousEffects:[Gn("â‘¡é™¤å¤–ä¸å¯","Monster",t=>[He.createContinuous("â‘¡é™¤å¤–ä¸å¯",e=>e.isSpawnedBy.isOnFieldStrictly&&e.isSpawnedBy.face==="FaceUp",t,(e,i)=>{var a;return i.controller===e.isSpawnedBy.controller&&!!((a=i.status.nameTags)!=null&&a.includes("ãƒ©ã‚¤ãƒˆãƒ­ãƒ¼ãƒ‰"))&&i.isOnFieldAsMonsterStrictly&&i.face==="FaceUp"},["BanishAsEffect"],()=>!1)])]}}const nl=Object.freeze(Object.defineProperty({__proto__:null,default:ep},Symbol.toStringTag,{value:"Module"}));function*tp(){for(const t of["ãƒ¡ã‚¿ãƒ«ãƒ•ã‚©ãƒ¼ã‚¼ãƒ»ã‚´ãƒ«ãƒ‰ãƒ©ã‚¤ãƒãƒ¼","ãƒ¡ã‚¿ãƒ«ãƒ•ã‚©ãƒ¼ã‚¼ãƒ»ã‚·ãƒ«ãƒãƒ¼ãƒ‰","ãƒ¡ã‚¿ãƒ«ãƒ•ã‚©ãƒ¼ã‚¼ãƒ»ã‚¹ãƒ†ã‚£ã‚¨ãƒ¬ãƒ³","ãƒ¡ã‚¿ãƒ«ãƒ•ã‚©ãƒ¼ã‚¼ãƒ»ãƒ´ã‚©ãƒ«ãƒ•ãƒ¬ã‚¤ãƒ "])yield{name:t,actions:[lt,{title:"â‘ ã‚µãƒ¼ãƒ",isMandatory:!1,playType:"IgnitionEffect",spellSpeed:"Normal",executableCells:["SpellAndTrapZone"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],executableFaces:["FaceUp"],isOnlyNTimesPerTurnIfFaceup:1,fixedTags:["Destroy"],..._e(e=>{let i=e.activator.getEntiteisOnField().filter(a=>a.face==="FaceUp").filter(a=>a.canBeTargetOfEffect(e)).filter(a=>a!==e.action.entity);return e.activator.getAvailableSpellTrapZones.length||(i=i.filter(a=>a.cell.cellType==="SpellAndTrapZone")),i},{message:"ç ´å£Šã™ã‚‹ã‚«ãƒ¼ãƒ‰ã‚’é¸æŠžã€‚",do:"Destroy",canExecute:e=>e.activator.canSet&&e.activator.getDeckCell().cardEntities.filter(i=>i.kind==="Spell"||i.kind==="Trap").some(i=>{var a;return(a=i.status.nameTags)==null?void 0:a.includes("ãƒ¡ã‚¿ãƒ«ãƒ•ã‚©ãƒ¼ã‚¼")})}),execute:async e=>{if(!(await _.tryDestroy(e.selectedEntities,e)).length||!e.activator.canSet)return!1;const a=e.activator.getAvailableSpellTrapZones();if(!a.length)return!1;const r=e.activator.getDeckCell().cardEntities.filter(l=>l.kind==="Spell"||l.kind==="Trap").filter(l=>{var o;return(o=l.status.nameTags)==null?void 0:o.includes("ãƒ¡ã‚¿ãƒ«ãƒ•ã‚©ãƒ¼ã‚¼")});if(!r.length)return!1;const n=await e.activator.waitSelectEntity(r,"ã‚»ãƒƒãƒˆã™ã‚‹ã‚«ãƒ¼ãƒ‰ã‚’é¸æŠžã€‚",!1);if(!n)return!1;const s=await e.activator.duel.view.waitSelectDestination(e.activator,n,a,"ã‚»ãƒƒãƒˆã™ã‚‹å…ˆã‚’é¸æŠž","ã‚»ãƒƒãƒˆ",!1);if(!s)throw new F("ã‚»ãƒƒãƒˆå…ˆé¸æŠž",e);return await n.setAsSpellTrap(s,n.kind,["Effect"],e.action.entity,e.activator),!0},settle:async()=>!0}]}}const sl=Object.freeze(Object.defineProperty({__proto__:null,default:tp},Symbol.toStringTag,{value:"Module"}));function*ip(){yield{name:"éŒ¬è£…èžåˆ",actions:[{title:"ç™ºå‹•",isMandatory:!1,playType:"CardActivation",spellSpeed:"Normal",executableCells:["Hand","SpellAndTrapZone"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],...vi(["ExtraDeck"],(t,e)=>{var i;return!!((i=e.status.nameTags)!=null&&i.includes("ãƒ¡ã‚¿ãƒ«ãƒ•ã‚©ãƒ¼ã‚¼"))},["Hand","MonsterZone","ExtraMonsterZone"],()=>!0)},{title:"â‘¡ãƒ‰ãƒ­ãƒ¼",isMandatory:!1,playType:"IgnitionEffect",spellSpeed:"Normal",executableCells:["Graveyard"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],executableFaces:["FaceUp"],isOnlyNTimesPerTurn:1,canExecute:t=>t.activator.getDeckCell().cardEntities.length>0&&t.activator.canDraw,prepare:async t=>(await t.action.entity.returnToDeck("Random",["Effect"],t.action.entity,t.activator),{selectedEntities:[],chainBlockTags:["Draw"]}),execute:async t=>(await t.activator.draw(1,t.action.entity,t.activator),!0),settle:async()=>!0},b]}}const ll=Object.freeze(Object.defineProperty({__proto__:null,default:ip},Symbol.toStringTag,{value:"Module"}));function*ap(){yield{name:"ãƒ€ãƒ¼ã‚¯ãƒ»ãƒªã‚¾ãƒãƒ¼ã‚¿ãƒ¼",actions:[],substituteEffects:[$d(1)]},yield{name:"ãƒ¬ãƒƒãƒ‰ãƒ»ãƒªã‚¾ãƒãƒ¼ã‚¿ãƒ¼",actions:[{title:"â‘ ç‰¹æ®Šå¬å–š",isMandatory:!1,playType:"TriggerEffect",spellSpeed:"Normal",executableCells:["MonsterZone"],executablePeriods:[...D,...O],executableDuelistTypes:["Controller"],fixedTags:["SpecialSummonFromHand","IfNormarlSummonSucceed","SpecialSummon"],meetsConditions:t=>t.action.entity.hasBeenArrivalNow(["NormalSummon"]),canExecute:t=>{const e=t.activator.getMonsterZones();return t.activator.getEnableSummonList(t.activator,"SpecialSummon",["Effect"],t.action,t.activator.getHandCell().cardEntities.filter(a=>a.kind==="Monster").filter(a=>(a.lvl??12)<5).map(a=>({monster:a,posList:k,cells:e})),[],!1).length>0},prepare:T,execute:async t=>{const e=t.activator.getMonsterZones(),i=t.activator.getHandCell().cardEntities.filter(r=>r.kind==="Monster").filter(r=>(r.lvl??12)<5).map(r=>({monster:r,posList:k,cells:e}));return!!await t.activator.summonOne(t.activator,"SpecialSummon",["Effect"],t.action,i,[],!1,!1)},settle:async()=>!0},{title:"â‘¡å›žå¾©",isMandatory:!1,playType:"TriggerEffect",spellSpeed:"Normal",executableCells:["MonsterZone"],executablePeriods:[...D,...O],executableDuelistTypes:["Controller"],isOnlyNTimesPerTurn:1,meetsConditions:t=>t.action.entity.hasBeenArrivalNow(["SpecialSummon"]),..._e(t=>t.activator.getMonstersOnField().filter(e=>e.canBeTargetOfEffect(t)).filter(e=>(e.atk??0)>0).filter(e=>e.info.summonKinds.includes("SpecialSummon")),{message:"å¯¾è±¡ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã‚’é¸æŠžã€‚"}),execute:async t=>{const e=t.activator.lp;return t.selectedEntities.filter(i=>i.isOnFieldAsMonsterStrictly).forEach(i=>t.activator.heal(i.atk??0,t.action.entity)),t.activator.lp!==e},settle:async()=>!0}]}}const ol=Object.freeze(Object.defineProperty({__proto__:null,default:ap},Symbol.toStringTag,{value:"Module"}));function*rp(){yield{name:"é­”å°Žæˆ¦å£« ãƒ–ãƒ¬ã‚¤ã‚«ãƒ¼",actions:[{title:"â‘ é­”åŠ›å……å¡«",isMandatory:!0,playType:"TriggerEffect",spellSpeed:"Normal",executableCells:["MonsterZone"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],fixedTags:["IfNormarlSummonSucceed"],meetsConditions:t=>t.action.entity.hasBeenArrivalNow(["NormalSummon"]),prepare:T,execute:async t=>t.action.entity.face==="FaceDown"?!1:(t.action.entity.counterHolder.setQty("SpellCounter",1,t.action.entity),!0),settle:async()=>!0},{title:"â‘¢ãƒžãƒŠãƒ–ãƒ¬ã‚¤ã‚¯",isMandatory:!1,playType:"IgnitionEffect",spellSpeed:"Normal",executableCells:["MonsterZone"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],executableFaces:["FaceUp"],fixedTags:["Destroy","DestroyOnField","DestroySpellTrapOnField"],...ja([1]),..._e(t=>t.activator.duel.field.getSpellTrapsOnFieldStrictly().filter(e=>e.canBeTargetOfEffect(t)),{message:"ç ´å£Šã™ã‚‹å¯¾è±¡ã‚’é¸æŠžã€‚",do:"Destroy"}),execute:async t=>t.selectedEntities.every(e=>!e.isOnFieldAsSpellTrapStrictly)?!1:(await _.tryDestroy(t.selectedEntities,t),!0),settle:async()=>!0}],continuousEffects:[Ua("Monster",1),pi("â‘¡æ”»æ’ƒåŠ›ä¸Šæ˜‡","Monster",t=>[t],t=>[ne.createContinuous("â‘¡æ”»æ’ƒåŠ›ä¸Šæ˜‡",()=>!0,t,()=>!0,"attack","wip","Addition",(e,i,a)=>e.isEffective?a+e.counterHolder.getQty("SpellCounter")*300:a)])]},yield{name:"çŽ‹ç«‹é­”æ³•å›³æ›¸é¤¨",actions:[{...Nf("â‘ ",1)},{title:"â‘¡ãƒ‰ãƒ­ãƒ¼",isMandatory:!1,playType:"IgnitionEffect",spellSpeed:"Normal",executableCells:["MonsterZone"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],executableFaces:["FaceUp"],...ja([3]),canExecute:t=>t.activator.getDeckCell().cardEntities.length>0,prepare:T,execute:async t=>(await t.activator.draw(1,t.action.entity,t.activator),!0),settle:async()=>!0}],continuousEffects:[Ua("Monster",3)]}}const cl=Object.freeze(Object.defineProperty({__proto__:null,default:rp},Symbol.toStringTag,{value:"Module"}));function*np(){yield{name:"ã‚¹ã‚¿ãƒ¼ãƒ€ã‚¹ãƒˆãƒ»ãƒ‰ãƒ©ã‚´ãƒ³",actions:[me(),{title:"â‘ ãƒ´ã‚£ã‚¯ãƒ†ãƒ ãƒ»ã‚µãƒ³ã‚¯ãƒãƒ¥ã‚¢ãƒª",isMandatory:!1,playType:"QuickEffect",spellSpeed:"Quick",executableCells:["MonsterZone","ExtraMonsterZone"],executablePeriods:le,executableDuelistTypes:["Controller"],executableFaces:["FaceUp"],canPayCosts:fa,canExecute:t=>!!(t.targetChainBlock&&t.targetChainBlock.action.isWithChainBlock&&t.targetChainBlock.chainBlockTags.includes("DestroyOnField")),payCosts:pa,prepare:async t=>{if(!t.targetChainBlock)throw new S("æƒ³å®šã•ã‚Œãªã„çŠ¶æ…‹",t);return{selectedEntities:[],chainBlockTags:t.action.calcChainBlockTagsForDestroy(t.activator,[t.targetChainBlock.action.entity]),prepared:void 0}},execute:async(t,e)=>{const i=e[t.index-1];return i.isNegatedActivationBy=t.action,await _.tryDestroy([i.action.entity],t),!0},settle:async()=>!0},{title:"â‘¡è‡ªå·±å†ç”Ÿ",playType:"IgnitionEffect",isMandatory:!1,spellSpeed:"Normal",executableCells:["Graveyard"],executablePeriods:["end"],executableDuelistTypes:["Controller"],executableFaces:["FaceUp"],fixedTags:["SpecialSummonFromGraveyard"],canExecute:t=>{const e=t.action.entity.moveLog.latestRecord;if(e.movedBy!==t.action.entity||!t.activator.duel.clock.isSameTurn(e.movedAt)||!e.movedAs.includes("Cost"))return!1;const i=t.activator.duel,a=t.action.entity.actionLogRecords.filter(r=>i.clock.isSameTurn(r.clock)).map(r=>r.chainBlockInfo).findLast(r=>r.action.title==="â‘ ãƒ´ã‚£ã‚¯ãƒ†ãƒ ãƒ»ã‚µãƒ³ã‚¯ãƒãƒ¥ã‚¢ãƒª");return!a||a.state!=="done"?!1:fe(t,k,[],["Effect"])},prepare:T,execute:Pe,settle:async()=>!0}]},yield{name:"é–ƒç–ç«œ ã‚¹ã‚¿ãƒ¼ãƒ€ã‚¹ãƒˆ",actions:[me(),{title:"æ³¢å‹•éŸ³å£",isMandatory:!1,playType:"QuickEffect",spellSpeed:"Quick",executableCells:H,executablePeriods:D,executableDuelistTypes:["Controller"],executableFaces:["FaceUp"],isOnlyNTimesPerTurnIfFaceup:1,..._e(t=>t.activator.getEntiteisOnField().filter(e=>e.face==="FaceUp").filter(e=>e.canBeTargetOfEffect(t))),execute:async t=>(t.selectedEntities.filter(e=>e.isOnFieldStrictly).filter(e=>e.face==="FaceUp").filter(e=>e.canBeEffected(t.activator,t.action.entity,t.action)).forEach(e=>{e.counterHolder.add("SonicBarrier",1,t.action.entity)}),!0),settle:async()=>!0}],substituteEffects:[{title:"æ³¢å‹•éŸ³å£ï¼ˆé©ç”¨ï¼‰",playType:"LingeringEffect",isMandatory:!0,executableCells:Me,executablePeriods:le,executableDuelistTypes:["Controller"],isApplicableTo:(t,e,i)=>i.filter(a=>a.counterHolder.getQty("SonicBarrier",t.entity)>0),substitute:async(t,e,i)=>{const a=i.filter(r=>r.counterHolder.getQty("SonicBarrier",t.entity)>0);return a.forEach(r=>{r.counterHolder.removeAll("SonicBarrier",t.entity),t.entity.controller.writeInfoLog(`æ³¢å‹•éŸ³å£ã«ã‚ˆã‚Š${r.toString()}ã¯ï¼‘ã‚¿ãƒ¼ãƒ³ã«ï¼‘åº¦ã ã‘æˆ¦é—˜åŠ¹æžœã§ã¯ç ´å£Šã•ã‚Œãªã„ã€‚`)}),a}}]},yield{name:"çœŸé–ƒç–ç«œ ã‚¹ã‚¿ãƒ¼ãƒ€ã‚¹ãƒˆãƒ»ã‚¯ãƒ­ãƒ‹ã‚¯ãƒ«",actions:[me(t=>t.length===1&&t.every(e=>{var i;return(i=e.status.monsterCategories)==null?void 0:i.includes("Synchro")}),t=>t.length>0&&t.every(e=>{var i;return(i=e.status.monsterCategories)==null?void 0:i.includes("Synchro")})),{title:"æ³¢å‹•è­·é­‚",isMandatory:!1,playType:"QuickEffect",spellSpeed:"Quick",executableCells:H,executablePeriods:D,executableDuelistTypes:["Controller"],executableFaces:["FaceUp"],isOnlyNTimesPerTurnIfFaceup:1,...cr(t=>t.activator.getGraveyard().cardEntities.filter(e=>{var i;return(i=e.status.monsterCategories)==null?void 0:i.includes("Synchro")})),prepare:T,execute:async t=>(t.action.entity.procFilterBundle.push(He.createLingering(t.action.title,e=>e.duel.clock.isSameTurn(e.isSpawnedAt),t.action.entity,t.action,()=>!0,["Effect"],()=>!1)),!0),settle:async()=>!0},{title:"â‘¡è˜‡ç”Ÿ",isMandatory:!1,playType:"TriggerEffect",spellSpeed:"Normal",executableCells:["Banished"],executablePeriods:[...D,...O],executableDuelistTypes:["Controller"],fixedTags:["SpecialSummonFromGraveyard"],meetsConditions:t=>t.action.entity.wasMovedAtPreviousChain&&t.action.entity.moveLog.latestRecord.actionOwner!==t.activator&&(t.action.entity.wasMovedFrom.owner===t.activator||t.action.entity.wasMovedFrom.cellType==="ExtraMonsterZone"),...Ze(t=>t.activator.getBanished().cardEntities.filter(e=>e.kind==="Monster").filter(e=>e.face==="FaceUp").filter(e=>e.types.includes("Dragon")).filter(e=>{var i;return(i=e.status.monsterCategories)==null?void 0:i.includes("Synchro")}).filter(e=>e.canBeTargetOfEffect(t))),settle:async()=>!0}]},yield{name:"è–ç–ç¥žç«œ ã‚¹ã‚¿ãƒ¼ãƒ€ã‚¹ãƒˆãƒ»ã‚·ãƒ•ãƒ«",actions:[me(t=>t.length===1&&t.every(e=>{var i;return(i=e.status.monsterCategories)==null?void 0:i.includes("Synchro")}),t=>t.length>1&&t.every(e=>{var i;return(i=e.status.monsterCategories)==null?void 0:i.includes("Synchro")})),{title:"â‘¡ç–æ³¢å‹•åæ’ƒ",isMandatory:!1,playType:"QuickEffect",spellSpeed:"Quick",executableCells:["Hand"],executablePeriods:D,executableDuelistTypes:["Controller"],executableFaces:["FaceUp"],isOnlyNTimesPerTurnIfFaceup:1,negatePreviousBlock:!0,fixedTags:["NegateCardEffect","DestroyOnField"],canExecute:t=>!!(t.targetChainBlock&&t.targetChainBlock.action.entity.isMonster&&t.targetChainBlock.action.isWithChainBlock&&t.activator!==t.targetChainBlock.activator),prepare:T,execute:async t=>{if(!t.targetChainBlock)return!1;const e=t.targetChainBlock;e.isNegatedEffectBy=t.action;const i=await t.activator.waitSelectEntity(t.action.duel.field.getCardsOnFieldStrictly(),"ç ´å£Šã™ã‚‹ã‚«ãƒ¼ãƒ‰ã‚’é¸æŠžã€‚",!1);return(await _.tryDestroy(i?[i]:[],t)).length>0},settle:async()=>!0},{title:"â‘¢è˜‡ç”Ÿ",isMandatory:!1,playType:"IgnitionEffect",spellSpeed:"Normal",executableCells:["Graveyard"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],executableFaces:["FaceUp"],priorityForNPC:10,fixedTags:["SpecialSummonFromGraveyard"],canPayCosts:Bt,payCosts:hi,...Ze(t=>t.activator.getGraveyard().cardEntities.filter(e=>{var i;return(i=e.status.nameTags)==null?void 0:i.includes("ã‚¹ã‚¿ãƒ¼ãƒ€ã‚¹ãƒˆ")}).filter(e=>(e.lvl??12)<9)),settle:async()=>!0}],substituteEffects:[{title:"æ³¢å‹•è–å¥",playType:"ContinuousEffect",isMandatory:!0,executableCells:["MonsterZone"],executablePeriods:le,executableDuelistTypes:["Controller"],isApplicableTo:(t,e,i)=>i.filter(a=>a.controller===t.entity.controller).filter(a=>a.counterHolder.getQty("SonicVerse",t.entity)===0),substitute:async(t,e,i)=>{if(!t.entity.isEffective)return[];const a=i.filter(r=>r.controller===t.entity.controller).filter(r=>r.counterHolder.getQty("SonicVerse",t.entity)===0);return a.forEach(r=>{r.counterHolder.add("SonicVerse",1,t.entity),t.entity.controller.writeInfoLog(`${t.entity.toString()}ã®åŠ¹æžœã«ã‚ˆã‚Š${r.toString()}ã¯ï¼‘ã‚¿ãƒ¼ãƒ³ã«ï¼‘åº¦ã ã‘ç ´å£Šã•ã‚Œãªã„ã€‚`)}),a}}]}}const ul=Object.freeze(Object.defineProperty({__proto__:null,default:np},Symbol.toStringTag,{value:"Module"}));function*sp(){yield{name:"èª¿å¾‹",actions:[{title:"ç™ºå‹•",isMandatory:!1,playType:"CardActivation",spellSpeed:"Normal",executableCells:["Hand","SpellAndTrapZone"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],fixedTags:["SearchFromDeck","SendToGraveyardFromDeck"],priorityForNPC:40,canExecute:t=>{const e=t.activator.getDeckCell().cardEntities;return e.length<2?!1:e.filter(i=>{var a;return(a=i.status.nameTags)==null?void 0:a.includes("ã‚·ãƒ³ã‚¯ãƒ­ãƒ³")}).some(i=>{var a;return(a=i.status.monsterCategories)==null?void 0:a.includes("Tuner")})},prepare:T,execute:async t=>{const e=t.activator.getDeckCell().cardEntities;if(e.length<2)return!1;const i=e.filter(r=>{var n;return(n=r.status.nameTags)==null?void 0:n.includes("ã‚·ãƒ³ã‚¯ãƒ­ãƒ³")}).filter(r=>{var n;return(n=r.status.monsterCategories)==null?void 0:n.includes("Tuner")});if(i.length===0)return!1;const a=await t.activator.waitSelectEntity(i,"æ‰‹æœ­ã«åŠ ãˆã‚‹ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã‚’é¸æŠž",!1);if(!a)throw new F(t);return await a.addToHand(["Effect"],t.action.entity,t.activator),t.activator.getDeckCell().shuffle(),t.activator.duel.clock.incrementProcSeq(),await t.activator.getDeckCell().cardEntities[0].sendToGraveyard(["Effect"],t.action.entity,t.activator),!0},settle:async()=>!0},b]}}const dl=Object.freeze(Object.defineProperty({__proto__:null,default:sp},Symbol.toStringTag,{value:"Module"}));function*lp(){yield{name:"ãƒ•ã‚©ãƒ¼ãƒŸãƒ¥ãƒ©ãƒ»ã‚·ãƒ³ã‚¯ãƒ­ãƒ³",actions:[me(),{title:"â‘ ãƒ‰ãƒ­ãƒ¼",isMandatory:!1,playType:"TriggerEffect",spellSpeed:"Normal",executableCells:H,executablePeriods:[...D,...O],executableDuelistTypes:["Controller"],fixedTags:["Draw","IfSpecialSummonSucceed"],meetsConditions:t=>t.action.entity.hasBeenArrivalNow(["SynchroSummon"],k,!0),canExecute:t=>t.activator.canDraw&&t.activator.getDeckCell().cardEntities.length>0,prepare:T,execute:async t=>(await t.activator.draw(1,t.action.entity,t.activator),!0),settle:async()=>!0},fs({title:"â‘¡ã‚·ãƒ³ã‚¯ãƒ­å¬å–š",isOnlyNTimesPerChain:1})]}}const fl=Object.freeze(Object.defineProperty({__proto__:null,default:lp},Symbol.toStringTag,{value:"Module"}));function*op(){yield{name:"ãƒˆã‚¥ãƒ¼ãƒ³ãƒ»ãƒ¯ãƒ¼ãƒ«ãƒ‰",actions:[{...lt,canPayCosts:t=>t.activator.lp>=1e3,payCosts:(t,e)=>Ut(t,e,1e3)},b]}}const pl=Object.freeze(Object.defineProperty({__proto__:null,default:op},Symbol.toStringTag,{value:"Module"}));function*cp(){yield{name:"ç„¡ã®ç…‰ç„",actions:[{title:"ç™ºå‹•",isMandatory:!1,playType:"CardActivation",spellSpeed:"Normal",executableCells:["Hand","SpellAndTrapZone"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],fixedTags:["Draw","DiscordAsEffect"],meetsConditions:t=>t.activator.getHandCell().cardEntities.length>2,canExecute:t=>t.activator.canDraw&&t.activator.status.canDiscardAsEffect&&t.activator.getDeckCell().cardEntities.length>0,prepare:T,execute:async t=>(await t.activator.draw(1,t.action.entity,t.activator),t.activator.entity.counterHolder.add("IntoTheVoid",1,t.action.entity),!0),settle:async()=>!0},{title:"æ‰‹æœ­æŠ¹æ®º",isMandatory:!0,playType:"LingeringEffect",spellSpeed:"Normal",executableCells:Me,executablePeriods:["end"],executableDuelistTypes:$t,meetsConditions:t=>t.activator.entity.counterHolder.getQty("IntoTheVoid",t.action.entity)>0,prepare:T,execute:async t=>(await _.discardManyForTheSameReason(t.activator.getHandCell().cardEntities,["Effect"],t.action.entity,t.activator),t.activator.entity.counterHolder.remove("IntoTheVoid",1,t.action.entity),!0),settle:async()=>!0},b]}}const gl=Object.freeze(Object.defineProperty({__proto__:null,default:cp},Symbol.toStringTag,{value:"Module"}));function*up(){yield{name:"æ˜Ÿæ¯ã®å¦–ç²¾ãƒªãƒ¼ã‚¹",actions:[{title:"â‘ ã‚µãƒ¼ãƒ",isMandatory:!1,playType:"TriggerEffect",spellSpeed:"Normal",executableCells:["MonsterZone"],executablePeriods:[...D,...O],executableDuelistTypes:["Controller"],isOnlyNTimesPerTurn:1,fixedTags:["SearchFromDeck"],meetsConditions:t=>t.action.entity.hasBeenArrivalNow(["NormalSummon","SpecialSummon"]),canExecute:t=>t.activator.canAddToHandFromDeck&&t.activator.getDeckCell().cardEntities.filter(e=>e.kind==="Monster").some(e=>{var i;return(i=e.status.nameTags)==null?void 0:i.includes("æ˜Ÿæ¯")}),prepare:async t=>{const e=t.action.entity.hasBeenArrivalNow(["NormalSummon"])?["IfNormarlSummonSucceed"]:["IfSpecialSummonSucceed"];return{selectedEntities:[],chainBlockTags:e}},execute:async t=>{const e=t.activator.getDeckCell().cardEntities.filter(a=>a.kind==="Monster").filter(a=>{var r;return(r=a.status.nameTags)==null?void 0:r.includes("æ˜Ÿæ¯")});if(e.length===0)return!1;const i=await t.activator.waitSelectEntity(e,"æ‰‹æœ­ã«åŠ ãˆã‚‹ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã‚’é¸æŠž",!1);if(!i)throw new S("æƒ³å®šã•ã‚Œãªã„çŠ¶æ…‹",t);return await i.addToHand(["Effect"],t.action.entity,t.activator),t.activator.getDeckCell().shuffle(),!0},settle:async()=>!0},{title:"â‘¡è‡ªå·±ã‚µãƒ«ãƒ™ãƒ¼ã‚¸",isMandatory:!1,playType:"IgnitionEffect",spellSpeed:"Normal",executableCells:["Graveyard"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],executableFaces:["FaceUp"],isOnlyNTimesPerTurn:1,canPayCosts:t=>[...t.activator.getMonstersOnField(),...t.activator.getHandCell().cardEntities.filter(e=>e.kind==="Monster")].some(e=>e.canBeSentToGraveyard(t.activator,t.action.entity,"SendToGraveyardAsCost",t.action)),payCosts:async t=>{const e=[...t.activator.getMonstersOnField(),...t.activator.getHandCell().cardEntities.filter(a=>a.kind==="Monster")].filter(a=>a.canBeSentToGraveyard(t.activator,t.action.entity,"SendToGraveyardAsCost",t.action)),i=await t.activator.waitSelectEntity(e,"å¢“åœ°ã«é€ã‚‹ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã‚’é¸æŠžã€‚",!0);if(i)return await i.sendToGraveyard(["Cost"],t.action.entity,t.activator),{sendToGraveyard:[i]}},fixedTags:["SearchFromDeck"],prepare:T,execute:async t=>t.action.entity.wasMovedAfter(t.isActivatedAt)?!1:(await t.action.entity.addToHand(["Effect"],t.action.entity,t.activator),!0),settle:async()=>!0}]},yield{name:"æ˜Ÿéºç‰©ï¼ã€Žæ˜Ÿæ¯ã€",actions:[{title:"â‘ å¢“åœ°é€ã‚Š",isMandatory:!1,playType:"TriggerEffect",spellSpeed:"Normal",executableCells:["MonsterZone"],executablePeriods:[...D,...O],executableDuelistTypes:["Controller"],canPayCosts:fa,canExecute:t=>t.activator.duel.field.moveLog.getPriviousChainLog().filter(e=>e.movedAs.includes("SpecialSummon")).map(e=>e.entity).some(e=>e.wasMovedFrom.cellType==="ExtraDeck"),payCosts:pa,prepare:T,execute:async t=>{const e=t.activator.duel.field.moveLog.getPriviousChainLog().filter(i=>i.movedAs.includes("SpecialSummon")).map(i=>i.entity).filter(i=>i.wasMovedFrom.cellType==="ExtraDeck").filter(i=>i.isOnFieldAsMonsterStrictly).filter(i=>i.canBeEffected(t.activator,t.action.entity,t.action)).toArray();return await _.sendManyToGraveyardForTheSameReason(e,["Effect"],t.action.entity,t.activator),!0},settle:async()=>!0},{title:"â‘¡ãƒªã‚¯ãƒ«ãƒ¼ãƒˆ",isMandatory:!1,playType:"TriggerEffect",spellSpeed:"Normal",executableCells:["Hand","Graveyard","Banished"],executablePeriods:[...D,...O],executableDuelistTypes:["Controller"],meetsConditions:t=>t.action.entity.wasMovedAtPreviousChain&&t.action.entity.info.summonKinds.includes("NormalSummon")&&t.action.entity.moveLog.previousPlaceRecord.face==="FaceUp",canExecute:t=>{const e=t.activator.getDeckCell().cardEntities.filter(r=>r.kind==="Monster").filter(r=>{var n;return(n=r.status.nameTags)==null?void 0:n.includes("æ˜Ÿæ¯")}).filter(r=>r.nm!=="æ˜Ÿéºç‰©ï¼ã€Žæ˜Ÿæ¯ã€"),i=t.activator.getMonsterZones(),a=t.activator.getEnableSummonList(t.activator,"SpecialSummon",["Effect"],t.action,e.map(r=>({monster:r,cells:i,posList:k})),[],!1);return a.length>1&&a.flatMap(r=>r.cells).getDistinct().length>1},prepare:T,execute:async t=>{const e=t.activator.getDeckCell().cardEntities.filter(r=>r.kind==="Monster").filter(r=>{var n;return(n=r.status.nameTags)==null?void 0:n.includes("æ˜Ÿæ¯")}).filter(r=>r.nm!=="æ˜Ÿéºç‰©ï¼ã€Žæ˜Ÿæ¯ã€"),i=t.activator.getMonsterZones();return(await t.activator.summonMany(t.activator,"SpecialSummon",["Effect"],t.action,e.map(r=>({monster:r,cells:i,posList:k})),[],!1,2,r=>r.length==2,!1)??[]).length?(t.activator.getDeckCell().shuffle(),!0):!1},settle:async()=>!0},{title:"â‘¢ã‚µãƒ¼ãƒ",isMandatory:!1,playType:"IgnitionEffect",spellSpeed:"Normal",executableCells:["Graveyard"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],executableFaces:["FaceUp"],canPayCosts:Bt,meetsConditions:t=>!t.action.entity.wasMovedAtCurrentTurn,canExecute:t=>t.activator.canAddToHandFromDeck&&t.activator.getDeckCell().cardEntities.filter(e=>{var i;return(i=e.status.nameTags)==null?void 0:i.includes("æ˜Ÿéºç‰©")}).length>0,payCosts:hi,fixedTags:["SearchFromDeck"],prepare:T,execute:async t=>{const e=await t.activator.waitSelectEntity(t.activator.getDeckCell().cardEntities.filter(i=>{var a;return(a=i.status.nameTags)==null?void 0:a.includes("æ˜Ÿéºç‰©")}),"æ‰‹æœ­ã«åŠ ãˆã‚‹ã‚«ãƒ¼ãƒ‰ã‚’é¸æŠž",!1);return e?(await e.addToHand(["Effect"],t.action.entity,t.activator),!0):!1},settle:async()=>!0}]}}const hl=Object.freeze(Object.defineProperty({__proto__:null,default:up},Symbol.toStringTag,{value:"Module"}));function*dp(){yield{name:"ãƒ‰ãƒƒãƒˆã‚¹ã‚±ãƒ¼ãƒ‘ãƒ¼",actions:[{title:"â‘ è‡ªå·±å†ç”Ÿ",isMandatory:!1,playType:"TriggerEffect",spellSpeed:"Normal",executableCells:["Graveyard"],executablePeriods:[...D,...O],executableDuelistTypes:["Controller"],isOnlyNTimesPerDuel:1,actionGroupName:"ãƒ‰ãƒƒãƒˆã‚¹ã‚±ãƒ¼ãƒ‘ãƒ¼",fixedTags:["SpecialSummonFromGraveyard"],meetsConditions:t=>t.action.entity.wasMovedAtPreviousChain&&t.action.entity.wasMovedFrom.cellType!=="Banished",canExecute:t=>fe(t,k,[],["Effect"]),prepare:T,execute:Pe,settle:async()=>!0},{title:"â‘¡è‡ªå·±å¸°é‚„",isMandatory:!1,playType:"TriggerEffect",spellSpeed:"Normal",executableCells:["Banished"],executablePeriods:[...D,...O],executableDuelistTypes:["Controller"],isOnlyNTimesPerDuel:1,actionGroupName:"ãƒ‰ãƒƒãƒˆã‚¹ã‚±ãƒ¼ãƒ‘ãƒ¼",fixedTags:["SpecialSummonFromBanished"],meetsConditions:t=>t.action.entity.wasMovedAtPreviousChain,canExecute:t=>fe(t,k,[],["Effect"]),prepare:T,execute:Pe,settle:async()=>!0}]}}const yl=Object.freeze(Object.defineProperty({__proto__:null,default:dp},Symbol.toStringTag,{value:"Module"}));function*fp(){yield{name:"ã‚¼ãƒ©ã®å¤©ä½¿",actions:[me(),{title:"â‘¡è‡ªå·±å¸°é‚„",isMandatory:!0,playType:"IgnitionEffect",spellSpeed:"Normal",executableCells:["Banished"],executablePeriods:["stanby"],executableDuelistTypes:["Controller"],executableFaces:["FaceUp"],fixedTags:["SpecialSummonFromBanished"],meetsConditions:t=>t.action.entity.wasMovedAtPreviousTurn,canExecute:t=>fe(t,k,[],["Effect"]),prepare:T,execute:Pe,settle:async()=>!0}],continuousEffects:[pi("â‘¡æ”»æ’ƒåŠ›ä¸Šæ˜‡","Monster",t=>[t],t=>[ne.createContinuous("â‘ æ”»æ’ƒåŠ›ä¸Šæ˜‡",()=>!0,t,()=>!0,"attack","wip","Addition",(e,i,a)=>e.isEffective?a+e.controller.getOpponentPlayer().getBanished().cardEntities.length*100:a)])]}}const vl=Object.freeze(Object.defineProperty({__proto__:null,default:fp},Symbol.toStringTag,{value:"Module"}));function*pp(){yield{name:"æ­»éœŠé¨Žå£«ãƒ‡ã‚¹ã‚«ãƒªãƒãƒ¼ãƒ»ãƒŠã‚¤ãƒˆ",actions:[{title:"â‘ ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼åŠ¹æžœç„¡åŠ¹",isMandatory:!0,playType:"TriggerEffect",spellSpeed:"Quick",executableCells:H,executablePeriods:[...D,...O],executableDuelistTypes:["Controller"],negatePreviousBlock:!0,canPayCosts:fa,canExecute:t=>!!(t.targetChainBlock&&t.targetChainBlock.action.entity.isMonster&&t.targetChainBlock.action.isWithChainBlock),payCosts:pa,prepare:async(t,e)=>{const i=t.targetChainBlock,a=e[t.index-1];return i!==a?{selectedEntities:[]}:{selectedEntities:[],chainBlockTags:["NegateCardEffect",...t.action.calcChainBlockTagsForDestroy(t.activator,[i.action.entity])],prepared:void 0}},execute:async(t,e)=>{const i=e.find(r=>r.action.entity.isMonster&&r.action.isWithChainBlock),a=e[t.index-1];return a!==i?!1:(a.isNegatedActivationBy=t.action,await _.tryDestroy([a.action.entity],t),!0)},settle:async()=>!0}]},yield{name:"ï¼§ãƒ»ã‚³ã‚¶ãƒƒã‚­ãƒ¼",actions:[{title:"è‡ªæ»…ãƒ€ãƒ¡ãƒ¼ã‚¸",isMandatory:!0,playType:"TriggerEffect",spellSpeed:"Normal",executableCells:ca,executablePeriods:[...D,...O],executableDuelistTypes:["Controller"],triggerPattern:{triggerType:"Departure",from:Se},meetsConditions:t=>t.action.entity.moveLog.previousPlaceRecord.face==="FaceUp",prepare:async t=>t.action.entity.moveLog.previousPlaceRecord.cell.owner!==t.action.entity.controller?{chainBlockTags:["DamageToOpponent"]}:{chainBlockTags:["DamageToSelf"]},execute:async t=>(t.chainBlockTags.includes("DamageToOpponent")?t.activator.getOpponentPlayer():t.activator).effectDamage(t.action.entity.origin.attack??0,t).length>0,settle:async()=>!0}],immediatelyActions:[{title:"è‡ªå£Š",executableCells:["MonsterZone"],executablePeriods:le.filter(t=>t!=="b1DBeforeDmgCalc"&&t!=="b2DBeforeDmgCalc"&&t!=="b1DDmgCalc"&&t!=="b2DDmgCalc"),executableFaces:["FaceUp"],execute:async t=>{t.entity.field.getCardsOnFieldStrictly().some(e=>e.nm==="ã‚³ã‚¶ãƒƒã‚­ãƒ¼")||t.entity.isEffective&&t.entity.isOnFieldAsMonsterStrictly&&(t.entity.controller.writeInfoLog(`ã‚³ã‚¶ãƒƒã‚­ãƒ¼ãŒãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ä¸Šã«å­˜åœ¨ã—ãªã„ãŸã‚ã€${t.entity.toString()}ã¯ç ´å£Šã•ã‚Œã‚‹ã€‚`),_.tryMarkForDestroy([t.entity],{activator:t.entity.controller,action:t,selectedEntities:[]}),t.entity.info.isDying=!0,t.entity.info.causeOfDeath=["Effect","Destroy"])}}]}}const ml=Object.freeze(Object.defineProperty({__proto__:null,default:pp},Symbol.toStringTag,{value:"Module"}));function*gp(){yield{name:"é­”ã‚µã‚¤ã®æˆ¦å£«",actions:[{title:"â‘¡å¢“åœ°é€ã‚Š",isMandatory:!1,playType:"TriggerEffect",spellSpeed:"Normal",executableCells:["Graveyard"],executablePeriods:[...D,...O],executableDuelistTypes:["Controller"],triggerPattern:{triggerType:"Departure"},fixedTags:["SendToGraveyardFromDeck"],isOnlyNTimesPerTurn:1,canExecute:t=>t.activator.getDeckCell().cardEntities.some(e=>e.types.includes("Fiend")),prepare:T,execute:async t=>{const e=t.activator.getDeckCell().cardEntities.filter(a=>a.types.includes("Fiend"));if(!e.length)return!1;const i=await t.activator.waitSelectEntity(e,"å¢“åœ°ã«é€ã‚‹ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã‚’é¸æŠžã€‚",!1);if(!i)throw new F(t);return await i.sendToGraveyard(["Effect"],t.action.entity,t.activator),t.activator.getDeckCell().shuffle(),!0},settle:async()=>!0}],continuousEffects:[Gn("â‘ ç ´å£Šè€æ€§ä»˜ä¸Ž","Monster",t=>[He.createContinuous("â‘ ç ´å£Šè€æ€§ä»˜ä¸Ž",()=>!0,t,(e,i)=>i.types.includes("Fiend")&&i.face==="FaceUp"&&i.isOnFieldAsMonsterStrictly&&i.nm!=="é­”ã‚µã‚¤ã®æˆ¦å£«",["EffectDestroy","BattleDestroy"],()=>!1)])]}}const Sl=Object.freeze(Object.defineProperty({__proto__:null,default:gp},Symbol.toStringTag,{value:"Module"}));function*hp(){yield{name:"å¬å–šåƒ§ã‚µãƒ¢ãƒ³ãƒ—ãƒªãƒ¼ã‚¹ãƒˆ",actions:[{title:"â‘ è¡¨ç¤ºå½¢å¼å¤‰æ›´",isMandatory:!0,playType:"TriggerEffect",spellSpeed:"Normal",executableCells:["MonsterZone"],executablePeriods:[...D,...O],executableDuelistTypes:["Controller"],meetsConditions:t=>t.action.entity.hasBeenArrivalNow(["NormalSummon","FlipSummon"]),fixedTags:["IfNormarlSummonSucceed"],prepare:T,execute:async t=>t.action.entity.battlePosition!=="Attack"||!t.action.entity.isOnFieldAsMonsterStrictly?!1:(await t.action.entity.setBattlePosition("Defense",["Effect"],t.action.entity,t.activator),!0),settle:async()=>!0},{title:"â‘¢ãƒªã‚¯ãƒ«ãƒ¼ãƒˆ",isMandatory:!1,playType:"IgnitionEffect",spellSpeed:"Normal",executableCells:["MonsterZone"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],executableFaces:["FaceUp"],isOnlyNTimesPerTurnIfFaceup:1,fixedTags:["SpecialSummonFromDeck"],canPayCosts:t=>t.activator.status.canDiscardAsCost?t.activator.getHandCell().cardEntities.some(e=>e.kind==="Spell"):!1,canExecute:t=>{const e=t.activator.getDeckCell().cardEntities.filter(r=>r.kind==="Monster").filter(r=>r.lvl===4),i=t.activator.getMonsterZones();return t.activator.getEnableSummonList(t.activator,"SpecialSummon",["Effect"],t.action,e.map(r=>({monster:r,posList:k,cells:i})),[],!1).length>0},payCosts:async(t,e,i)=>{const a=t.activator.getHandCell().cardEntities.filter(n=>n.kind==="Spell"),r=await t.activator.waitSelectEntity(a,"æ‰‹æœ­ã‚³ã‚¹ãƒˆã‚’é¸æŠž",i);if(!r&&!i)throw new F(t);if(r)return await r.discard(["Cost"],t.action.entity,t.activator),{discard:[r]}},prepare:T,execute:async t=>{const e=t.activator.getDeckCell().cardEntities.filter(r=>r.lvl===4),i=t.activator.getMonsterZones(),a=await t.activator.summonOne(t.activator,"SpecialSummon",["Effect"],t.action,e.map(r=>({monster:r,posList:k,cells:i})),[],!1,!1);return!a||(a.statusOperatorBundle.push(new oe({title:"æ”»æ’ƒä¸å¯",validateAlive:r=>r.duel.clock.isSameTurn(r.isSpawnedAt),isContinuous:!1,isSpawnedBy:t.action.entity,actionAttr:t.action,isApplicableTo:()=>!0,statusCalculator:()=>({canAttack:!1})})),!a)?!1:(t.activator.getDeckCell().shuffle(),!0)},settle:async()=>!0}],continuousEffects:[da("â‘¡ãƒªãƒªãƒ¼ã‚¹ä¸å¯","Monster",t=>[t],t=>[He.createContinuous("â‘¡ãƒªãƒªãƒ¼ã‚¹ä¸å¯",()=>!0,t,()=>!0,["AdvanceSummonRelease","ReleaseAsEffect","ReleaseAsCost"],()=>!1)])]}}const _l=Object.freeze(Object.defineProperty({__proto__:null,default:hp},Symbol.toStringTag,{value:"Module"}));function*yp(){yield{name:"ã‚¢ãƒ³ã‚«ãƒ¢ãƒ•ãƒ©ã‚¤ãƒˆ",actions:[lt,{title:"ç‰¹æ®Šå¬å–š",isMandatory:!1,playType:"SpecialSummon",spellSpeed:"Normal",executableCells:["ExtraDeck"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],isOnlyNTimesPerDuel:1,meetsConditions:t=>t.activator.getExtraDeck().cardEntities.every(e=>e.nm==="ã‚¢ãƒ³ã‚«ãƒ¢ãƒ•ãƒ©ã‚¤ãƒˆ"),canExecute:t=>t.action.entity.face==="FaceUp"&&fe(t,k,[],["Rule"]),getDests:t=>Ot(t,k,[],["Rule"]),prepare:t=>ot(t,"SpecialSummon",["SpecialSummon","Rule"],k),execute:ct,settle:async()=>!0},{title:"â‘ ãƒ‰ãƒ­ãƒ¼",isMandatory:!1,playType:"IgnitionEffect",spellSpeed:"Normal",executableCells:["SpellAndTrapZone"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],executableFaces:["FaceUp"],priorityForNPC:20,isOnlyNTimesPerTurn:1,fixedTags:["DestroySpellTrapOnField","Draw"],meetsConditions:t=>t.activator.getExtraDeck().cardEntities.every(e=>e.nm==="ã‚¢ãƒ³ã‚«ãƒ¢ãƒ•ãƒ©ã‚¤ãƒˆ"),canExecute:t=>t.activator.getDeckCell().cardEntities.length>0&&t.activator.canDraw,prepare:async()=>({selectedEntities:[]}),execute:async t=>(await _.tryDestroy([t.action.entity],t)).length?(t.action.entity.field.duel.clock.incrementProcSeq(),await t.activator.draw(1,t.action.entity,t.activator),!0):!1,settle:async()=>!0}],summonFilter:(t,e,i,a,r,n,s,l,o,u)=>{const d={posList:o,cells:u},f={posList:[],cells:[]};return s!==e||n.entity===e?d:f},continuousEffects:[ni("é™¤å¤–äºˆå®š","Monster",t=>[t],t=>[new oe({title:"é™¤å¤–äºˆå®š",validateAlive:()=>!0,isContinuous:!0,isSpawnedBy:t,actionAttr:{},isApplicableTo:(e,i)=>i.isOnFieldAsMonsterStrictly&&i.face==="FaceUp",statusCalculator:()=>({willBeBanished:!0})})])]}}const Tl=Object.freeze(Object.defineProperty({__proto__:null,default:yp},Symbol.toStringTag,{value:"Module"}));function*vp(){yield{name:"ã‚¨ã‚­ã‚»ãƒ³ãƒˆãƒªãƒƒã‚¯ãƒ»ãƒœãƒ¼ã‚¤",actions:[],summonFilter:(t,e,i,a,r,n,s,l,o,u)=>{const d={posList:o,cells:u},f={posList:[],cells:[]};if(!r.includes("SynchroSummon"))return d;const p=l.find(h=>h.material===t.isSpawnedBy);return p?!p.cell.isMonsterZoneLikeCell||l.length!==2?f:l.filter(h=>h!==p).every(h=>h.cell.cellType==="Hand")?d:f:d},defaultStatus:{allowHandSynchro:!0},onUsedAsMaterial:(t,e,i)=>{i.info.summonKinds.includes("SynchroSummon")&&(e.action.entity.statusOperatorBundle.push(new oe({title:"é™¤å¤–äºˆå®š",validateAlive:()=>!0,isContinuous:!1,isSpawnedBy:t,actionAttr:e.action,isApplicableTo:(a,r)=>r.isOnFieldAsMonsterStrictly&&r.face==="FaceUp",statusCalculator:()=>({willBeBanished:!0})})),i.info.isEffectiveIn=i.info.isEffectiveIn.filter(a=>a!=="ExtraMonsterZone").filter(a=>a!=="MonsterZone"))}}}const Cl=Object.freeze(Object.defineProperty({__proto__:null,default:vp},Symbol.toStringTag,{value:"Module"})),mp={title:"ãƒšãƒ³ãƒ‡ãƒ¥ãƒ©ãƒ å¬å–š",isMandatory:!1,playType:"SpecialSummon",spellSpeed:"Normal",executableCells:["Hand"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],isOnlyNTimesPerTurn:1,canExecute:t=>{const e=t.activator.getPendulumScales();if(!e||e.upperBound-e.lowerBound<2)return!1;const i=[...t.activator.getHandCell().cardEntities.filter(n=>n.kind==="Monster"),...t.activator.getExtraDeck().cardEntities.filter(n=>n.face==="FaceUp")].filter(n=>n.kind==="Monster").filter(n=>n.lvl&&n.lvl>e.lowerBound).filter(n=>n.lvl&&n.lvl<e.upperBound);if(!i.length)return!1;const a=[...t.activator.getMonsterZones(),...t.activator.getAvailableMonsterZones()];return t.activator.getEnableSummonList(t.activator,"PendulumSummon",["Rule"],t.action,i.map(n=>({monster:n,cells:a,posList:k})),[],!1).length>0},prepare:async t=>{const e=t.activator.getPendulumScales();if(!e||e.upperBound-e.lowerBound<2)return;const i=[...t.activator.getHandCell().cardEntities.filter(r=>r.kind==="Monster"),...t.activator.getExtraDeck().cardEntities.filter(r=>r.face==="FaceUp")].filter(r=>r.kind==="Monster").filter(r=>r.lvl&&r.lvl>e.lowerBound).filter(r=>r.lvl&&r.lvl<e.upperBound);if(!i.length)return;const a=[...t.activator.getMonsterZones(),...t.activator.getAvailableExtraMonsterZones()];return await t.activator.summonMany(t.activator,"PendulumSummon",["Rule"],t.action,i.map(r=>({monster:r,posList:k,cells:a})),[],!1,void 0,r=>r.length>0,!1),T()},execute:async t=>{for(const e of t.activator.getPendingMonstersOnField())await e.determine();return!0},settle:async()=>!0},Sp={title:"å¼·åˆ¶å‹åˆ©",isMandatory:!0,playType:"LingeringEffect",spellSpeed:"Normal",executableCells:["Hand"],executablePeriods:["main2"],executableDuelistTypes:["Controller"],isOnlyNTimesPerTurn:1,canExecute:t=>t.activator.duel.clock.turn>1,prepare:async t=>(await _.sendManyToGraveyardForTheSameReason(t.activator.duel.field.getCardsOnFieldStrictly(),["Rule"],t.action.entity,t.activator),{selectedEntities:[],nextChainBlockFilter:()=>!1}),execute:async t=>{const e=[{name:"å°å°ã•ã‚Œã—è€…ã®å·¦è¶³",column:4},{name:"å°å°ã•ã‚Œã—è€…ã®å³è¶³",column:2},{name:"å°å°ã•ã‚Œã—è€…ã®å·¦è…•",column:5},{name:"å°å°ã•ã‚Œã—è€…ã®å³è…•",column:1},{name:"å°å°ã•ã‚Œã—ã‚¨ã‚¯ã‚¾ãƒ‡ã‚£ã‚¢",column:3}];for(const i of e){const a=[t.activator.duel.field.getAllCardEntities().filter(r=>r.owner===t.activator).find(r=>r.origin.name===i.name),t.activator.getOpponentPlayer().getHandCell().cardEntities.find(r=>r.origin.name===i.name)].filter(r=>r!==void 0);if(!a.length)throw new S("æƒ³å®šã•ã‚Œãªã„çŠ¶æ…‹",t.activator.getHandCell().cardEntities,i.name);await Z.moveMany(a.map(r=>({entity:r,to:r.controller.getMonsterZones().find(n=>n.column===(r.controller.seat==="Above"?6-i.column:i.column))??r.controller.getFieldZone(),kind:"Monster",face:"FaceUp",orientation:"Vertical",pos:"Top",movedAs:["Rule"],movedBy:void 0,actionOwner:void 0,chooser:void 0})))}throw new re(t.activator,`${t.activator.getOpponentPlayer().name}ãŒãƒ¯ãƒ³ã‚¿ãƒ¼ãƒ³ã‚­ãƒ«ã«å¤±æ•—ã—ãŸã€‚`)},settle:async()=>!0},_p=t=>{const e=[mp];return t.profile.npcType==="FtkChallenge"&&e.push(Sp),{name:t.profile.name,actions:e,staticInfo:{name:t.profile.name,kind:"Monster",wikiEncodedName:"%A5%D7%A5%EC%A5%A4%A5%E4%A1%BC"}}},nt=t=>t.type==="Name",Tp=t=>t.type==="Filter",Cp=t=>t.type==="Overmuch";function*wp(){const t={...Object.assign({"/src/ygo_entity_proc/card_proc_definitions/CardProcDefinitions_ContinuousSpell.ts":is,"/src/ygo_entity_proc/card_proc_definitions/CardProcDefinitions_ContinuousTrap.ts":as,"/src/ygo_entity_proc/card_proc_definitions/CardProcDefinitions_CounterTrap.ts":rs,"/src/ygo_entity_proc/card_proc_definitions/CardProcDefinitions_EquipSpell.ts":ns,"/src/ygo_entity_proc/card_proc_definitions/CardProcDefinitions_EquipSpell_Preset.ts":ss,"/src/ygo_entity_proc/card_proc_definitions/CardProcDefinitions_FieldSpell.ts":ls,"/src/ygo_entity_proc/card_proc_definitions/CardProcDefinitions_FieldSpell_Preset.ts":os,"/src/ygo_entity_proc/card_proc_definitions/CardProcDefinitions_FusionMonster.ts":cs,"/src/ygo_entity_proc/card_proc_definitions/CardProcDefinitions_LinkMonster.ts":ps,"/src/ygo_entity_proc/card_proc_definitions/CardProcDefinitions_Monster.ts":gs,"/src/ygo_entity_proc/card_proc_definitions/CardProcDefinitions_Monster_Preset_Catapult.ts":hs,"/src/ygo_entity_proc/card_proc_definitions/CardProcDefinitions_Monster_Preset_DirectAttacker.ts":ys,"/src/ygo_entity_proc/card_proc_definitions/CardProcDefinitions_Monster_Preset_Recruiter.ts":vs,"/src/ygo_entity_proc/card_proc_definitions/CardProcDefinitions_NormalSpell.ts":ms,"/src/ygo_entity_proc/card_proc_definitions/CardProcDefinitions_NormalSpell_General_Draw.ts":Ss,"/src/ygo_entity_proc/card_proc_definitions/CardProcDefinitions_NormalSpell_General_Mill.ts":_s,"/src/ygo_entity_proc/card_proc_definitions/CardProcDefinitions_NormalSpell_General_Salvage.ts":Ts,"/src/ygo_entity_proc/card_proc_definitions/CardProcDefinitions_NormalSpell_Preset.ts":Cs,"/src/ygo_entity_proc/card_proc_definitions/CardProcDefinitions_NormalTrap.ts":ws,"/src/ygo_entity_proc/card_proc_definitions/CardProcDefinitions_NormalTrap_UponAttackDeclaration.ts":Es,"/src/ygo_entity_proc/card_proc_definitions/CardProcDefinitions_QuickPlaySpell.ts":bs,"/src/ygo_entity_proc/card_proc_definitions/CardProcDefinitions_RitualSpell.ts":Ds,"/src/ygo_entity_proc/card_proc_definitions/CardProcDefinitions_SynchroMonster.ts":xs,"/src/ygo_entity_proc/card_proc_definitions/CardProcDefinitions_TestMonster.ts":As,"/src/ygo_entity_proc/card_proc_definitions/CardProcDefinitions_XyzMonster.ts":Ms}),...Object.assign({"/src/ygo_entity_proc/card_proc_definitions/character_yusei/CardProcDefinitions_Yusei_SynchroTunerMonster.ts":Fs,"/src/ygo_entity_proc/card_proc_definitions/support_fusion/CardProcDefinitions_FustionSubstitude_Monster.ts":Ns,"/src/ygo_entity_proc/card_proc_definitions/support_fusion/CardProcDefinitions_FustionSupport_Monster.ts":Bs,"/src/ygo_entity_proc/card_proc_definitions/support_retual/CardProcDefinitions_RetualSupport_Monster.ts":Ls,"/src/ygo_entity_proc/card_proc_definitions/support_retual/CardProcDefinitions_RetualSupport_NormalSpell.ts":qs,"/src/ygo_entity_proc/card_proc_definitions/tag_b/CardProcDefinitions_BambooSword_EquipSpell.ts":Rs,"/src/ygo_entity_proc/card_proc_definitions/tag_b/CardProcDefinitions_BambooSword_NormalSpell.ts":Hs,"/src/ygo_entity_proc/card_proc_definitions/tag_b/CardProcDefinitions_Blackwing_Monster.ts":Zs,"/src/ygo_entity_proc/card_proc_definitions/tag_c/CardProcDefinitions_Crystron_LinkMonster.ts":Gs,"/src/ygo_entity_proc/card_proc_definitions/tag_d/CardProcDefinitions_DestinyHero_Monster.ts":$s,"/src/ygo_entity_proc/card_proc_definitions/tag_e/CardProcDefinitions_ElementalHero_Monster.ts":Us,"/src/ygo_entity_proc/card_proc_definitions/tag_e/CardProcDefinitions_Endymion_LinkMonster.ts":js,"/src/ygo_entity_proc/card_proc_definitions/tag_e/CardProcDefinitions_Exodia_Monster.ts":zs,"/src/ygo_entity_proc/card_proc_definitions/tag_f/CardProcDefinitions_FallenOfAlbaz_FusionMonster.ts":Vs,"/src/ygo_entity_proc/card_proc_definitions/tag_f/CardProcDefinitions_FallenOfAlbaz_Monster.ts":Ws,"/src/ygo_entity_proc/card_proc_definitions/tag_f/CardProcDefinitions_FallenOfAlbaz_NormalSpell.ts":Qs,"/src/ygo_entity_proc/card_proc_definitions/tag_f/CardProcDefinitions_FallenOfAlbaz_NormalTrap.ts":Xs,"/src/ygo_entity_proc/card_proc_definitions/tag_f/CardProcDefinitions_Firewall_LinkMonster.ts":Ks,"/src/ygo_entity_proc/card_proc_definitions/tag_f/CardProcDefinitions_Fusion_NormalSpell.ts":Ys,"/src/ygo_entity_proc/card_proc_definitions/tag_i/CardProcDefinitions_Igknight_Monster.ts":Js,"/src/ygo_entity_proc/card_proc_definitions/tag_j/CardProcDefinitions_Junk_Monster.ts":Is,"/src/ygo_entity_proc/card_proc_definitions/tag_l/CardProcDefinitions_Lightsworn_LinkMonster.ts":el,"/src/ygo_entity_proc/card_proc_definitions/tag_l/CardProcDefinitions_Lightsworn_NormalSpell.ts":tl,"/src/ygo_entity_proc/card_proc_definitions/tag_l/CardProcDefinitions_Lightsworn_Rk4_XyzMonster.ts":il,"/src/ygo_entity_proc/card_proc_definitions/tag_l/CardProcDefinitions_Lightsworn_lv3_Monster.ts":al,"/src/ygo_entity_proc/card_proc_definitions/tag_l/CardProcDefinitions_Lightsworn_lv4_Monster.ts":rl,"/src/ygo_entity_proc/card_proc_definitions/tag_l/CardProcDefinitions_Lightsworn_lv8_SynchroMonster.ts":nl,"/src/ygo_entity_proc/card_proc_definitions/tag_m/CardProcDefinitions_Metalfoes_Monster.ts":sl,"/src/ygo_entity_proc/card_proc_definitions/tag_m/CardProcDefinitions_Metalfoes_NormalSpell.ts":ll,"/src/ygo_entity_proc/card_proc_definitions/tag_r/CardProcDefinitions_Resonator_Monster.ts":ol,"/src/ygo_entity_proc/card_proc_definitions/tag_s/CardProcDefinitions_SpellCounter_Monster.ts":cl,"/src/ygo_entity_proc/card_proc_definitions/tag_s/CardProcDefinitions_Stardust_Monster.ts":ul,"/src/ygo_entity_proc/card_proc_definitions/tag_s/CardProcDefinitions_Synchron_NormalSpell.ts":dl,"/src/ygo_entity_proc/card_proc_definitions/tag_s/CardProcDefinitions_Synchron_SynchroMonster.ts":fl,"/src/ygo_entity_proc/card_proc_definitions/tag_t/CardProcDefinitions_Toon_ContinuousSpell.ts":pl,"/src/ygo_entity_proc/card_proc_definitions/tag_v/CardProcDefinitions_Void_NormalSpell.ts":gl,"/src/ygo_entity_proc/card_proc_definitions/tag_w/CardProcDefinitions_WorldChalice_Monster.ts":hl,"/src/ygo_entity_proc/card_proc_definitions/type_Cyberse/CardProcDefinitions_Earth_Cyberse_lvl1_Monster.ts":yl,"/src/ygo_entity_proc/card_proc_definitions/type_Fairy/CardProcDefinitions_Light_Fairy_lvl8_SynchroMonster.ts":vl,"/src/ygo_entity_proc/card_proc_definitions/type_Fiend/CardProcDefinitions_Dark_Fiend_lvl4_Monster.ts":ml,"/src/ygo_entity_proc/card_proc_definitions/type_Fiend/CardProcDefinitions_Earth_Fiend_lvl3_Monster.ts":Sl,"/src/ygo_entity_proc/card_proc_definitions/type_Spellcaster/CardProcDefinitions_Dark_Spellcaster_lvl4_Monster.ts":_l,"/src/ygo_entity_proc/card_proc_definitions/type_Spellcaster/CardProcDefinitions_Light_Spellcaster_lvl5_PendulumMonster.ts":Tl,"/src/ygo_entity_proc/card_proc_definitions/type_Spellcaster/CardProcDefinitions_Wind_Spellcaster_lvl3_Monster.ts":Cl})};for(const e of Object.keys(t))t[e].default&&(yield*t[e].default())}function*Ep(...t){var a,r;const e={...Object.assign({"/src/ygo_entity_proc/card_proc_definitions/CardProcDefinitions_ContinuousSpell.ts":is,"/src/ygo_entity_proc/card_proc_definitions/CardProcDefinitions_ContinuousTrap.ts":as,"/src/ygo_entity_proc/card_proc_definitions/CardProcDefinitions_CounterTrap.ts":rs,"/src/ygo_entity_proc/card_proc_definitions/CardProcDefinitions_EquipSpell.ts":ns,"/src/ygo_entity_proc/card_proc_definitions/CardProcDefinitions_EquipSpell_Preset.ts":ss,"/src/ygo_entity_proc/card_proc_definitions/CardProcDefinitions_FieldSpell.ts":ls,"/src/ygo_entity_proc/card_proc_definitions/CardProcDefinitions_FieldSpell_Preset.ts":os,"/src/ygo_entity_proc/card_proc_definitions/CardProcDefinitions_FusionMonster.ts":cs,"/src/ygo_entity_proc/card_proc_definitions/CardProcDefinitions_LinkMonster.ts":ps,"/src/ygo_entity_proc/card_proc_definitions/CardProcDefinitions_Monster.ts":gs,"/src/ygo_entity_proc/card_proc_definitions/CardProcDefinitions_Monster_Preset_Catapult.ts":hs,"/src/ygo_entity_proc/card_proc_definitions/CardProcDefinitions_Monster_Preset_DirectAttacker.ts":ys,"/src/ygo_entity_proc/card_proc_definitions/CardProcDefinitions_Monster_Preset_Recruiter.ts":vs,"/src/ygo_entity_proc/card_proc_definitions/CardProcDefinitions_NormalSpell.ts":ms,"/src/ygo_entity_proc/card_proc_definitions/CardProcDefinitions_NormalSpell_General_Draw.ts":Ss,"/src/ygo_entity_proc/card_proc_definitions/CardProcDefinitions_NormalSpell_General_Mill.ts":_s,"/src/ygo_entity_proc/card_proc_definitions/CardProcDefinitions_NormalSpell_General_Salvage.ts":Ts,"/src/ygo_entity_proc/card_proc_definitions/CardProcDefinitions_NormalSpell_Preset.ts":Cs,"/src/ygo_entity_proc/card_proc_definitions/CardProcDefinitions_NormalTrap.ts":ws,"/src/ygo_entity_proc/card_proc_definitions/CardProcDefinitions_NormalTrap_UponAttackDeclaration.ts":Es,"/src/ygo_entity_proc/card_proc_definitions/CardProcDefinitions_QuickPlaySpell.ts":bs,"/src/ygo_entity_proc/card_proc_definitions/CardProcDefinitions_RitualSpell.ts":Ds,"/src/ygo_entity_proc/card_proc_definitions/CardProcDefinitions_SynchroMonster.ts":xs,"/src/ygo_entity_proc/card_proc_definitions/CardProcDefinitions_TestMonster.ts":As,"/src/ygo_entity_proc/card_proc_definitions/CardProcDefinitions_XyzMonster.ts":Ms}),...Object.assign({"/src/ygo_entity_proc/card_proc_definitions/character_yusei/CardProcDefinitions_Yusei_SynchroTunerMonster.ts":Fs,"/src/ygo_entity_proc/card_proc_definitions/support_fusion/CardProcDefinitions_FustionSubstitude_Monster.ts":Ns,"/src/ygo_entity_proc/card_proc_definitions/support_fusion/CardProcDefinitions_FustionSupport_Monster.ts":Bs,"/src/ygo_entity_proc/card_proc_definitions/support_retual/CardProcDefinitions_RetualSupport_Monster.ts":Ls,"/src/ygo_entity_proc/card_proc_definitions/support_retual/CardProcDefinitions_RetualSupport_NormalSpell.ts":qs,"/src/ygo_entity_proc/card_proc_definitions/tag_b/CardProcDefinitions_BambooSword_EquipSpell.ts":Rs,"/src/ygo_entity_proc/card_proc_definitions/tag_b/CardProcDefinitions_BambooSword_NormalSpell.ts":Hs,"/src/ygo_entity_proc/card_proc_definitions/tag_b/CardProcDefinitions_Blackwing_Monster.ts":Zs,"/src/ygo_entity_proc/card_proc_definitions/tag_c/CardProcDefinitions_Crystron_LinkMonster.ts":Gs,"/src/ygo_entity_proc/card_proc_definitions/tag_d/CardProcDefinitions_DestinyHero_Monster.ts":$s,"/src/ygo_entity_proc/card_proc_definitions/tag_e/CardProcDefinitions_ElementalHero_Monster.ts":Us,"/src/ygo_entity_proc/card_proc_definitions/tag_e/CardProcDefinitions_Endymion_LinkMonster.ts":js,"/src/ygo_entity_proc/card_proc_definitions/tag_e/CardProcDefinitions_Exodia_Monster.ts":zs,"/src/ygo_entity_proc/card_proc_definitions/tag_f/CardProcDefinitions_FallenOfAlbaz_FusionMonster.ts":Vs,"/src/ygo_entity_proc/card_proc_definitions/tag_f/CardProcDefinitions_FallenOfAlbaz_Monster.ts":Ws,"/src/ygo_entity_proc/card_proc_definitions/tag_f/CardProcDefinitions_FallenOfAlbaz_NormalSpell.ts":Qs,"/src/ygo_entity_proc/card_proc_definitions/tag_f/CardProcDefinitions_FallenOfAlbaz_NormalTrap.ts":Xs,"/src/ygo_entity_proc/card_proc_definitions/tag_f/CardProcDefinitions_Firewall_LinkMonster.ts":Ks,"/src/ygo_entity_proc/card_proc_definitions/tag_f/CardProcDefinitions_Fusion_NormalSpell.ts":Ys,"/src/ygo_entity_proc/card_proc_definitions/tag_i/CardProcDefinitions_Igknight_Monster.ts":Js,"/src/ygo_entity_proc/card_proc_definitions/tag_j/CardProcDefinitions_Junk_Monster.ts":Is,"/src/ygo_entity_proc/card_proc_definitions/tag_l/CardProcDefinitions_Lightsworn_LinkMonster.ts":el,"/src/ygo_entity_proc/card_proc_definitions/tag_l/CardProcDefinitions_Lightsworn_NormalSpell.ts":tl,"/src/ygo_entity_proc/card_proc_definitions/tag_l/CardProcDefinitions_Lightsworn_Rk4_XyzMonster.ts":il,"/src/ygo_entity_proc/card_proc_definitions/tag_l/CardProcDefinitions_Lightsworn_lv3_Monster.ts":al,"/src/ygo_entity_proc/card_proc_definitions/tag_l/CardProcDefinitions_Lightsworn_lv4_Monster.ts":rl,"/src/ygo_entity_proc/card_proc_definitions/tag_l/CardProcDefinitions_Lightsworn_lv8_SynchroMonster.ts":nl,"/src/ygo_entity_proc/card_proc_definitions/tag_m/CardProcDefinitions_Metalfoes_Monster.ts":sl,"/src/ygo_entity_proc/card_proc_definitions/tag_m/CardProcDefinitions_Metalfoes_NormalSpell.ts":ll,"/src/ygo_entity_proc/card_proc_definitions/tag_r/CardProcDefinitions_Resonator_Monster.ts":ol,"/src/ygo_entity_proc/card_proc_definitions/tag_s/CardProcDefinitions_SpellCounter_Monster.ts":cl,"/src/ygo_entity_proc/card_proc_definitions/tag_s/CardProcDefinitions_Stardust_Monster.ts":ul,"/src/ygo_entity_proc/card_proc_definitions/tag_s/CardProcDefinitions_Synchron_NormalSpell.ts":dl,"/src/ygo_entity_proc/card_proc_definitions/tag_s/CardProcDefinitions_Synchron_SynchroMonster.ts":fl,"/src/ygo_entity_proc/card_proc_definitions/tag_t/CardProcDefinitions_Toon_ContinuousSpell.ts":pl,"/src/ygo_entity_proc/card_proc_definitions/tag_v/CardProcDefinitions_Void_NormalSpell.ts":gl,"/src/ygo_entity_proc/card_proc_definitions/tag_w/CardProcDefinitions_WorldChalice_Monster.ts":hl,"/src/ygo_entity_proc/card_proc_definitions/type_Cyberse/CardProcDefinitions_Earth_Cyberse_lvl1_Monster.ts":yl,"/src/ygo_entity_proc/card_proc_definitions/type_Fairy/CardProcDefinitions_Light_Fairy_lvl8_SynchroMonster.ts":vl,"/src/ygo_entity_proc/card_proc_definitions/type_Fiend/CardProcDefinitions_Dark_Fiend_lvl4_Monster.ts":ml,"/src/ygo_entity_proc/card_proc_definitions/type_Fiend/CardProcDefinitions_Earth_Fiend_lvl3_Monster.ts":Sl,"/src/ygo_entity_proc/card_proc_definitions/type_Spellcaster/CardProcDefinitions_Dark_Spellcaster_lvl4_Monster.ts":_l,"/src/ygo_entity_proc/card_proc_definitions/type_Spellcaster/CardProcDefinitions_Light_Spellcaster_lvl5_PendulumMonster.ts":Tl,"/src/ygo_entity_proc/card_proc_definitions/type_Spellcaster/CardProcDefinitions_Wind_Spellcaster_lvl3_Monster.ts":Cl})},i=[];for(const n of Object.values(e))if(n.default){for(const s of n.default())if(t.includes(s.name)){const l={...Ie[s.name]};let o=s.summonFilter;l.kind==="Monster"&&l.monsterCategories&&!s.summonFilter&&l.monsterCategories.union(Mn).length&&(o=$a),s.fusionMaterialInfos&&s.fusionMaterialInfos.some(d=>d.type==="Name")&&(l.textTags=[...l.textTags??[],...s.fusionMaterialInfos.filter(nt).map(d=>d.cardName)]);const u={...s,summonFilter:o,staticInfo:l};(a=l.monsterCategories)!=null&&a.includes("Link")?u.actions=[...ds,...u.actions]:(r=l.monsterCategories)!=null&&r.includes("SpecialSummon")?u.actions=[...ji,...u.actions]:u.actions=[...jr,...s.actions],u.actions.filter(d=>d.fixedTags&&d.fixedTags.some(f=>f.startsWith("SpecialSummon"))&&!d.fixedTags.includes("SpecialSummon")).forEach(d=>{var f;return(f=d.fixedTags)==null?void 0:f.push("SpecialSummon")}),yield u,i.push(s.name)}}yield*t.filter(n=>!i.includes(n)).map(n=>Ie[n]).filter(n=>n).filter(n=>n.kind==="Monster").filter(n=>{var s;return!((s=n.monsterCategories)!=null&&s.includes("Effect"))}).filter(n=>{var s;return!((s=n.monsterCategories)!=null&&s.includes("Pendulum"))}).map(n=>{var s;return i.push(n.name),{name:n.name,actions:(s=n.monsterCategories)!=null&&s.includes("SpecialSummon")?ji:jr,staticInfo:n}}),i.length!==t.length&&console.log(t.filter(n=>!i.includes(n)))}const bp=t=>({..._p(t),staticInfo:{name:t.profile.name,kind:"Monster",wikiEncodedName:"%A5%D7%A5%EC%A5%A4%A5%E4%A1%BC"}}),kp=new Set,za=Ml;let wl=0,El=0;for(const t of wp()){if(kp.has(t.name))throw new Error(`ã‚«ãƒ¼ãƒ‰å®šç¾©é‡è¤‡${t.name}`);za[t.name]&&(za[t.name].isImplemented=!0,wl++)}const Ie=Object.values(za).reduce((t,e)=>{var i;return e.kind==="Monster"&&e.monsterCategories&&!((i=e.monsterCategories)!=null&&i.includes("Effect"))&&!e.monsterCategories.includes("Pendulum")&&(e.isImplemented=!0,El++),e.isForTest&&e.isImplemented,t[e.name]=e,t},{}),pg=wl,gg=El,Va=[{id:-1,name:"ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒƒã‚­ï¼‘",deckType:"NPC",description:"",cardNames:["ã‚¢ãƒ³ãƒŽã‚¦ãƒ³ãƒ»ã‚·ãƒ³ã‚¯ãƒ­ãƒ³","å…­æ­¦è¡†ã®ã”éš å±…","ã‚¸ãƒ£ãƒ³ã‚¯ãƒ»ãƒ•ã‚©ã‚¢ãƒ¼ãƒ‰","ã‚¸ãƒ£ãƒ³ã‚¯ãƒ»ãƒ•ã‚©ã‚¢ãƒ¼ãƒ‰","ã‚¸ãƒ£ãƒ³ã‚¯ãƒ»ãƒ•ã‚©ã‚¢ãƒ¼ãƒ‰","ãƒãƒ¥ãƒ¼ãƒ³ãƒ»ã‚¦ã‚©ãƒªã‚¢ãƒ¼","ãƒãƒ¥ãƒ¼ãƒ³ãƒ»ã‚¦ã‚©ãƒªã‚¢ãƒ¼","ã‚¬ãƒ¼ãƒ‰ãƒ»ã‚ªãƒ–ãƒ»ãƒ•ãƒ¬ãƒ ãƒ™ãƒ«","ã‚¬ãƒ¼ãƒ‰ãƒ»ã‚ªãƒ–ãƒ»ãƒ•ãƒ¬ãƒ ãƒ™ãƒ«","å®ˆè­·ç«œãƒ¦ã‚¹ãƒ†ã‚£ã‚¢","å®ˆè­·ç«œãƒ¦ã‚¹ãƒ†ã‚£ã‚¢","ã‚¨ãƒ³ã‚¸ã‚§ãƒ«ãƒ»ãƒˆãƒ©ãƒ³ãƒšãƒƒã‚¿ãƒ¼","ã‚¨ãƒ³ã‚¸ã‚§ãƒ«ãƒ»ãƒˆãƒ©ãƒ³ãƒšãƒƒã‚¿ãƒ¼","ã‚¸ã‚§ãƒ ãƒŠã‚¤ãƒˆãƒ»ã‚µãƒ•ã‚£ã‚¢","ã‚¸ã‚§ãƒ ãƒŠã‚¤ãƒˆãƒ»ã‚µãƒ•ã‚£ã‚¢","é­‚è™Ž","é­‚è™Ž","æš—é»’ç•Œã®ç•ªå…µ ãƒ¬ãƒ³ã‚¸","æš—é»’ç•Œã®ç•ªå…µ ãƒ¬ãƒ³ã‚¸","ãƒãƒˆãƒ«ãƒ•ãƒƒãƒˆãƒœãƒ¼ãƒ©ãƒ¼","ãƒãƒˆãƒ«ãƒ•ãƒƒãƒˆãƒœãƒ¼ãƒ©ãƒ¼","çƒé¨Žå£«ã®ä¸‰äººå¨˜","çƒé¨Žå£«ã®ä¸‰äººå¨˜","ã‚¨ãƒ³ã‚¸ã‚§ãƒ«ãƒ»ãƒˆãƒ©ãƒ³ãƒšãƒƒã‚¿ãƒ¼","ã‚¨ãƒ³ã‚¸ã‚§ãƒ«ãƒ»ãƒˆãƒ©ãƒ³ãƒšãƒƒã‚¿ãƒ¼","ï¼§æˆ¦éšŠ ã‚·ãƒ£ã‚¤ãƒ³ãƒ–ãƒ©ãƒƒã‚¯","ï¼§æˆ¦éšŠ ã‚·ãƒ£ã‚¤ãƒ³ãƒ–ãƒ©ãƒƒã‚¯","ã—ã‚ƒã‚Šã®è»è²«","ã—ã‚ƒã‚Šã®è»è²«","ã‚¸ãƒ§ãƒ³ã‚°ãƒ«ã‚°ãƒ¼ãƒ«ã®å¹»è¡“å¸«","ã‚¸ãƒ§ãƒ³ã‚°ãƒ«ã‚°ãƒ¼ãƒ«ã®å¹»è¡“å¸«","ã‚¾ãƒ³ãƒ“ãƒ¼ãƒŽ","ã‚¾ãƒ³ãƒ“ãƒ¼ãƒŽ","ãƒ¡ã‚¬ãƒ­ã‚¹ãƒžãƒƒã‚·ãƒ£ãƒ¼ï¼¸","ãƒ¡ã‚¬ãƒ­ã‚¹ãƒžãƒƒã‚·ãƒ£ãƒ¼ï¼¸","ãƒ©ã‚¤ãƒ‰ãƒ­ãƒ³","ãƒ©ã‚¤ãƒ‰ãƒ­ãƒ³","æ©Ÿç•Œé¨Žå£«ã‚¢ãƒ´ãƒ©ãƒ ","æ©Ÿç•Œé¨Žå£«ã‚¢ãƒ´ãƒ©ãƒ ","å¹»ã®ã‚°ãƒªãƒ•ã‚©ãƒ³","å¹»ã®ã‚°ãƒªãƒ•ã‚©ãƒ³","å¹»æ®»ç«œ","å¹»æ®»ç«œ","ã‚¢ãƒ¬ã‚­ã‚µãƒ³ãƒ‰ãƒ©ã‚¤ãƒ‰ãƒ©ã‚´ãƒ³","ã‚¢ãƒ¬ã‚­ã‚µãƒ³ãƒ‰ãƒ©ã‚¤ãƒ‰ãƒ©ã‚´ãƒ³","ã‚¸ã‚§ãƒãƒ†ã‚£ãƒƒã‚¯ãƒ»ãƒ¯ãƒ¼ã‚¦ãƒ«ãƒ•","ã‚¸ã‚§ãƒãƒ†ã‚£ãƒƒã‚¯ãƒ»ãƒ¯ãƒ¼ã‚¦ãƒ«ãƒ•","ã‚µã‚¤ãƒãƒ¼ãƒ»ãƒ‰ãƒ©ã‚´ãƒ³","ãƒ•ãƒ­ã‚¹ãƒˆã‚¶ã‚¦ãƒ«ã‚¹","ãƒ•ãƒ­ã‚¹ãƒˆã‚¶ã‚¦ãƒ«ã‚¹","ãƒ•ãƒ­ã‚¹ãƒˆã‚¶ã‚¦ãƒ«ã‚¹","é’çœ¼ã®ç™½é¾","ãƒžã‚¸ã‚«ãƒ«ãƒ»ã‚¢ãƒ³ãƒ‰ãƒ­ã‚¤ãƒ‰","ãƒžã‚¸ã‚«ãƒ«ãƒ»ã‚¢ãƒ³ãƒ‰ãƒ­ã‚¤ãƒ‰","ãƒžã‚¸ã‚«ãƒ«ãƒ»ã‚¢ãƒ³ãƒ‰ãƒ­ã‚¤ãƒ‰","å¤§åœ°ã®é¨Žå£«ã‚¬ã‚¤ã‚¢ãƒŠã‚¤ãƒˆ","å¤§åœ°ã®é¨Žå£«ã‚¬ã‚¤ã‚¢ãƒŠã‚¤ãƒˆ","å¤§åœ°ã®é¨Žå£«ã‚¬ã‚¤ã‚¢ãƒŠã‚¤ãƒˆ","ã‚¹ã‚¯ãƒ©ãƒƒãƒ—ãƒ»ãƒ‡ã‚¹ãƒ‡ãƒ¼ãƒ¢ãƒ³","ã‚¹ã‚¯ãƒ©ãƒƒãƒ—ãƒ»ãƒ‡ã‚¹ãƒ‡ãƒ¼ãƒ¢ãƒ³","ã‚¹ã‚¯ãƒ©ãƒƒãƒ—ãƒ»ãƒ‡ã‚¹ãƒ‡ãƒ¼ãƒ¢ãƒ³","ã‚¹ã‚¿ãƒ¼ãƒ€ã‚¹ãƒˆãƒ»ãƒ‰ãƒ©ã‚´ãƒ³","ã‚¹ã‚¿ãƒ¼ãƒ€ã‚¹ãƒˆãƒ»ãƒ‰ãƒ©ã‚´ãƒ³","ã‚¹ã‚¿ãƒ¼ãƒ€ã‚¹ãƒˆãƒ»ãƒ‰ãƒ©ã‚´ãƒ³","ãƒŠãƒãƒ¥ãƒ«ãƒ»ã‚¬ã‚ªãƒ‰ãƒ¬ã‚¤ã‚¯","ãƒŠãƒãƒ¥ãƒ«ãƒ»ã‚¬ã‚ªãƒ‰ãƒ¬ã‚¤ã‚¯","ãƒŠãƒãƒ¥ãƒ«ãƒ»ã‚¬ã‚ªãƒ‰ãƒ¬ã‚¤ã‚¯"]},{id:-2,name:"ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒƒã‚­ï¼’",deckType:"NPC",description:"",cardNames:["ã‚¢ãƒ³ãƒŽã‚¦ãƒ³ãƒ»ã‚·ãƒ³ã‚¯ãƒ­ãƒ³","å…­æ­¦è¡†ã®ã”éš å±…","ã‚¸ãƒ£ãƒ³ã‚¯ãƒ»ãƒ•ã‚©ã‚¢ãƒ¼ãƒ‰","ã‚°ãƒ­ãƒ¼ã‚¢ãƒƒãƒ—ãƒ»ãƒãƒ«ãƒ–","ã‚¬ãƒ¼ãƒ‰ãƒ»ã‚ªãƒ–ãƒ»ãƒ•ãƒ¬ãƒ ãƒ™ãƒ«","ä¼èª¬ã®ç™½çŸ³","ä¼èª¬ã®ç™½çŸ³","ä¼èª¬ã®ç™½çŸ³","å®ˆè­·ç«œãƒ¦ã‚¹ãƒ†ã‚£ã‚¢","ã‚®ãƒ£ãƒ©ã‚¯ã‚·ãƒ¼ã‚µãƒ¼ãƒšãƒ³ãƒˆ","ã‚¸ã‚§ãƒã‚¯ã‚¹ãƒ»ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼","ï¼¥ãƒ»ï¼¨ï¼¥ï¼²ï¼¯ ãƒ•ã‚§ã‚¶ãƒ¼ãƒžãƒ³","ï¼¥ãƒ»ï¼¨ï¼¥ï¼²ï¼¯ ãƒãƒ¼ã‚¹ãƒˆãƒ¬ãƒ‡ã‚£","ãƒãƒ¥ãƒ¼ãƒ³ãƒ»ã‚¦ã‚©ãƒªã‚¢ãƒ¼","ï¼¥ãƒ»ï¼¨ï¼¥ï¼²ï¼¯ ã‚¯ãƒ¬ã‚¤ãƒžãƒ³","ï¼¥ãƒ»ï¼¨ï¼¥ï¼²ï¼¯ ã‚¹ãƒ‘ãƒ¼ã‚¯ãƒžãƒ³","ã—ã‚ƒã‚Šã®è»è²«","ã‚¸ãƒ§ãƒ³ã‚°ãƒ«ã‚°ãƒ¼ãƒ«ã®å¹»è¡“å¸«","ã‚¾ãƒ³ãƒ“ãƒ¼ãƒŽ","ã‚¸ã‚§ãƒãƒ†ã‚£ãƒƒã‚¯ãƒ»ãƒ¯ãƒ¼ã‚¦ãƒ«ãƒ•","ãƒ©ã‚¤ãƒˆãƒ­ãƒ¼ãƒ‰ãƒ»ãƒ“ãƒ¼ã‚¹ãƒˆ ã‚¦ã‚©ãƒ«ãƒ•","ã‚µã‚¤ãƒãƒ¼ãƒ»ãƒ‰ãƒ©ã‚´ãƒ³","ã‚µã‚¤ãƒãƒ¼ãƒ»ãƒ‰ãƒ©ã‚´ãƒ³","ã‚µã‚¤ãƒãƒ¼ãƒ»ãƒ‰ãƒ©ã‚´ãƒ³","ãƒ©ãƒ–ãƒ©ãƒ‰ãƒ©ã‚¤ãƒ‰ãƒ©ã‚´ãƒ³","ï¼¤ï¼ï¼¨ï¼¥ï¼²ï¼¯ ãƒ‡ã‚£ã‚¢ãƒœãƒªãƒƒã‚¯ã‚¬ã‚¤","ï¼¤ï¼ï¼¨ï¼¥ï¼²ï¼¯ ãƒ‡ã‚£ã‚¢ãƒœãƒªãƒƒã‚¯ã‚¬ã‚¤","ï¼¤ï¼ï¼¨ï¼¥ï¼²ï¼¯ ãƒ‡ã‚£ã‚¢ãƒœãƒªãƒƒã‚¯ã‚¬ã‚¤","ãƒ•ãƒ­ã‚¹ãƒˆã‚¶ã‚¦ãƒ«ã‚¹","ï¼¥ãƒ»ï¼¨ï¼¥ï¼²ï¼¯ ãƒã‚ªã‚¹","é’çœ¼ã®ç™½é¾","é’çœ¼ã®ç™½é¾","é’çœ¼ã®ç™½é¾","ï¼¥ï¼ã‚¨ãƒžãƒ¼ã‚¸ã‚§ãƒ³ã‚·ãƒ¼ã‚³ãƒ¼ãƒ«","ãŠã‚ã‹ãªåŸ‹è‘¬","ãƒˆãƒ¬ãƒ¼ãƒ‰ãƒ»ã‚¤ãƒ³","ãƒˆãƒ¬ãƒ¼ãƒ‰ãƒ»ã‚¤ãƒ³","ãƒˆãƒ¬ãƒ¼ãƒ‰ãƒ»ã‚¤ãƒ³","é—‡ã®é‡ç”£å·¥å ´","å¼·æ¬²ãªå£º","å¼·æ¬²ãªå£º","å¼·æ¬²ãªå£º","æ­»è€…è˜‡ç”Ÿ","æ­»è€…è˜‡ç”Ÿ","æ­»è€…è˜‡ç”Ÿ","å¬å–šå¸«ã®ã‚¹ã‚­ãƒ«","å¬å–šå¸«ã®ã‚¹ã‚­ãƒ«","å¬å–šå¸«ã®ã‚¹ã‚­ãƒ«","æˆé‡‘ã‚´ãƒ–ãƒªãƒ³","æˆé‡‘ã‚´ãƒ–ãƒªãƒ³","æˆé‡‘ã‚´ãƒ–ãƒªãƒ³","æˆ¦å£«ã®ç”Ÿé‚„","å¢—æ´","èª¿å’Œã®å®æœ­","èª¿å’Œã®å®æœ­","èª¿å’Œã®å®æœ­","å¤©ä½¿ã®æ–½ã—","å¤©ä½¿ã®æ–½ã—","å¤©ä½¿ã®æ–½ã—","è²ªæ¬²ãªå£º","è²ªæ¬²ãªå£º","è²ªæ¬²ãªå£º","ãƒžã‚¸ã‚«ãƒ«ãƒ»ã‚¢ãƒ³ãƒ‰ãƒ­ã‚¤ãƒ‰","ãƒžã‚¸ã‚«ãƒ«ãƒ»ã‚¢ãƒ³ãƒ‰ãƒ­ã‚¤ãƒ‰","ãƒžã‚¸ã‚«ãƒ«ãƒ»ã‚¢ãƒ³ãƒ‰ãƒ­ã‚¤ãƒ‰","å¤§åœ°ã®é¨Žå£«ã‚¬ã‚¤ã‚¢ãƒŠã‚¤ãƒˆ","å¤§åœ°ã®é¨Žå£«ã‚¬ã‚¤ã‚¢ãƒŠã‚¤ãƒˆ","å¤§åœ°ã®é¨Žå£«ã‚¬ã‚¤ã‚¢ãƒŠã‚¤ãƒˆ","ã‚¹ã‚¯ãƒ©ãƒƒãƒ—ãƒ»ãƒ‡ã‚¹ãƒ‡ãƒ¼ãƒ¢ãƒ³","ã‚¹ã‚¯ãƒ©ãƒƒãƒ—ãƒ»ãƒ‡ã‚¹ãƒ‡ãƒ¼ãƒ¢ãƒ³","ã‚¹ã‚¯ãƒ©ãƒƒãƒ—ãƒ»ãƒ‡ã‚¹ãƒ‡ãƒ¼ãƒ¢ãƒ³","ã‚¹ã‚¿ãƒ¼ãƒ€ã‚¹ãƒˆãƒ»ãƒ‰ãƒ©ã‚´ãƒ³","ã‚¹ã‚¿ãƒ¼ãƒ€ã‚¹ãƒˆãƒ»ãƒ‰ãƒ©ã‚´ãƒ³","ã‚¹ã‚¿ãƒ¼ãƒ€ã‚¹ãƒˆãƒ»ãƒ‰ãƒ©ã‚´ãƒ³","ãƒŠãƒãƒ¥ãƒ«ãƒ»ã‚¬ã‚ªãƒ‰ãƒ¬ã‚¤ã‚¯","ãƒŠãƒãƒ¥ãƒ«ãƒ»ã‚¬ã‚ªãƒ‰ãƒ¬ã‚¤ã‚¯","ãƒŠãƒãƒ¥ãƒ«ãƒ»ã‚¬ã‚ªãƒ‰ãƒ¬ã‚¤ã‚¯"]},{id:-3,name:"ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒƒã‚­ï¼“",deckType:"NPC",description:"",cardNames:["ã‚¢ãƒ³ãƒŽã‚¦ãƒ³ãƒ»ã‚·ãƒ³ã‚¯ãƒ­ãƒ³","å…­æ­¦è¡†ã®ã”éš å±…","ã‚¸ãƒ£ãƒ³ã‚¯ãƒ»ãƒ•ã‚©ã‚¢ãƒ¼ãƒ‰","ã‚°ãƒ­ãƒ¼ã‚¢ãƒƒãƒ—ãƒ»ãƒãƒ«ãƒ–","ã‚¬ãƒ¼ãƒ‰ãƒ»ã‚ªãƒ–ãƒ»ãƒ•ãƒ¬ãƒ ãƒ™ãƒ«","ä¼èª¬ã®ç™½çŸ³","ä¼èª¬ã®ç™½çŸ³","ä¼èª¬ã®ç™½çŸ³","å®ˆè­·ç«œãƒ¦ã‚¹ãƒ†ã‚£ã‚¢","ã‚®ãƒ£ãƒ©ã‚¯ã‚·ãƒ¼ã‚µãƒ¼ãƒšãƒ³ãƒˆ","ã‚¸ã‚§ãƒã‚¯ã‚¹ãƒ»ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼","ï¼¥ãƒ»ï¼¨ï¼¥ï¼²ï¼¯ ãƒ•ã‚§ã‚¶ãƒ¼ãƒžãƒ³","ï¼¥ãƒ»ï¼¨ï¼¥ï¼²ï¼¯ ãƒãƒ¼ã‚¹ãƒˆãƒ¬ãƒ‡ã‚£","ãƒãƒ¥ãƒ¼ãƒ³ãƒ»ã‚¦ã‚©ãƒªã‚¢ãƒ¼","ï¼¥ãƒ»ï¼¨ï¼¥ï¼²ï¼¯ ã‚¯ãƒ¬ã‚¤ãƒžãƒ³","ï¼¥ãƒ»ï¼¨ï¼¥ï¼²ï¼¯ ã‚¹ãƒ‘ãƒ¼ã‚¯ãƒžãƒ³","ã—ã‚ƒã‚Šã®è»è²«","ã‚¸ãƒ§ãƒ³ã‚°ãƒ«ã‚°ãƒ¼ãƒ«ã®å¹»è¡“å¸«","ã‚¾ãƒ³ãƒ“ãƒ¼ãƒŽ","ã‚¸ã‚§ãƒãƒ†ã‚£ãƒƒã‚¯ãƒ»ãƒ¯ãƒ¼ã‚¦ãƒ«ãƒ•","ãƒ©ã‚¤ãƒˆãƒ­ãƒ¼ãƒ‰ãƒ»ãƒ“ãƒ¼ã‚¹ãƒˆ ã‚¦ã‚©ãƒ«ãƒ•","ã‚µã‚¤ãƒãƒ¼ãƒ»ãƒ‰ãƒ©ã‚´ãƒ³","ã‚µã‚¤ãƒãƒ¼ãƒ»ãƒ‰ãƒ©ã‚´ãƒ³","ã‚µã‚¤ãƒãƒ¼ãƒ»ãƒ‰ãƒ©ã‚´ãƒ³","ãƒ©ãƒ–ãƒ©ãƒ‰ãƒ©ã‚¤ãƒ‰ãƒ©ã‚´ãƒ³","ï¼¤ï¼ï¼¨ï¼¥ï¼²ï¼¯ ãƒ‡ã‚£ã‚¢ãƒœãƒªãƒƒã‚¯ã‚¬ã‚¤","ï¼¤ï¼ï¼¨ï¼¥ï¼²ï¼¯ ãƒ‡ã‚£ã‚¢ãƒœãƒªãƒƒã‚¯ã‚¬ã‚¤","ï¼¤ï¼ï¼¨ï¼¥ï¼²ï¼¯ ãƒ‡ã‚£ã‚¢ãƒœãƒªãƒƒã‚¯ã‚¬ã‚¤","ãƒ•ãƒ­ã‚¹ãƒˆã‚¶ã‚¦ãƒ«ã‚¹","ï¼¥ãƒ»ï¼¨ï¼¥ï¼²ï¼¯ ãƒã‚ªã‚¹","é’çœ¼ã®ç™½é¾","é’çœ¼ã®ç™½é¾","é’çœ¼ã®ç™½é¾","ï¼¥ï¼ã‚¨ãƒžãƒ¼ã‚¸ã‚§ãƒ³ã‚·ãƒ¼ã‚³ãƒ¼ãƒ«","ãŠã‚ã‹ãªåŸ‹è‘¬","ãƒˆãƒ¬ãƒ¼ãƒ‰ãƒ»ã‚¤ãƒ³","ãƒˆãƒ¬ãƒ¼ãƒ‰ãƒ»ã‚¤ãƒ³","ãƒˆãƒ¬ãƒ¼ãƒ‰ãƒ»ã‚¤ãƒ³","é—‡ã®é‡ç”£å·¥å ´","å¼·æ¬²ãªå£º","å¼·æ¬²ãªå£º","å¼·æ¬²ãªå£º","æ­»è€…è˜‡ç”Ÿ","æ­»è€…è˜‡ç”Ÿ","æ­»è€…è˜‡ç”Ÿ","å¬å–šå¸«ã®ã‚¹ã‚­ãƒ«","å¬å–šå¸«ã®ã‚¹ã‚­ãƒ«","å¬å–šå¸«ã®ã‚¹ã‚­ãƒ«","æˆé‡‘ã‚´ãƒ–ãƒªãƒ³","æˆé‡‘ã‚´ãƒ–ãƒªãƒ³","æˆé‡‘ã‚´ãƒ–ãƒªãƒ³","æˆ¦å£«ã®ç”Ÿé‚„","å¢—æ´","èª¿å’Œã®å®æœ­","èª¿å’Œã®å®æœ­","èª¿å’Œã®å®æœ­","å¤©ä½¿ã®æ–½ã—","å¤©ä½¿ã®æ–½ã—","å¤©ä½¿ã®æ–½ã—","è²ªæ¬²ãªå£º","è²ªæ¬²ãªå£º","è²ªæ¬²ãªå£º","ãƒžã‚¸ã‚«ãƒ«ãƒ»ã‚¢ãƒ³ãƒ‰ãƒ­ã‚¤ãƒ‰","ãƒžã‚¸ã‚«ãƒ«ãƒ»ã‚¢ãƒ³ãƒ‰ãƒ­ã‚¤ãƒ‰","ãƒžã‚¸ã‚«ãƒ«ãƒ»ã‚¢ãƒ³ãƒ‰ãƒ­ã‚¤ãƒ‰","å¤§åœ°ã®é¨Žå£«ã‚¬ã‚¤ã‚¢ãƒŠã‚¤ãƒˆ","å¤§åœ°ã®é¨Žå£«ã‚¬ã‚¤ã‚¢ãƒŠã‚¤ãƒˆ","å¤§åœ°ã®é¨Žå£«ã‚¬ã‚¤ã‚¢ãƒŠã‚¤ãƒˆ","ã‚¹ã‚¯ãƒ©ãƒƒãƒ—ãƒ»ãƒ‡ã‚¹ãƒ‡ãƒ¼ãƒ¢ãƒ³","ã‚¹ã‚¯ãƒ©ãƒƒãƒ—ãƒ»ãƒ‡ã‚¹ãƒ‡ãƒ¼ãƒ¢ãƒ³","ã‚¹ã‚¯ãƒ©ãƒƒãƒ—ãƒ»ãƒ‡ã‚¹ãƒ‡ãƒ¼ãƒ¢ãƒ³","ã‚¹ã‚¿ãƒ¼ãƒ€ã‚¹ãƒˆãƒ»ãƒ‰ãƒ©ã‚´ãƒ³","ã‚¹ã‚¿ãƒ¼ãƒ€ã‚¹ãƒˆãƒ»ãƒ‰ãƒ©ã‚´ãƒ³","ã‚¹ã‚¿ãƒ¼ãƒ€ã‚¹ãƒˆãƒ»ãƒ‰ãƒ©ã‚´ãƒ³","ãƒŠãƒãƒ¥ãƒ«ãƒ»ã‚¬ã‚ªãƒ‰ãƒ¬ã‚¤ã‚¯","ãƒŠãƒãƒ¥ãƒ«ãƒ»ã‚¬ã‚ªãƒ‰ãƒ¬ã‚¤ã‚¯","ãƒŠãƒãƒ¥ãƒ«ãƒ»ã‚¬ã‚ªãƒ‰ãƒ¬ã‚¤ã‚¯"]},{id:-9007199254740991,name:"FtkChallenge",deckType:"NPC",description:"FtkChallenge",cardNames:["å°å°ã•ã‚Œã—è€…ã®å³è¶³","å°å°ã•ã‚Œã—è€…ã®å³è…•","å°å°ã•ã‚Œã—è€…ã®å·¦è¶³","å°å°ã•ã‚Œã—è€…ã®å·¦è…•","å°å°ã•ã‚Œã—ã‚¨ã‚¯ã‚¾ãƒ‡ã‚£ã‚¢","ã‚¹ã‚«ã‚´ãƒ–ãƒªãƒ³","ã‚¹ã‚«ã‚´ãƒ–ãƒªãƒ³","ã‚¹ã‚«ã‚´ãƒ–ãƒªãƒ³","ã‚¹ã‚«ã‚´ãƒ–ãƒªãƒ³","ã‚¹ã‚«ã‚´ãƒ–ãƒªãƒ³","ã‚¹ã‚«ã‚´ãƒ–ãƒªãƒ³","ã‚¹ã‚«ã‚´ãƒ–ãƒªãƒ³","ã‚¹ã‚«ã‚´ãƒ–ãƒªãƒ³","ã‚¹ã‚«ã‚´ãƒ–ãƒªãƒ³","ã‚¹ã‚«ã‚´ãƒ–ãƒªãƒ³","ã‚¹ã‚«ã‚´ãƒ–ãƒªãƒ³","ã‚¹ã‚«ã‚´ãƒ–ãƒªãƒ³","ã‚¹ã‚«ã‚´ãƒ–ãƒªãƒ³","ã‚¹ã‚«ã‚´ãƒ–ãƒªãƒ³","ã‚¹ã‚«ã‚´ãƒ–ãƒªãƒ³","ã‚¹ã‚«ã‚´ãƒ–ãƒªãƒ³","ã‚¹ã‚«ã‚´ãƒ–ãƒªãƒ³","ã‚¹ã‚«ã‚´ãƒ–ãƒªãƒ³","ã‚¹ã‚«ã‚´ãƒ–ãƒªãƒ³","ã‚¹ã‚«ã‚´ãƒ–ãƒªãƒ³","ã‚¹ã‚«ã‚´ãƒ–ãƒªãƒ³","ã‚¹ã‚«ã‚´ãƒ–ãƒªãƒ³","ã‚¹ã‚«ã‚´ãƒ–ãƒªãƒ³","ã‚¹ã‚«ã‚´ãƒ–ãƒªãƒ³","ã‚¹ã‚«ã‚´ãƒ–ãƒªãƒ³","ã‚¹ã‚«ã‚´ãƒ–ãƒªãƒ³","ã‚¹ã‚«ã‚´ãƒ–ãƒªãƒ³","ã‚¹ã‚«ã‚´ãƒ–ãƒªãƒ³","ã‚¹ã‚«ã‚´ãƒ–ãƒªãƒ³","ã‚¹ã‚«ã‚´ãƒ–ãƒªãƒ³","ã‚¹ã‚«ã‚´ãƒ–ãƒªãƒ³","ã‚¹ã‚«ã‚´ãƒ–ãƒªãƒ³","ã‚¹ã‚«ã‚´ãƒ–ãƒªãƒ³","ã‚¹ã‚«ã‚´ãƒ–ãƒªãƒ³","ã‚¹ã‚«ã‚´ãƒ–ãƒªãƒ³","ã‚¹ã‚«ã‚´ãƒ–ãƒªãƒ³","ã‚¹ã‚«ã‚´ãƒ–ãƒªãƒ³","ã‚¹ã‚«ã‚´ãƒ–ãƒªãƒ³","ã‚¹ã‚«ã‚´ãƒ–ãƒªãƒ³","ã‚¹ã‚«ã‚´ãƒ–ãƒªãƒ³","ã‚¹ã‚«ã‚´ãƒ–ãƒªãƒ³","ã‚¹ã‚«ã‚´ãƒ–ãƒªãƒ³","ã‚¹ã‚«ã‚´ãƒ–ãƒªãƒ³","ã‚¹ã‚«ã‚´ãƒ–ãƒªãƒ³","ã‚¹ã‚«ã‚´ãƒ–ãƒªãƒ³","ã‚¹ã‚«ã‚´ãƒ–ãƒªãƒ³","ã‚¹ã‚«ã‚´ãƒ–ãƒªãƒ³","ã‚¹ã‚«ã‚´ãƒ–ãƒªãƒ³","ã‚¹ã‚«ã‚´ãƒ–ãƒªãƒ³","ã‚¹ã‚«ã‚´ãƒ–ãƒªãƒ³","ã‚¹ã‚«ã‚´ãƒ–ãƒªãƒ³","ã‚¹ã‚«ã‚´ãƒ–ãƒªãƒ³","ã‚¹ã‚«ã‚´ãƒ–ãƒªãƒ³","ã‚¹ã‚«ã‚´ãƒ–ãƒªãƒ³","ã‚¹ã‚«ã‚´ãƒ–ãƒªãƒ³"]},{id:-9007199254740990,name:"FtkChallenge[HARD]",deckType:"NPC",description:"FtkChallenge[HARD]",cardNames:["å°å°ã•ã‚Œã—è€…ã®å³è¶³","å°å°ã•ã‚Œã—è€…ã®å³è…•","å°å°ã•ã‚Œã—è€…ã®å·¦è¶³","å°å°ã•ã‚Œã—è€…ã®å·¦è…•","å°å°ã•ã‚Œã—ã‚¨ã‚¯ã‚¾ãƒ‡ã‚£ã‚¢","ç°æµã†ã‚‰ã‚‰","ç°æµã†ã‚‰ã‚‰","ç°æµã†ã‚‰ã‚‰","ç°æµã†ã‚‰ã‚‰","ç°æµã†ã‚‰ã‚‰","ç°æµã†ã‚‰ã‚‰","ç°æµã†ã‚‰ã‚‰","ç°æµã†ã‚‰ã‚‰","ç°æµã†ã‚‰ã‚‰","ç°æµã†ã‚‰ã‚‰","ç°æµã†ã‚‰ã‚‰","ç°æµã†ã‚‰ã‚‰","ç°æµã†ã‚‰ã‚‰","ç°æµã†ã‚‰ã‚‰","ç°æµã†ã‚‰ã‚‰","ç°æµã†ã‚‰ã‚‰","ç°æµã†ã‚‰ã‚‰","ç°æµã†ã‚‰ã‚‰","ç°æµã†ã‚‰ã‚‰","ç°æµã†ã‚‰ã‚‰","ç°æµã†ã‚‰ã‚‰","ç°æµã†ã‚‰ã‚‰","ç°æµã†ã‚‰ã‚‰","ç°æµã†ã‚‰ã‚‰","ç°æµã†ã‚‰ã‚‰","ç°æµã†ã‚‰ã‚‰","ç°æµã†ã‚‰ã‚‰","å±‹æ•·ã‚ã‚‰ã—","å±‹æ•·ã‚ã‚‰ã—","å±‹æ•·ã‚ã‚‰ã—","å±‹æ•·ã‚ã‚‰ã—","å±‹æ•·ã‚ã‚‰ã—","å±‹æ•·ã‚ã‚‰ã—","å±‹æ•·ã‚ã‚‰ã—","å±‹æ•·ã‚ã‚‰ã—","å±‹æ•·ã‚ã‚‰ã—","å±‹æ•·ã‚ã‚‰ã—","å±‹æ•·ã‚ã‚‰ã—","å±‹æ•·ã‚ã‚‰ã—","å±‹æ•·ã‚ã‚‰ã—","å±‹æ•·ã‚ã‚‰ã—","å±‹æ•·ã‚ã‚‰ã—","å±‹æ•·ã‚ã‚‰ã—","å±‹æ•·ã‚ã‚‰ã—","å±‹æ•·ã‚ã‚‰ã—","å±‹æ•·ã‚ã‚‰ã—","å±‹æ•·ã‚ã‚‰ã—","å±‹æ•·ã‚ã‚‰ã—","å±‹æ•·ã‚ã‚‰ã—","å±‹æ•·ã‚ã‚‰ã—","å±‹æ•·ã‚ã‚‰ã—","å±‹æ•·ã‚ã‚‰ã—","å±‹æ•·ã‚ã‚‰ã—","å±‹æ•·ã‚ã‚‰ã—","å±‹æ•·ã‚ã‚‰ã—"]},{id:-1e3,name:"å›³æ›¸é¤¨ã‚¨ã‚¯ã‚¾",deckType:"Preset",description:"ãƒ—ãƒªã‚»ãƒƒãƒˆ",cardNames:["å°å°ã•ã‚Œã—è€…ã®å³è¶³","å°å°ã•ã‚Œã—è€…ã®å³è…•","å°å°ã•ã‚Œã—è€…ã®å·¦è¶³","å°å°ã•ã‚Œã—è€…ã®å·¦è…•","å°å°ã•ã‚Œã—ã‚¨ã‚¯ã‚¾ãƒ‡ã‚£ã‚¢","çŽ‹ç«‹é­”æ³•å›³æ›¸é¤¨","çŽ‹ç«‹é­”æ³•å›³æ›¸é¤¨","çŽ‹ç«‹é­”æ³•å›³æ›¸é¤¨","å¬å–šåƒ§ã‚µãƒ¢ãƒ³ãƒ—ãƒªãƒ¼ã‚¹ãƒˆ","å¬å–šåƒ§ã‚µãƒ¢ãƒ³ãƒ—ãƒªãƒ¼ã‚¹ãƒˆ","å¬å–šåƒ§ã‚µãƒ¢ãƒ³ãƒ—ãƒªãƒ¼ã‚¹ãƒˆ","ã‚¢ãƒ³ã‚«ãƒ¢ãƒ•ãƒ©ã‚¤ãƒˆ","é—‡ã®é‡ç”£å·¥å ´","ãƒã‚­ãƒ³ãƒ¬ãƒ¼ã‚¹","ãƒã‚­ãƒ³ãƒ¬ãƒ¼ã‚¹","ãƒã‚­ãƒ³ãƒ¬ãƒ¼ã‚¹","ãƒ†ãƒ©ãƒ»ãƒ•ã‚©ãƒ¼ãƒŸãƒ³ã‚°","ãƒˆã‚¥ãƒ¼ãƒ³ãƒ»ãƒ¯ãƒ¼ãƒ«ãƒ‰","ãƒˆã‚¥ãƒ¼ãƒ³ã®ã‚‚ãã˜","ãƒˆã‚¥ãƒ¼ãƒ³ã®ã‚‚ãã˜","ãƒˆã‚¥ãƒ¼ãƒ³ã®ã‚‚ãã˜","ä¸€æ™‚ä¼‘æˆ¦","é»„é‡‘è‰²ã®ç«¹å…‰","é»„é‡‘è‰²ã®ç«¹å…‰","é»„é‡‘è‰²ã®ç«¹å…‰","æ‰‹æœ­æ–­æ®º","æ‰‹æœ­æ–­æ®º","æ‰‹æœ­æ–­æ®º","çœŸåˆ€ç«¹å…‰","æˆé‡‘ã‚´ãƒ–ãƒªãƒ³","æˆé‡‘ã‚´ãƒ–ãƒªãƒ³","æˆé‡‘ã‚´ãƒ–ãƒªãƒ³","æ‰“ã¡å‡ºã®å°æ§Œ","æ‰“ã¡å‡ºã®å°æ§Œ","ç„¡ã®ç…‰ç„","ç„¡ã®ç…‰ç„","ç„¡ã®ç…‰ç„","å¦–åˆ€ç«¹å…‰","å¦–åˆ€ç«¹å…‰","å¦–åˆ€ç«¹å…‰"]},{id:-2e3,name:"åˆ†ã‹ã¤Gã‚³ã‚¶ãƒƒã‚­ãƒ¼ï¼ˆæ¤œè¨¼ä¸­ï¼‰",deckType:"Preset",description:"ãƒ—ãƒªã‚»ãƒƒãƒˆ",cardNames:["ãƒˆãƒ¯ã‚¤ãƒ©ã‚¤ãƒˆãƒ­ãƒ¼ãƒ‰ãƒ»ã‚·ãƒ£ãƒ¼ãƒžãƒ³ ãƒ«ãƒŸãƒŠã‚¹","ãƒˆãƒ¯ã‚¤ãƒ©ã‚¤ãƒˆãƒ­ãƒ¼ãƒ‰ãƒ»ã‚·ãƒ£ãƒ¼ãƒžãƒ³ ãƒ«ãƒŸãƒŠã‚¹","ãƒ©ã‚¤ãƒˆãƒ­ãƒ¼ãƒ‰ãƒ»ã‚µãƒ¢ãƒŠãƒ¼ ãƒ«ãƒŸãƒŠã‚¹","ãƒ©ã‚¤ãƒˆãƒ­ãƒ¼ãƒ‰ãƒ»ã‚µãƒ¢ãƒŠãƒ¼ ãƒ«ãƒŸãƒŠã‚¹","ãƒ©ã‚¤ãƒˆãƒ­ãƒ¼ãƒ‰ãƒ»ã‚µãƒ¢ãƒŠãƒ¼ ãƒ«ãƒŸãƒŠã‚¹","é­”ã‚µã‚¤ã®æˆ¦å£«","ãƒ©ã‚¤ãƒˆãƒ­ãƒ¼ãƒ‰ãƒ»ãƒ‡ãƒ¼ãƒ¢ãƒ³ ãƒ´ã‚¡ã‚¤ã‚¹","ãƒ©ã‚¤ãƒˆãƒ­ãƒ¼ãƒ‰ãƒ»ãƒ‡ãƒ¼ãƒ¢ãƒ³ ãƒ´ã‚¡ã‚¤ã‚¹","ãƒ©ã‚¤ãƒˆãƒ­ãƒ¼ãƒ‰ãƒ»ãƒ‡ãƒ¼ãƒ¢ãƒ³ ãƒ´ã‚¡ã‚¤ã‚¹","ãƒ©ã‚¤ãƒˆãƒ­ãƒ¼ãƒ‰ãƒ»ã‚¢ãƒ¼ãƒãƒ£ãƒ¼ ãƒ•ã‚§ãƒªã‚¹","ãƒ©ã‚¤ãƒˆãƒ­ãƒ¼ãƒ‰ãƒ»ã‚¢ãƒ¼ãƒãƒ£ãƒ¼ ãƒ•ã‚§ãƒªã‚¹","ãƒ©ã‚¤ãƒˆãƒ­ãƒ¼ãƒ‰ãƒ»ã‚¢ãƒ¼ãƒãƒ£ãƒ¼ ãƒ•ã‚§ãƒªã‚¹","å…‰é“ã®é¾","å…‰é“ã®é¾","å…‰é“ã®é¾","ãƒ©ã‚¤ãƒˆãƒ­ãƒ¼ãƒ‰ãƒ»ãƒžã‚¸ã‚·ãƒ£ãƒ³ ãƒ©ã‚¤ãƒ©","ãƒ©ã‚¤ãƒˆãƒ­ãƒ¼ãƒ‰ãƒ»ã‚¢ã‚µã‚·ãƒ³ ãƒ©ã‚¤ãƒ‡ãƒ³","ãƒ©ã‚¤ãƒˆãƒ­ãƒ¼ãƒ‰ãƒ»ãƒ“ãƒ¼ã‚¹ãƒˆ ã‚¦ã‚©ãƒ«ãƒ•","ãƒ©ã‚¤ãƒˆãƒ­ãƒ¼ãƒ‰ãƒ»ãƒ“ãƒ¼ã‚¹ãƒˆ ã‚¦ã‚©ãƒ«ãƒ•","ãƒ©ã‚¤ãƒˆãƒ­ãƒ¼ãƒ‰ãƒ»ãƒ“ãƒ¼ã‚¹ãƒˆ ã‚¦ã‚©ãƒ«ãƒ•","ï¼§ãƒ»ã‚³ã‚¶ãƒƒã‚­ãƒ¼","ã‚¸ãƒ£ãƒ³ã‚¯ãƒ»ã‚³ãƒ¬ã‚¯ã‚¿ãƒ¼","é»’è¡£ç«œã‚¢ãƒ«ãƒ“ã‚ªãƒ³","é»’è¡£ç«œã‚¢ãƒ«ãƒ“ã‚ªãƒ³","ãŠã‚ã‹ãªåŸ‹è‘¬","ã‚½ãƒ¼ãƒ©ãƒ¼ãƒ»ã‚¨ã‚¯ã‚¹ãƒã‚§ãƒ³ã‚¸","ã‚½ãƒ¼ãƒ©ãƒ¼ãƒ»ã‚¨ã‚¯ã‚¹ãƒã‚§ãƒ³ã‚¸","ã‚½ãƒ¼ãƒ©ãƒ¼ãƒ»ã‚¨ã‚¯ã‚¹ãƒã‚§ãƒ³ã‚¸","å…‰ã®æ´è»","å…‰ã®æ´è»","å…‰ã®æ´è»","æ­»è€…è˜‡ç”Ÿ","æˆé‡‘ã‚´ãƒ–ãƒªãƒ³","æˆé‡‘ã‚´ãƒ–ãƒªãƒ³","ç™½ã®çƒ™å°","å°å°ã®é»„é‡‘æ«ƒ","ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ãƒ»ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯","åˆ†ã‹ã¤çƒ™å°","åˆ†ã‹ã¤çƒ™å°","åˆ†ã‹ã¤çƒ™å°","çœŸç‚Žç«œã‚¢ãƒ«ãƒ“ã‚ªãƒ³","çœŸç‚Žç«œã‚¢ãƒ«ãƒ“ã‚ªãƒ³","ãƒ©ã‚¤ãƒˆãƒ­ãƒ¼ãƒ‰ãƒ»ã‚¢ãƒ†ãƒŠ ãƒŸãƒãƒ«ãƒ","ãƒ©ã‚¤ãƒˆãƒ­ãƒ¼ãƒ‰ãƒ»ã‚¢ãƒ†ãƒŠ ãƒŸãƒãƒ«ãƒ","ãƒ©ã‚¤ãƒˆãƒ­ãƒ¼ãƒ‰ãƒ»ã‚¢ãƒ†ãƒŠ ãƒŸãƒãƒ«ãƒ","ãƒ©ã‚¤ãƒˆãƒ­ãƒ¼ãƒ‰ãƒ»ã‚»ã‚¤ãƒ³ãƒˆ ãƒŸãƒãƒ«ãƒ","ãƒ©ã‚¤ãƒˆãƒ­ãƒ¼ãƒ‰ãƒ»ã‚»ã‚¤ãƒ³ãƒˆ ãƒŸãƒãƒ«ãƒ","ãƒ©ã‚¤ãƒˆãƒ­ãƒ¼ãƒ‰ãƒ»ã‚»ã‚¤ãƒ³ãƒˆ ãƒŸãƒãƒ«ãƒ","ï¼¬ï¼¡ï¼®ãƒ•ã‚©ãƒªãƒ³ã‚¯ã‚¹","ï¼¬ï¼¡ï¼®ãƒ•ã‚©ãƒªãƒ³ã‚¯ã‚¹","ï¼¬ï¼¡ï¼®ãƒ•ã‚©ãƒªãƒ³ã‚¯ã‚¹","ç¥žè–é­”çš‡åŽã‚»ãƒ¬ãƒ¼ãƒ","ç¥žè–é­”çš‡åŽã‚»ãƒ¬ãƒ¼ãƒ","ç¥žè–é­”çš‡åŽã‚»ãƒ¬ãƒ¼ãƒ","ãƒ©ã‚¤ãƒˆãƒ­ãƒ¼ãƒ‰ãƒ»ãƒ‰ãƒŸãƒ‹ã‚ªãƒ³ ã‚­ãƒ¥ãƒªã‚ªã‚¹"]}],Dp=t=>{if(!Dc(t))return!1;const e=t;return $n(e.id)&&typeof e.name=="string"&&typeof e.description=="string"&&typeof e.lastUsedAt=="string"&&Array.isArray(e.cardNames)&&e.cardNames.every(i=>typeof i=="string")},M=class M{constructor(e,i){c(this,"id");c(this,"name");c(this,"deckType");c(this,"description");c(this,"lastUsedAt");c(this,"cardNames");c(this,"getIllegalCardNames",()=>Array.from(new Set(this.cardNames.filter(e=>!Object.keys(Ie).includes(e)))));c(this,"getDisableCardNames",()=>Array.from(new Set(this.cardNames.filter(e=>!Object.keys(Ie).includes(e)))));c(this,"createCardInfos",()=>{const e=this.getIllegalCardNames();if(e.length>0)throw new Error(`å­˜åœ¨ã—ãªã„ã‚«ãƒ¼ãƒ‰åã‹ã‚‰ãƒ‡ãƒƒã‚­ã‚’ç”Ÿæˆã—ã‚ˆã†ã¨ã—ãŸã€‚${e}`);return this.cardNames.map(i=>Ie==null?void 0:Ie[i]).filter(i=>i)});c(this,"copy",async()=>M.createNewDeck(this.name,this.description,this.cardNames));c(this,"updateTimestamp",async()=>{await M.tblHeader.update(this.id,e=>({...e,lastUsedAt:new Date}))});c(this,"saveDeckInfo",async e=>{const i=e??this;await M.tblHeader.update(this.id,n=>({...n,name:i.name,description:i.description,deckType:"User",lastUsedAt:new Date}));const a=(await M.tblDetail.getAll()).filter(n=>n.deckId===this.id);await M.tblDetail.delete(a.map(n=>n.id));const r=await M.tblDetail.insertMany(i.cardNames.map((n,s)=>({deckId:this.id,seq:s,name:n,description:""})));return new M(await M.tblHeader.get(this.id),r)});c(this,"delete",async()=>{await M.remove(this.id)});this.id=e.id,this.name=e.name,this.deckType=e.deckType,this.description=e.description,this.lastUsedAt=e.lastUsedAt,this.cardNames=i.filter(a=>a.deckId===this.id).map(a=>a.name)}};c(M,"toJson",e=>{const i=e.map(a=>{const{id:r,name:n,description:s,lastUsedAt:l,cardNames:o}=a;return{id:r,name:n,description:s,lastUsedAt:l,cardNames:o}});return i.forEach(a=>{a.cardNames=a.cardNames.map(r=>Ie[r]).sort(Nn).map(r=>r.name)}),JSON.stringify(i,null,2)}),c(M,"createfromJson",async e=>{let i;try{const r=await e.text();i=JSON.parse(r)}catch(r){throw console.error(r),new Error(`${e.name}ã¯æ­£ã—ã„JSONãƒ•ã‚¡ã‚¤ãƒ«å½¢å¼ã§ã¯ãªã„ã€‚`)}if(!Array.isArray(i))throw new Error(`${e.name}ã¯æ­£ã—ã„ãƒ‡ãƒƒã‚­æƒ…å ±ã®å½¢å¼ã§ã¯ãªã„ã€‚`);if(!i.length)throw new Error(`${e.name}ã«ãƒ‡ãƒƒã‚­æƒ…å ±ãŒå«ã¾ã‚Œã¦ã„ãªã„ã€‚`);const a=i.filter(Dp).map(r=>({...r,deckType:"User",id:Number(r.id),lastUsedAt:new Date(r.lastUsedAt)}));if(i.length!==a.length)throw new Error(`${e.name}ã®ãƒ‡ãƒƒã‚­æƒ…å ±${i.length}ä»¶ã®ã†ã¡ã€${i.length-a.length}ä»¶ãŒæ­£ã—ã„ãƒ‡ãƒƒã‚­æƒ…å ±ã®å½¢å¼ã§ã¯ãªã‹ã£ãŸã€‚`);return a}),c(M,"convertToObjectURL",e=>{const i=M.toJson(e),a=new Blob([i],{type:"text/plain"});return window.URL.createObjectURL(a)}),c(M,"idb"),c(M,"tblHeader"),c(M,"tblDetail"),c(M,"getAllDeckInfo",async e=>{if(e&&(M.idb=e),!M.idb)throw new Error("illegal argument: idb is undefined.");M.tblHeader||(M.tblHeader=new xp(M.idb)),M.tblDetail||(M.tblDetail=new Ap(M.idb));const i=await M.tblHeader.getAll(),a=await M.tblDetail.getAll();return i.length?i.map(r=>new M(r,a)):[await M.prepareSampleDeck()]}),c(M,"createNewDeck",async(e,i,a,r)=>{const n=await M.tblHeader.insert({name:e,description:i,deckType:"User",lastUsedAt:r??new Date}),s=await M.tblDetail.insertMany(a.map((l,o)=>({deckId:n.id,seq:o,name:l,description:""})));return new M(n,s)}),c(M,"prepareSampleDeck",async()=>{const e=Va.find(i=>i.deckType==="Preset")??Va.slice(-1)[0];return await M.createNewDeck(e.name,e.description,e.cardNames)}),c(M,"remove",async e=>{await M.tblHeader.delete([e]);const i=(await M.tblDetail.getAll()).filter(a=>a.deckId===e);await M.tblDetail.delete(i.map(a=>a.id))});let Vr=M;class xp extends rr{constructor(i){super(i,"TblDeckHeader");c(this,"_prepareInitialRecords",()=>[])}}class Ap extends rr{constructor(i){super(i,"TblDeckDetail");c(this,"_prepareInitialRecords",()=>[])}}const hg=Va.map(t=>({...t,lastUsedAt:new Date})).filter(t=>t.id<0);export{qp as $,Gp as A,ii as B,he as C,Qn as D,ng as E,Bp as F,Hn as G,Op as H,Wp as I,Gi as J,Ie as K,eg as L,gc as M,pc as N,cc as O,oc as P,dc as Q,fc as R,S,cu as T,fg as U,jp as V,dg as W,Za as X,Zp as Y,sg as Z,Qp as _,Y as a,Ri as a0,Nn as a1,Jp as a2,Yp as a3,Kp as a4,rg as a5,lr as a6,zp as a7,Vr as a8,Ju as a9,gu as aa,qa as ab,nc as ac,ag as ad,ig as ae,tg as af,uc as ag,Ip as ah,Np as ai,Vp as aj,$p as ak,gg as al,pg as am,Up as an,Xp as ao,Hr as ap,cg as aq,Zr as ar,hg as as,_a as at,og as au,Rp as av,Hp as aw,lg as ax,ug as ay,Lp as az,We as b,K as c,oa as d,q as e,X as f,P as g,te as h,Gt as i,rt as j,ae as k,Yo as l,Mi as m,br as n,pt as o,ut as p,N as q,Zt as r,ue as s,$ as t,dt as u,Fp as v,vt as w,Ne as x,Q as y,ai as z};
