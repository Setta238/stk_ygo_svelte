var Co=Object.defineProperty;var br=(e,t)=>(t=Symbol[e])?t:Symbol.for("Symbol."+e),wr=e=>{throw TypeError(e)};var bo=(e,t,a)=>t in e?Co(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a;var u=(e,t,a)=>bo(e,typeof t!="symbol"?t+"":t,a);var Er=(e,t,a)=>{if(t!=null){typeof t!="object"&&typeof t!="function"&&wr("Object expected");var i,r;a&&(i=t[br("asyncDispose")]),i===void 0&&(i=t[br("dispose")],a&&(r=i)),typeof i!="function"&&wr("Object not disposable"),r&&(i=function(){try{r.call(this)}catch(n){return Promise.reject(n)}}),e.push([a,i,t])}else a&&e.push([a]);return t},kr=(e,t,a)=>{var i=typeof SuppressedError=="function"?SuppressedError:function(s,l,o,c){return c=Error(o),c.name="SuppressedError",c.error=s,c.suppressed=l,c},r=s=>t=a?new i(s,t,"An error was suppressed during disposal"):(a=!0,s),n=s=>{for(;s=e.pop();)try{var l=s[1]&&s[1].call(s[2]);if(s[0])return Promise.resolve(l).then(n,o=>(r(o),n()))}catch(o){r(o)}if(a)throw t};return n()};import{_ as wo,c as Eo,j as ko,a as Do,b as xo,s as Ni}from"./json_20260220_130442.js";const Bi=!1;var tr=Array.isArray,Po=Array.prototype.indexOf,ar=Array.from,Ao=Object.defineProperty,Gt=Object.getOwnPropertyDescriptor,gn=Object.getOwnPropertyDescriptors,Mo=Object.prototype,Fo=Array.prototype,ir=Object.getPrototypeOf;function Oo(e){return typeof e=="function"}const ra=()=>{};function No(e){return typeof(e==null?void 0:e.then)=="function"}function Bo(e){return e()}function Li(e){for(var t=0;t<e.length;t++)e[t]()}const Ae=2,hn=4,ri=8,ni=16,ot=32,Sa=64,Za=128,Pe=256,Ga=512,fe=1024,ct=2048,Bt=4096,nt=8192,si=16384,yn=32768,li=65536,vn=1<<17,Lo=1<<19,mn=1<<20,st=Symbol("$state"),Ro=Symbol("legacy props"),qo=Symbol("");function _n(e){return e===this.v}function Ho(e,t){return e!=e?t==t:e!==t||e!==null&&typeof e=="object"||typeof e=="function"}function rr(e){return!Ho(e,this.v)}function Zo(e){throw new Error("https://svelte.dev/e/effect_in_teardown")}function Go(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function Uo(e){throw new Error("https://svelte.dev/e/effect_orphan")}function $o(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function jo(e){throw new Error("https://svelte.dev/e/props_invalid_value")}function zo(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function Vo(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function Qo(){throw new Error("https://svelte.dev/e/state_unsafe_local_read")}function Wo(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}let Ta=!1,Xo=!1;function Ko(){Ta=!0}const nr=1,sr=2,Sn=4,Yo=8,Jo=16,Io=1,ec=2,tc=4,ac=8,ic=16,rc=1,nc=2,sc=4,lc=1,oc=2,pe=Symbol();let W=null;function Ua(e){W=e}function mt(e,t=!1,a){W={p:W,c:null,e:null,m:!1,s:e,x:null,l:null},Ta&&!t&&(W.l={s:null,u:null,r1:[],r2:he(!1)})}function _t(e){const t=W;if(t!==null){const s=t.e;if(s!==null){var a=$,i=j;t.e=null;try{for(var r=0;r<s.length;r++){var n=s[r];Fe(n.effect),Me(n.reaction),Yt(n.fn)}}finally{Fe(a),Me(i)}}W=t.p,t.m=!0}return{}}function Xt(){return!Ta||W!==null&&W.l===null}function he(e,t){var a={f:0,v:e,reactions:null,equals:_n,rv:0,wv:0};return a}function cc(e){return Tn(he(e))}function oa(e,t=!1){var i;const a=he(e);return t||(a.equals=rr),Ta&&W!==null&&W.l!==null&&((i=W.l).s??(i.s=[])).push(a),a}function $a(e,t=!1){return Tn(oa(e,t))}function Tn(e){return j!==null&&!Qe&&j.f&Ae&&(Xe===null?Sc([e]):Xe.push(e)),e}function Wg(e,t){return J(e,qe(()=>F(e))),t}function J(e,t){return j!==null&&!Qe&&Xt()&&j.f&(Ae|ni)&&(Xe===null||!Xe.includes(e))&&Wo(),ht(e,t)}function ht(e,t){return e.equals(t)||(e.v,e.v=t,e.wv=Hn(),Cn(e,ct),Xt()&&$!==null&&$.f&fe&&!($.f&(ot|Sa))&&(at===null?Tc([e]):at.push(e))),t}function Cn(e,t){var a=e.reactions;if(a!==null)for(var i=Xt(),r=a.length,n=0;n<r;n++){var s=a[n],l=s.f;l&ct||!i&&s===$||(He(s,t),l&(fe|Pe)&&(l&Ae?Cn(s,Bt):fi(s)))}}let bn=!1;function dt(e,t=null,a){if(typeof e!="object"||e===null||st in e)return e;const i=ir(e);if(i!==Mo&&i!==Fo)return e;var r=new Map,n=tr(e),s=he(0);n&&r.set("length",he(e.length));var l;return new Proxy(e,{defineProperty(o,c,d){(!("value"in d)||d.configurable===!1||d.enumerable===!1||d.writable===!1)&&zo();var p=r.get(c);return p===void 0?(p=he(d.value),r.set(c,p)):J(p,dt(d.value,l)),!0},deleteProperty(o,c){var d=r.get(c);if(d===void 0)c in o&&r.set(c,he(pe));else{if(n&&typeof c=="string"){var p=r.get("length"),f=Number(c);Number.isInteger(f)&&f<p.v&&J(p,f)}J(d,pe),Dr(s)}return!0},get(o,c,d){var y;if(c===st)return e;var p=r.get(c),f=c in o;if(p===void 0&&(!f||(y=Gt(o,c))!=null&&y.writable)&&(p=he(dt(f?o[c]:pe,l)),r.set(c,p)),p!==void 0){var h=F(p);return h===pe?void 0:h}return Reflect.get(o,c,d)},getOwnPropertyDescriptor(o,c){var d=Reflect.getOwnPropertyDescriptor(o,c);if(d&&"value"in d){var p=r.get(c);p&&(d.value=F(p))}else if(d===void 0){var f=r.get(c),h=f==null?void 0:f.v;if(f!==void 0&&h!==pe)return{enumerable:!0,configurable:!0,value:h,writable:!0}}return d},has(o,c){var h;if(c===st)return!0;var d=r.get(c),p=d!==void 0&&d.v!==pe||Reflect.has(o,c);if(d!==void 0||$!==null&&(!p||(h=Gt(o,c))!=null&&h.writable)){d===void 0&&(d=he(p?dt(o[c],l):pe),r.set(c,d));var f=F(d);if(f===pe)return!1}return p},set(o,c,d,p){var D;var f=r.get(c),h=c in o;if(n&&c==="length")for(var y=d;y<f.v;y+=1){var v=r.get(y+"");v!==void 0?J(v,pe):y in o&&(v=he(pe),r.set(y+"",v))}f===void 0?(!h||(D=Gt(o,c))!=null&&D.writable)&&(f=he(void 0),J(f,dt(d,l)),r.set(c,f)):(h=f.v!==pe,J(f,dt(d,l)));var g=Reflect.getOwnPropertyDescriptor(o,c);if(g!=null&&g.set&&g.set.call(p,d),!h){if(n&&typeof c=="string"){var _=r.get("length"),w=Number(c);Number.isInteger(w)&&w>=_.v&&J(_,w+1)}Dr(s)}return!0},ownKeys(o){F(s);var c=Reflect.ownKeys(o).filter(f=>{var h=r.get(f);return h===void 0||h.v!==pe});for(var[d,p]of r)p.v!==pe&&!(d in o)&&c.push(d);return c},setPrototypeOf(){Vo()}})}function Dr(e,t=1){J(e,e.v+t)}function xr(e){return e!==null&&typeof e=="object"&&st in e?e[st]:e}function wn(e,t){return Object.is(xr(e),xr(t))}var Pr,En,kn,Dn;function uc(){if(Pr===void 0){Pr=window,En=/Firefox/.test(navigator.userAgent);var e=Element.prototype,t=Node.prototype;kn=Gt(t,"firstChild").get,Dn=Gt(t,"nextSibling").get,e.__click=void 0,e.__className="",e.__attributes=null,e.__styles=null,e.__e=void 0,Text.prototype.__t=void 0}}function oi(e=""){return document.createTextNode(e)}function ja(e){return kn.call(e)}function ci(e){return Dn.call(e)}function H(e,t){return ja(e)}function Re(e,t){{var a=ja(e);return a instanceof Comment&&a.data===""?ci(a):a}}function X(e,t=1,a=!1){let i=e;for(;t--;)i=ci(i);return i}function dc(e){e.textContent=""}function ca(e){var t=Ae|ct,a=j!==null&&j.f&Ae?j:null;return $===null||a!==null&&a.f&Pe?t|=Pe:$.f|=mn,{ctx:W,deps:null,effects:null,equals:_n,f:t,fn:e,reactions:null,rv:0,v:null,wv:0,parent:a??$}}function rt(e){const t=ca(e);return t.equals=rr,t}function xn(e){var t=e.effects;if(t!==null){e.effects=null;for(var a=0;a<t.length;a+=1)vt(t[a])}}function pc(e){for(var t=e.parent;t!==null;){if(!(t.f&Ae))return t;t=t.parent}return null}function fc(e){var t,a=$;Fe(pc(e));try{xn(e),t=Gn(e)}finally{Fe(a)}return t}function Pn(e){var t=fc(e),a=(ft||e.f&Pe)&&e.deps!==null?Bt:fe;He(e,a),e.equals(t)||(e.v=t,e.wv=Hn())}function An(e){$===null&&j===null&&Uo(),j!==null&&j.f&Pe&&$===null&&Go(),cr&&Zo()}function gc(e,t){var a=t.last;a===null?t.last=t.first=e:(a.next=e,e.prev=a,t.last=e)}function Kt(e,t,a,i=!0){var r=(e&Sa)!==0,n=$,s={ctx:W,deps:null,nodes_start:null,nodes_end:null,f:e|ct,first:null,fn:t,last:null,next:null,parent:r?null:n,prev:null,teardown:null,transitions:null,wv:0};if(a){var l=Ut;try{Mr(!0),pi(s),s.f|=yn}catch(d){throw vt(s),d}finally{Mr(l)}}else t!==null&&fi(s);var o=a&&s.deps===null&&s.first===null&&s.nodes_start===null&&s.teardown===null&&(s.f&(mn|Za))===0;if(!o&&!r&&i&&(n!==null&&gc(s,n),j!==null&&j.f&Ae)){var c=j;(c.effects??(c.effects=[])).push(s)}return s}function lr(e){const t=Kt(ri,null,!1);return He(t,fe),t.teardown=e,t}function Ar(e){An();var t=$!==null&&($.f&ot)!==0&&W!==null&&!W.m;if(t){var a=W;(a.e??(a.e=[])).push({fn:e,effect:$,reaction:j})}else{var i=Yt(e);return i}}function hc(e){return An(),St(e)}function yc(e){const t=Kt(Sa,e,!0);return(a={})=>new Promise(i=>{a.outro?Pt(t,()=>{vt(t),i(void 0)}):(vt(t),i(void 0))})}function Yt(e){return Kt(hn,e,!1)}function Xg(e,t){var a=W,i={effect:null,ran:!1};a.l.r1.push(i),i.effect=St(()=>{e(),!i.ran&&(i.ran=!0,J(a.l.r2,!0),qe(t))})}function Kg(){var e=W;St(()=>{if(F(e.l.r2)){for(var t of e.l.r1){var a=t.effect;a.f&fe&&He(a,Bt),Jt(a)&&pi(a),t.ran=!1}e.l.r2.v=!1}})}function St(e){return Kt(ri,e,!0)}function Y(e,t=[],a=ca){const i=t.map(a);return ui(()=>e(...i.map(F)))}function ui(e,t=0){return Kt(ri|ni|t,e,!0)}function Ft(e,t=!0){return Kt(ri|ot,e,!0,t)}function Mn(e){var t=e.teardown;if(t!==null){const a=cr,i=j;Fr(!0),Me(null);try{t.call(null)}finally{Fr(a),Me(i)}}}function Fn(e,t=!1){var a=e.first;for(e.first=e.last=null;a!==null;){var i=a.next;vt(a,t),a=i}}function vc(e){for(var t=e.first;t!==null;){var a=t.next;t.f&ot||vt(t),t=a}}function vt(e,t=!0){var a=!1;if((t||e.f&Lo)&&e.nodes_start!==null){for(var i=e.nodes_start,r=e.nodes_end;i!==null;){var n=i===r?null:ci(i);i.remove(),i=n}a=!0}Fn(e,t&&!a),Qa(e,0),He(e,si);var s=e.transitions;if(s!==null)for(const o of s)o.stop();Mn(e);var l=e.parent;l!==null&&l.first!==null&&On(e),e.next=e.prev=e.teardown=e.ctx=e.deps=e.fn=e.nodes_start=e.nodes_end=null}function On(e){var t=e.parent,a=e.prev,i=e.next;a!==null&&(a.next=i),i!==null&&(i.prev=a),t!==null&&(t.first===e&&(t.first=i),t.last===e&&(t.last=a))}function Pt(e,t){var a=[];or(e,a,!0),Nn(a,()=>{vt(e),t&&t()})}function Nn(e,t){var a=e.length;if(a>0){var i=()=>--a||t();for(var r of e)r.out(i)}else t()}function or(e,t,a){if(!(e.f&nt)){if(e.f^=nt,e.transitions!==null)for(const s of e.transitions)(s.is_global||a)&&t.push(s);for(var i=e.first;i!==null;){var r=i.next,n=(i.f&li)!==0||(i.f&ot)!==0;or(i,t,n?a:!1),i=r}}}function zt(e){Bn(e,!0)}function Bn(e,t){if(e.f&nt){e.f^=nt,e.f&fe||(e.f^=fe),Jt(e)&&(He(e,ct),fi(e));for(var a=e.first;a!==null;){var i=a.next,r=(a.f&li)!==0||(a.f&ot)!==0;Bn(a,r?t:!1),a=i}if(e.transitions!==null)for(const n of e.transitions)(n.is_global||t)&&n.in()}}let za=!1,Ri=[];function Ln(){za=!1;const e=Ri.slice();Ri=[],Li(e)}function Ot(e){za||(za=!0,queueMicrotask(Ln)),Ri.push(e)}function mc(){za&&Ln()}const Rn=0,_c=1;let Ra=!1,qa=Rn,ua=!1,da=null,Ut=!1,cr=!1;function Mr(e){Ut=e}function Fr(e){cr=e}let kt=[],$t=0;let j=null,Qe=!1;function Me(e){j=e}let $=null;function Fe(e){$=e}let Xe=null;function Sc(e){Xe=e}let ye=null,Ce=0,at=null;function Tc(e){at=e}let qn=1,Va=0,ft=!1,pt=null;function Hn(){return++qn}function Jt(e){var p;var t=e.f;if(t&ct)return!0;if(t&Bt){var a=e.deps,i=(t&Pe)!==0;if(a!==null){var r,n,s=(t&Ga)!==0,l=i&&$!==null&&!ft,o=a.length;if(s||l){var c=e,d=c.parent;for(r=0;r<o;r++)n=a[r],(s||!((p=n==null?void 0:n.reactions)!=null&&p.includes(c)))&&(n.reactions??(n.reactions=[])).push(c);s&&(c.f^=Ga),l&&d!==null&&!(d.f&Pe)&&(c.f^=Pe)}for(r=0;r<o;r++)if(n=a[r],Jt(n)&&Pn(n),n.wv>e.wv)return!0}(!i||$!==null&&!ft)&&He(e,fe)}return!1}function Cc(e,t){for(var a=t;a!==null;){if(a.f&Za)try{a.fn(e);return}catch{a.f^=Za}a=a.parent}throw Ra=!1,e}function bc(e){return(e.f&si)===0&&(e.parent===null||(e.parent.f&Za)===0)}function di(e,t,a,i){if(Ra){if(a===null&&(Ra=!1),bc(t))throw e;return}a!==null&&(Ra=!0);{Cc(e,t);return}}function Zn(e,t,a=!0){var i=e.reactions;if(i!==null)for(var r=0;r<i.length;r++){var n=i[r];n.f&Ae?Zn(n,t,!1):t===n&&(a?He(n,ct):n.f&fe&&He(n,Bt),fi(n))}}function Gn(e){var h;var t=ye,a=Ce,i=at,r=j,n=ft,s=Xe,l=W,o=Qe,c=e.f;ye=null,Ce=0,at=null,j=c&(ot|Sa)?null:e,ft=(c&Pe)!==0&&(!Ut||r===null||o),Xe=null,Ua(e.ctx),Qe=!1,Va++;try{var d=(0,e.fn)(),p=e.deps;if(ye!==null){var f;if(Qa(e,Ce),p!==null&&Ce>0)for(p.length=Ce+ye.length,f=0;f<ye.length;f++)p[Ce+f]=ye[f];else e.deps=p=ye;if(!ft)for(f=Ce;f<p.length;f++)((h=p[f]).reactions??(h.reactions=[])).push(e)}else p!==null&&Ce<p.length&&(Qa(e,Ce),p.length=Ce);if(Xt()&&at!==null&&!Qe&&p!==null&&!(e.f&(Ae|Bt|ct)))for(f=0;f<at.length;f++)Zn(at[f],e);return r!==null&&Va++,d}finally{ye=t,Ce=a,at=i,j=r,ft=n,Xe=s,Ua(l),Qe=o}}function wc(e,t){let a=t.reactions;if(a!==null){var i=Po.call(a,e);if(i!==-1){var r=a.length-1;r===0?a=t.reactions=null:(a[i]=a[r],a.pop())}}a===null&&t.f&Ae&&(ye===null||!ye.includes(t))&&(He(t,Bt),t.f&(Pe|Ga)||(t.f^=Ga),xn(t),Qa(t,0))}function Qa(e,t){var a=e.deps;if(a!==null)for(var i=t;i<a.length;i++)wc(e,a[i])}function pi(e){var t=e.f;if(!(t&si)){He(e,fe);var a=$,i=W;$=e;try{t&ni?vc(e):Fn(e),Mn(e);var r=Gn(e);e.teardown=typeof r=="function"?r:null,e.wv=qn;var n=e.deps,s;Bi&&Xo&&e.f&ct}catch(l){di(l,e,a,i||e.ctx)}finally{$=a}}}function Un(){if($t>1e3){$t=0;try{$o()}catch(e){if(da!==null)di(e,da,null);else throw e}}$t++}function $n(e){var t=e.length;if(t!==0){Un();var a=Ut;Ut=!0;try{for(var i=0;i<t;i++){var r=e[i];r.f&fe||(r.f^=fe);var n=Dc(r);Ec(n)}}finally{Ut=a}}}function Ec(e){var t=e.length;if(t!==0)for(var a=0;a<t;a++){var i=e[a];if(!(i.f&(si|nt)))try{Jt(i)&&(pi(i),i.deps===null&&i.first===null&&i.nodes_start===null&&(i.teardown===null?On(i):i.fn=null))}catch(r){di(r,i,null,i.ctx)}}}function kc(){if(ua=!1,$t>1001)return;const e=kt;kt=[],$n(e),ua||($t=0,da=null)}function fi(e){qa===Rn&&(ua||(ua=!0,queueMicrotask(kc))),da=e;for(var t=e;t.parent!==null;){t=t.parent;var a=t.f;if(a&(Sa|ot)){if(!(a&fe))return;t.f^=fe}}kt.push(t)}function Dc(e){var t=[],a=e.first;e:for(;a!==null;){var i=a.f,r=(i&ot)!==0,n=r&&(i&fe)!==0,s=a.next;if(!n&&!(i&nt)){if(i&hn)t.push(a);else if(r)a.f^=fe;else{var l=j;try{j=a,Jt(a)&&pi(a)}catch(d){di(d,a,null,a.ctx)}finally{j=l}}var o=a.first;if(o!==null){a=o;continue}}if(s===null){let d=a.parent;for(;d!==null;){if(e===d)break e;var c=d.next;if(c!==null){a=c;continue e}d=d.parent}}a=s}return t}function ur(e){var t=qa,a=kt;try{Un();const r=[];qa=_c,kt=r,ua=!1,$n(a);var i=e==null?void 0:e();return mc(),(kt.length>0||r.length>0)&&ur(),$t=0,da=null,i}finally{qa=t,kt=a}}async function Yg(){await Promise.resolve(),ur()}function F(e){var t=e.f,a=(t&Ae)!==0;if(pt!==null&&pt.add(e),j!==null&&!Qe){Xe!==null&&Xe.includes(e)&&Qo();var i=j.deps;e.rv<Va&&(e.rv=Va,ye===null&&i!==null&&i[Ce]===e?Ce++:ye===null?ye=[e]:(!ft||!ye.includes(e))&&ye.push(e))}else if(a&&e.deps===null&&e.effects===null){var r=e,n=r.parent;n!==null&&!(n.f&Pe)&&(r.f^=Pe)}return a&&(r=e,Jt(r)&&Pn(r)),e.v}function xc(e){var t=pt;pt=new Set;var a=pt,i;try{if(qe(e),t!==null)for(i of pt)t.add(i)}finally{pt=t}return a}function Jg(e){var t=xc(()=>qe(e));for(var a of t)if(a.f&vn)for(const i of a.deps||[])i.f&Ae||ht(i,i.v);else ht(a,a.v)}function qe(e){var t=Qe;try{return Qe=!0,e()}finally{Qe=t}}const Pc=-7169;function He(e,t){e.f=e.f&Pc|t}function Ac(e){if(!(typeof e!="object"||!e||e instanceof EventTarget)){if(st in e)qi(e);else if(!Array.isArray(e))for(let t in e){const a=e[t];typeof a=="object"&&a&&st in a&&qi(a)}}}function qi(e,t=new Set){if(typeof e=="object"&&e!==null&&!(e instanceof EventTarget)&&!t.has(e)){t.add(e),e instanceof Date&&e.getTime();for(let i in e)try{qi(e[i],t)}catch{}const a=ir(e);if(a!==Object.prototype&&a!==Array.prototype&&a!==Map.prototype&&a!==Set.prototype&&a!==Date.prototype){const i=gn(a);for(let r in i){const n=i[r].get;if(n)try{n.call(e)}catch{}}}}}const Mc=["touchstart","touchmove"];function Fc(e){return Mc.includes(e)}let Or=!1;function Oc(){Or||(Or=!0,document.addEventListener("reset",e=>{Promise.resolve().then(()=>{var t;if(!e.defaultPrevented)for(const a of e.target.elements)(t=a.__on_r)==null||t.call(a)})},{capture:!0}))}function Nc(e,t,a,i=!0){i&&a();for(var r of t)e.addEventListener(r,a);lr(()=>{for(var n of t)e.removeEventListener(n,a)})}function gi(e){var t=j,a=$;Me(null),Fe(null);try{return e()}finally{Me(t),Fe(a)}}function Ca(e,t,a,i=a){e.addEventListener(t,()=>gi(a));const r=e.__on_r;r?e.__on_r=()=>{r(),i(!0)}:e.__on_r=()=>i(!0),Oc()}const jn=new Set,Hi=new Set;function Bc(e,t,a,i={}){function r(n){if(i.capture||na.call(t,n),!n.cancelBubble)return gi(()=>a==null?void 0:a.call(this,n))}return e.startsWith("pointer")||e.startsWith("touch")||e==="wheel"?Ot(()=>{t.addEventListener(e,r,i)}):t.addEventListener(e,r,i),r}function Ct(e,t,a,i,r){var n={capture:i,passive:r},s=Bc(e,t,a,n);(t===document.body||t===window||t===document)&&lr(()=>{t.removeEventListener(e,s,n)})}function hi(e){for(var t=0;t<e.length;t++)jn.add(e[t]);for(var a of Hi)a(e)}function na(e){var w;var t=this,a=t.ownerDocument,i=e.type,r=((w=e.composedPath)==null?void 0:w.call(e))||[],n=r[0]||e.target,s=0,l=e.__root;if(l){var o=r.indexOf(l);if(o!==-1&&(t===document||t===window)){e.__root=t;return}var c=r.indexOf(t);if(c===-1)return;o<=c&&(s=o)}if(n=r[s]||e.target,n!==t){Ao(e,"currentTarget",{configurable:!0,get(){return n||a}});var d=j,p=$;Me(null),Fe(null);try{for(var f,h=[];n!==null;){var y=n.assignedSlot||n.parentNode||n.host||null;try{var v=n["__"+i];if(v!==void 0&&!n.disabled)if(tr(v)){var[g,..._]=v;g.apply(n,[e,..._])}else v.call(n,e)}catch(D){f?h.push(D):f=D}if(e.cancelBubble||y===t||y===null)break;n=y}if(f){for(let D of h)queueMicrotask(()=>{throw D});throw f}}finally{e.__root=t,delete e.currentTarget,Me(d),Fe(p)}}}function Lc(e){var t=document.createElement("template");return t.innerHTML=e,t.content}function Wa(e,t){var a=$;a.nodes_start===null&&(a.nodes_start=e,a.nodes_end=t)}function U(e,t){var a=(t&lc)!==0,i=(t&oc)!==0,r,n=!e.startsWith("<!>");return()=>{r===void 0&&(r=Lc(n?e:"<!>"+e),a||(r=ja(r)));var s=i||En?document.importNode(r,!0):r.cloneNode(!0);if(a){var l=ja(s),o=s.lastChild;Wa(l,o)}else Wa(s,s);return s}}function Ig(e=""){{var t=oi(e+"");return Wa(t,t),t}}function Dt(){var e=document.createDocumentFragment(),t=document.createComment(""),a=oi();return e.append(t,a),Wa(t,a),e}function R(e,t){e!==null&&e.before(t)}let Zi=!0;function ge(e,t){var a=t==null?"":typeof t=="object"?t+"":t;a!==(e.__t??(e.__t=e.nodeValue))&&(e.__t=a,e.nodeValue=a+"")}function eh(e,t){return Rc(e,t)}const Rt=new Map;function Rc(e,{target:t,anchor:a,props:i={},events:r,context:n,intro:s=!0}){uc();var l=new Set,o=p=>{for(var f=0;f<p.length;f++){var h=p[f];if(!l.has(h)){l.add(h);var y=Fc(h);t.addEventListener(h,na,{passive:y});var v=Rt.get(h);v===void 0?(document.addEventListener(h,na,{passive:y}),Rt.set(h,1)):Rt.set(h,v+1)}}};o(ar(jn)),Hi.add(o);var c=void 0,d=yc(()=>{var p=a??t.appendChild(oi());return Ft(()=>{if(n){mt({});var f=W;f.c=n}r&&(i.$$events=r),Zi=s,c=e(p,i)||{},Zi=!0,n&&_t()}),()=>{var y;for(var f of l){t.removeEventListener(f,na);var h=Rt.get(f);--h===0?(document.removeEventListener(f,na),Rt.delete(f)):Rt.set(f,h)}Hi.delete(o),p!==a&&((y=p.parentNode)==null||y.removeChild(p))}});return qc.set(c,d),c}let qc=new WeakMap;const Ci=0,Oa=1,bi=2;function th(e,t,a,i,r){var n=e,s=Xt(),l=W,o=pe,c,d,p,f=(s?he:oa)(void 0),h=(s?he:oa)(void 0),y=!1;function v(_,w){y=!0,w&&(Fe(g),Me(g),Ua(l));try{_===Ci&&a&&(c?zt(c):c=Ft(()=>a(n))),_===Oa&&i&&(d?zt(d):d=Ft(()=>i(n,f))),_!==Ci&&c&&Pt(c,()=>c=null),_!==Oa&&d&&Pt(d,()=>d=null),_!==bi&&p&&Pt(p,()=>p=null)}finally{w&&(Ua(null),Me(null),Fe(null),ur())}}var g=ui(()=>{if(o!==(o=t())){if(No(o)){var _=o;y=!1,_.then(w=>{_===o&&(ht(f,w),v(Oa,!0))},w=>{if(_===o)throw ht(h,w),v(bi,!0),h.v}),Ot(()=>{y||v(Ci,!0)})}else ht(f,o),v(Oa,!1);return()=>o=pe}})}function K(e,t,a=!1){var i=e,r=null,n=null,s=pe,l=a?li:0,o=!1;const c=(p,f=!0)=>{o=!0,d(f,p)},d=(p,f)=>{s!==(s=p)&&(s?(r?zt(r):f&&(r=Ft(()=>f(i))),n&&Pt(n,()=>{n=null})):(n?zt(n):f&&(n=Ft(()=>f(i))),r&&Pt(r,()=>{r=null})))};ui(()=>{o=!1,t(c),o||d(null,null)},l)}let Ha=null;function pa(e,t){return t}function Hc(e,t,a,i){for(var r=[],n=t.length,s=0;s<n;s++)or(t[s].e,r,!0);var l=n>0&&r.length===0&&a!==null;if(l){var o=a.parentNode;dc(o),o.append(a),i.clear(),ut(e,t[0].prev,t[n-1].next)}Nn(r,()=>{for(var c=0;c<n;c++){var d=t[c];l||(i.delete(d.k),ut(e,d.prev,d.next)),vt(d.e,!l)}})}function fa(e,t,a,i,r,n=null){var s=e,l={flags:t,items:new Map,first:null},o=(t&Sn)!==0;if(o){var c=e;s=c.appendChild(oi())}var d=null,p=!1,f=rt(()=>{var h=a();return tr(h)?h:h==null?[]:ar(h)});ui(()=>{var h=F(f),y=h.length;p&&y===0||(p=y===0,Zc(h,l,s,r,t,i,a),n!==null&&(y===0?d?zt(d):d=Ft(()=>n(s)):d!==null&&Pt(d,()=>{d=null})),F(f))})}function Zc(e,t,a,i,r,n,s){var Oe,Ee,ia,Ma;var l=(r&Yo)!==0,o=(r&(nr|sr))!==0,c=e.length,d=t.items,p=t.first,f=p,h,y=null,v,g=[],_=[],w,D,b,O;if(l)for(O=0;O<c;O+=1)w=e[O],D=n(w,O),b=d.get(D),b!==void 0&&((Oe=b.a)==null||Oe.measure(),(v??(v=new Set)).add(b));for(O=0;O<c;O+=1){if(w=e[O],D=n(w,O),b=d.get(D),b===void 0){var ie=f?f.e.nodes_start:a;y=Uc(ie,t,y,y===null?t.first:y.next,w,D,O,i,r,s),d.set(D,y),g=[],_=[],f=y.next;continue}if(o&&Gc(b,w,O,r),b.e.f&nt&&(zt(b.e),l&&((Ee=b.a)==null||Ee.unfix(),(v??(v=new Set)).delete(b))),b!==f){if(h!==void 0&&h.has(b)){if(g.length<_.length){var _e=_[0],G;y=_e.prev;var q=g[0],k=g[g.length-1];for(G=0;G<g.length;G+=1)Nr(g[G],_e,a);for(G=0;G<_.length;G+=1)h.delete(_[G]);ut(t,q.prev,k.next),ut(t,y,q),ut(t,k,_e),f=_e,y=k,O-=1,g=[],_=[]}else h.delete(b),Nr(b,f,a),ut(t,b.prev,b.next),ut(t,b,y===null?t.first:y.next),ut(t,y,b),y=b;continue}for(g=[],_=[];f!==null&&f.k!==D;)f.e.f&nt||(h??(h=new Set)).add(f),_.push(f),f=f.next;if(f===null)continue;b=f}g.push(b),y=b,f=b.next}if(f!==null||h!==void 0){for(var se=h===void 0?[]:ar(h);f!==null;)f.e.f&nt||se.push(f),f=f.next;var re=se.length;if(re>0){var Te=r&Sn&&c===0?a:null;if(l){for(O=0;O<re;O+=1)(ia=se[O].a)==null||ia.measure();for(O=0;O<re;O+=1)(Ma=se[O].a)==null||Ma.fix()}Hc(t,se,Te,d)}}l&&Ot(()=>{var Fa;if(v!==void 0)for(b of v)(Fa=b.a)==null||Fa.apply()}),$.first=t.first&&t.first.e,$.last=y&&y.e}function Gc(e,t,a,i){i&nr&&ht(e.v,t),i&sr?ht(e.i,a):e.i=a}function Uc(e,t,a,i,r,n,s,l,o,c){var d=Ha,p=(o&nr)!==0,f=(o&Jo)===0,h=p?f?oa(r):he(r):r,y=o&sr?he(s):s,v={i:y,v:h,k:n,a:null,e:null,prev:a,next:i};Ha=v;try{return v.e=Ft(()=>l(e,h,y,c),bn),v.e.prev=a&&a.e,v.e.next=i&&i.e,a===null?t.first=v:(a.next=v,a.e.next=v.e),i!==null&&(i.prev=v,i.e.prev=v.e),v}finally{Ha=d}}function Nr(e,t,a){for(var i=e.next?e.next.e.nodes_start:a,r=t?t.e.nodes_start:a,n=e.e.nodes_start;n!==i;){var s=ci(n);r.before(n),n=s}}function ut(e,t,a){t===null?e.first=a:(t.next=a,t.e.next=a&&a.e),a!==null&&(a.prev=t,a.e.prev=t&&t.e)}function Gi(e,t,a,i,r){var l;var n=(l=t.$$slots)==null?void 0:l[a],s=!1;n===!0&&(n=t[a==="default"?"children":a],s=!0),n===void 0||n(e,s?()=>i:i)}function zn(e){var t,a,i="";if(typeof e=="string"||typeof e=="number")i+=e;else if(typeof e=="object")if(Array.isArray(e)){var r=e.length;for(t=0;t<r;t++)e[t]&&(a=zn(e[t]))&&(i&&(i+=" "),i+=a)}else for(a in e)e[a]&&(i&&(i+=" "),i+=a);return i}function $c(){for(var e,t,a=0,i="",r=arguments.length;a<r;a++)(e=arguments[a])&&(t=zn(e))&&(i&&(i+=" "),i+=t);return i}function bt(e){return typeof e=="object"?$c(e):e??""}function ah(e,t){var a=e.__attributes??(e.__attributes={});a.value===(a.value=t??void 0)||e.value===t&&(t!==0||e.nodeName!=="PROGRESS")||(e.value=t??"")}function ih(e,t){var a=e.__attributes??(e.__attributes={});a.checked!==(a.checked=t??void 0)&&(e.checked=t)}function Br(e,t,a,i){var r=e.__attributes??(e.__attributes={});r[t]!==(r[t]=a)&&(t==="style"&&"__styles"in e&&(e.__styles={}),t==="loading"&&(e[qo]=a),a==null?e.removeAttribute(t):typeof a!="string"&&jc(e).includes(t)?e[t]=a:e.setAttribute(t,a))}var Lr=new Map;function jc(e){var t=Lr.get(e.nodeName);if(t)return t;Lr.set(e.nodeName,t=[]);for(var a,i=e,r=Element.prototype;r!==i;){a=gn(i);for(var n in a)a[n].set&&t.push(n);i=ir(i)}return t}function oe(e,t,a){var i=e.__className,r=zc(t,a);(i!==r||bn)&&(t==null&&!a?e.removeAttribute("class"):e.className=r,e.__className=r)}function zc(e,t){return(e??"")+(t?" "+t:"")}const Vc=()=>performance.now(),it={tick:e=>requestAnimationFrame(e),now:()=>Vc(),tasks:new Set};function Vn(){const e=it.now();it.tasks.forEach(t=>{t.c(e)||(it.tasks.delete(t),t.f())}),it.tasks.size!==0&&it.tick(Vn)}function Qc(e){let t;return it.tasks.size===0&&it.tick(Vn),{promise:new Promise(a=>{it.tasks.add(t={c:e,f:a})}),abort(){it.tasks.delete(t)}}}function Na(e,t){gi(()=>{e.dispatchEvent(new CustomEvent(t))})}function Wc(e){if(e==="float")return"cssFloat";if(e==="offset")return"cssOffset";if(e.startsWith("--"))return e;const t=e.split("-");return t.length===1?t[0]:t[0]+t.slice(1).map(a=>a[0].toUpperCase()+a.slice(1)).join("")}function Rr(e){const t={},a=e.split(";");for(const i of a){const[r,n]=i.split(":");if(!r||n===void 0)break;const s=Wc(r.trim());t[s]=n.trim()}return t}const Xc=e=>e;function rh(e,t,a){var i=Ha,r,n,s,l=null;i.a??(i.a={element:e,measure(){r=this.element.getBoundingClientRect()},apply(){if(s==null||s.abort(),n=this.element.getBoundingClientRect(),r.left!==n.left||r.right!==n.right||r.top!==n.top||r.bottom!==n.bottom){const o=t()(this.element,{from:r,to:n},a==null?void 0:a());s=Xa(this.element,o,void 0,1,()=>{s==null||s.abort(),s=void 0})}},fix(){if(!e.getAnimations().length){var{position:o,width:c,height:d}=getComputedStyle(e);if(o!=="absolute"&&o!=="fixed"){var p=e.style;l={position:p.position,width:p.width,height:p.height,transform:p.transform},p.position="absolute",p.width=c,p.height=d;var f=e.getBoundingClientRect();if(r.left!==f.left||r.top!==f.top){var h=`translate(${r.left-f.left}px, ${r.top-f.top}px)`;p.transform=p.transform?`${p.transform} ${h}`:h}}}},unfix(){if(l){var o=e.style;o.position=l.position,o.width=l.width,o.height=l.height,o.transform=l.transform}}}),i.a.element=e}function nh(e,t,a,i){var r=(e&rc)!==0,n=(e&nc)!==0,s=r&&n,l=(e&sc)!==0,o=s?"both":r?"in":"out",c,d=t.inert,p=t.style.overflow,f,h;function y(){var D=j,b=$;Me(null),Fe(null);try{return c??(c=a()(t,(i==null?void 0:i())??{},{direction:o}))}finally{Me(D),Fe(b)}}var v={is_global:l,in(){var D;if(t.inert=d,!r){h==null||h.abort(),(D=h==null?void 0:h.reset)==null||D.call(h);return}n||f==null||f.abort(),Na(t,"introstart"),f=Xa(t,y(),h,1,()=>{Na(t,"introend"),f==null||f.abort(),f=c=void 0,t.style.overflow=p})},out(D){if(!n){D==null||D(),c=void 0;return}t.inert=!0,Na(t,"outrostart"),h=Xa(t,y(),f,0,()=>{Na(t,"outroend"),D==null||D()})},stop:()=>{f==null||f.abort(),h==null||h.abort()}},g=$;if((g.transitions??(g.transitions=[])).push(v),r&&Zi){var _=l;if(!_){for(var w=g.parent;w&&w.f&li;)for(;(w=w.parent)&&!(w.f&ni););_=!w||(w.f&yn)!==0}_&&Yt(()=>{qe(()=>v.in())})}}function Xa(e,t,a,i,r){var n=i===1;if(Oo(t)){var s,l=!1;return Ot(()=>{if(!l){var g=t({direction:n?"in":"out"});s=Xa(e,g,a,i,r)}}),{abort:()=>{l=!0,s==null||s.abort()},deactivate:()=>s.deactivate(),reset:()=>s.reset(),t:()=>s.t()}}if(a==null||a.deactivate(),!(t!=null&&t.duration))return r(),{abort:ra,deactivate:ra,reset:ra,t:()=>i};const{delay:o=0,css:c,tick:d,easing:p=Xc}=t;var f=[];if(n&&a===void 0&&(d&&d(0,1),c)){var h=Rr(c(0,1));f.push(h,h)}var y=()=>1-i,v=e.animate(f,{duration:o});return v.onfinish=()=>{var g=(a==null?void 0:a.t())??1-i;a==null||a.abort();var _=i-g,w=t.duration*Math.abs(_),D=[];if(w>0){var b=!1;if(c)for(var O=Math.ceil(w/16.666666666666668),ie=0;ie<=O;ie+=1){var _e=g+_*p(ie/O),G=Rr(c(_e,1-_e));D.push(G),b||(b=G.overflow==="hidden")}b&&(e.style.overflow="hidden"),y=()=>{var q=v.currentTime;return g+_*p(q/w)},d&&Qc(()=>{if(v.playState!=="running")return!1;var q=y();return d(q,1-q),!0})}v=e.animate(D,{duration:w,fill:"forwards"}),v.onfinish=()=>{y=()=>i,d==null||d(i,1-i),r()}},{abort:()=>{v&&(v.cancel(),v.effect=null,v.onfinish=ra)},deactivate:()=>{r=ra},reset:()=>{i===0&&(d==null||d(1,0))},t:()=>y()}}function sh(e,t,a=t){var i=Xt();Ca(e,"input",r=>{var n=r?e.defaultValue:e.value;if(n=Ei(e)?ki(n):n,a(n),i&&n!==(n=t())){var s=e.selectionStart,l=e.selectionEnd;e.value=n??"",l!==null&&(e.selectionStart=s,e.selectionEnd=Math.min(l,e.value.length))}}),qe(t)==null&&e.value&&a(Ei(e)?ki(e.value):e.value),St(()=>{var r=t();Ei(e)&&r===ki(e.value)||e.type==="date"&&!r&&!e.value||r!==e.value&&(e.value=r??"")})}const wi=new Set;function lh(e,t,a,i,r=i){var n=a.getAttribute("type")==="checkbox",s=e;if(t!==null)for(var l of t)s=s[l]??(s[l]=[]);s.push(a),Ca(a,"change",()=>{var o=a.__value;n&&(o=Kc(s,o,a.checked)),r(o)},()=>r(n?[]:null)),St(()=>{var o=i();n?(o=o||[],a.checked=o.includes(a.__value)):a.checked=wn(a.__value,o)}),lr(()=>{var o=s.indexOf(a);o!==-1&&s.splice(o,1)}),wi.has(s)||(wi.add(s),Ot(()=>{s.sort((o,c)=>o.compareDocumentPosition(c)===4?-1:1),wi.delete(s)})),Ot(()=>{})}function oh(e,t,a=t){Ca(e,"change",i=>{var r=i?e.defaultChecked:e.checked;a(r)}),qe(t)==null&&a(e.checked),St(()=>{var i=t();e.checked=!!i})}function Kc(e,t,a){for(var i=new Set,r=0;r<e.length;r+=1)e[r].checked&&i.add(e[r].__value);return a||i.delete(t),Array.from(i)}function Ei(e){var t=e.type;return t==="number"||t==="range"}function ki(e){return e===""?null:+e}function ch(e,t,a=t){Ca(e,"change",()=>{a(e.files)}),St(()=>{e.files=t()})}function Qn(e,t,a){if(e.multiple)return Jc(e,t);for(var i of e.options){var r=sa(i);if(wn(r,t)){i.selected=!0;return}}(!a||t!==void 0)&&(e.selectedIndex=-1)}function Yc(e,t){Yt(()=>{var a=new MutationObserver(()=>{var i=e.__value;Qn(e,i)});return a.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),()=>{a.disconnect()}})}function uh(e,t,a=t){var i=!0;Ca(e,"change",r=>{var n=r?"[selected]":":checked",s;if(e.multiple)s=[].map.call(e.querySelectorAll(n),sa);else{var l=e.querySelector(n)??e.querySelector("option:not([disabled])");s=l&&sa(l)}a(s)}),Yt(()=>{var r=t();if(Qn(e,r,i),i&&r===void 0){var n=e.querySelector(":checked");n!==null&&(r=sa(n),a(r))}e.__value=r,i=!1}),Yc(e)}function Jc(e,t){for(var a of e.options)a.selected=~t.indexOf(sa(a))}function sa(e){return"__value"in e?e.__value:e.value}function qr(e,t){return e===t||(e==null?void 0:e[st])===t}function dh(e={},t,a,i){return Yt(()=>{var r,n;return St(()=>{r=n,n=[],qe(()=>{e!==a(...n)&&(t(e,...n),r&&qr(a(...r),e)&&t(null,...r))})}),()=>{Ot(()=>{n&&qr(a(...n),e)&&t(null,...n)})}}),e}function ph(e,t){Nc(window,["resize"],()=>gi(()=>t(window[e])))}function It(e=!1){const t=W,a=t.l.u;if(!a)return;let i=()=>Ac(t.s);if(e){let r=0,n={};const s=ca(()=>{let l=!1;const o=t.s;for(const c in o)o[c]!==n[c]&&(n[c]=o[c],l=!0);return l&&r++,r});i=()=>F(s)}a.b.length&&hc(()=>{Hr(t,i),Li(a.b)}),Ar(()=>{const r=qe(()=>a.m.map(Bo));return()=>{for(const n of r)typeof n=="function"&&n()}}),a.a.length&&Ar(()=>{Hr(t,i),Li(a.a)})}function Hr(e,t){if(e.l.s)for(const a of e.l.s)F(a);t()}let Ba=!1;function Ic(e){var t=Ba;try{return Ba=!1,[e(),Ba]}finally{Ba=t}}function te(e,t,a,i){var _e;var r=(a&Io)!==0,n=!Ta||(a&ec)!==0,s=(a&ac)!==0,l=(a&ic)!==0,o=!1,c;s?[c,o]=Ic(()=>e[t]):c=e[t];var d=st in e||Ro in e,p=s&&(((_e=Gt(e,t))==null?void 0:_e.set)??(d&&t in e&&(G=>e[t]=G)))||void 0,f=i,h=!0,y=!1,v=()=>(y=!0,h&&(h=!1,l?f=qe(i):f=i),f);c===void 0&&i!==void 0&&(p&&n&&jo(),c=v(),p&&p(c));var g;if(n)g=()=>{var G=e[t];return G===void 0?v():(h=!0,y=!1,G)};else{var _=(r?ca:rt)(()=>e[t]);_.f|=vn,g=()=>{var G=F(_);return G!==void 0&&(f=void 0),G===void 0?f:G}}if(!(a&tc))return g;if(p){var w=e.$$legacy;return function(G,q){return arguments.length>0?((!n||!q||w||o)&&p(q?g():G),G):g()}}var D=!1,b=!1,O=oa(c),ie=ca(()=>{var G=g(),q=F(O);return D?(D=!1,b=!0,q):(b=!1,O.v=G)});return r||(ie.equals=rr),function(G,q){if(pt!==null&&(D=b,g(),F(O)),arguments.length>0){const k=q?F(ie):n&&s?dt(G):G;return ie.equals(k)||(D=!0,J(O,k),y&&f!==void 0&&(f=k),qe(()=>F(ie))),G}return F(ie)}}const eu="5";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(eu);Ko();class fh{constructor(t,a,i){u(this,"_dbname");u(this,"_dbversion");u(this,"dbPromise");u(this,"getTran",async(t,a)=>(await this.dbPromise).transaction(t,a));u(this,"reset",async()=>(await indexedDB.databases().then(t=>{console.log(t)}),await new Promise((t,a)=>{const i=indexedDB.deleteDatabase(this._dbname);i.onsuccess=()=>{console.log("onsuccess"),t()},i.onerror=r=>{console.log("onerror"),a(r)}})));u(this,"getAll",async t=>{const a=await this.dbPromise;return new Promise((i,r)=>{const l=a.transaction([t],"readonly").objectStore(t).getAll();l.onsuccess=()=>{i(l.result)},l.onerror=o=>{r(o)}})});u(this,"get",async(t,a)=>{const i=await this.dbPromise;return new Promise((r,n)=>{const o=i.transaction([t],"readonly").objectStore(t).get(a);o.onsuccess=()=>{r(o.result)},o.onerror=c=>{n(c)}})});u(this,"getMany",async(t,a)=>{const n=(await this.dbPromise).transaction([t],"readonly").objectStore(t),s=a.map(l=>new Promise((o,c)=>{const d=n.get(l);d.onsuccess=()=>{o(d.result)},d.onerror=p=>{c(p)}}));return await Promise.all(s)});u(this,"putRecords",async(t,a)=>{const r=(await this.dbPromise).transaction([t],"readwrite"),n=r.objectStore(t),s=a.map(l=>({record:l,request:n.put(l)}));return new Promise((l,o)=>{r.oncomplete=()=>l(s.map(c=>Object.assign({id:c.request.result},c.record))),r.onerror=c=>o(c)})});u(this,"deleteRecords",async(t,a)=>{const r=(await this.dbPromise).transaction([t],"readwrite"),n=r.objectStore(t),s=a.map(l=>({key:l,request:n.delete(l)}));return new Promise((l,o)=>{r.oncomplete=()=>{console.log(s.map(c=>c.request.result)),l()},r.onerror=c=>o(c)})});this._dbname=t,this._dbversion=a,this.dbPromise=new Promise((r,n)=>{const s=indexedDB.open(t,a);s.onsuccess=l=>{if(console.log(l),!l.target){console.log("event.target is undefined"),n("event.target is undefined");return}const o=l.target.result;if(!o){console.log("event.target.result is undefined"),n("event.target.result is undefined");return}o.onversionchange=c=>{console.log(c),o.close()},r(o)},s.onupgradeneeded=l=>{console.log("onupgradeneeded");const o=l.target.result;i.filter(c=>!o.objectStoreNames.contains(c)).map(c=>o.createObjectStore(c,{keyPath:"id",autoIncrement:!0}))},s.onerror=l=>{console.log(l),n(l)},s.onblocked=l=>{console.log(l),n(l)}}),console.log(this.dbPromise)}get dbversion(){return this._dbversion}}class ce{constructor(){u(this,"handlers",[])}get length(){return this.handlers.length}append(t){this.handlers.push(t)}remove(t){this.handlers=this.handlers.filter(a=>a!==t)}trigger(t){this.handlers.slice(0).filter(a=>a(t)==="RemoveMe").forEach(a=>this.remove(a))}clear(){this.handlers.splice(0)}expose(){return this}}class wt{constructor(){u(this,"handlers",[])}append(t){this.handlers.push(t)}remove(t){this.handlers=this.handlers.filter(a=>a!==t)}async trigger(t){(await Promise.all(this.handlers.slice(0).map(async i=>{const r=await i(t);return{h:i,result:r}}))).filter(i=>i.result==="RemoveMe").map(i=>i.h).forEach(i=>this.remove(i))}clear(){this.handlers.splice(0)}expose(){return this}}class Zr{constructor(){u(this,"handler")}set(t){this.handler=t}async call(t){if(!this.handler)throw Error("illegal state error");return await this.handler(t)}expose(){return this}}class dr{constructor(t,a,i,r){u(this,"_name");u(this,"_createVersion");u(this,"mountResolver",()=>{});u(this,"_indexedDb");u(this,"onInsertEvent",new ce);u(this,"onBeforeInsertEvent",new Zr);u(this,"onUpdateEvent",new ce);u(this,"onBeforeUpdateEvent",new Zr);u(this,"onDeleteEvent",new ce);u(this,"prepareInitialRecords",()=>{const t=new Date;return this._prepareInitialRecords().map(a=>Object.assign(a,{createdAt:t,updatedAt:t,dbVersion:this._createVersion}))});u(this,"resolveMount",()=>this.mountResolver());u(this,"patchForInsert",(t,a)=>{t.newRecords.forEach(i=>{a[i.id]=i})});u(this,"patchForUpdate",(t,a)=>{t.recordPairs.forEach(i=>{a[i.newRecord.id]={...i.newRecord}})});u(this,"patchForDelete",(t,a)=>{t.oldRecords.forEach(i=>{delete a[i.id]})});this._indexedDb=t,this._name=a,this._createVersion=t.dbversion,this.getAll().then(n=>n.reduce((s,l)=>(s[l.id]=l,s),{})).then(n=>{console.log(this.name,n),this.onBeforeInsertEvent.set(i??(()=>Promise.resolve())),this.onBeforeUpdateEvent.set(r??(()=>Promise.resolve()))})}get name(){return this._name}get createVersion(){return this._createVersion}get oninsert(){return this.onInsertEvent.expose()}get onbeforeinsert(){return this.onBeforeInsertEvent.expose()}get onupdate(){return this.onUpdateEvent.expose()}get onbeforeupdate(){return this.onBeforeUpdateEvent.expose()}get ondelete(){return this.onDeleteEvent.expose()}getAll(){return this._indexedDb.getAll(this.name)}get(t){return this._indexedDb.get(this.name,t)}async insertMany(t){const a=new Date,i=t.map(n=>{const s={createdAt:a,updatedAt:a,dbVersion:this._createVersion};return Object.assign(n,s)});await this.onBeforeInsertEvent.call({sender:this,newRecords:i,timestamp:a});const r=await this._indexedDb.putRecords(this.name,i);return this.onInsertEvent.trigger({sender:this,newRecords:r,timestamp:a}),r}async insert(t){return(await this.insertMany([t]))[0]}async updateMany(t,a){const i=new Date,r=[];return(await this._indexedDb.getMany(this.name,t)).forEach(s=>{const l={...s},o={...l};r.push({newRecord:Object.assign(a(o),{updatedAt:i,dbVersion:this._createVersion}),oldRecord:l})}),await this.onBeforeUpdateEvent.call({sender:this,recordPairs:r,timestamp:i}),await this._indexedDb.putRecords(this.name,r.map(s=>s.newRecord)),this.onUpdateEvent.trigger({sender:this,recordPairs:r,timestamp:i}),r.map(s=>s.newRecord)}async update(t,a){return(await this.updateMany([t],a))[0]}async delete(t){const a=new Date,i=await this._indexedDb.getMany(this.name,t);await this._indexedDb.deleteRecords(this.name,t),this.onDeleteEvent.trigger({sender:this,oldRecords:i,timestamp:a})}}const tu=e=>typeof e=="string";String.prototype.format=function(...e){let t=this;for(const[a,i]of e.entries()){const r=new RegExp(`\\{${a}\\}`,"g");t=t.replace(r,i)}return t};String.prototype.toSnakeCase=function(){return this.split(/(?=[A-Z])/).join("_").toLowerCase()};String.prototype.toNarrow=function(){return this.replace(/[ï¼¡-ï¼ºï½-ï½šï¼-ï¼™]/g,function(e){return String.fromCharCode(e.charCodeAt(0)-65248)})};String.prototype.toWide=function(){return this.replace(/[A-Za-z0-9]/g,function(e){return String.fromCharCode(e.charCodeAt(0)+65248)})};const Wn=["Monster","Spell","Trap","XyzMaterial"],gh=["ExtraMonster","Monster","Spell","Trap"],hh={ExtraMonster:"ã‚¨ã‚¯ã‚¹ãƒˆãƒ©",Monster:"ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼",Spell:"é­”æ³•",Trap:"ç½ "},au=e=>{var t;return e.kind==="XyzMaterial"?"Monster":e.kind!=="Monster"?e.kind:(t=e.monsterCategories)!=null&&t.some(a=>At.some(i=>a===i))?"ExtraMonster":"Monster"},At=["Fusion","Synchro","Xyz","Link"],Xn=[...At,"SpecialSummon","Ritual"],iu=["NormalSummonOnly","RegularSpecialSummonOnly","FreeReborn"],Kn=[...Xn,...iu],ru=["Toon","Spirit","Union","Gemini","FlipEffect"],nu=["Tuner","Effect","Normal","Pendulum","Token"],su=[...ru,...nu,...Kn],lu={Synchro:"ã‚·ãƒ³ã‚¯ãƒ­",Fusion:"èžåˆ",Xyz:"ã‚¨ã‚¯ã‚·ãƒ¼ã‚º",Link:"ãƒªãƒ³ã‚¯",Ritual:"å„€å¼",SpecialSummon:"ç‰¹æ®Šå¬å–š",Toon:"ãƒˆã‚¥ãƒ¼ãƒ³",Spirit:"ã‚¹ãƒ”ãƒªãƒƒãƒˆ",Union:"ãƒ¦ãƒ‹ã‚ªãƒ³",Gemini:"ãƒ‡ãƒ¥ã‚¢ãƒ«",FlipEffect:"ãƒªãƒãƒ¼ã‚¹",Tuner:"ãƒãƒ¥ãƒ¼ãƒŠãƒ¼",Effect:"åŠ¹æžœ",Normal:"é€šå¸¸",Pendulum:"ãƒšãƒ³ãƒ‡ãƒ¥ãƒ©ãƒ ",Token:"ãƒˆãƒ¼ã‚¯ãƒ³",FreeReborn:"ç‰¹æ®Šå¬å–šãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ï¼ˆè˜‡ç”Ÿåˆ¶é™ãªã—ï¼‰",NormalSummonOnly:"ç‰¹æ®Šå¬å–šä¸å¯",RegularSpecialSummonOnly:"æ­£è¦ã®æ–¹æ³•ä»¥å¤–ã§ã®ç‰¹æ®Šå¬å–šä¸å¯"},ou={Synchro:"ðŸŽµ",Fusion:"ðŸŒ€",Xyz:"ðŸ“°",Link:"â›“ï¸",Ritual:"ðŸ“œ",SpecialSummon:"ðŸ”¯",Toon:"ðŸ“–",Spirit:"ðŸ‘»",Union:"ðŸš—",Gemini:"ðŸ‘«",FlipEffect:"ðŸ”„",Tuner:"ðŸŽ¶",Effect:"âœ¨",Normal:"ðŸ”˜",Pendulum:"ðŸ’ ",Token:"ðŸ",FreeReborn:"ðŸ†“",NormalSummonOnly:"ðŸ”²",RegularSpecialSummonOnly:"â—"},Yn=["Light","Dark","Earth","Water","Fire","Wind","Divine"],yh={Light:"å…‰",Dark:"é—‡",Earth:"åœ°",Water:"æ°´",Fire:"ç‚Ž",Wind:"é¢¨",Divine:"ç¥ž"},cu=["Aqua","Beast","BeastWarrior","CreatorGod","Cyberse","Dinosaur","DivineBeast","Dragon","Fairy","Fiend","Fish","Insect","Illusion","Machine","Plant","Psychic","Pyro","Reptile","Rock","SeaSerpent","Spellcaster","Thunder","Warrior","WingedBeast","Wyrm","Zombie"],uu=["Normal","Continuous","Field","QuickPlay","Equip","Ritual","PendulumScale"],du={Normal:"é€šå¸¸",Continuous:"æ°¸ç¶š",Field:"ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰",QuickPlay:"é€Ÿæ”»",Equip:"è£…å‚™",Ritual:"å„€å¼",PendulumScale:"ãƒšãƒ³ãƒ‡ãƒ¥ãƒ©ãƒ "},pu=["Normal","Continuous","Counter"],fu={Normal:"é€šå¸¸",Continuous:"æ°¸ç¶š",Counter:"ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼"},T=["Attack","Defense"],La={Attack:"æ”»æ’ƒè¡¨ç¤º",Defense:"å®ˆå‚™è¡¨ç¤º",Set:"è£å´å®ˆå‚™è¡¨ç¤º"},Jn=["level","rank","attack","defense","pendulumScaleR","pendulumScaleL"],gu={Aqua:"æ°´",Beast:"ç£",BeastWarrior:"ç£æˆ¦å£«",CreatorGod:"å‰µé€ ç¥ž",Cyberse:"ã‚µã‚¤ãƒãƒ¼ã‚¹",Dinosaur:"æç«œ",DivineBeast:"å¹»ç¥žç£",Dragon:"ãƒ‰ãƒ©ã‚´ãƒ³",Fairy:"å¤©ä½¿",Fiend:"æ‚ªé­”",Fish:"é­š",Insect:"æ˜†è™«",Illusion:"å¹»æƒ³é­”",Machine:"æ©Ÿæ¢°",Plant:"æ¤ç‰©",Psychic:"ã‚µã‚¤ã‚­ãƒƒã‚¯",Pyro:"ç‚Ž",Reptile:"çˆ¬è™«é¡ž",Rock:"å²©çŸ³",SeaSerpent:"æµ·ç«œ",Spellcaster:"é­”æ³•ä½¿ã„",Thunder:"é›·",Warrior:"æˆ¦å£«",WingedBeast:"é³¥ç£",Wyrm:"å¹»ç«œ",Zombie:"ã‚¢ãƒ³ãƒ‡ãƒƒãƒˆ"},hu={Aqua:"ðŸš°",Beast:"ðŸ…",BeastWarrior:"ðŸ¦",CreatorGod:"ðŸ”†",Cyberse:"ðŸ’»ï¸",Dinosaur:"ðŸ¦–",DivineBeast:"ðŸ’«",Dragon:"ðŸ²",Fairy:"ðŸ‘¼",Fiend:"ðŸ‘¿",Fish:"ðŸŸï¸",Insect:"ðŸ¦‹",Illusion:"ðŸ¤¡",Machine:"ðŸ¤–",Plant:"ðŸŒ±",Psychic:"ðŸ‘ï¸",Pyro:"ðŸ”¥",Reptile:"ðŸ¦Ž",Rock:"â›°",SeaSerpent:"ðŸ",Spellcaster:"ðŸ§™",Thunder:"âš¡ï¸",Warrior:"âš”ï¸",WingedBeast:"ðŸ¦…",Wyrm:"ðŸ‰",Zombie:"ðŸ¦´"},In=["TopLeft","TopCenter","TopRight","MiddleLeft","MiddleRight","BottomLeft","BottomCenter","BottomRight"],pr={TopLeft:{name:"å·¦ä¸Š",linkArrow:{offsetRow:-1,offsetColumn:-1},emoji:"â†–"},TopCenter:{name:"ä¸Š",linkArrow:{offsetRow:-1,offsetColumn:0},emoji:"â¬†"},TopRight:{name:"å³ä¸Š",linkArrow:{offsetRow:-1,offsetColumn:1},emoji:"â†—"},MiddleLeft:{name:"å·¦",linkArrow:{offsetRow:0,offsetColumn:-1},emoji:"â¬…"},MiddleRight:{name:"å³",linkArrow:{offsetRow:0,offsetColumn:1},emoji:"âž¡"},BottomLeft:{name:"å·¦ä¸‹",linkArrow:{offsetRow:1,offsetColumn:-1},emoji:"â†™"},BottomCenter:{name:"ä¸‹",linkArrow:{offsetRow:1,offsetColumn:0},emoji:"â¬‡"},BottomRight:{name:"å³ä¸‹",linkArrow:{offsetRow:1,offsetColumn:1},emoji:"â†˜"}};In.reduce((e,t)=>(e[pr[t].name]=t,e),{});const vh=e=>e.cardId??!1?`https://www.db.yugioh-card.com/yugiohdb/card_search.action?ope=2&cid=${e.cardId}`:`https://www.db.yugioh-card.com/yugiohdb/card_search.action?ope=1&sess=1&rp=10&mode=&sort=1&keyword=${e.name}&stype=1&ctype=&othercon=2&starfr=&starto=&pscalefr=&pscaleto=&linkmarkerfr=&linkmarkerto=&link_m=2&atkfr=&atkto=&deffr=&defto=&releaseDStart=1&releaseMStart=1&releaseYStart=1999&releaseDEnd=&releaseMEnd=&releaseYEnd=`,mh={star:"æ˜Ÿ",attack:"æ”»",defense:"é˜²",cardId:"ID",name:"å",releaseDate:"æ—¥"},yu=[{key:"star",order:"asc",priority:1},{key:"attack",order:"asc",priority:2},{key:"defense",order:"asc",priority:3},{key:"name",order:"asc",priority:4},{key:"cardId",order:"asc",priority:5},{key:"releaseDate",order:"asc",priority:6}],Gr=e=>({star:e.link??e.rank??e.level??-1,attack:e.attack??-1,defense:e.defense??-1,cardId:e.cardId,releaseDate:e.releaseDate}),es=(e,t,a=[...yu])=>{if(e.kind!==t.kind)for(const s of Wn){if(e.kind===s)return-1;if(t.kind===s)return 1}if(e.kind==="Monster"){const s=(e.monsterCategories??[]).filter(o=>At.includes(o)),l=(t.monsterCategories??[]).filter(o=>At.includes(o));if(s.length!==l.length)return l.length-s.length;if(s.length&&s[0]!==l[0])for(const o of At){if(s.includes(o)&&!l.includes(o))return-1;if(!s.includes(o)&&l.includes(o))return 1}}const i=a.filter(({key:s})=>e.kind==="Monster"||s==="cardId"||s==="name"||s==="releaseDate"),r=Gr(e),n=Gr(t);return i.toSorted((s,l)=>s.priority-l.priority).map(s=>{if(s.key==="name")return e.name.localeCompare(t.name,"Ja")*(s.order==="asc"?1:-1);const l=r[s.key],o=n[s.key];if(l===void 0||o===void 0)return l===void 0&&o===void 0?0:o?1:-1;const c=l instanceof Date?l.getTime():l,d=o instanceof Date?o.getTime():o;return(c-d)*(s.order==="asc"?1:-1)}).find(s=>s)??e.name.localeCompare(t.name,"Ja")},vu=e=>{const t=e,a=["kind","name"],i=["attack","defense","level","rank","link","pendulumScaleL","pendulumScaleR"],r=[{key:"kind",list:Wn},{key:"spellCategory",list:uu},{key:"trapCategory",list:pu},{key:"name",list:[]}],n=[{key:"nameTags",list:[]},{key:"textTags",list:[]},{key:"monsterCategories",list:su},{key:"attributes",list:Yn},{key:"types",list:cu},{key:"linkArrowKeys",list:In}],s=["releaseDate"];return a.every(l=>t[l])&&i.map(l=>t[l]).filter(l=>l!==void 0).every(l=>!isNaN(Number(l)))&&r.map(({key:l,list:o})=>({value:t[l],list:o})).filter(({value:l})=>l).every(({value:l,list:o})=>tu(l)&&(o.includes(l)||!o.length))&&n.map(({key:l,list:o})=>({value:t[l],list:o})).filter(({value:l})=>l).every(({value:l,list:o})=>Array.isArray(l)&&l.every(c=>o.includes(c))||!o.length)&&s.map(l=>t[l]).filter(l=>l).every(l=>l instanceof Date)},mu=e=>{e.length=18;const t={};let a=0;t.cardId=e[a++],t.name=e[a++];const i=e[a++];if(t.releaseDate=i?new Date(i.toString()):void 0,t.kind=e[a++],t.nameTags=e[a++],t.textTags=e[a++],t.monsterCategories=e[a++],t.spellCategory=e[a++],t.trapCategory=e[a++],t.attributes=e[a++],t.types=e[a++],t.attack=e[a++],t.defense=e[a++],t.level=e[a++],t.rank=e[a++],t.link=e[a++],t.linkArrowKeys=e[a++],t.pendulumScaleL=e[a++],t.pendulumScaleR=e[a++],!vu(t))throw console.error(Object.entries(t)),new Error(`IllegalCardDefinition:${Object.values(t)}`);return t},_u=e=>e.filter(t=>t.kind!=="XyzMaterial").reduce((t,a)=>{const i=au(a);return t[i].push(a),t},{ExtraMonster:[],Monster:[],Spell:[],Trap:[]});class ue extends Error{constructor(a,i){super(a?`ãƒ‡ãƒ¥ã‚¨ãƒ«ãŒçµ‚äº†ã—ãŸã€‚å‹è€…ï¼š${a.profile.name}`:"ãƒ‡ãƒ¥ã‚¨ãƒ«ãŒçµ‚äº†ã—ãŸã€‚ãƒ‰ãƒ­ãƒ¼ã€‚");u(this,"winner");u(this,"message");this.winner=a,this.message=i}}class A extends Error{constructor(a,...i){super(a);u(this,"message");u(this,"items");u(this,"viteBuildTimestamp","20260220_130442");this.message=a,this.items=i}}class N extends A{constructor(...t){super("ã‚­ãƒ£ãƒ³ã‚»ãƒ«ä¸å¯ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãŒã‚­ãƒ£ãƒ³ã‚»ãƒ«ã•ã‚ŒãŸã€‚",...t)}}class P extends A{constructor(t,a,...i){let r=`${t} duelist:${a.activator.name} entity:${a.action.entity.toString()} action:${a.action.definition.title}`;lp(a)&&(r+=` targets:${a.selectedEntities}`),t==="IlligalActionData"&&(r+=` data:${a.data}`),super(r,a,...i)}}const ts=["Deck","ExtraDeck"],yi=["Graveyard","Banished"],as=[...ts,...yi],Su=[...as,"Hand"],x=["MonsterZone","ExtraMonsterZone"],ga=["SpellAndTrapZone","FieldSpellZone"],me=[...x,...ga],is=["XyzMaterialZone","WaitingRoom"],Ke=[...Su,...me,...is],Tu={Deck:"ãƒ‡ãƒƒã‚­",ExtraDeck:"EXãƒ‡ãƒƒã‚­",Graveyard:"å¢“åœ°",Banished:"é™¤å¤–",Hand:"æ‰‹æœ­",MonsterZone:"å ´",ExtraMonsterZone:"å ´",SpellAndTrapZone:"å ´",FieldSpellZone:"å ´",XyzMaterialZone:"XYZç´ æ",WaitingRoom:"è™šç„¡"},Ur={Deck:"Random",ExtraDeck:"Bottom",Graveyard:"Top",Banished:"Top",Hand:"Bottom",MonsterZone:"Top",ExtraMonsterZone:"Top",SpellAndTrapZone:"Top",FieldSpellZone:"Top",XyzMaterialZone:"Bottom",WaitingRoom:"Bottom"},$r={Deck:"FaceDown",ExtraDeck:"FaceDown",Graveyard:"FaceUp",Banished:"FaceUp",Hand:"FaceDown",MonsterZone:"FaceUp",ExtraMonsterZone:"FaceUp",SpellAndTrapZone:"FaceUp",FieldSpellZone:"FaceUp",XyzMaterialZone:"FaceUp",WaitingRoom:"FaceUp"},Ui={0:{0:"Hand"},1:{0:"Deck",1:"SpellAndTrapZone",2:"SpellAndTrapZone",3:"SpellAndTrapZone",4:"SpellAndTrapZone",5:"SpellAndTrapZone",6:"ExtraDeck"},2:{0:"Graveyard",1:"MonsterZone",2:"MonsterZone",3:"MonsterZone",4:"MonsterZone",5:"MonsterZone",6:"FieldSpellZone"},3:{0:"Banished",1:"XyzMaterialZone",2:"ExtraMonsterZone",3:"WaitingRoom",4:"ExtraMonsterZone",5:"XyzMaterialZone",6:"Banished"},4:{0:"FieldSpellZone",1:"MonsterZone",2:"MonsterZone",3:"MonsterZone",4:"MonsterZone",5:"MonsterZone",6:"Graveyard"},5:{0:"ExtraDeck",1:"SpellAndTrapZone",2:"SpellAndTrapZone",3:"SpellAndTrapZone",4:"SpellAndTrapZone",5:"SpellAndTrapZone",6:"Deck"},6:{0:"Hand"}};class Cu{constructor(t,a,i,r){u(this,"onUpdateEvent",new ce);u(this,"field");u(this,"row");u(this,"column");u(this,"cellType");u(this,"_owner");u(this,"_requiresRecalcLinkArrows");u(this,"_linkArrowSources");u(this,"_needsShuffle",!1);u(this,"recalcLinkArrows",()=>{this.isMonsterZoneLikeCell&&(this._requiresRecalcLinkArrows=!1,this._linkArrowSources=this.neighbors.filter(t=>t.isMonsterZoneLikeCell).filter(t=>t.cardEntities.length).filter(t=>t.cardEntities[0].linkArrows.some(a=>this.row===t.row+a.offsetRow&&this.column===t.column+a.offsetColumn)).map(t=>t.cardEntities[0]))});u(this,"_entities");u(this,"releaseEntities",t=>{var a;return this._entities=this._entities.filter(i=>i!==t),this.isMonsterZoneLikeCell&&((a=t.origin.monsterCategories)!=null&&a.includes("Link"))&&(this._requiresRecalcLinkArrows=!0),this.onUpdateEvent.trigger(),t});u(this,"acceptEntities",(t,a)=>{var i;if(a==="Fix"){if(!this._entities.includes(t))throw new A("å¼•æ•°ã¨ã‚»ãƒ«ã®çŠ¶æ…‹ãŒçŸ›ç›¾ã—ã¦ã„ã‚‹ã€‚",this,t,a)}else a==="Top"?this._entities.unshift(t):this._entities.push(t),a==="Random"&&(this._needsShuffle=!0),this._entities.forEach(r=>{r.cell=this}),this.isMonsterZoneLikeCell&&((i=t.origin.monsterCategories)!=null&&i.includes("Link"))&&(this._requiresRecalcLinkArrows=!0);this.onUpdateEvent.trigger()});u(this,"shuffle",()=>{this._entities=this.entities.shuffle(),this._needsShuffle=!1,this.field.duel.log.info("ãƒ‡ãƒƒã‚­ã‚’ã‚·ãƒ£ãƒƒãƒ•ãƒ«ã€‚",this.owner)});u(this,"toString",()=>this.isMonsterZoneLikeCell||this.cellType==="SpellAndTrapZone"?`${this.cellType}(${this.row},${this.column})`:this.cellType);this.field=t,this.row=a,this.column=i,this.cellType=Ui[a][i],this._owner=r,this._entities=[],this._linkArrowSources=[],this._requiresRecalcLinkArrows=!1}get onUpdate(){return this.onUpdateEvent.expose()}get owner(){var t;return this._owner||((t=this.cardEntities[0])==null?void 0:t.owner)}get requiresRecalcLinkArrows(){return this._requiresRecalcLinkArrows}get linkArrowSources(){return this._linkArrowSources}get needsShuffle(){return this._needsShuffle}get entities(){return this._entities}get visibleEntities(){return this._entities.filter(t=>Kr.find(a=>a===t.entityType))}get cardEntities(){return this._entities.filter(t=>Kr.find(a=>a===t.entityType)).filter(t=>t.kind!=="XyzMaterial")}get xyzMaterials(){return this._entities.filter(t=>t.kind==="XyzMaterial")}get targetForAttack(){return this.cellType==="Hand"?this._entities.find(t=>t.entityType==="Duelist"):this.cardEntities[0]}get isAvailable(){return this.cardEntities.length===0&&this._entities.filter(t=>Iu.find(a=>a===t.entityType)).length===0}get isAvailableForPendulum(){return this.isAvailable&&this.isSpellTrapZoneLikeCell&&(this.column===1||this.column===5)}get isStackCell(){return as.some(t=>t===this.cellType)}get isPlayFieldCell(){return me.some(t=>t===this.cellType)}get isMonsterZoneLikeCell(){return x.some(t=>t===this.cellType)}get isSpellTrapZoneLikeCell(){return ga.some(t=>t===this.cellType)}get isDisabledCell(){return is.some(t=>t===this.cellType)}get isTrashCell(){return yi.some(t=>t===this.cellType)}get neighbors(){const t=[this.row-1,this.row,this.row+1].filter(i=>i>=0&&i<=6),a=[this.column-1,this.column,this.column+1].filter(i=>i>=0&&i<=6);return t.flatMap(i=>a.map(r=>this.field.cells[i][r])).filter(i=>i.isMonsterZoneLikeCell).filter(i=>i!==this)}get shortName(){return Tu[this.cellType]}}const rs=["NormalSummon","SpecialSummon","FlipSummon"],fr=["IgnitionEffect","TriggerEffect","QuickEffect","CardActivation"],bu=[...rs,...fr,"DeclareAttack"],wu=e=>e==="CardActivation"?"CardActivation":fr.some(t=>t===e)?"EffectActivation":"NonActivate",Eu=["isOnlyNTimesPerTurn","isOnlyNTimesPerDuel","isOnlyNTimesPerTurnIfFaceup","isOnlyNTimesPerChain","isOnlyNTimesIfFaceup"],Ja=class Ja{constructor(t,a,i){u(this,"seq");u(this,"entity");u(this,"_definition");u(this,"validateDuelist",t=>this.entity.controller===t?this.executableDuelistTypes.includes("Controller"):this.executableDuelistTypes.includes("Opponent"));u(this,"isSame",t=>this.entity.origin.name===t.entity.origin.name&&this.title===t.title);u(this,"isSameGroup",t=>this.actionGroupName?this.entity.origin.name===t.entity.origin.name&&this.actionGroupName===t.actionGroupName:this.isSame(t));u(this,"canExecute",t=>this.executableCells.includes(this.entity.cell.cellType)&&this.executableFaces.includes(this.entity.face)&&this.executablePeriods.includes(this.entity.duel.clock.period.key)&&this.validateDuelist(t??this.entity.controller));this.seq=t==="AutoSeq"?Ja.nextSeq++:t,this.entity=a,this._definition=i}get definition(){return this._definition}get title(){return this.definition.title}get playType(){return this.definition.playType}get isMandatory(){return this.definition.isMandatory}get executableCells(){return this.definition.executableCells}get executablePeriods(){return this.definition.executablePeriods}get executableFaces(){return this.definition.executableFaces??hr}get executableDuelistTypes(){return this.definition.executableDuelistTypes??["Controller"]}get isOnlyNTimesPerDuel(){return this.definition.isOnlyNTimesPerDuel??0}get isOnlyNTimesPerTurn(){return this.definition.isOnlyNTimesPerTurn??0}get isOnlyNTimesPerTurnIfFaceup(){return this.definition.isOnlyNTimesPerTurnIfFaceup??0}get isOnlyNTimesIfFaceup(){return this.definition.isOnlyNTimesIfFaceup??0}get isOnlyNTimesPerChain(){return this.definition.isOnlyNTimesPerChain??0}get actionCountUpperBoundKey(){return Eu.find(t=>this[t])}get actionCountUpperBound(){const t=this.actionCountUpperBoundKey;if(t)return this[t]}get actionCount(){const t=this.actionCountUpperBoundKey;if(!t)return;if(t==="isOnlyNTimesIfFaceup"||t==="isOnlyNTimesPerTurnIfFaceup")return this.entity.counterHolder.getActionCount(this);const a=this.duel.chainBlockInfos.filter(n=>this.isSameGroup(n.action)).length;if(t==="isOnlyNTimesPerChain")return a;let i=this.duel.chainBlockLog.records;return t==="isOnlyNTimesPerTurn"&&(i=i.filter(n=>n.clock.turn===this.duel.clock.turn)),i.filter(n=>!n.chainBlockInfo.isNegatedActivationBy).filter(n=>this.isSameGroup(n.chainBlockInfo.action)).filter(n=>n.chainBlockInfo.activator===this.entity.controller).length+a}get actionGroupName(){return this.definition.actionGroupName}get duel(){return this.entity.duel}};u(Ja,"nextSeq",0);let ha=Ja;class ba{constructor(){u(this,"pooledOperators",[]);u(this,"bundles",[]);u(this,"excludesExpired",()=>{this.bundles.forEach(t=>t.excludesExpired()),this.pooledOperators=this.pooledOperators.filter(t=>t.validateAlive())});u(this,"append",t=>{this.bundles.push(t)});u(this,"push",t=>{this.excludesExpired(),this.distribute(t),this.pooledOperators.push(t)});u(this,"distributeAll",t=>(this.excludesExpired(),this.pooledOperators.flatMap(this.distribute).getDistinct().forEach(a=>a.operators.sort((i,r)=>i.seq-r.seq)),this.afterDistributeAll(t)));u(this,"distribute",t=>this.bundles.filter(a=>a.entity.exist).filter(a=>a.operators.every(i=>i.seq!==t.seq)).filter(a=>t.isApplicableTo(a.entity)).filter(a=>a.entity.canBeEffected(t.effectOwner,t.isSpawnedBy,t.actionAttr)).map(a=>(a.push(t),a)));u(this,"removeItem",t=>{this.pooledOperators=this.pooledOperators.filter(a=>a.seq!==t)})}}class wa{constructor(t,a){u(this,"pool");u(this,"entity");u(this,"_operators");u(this,"excludesExpired",()=>{this._operators=this._operators.filter(t=>{const a=t.validateAlive()&&t.isApplicableTo(this.entity);return a||(console.info(`before remove ${this.entity.toString} ${t.title}`),t.beforeRemove(this)),a})});u(this,"push",(...t)=>(t.forEach(a=>{if(!this.entity.procFilterBundle.filter(["Effect"],a.effectOwner,a.isSpawnedBy,a.actionAttr,[]))return!1;this.beforePush(a),this._operators.push(a),this.afterPush(a)}),!0));u(this,"removeItem",t=>{this._operators=this._operators.filter(a=>a.seq!==t?!0:(a.beforeRemove(this),!1))});this.pool=t,this.entity=a,this._operators=[],this.pool.append(this)}get operators(){return this._operators}get effectiveOperators(){return this.operators.filter(t=>t.isSpawnedBy.isEffective||!t.isContinuous)}}const Ia=class Ia{constructor(t){u(this,"seq");u(this,"title");u(this,"validateAlive");u(this,"isContinuous");u(this,"isSpawnedBy");u(this,"isSpawnedAt");u(this,"activateType");u(this,"actionAttr");u(this,"isApplicableTo");u(this,"effectOwner");this.seq=Ia.nextSeq++,this.title=t.title,this.validateAlive=()=>t.validateAlive(this),this.isContinuous=t.isContinuous,this.isSpawnedBy=t.isSpawnedBy,this.isSpawnedAt=t.isSpawnedBy.duel.clock.getClone(),this.isApplicableTo=a=>t.isApplicableTo(this,a),this.actionAttr=t.actionAttr,this.activateType=this.actionAttr.playType?wu(this.actionAttr.playType):"NonActivate",this.effectOwner=this.isSpawnedBy.controller}get duel(){return this.effectOwner.duel}get isEffective(){return!this.isContinuous||this.activateType==="NonActivate"?!0:this.isSpawnedBy.isEffective}};u(Ia,"nextSeq",0);let Nt=Ia;class ku extends ba{constructor(){super(...arguments);u(this,"afterDistributeAll",()=>this.bundles.every(a=>a.applyEffectFilter()))}}class Du extends wa{constructor(){super(...arguments);u(this,"applyEffectFilter",()=>{const a=this.entity.allStickyEffectOperators.length,i=[];for(;;){const r=this.effectiveOperators.filter(n=>n.procTypes.includes("Effect")).filter(n=>n.isContinuous).find(n=>!i.includes(n.seq));if(!r)break;i.push(r.seq),r.eraseOperators(this.entity)}return this.entity.allStickyEffectOperators.length===a});u(this,"filter",(a,i,r,n,s)=>this.effectiveOperators.filter(l=>l.procTypes.union(a).length).every(l=>l.filter(this.entity,i,r,n,s)));u(this,"beforePush",a=>a.eraseOperators(this.entity));u(this,"afterPush",()=>{})}}const Zt=class Zt extends Nt{constructor(a){super(a);u(this,"beforeRemove",()=>{});u(this,"procTypes");u(this,"filter");u(this,"eraseOperators",a=>{if(!this.procTypes.includes("Effect"))return 0;const i=a.allStickyEffectOperators.filter(r=>r.isContinuous).filter(r=>!this.filter(a,r.effectOwner,r.isSpawnedBy,r.actionAttr,[])).map(r=>r.seq);return i.forEach(a.procFilterBundle.removeItem),i.forEach(a.statusOperatorBundle.removeItem),i.forEach(a.numericOprsBundle.removeItem),i.length});this.procTypes=a.procTypes,this.filter=a.filter}};u(Zt,"createContinuous",(a,i,r,n,s,l)=>new Zt({title:a,validateAlive:i,isContinuous:!0,isSpawnedBy:r,actionAttr:{},isApplicableTo:n,procTypes:s,filter:l})),u(Zt,"createLingering",(a,i,r,n,s,l,o)=>new Zt({title:a,validateAlive:i,isContinuous:!1,isSpawnedBy:r,actionAttr:n,isApplicableTo:s,procTypes:l,filter:o}));let we=Zt;const jr={level:1,rank:1,attack:0,defense:0,pendulumScaleR:0,pendulumScaleL:0};class xu extends ba{constructor(){super(...arguments);u(this,"afterDistributeAll",a=>{if(this.bundles.forEach(r=>r.calcStateAll()),a.field.getMonstersOnFieldStrictly().flatMap(r=>r.numericOprsBundle).flatMap(r=>r.effectiveOperators).some(r=>r.targetStateGen==="calculated")){const n=a.field.getMonstersOnFieldStrictly().filter(s=>(s.atk??0)>=0).map(s=>s.atk??0).reduce((s,l)=>s>l?s:l,0);a.field.getMonstersOnFieldStrictly().forEach(s=>{s.numericOprsBundle.effectiveOperators.filter(l=>l.targetStateGen==="calculated").forEach(l=>{var o;if(!((o=s.status.monsterCategories)!=null&&o.includes("Link")&&l.targetState==="defense")){if(l.stateOperationType==="THE_DEVILS_AVATAR"){s.numericStatus.calculated[l.targetState]=n+100;return}s.numericStatus.calculated[l.targetState]=l.calcValue(s,s.numericStatus.calculated[l.targetState]??0)}})})}return!0})}}class Pu extends wa{constructor(){super(...arguments);u(this,"beforePush",a=>{const i=this.effectiveOperators.filter(n=>n.targetState===a.targetState).filter(n=>n.isEffective);if(a.kind==="O-L-F"||a.kind==="O-C-F"?(i.filter(n=>n.kind==="O-L-F").forEach(n=>n.negate()),i.filter(n=>n.kind==="L-F").forEach(n=>n.negate())):a.kind==="L-F"||a.kind==="C-F"?i.filter(n=>n.kind==="L-F"||n.kind==="L-A").forEach(n=>n.negate()):a.kind==="X-C-X"&&i.filter(n=>!n.isContinuous).forEach(n=>n.negate()),i.filter(n=>n.isEffective).some(n=>n.kind==="X-C-X")&&!a.isContinuous)return;if(a.stateOperationType!=="Addition"&&a.targetStateGen==="wip"&&i.filter(n=>!n.isContinuous).forEach(n=>n.negate()),a.stateOperationType==="THE_DEVILS_AVATAR"||a.stateOperationType==="Gradius'_Option"){this.entity.numericStatus.calculated[a.targetState]=-Number.MAX_VALUE;return}const r=this.entity.numericStatus.calculated[a.targetState]??0;if(a.stateOperationType==="THE_DEVILS_DREAD-ROOT"){this.entity.numericStatus.calculated[a.targetState]=a.calcValue(this.entity,r);return}if(a.kind==="L-F"){this.entity.numericStatus.wip[a.targetState]=a.calcValue(this.entity,r);return}});u(this,"afterPush",()=>{this.calcStateAll()});u(this,"calcStateAll",()=>Jn.forEach(this.calcState));u(this,"calcState",a=>{if(!this.entity.isPendulumScale&&!this.entity.isMonster){this.entity.numericStatus.calculated[a]=void 0;return}if(!this.entity.status.monsterCategories){this.entity.numericStatus.calculated[a]=void 0;return}if(this.entity.status.monsterCategories.includes("Link")&&a!=="attack"){this.entity.numericStatus.calculated[a]=void 0;return}if(this.entity.status.monsterCategories.includes("Xyz")&&a==="level"){this.entity.numericStatus.calculated[a]=void 0;return}if(!this.entity.status.monsterCategories.includes("Xyz")&&a==="rank"){this.entity.numericStatus.calculated[a]=void 0;return}if(!this.entity.status.monsterCategories.includes("Pendulum")&&(a==="pendulumScaleL"||a==="pendulumScaleR")){this.entity.numericStatus.calculated[a]=void 0;return}if(a!=="level"&&!this.entity.isOnFieldStrictly){this.entity.numericStatus.origin[a]=this.entity.origin[a],this.entity.numericStatus.wip[a]=this.entity.origin[a],this.entity.numericStatus.calculated[a]=this.entity.origin[a];return}const i=this.entity.origin[a]??0,r=this.entity.numericStatus.wip[a]??0,n=this._operators.filter(d=>d.targetState===a).filter(d=>d.isEffective);if(n.some(d=>d.stateOperationType==="THE_DEVILS_AVATAR"||d.stateOperationType==="Gradius'_Option")&&this.entity.isEffective){this.entity.numericStatus.calculated[a]=-Number.MAX_VALUE;return}const s=n.filter(d=>d.targetState===a).findLast(d=>d.targetStateGen==="origin"),l=s?s.calcValue(this.entity,i??0):i;this.entity.numericStatus.origin[a]=l;let o=l;const c=n.filter(d=>d.targetState===a).filter(d=>d.targetStateGen==="wip").findLast(d=>d.stateOperationType==="Fixation");if(!c)o=n.filter(d=>d.stateOperationType==="Addition").reduce((d,p)=>p.calcValue(this.entity,d),o),this.entity.numericStatus.wip[a]=o;else if(c.isContinuous)o=c.calcValue(this.entity,o),o=n.filter(d=>d.stateOperationType==="Addition").reduce((d,p)=>p.calcValue(this.entity,d),o),this.entity.numericStatus.wip[a]=o;else{let d=!1;o=n.filter(p=>(d=d||p===c,d&&p!==c)).filter(p=>p.stateOperationType==="Addition").reduce((p,f)=>f.calcValue(this.entity,p),r)}o<jr[a]&&(o=jr[a]),this.entity.numericStatus.calculated[a]=o})}}const ze=class ze extends Nt{constructor(a){super(a);u(this,"beforeRemove",()=>{});u(this,"targetState");u(this,"targetStateGen");u(this,"stateOperationType");u(this,"calcValue");u(this,"_isEffective");u(this,"negate",()=>{this._isEffective=!1});this._isEffective=!0,this.targetState=a.targetState,this.targetStateGen=a.targetStateGen,this.stateOperationType=a.stateOperationType,this.calcValue=(i,r)=>a.calcValue(this.isSpawnedBy,i,r)}get isEffective(){return this._isEffective&&super.isEffective}get kind(){if(this.targetStateGen==="origin"){if(this.stateOperationType==="Fixation")return this.isContinuous?"O-C-F":"O-L-F";throw new A("çŸ›ç›¾ã—ãŸãƒ—ãƒ­ãƒ‘ãƒ†ã‚£",this)}if(this.targetStateGen==="wip"){if(this.stateOperationType==="Addition")return this.isContinuous?"C-A":"L-A";if(this.stateOperationType==="Fixation")return this.isContinuous?"C-F":"L-F";throw new A("çŸ›ç›¾ã—ãŸãƒ—ãƒ­ãƒ‘ãƒ†ã‚£",this)}if(this.stateOperationType==="THE_DEVILS_DREAD-ROOT")return"X-C-F";if(this.stateOperationType==="THE_DEVILS_AVATAR"||this.stateOperationType==="Gradius'_Option")return"X-C-X";throw new A("çŸ›ç›¾ã—ãŸãƒ—ãƒ­ãƒ‘ãƒ†ã‚£",this)}};u(ze,"createContinuous",(a,i,r,n,s,l,o,c)=>new ze({title:a,validateAlive:i,isContinuous:!0,isSpawnedBy:r,actionAttr:{},isApplicableTo:n,targetState:s,targetStateGen:l,stateOperationType:o,calcValue:c})),u(ze,"createLingering",(a,i,r,n,s,l,o)=>new ze({title:a,validateAlive:i,isContinuous:!1,isSpawnedBy:r,actionAttr:n,isApplicableTo:(c,d)=>d.isOnFieldAsMonsterStrictly,targetState:s,targetStateGen:"wip",stateOperationType:l,calcValue:o})),u(ze,"createLingeringFixation",(a,i,r,n,s,l)=>ze.createLingering(a,i,r,n,s,"Fixation",l)),u(ze,"createLingeringAddition",(a,i,r,n,s,l)=>ze.createLingering(a,i,r,n,s,"Addition",l));let I=ze;const Au=e=>e!==null&&(typeof e=="object"||typeof e=="function"),Mu=e=>Object.keys(e),Fu={draw:"ãƒ‰ãƒ­ãƒ¼ãƒ•ã‚§ã‚¤ã‚º",standby:"ã‚¹ã‚¿ãƒ³ãƒã‚¤ãƒ•ã‚§ã‚¤ã‚º",main1:"ãƒ¡ã‚¤ãƒ³ãƒ•ã‚§ã‚¤ã‚ºï¼‘",battle1:"ãƒãƒˆãƒ«ãƒ•ã‚§ã‚¤ã‚º",battle2:"ãƒãƒˆãƒ«ãƒ•ã‚§ã‚¤ã‚ºï¼ˆè¿½åŠ ï¼‰",main2:"ãƒ¡ã‚¤ãƒ³ãƒ•ã‚§ã‚¤ã‚ºï¼’",end:"ã‚¨ãƒ³ãƒ‰ãƒ•ã‚§ã‚¤ã‚º"},Ou={start:"ã‚¹ã‚¿ãƒ¼ãƒˆã‚¹ãƒ†ãƒƒãƒ—",battle:"ãƒãƒˆãƒ«ã‚¹ãƒ†ãƒƒãƒ—",damage:"ãƒ€ãƒ¡ãƒ¼ã‚¸ã‚¹ãƒ†ãƒƒãƒ—",end:"ã‚¨ãƒ³ãƒ‰ã‚¹ãƒ†ãƒƒãƒ—"},Nu={start:"ãƒ€ãƒ¡ãƒ¼ã‚¸ã‚¹ãƒ†ãƒƒãƒ—é–‹å§‹æ™‚",beforeDmgCalc:"ãƒ€ãƒ¡ãƒ¼ã‚¸è¨ˆç®—å‰",dmgCalc:"ãƒ€ãƒ¡ãƒ¼ã‚¸è¨ˆç®—æ™‚",afterDmgCalc:"ãƒ€ãƒ¡ãƒ¼ã‚¸è¨ˆç®—å¾Œ",end:"ãƒ€ãƒ¡ãƒ¼ã‚¸ã‚¹ãƒ†ãƒƒãƒ—çµ‚äº†æ™‚"},C=["draw","stanby","main1","b1Start","b1Battle","b1End","b2Start","b2Battle","b2End","main2","end"],M=["b1DStart","b1DBeforeDmgCalc","b1DAfterDmgCalc","b1DEnd","b2DStart","b2DBeforeDmgCalc","b2DAfterDmgCalc","b2DEnd"],Bu=["b1DDmgCalc","b2DDmgCalc"],ae=[...C,...M,...Bu],zr={draw:{phase:"draw",step:void 0,stage:void 0},stanby:{phase:"standby",step:void 0,stage:void 0},main1:{phase:"main1",step:void 0,stage:void 0},b1Start:{phase:"battle1",step:"start",stage:void 0},b1Battle:{phase:"battle1",step:"battle",stage:void 0},b1DStart:{phase:"battle1",step:"battle",stage:"start"},b1DBeforeDmgCalc:{phase:"battle1",step:"battle",stage:"beforeDmgCalc"},b1DDmgCalc:{phase:"battle1",step:"battle",stage:"dmgCalc"},b1DAfterDmgCalc:{phase:"battle1",step:"battle",stage:"afterDmgCalc"},b1DEnd:{phase:"battle1",step:"battle",stage:"end"},b1End:{phase:"battle1",step:"end",stage:void 0},b2Start:{phase:"battle2",step:"start",stage:void 0},b2Battle:{phase:"battle2",step:"battle",stage:void 0},b2DStart:{phase:"battle2",step:"battle",stage:"start"},b2DBeforeDmgCalc:{phase:"battle2",step:"battle",stage:"beforeDmgCalc"},b2DDmgCalc:{phase:"battle2",step:"battle",stage:"dmgCalc"},b2DAfterDmgCalc:{phase:"battle2",step:"battle",stage:"afterDmgCalc"},b2DEnd:{phase:"battle2",step:"battle",stage:"end"},b2End:{phase:"battle2",step:"end",stage:void 0},main2:{phase:"main2",step:void 0,stage:void 0},end:{phase:"end",step:void 0,stage:void 0}},Lu=e=>e.stage?Nu[e.stage]:e.step?Ou[e.step]:Fu[e.phase],Et=Mu(zr).reduce((e,t)=>(e[t].key=t,e[t].name=Lu(e[t]),e),zr),ei=class ei{constructor(t,a){u(this,"entity");u(this,"isRegular");u(this,"_isStarted");u(this,"info");u(this,"continuousEffectBase");u(this,"updateState",async()=>{if(this.hasToStart!==this.isStarted){if(this.isStarted){if(!this.info)throw new A("illegal state");this._isStarted=!1,await this.continuousEffectBase.finish(this.entity,this.info),this.info=void 0;return}this.info=await this.continuousEffectBase.start(this.entity),this._isStarted=!0}});this._isStarted=!1,this.entity=t,this.continuousEffectBase=a,this.isRegular=this.appliableCellTypes.every(i=>me.find(r=>r===i))&&this.faceList.length===1&&this.faceList[0]==="FaceUp"}get isStarted(){return this._isStarted}get appliableCellTypes(){return this.continuousEffectBase.appliableCellTypes}get appliableDuelPeriodKeys(){return this.continuousEffectBase.appliableDuelPeriodKeys}get faceList(){return this.continuousEffectBase.faceList}get hasToStart(){return!this.appliableCellTypes.includes(this.entity.cell.cellType)||!this.appliableDuelPeriodKeys.includes(this.entity.duel.clock.period.key)||!this.faceList.includes(this.entity.face)?!1:this.continuousEffectBase.canStart(this.entity)}};u(ei,"createNew",(t,a)=>new ei(t,a));let $i=ei;const ns=(e,t,a,i)=>({title:e,appliableCellTypes:t==="Monster"?["MonsterZone","ExtraMonsterZone"]:["FieldSpellZone","SpellAndTrapZone"],appliableDuelPeriodKeys:ae,faceList:["FaceUp"],canStart:r=>!r.info.isPending&&!r.info.isDying,start:async r=>{const n=a(r);return n.forEach(i(r).push),n.map(s=>s.seq)},finish:async(r,n)=>{n.forEach(s=>i(r).removeItem(s))}}),vi=(e,t,a,i,r)=>({title:e,appliableCellTypes:t==="Monster"?["MonsterZone","ExtraMonsterZone"]:["FieldSpellZone","SpellAndTrapZone"],appliableDuelPeriodKeys:ae,faceList:["FaceUp"],canStart:n=>!n.info.isPending&&!n.info.isDying,start:async n=>{const s=i(n),l=a(n);return console.info(`start : ${n.toString()} â‡’ ${l.map(o=>o.toString()).join(" ")} (${s.map(o=>o.title).join(" ")})`),l.map(r).forEach(o=>o.push(...s)),{targets:l,seqList:s.map(o=>o.seq)}},finish:async(n,s)=>{s.targets.map(r).forEach(l=>s.seqList.forEach(o=>l.removeItem(o)))}}),gr=(e,t,a)=>ns(e,t,a,i=>i.field.procFilterPool),Ea=(e,t,a,i)=>vi(e,t,a,i,r=>r.procFilterBundle),Ka=(e,t,a)=>ns(e,t,a,i=>i.field.numericStateOperatorPool),ka=(e,t,a,i)=>vi(e,t,a,i,r=>r.numericOprsBundle),Vt=(e,t,a,i)=>vi(e,t,a,i,r=>r.statusOperatorBundle),Ru=(e,t,a,i)=>vi(e,t,a,i,r=>r.damageFilterBundle),mi=e=>e===void 0||e===null?!1:!isNaN(Number(e)),Vr=(...e)=>e.length?e.reduce((t,a)=>t>a?t:a):-Number.MAX_VALUE,ss=(...e)=>e.length?e.reduce((t,a)=>t<a?t:a):Number.MAX_VALUE,qt=(e,t)=>{if((e[0]??Number.MAX_VALUE)>t)return 0;if(e.slice(-1)[0]<t)return e.length;let a=0,i=e.length-1;for(;;){const r=Math.round((a+i)/2);if(r===i||r===a)return e[a]<t?i:a;if(e[r]<t){a=r;continue}i=r}},je=[3,5,5,6,6,6,7,8,9,10,11,11,11,12,12,13,13,14,15,15,15,15,15,15,16,16,16,17,18,18,18,21,21,21,22,23,25,25,26,28,28,28,30,30,31,32,32,33,33,34,35,35,36,36,36,37,37,38,38,38,39,41,42,42,43,45,45,45,45,48,48,48,50,51,52,54,54,54,54,56,57,58,59,59,59,59,60,61,63,65,65,65,65,66,67,67,67,69,69,71,71,72,73,73,73,73,73,74,75,75,76,76,77,78,79,80,80,80,80,84,84,84,84,84,84,85,85,85,87,90,91,94,96,96,97,98,101,101,101,101,101];je.forEach((e,t)=>{((je[qt(je,t)-1]||-Number.MAX_VALUE)>=t||(je[qt(je,t)]||Number.MAX_VALUE)<t)&&console.log(t,qt(je,t),(je[qt(je,t)-1]||-Number.MAX_VALUE)<t,(je[qt(je,t)]||Number.MAX_VALUE)>=t)});const qu=["seq","entityType","origin","cell","kind","nm","lvl","rank","attr","types","atk","def"],Qr=e=>{if(!e)return;const t={};for(const a of qu)t[a]=e[a];return t};class Hu{constructor(t){u(this,"_field");u(this,"_records",[]);u(this,"getIndexOfStartPoint",t=>qt(this._records.map(a=>a.movedAt.totalProcSeq),t));u(this,"push",t=>{this._records.push(t)});u(this,"getCurrentTurnLog",()=>this.getTermLog("Current","turn"));u(this,"getPriviousChainLog",()=>this.getTermLog("Previous","chainSeq"));this._field=t}*getTermLog(t,a){const i=t==="Current"?this._field.duel.clock.currentStartPoints[a]:this._field.duel.clock.previousStartPoints[a];for(let r=this.getIndexOfStartPoint(i);r<this._records.length;r++)yield this._records[r]}}class Zu{constructor(t){u(this,"entity");u(this,"_records");u(this,"_push",t=>{this.entity.field.moveLog.push(t),this._records.push(t)});u(this,"pushForRuleAction",t=>{this._push({entity:this.entity,kind:this.entity.origin.kind,cell:this.entity.cell,face:this.entity.face,orientation:this.entity.orientation,isPending:this.entity.info.isPending,movedAt:this.entity.duel.clock.getClone(),movedAs:[...t,"Rule"]})});u(this,"push",(t,a,i,r,n)=>{let s=this.entity.cell;this.entity.kind==="XyzMaterial"&&(s=this.entity.controller.getXyzMaterialZone()),this._push({entity:this.entity,kind:t,cell:s,face:this.entity.face,orientation:this.entity.orientation,isPending:this.entity.info.isPending,movedAt:this.entity.duel.clock.getClone(),movedAs:a.getDistinct(),movedBy:Qr(i),actionOwner:r,chooser:n??r})});u(this,"finalize",()=>{if(!this.latestRecord.isPending)throw new A("æƒ³å®šã•ã‚Œãªã„çŠ¶æ³");if(this.entity.info.isPending)throw new A("æƒ³å®šã•ã‚Œãªã„çŠ¶æ³");this._push({...this.latestRecord,isPending:!1,movedAt:this.entity.duel.clock.getClone()})});u(this,"negateSummon",(t,a)=>{const i=this.records.slice(-1)[0];i.cell=this.entity.field.getWaitingRoomCell(),i.movedBy=Qr(t),i.movedAs=["SummonNegated"],i.actionOwner=a});this.entity=t,this._records=[]}get records(){return this._records}get latestRecord(){return this.records.slice(-1)[0]}get previousPlaceRecord(){return this.records.findLast(t=>t.cell.cellType!==this.entity.cell.cellType)??this._records[0]}get currentProcRecords(){return this.records.filter(t=>t.movedAt.totalProcSeq===this.entity.duel.clock.totalProcSeq)}get latestArrivalRecord(){if(this.entity.isOnFieldAsMonsterStrictly)return this.records.findLast(t=>t.movedAs.union(["NormalSummon","SpecialSummon","FlipSummon","Flip","ComeBackAlive"]).length)}}const Ht=wo,Wr=Object.values(Ht).filter(e=>e.type==="Actual").filter(e=>e.sticky||e.temporary||!e.isOnlyOnField);if(Wr.length)throw new Error(`ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼ã®è¨­å®šèª¤ã‚Šã€‚${Wr.map(e=>e.name).join(", ")}`);const _h=e=>Ht[e].emoji;class Gu{constructor(t){u(this,"dic");u(this,"temporaryCounterNames");u(this,"entity");u(this,"add",(t,a=1,i)=>{this.dic[t]=[...this.dic[t]??[],...Array(a).fill(i)];const r=this.entity.status.maxCounterQty[t]??0;return r&&(this.dic[t]=this.dic[t].slice(0,r)),this.dic[t]});u(this,"setQty",(t,a=1,i)=>(this.dic[t]=[...Array(a).fill(i)],this.dic[t]));u(this,"remove",(t,a=1,i)=>{const r=this.dic[t].length;if(r===void 0)return[];if(a>=r)return delete this.dic[t],[];if(i){const n=this.dic[t].filter(l=>l===i),s=this.dic[t].filter(l=>l!==i);this.dic[t]=[...n.slice(a),...s]}else this.dic[t]=this.dic[t].slice(a);return this.dic[t]});u(this,"removeAll",(t,a)=>{if(a){const r=this.dic[t].filter(n=>n===a).length;return this.dic[t]=this.dic[t].filter(n=>n!==a),r}const i=this.dic[t];return delete this.dic[t],i});u(this,"getQty",(t,a)=>this.dic[t]?a?this.dic[t].filter(i=>i===a).length:this.dic[t].length??0:0);u(this,"setSelfDestructionFlg",t=>{this.add("SelfDestruction",1,t)});u(this,"getSelfDestructionFlg",t=>this.getQty("SelfDestruction",t)>0);u(this,"setCurfewFlg",t=>{this.add("Curfew",1,t)});u(this,"getCurfewFlg",t=>this.getQty("Curfew",t)>0);u(this,"incrementActionCountPerTurn",t=>{this.temporaryCounterNames.push(t.title),this.incrementActionCount(t)});u(this,"incrementActionCount",t=>{this.dic[t.title]=[t.entity,...this.dic[t.title]??[]]});u(this,"getActionCount",t=>this.dic[t.title]?this.dic[t.title].filter(a=>a===t.entity).length:0);u(this,"corpseDisposal",()=>{this.temporaryCounterNames.forEach(t=>delete this.dic[t]),this.temporaryCounterNames.reset(),Object.values(Ht).filter(t=>t.temporary).forEach(t=>delete this.dic[t.name])});u(this,"removeAllActualCounters",()=>{Object.values(Ht).filter(t=>t.type==="Actual").forEach(t=>delete this.dic[t.name])});u(this,"removeAllWhenfaceDown",()=>{this.temporaryCounterNames.forEach(t=>delete this.dic[t]),this.temporaryCounterNames.reset(),Object.values(Ht).filter(t=>!t.sticky).forEach(t=>delete this.dic[t.name])});u(this,"clear",()=>{this.temporaryCounterNames.forEach(t=>delete this.dic[t]),this.temporaryCounterNames.reset(),Object.values(Ht).filter(t=>t.isOnlyOnField).forEach(t=>delete this.dic[t.name])});this.dic={},this.temporaryCounterNames=[],this.entity=t}}class Uu extends ba{constructor(){super(...arguments);u(this,"afterDistributeAll",a=>a.field.getAllEntities().map(i=>i.statusOperatorBundle).every(i=>i.calcStatus()))}}class $u extends wa{constructor(){super(...arguments);u(this,"calcStatus",()=>{const a=this.entity.isEffective;return this.entity.resetStatus(),this.entity.status=this._operators.filter(i=>i.isSpawnedBy.isEffective||!i.isContinuous).reduce((i,r)=>({...i,...r.statusCalculator(this.entity,r,i)}),this.entity.status),this.entity.isEffective===a});u(this,"beforePush",()=>{});u(this,"afterPush",()=>{this.calcStatus()})}}class ee extends Nt{constructor(a){super(a);u(this,"beforeRemove",()=>{});u(this,"statusCalculator");this.statusCalculator=a.statusCalculator}}const la=class la extends ha{constructor(){super(...arguments);u(this,"isApplicableTo",(...a)=>{const i=this.entity.counterHolder.getActionCount(this);return this.isOnlyNTimesPerTurnIfFaceup>0&&i>=this.isOnlyNTimesPerTurnIfFaceup?this.entity.counterHolder.incrementActionCountPerTurn(this):this.isOnlyNTimesIfFaceup>0&&i>=this.isOnlyNTimesIfFaceup&&this.entity.counterHolder.incrementActionCount(this),this.definition.isApplicableTo(this,...a)});u(this,"substitute",async(a,i,r)=>{const n=await this.definition.substitute(this,a,i,r);return this.isOnlyNTimesPerTurnIfFaceup>0?this.entity.counterHolder.incrementActionCountPerTurn(this):this.isOnlyNTimesIfFaceup>0&&this.entity.counterHolder.incrementActionCount(this),n});u(this,"getClone",()=>new la(this.seq,this.entity,this.definition))}get definition(){return super.definition}};u(la,"createNew",(a,i)=>new la("AutoSeq",a,i));let ji=la;class ju extends ba{constructor(){super(...arguments);u(this,"afterDistributeAll",()=>!0)}}class zu extends wa{constructor(){super(...arguments);u(this,"beforePush",()=>{});u(this,"afterPush",()=>{});u(this,"filter",(a,i,r,n,s,l,o)=>this.effectiveOperators.filter(c=>c.summonKinds.includes(i)).reduce((c,d)=>({...c,...d.filter(this.entity,a,s.summoner,[i,...r],n,s.monster,l,c.posList,c.cells,o)}),s))}}class Vu extends Nt{constructor(a){super(a);u(this,"beforeRemove",()=>{});u(this,"summonKinds");u(this,"filter");this.summonKinds=a.summonKinds,this.filter=(...i)=>a.filter(this,...i)}}const Z=class Z{constructor(){}};u(Z,"_tryMarkForDestroy",(t,a)=>{if(t.info.isDying||t.kind==="XyzMaterial"||!t.isOnFieldStrictly&&t.cell.cellType!=="Deck"&&t.cell.cellType!=="Hand")return!1;const i=a.action.playType==="Battle"?"Battle":"Effect",r=i==="Battle"&&a.action.entity===t?a.selectedEntities[0]:a.action.entity;return t.info.isDying=t.validateDestroy(i,a.activator,r,a.action),t.info.isDying&&(t.info.causeOfDeath=[i,"Destroy"],t.info.isKilledBy=r,t.info.isKilledByWhom=a.activator,i==="Battle"&&(t.info.isKilledByWhom=r.controller)),t.info.isDying}),u(Z,"excavateFromDeck",async(t,a,i,r)=>{const n=await Z.excavateManyFromDeck(t,1,a,i,r);return n.length?n[0]:void 0}),u(Z,"excavateManyFromDeck",async(t,a,i,r,n)=>{const s=t.getDeckCell().cardEntities.slice(0,a);return await L.moveMany(s.map(l=>({entity:l,to:l.cell,kind:l.kind,face:"FaceUp",orientation:l.orientation,pos:"Fix",movedAs:["Excavate",...i],movedBy:r,actionOwner:n,chooser:void 0}))),s}),u(Z,"releaseManyForTheSameReason",(t,a,i,r)=>t.length?(a.includes("Cost")&&r.writeInfoLog(`${t.map(n=>n.toString()).join(" ")}ã‚’ãƒªãƒªãƒ¼ã‚¹ã—â€•â€•ã€`),Z.bringManyToSameCellForTheSameReason("Graveyard","Top",t,"FaceUp","Vertical",["Release",...a],i,r)):Promise.resolve([])),u(Z,"sendManyToGraveyardForTheSameReason",(t,a,i,r)=>t.length?(r&&a.includes("Cost")&&(a.includes("FusionMaterial")?r.writeInfoLog(`${t.map(n=>n.toString()).join(" ")}ã‚’èžåˆç´ æã¨ã—â€•â€•ã€`):a.includes("SynchroMaterial")?r.writeInfoLog(`${t.map(n=>n.toString()).join(" ")}ã‚’ã‚·ãƒ³ã‚¯ãƒ­ã¨ç´ æã—â€•â€•ã€`):a.includes("LinkMaterial")?r.writeInfoLog(`${t.map(n=>n.toString()).join(" ")}ã‚’ãƒªãƒ³ã‚¯ãƒžãƒ¼ã‚«ãƒ¼ã«ã‚»ãƒƒãƒ†ã‚£ãƒ³ã‚°â€•â€•ã€`):r.writeInfoLog(`${t.map(n=>n.toString()).join(" ")}ã‚’å¢“åœ°ã«é€ã‚Šâ€•â€•ã€`)),Z.bringManyToSameCellForTheSameReason("Graveyard","Top",t,"FaceUp","Vertical",a,i,r)):Promise.resolve([])),u(Z,"addManyToHand",(t,a,i,r)=>t.length?Z.bringManyToSameCellForTheSameReason("Hand","Bottom",t,"FaceDown","Vertical",a,i,r):Promise.resolve([])),u(Z,"discardManyForTheSameReason",(t,a,i,r)=>t.length?(r&&a.includes("Cost")&&r.writeInfoLog(`${t.map(n=>n.toString()).join(" ")}ã‚’æ‰‹æœ­ã‹ã‚‰æ¨ã¦â€•â€•ã€`),Z.bringManyToSameCellForTheSameReason("Graveyard","Top",t,"FaceUp","Vertical",["Discard",...a],i,r)):Promise.resolve([])),u(Z,"banishManyForTheSameReason",(t,a,i,r)=>t.length?(r&&a.includes("Cost")&&r.writeInfoLog(`${t.map(n=>n.toString()).join(" ")}ã‚’ã‚²ãƒ¼ãƒ ã‹ã‚‰é™¤å¤–ã—â€•â€•ã€`),Z.bringManyToSameCellForTheSameReason("Banished","Top",t,"FaceUp","Vertical",a,i,r)):Promise.resolve([])),u(Z,"returnManyToDeckForTheSameReason",(t,a,i,r,n)=>a.length?(n&&i.includes("Cost")&&n.writeInfoLog(`${a.map(s=>s.toString()).join(" ")}ã‚’ãƒ‡ãƒƒã‚­ã«æˆ»ã—â€•â€•ã€`),Z.bringManyToSameCellForTheSameReason("Deck",t,a,"FaceDown","Vertical",i,r,n)):Promise.resolve([])),u(Z,"returnManyToHandForTheSameReason",(t,a,i,r)=>t.length?(r&&a.includes("Cost")&&r.writeInfoLog(`${t.map(n=>n.toString()).join(" ")}ã‚’æ‰‹æœ­ã«æˆ»ã—â€•â€•ã€`),Z.bringManyToSameCellForTheSameReason("Hand","Bottom",t,"FaceDown","Vertical",a,i,r)):Promise.resolve([])),u(Z,"convertManyToXyzMaterials",(t,a,i,r)=>t.length?(r&&a.includes("Cost")&&r.writeInfoLog(`${t.map(n=>n.toString()).join(" ")}ã«ã‚ˆã£ã¦ã€ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚’æ§‹ç¯‰â€•â€•ã€`),L.moveMany(t.map(n=>({entity:n,to:n.cell,kind:"XyzMaterial",face:"FaceUp",orientation:"Vertical",pos:"Top",movedAs:a,movedBy:i,actionOwner:r,chooser:r})))):Promise.resolve()),u(Z,"moveToXyzOwner",async(t,a,i,r,n,s)=>{i.length&&(await L.moveMany(i.map(l=>({entity:l,to:t,kind:"XyzMaterial",face:"FaceUp",orientation:"Vertical",pos:"Top",movedAs:r,movedBy:n,actionOwner:s,chooser:s}))),i.forEach(l=>l.info.xyzOwner=a))}),u(Z,"banishMany",(t,a)=>L.bringManyToSameCell("Banished","Top",t.map(i=>({...i,face:"FaceUp",orientation:"Vertical"})),a)),u(Z,"bringManyToSameCellForTheSameReason",(t,a,i,r,n,s,l,o)=>L.bringManyToSameCell(t,a,i.map(c=>({entity:c,face:r,orientation:n,movedAs:s,movedBy:l,activator:o})))),u(Z,"tryDestroy",async(t,a)=>{const i=await Z.tryMarkForDestroy(t,a);return await Z.waitCorpseDisposal(a.activator.duel),i}),u(Z,"waitCorpseDisposal",(t,a={})=>{const i=a.excludedList??[];let r=t.field.getDyingCardsOnField().filter(n=>n.info.isDying).filter(n=>!i.includes(n));return t.clock.period.stage!=="end"&&(r=r.filter(n=>!n.info.causeOfDeath.includes("Battle"))),L.sendManyToGraveyard(r.map(n=>({entity:n,movedAs:n.info.causeOfDeath??[],movedBy:n.info.isKilledBy,activator:n.info.isKilledByWhom})))}),u(Z,"tryMarkForDestroy",async(t,a)=>{let i=t.filter(l=>Z._tryMarkForDestroy(l,a));if(!i.length)return[];const r=a.action.playType==="Battle"?"Battle":"Effect";(await Promise.all(t[0].field.getAllEntities().flatMap(l=>l.substituteEffects.filter(o=>o.isMandatory).filter(o=>o.executableCells.includes(l.cell.cellType)).filter(o=>o.isApplicableTo(r,t,a).length).flatMap(o=>o.substitute(r,t,a))))).flatMap(l=>l).forEach(l=>{l.resetCauseOfDeath()}),i=i.filter(l=>l.info.isDying);let n=t[0].field.getAllEntities().flatMap(l=>l.substituteEffects.filter(o=>!o.isMandatory).filter(o=>o.executableCells.includes(l.cell.cellType)).filter(o=>o.isApplicableTo(r,t,a).length).map(o=>({chooser:l.owner,effect:o,sacrifice:l})));for(const l of n.map(o=>o.sacrifice.controller).getDistinct()){const o=n.filter(d=>d.sacrifice.controller===l),c=await l.duel.view.waitSelectAction(l,o.map(d=>({entity:d.sacrifice,title:d.effect.title,origin:d.effect})),"èº«ä»£ã‚ã‚ŠåŠ¹æžœã‚’é©ç”¨ã™ã‚‹ï¼Ÿ",!0);if(c){if((await c.substitute(r,i,a)).forEach(d=>{d.resetCauseOfDeath()}),i=i.filter(d=>d.info.isDying),!i.length)return[];n=n.filter(d=>d.effect.isApplicableTo(r,t,a).length)}}const s=i.filter(l=>l.info.isDying);return s.forEach(l=>l.duel.log.info(`${l.toString()}ã‚’${r==="Battle"?"æˆ¦é—˜":r==="Effect"?"åŠ¹æžœ":"ãƒ«ãƒ¼ãƒ«"}ç ´å£Šã€‚`,l.info.isKilledByWhom)),s}),u(Z,"tryBanish",async(t,a,i)=>{const r=a.filter(n=>n.canBeBanished(t,i.activator,i.action.entity,i.action));return await Z.banishManyForTheSameReason(r,["Effect"],i.action.entity,i.activator),r.filter(n=>n.cell.cellType==="Banished").filter(n=>n.moveLog.latestRecord.movedBy===i.action.entity)}),u(Z,"negateSummonMany",(t,a)=>{const i=a.duel.field.getPendingMonstersOnField();return i.forEach(r=>{r.info.summonKinds=[],r.info.materials=[],r.moveLog.negateSummon(t,a)}),a.writeInfoLog(`${i.map(r=>r.toString()).join(" ")}.ã®å¬å–šã¯ç„¡åŠ¹ã«ã•ã‚ŒãŸã€‚`),i}),u(Z,"drawAtSameTime",async(t,a,i,r)=>{const n=[],s=[],l=[t.draw(i,a,t),t.getOpponentPlayer().draw(r,a,t)].map(o=>o.catch(c=>{c instanceof ue?c.winner&&n.push(c.winner):s.push(c)}));if(await Promise.all(l),s.length)throw new A("ãƒ‰ãƒ­ãƒ¼å‡¦ç†ã§æƒ³å®šã•ã‚Œãªã„ä¾‹å¤–ãŒç™ºç”Ÿã—ãŸã€‚",t,i,r,a,...s);if(n.length!==0)throw n.length===1?new ue(n[0],`${n[0].getOpponentPlayer().name}ãŒãƒ‡ãƒƒã‚­ã‹ã‚‰ãƒ‰ãƒ­ãƒ¼ã§ããªã‹ã£ãŸã€‚`):new ue(void 0,"ãŠäº’ã„ã«ãƒ‡ãƒƒã‚­ã‹ã‚‰ã‚«ãƒ¼ãƒ‰ã‚’ãƒ‰ãƒ­ãƒ¼ã§ããªã‹ã£ãŸã€‚")});let S=Z;class Qu extends ba{constructor(){super(...arguments);u(this,"afterDistributeAll",()=>!0)}}class Wu extends wa{constructor(){super(...arguments);u(this,"beforePush",()=>{});u(this,"afterPush",()=>{})}}class ls extends Nt{constructor(a){super(a);u(this,"beforeRemove",()=>{});u(this,"calcType");u(this,"filter");this.calcType=a.calcType,this.filter=(...i)=>a.filter(this,...i)}}const Di=(e,t,...a)=>e.filter(i=>t.includes(i.calcType)).reduce((i,r)=>({...i,...r.filter(...a)}),{}),os=(...e)=>{const[t,a,i,r,n,s,l]=e,o=[i.entity,r,n].filter(p=>!!p).flatMap(p=>p.damageFilterBundle.effectiveOperators);let c=Di(o,["double_typeA","eachOther_typeA","eachOther_typeB","asEffectDamage"],...e);const d={damageSource:r,point:t,damageToOpponent1:0,damageToOpponent2:0,damageType:s};return c.double_typeA&&(d.point*=2),c.asEffectDamage&&(d.damageType="EffectDamage"),c={...Di(o,["heal","zero_typeA","half","double_typeB","fix"],d.point,a,i,r,n,d.damageType,l),...c},c.fix!==void 0?d.point=c.fix:c.zero_typeA?d.point=0:(c.half&&(d.point=Math.round(d.point/2)),c.double_typeA&&(d.point*=2)),c={...Di(o,["zero_typeB"],d.point,a,i,r,n,d.damageType,l),...c},c.zero_typeB&&(d.point=0),c.heal?d.damageType="Heal":(c.eachOther_typeA&&(d.damageToOpponent1=d.point),c.eachOther_typeB&&(d.damageToOpponent2=d.point,c.eachOther_typeB==="Substitude"&&(d.point=0))),d},Xu=(e,t,a)=>os(e,t.activator,a,t.action.entity,void 0,"EffectDamage",t.action),Ku=(e,t,a,i,r,n)=>os(e,t,a,i,r.entityType==="Duelist"?void 0:r,"BattleDamage",n),ya=e=>new Promise(t=>setTimeout(t,e)),_i=()=>{let e=()=>{},t=()=>{};return{promise:new Promise((i,r)=>{e=i,t=r}),resolve:e,reject:t}},ti=class ti extends ha{constructor(a,i,r){super(a,i,{...r,playType:"ContinuousEffect",isMandatory:!1,executableDuelistTypes:["Controller"]});u(this,"toString",()=>this.title);u(this,"toFullString",()=>`${this.entity.toString()}ã®${this.toString()}`);u(this,"execute",async(a,i)=>{if(!this.canExecute())return;const r=await this.definition.execute(this,a,i);return r==="RemoveMe"&&this.entity.immediatelyActions.reset(...this.entity.immediatelyActions.filter(n=>n!==this)),r})}get definition(){return super.definition}get playType(){return this.definition.playType}};u(ti,"createNew",(a,i)=>new ti("AutoSeq",a,i));let zi=ti;const hr=["FaceUp","FaceDown"],cs=["FusionSummon","SynchroSummon","XyzSummon","PendulumSummon","LinkSummon","RitualSummon","FlipSummon"],Yu={FusionSummon:"èžåˆå¬å–š",SynchroSummon:"ã‚·ãƒ³ã‚¯ãƒ­å¬å–š",XyzSummon:"ã‚¨ã‚¯ã‚·ãƒ¼ã‚ºå¬å–š",PendulumSummon:"ãƒšãƒ³ãƒ‡ãƒ¥ãƒ©ãƒ å¬å–š",LinkSummon:"ãƒªãƒ³ã‚¯å¬å–š",RitualSummon:"å„€å¼å¬å–š",FlipSummon:"åè»¢å¬å–š"},us=[...cs,"AdvanceSummon","NormalSummon","SpecialSummon"];[...us];const Xr={Battle:"æˆ¦é—˜",Effect:"åŠ¹æžœ",Rule:"ãƒ«ãƒ¼ãƒ«"},Ju=e=>e+"Summon",Kr=["Card","Token"],Iu=["Duelist","Squatter"],ed=(e,t)=>es(e.origin,t.origin),z=class z{constructor(t,a,i,r,n,s,l){u(this,"isSame",t=>this.seq===t.seq);u(this,"seq");u(this,"origin");u(this,"entityType");u(this,"summonFilterBundle");u(this,"procFilterBundle");u(this,"numericOprsBundle");u(this,"statusOperatorBundle");u(this,"damageFilterBundle");u(this,"moveLog");u(this,"counterHolder");u(this,"_parent");u(this,"face");u(this,"orientation");u(this,"owner");u(this,"cell");u(this,"_status");u(this,"_numericStatus");u(this,"_info");u(this,"actions",[]);u(this,"immediatelyActions",[]);u(this,"continuousEffects",[]);u(this,"substituteEffects",[]);u(this,"canBeReleased",(t,a,i,r)=>!this.isInTrashCell&&this.procFilterBundle.filter(i,t,a,r,[this]));u(this,"canBeSentToGraveyard",(t,a,i,r)=>!this.status.willBeBanished&&!this.status.willReturnToDeck&&this.procFilterBundle.filter([i],t,a,r,[this]));u(this,"_exists",!0);u(this,"validateFusionMaterials",t=>this.definition.fusionMaterialInfos?this.definition.validateFusionMaterials?this.definition.validateFusionMaterials(t):!0:!1);u(this,"definition");u(this,"toString",()=>{let t=this.nm;return this.nm!==this.origin.name&&(t=`${t}(${this.origin.name})`),this.entityType==="Card"?`ã€Š${t}ã€‹`:t});u(this,"onUsedAsMaterial",(t,a)=>{this.definition.onUsedAsMaterial&&this.definition.onUsedAsMaterial(this,t,a)});u(this,"setBattlePosition",async(t,a,i,r)=>{let n=`è¡¨ç¤ºå½¢å¼ã®å¤‰æ›´ï¼š${this.toString()}ï¼ˆ${this.battlePositionName}â‡’${La[t]}ï¼‰`;const s=[...a];this.battlePosition==="Set"&&(s.push("Flip"),a.includes("Rule")&&(this.info.isPending=!0,n=`${this.toString()}ã‚’åè»¢å¬å–š`,this.info.summonKinds.push("FlipSummon"),s.push("FlipSummon"),s.push("AttackSummon"))),this.duel.log.info(n,r),await this.moveAlone(this.cell,"Monster",t==="Set"?"FaceDown":"FaceUp",t==="Attack"?"Vertical":"Horizontal","Top",s,i,r,r)});u(this,"activateAsPendulumScale",(t,a,i,r)=>this.moveAlone(t,"Spell","FaceUp","Vertical","Top",["CardActivation",...a],i,r,r));u(this,"setNonFieldMonsterPosition",async(t,a,i,r,n)=>{this.moveAlone(this.cell,t,a==="FaceUp"?"FaceUp":"FaceDown","Vertical","Top",i,r,n,n)});u(this,"setAsSpellTrap",async(t,a,i,r,n)=>{await this.moveAlone(t,a,"FaceDown","Vertical","Top",[...i,"SpellTrapSet"],r,n,n)});u(this,"activateSpellTrapFromHand",async(t,a,i,r,n)=>{await this.moveAlone(t,a,"FaceUp","Vertical","Top",[...i,"CardActivation"],r,n,n)});u(this,"putDirectly",async(t,a,i,r,n)=>{await this.moveAlone(t,a,"FaceUp","Vertical","Top",[...i,"PutDirectly"],r,n,n)});u(this,"activateSpellTrapOnField",async(t,a,i,r)=>{await this.moveAlone(this.cell,t,"FaceUp","Vertical","Top",[...a,"CardActivation"],i,r,r)});u(this,"draw",async(t,a,i)=>await this.addToHand([...t,"Draw"],a,i));u(this,"addToHand",async(t,a,i)=>await this.moveAlone(this.owner.getHandCell(),this.origin.kind,"FaceDown","Vertical","Bottom",[...t],a,i,i));u(this,"summon",(t,a,i,r,n,s,l)=>z.summonMany([{monster:this,dest:t,summoner:l??s,pos:a}],i,r,n,s));u(this,"moveForcibly",async(t,a,i,r,n,s,l)=>{await this.moveAlone(t,this.origin.kind,a,i,r,["Rule",...n],s,l,l)});u(this,"excavate",async(t,a,i)=>this.moveAlone(this.cell,this.kind,"FaceUp",this.orientation,"Fix",["Excavate",...t],a,i,void 0));u(this,"moveAlone",async(t,a,i,r,n,s,l,o,c)=>(await z.moveMany([{entity:this,to:t,kind:a,face:i,orientation:r,pos:n,movedAs:s,movedBy:l,actionOwner:o,chooser:c}],void 0),this.cell));u(this,"determine",async()=>{this.info.isPending&&(this.info.isPending=!1,this.moveLog.finalize(),this.continuousEffects.forEach(t=>t.updateState()),await this.field.distributeOperators(this.duel.clock),await this.fireImmediatelyActions(),await S.waitCorpseDisposal(this.duel))});u(this,"_move",async t=>{var n,s;if(!t.to)throw new Error("illegal argument: to");const a={cell:this.cell,status:this.status,info:this.info};this.face=t.face,this.orientation=t.orientation;let i=!1,r=t.actionOwner;if(!r&&t.movedAs.includes("LostDestinyBond")){console.log(this.toString(),(n=this.info.equipedBy)==null?void 0:n.toString(),(s=this.info.xyzOwner)==null?void 0:s.toString());const l=this.info.equipedBy??this.info.xyzOwner;l&&(r=l.moveLog.latestRecord.actionOwner)}return t.to!==this.cell&&(this.duel.log.pushMoveLog(r,this,this.cell,t.to),this.cell.cellType==="WaitingRoom"?i=!0:t.to.cellType==="WaitingRoom"?(this._exists=!1,await this.duel.view.waitTokenAnimation()):this.field.duel.clock.turn&&await this.field.duel.view.waitAnimation({entity:this,to:t.to,index:t.pos,count:0})),(t.to!==this.cell||t.pos==="Random")&&(this.cell.releaseEntities(this),this.cell.isPlayFieldCell&&!t.to.isPlayFieldCell&&(this.counterHolder.clear(),this.resetCauseOfDeath()),this.cell.isMonsterZoneLikeCell&&!t.to.isMonsterZoneLikeCell||t.kind!=="Monster"?(this.resetNumericStatus(),this.info.isEffectiveIn.push(...me),this.info.equipEntities.filter(l=>l.isOnFieldAsSpellTrapStrictly).forEach(l=>{l.info.isDying=!0,l.info.causeOfDeath=["Rule","Destroy","LostEquipOwner","LostDestinyBond"],this.controller.writeInfoLog(`è£…å‚™å¯¾è±¡${this.toString()}ä¸åœ¨ã«ã‚ˆã‚Š${l.toString()}ã¯ç ´å£Šã•ã‚ŒãŸã€‚`)}),this.info.equipEntities=[],this.kind!=="XyzMaterial"&&this.cell.xyzMaterials.forEach(l=>{l.info.isDying=!0,l.info.causeOfDeath=["LostXyzOwner","LostDestinyBond"],this.controller.writeInfoLog(`${this.toString()}ä¸åœ¨ã«ã‚ˆã‚Šã€XYZç´ æ${l.toString()}ã¯å¢“åœ°ã«é€ã‚‰ã‚ŒãŸã€‚`)})):this.cell.cellType==="SpellAndTrapZone"&&t.to.cellType!=="SpellAndTrapZone"&&(this.info.equipedBy=void 0,this.info.equipedAs=void 0,this.info.isEffectiveIn.push(...me)),t.to.acceptEntities(this,t.pos),i&&(await ya(1),this._exists=!0,await this.duel.view.waitTokenAnimation()),(t.to===this.isBelongTo||t.to.cellType==="Hand"||t.to.cellType==="Banished"&&this.face==="FaceDown")&&(this.counterHolder.clear(),this.resetInfoAll(),this.resetStatusAll())),(this.isOnFieldStrictly&&this.face==="FaceDown"||t.kind==="XyzMaterial")&&(this.info.equipEntities.forEach(l=>{l.info.isDying=!0,l.info.causeOfDeath=["Rule","Destroy","LostEquipOwner","LostDestinyBond"],this.controller.writeInfoLog(`è£…å‚™å¯¾è±¡${this.toString()}ä¸åœ¨ã«ã‚ˆã‚Š${l.toString()}ã¯ç ´å£Šã•ã‚ŒãŸã€‚`)}),this.counterHolder.removeAllWhenfaceDown(),this.info.materials=[],this.status={...this._status,isEffective:!0},this.info.isEffectiveIn=[...Ke],this.resetNumericStatus(),this.info.isSettingSickness=this.kind==="Trap"||this.status.spellCategory==="QuickPlay"),this._info.kind=t.kind,this.moveLog.push(t.kind,t.movedAs,t.movedBy,t.actionOwner,t.chooser),t.movedAs.includes("NonEffectiveSummon")||await this.fireImmediatelyActions(a),t.to});u(this,"fireImmediatelyActions",async t=>{for(const a of[this,...this.field.getCardsOnFieldStrictly()].getDistinct().filter(i=>i.immediatelyActions.length).toSorted((i,r)=>{var n,s;return(((n=i.hadArrivedToFieldAt())==null?void 0:n.totalProcSeq)??Number.MAX_SAFE_INTEGER)-(((s=r.hadArrivedToFieldAt())==null?void 0:s.totalProcSeq)??Number.MAX_SAFE_INTEGER)}).flatMap(i=>i.immediatelyActions))await a.execute(this,t)});u(this,"initForTurn",()=>{this.info.isSettingSickness=!1,this.info.attackDeclareCount=0,this.info.battlePotisionChangeCount=0,this.counterHolder.corpseDisposal()});u(this,"resetInfoIfLeavesTheField",()=>{this._info={...this._info,isDying:!1,isPending:!1,causeOfDeath:[],isKilledBy:void 0,isKilledByWhom:void 0,effectTargets:{},attackDeclareCount:0,battlePotisionChangeCount:0,materials:[],equipedBy:void 0,equipedAs:void 0,equipEntities:[]},this._info.isEffectiveIn.push(...me),this._info.isEffectiveIn.distinct()});u(this,"resetInfoAll",()=>{var t;this._info={kind:this.origin.kind,isDying:!1,isPending:!1,isEffectiveIn:[...Ke],causeOfDeath:[],isKilledBy:void 0,isKilledByWhom:void 0,isVanished:!1,isRebornable:((t=this.origin.monsterCategories)==null?void 0:t.union(Xn).length)===0,isSettingSickness:!1,summonKinds:[],materials:[],effectTargets:{},attackDeclareCount:0,battlePotisionChangeCount:0,equipedBy:void 0,equipedAs:void 0,validateEquipOwner:()=>!0,equipEntities:[],xyzOwner:void 0,battleLog:[]},this.counterHolder.clear()});u(this,"resetNumericStatus",()=>{const t=Jn.reduce((a,i)=>(a[i]=this.origin[i],a),{});this._numericStatus={origin:{...t},wip:{...t},calculated:{...t}}});u(this,"negate",()=>{this.status={...this.status,isEffective:!1}});u(this,"resetStatus",()=>{this.status={...this.origin,canBattlePositionChange:!0,canAttack:!0,canDirectAttack:!1,canActivateEffect:!0,isEffective:!0,isFaithful:!1,isSelectableForAttack:!0,allowHandSynchro:!1,allowHandLink:!1,willBeBanished:!1,willReturnToDeck:void 0,fusionSubstitute:!1,maxCounterQty:{},piercingTo:[]}});u(this,"resetStatusAll",()=>{this.resetNumericStatus(),this.resetStatus()});u(this,"resetCauseOfDeath",()=>{this.info.isDying=!1,this.info.causeOfDeath=[],this.info.isKilledBy=void 0,this.info.isKilledByWhom=void 0});this.seq=z.nextEntitySeq++,this.counterHolder=new Gu(this),this.definition=r,this.owner=t,this.cell=a,this.entityType=i,this._parent=l,this.origin=r.staticInfo,this._status=JSON.parse(JSON.stringify(r.staticInfo)),this._numericStatus=JSON.parse(JSON.stringify(r.staticInfo)),this.resetStatusAll(),this._info={kind:this.origin.kind,isEffectiveIn:[...Ke],attackDeclareCount:0,battlePotisionChangeCount:0,isDying:!1,isPending:!1,causeOfDeath:[],isKilledBy:void 0,isKilledByWhom:void 0,isVanished:!1,isRebornable:!0,isSettingSickness:!1,summonKinds:[],materials:[],effectTargets:{},equipedBy:void 0,equipedAs:void 0,validateEquipOwner:()=>!0,equipEntities:[],xyzOwner:void 0,battleLog:[]},this.resetInfoAll(),this.face=n,this.orientation=s,this.summonFilterBundle=new zu(a.field.summonFilterPool,this),this.procFilterBundle=new Du(a.field.procFilterPool,this),this.numericOprsBundle=new Pu(a.field.numericStateOperatorPool,this),this.statusOperatorBundle=new $u(a.field.statusOperatorPool,this),this.damageFilterBundle=new Wu(a.field.damageFilterPool,this),this._exists=this.entityType==="Card",a.acceptEntities(this,"Top"),this.moveLog=new Zu(this),this.moveLog.pushForRuleAction(["Spawn"]);let o=r.continuousEffects??[];this.substituteEffects.push(...(r.substituteEffects??[]).map(c=>ji.createNew(this,c))),this.origin.kind==="Monster"&&(this.entityType==="Card"||this.entityType==="Token")&&r.summonFilter&&this.summonFilterBundle.push(new Vu({title:"default",validateAlive:()=>!0,isContinuous:!0,isSpawnedBy:this,actionAttr:{},isApplicableTo:()=>!0,summonKinds:us,filter:r.summonFilter})),r.defaultStatus&&this.statusOperatorBundle.push(new ee({title:"default",validateAlive:()=>!0,isContinuous:!0,isSpawnedBy:this,actionAttr:{},isApplicableTo:()=>!0,statusCalculator:()=>r.defaultStatus??{}})),this.actions.push(...r.actions.map(c=>Mt.createNew(this,c))),this.immediatelyActions.push(...(r.immediatelyActions??[]).map(c=>zi.createNew(this,c))),this.continuousEffects.push(...o.map(c=>$i.createNew(this,c)))}get parent(){return this._parent}get isUnderControl(){return this.face==="FaceUp"||ts.every(t=>t!==this.cell.cellType)}get controller(){return this.cell.owner??this.owner}get field(){return this.owner.duel.field}get duel(){return this.owner.duel.field.duel}get actionLogRecords(){return this.duel.chainBlockLog.records.filter(t=>t.chainBlockInfo.action.entity===this)}get status(){return this._status}set status(t){this._status={...t}}get numericStatus(){return this._numericStatus}get info(){return this._info}get kind(){return this.info.kind}get nm(){return this.status.name}get atk(){return this._numericStatus.calculated.attack}get def(){return this._numericStatus.calculated.defense}get lvl(){return this._numericStatus.calculated.level}get rank(){return this._numericStatus.calculated.rank}get attr(){return this.status.attributes??[]}get types(){return this.status.types??[]}get psL(){return this._numericStatus.calculated.pendulumScaleL}get psR(){return this._numericStatus.calculated.pendulumScaleR}get linkArrows(){let t=(this.origin.linkArrowKeys??[]).map(a=>pr[a].linkArrow);return this.controller.seat==="Above"&&(t=t.map(a=>({offsetColumn:a.offsetColumn*-1,offsetRow:a.offsetRow*-1}))),t}get linkArrowDests(){var t;return(t=this.origin.monsterCategories)!=null&&t.includes("Link")?this.cell.isMonsterZoneLikeCell?this.linkArrows.map(a=>[this.cell.row+a.offsetRow,this.cell.column+a.offsetColumn]).map(([a,i])=>this.field.cells[a][i]).filter(a=>a.isMonsterZoneLikeCell):[]:[]}get pointedToEntities(){return this.isOnFieldAsMonsterStrictly?[...this.linkArrowDests.map(t=>t.cardEntities[0]).filter(t=>t)]:[]}get linkArrowSources(){return this.isOnFieldAsMonsterStrictly?[...this.cell.linkArrowSources]:[]}get linkedEntities(){return this.isOnFieldAsMonsterStrictly?[...this.linkArrowDests.map(t=>t.cardEntities[0]).filter(t=>t),...this.cell.linkArrowSources].getDistinct():[]}get coLinkedEntities(){var t;return this.cell.isMonsterZoneLikeCell?(t=this.origin.monsterCategories)!=null&&t.includes("Link")?this.linkArrowDests.map(a=>a.cardEntities[0]).filter(a=>a).union(this.cell.linkArrowSources):[]:[]}get isEffective(){return this.status.isEffective&&this.info.isEffectiveIn.includes(this.cell.cellType)}get canBeSet(){var t;return this.entityType==="Card"&&!((t=this.status.monsterCategories)!=null&&t.includes("Link"))}get isEffectiveWeakly(){return this.status.isEffective}get battlePosition(){if(this.isOnFieldStrictly&&this.kind==="Monster")return this.orientation==="Vertical"?"Attack":this.face==="FaceUp"?"Defense":"Set"}get battlePositionName(){const t=this.battlePosition;if(t)return La[t]}get wasMovedAtCurrentProc(){return this.field.duel.clock.totalProcSeq===this.moveLog.latestRecord.movedAt.totalProcSeq}get wasMovedAtPreviousProc(){return this.field.duel.clock.totalProcSeq===this.moveLog.latestRecord.movedAt.totalProcSeq+1}get wasMovedAtCurrentTurn(){return this.field.duel.clock.isSameTurn(this.moveLog.latestRecord.movedAt)}get wasMovedAtCurrentChain(){return this.field.duel.clock.isSameChain(this.moveLog.latestRecord.movedAt)}get wasMovedAtPreviousChain(){return this.field.duel.clock.isPreviousChain(this.moveLog.latestRecord.movedAt)}get wasMovedAtPreviousTurn(){return this.field.duel.clock.isPreviousTurn(this.moveLog.latestRecord.movedAt)}get wasMovedFrom(){return this.moveLog.previousPlaceRecord.cell}get isPendulumScale(){var t;return!(!((t=this.origin.monsterCategories)!=null&&t.includes("Pendulum"))||!this.isOnField||!this.cell.isSpellTrapZoneLikeCell||this.status.spellCategory)}get isOnField(){return this.cell.isPlayFieldCell}get isOnFieldStrictly(){return this.isOnField&&!this.info.isPending&&!this.info.isDying&&this.kind!=="XyzMaterial"}get isOnFieldAsMonsterStrictly(){return this.cell.isMonsterZoneLikeCell&&this.isOnFieldStrictly}get isMonster(){return this.isOnFieldAsMonsterStrictly||this.kind==="Monster"}get isOnFieldAsSpellTrapStrictly(){return this.isOnFieldStrictly&&(this.kind==="Spell"||this.kind==="Trap")}get isInTrashCell(){return this.cell.isTrashCell}get isLikeContinuousSpell(){return this.status.spellCategory==="Continuous"||this.status.spellCategory==="Field"||this.status.spellCategory==="Equip"||this.status.trapCategory==="Continuous"||(this.status.monsterCategories??[]).includes("Pendulum")}get isBelongTo(){return this.origin.monsterCategories&&this.origin.monsterCategories.union(At).length?this.owner.getExtraDeck():this.owner.getDeckCell()}get exist(){return this._exists}get allStickyEffectOperators(){return[...this.procFilterBundle.effectiveOperators,...this.numericOprsBundle.effectiveOperators]}get fusionMaterialInfos(){return this.definition.fusionMaterialInfos??[]}};u(z,"nextEntitySeq",0),u(z,"splitBattlePos",t=>({face:t==="Set"?"FaceDown":"FaceUp",orientation:t==="Attack"?"Vertical":"Horizontal"})),u(z,"recreateArray",(t,a)=>{if(!a.length)return[];const i=t.getAllCells().flatMap(r=>r.entities);return a.map(r=>r.seq).map(r=>i.find(n=>n.seq===r)).filter(r=>r!==void 0)}),u(z,"createPlayerEntity",t=>{const a=t.getHandCell();return new z(t,a,"Duelist",Ng(t),"FaceUp","Vertical")}),u(z,"createCardEntity",(t,a)=>{const i=a.staticInfo.monsterCategories&&a.staticInfo.monsterCategories.union(At).length?t.getExtraDeck():t.getDeckCell();return new z(t,i,"Card",a,"FaceDown","Vertical")}),u(z,"prepareTokenEntities",(t,a,i,r)=>{const n=t.duel.field.getWaitingRoomCell().cardEntities.filter(s=>s.owner===t).filter(s=>s.exist).filter(s=>s.definition===i);for(;n.length<r;)n.push(new z(t,t.duel.field.getWaitingRoomCell(),"Token",i,"FaceUp","Vertical",a));return n.forEach(s=>s._parent=a),n.slice(0,r)}),u(z,"prepareTokenEntity",(t,a,i)=>z.prepareTokenEntities(t,a,i,1)[0]),u(z,"moveMany",async(t,a)=>{if(!t.length)return;const i=t[0].entity.duel,n=[...t.filter(l=>l.entity.cell!==l.to).map(l=>l.entity).filter(l=>!(a??[]).includes(l)),...i.field.getCardsOnFieldStrictly().filter(l=>l.info.isDying)],s=new Map;for(t.forEach(({entity:l,to:o,kind:c,face:d,orientation:p,pos:f,...h})=>{var D;let y=o,v=c,g=d,_=f,w=p;l.status.willBeBanished?(y=l.owner.getBanished(),g="FaceUp",w="Vertical"):l.status.willReturnToDeck?(y=l.isBelongTo,g="FaceDown",_=l.status.willReturnToDeck,w="Vertical"):(D=l.status.monsterCategories)!=null&&D.includes("Pendulum")&&l.isOnField&&!l.info.isPending&&l.kind!=="XyzMaterial"&&l.face==="FaceUp"&&o.isTrashCell&&(y=l.owner.getExtraDeck(),g="FaceUp",_="Top",w="Vertical"),y.cellType==="ExtraDeck"&&(_=g==="FaceUp"?"Top":"Bottom"),l.isBelongTo.cellType==="ExtraDeck"&&(y.cellType==="Hand"||y.cellType==="Deck")&&(y=l.isBelongTo,g="FaceDown",w="Vertical"),y.isPlayFieldCell||(v=l.origin.kind,l.entityType==="Token"&&(y=l.field.getWaitingRoomCell())),y.isMonsterZoneLikeCell||(w="Vertical"),s.set(y,[{entity:l,to:y,kind:v,face:g,orientation:w,pos:_,...h},...s.get(y)??[]])});;){const l=Array.from(s.values()).map(o=>o.pop()).filter(o=>o!==void 0).map(o=>o.entity._move(o));if(!l.length)break;await Promise.all(l),await S.waitCorpseDisposal(i,{excludedList:n})}await z.settleEntityMove(i)}),u(z,"summonMany",async(t,a,i,r,n)=>{if(!t.length)return;const s=[...i],l=r.entity,o=n.duel,c={Attack:"AttackSummon",Defense:"DefenseSummon",Set:"SetSummon"},d=t.map(({monster:p,dest:f,pos:h,summoner:y})=>{if(p.info.summonKinds=[a],a==="NormalSummon"||a==="AdvanceSummon"){p.info.summonKinds.push("NormalSummon");const _=a==="AdvanceSummon"?"ã‚¢ãƒ‰ãƒãƒ³ã‚¹":"";h==="Attack"?p.field.duel.log.info(`${p.toString()}ã‚’${_}å¬å–š`,y):p.duel.log.info(`${p.toString()}ã‚’${_}ã‚»ãƒƒãƒˆ`,y),s.includes("Rule")?y.info.ruleNormalSummonCountQty++:y.info.effectNormalSummonCountQty++}else a==="SpecialSummon"?p.duel.log.info(`${p.toString()}ã‚’${La[h]}ã§ç‰¹æ®Šå¬å–š`,y):(s.includes("SpecialSummon")||s.push("SpecialSummon"),p.info.summonKinds.push("SpecialSummon"),p.duel.log.info(`${p.toString()}ã‚’${La[h]}ã§${Yu[a]}ï¼`,y)),y.info.specialSummonCountQty++;p.info.summonKinds=p.info.summonKinds.getDistinct(),p.info.battlePotisionChangeCount=1;const{face:v,orientation:g}=z.splitBattlePos(h);return s.includes("Rule")&&(p.info.isPending=!0),{entity:p,args:{to:f,kind:"Monster",face:v,orientation:g,pos:"Top",movedAs:[a,c[h],...s],movedBy:l,actionOwner:n,chooser:y}}}).map(p=>p.entity._move(p.args));await Promise.all(d),t.map(p=>p.summoner).forEach(p=>{a==="NormalSummon"||a==="AdvanceSummon"?s.includes("Rule")?p.info.ruleNormalSummonCount++:p.info.effectNormalSummonCount++:p.info.specialSummonCount++}),await S.waitCorpseDisposal(o),await z.settleEntityMove(t[0].monster.duel)}),u(z,"sendManyToGraveyard",(t,a)=>z.bringManyToSameCell("Graveyard","Top",t.map(i=>({...i,face:"FaceUp",orientation:"Vertical"})),a)),u(z,"bringManyToSameCell",async(t,a,i,r)=>(await z.moveMany(i.map(n=>({...n,to:n.entity.field.getCells(t).filter(s=>s.owner===n.entity.owner)[0],kind:n.entity.origin.kind,pos:a,chooser:n.activator,actionOwner:n.activator})),r),i.map(n=>n.entity).filter(n=>n.cell.cellType===t))),u(z,"settleEntityMove",async t=>{t.field.recalcLinkArrows(),await t.field.distributeOperators(t.clock);const a=t.field.getAllEntities().filter(i=>i.wasMovedAtCurrentProc);a.filter(i=>!i.isOnFieldStrictly&&!i.info.isPending).forEach(i=>i.resetInfoIfLeavesTheField()),a.filter(i=>i.face==="FaceDown").filter(i=>i.cell===i.isBelongTo).forEach(i=>{i.resetInfoAll(),i.resetStatusAll()}),await Promise.all(a.flatMap(i=>i.continuousEffects).map(i=>i.updateState())),t.field.getAllCells().filter(i=>i.needsShuffle).map(i=>i.shuffle())});let L=z;L.prototype.hasBeenArrivalNow=function(e,t=T,a=!1){const i=t.map(Ju),r=this.moveLog.latestArrivalRecord;if(!r)return!1;if(this.field.duel.clock.isPreviousChain(r.movedAt)){if(a&&!this.field.duel.clock.isPreviousProc(r.movedAt))return!1}else return!1;const n=r.movedAs;return!(!n.union(e).length||!n.union(i).length)};L.prototype.getAttackTargets=function(){const e=this.controller.getOpponentPlayer().getMonstersOnField().filter(t=>t.status.isSelectableForAttack);return(this.status.canDirectAttack||!e.length)&&e.push(this.controller.getOpponentPlayer().entity),e.filter(t=>t.canBeTargetOfBattle(this.controller,this)).filter(t=>this.procFilterBundle.filter(["BattleTarget"],this.controller,this,{},[t]))};L.prototype.canBeEffected=function(e,t,a){return this.procFilterBundle.filter(["Effect"],e,t,a,[this])};const td=(e,t,a,i,r)=>e.canBeEffected(a,i,r)&&e.procFilterBundle.filter([t],a,i,r,[e]);L.prototype.canBeTargetOfEffect=function(e){return this.procFilterBundle.filter(["EffectTarget"],e.activator,e.action.entity,e.action,[this])};L.prototype.canBeBanished=function(e,t,a,i){return this.cell.cellType==="Banished"?!1:td(this,e,t,a,i)};L.prototype.canBeTargetOfBattle=function(e,t){return this.procFilterBundle.filter(["BattleTarget"],e,t,{},[this])};L.prototype.validateDestroy=function(e,t,a,i){let r=this.procFilterBundle.filter([e==="Battle"?"BattleDestroy":"EffectDestroy"],t,a,i??{},[this]);return r&&e==="Effect"&&(r=this.canBeEffected(t,a,i)),r};L.prototype.getIndexInCell=function(){const e=this;if(e.info.isVanished||e.kind==="XyzMaterial")return-1;const t=e.cell.cardEntities.indexOf(e);if(t<0)throw new A("ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã¨ã‚»ãƒ«ã®çŠ¶æ…‹ãŒçŸ›ç›¾ã—ã¦ã„ã‚‹ã€‚",[e,e.cell]);return t};L.prototype.getXyzMaterials=function(){const e=this;return(e.status.monsterCategories??[]).includes("Xyz")?e.cell.xyzMaterials:[]};L.prototype.wasMovedAfter=function(e){return this.moveLog.latestRecord.movedAt.totalProcSeq>e.totalProcSeq};L.prototype.wasMovedBefore=function(e){return this.moveLog.latestRecord.movedAt.totalProcSeq<e.totalProcSeq};L.prototype.hadArrivedToFieldAt=function(){let e=this.moveLog.latestRecord.movedAt;return this.moveLog.records.findLast(t=>!t.cell.isPlayFieldCell||t.isPending||t.kind!==this.kind||t.face==="FaceDown"?!0:(e=t.movedAt,!1)),e};L.prototype.release=async function(e,t,a){return await this.sendToGraveyard([...e,"Release"],t,a),this.info.isVanished?void 0:this.cell};L.prototype.ruleDestroy=async function(){return await this.sendToGraveyard(["Rule","Destroy"],void 0,void 0),this.info.isVanished?void 0:this.cell};L.prototype.sendToGraveyard=async function(e,t,a){await S.sendManyToGraveyardForTheSameReason([this],e,t,a)};L.prototype.discard=async function(e,t,a){await S.discardManyForTheSameReason([this],e,t,a)};L.prototype.returnToDeck=async function(e,t,a,i){await S.returnManyToDeckForTheSameReason(e,[this],t,a,i)};L.prototype.banish=async function(e,t,a){await S.banishManyForTheSameReason([this],e,t,a)};class ad{constructor(t){u(this,"cells");u(this,"duel");u(this,"summonFilterPool");u(this,"procFilterPool");u(this,"numericStateOperatorPool");u(this,"statusOperatorPool");u(this,"damageFilterPool");u(this,"moveLog");u(this,"distributeOperators",async t=>{console.info(`[totalProcSeq]:${t.totalProcSeq}`);let a=0;for(;;){if(a++,a>10)throw new A("ç„¡é™ãƒ«ãƒ¼ãƒ—ç™ºç”Ÿ");let i=!0;for(const r of this.stickyOperatorPools)if(!r.distributeAll(this.duel)){i=!1;break}if(i)return}});u(this,"getAllCells",()=>this.cells.flat());u(this,"getCells",(...t)=>this.getAllCells().filter(a=>t.includes(a.cellType)));u(this,"getAvailableExtraMonsterZones",()=>this.getCells("ExtraMonsterZone").filter(t=>t.isAvailable));u(this,"getWaitingRoomCell",()=>this.getCells("WaitingRoom")[0]);u(this,"getAllEntities",()=>this.getAllCells().map(t=>t.entities).flat());u(this,"getAllCardEntities",()=>this.getAllCells().map(t=>t.cardEntities).flat());u(this,"getCardsOnFieldStrictly",()=>this.getCells(...me).map(t=>t.cardEntities).filter(t=>t.length>0).map(t=>t[0]).filter(t=>t.isOnFieldStrictly));u(this,"getMonstersOnFieldStrictly",()=>this.getCardsOnFieldStrictly().filter(t=>t.isOnFieldAsMonsterStrictly));u(this,"getSpellTrapsOnFieldStrictly",()=>this.getCardsOnFieldStrictly().filter(t=>t.isOnFieldAsSpellTrapStrictly));u(this,"getPendulumScalesOnFieldStrictly",()=>this.getCardsOnFieldStrictly().filter(t=>{var a;return(a=t.origin.monsterCategories)==null?void 0:a.includes("Pendulum")}).filter(t=>t.isOnFieldAsSpellTrapStrictly).filter(t=>!t.status.spellCategory));u(this,"getPendingCardsOnField",()=>this.getCells(...me).map(t=>t.cardEntities).filter(t=>t.length>0).map(t=>t[0]).filter(t=>t.info.isPending));u(this,"getDyingCardsOnField",()=>this.getCells(...me).flatMap(t=>[...t.cardEntities,...t.xyzMaterials]).filter(t=>t.info.isDying));u(this,"getPendingMonstersOnField",()=>this.getPendingCardsOnField().filter(t=>t.kind==="Monster"));u(this,"getEntities",t=>this.getAllEntities().filter(a=>a.controller===t));u(this,"recalcLinkArrows",()=>{const t=this.getAllCells().filter(a=>a.isMonsterZoneLikeCell);t.some(a=>a.recalcLinkArrows)&&t.forEach(a=>a.recalcLinkArrows())});u(this,"canExtraLink",(t,a)=>{if(!t.linkArrows.length)return!1;const i=a.map(c=>c.material),r=this.getCells("ExtraMonsterZone").filter(c=>c.isAvailable||i.includes(c.cardEntities[0]));if(r.length!==1)return!1;const n=r[0],s=t.linkArrows.map(c=>this.cells[n.row+c.offsetRow][n.column+c.offsetColumn]);let l=n.linkArrowSources.filter(c=>!i.includes(c)).filter(c=>s.includes(c.cell));if(!l.length)return!1;let o=-1;for(;o!==l.length;){const c=l.flatMap(d=>d.coLinkedEntities).filter(d=>!i.includes(d));if(c.some(d=>d.cell.cellType==="ExtraMonsterZone"))return!0;l=[...l,...c].getDistinct(),o=l.length}return!1});u(this,"drawAtSameTime",async(t,a,i,r,n,s)=>{const l=[],o=[],c=[t.draw(a,n,s),i.draw(r,n,s)].map(d=>d.catch(p=>{p instanceof ue?p.winner&&l.push(p.winner):o.push(p)}));if(await Promise.all(c),o.length)throw new A("ãƒ‰ãƒ­ãƒ¼å‡¦ç†ã§æƒ³å®šã•ã‚Œãªã„ä¾‹å¤–ãŒç™ºç”Ÿã—ãŸã€‚",t,a,i,r,n,...o);if(l.length!==0)throw l.length===1?new ue(l[0],`${l[0].getOpponentPlayer().name}ãŒãƒ‡ãƒƒã‚­ã‹ã‚‰ãƒ‰ãƒ­ãƒ¼ã§ããªã‹ã£ãŸã€‚`):new ue(void 0,"ãŠäº’ã„ã«ãƒ‡ãƒƒã‚­ã‹ã‚‰ã‚«ãƒ¼ãƒ‰ã‚’ãƒ‰ãƒ­ãƒ¼ã§ããªã‹ã£ãŸã€‚")});u(this,"sendToGraveyard",async(t,a,i,r,n,s,l,o)=>{if(r>0&&i.length<r)return;const c=await this.duel.view.waitSelectEntities(a,{selectables:i,qty:r,validator:n,cancelable:o??!1},t);if(c)return await L.sendManyToGraveyard(c.map(d=>({entity:d,movedAs:s,movedBy:l,activator:a}))),this.duel.log.info(`${c.map(d=>d.status.name).join(", ")}ã‚’å¢“åœ°ã«é€ã£ãŸï¼ˆ${s.getDistinct().join(", ")}ï¼‰ã€‚`,a),c});this.duel=t,this.cells=[...Array(7)].map(()=>[]);for(const a of Object.keys(Ui).map(Number))for(const i of Object.keys(Ui[a]).map(Number))this.cells[a][i]=new Cu(this,a,i,a<3?t.duelists.Above:a>3?t.duelists.Below:i<2?t.duelists.Above:i>4?t.duelists.Below:void 0);this.summonFilterPool=new ju,this.procFilterPool=new ku,this.numericStateOperatorPool=new xu,this.statusOperatorPool=new Uu,this.damageFilterPool=new Qu,this.moveLog=new Hu(this),this.duel.clock.onStageChange.append(this.distributeOperators)}get stickyOperatorPools(){return[this.procFilterPool,this.statusOperatorPool,this.numericStateOperatorPool,this.summonFilterPool,this.damageFilterPool]}}const Yr=e=>{let t=[];do{const a=e.qty&&e.qty>0?e.qty:Math.floor(Math.random()*e.selectables.length+1);t=e.selectables.randomPickMany(a)}while(!e.validator(t));return t};class id{constructor(t){u(this,"onStateChangeEvent",new ce);u(this,"_stateLog",[]);u(this,"_state");this._stateLog.push({state:t,timestamp:new Date}),this._state=t}get stateLog(){return this._stateLog}get wasSpawnedAt(){return this.stateLog[0].timestamp}get onStateChange(){return this.onStateChangeEvent.expose()}get state(){return this._state}set state(t){this._stateLog.push({state:t,timestamp:new Date}),this._state=t,this.onStateChangeEvent.trigger(t)}}class Jr{constructor(t,a){u(this,"_dispose");u(this,"_commit");u(this,"commit",()=>this._commit());this._dispose=t,this._commit=a}[Symbol.dispose](){this._dispose()}[Symbol.for("Symbol.dispose")](){this._dispose()}}class rd{constructor(t){u(this,"onUpdateEvent",new ce);u(this,"nextSeq");u(this,"records",[]);u(this,"_state","Opened");u(this,"pooledRecords",[]);u(this,"duel");u(this,"openTransaction",()=>this._state!=="Opened"?(console.info("ãƒ­ã‚°ã®äºŒé‡ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã‚’é–‹å§‹ã—ã‚ˆã†ã¨ã—ãŸãŸã‚ã€ãƒ€ãƒŸãƒ¼ã‚’è¿”ã™ã€‚"),new Jr(()=>{},()=>{})):(this._state="Pending",new Jr(this.closeTransaction,this.commit)));u(this,"commit",()=>{if(this._state!=="Pending")throw new A("DuelLog is not in Pending state.");this.records.push(...this.pooledRecords),this.pooledRecords=[],this.onUpdateEvent.trigger(this.nextSeq-1)});u(this,"closeTransaction",()=>{this._state="Opened",this.pooledRecords=[],this.onUpdateEvent.trigger(this.nextSeq-1)});u(this,"dispose",()=>{this.onUpdateEvent.clear()});u(this,"error",t=>{const a=["ã‚¨ãƒ©ãƒ¼ç™ºç”Ÿ"],i={stack:[],duelists:{...this.duel.duelists},error:t};t instanceof Error?(a.push("-- ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ --"),a.push(t.message),a.push("-- ã‚¨ãƒ©ãƒ¼åç§° --"),a.push(t.name||"ã‚¨ãƒ©ãƒ¼åç§°å–å¾—å¤±æ•—"),t.stack&&(i.stack=t.stack.split(`
`))):a.push("-- ã‚¨ãƒ©ãƒ¼åž‹ç‰¹å®šå¤±æ•— --"),console.error(t),console.error(a),this.write("error","System",a,void 0,{error:i})});u(this,"warn",t=>{this.write("warn","System",["ã€æ³¨æ„ã€‘",t],void 0)});u(this,"info",(t,a)=>{this.write("info","Others",[t],a)});u(this,"pushChainBlockHeaderLog",(t,a,i)=>{this.write("info","ChainBlockHeader",[i],t,{chainNumber:a})});u(this,"pushMoveLog",(t,a,i,r)=>{const n=i.cellType==="WaitingRoom"?void 0:i,s=r.cellType==="WaitingRoom"?void 0:r;if(!n&&!s)throw new A("ç§»å‹•å…ƒã€ç§»å‹•å…ˆã¨ã‚‚ã«WaitingRoomãŒæŒ‡å®šã•ã‚Œã¦ã„ã‚‹ã€‚",t,a,i,r);const l=n&&s?"EntityMove":s?"EntityAppear":"EntityDisappear";this.write("info",l,[],t,{mainEntity:a,from:n,to:s})});u(this,"write",(t,a,i,r,n={})=>{const s=i.join(`
`),l={seq:this.nextSeq++,lvl:t,type:a,clock:this.duel.clock.getClone(),text:s,duelist:r,subEntities:[],...n};this._state==="Opened"||t!=="info"?(this.records.push(l),this.onUpdateEvent.trigger(this.nextSeq-1)):this.pooledRecords.push(l)});this.nextSeq=0,this.duel=t}get onUpdate(){return this.onUpdateEvent.expose()}get lastRecord(){return this.records.slice(-1)[0]}}class Vi{constructor(t){u(this,"onUpdateEvent",new ce);u(this,"_state","Disable");u(this,"defaultArgs");u(this,"_args");u(this,"resolve",()=>{});u(this,"show",t=>{this._args=t,this._state="Shown",console.log(this,this.onUpdateEvent),this.onUpdateEvent.trigger();const{promise:a,resolve:i}=_i();return this.resolve=r=>{this._state="Disable",i(r),this.resolve=()=>{},this.onUpdateEvent.trigger()},a});u(this,"cancel",()=>{console.log(this),this.args.cancelable&&(this._state!=="Disable"&&this.resolve(void 0),this.terminate())});u(this,"terminate",()=>{this._state="Disable",this._args=this.defaultArgs,this.resolve=()=>{}});this.defaultArgs=t,this._args=t}get onUpdate(){return this.onUpdateEvent.expose()}get state(){return this._state}get args(){return this._args}}class nd{constructor(t,...a){u(this,"textSelector",new Vi({title:"é¸æŠžã€‚",position:"Middle",choises:[],cancelable:!1}));u(this,"onUpdateEvent",new ce);u(this,"modals");u(this,"eventHolder");u(this,"terminateAll",()=>{this.modals.forEach(t=>t.terminate()),this.onUpdateEvent.trigger()});this.modals=[this.textSelector,...a],this.eventHolder=t,this.modals.forEach(i=>i.onUpdate.append(()=>{this.onUpdateEvent.trigger()}))}get onUpdate(){return this.onUpdateEvent.expose()}}var sd=U("<div></div>"),ld=U('<div class="link_arrow_emoji svelte-1qeuyz"> </div>'),od=U('<div class="duel_card_row svelte-1qeuyz"><!> <div> </div> <div> </div></div>'),cd=U('<div class="duel_card_row svelte-1qeuyz"><div class="svelte-1qeuyz"></div> <div class="svelte-1qeuyz"> </div></div>'),ud=U('<div class="duel_card_row svelte-1qeuyz"><div class="svelte-1qeuyz"></div> <div class="svelte-1qeuyz"> </div></div>'),dd=U('<div class="duel_card_row svelte-1qeuyz"><div> </div> <div> </div></div>'),pd=U('<div class="duel_card_row svelte-1qeuyz"><div class="svelte-1qeuyz"></div> <div class="svelte-1qeuyz">ãƒšãƒ³ãƒ‡ãƒ¥ãƒ©ãƒ </div></div>'),fd=U("/ <span> </span>",1),gd=U('<div class="duel_card_row duel_card_detail svelte-1qeuyz"><div class="svelte-1qeuyz"> </div></div> <div class="duel_card_row duel_card_detail svelte-1qeuyz"><div class="svelte-1qeuyz"></div> <div class="svelte-1qeuyz"><span> </span> <!></div></div>',1),hd=U('<button><div class="duel_card_body svelte-1qeuyz"><div class="duel_card_row svelte-1qeuyz" style="position:relative"><div> </div> <div class="svelte-1qeuyz"></div> <!></div> <!> <!> <!> <!></div></button>'),yd=U('<button><div class="svelte-1qeuyz">è£å®ˆå‚™</div></button>'),vd=U('<button><div class="svelte-1qeuyz">ã‚»ãƒƒãƒˆ</div></button>');function ds(e,t){mt(t,!1);let a=te(t,"entity",8),i=te(t,"state",8,"Disabled"),r=te(t,"selectedList",28,()=>[]),n=te(t,"isVisibleForcibly",8,!1),s=te(t,"isWideMode",8,!1),l=te(t,"dummyActionInfos",24,()=>[]),o=te(t,"cardActionResolve",8),c=te(t,"entitySelectResolve",8,()=>{}),d,p=$a(!1),f=()=>{},h=te(t,"qty",12,void 0);const y=q=>{var k;d=q.activator,J(p,!1),h((k=q.entitiesChoices)==null?void 0:k.qty),f=q.resolve};a().field.duel.view.onWaitStart.append(y);let v=$a(!1);const g=q=>{(a().face==="FaceUp"||a().owner===a().field.duel.duelists.Below&&(a().isUnderControl||n()))&&a().field.duel.view.showCardInfo({card:a(),mode:q})},_=()=>{if(g(),console.log(a().toString(),i(),l().length,o(),h(),f),i()==="Disabled")return;if(i()==="Selectable"){if(J(p,!F(p)),h()===1){c()&&c()([a()]),f&&f({selectedEntities:[a()]});return}r(F(p)?[...r(),a()]:r().filter(k=>k!==a()));return}if(l().length===0)return;if(l().length===1){const k=l()[0];if(o()){o()(k);return}console.log(a().toString(),i(),l().length,f),f({actionInfo:k});return}if(!d)return;a().field.duel.view.modalController.actionSelector.show({title:"è¡Œå‹•ã‚’é¸æŠžã€‚",position:"Bottom",activator:d,dummyActionInfos:l(),cancelable:!0}).then(k=>{k&&f({actionInfo:k})})},w=q=>{var k;window.getSelection&&((k=window.getSelection())==null||k.removeAllRanges()),console.info("drag start",q,l()),a().field.duel.view.setDraggingActions(l()),J(v,!0)},D=q=>{console.info("drag end",q,l()),a().field.duel.view.removeDraggingActions(),q.dataTransfer&&J(v,!1)},b=()=>(g("Debug"),!1);It();var O=Dt(),ie=Re(O);{var _e=q=>{var k=hd(),se=H(k),re=H(se),Te=H(re),Oe=H(Te),Ee=X(Te,4);fa(Ee,1,()=>a().attr,pa,(V,ne)=>{var Se=sd();Y(()=>oe(Se,`monster_attr ${F(ne)??""} svelte-1qeuyz`)),R(V,Se)});var ia=X(re,2);{var Ma=V=>{var ne=od(),Se=H(ne);{var Tt=Ne=>{var $e=ld(),Lt=H($e);Y(le=>ge(Lt,le),[()=>a().origin.linkArrowKeys.map(le=>pr[le].emoji).join("")],rt),R(Ne,$e)};K(Se,Ne=>{a().origin.linkArrowKeys&&Ne(Tt)})}var Ge=X(Se,2),ke=H(Ge),Ue=X(Ge,2),tt=H(Ue);Y((Ne,$e)=>{oe(Ge,bt(a().lvl!==a().origin.level?"different_from_its_origin":""),"svelte-1qeuyz"),ge(ke,Ne),oe(Ue,bt(a().rank!==a().origin.rank?"different_from_its_origin":""),"svelte-1qeuyz"),ge(tt,$e)},[()=>"â˜…".repeat(a().lvl||0),()=>"â˜†".repeat(a().rank||0)],rt),R(V,ne)},Fa=V=>{var ne=Dt(),Se=Re(ne);{var Tt=ke=>{var Ue=cd(),tt=X(H(Ue),2),Ne=H(tt);Y(()=>ge(Ne,`${du[a().status.spellCategory]??""}é­”æ³•`)),R(ke,Ue)},Ge=ke=>{var Ue=Dt(),tt=Re(Ue);{var Ne=$e=>{var Lt=ud(),le=X(H(Lt),2),De=H(le);Y(()=>ge(De,`${fu[a().status.trapCategory]??""}ç½ `)),R($e,Lt)};K(tt,$e=>{a().kind==="Trap"&&a().status.trapCategory&&$e(Ne)},!0)}R(ke,Ue)};K(Se,ke=>{a().kind==="Spell"&&a().status.spellCategory?ke(Tt):ke(Ge,!1)},!0)}R(V,ne)};K(ia,V=>{a().isMonster?V(Ma):V(Fa,!1)})}var Sr=X(ia,2);{var vo=V=>{var ne=dd(),Se=H(ne),Tt=H(Se),Ge=X(Se,2),ke=H(Ge);Y(()=>{oe(Se,bt(a().psL!==a().origin.pendulumScaleL?"different_from_its_origin":""),"svelte-1qeuyz"),ge(Tt,`â—€ ${a().psL??""}`),oe(Ge,bt(a().psR!==a().origin.pendulumScaleR?"different_from_its_origin":""),"svelte-1qeuyz"),ge(ke,`${a().psR??""} â–¶`)}),R(V,ne)};K(Sr,V=>{var ne;(ne=a().status.monsterCategories)!=null&&ne.includes("Pendulum")&&V(vo)})}var Tr=X(Sr,2);{var mo=V=>{var ne=pd();R(V,ne)};K(Tr,V=>{a().kind==="Spell"&&a().isPendulumScale&&V(mo)})}var _o=X(Tr,2);{var So=V=>{var ne=gd(),Se=Re(ne),Tt=H(Se),Ge=H(Tt),ke=X(Se,2),Ue=X(H(ke),2),tt=H(Ue),Ne=H(tt),$e=X(tt,2);{var Lt=le=>{var De=fd(),Cr=X(Re(De)),To=H(Cr);Y(()=>{oe(Cr,bt(a().def!==a().origin.defense?"different_from_its_origin":""),"svelte-1qeuyz"),ge(To,a().def??"?")}),R(le,De)};K($e,le=>{var De;(De=a().status.monsterCategories)!=null&&De.includes("Link")||le(Lt)})}Y((le,De)=>{ge(Ge,`${le??""}
            ${De??""}`),oe(tt,bt(a().atk!==a().origin.attack?"different_from_its_origin":""),"svelte-1qeuyz"),ge(Ne,a().atk??"?")},[()=>a().types.map(le=>hu[le]+(s()?gu[le]:"")).join(),()=>{var le;return(le=a().status.monsterCategories)==null?void 0:le.map(De=>ou[De]+(s()?lu[De]:"")).join()}],rt),R(V,ne)};K(_o,V=>{a().isMonster&&V(So)})}Y(V=>{oe(k,`duel_card button_style_reset ${a().origin.kind??""} ${V??""} ${(F(p)?"duel_card_selected":"")??""} ${i()??""} duel_card_${a().orientation??""} ${(F(v)?"isDragging":"")??""} ${(s()?"duel_card_wide":"")??""} duel_card_${a().face??""} ${(a().isOnField?"duel_card_is_on_field":"")??""} svelte-1qeuyz`),Br(k,"draggable",i()==="Draggable"),Br(k,"title",a().nm),oe(Te,bt(a().nm!==a().origin.name?"different_from_its_origin":""),"svelte-1qeuyz"),ge(Oe,a().nm)},[()=>{var V;return((V=a().status.monsterCategories)==null?void 0:V.join(" "))||""}],rt),Ct("dragstart",k,w),Ct("dragend",k,D),Ct("click",k,_),Ct("mouseenter",k,()=>g()),Ct("contextmenu",k,b),R(q,k)},G=q=>{var k=Dt(),se=Re(k);{var re=Oe=>{var Ee=yd();Y(()=>oe(Ee,`duel_card duel_card_face_down duel_card_face_down_defense ${i()??""}  ${(F(p)?"duel_card_selected":"")??""} svelte-1qeuyz`)),Ct("click",Ee,_),R(Oe,Ee)},Te=Oe=>{var Ee=vd();Y(()=>oe(Ee,`duel_card duel_card_face_down ${i()??""}  ${(F(p)?"duel_card_selected":"")??""} svelte-1qeuyz`)),Ct("click",Ee,_),R(Oe,Ee)};K(se,Oe=>{a().battlePosition==="Set"?Oe(re):Oe(Te,!1)},!0)}R(q,k)};K(ie,q=>{a().face==="FaceUp"||n()||a().controller.duelistType==="Player"&&a().isUnderControl?q(_e):q(G,!1)})}R(e,O),_t()}var md=U('<div class="modal_window_header svelte-2kmgt1"> </div>'),_d=U('<div><!> <div class="modal_window_body svelte-2kmgt1"><!></div> <div class="modal_window_footer svelte-2kmgt1"><!></div></div>');function yr(e,t){mt(t,!1);let a=te(t,"args",8),i=te(t,"eventHolder",8),r=$a(!1);const n=()=>{J(r,!0)},s=()=>{J(r,!1)};i().onDragStart.append(n),i().onDragEnd.append(s),It();var l=_d(),o=H(l);{var c=y=>{var v=md(),g=H(v);Y(()=>ge(g,a().title)),R(y,v)};K(o,y=>{F(r)||y(c)})}var d=X(o,2),p=H(d);Gi(p,t,"body",{});var f=X(d,2),h=H(f);Gi(h,t,"footer",{}),Y(y=>oe(l,`modal_window modal_window_${y??""} ${(F(r)?"modal_window_is_dragging":"")??""} svelte-2kmgt1`),[()=>a().position.toLowerCase()],rt),R(e,l),_t()}const Sd=(e,t,a)=>t.resolve(F(a));var Td=U('<div><!> <div class="cell_type_name svelte-p7db7v"> </div></div>'),Cd=U("<div></div>"),bd=U('<div slot="body"></div>'),wd=U('<button class="svelte-p7db7v">OK</button>'),Ed=(e,t)=>t.resolve(void 0),kd=U('<button class="cancel_button svelte-p7db7v">Cancel</button>'),Dd=U('<div slot="footer" class="modal_window_footer svelte-p7db7v"><!> <!></div>');function xd(e,t){mt(t,!0);let a=cc(dt([])),i=t.args.chainBlockInfos.flatMap(l=>l.selectedEntities).getDistinct();var r=Dt(),n=Re(r);{var s=l=>{yr(l,{get eventHolder(){return t.eventHolder},get args(){return t.args},$$slots:{body:(o,c)=>{var d=bd();fa(d,21,()=>t.args.entitiesChoices.selectables.map(p=>p.controller.seat).getDistinct(),pa,(p,f)=>{var h=Cd();fa(h,21,()=>t.args.entitiesChoices.selectables.filter(y=>y.controller.seat===F(f)).toSorted(ed),pa,(y,v)=>{var g=Td(),_=H(g);ds(_,{get entity(){return F(v)},isVisibleForcibly:!0,state:"Selectable",entitySelectResolve:b=>t.resolve(b),get qty(){return t.args.entitiesChoices.qty},cardActionResolve:void 0,get selectedList(){return F(a)},set selectedList(b){J(a,dt(b))}});var w=X(_,2),D=H(w);Y(b=>{oe(g,`entities_list_item ${b??""} svelte-p7db7v`),ge(D,`ã€ˆ${F(v).cell.shortName??""}ã€‰`)},[()=>i.includes(F(v))?"effect_target":""]),R(y,g)}),Y(()=>oe(h,`entities_list ${F(f)??""} svelte-p7db7v`)),R(p,h)}),R(o,d)},footer:(o,c)=>{var d=Dd(),p=H(d);{var f=v=>{var g=wd();g.__click=[Sd,t,a],Y(_=>g.disabled=_,[()=>!t.args.entitiesChoices.validator([...F(a)])]),R(v,g)};K(p,v=>{(t.args.entitiesChoices.qty??1e3)>1&&v(f)})}var h=X(p,2);{var y=v=>{var g=kd();g.__click=[Ed,t],R(v,g)};K(h,v=>{t.args.cancelable&&v(y)})}R(o,d)}}})};K(n,l=>{l(s)})}R(e,r),_t()}hi(["click"]);var Pd=U('<div class="duel_card_wrapper svelte-1pg50l9"><!> <div> </div></div>'),Ad=U('<div class="action_list" slot="body" style="display: flex; justify-content: space-around;"></div>'),Md=(e,t)=>t()(void 0),Fd=U('<button class="cancel_button svelte-1pg50l9">Cancel</button>'),Od=U('<div slot="footer"><!></div>');function Nd(e,t){mt(t,!1);let a=te(t,"eventHolder",8),i=te(t,"args",8),r=te(t,"resolve",8);It();var n=Dt(),s=Re(n);{var l=o=>{yr(o,{get eventHolder(){return a()},get args(){return i()},$$slots:{body:(c,d)=>{var p=Ad();fa(p,5,()=>i().dummyActionInfos,pa,(f,h)=>{var y=Pd(),v=H(y);const g=rt(()=>F(h).dests.length?"Draggable":"Clickable"),_=rt(()=>i().dragAndDropOnly?[]:[F(h)]);ds(v,{get entity(){return F(h).action.entity},isVisibleForcibly:!0,get state(){return F(g)},get dummyActionInfos(){return F(_)},get cardActionResolve(){return r()}});var w=X(v,2),D=H(w);Y(()=>ge(D,`Â«${F(h).action.title??""}Â»`)),R(f,y)}),R(c,p)},footer:(c,d)=>{var p=Od(),f=H(p);{var h=y=>{var v=Fd();v.__click=[Md,r],R(y,v)};K(f,y=>{i().cancelable&&y(h)})}R(c,p)}}})};K(s,o=>{o(l)})}R(e,n),_t()}hi(["click"]);var Bd=(e,t,a)=>t()(a()),Ld=U('<li><button class="svelte-1rzyf4u"> </button></li>'),Rd=U('<ui slot="body" class="text_list svelte-1rzyf4u"></ui>'),qd=(e,t)=>t()(void 0),Hd=U('<button class="cancel_button svelte-1rzyf4u">Cancel</button>'),Zd=U('<div slot="footer"><!></div>');function Gd(e,t){mt(t,!1);let a=te(t,"eventHolder",8),i=te(t,"args",8),r=te(t,"resolve",8);It();var n=Dt(),s=Re(n);{var l=o=>{yr(o,{get eventHolder(){return a()},get args(){return i()},$$slots:{body:(c,d)=>{var p=Rd();fa(p,5,()=>i().choises,pa,(f,h)=>{let y=()=>F(h).seq,v=()=>F(h).text;var g=Ld(),_=H(g);_.__click=[Bd,r,y];var w=H(_);Y(()=>{oe(g,`text_item ${y()??""} svelte-1rzyf4u`),ge(w,v())}),R(f,g)}),R(c,p)},footer:(c,d)=>{var p=Zd(),f=H(p);{var h=y=>{var v=Hd();v.__click=[qd,r],R(y,v)};K(f,y=>{i().cancelable&&y(h)})}R(c,p)}}})};K(s,o=>{o(l)})}R(e,n),_t()}hi(["click"]);const Ud=(e,t)=>t().modals.filter(a=>a.args.cancelable).forEach(a=>a.cancel());var $d=U("<button>â˜†</button> <!> <!>",1),jd=U("<div><!></div>");function zd(e,t){mt(t,!1);let a=te(t,"modalController",12),i=$a(!1);const r=()=>{a(a())},n=()=>{console.log("hoge"),J(i,!0),r()},s=()=>{J(i,!1),r()};a().eventHolder.onDragStart.append(n),a().eventHolder.onDragEnd.append(s),a().onUpdate.append(r),It();var l=jd(),o=H(l);{var c=d=>{var p=$d(),f=Re(p);f.__click=[Ud,a];var h=X(f,2);Gi(h,t,"default",{});var y=X(h,2);{var v=g=>{Gd(g,{get eventHolder(){return a().eventHolder},get args(){return a().textSelector.args},get resolve(){return a().textSelector.resolve}})};K(y,g=>{a().textSelector.state==="Shown"&&g(v)})}Y(()=>oe(f,`overlay ${(F(i)?"pointer_events_none":"")??""} svelte-xqm104`)),R(d,p)};K(o,d=>{a().modals.some(p=>p.state==="Shown")&&d(c)})}Y(()=>oe(l,`base ${(F(i)?"base_is_dragging":"")??""} svelte-xqm104`)),R(e,l),_t()}hi(["click"]);const ai=class ai extends nd{constructor(t,a){super(t,...Object.values(a))}};u(ai,"createModalController",t=>{const a={actionSelector:new Vi({title:"ã‚«ãƒ¼ãƒ‰æ“ä½œã‚’é¸æŠžã€‚",position:"Bottom",activator:void 0,dummyActionInfos:[],cancelable:!1}),entitySelector:new Vi({title:"å¯¾è±¡ã‚’é¸æŠž",position:"Middle",entitiesChoices:{selectables:[],validator:()=>!0,cancelable:!1},cancelable:!1,chainBlockInfos:[]})};return Object.assign(new ai(t,a),a)});let Qi=ai;var Vd=U("<!> <!>",1);function Sh(e,t){mt(t,!1);let a=te(t,"modalController",8);It(),zd(e,{get modalController(){return a()},children:(i,r)=>{var n=Vd(),s=Re(n);{var l=d=>{xd(d,{get eventHolder(){return a().eventHolder},get args(){return a().entitySelector.args},get resolve(){return a().entitySelector.resolve}})};K(s,d=>{a().entitySelector.state==="Shown"&&d(l)})}var o=X(s,2);{var c=d=>{Nd(d,{get eventHolder(){return a().eventHolder},get args(){return a().actionSelector.args},get resolve(){return a().actionSelector.resolve}})};K(o,d=>{a().actionSelector.state==="Shown"&&d(c)})}R(i,n)},$$slots:{default:!0}}),_t()}const Qd=[{seq:10,name:"Internet Explorer",key:"msie"},{seq:20,name:"Internet Explorer",key:"trident"},{seq:30,name:"Edge",key:"edge"},{seq:40,name:"Google Chrome",key:"chrome"},{seq:50,name:"Safari",key:"safari"},{seq:60,name:"Mozilla Firefox",key:"firefox"},{seq:70,name:"Opera",key:"opera"}],Wd=[{seq:10,name:"Microsoft Windows",key:"windows nt"},{seq:20,name:"Android",key:"android"},{seq:30,name:"iOS",key:"iphone"},{seq:40,name:"iOS",key:"ipad"},{seq:50,name:"macOS",key:"mac os x"}],va=window.navigator.userAgent.toLowerCase();var pn;const Xd=((pn=Qd.find(e=>va.indexOf(e.key)!==-1))==null?void 0:pn.name)??"Unknown Browser";var fn;const vr=((fn=Wd.find(e=>va.indexOf(e.key)!==-1))==null?void 0:fn.name)??"Unknown OS",ps=va.indexOf("iphone")!==-1||vr==="Android"&&va.indexOf("mobile")!==-1,Kd=va.indexOf("ipad")!==-1||vr==="Android"&&!ps,Ir=ps?"Smart Phone":Kd?"Tablet Device":"PC",xi={canDragElement:Ir==="PC",text:`${Ir} ${vr} ${Xd}`};class Yd{constructor(t){u(this,"onDuelUpdateEvent",new ce);u(this,"requireUpdate",()=>{this.onDuelUpdateEvent.trigger()});u(this,"onWaitStartEvent",new ce);u(this,"onWaitEndEvent",new ce);u(this,"onDragStartEvent",new ce);u(this,"onDragEndEvent",new ce);u(this,"onAnimationStartEvent",new ce);u(this,"onShowCardEntityEvent",new ce);u(this,"duel");u(this,"modalController");u(this,"_message");u(this,"waitMode");u(this,"infoBoardState");u(this,"infoBoardCell");u(this,"getCell",(t,a)=>this.duel.field.cells[t][a]);u(this,"showCardInfo",t=>{this.onShowCardEntityEvent.trigger(t)});u(this,"dispose",()=>{this.onDragStartEvent.clear(),this.onDragEndEvent.clear(),this.onDuelUpdateEvent.clear(),this.onWaitStartEvent.clear(),this.onWaitEndEvent.clear()});u(this,"waitFieldAction",async t=>{if(this.duel.getTurnPlayer().duelistType==="NPC"){const n=this.duel.getTurnPlayer().selectActionForNPC(t,[]);return n?{actionInfo:n}:{phaseChange:this.duel.nextPhaseList[0]}}const a=await this._waitDuelistAction(this.duel.getTurnPlayer(),t,"Free","",void 0,void 0,!1);if(!a.actionInfo)return{...a,actionInfo:void 0};const i={...a.actionInfo},r=t.find(n=>{var s;return((s=a.actionInfo)==null?void 0:s.originSeq)===n.originSeq});if(!r)throw new A("æƒ³å®šã•ã‚Œãªã„çŠ¶æ…‹",t,a);return{...a,actionInfo:{dest:i.dest,battlePosition:i.battlePosition,action:r.action,originSeq:r.originSeq}}});u(this,"waitQuickEffect",async(t,a,i,r,n)=>{if(a.length===0)return;if(t.duelistType==="NPC")return t.selectActionForNPC(a,i);const s=[this.modalController.actionSelector.show({title:r,position:"Bottom",activator:t,dummyActionInfos:a,cancelable:n}),this._waitDuelistAction(t,a,"Modal",this.message,void 0,void 0,!1).then(c=>c.actionInfo)],l=await Promise.any(s);if(!l)return;this.infoBoardState="Default";const o=a.find(c=>l.originSeq===c.originSeq);if(!o)throw new A("æƒ³å®šã•ã‚Œãªã„çŠ¶æ…‹",l);return{...o,dest:l.dest}});u(this,"waitSubAction",async(t,a,i,r=!1)=>{if(t.duelistType==="NPC")throw Error("Not implemented");const n=await this._waitDuelistAction(t,a,"Modal",i,void 0,void 0,r);if(n&&n.actionInfo)return n.actionInfo});u(this,"waitSelectEntities",async(t,a,i)=>{if(!a.selectables.length)return;if(a.qty&&a.selectables.length===a.qty)return[...a.selectables];if(t.duelistType==="NPC")return Yr(a);let r;a.selectables.some(s=>s.entityType==="Duelist")&&(r={...a,selectables:a.selectables.filter(s=>s.entityType==="Duelist").map(s=>s.cell),qty:1,validator:s=>s.length===1}),console.log(a);const n=await this._waitDuelistAction(t,[],"Modal",i,a,r,a.cancelable);return(n.selectedEntities||n.selectedCells)&&[...n.selectedEntities??[],...(n.selectedCells??[]).flatMap(s=>s.entities).filter(s=>s.entityType==="Duelist")]});u(this,"waitSelectNumber",async(t,a,i,r)=>{const n=await this.waitSelectText(t,i.getDistinct().toSorted().map(s=>({seq:s,text:s.toString()})),a,r);if(n)return n.seq});u(this,"waitYesOrNo",async(t,a)=>{const i=await this.waitSelectText(t,[{seq:0,text:"Yes"},{seq:1,text:"No"}],a,!1);return(i==null?void 0:i.seq)===0});u(this,"waitSelectText",async(t,a,i,r=!1)=>{if(t.duelistType==="NPC")return a.randomPick();const n=await this.modalController.textSelector.show({title:i,position:"Middle",choises:a,cancelable:r});if(n===void 0){if(!r)throw new N(t,a,i,r);return}return a.find(s=>s.seq===n)});u(this,"waitAnimation",async t=>{var a;return this._message="",this.waitMode="Animation",window.getSelection&&((a=window.getSelection())==null||a.removeAllRanges()),this.onDuelUpdateEvent.trigger(),new Promise(i=>this.onAnimationStartEvent.trigger({...t,resolve:i}))});u(this,"waitTokenAnimation",async()=>{this.requireUpdate(),await ya(450)});u(this,"setDraggingActions",t=>{this.onDragStartEvent.trigger(t),this.requireUpdate()});u(this,"removeDraggingActions",()=>{this.onDragEndEvent.trigger()});u(this,"waitSelectAction",async(t,a,i,r)=>{var o;const n=a.map(c=>Mt.createDummyAction(c.entity,c.title,[],void 0,c.origin)),s=await this._waitDammyAction(t,n,i,r);if(!s)return;const l=(o=a.find(c=>c.origin.seq===s.originSeq))==null?void 0:o.origin;if(!l)throw new A("æƒ³å®šã•ã‚Œãªã„çŠ¶æ…‹",a,s);return l});u(this,"waitSelectSummonDestination",async(t,a,i,r,n)=>{const s=i.length>1&&xi.canDragElement?"ã‚«ãƒ¼ãƒ‰ã‚’å¬å–šå…ˆã¸ãƒ‰ãƒ©ãƒƒã‚°ã€‚":"è¡¨ç¤ºå½¢å¼ã‚’é¸æŠžã€‚";if(!i.length&&!r.length){if(n)return;throw new A("æƒ³å®šã•ã‚Œãªã„çŠ¶æ…‹",t,a,i,r,n)}let l=[...r];for(;;){const o={dest:i.randomPick(),battlePosition:l[0]};if(l.length===1){if(i.length===1&&!n)return o;if(!xi.canDragElement){const p=await this.waitSelectCell(t,i,n,"å¬å–šå…ˆã‚’é¸æŠžã€‚");return p?{...o,dest:p}:void 0}}const c=l.map(p=>Mt.createDummyAction(a,p,i,p)),d=await this._waitDammyAction(t,c,s,n);if(!d)return;if(d.battlePosition&&(l=[d.battlePosition]),!(i.length>1&&!d.dest))return o.dest=d.dest??o.dest,o.battlePosition=d.battlePosition??o.battlePosition,o}});u(this,"waitSelectDestination",async(t,a,i,r,n,s=!1)=>{if(!i.length)return;if(i.length===1)return i[0];if(!xi.canDragElement)return await this.waitSelectCell(t,i,s,r);let l=i.randomPick();const o=[Mt.createDummyAction(a,n,i,void 0)],c=await this._waitDammyAction(t,o,r,s);if(c)return l=c.dest??l,l});u(this,"_waitDammyAction",async(t,a,i,r=!1)=>{if(!a.length)return;const n=a.randomPick();let s={...n,dest:n.dest??n.dests.randomPick()};if(t.duelistType!=="NPC"){const l=[this.modalController.actionSelector.show({title:i,position:"Bottom",activator:t,dummyActionInfos:a,cancelable:r}),this.duel.view.waitSubAction(t,a,i,r)],o=await Promise.any(l);if(!o&&!r)throw new N(o,l);if(!o)return;s=o??s}return s});u(this,"waitSelectCell",async(t,a,i,r)=>a.length?t.duelistType==="NPC"?a.randomPick():(await this.waitSelectCells(t,{selectables:a,qty:1,validator:s=>s.length===1,cancelable:i},r)??[])[0]:void 0);u(this,"waitSelectCells",async(t,a,i)=>{if(!a.selectables.length)return;if(t.duelistType==="NPC")return Yr(a);const r=await this._waitDuelistAction(t,[],"Modal",i,void 0,a,a.cancelable);if((!r||!r.selectedCells)&&!a.cancelable)throw new N(t,a,i);return r.selectedCells});u(this,"_waitDuelistAction",async(t,a,i,r,n,s,l=!1)=>{for(this.waitMode=i,this._message=r;this.onDuelUpdateEvent.length<38;)console.log("this.onDuelUpdateEvent.length",this.onDuelUpdateEvent.length),await ya(1);this.onDuelUpdateEvent.trigger();const o=_i();console.log(n);const c={resolve:o.resolve,activator:t,dummyActionInfos:a,chainBlockInfos:t.duel.chainBlockInfos,entitiesChoices:n,cellsChoices:s};console.info("wait start",c),this.onWaitStartEvent.trigger(c);const d=await o.promise;if(console.info("response",d),this.modalController.terminateAll(),this.waitMode="None",this.onWaitEndEvent.trigger(),d.surrender)throw new ue(t.getOpponentPlayer(),`${t.profile.name}ãŒã‚µãƒ¬ãƒ³ãƒ€ãƒ¼ã—ãŸã€‚`);if(!l&&d.cancel)throw new A("ã‚­ãƒ£ãƒ³ã‚»ãƒ«ä¸å¯ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãŒã‚­ãƒ£ãƒ³ã‚»ãƒ«ã•ã‚ŒãŸã€‚",d,a,i,n,s);return this.infoBoardState="Default",d});this.duel=t,this._message="",this.waitMode="None",this.infoBoardState="Default",this.infoBoardCell=t.duelists.Below.getExtraDeck(),this.modalController=Qi.createModalController(this)}get onDuelUpdate(){return this.onDuelUpdateEvent.expose()}get onWaitStart(){return this.onWaitStartEvent.expose()}get onWaitEnd(){return this.onWaitEndEvent.expose()}get onDragStart(){return this.onDragStartEvent.expose()}get onDragEnd(){return this.onDragEndEvent.expose()}get onAnimation(){return this.onAnimationStartEvent.expose()}get onShowCardEntity(){return this.onShowCardEntityEvent.expose()}get message(){if(this._message)return this._message.substring(0,100);const t=this.duel.log.records.findLast(a=>a.type==="Others"||a.type==="System");return((t==null?void 0:t.text)??"").substring(0,100)}}const Wi=["turn","phaseSeq","stepSeq","stageSeq","chainSeq","chainBlockSeq","procSeq"];[...Wi];const ii=class ii{constructor(){u(this,"onClockChangeEvents",{turn:new wt,phaseSeq:new wt,stepSeq:new wt,stageSeq:new wt,chainSeq:new wt,chainBlockSeq:new wt,procSeq:new wt});u(this,"_turn",0);u(this,"_phaseSeq",0);u(this,"_stepSeq",0);u(this,"_stageSeq",0);u(this,"_chainSeq",0);u(this,"_chainBlockSeq",0);u(this,"_procSeq",0);u(this,"_totalProcSeq",0);u(this,"_periodKey");u(this,"_previousStartPoints",{turn:0,phaseSeq:0,stepSeq:0,stageSeq:0,chainSeq:0,chainBlockSeq:0,procSeq:0});u(this,"_currentStartPoints",{turn:0,phaseSeq:0,stepSeq:0,stageSeq:0,chainSeq:0,chainBlockSeq:0,procSeq:0});u(this,"setPhase",async(t,a)=>{const i=Object.values(Et).filter(r=>r.phase===a).find(r=>(r.step??"start")==="start");if(!i)throw new A("æƒ³å®šã•ã‚Œãªã„çŠ¶æ…‹",this.period,a,Et);a==="draw"?(this.turn>0&&t.log.info("ã‚¿ãƒ¼ãƒ³çµ‚äº†ã€‚",t.getTurnPlayer()),this._turn++,this._phaseSeq=0):(t.log.info(`ãƒ•ã‚§ã‚¤ã‚ºç§»è¡Œï¼ˆ${this.period.name}â†’${i.name}ï¼‰`,t.getTurnPlayer()),this._phaseSeq++),this._stepSeq=0,this._stageSeq=0,await this.setPeriodKey(i.key)});u(this,"setStep",async(t,a)=>{const i=this.period.phase,r=Object.values(Et).filter(n=>n.phase===i).find(n=>(n.step??"")===a);if(!r)throw new A("æƒ³å®šã•ã‚Œãªã„çŠ¶æ…‹",this.period,a,Et);this.period.name!==r.name&&(t.log.info(`ã‚¹ãƒ†ãƒƒãƒ—ç§»è¡Œï¼ˆ${this.period.name}â†’${r.name}ï¼‰`,t.getTurnPlayer()),this._stepSeq++,this._stageSeq=0,await this.setPeriodKey(r.key))});u(this,"setStage",async(t,a)=>{const i=this.period,r=Object.values(Et).filter(n=>n.phase===i.phase).filter(n=>n.step===i.step).find(n=>(n.stage??"")===a);if(!r)throw new A("æƒ³å®šã•ã‚Œãªã„çŠ¶æ…‹",this.period,a,Et);t.log.info(`ã‚¿ã‚¤ãƒŸãƒ³ã‚°ç§»è¡Œï¼ˆ${this.period.name}â†’${r.name}ï¼‰`,t.getTurnPlayer()),this._stageSeq++,await this.setPeriodKey(r.key)});u(this,"setPeriodKey",async t=>{this._periodKey!==t&&(this._periodKey=t,this._chainSeq=0,this._chainBlockSeq=0,this._procSeq=0,await this.incrementTotalProcSeq())});u(this,"incrementChainSeq",async()=>{this._chainSeq++,this._chainBlockSeq=0,this._procSeq=0,await this.incrementTotalProcSeq()});u(this,"incrementChainBlockSeq",async()=>{this._chainBlockSeq++,this._procSeq=0,await this.incrementTotalProcSeq()});u(this,"incrementProcSeq",async()=>{this._procSeq++,await this.incrementTotalProcSeq()});u(this,"incrementTotalProcSeq",async()=>{this._totalProcSeq++;let t=!0;Wi.toReversed().forEach(a=>{t&&(this._previousStartPoints[a]=this.currentStartPoints[a],this._currentStartPoints[a]=this.totalProcSeq),t=t&&this[a]===0});for(const a of Wi.toReversed().filter(i=>this._currentStartPoints[i]===this.totalProcSeq).filter(i=>i!=="procSeq"))await this.onClockChangeEvents[a].trigger(this);await this.onClockChangeEvents.procSeq.trigger(this)});u(this,"toFullString",()=>`${this.totalProcSeq}(t${this.turn}-phs${this.phaseSeq}-stp${this.stepSeq}-stg${this.stepSeq}-c${this.chainSeq}-cb${this.chainBlockSeq}-prc${this.procSeq})`);u(this,"getClone",()=>({turn:this.turn,phaseSeq:this.phaseSeq,stepSeq:this.stepSeq,stageSeq:this.stageSeq,chainSeq:this.chainSeq,chainBlockSeq:this.chainBlockSeq,procSeq:this.procSeq,totalProcSeq:this.totalProcSeq,period:this.period}));u(this,"isSameTurn",t=>this.turn===t.turn);u(this,"isSameChain",t=>ii.isSameChain(this,t));u(this,"isPreviousChain",t=>this.turn===t.turn&&this.phaseSeq===t.phaseSeq&&this.stepSeq===t.stepSeq&&this.stageSeq===t.stageSeq&&this.chainSeq===t.chainSeq+1);u(this,"isPreviousStage",t=>this.turn===t.turn&&this.phaseSeq===t.phaseSeq&&this.stepSeq===t.stepSeq&&this.stageSeq===t.stageSeq+1);u(this,"isPreviousTurn",t=>this.turn===t.turn+1);u(this,"isPreviousProc",t=>this.totalProcSeq===t.totalProcSeq+1);this._periodKey="end"}get onTurnChange(){return this.onClockChangeEvents.turn.expose()}get onStageChange(){return this.onClockChangeEvents.stageSeq.expose()}get onProcSeqChange(){return this.onClockChangeEvents.procSeq.expose()}get previousStartPoints(){return this._previousStartPoints}get currentStartPoints(){return this._currentStartPoints}get periodKey(){return this._periodKey}get period(){return Et[this.periodKey]}get turn(){return this._turn}get phaseSeq(){return this._phaseSeq}get stepSeq(){return this._stepSeq}get stageSeq(){return this._stageSeq}get chainSeq(){return this._chainSeq}get chainBlockSeq(){return this._chainBlockSeq}get procSeq(){return this._procSeq}get totalProcSeq(){return this._totalProcSeq}get isFirstChain(){return this.chainSeq===0}};u(ii,"isSameChain",(t,a)=>t.turn===a.turn&&t.phaseSeq===a.phaseSeq&&t.stepSeq===a.stepSeq&&t.stageSeq===a.stageSeq&&t.chainSeq===a.chainSeq);let Xi=ii;class Jd{constructor(t){u(this,"onInsertEvent",new ce);u(this,"nextSeq");u(this,"records",[]);u(this,"duel");u(this,"push",t=>{const a={seq:this.nextSeq++,clock:this.duel.clock.getClone(),chainBlockInfo:t};this.records.push(a),this.onInsertEvent.trigger(a)});this.nextSeq=0,this.duel=t}get onInsert(){return this.onInsertEvent.expose()}}class Da{constructor(t,a){u(this,"duel");u(this,"phase");u(this,"_priorityHolder");u(this,"turnPlayer");u(this,"_chainBlockInfos",[]);u(this,"proceed",async()=>(await this.duel.clock.setPhase(this.duel,this.phase),this._priorityHolder=this.turnPlayer,await this._proceed()));u(this,"procSpellSpeed1",async()=>{this.priorityHolder=this.turnPlayer;let t=0;const a={Above:Number.MAX_VALUE,Below:Number.MAX_VALUE};for(;;){const i=this.priorityHolder.getEnableActions(["IgnitionEffect","QuickEffect","CardActivation","LingeringEffect"],["Normal","Quick","Counter"],[]);if(a[this.priorityHolder.seat]=i.filter(l=>l.action.isMandatory).length,Object.values(a).every(l=>l===0)&&t>1)break;const r=i.find(l=>l.action.isMandatory);let n=r?{action:r.action,originSeq:r.action.seq}:void 0,s=!n;if(this.priorityHolder.isTurnPlayer?t===0&&(s=!0):a[this.turnPlayer.seat]&&(s=!0),i.length&&(i.length>1||!n)&&(this.priorityHolder.chainConfig.noticeFreeChain||i.some(l=>l.action.isNoticedForcibly))&&(n=await this.duel.view.waitQuickEffect(this.priorityHolder,i,[],this.duel.clock.period.name,s)),n){if(await this.procChain({activator:this.priorityHolder,actionInfo:n},void 0)==="cancel")continue;if(!await this.procFreeChain())return!1;this.priorityHolder=this.turnPlayer,t=0;continue}this.priorityHolder=this.priorityHolder.getOpponentPlayer(),t++}return!0});u(this,"procFreeChain",async(t=()=>!0)=>{const a=this.duel.clock.period.key;for(;await this.procChain(void 0,void 0)!=="pass";)if(this.duel.clock.period.key!==a||!t())return!1;return!0});u(this,"procTriggerEffects",async()=>{for(;await this.procChain(void 0,void 0,!0)==="done";);});u(this,"procChain",async(t,a,i)=>{const r=this.chainBlockInfos.length===0;let n=t?[]:a??Object.values(this.duel.duelists).flatMap(l=>l.getEnableActions(["TriggerEffect"],[this.chainBlockInfos.length?"Quick":"Normal"],this.chainBlockInfos).map(o=>({activator:l,actionInfo:o,targetChainBlock:this.chainBlockInfos.slice(-1)[0]}))),s;if(t)s={activator:t.activator,action:t.actionInfo.action,dest:t.actionInfo.dest,targetChainBlock:void 0},this.priorityHolder=s.activator;else if(n.length>0){const l=await this.selectTriggerEffect(n);l?(n=n.filter(o=>o!==l),s={...l,action:l.actionInfo.action},this.priorityHolder=s.activator):n=[]}if(!s){if(i)return"pass";let l=0;for(;l<2;){this.priorityHolder=this.priorityHolder.getOpponentPlayer();const o=["Counter"];this.chainBlockInfos.every(p=>p.action.spellSpeed!=="Counter")&&o.push("Quick");let d=this.priorityHolder.getEnableActions(["QuickEffect","CardActivation"],o,this.chainBlockInfos).some(p=>p.action.isNoticedForcibly)||!!this.attackingMonster;if(d||(this.chainBlockInfos.length?d=this.priorityHolder.chainConfig.noticeSelfChain||this.chainBlockInfos.slice(-1)[0].activator!==this.priorityHolder:d=this.priorityHolder.chainConfig.noticeFreeChain),d){const p=this.chainBlockInfos.some(h=>h.action.isWithChainBlock)?"ãƒã‚§ãƒ¼ãƒ³ã—ã¦åŠ¹æžœã‚’ç™ºå‹•ã—ã¾ã™ã‹ï¼Ÿ":"ã‚¯ã‚¤ãƒƒã‚¯ã‚¨ãƒ•ã‚§ã‚¯ãƒˆç™ºå‹•ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã€‚åŠ¹æžœã‚’ç™ºå‹•ã—ã¾ã™ã‹ï¼Ÿ",f=await this.duel.view.waitQuickEffect(this.priorityHolder,this.priorityHolder.getEnableActions(["QuickEffect","CardActivation"],o,this.chainBlockInfos),this.chainBlockInfos,p,!0);if(f){s={...f,activator:this.priorityHolder,targetChainBlock:this.chainBlockInfos.slice(-1)[0]};break}}l++}}if(console.info("selected action: ",s),s){const l=s.activator,o=await s.action.prepare(l,s.dest,s.targetChainBlock,this.chainBlockInfos,r,!1);if(!o)return"cancel";if(this.duel.chainBlockLog.push(o),this._chainBlockInfos.push(o),await this.duel.clock.incrementProcSeq(),await this.duel.clock.incrementChainBlockSeq(),n=n.filter(c=>c.actionInfo.action.seq!==(s==null?void 0:s.action.seq)).filter(c=>c.actionInfo.action.validateCount(c.activator,this.chainBlockInfos)),o.action.isChainable&&await this.procChain(void 0,n.length?n:void 0),await o.action.execute(o,this.chainBlockInfos),o.state==="done"||o.state==="failed")for(const c of[this.turnPlayer,this.nonTurnPlayer]){for(const d of c.getEnableActions(["Exodia"],["Normal"],[]))await d.action.directExecute(c,o,!1);for(const d of c.getEnableActions(["AfterChainBlock"],["Normal"],[o])){await d.action.directExecute(c,o,!1);for(const p of c.getEnableActions(["Exodia"],["Normal"],[]))await p.action.directExecute(c,o,!1)}}r?(await S.sendManyToGraveyardForTheSameReason(this._chainBlockInfos.filter(c=>c.action.playType==="CardActivation").filter(c=>!c.action.isLikeContinuousSpell).map(c=>c.action.entity).filter(c=>c.isOnFieldStrictly).filter(c=>c.face==="FaceUp"),["Rule"],void 0,void 0),this._chainBlockInfos.reset(),o.nextActionInfo&&await this.procChain({activator:o.activator,actionInfo:o.nextActionInfo},void 0),await this.duel.clock.incrementChainSeq()):(o.nextActionInfo&&await o.nextActionInfo.action.directExecute(o.activator,void 0,!1),await this.duel.clock.incrementChainBlockSeq())}return s?"done":"pass"});u(this,"selectTriggerEffect",async t=>{if(t.length>0)for(const a of[!0,!1])for(const i of[this.turnPlayer,this.nonTurnPlayer]){const r=t.filter(s=>s.actionInfo.action.isMandatory===a&&s.activator===i);if(r.length===0)continue;if(r.length===1&&a)return r[0];const n=await this.duel.view.waitQuickEffect(i,r.map(s=>s.actionInfo),this.chainBlockInfos,"ãƒˆãƒªã‚¬ãƒ¼ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã‚’é¸æŠžã€‚",!a);if(n)return r.find(s=>s.actionInfo.action===n.action)}});this.duel=t,this.phase=a,this.turnPlayer=this.phase==="draw"?this.duel.getNonTurnPlayer():this.duel.getTurnPlayer(),this._priorityHolder=this.turnPlayer}set priorityHolder(t){this._priorityHolder=t}get priorityHolder(){return this._priorityHolder}get nonTurnPlayer(){return this.turnPlayer.getOpponentPlayer()}get chainBlockInfos(){return this._chainBlockInfos}}class Id extends Da{constructor(a,i){super(a,i);u(this,"_attackingMonster");u(this,"_targetForAttack");u(this,"declareAttack",(a,i,r=!1)=>{var l;this._attackingMonster=a,this._targetForAttack=i;let n=" ("+((l=i.battlePosition==="Attack"?i.atk:i.def)==null?void 0:l.toString())+")";i.face==="FaceDown"&&(n=" (????)"),i.entityType==="Duelist"&&(n="");const s=r?"æ”»æ’ƒå¯¾è±¡å†é¸æŠž":"æ”»æ’ƒå®£è¨€";r||a.info.attackDeclareCount++,this.duel.log.info(`${s}:${a.toString()} (${a.atk})â‡’ ${i.toString()}${n}`,a.controller)});u(this,"_proceed",async()=>(await this.procBattlePhaseStartStep()&&await this.procBattlePhaseBattleStep(),await this.procBattlePhaseEndStep(),new fs(this.duel,"main2")));u(this,"procBattlePhaseStartStep",async()=>(await this.setStep("start"),this.priorityHolder=this.turnPlayer,this._attackingMonster=void 0,this._targetForAttack=void 0,await this.procSpellSpeed1()));u(this,"procBattlePhaseBattleStep",async()=>{for(;;){await this.setStep("battle"),this.priorityHolder=this.turnPlayer,this._attackingMonster=void 0,this._targetForAttack=void 0;const a=await this.duel.view.waitFieldAction(this.priorityHolder.getEnableActions(["DeclareAttack","QuickEffect","CardActivation"],["Normal","Quick","Counter"],[]));if(a.phaseChange)break;if(!a.actionInfo)continue;let i=this.duel.clock.totalProcSeq,r=this.nonTurnPlayer.getMonstersOnField();if(await this.procChain({activator:this.priorityHolder,actionInfo:a.actionInfo},void 0)!=="cancel"&&(await this.procTriggerEffects(),!(!this.attackingMonster||!this.targetForAttack))){for(;this.attackingMonster&&this.targetForAttack;){const s=this.attackingMonster.getAttackTargets();if(r.some(o=>!o.isOnFieldAsMonsterStrictly)||this.nonTurnPlayer.getMonstersOnField().flatMap(o=>o.moveLog.records).filter(o=>o.movedAt.totalProcSeq>i).some(o=>!o.cell.isMonsterZoneLikeCell)?(this.duel.log.info("ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã®æ•°ãŒå¢—æ¸›ã—ãŸãŸã‚ãƒãƒˆãƒ«ã‚¹ãƒ†ãƒƒãƒ—ã®å·»ãæˆ»ã—ãŒç™ºç”Ÿã€‚"),this._targetForAttack=void 0):this.targetForAttack.entityType==="Duelist"&&s.every(o=>o!==this.targetForAttack)&&!this.attackingMonster.status.canDirectAttack&&(this.duel.log.info(`${this.attackingMonster.toString()}ãŒç›´æŽ¥æ”»æ’ƒèƒ½åŠ›ã‚’å–ªå¤±ã—ãŸãŸã‚ã€ãƒãƒˆãƒ«ã‚¹ãƒ†ãƒƒãƒ—ã®å·»ãæˆ»ã—ãŒç™ºç”Ÿã€‚`),this._targetForAttack=void 0),!this.targetForAttack){if(!s.length){this.duel.log.info("æ”»æ’ƒå¯èƒ½ãªå¯¾è±¡ãŒå­˜åœ¨ã—ãªã„ãŸã‚ã€æ”»æ’ƒå¯¾è±¡é¸æŠžã‚’é¸æŠžè‚¢ã—ãªãŠã›ãªã„ã€‚");break}if(this.turnPlayer.duelistType==="Player"&&!await this.duel.view.waitYesOrNo(this.turnPlayer,"æ”»æ’ƒå¯¾è±¡é¸æŠžã‚’é¸æŠžã—ç›´ã™ï¼Ÿ")){this.turnPlayer.writeInfoLog(`${this.attackingMonster.toString()}ã®æ”»æ’ƒå®£è¨€ã‚’ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã€‚`);break}const o=await this.turnPlayer.waitSelectEntity(s,"æ”»æ’ƒå¯¾è±¡ã‚’é¸æŠžã€‚",!0);if(!o){this.turnPlayer.writeInfoLog(`${this.attackingMonster.toString()}ã®æ”»æ’ƒå®£è¨€ã‚’ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã€‚`);break}this.declareAttack(this.attackingMonster,o,!0),i=this.duel.clock.totalProcSeq,r=this.nonTurnPlayer.getMonstersOnField();continue}let l="cancel";for(;(l=await this.procChain(void 0,void 0))==="cancel";);if(l==="done")await this.procTriggerEffects();else if(l==="pass")break;if(!this.attackingMonster)throw new A("æƒ³å®šã•ã‚Œãªã„çŠ¶æ…‹");if(!this.canContinueBattle())break}this.canContinueBattle()&&await this.procBattlePhaseDamageStep()}}});u(this,"procBattlePhaseDamageStep",async()=>{if(!this.attackingMonster||!this.targetForAttack)throw new A("æƒ³å®šã•ã‚Œãªã„çŠ¶æ…‹",this.attackingMonster,this.targetForAttack);if(this.targetForAttack.entityType!=="Duelist"&&!this.targetForAttack.isOnFieldAsMonsterStrictly)throw new A("æƒ³å®šã•ã‚Œãªã„çŠ¶æ…‹",this.attackingMonster,this.targetForAttack);for(const a of[this.procBattlePhaseDamageStep1,this.procBattlePhaseDamageStep2,this.procBattlePhaseDamageStep3,this.procBattlePhaseDamageStep4,this.procBattlePhaseDamageStep5])if(!await a())return});u(this,"procBattlePhaseDamageStep1",async()=>(await this.setStage("start"),await this.procFreeChain(this.canContinueBattle)));u(this,"procBattlePhaseDamageStep2",async()=>{if(!this.attackingMonster)throw new A("æƒ³å®šã•ã‚Œãªã„çŠ¶æ…‹",this.attackingMonster);if(!this.targetForAttack)throw new A("æƒ³å®šã•ã‚Œãªã„çŠ¶æ…‹",this.targetForAttack);const a=this.attackingMonster,i=this.targetForAttack;return await this.setStage("beforeDmgCalc"),i.battlePosition==="Set"&&i.setBattlePosition("Defense",["Flip","Battle"],a,a.controller),await this.procFreeChain(this.canContinueBattle)});u(this,"procBattlePhaseDamageStep3",async()=>{if(!this.attackingMonster)throw new A("æƒ³å®šã•ã‚Œãªã„çŠ¶æ…‹",this.attackingMonster);if(!this.targetForAttack)throw new A("æƒ³å®šã•ã‚Œãªã„çŠ¶æ…‹",this.targetForAttack);const a=this.attackingMonster,i=this.targetForAttack;if(a.atk===void 0)throw new A("æƒ³å®šã•ã‚Œãªã„çŠ¶æ…‹",this.attackingMonster,this.targetForAttack);if(await this.setStage("dmgCalc"),!await this.procFreeChain(this.canContinueBattle))return!1;const r=a.atk,n=(i.battlePosition==="Attack"?i.atk:i.def)??0,s=this.turnPlayer,l=a.actions.find(f=>f.playType==="Battle");if(!l)throw new A(`${a.toString()}ã«æˆ¦é—˜ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãŒå®šç¾©ã•ã‚Œã¦ã„ãªã„ã€‚`);const o=await l.prepare(s,i.cell,void 0,[],!1,!1);if(!o)throw new N("æˆ¦é—˜ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãŒã‚­ãƒ£ãƒ³ã‚»ãƒ«ã•ã‚ŒãŸã€‚");this.duel.chainBlockLog.push(o),i.entityType==="Duelist"?s.writeInfoLog(`ãƒ€ãƒ¡ãƒ¼ã‚¸è¨ˆç®—ï¼š${a.toString()} (${r}) â‡’ ${i.toString()}`):s.writeInfoLog(`ãƒ€ãƒ¡ãƒ¼ã‚¸è¨ˆç®—ï¼š${a.toString()} (${r}) â‡’ ${i.toString()} (${n})`);const c=[];i.entityType==="Duelist"?c.push(gt.calcBattleDamage(a.controller.getOpponentPlayer(),r-n,a,i,o)):r>0&&r>n?i.battlePosition==="Attack"?c.push(gt.calcBattleDamage(a.controller.getOpponentPlayer(),r-n,a,i,o)):a.status.piercingTo.getDistinct().forEach(f=>c.push(gt.calcBattleDamage(f,r-n,a,i,o))):r<n&&c.push(gt.calcBattleDamage(a.controller,n-r,i,a,o));const d=[];r>0&&(r>n||r===n&&i.battlePosition==="Attack")&&d.push(i),i.battlePosition==="Attack"&&r<=n&&d.push(a),await S.tryMarkForDestroy(d,o),c.forEach(f=>f.damageTo.battleDamage(f)),o.state=r>n?"done":"failed",a.info.battleLog.push({enemy:i,timestamp:this.duel.clock.getClone()}),i.info.battleLog.push({enemy:a,timestamp:this.duel.clock.getClone()});const p=Object.values(this.duel.duelists).filter(f=>f.lp<=0);if(p.length)throw p.length===1?new ue(p[0].getOpponentPlayer(),`æˆ¦é—˜ãƒ€ãƒ¡ãƒ¼ã‚¸ã«ã‚ˆã£ã¦ã€${p[0].name}ã®ãƒ©ã‚¤ãƒ•ãƒã‚¤ãƒ³ãƒˆãŒã‚¼ãƒ­ã«ãªã£ãŸã€‚`):new ue(void 0,"æˆ¦é—˜ãƒ€ãƒ¡ãƒ¼ã‚¸ã«ã‚ˆã£ã¦ã€ãŠäº’ã„ã®ãƒ©ã‚¤ãƒ•ãƒã‚¤ãƒ³ãƒˆãŒã‚¼ãƒ­ã«ãªã£ãŸã€‚");return!0});u(this,"procBattlePhaseDamageStep4",async()=>(await this.setStage("afterDmgCalc"),await this.procChain(void 0,void 0),!0));u(this,"procBattlePhaseDamageStep5",async()=>(await this.setStage("end"),await S.waitCorpseDisposal(this.duel),await this.duel.clock.incrementChainSeq(),!!await this.procFreeChain()));u(this,"procBattlePhaseEndStep",async()=>{await this.setStep("end"),this.priorityHolder=this.turnPlayer,await this.procSpellSpeed1()});u(this,"canContinueBattle",()=>this.attackingMonster?(this.attackingMonster.isOnFieldStrictly?this.attackingMonster.face==="FaceDown"?(this.duel.log.info(`${this.attackingMonster.toString()}ãŒè£å´å®ˆå‚™è¡¨ç¤ºã«ãªã£ãŸãŸã‚ã€æˆ¦é—˜ãŒä¸­æ–­ã•ã‚ŒãŸã€‚`),this._attackingMonster=void 0):this.attackingMonster.orientation==="Horizontal"&&(this.duel.log.info(`${this.attackingMonster.toString()}ãŒå®ˆå‚™è¡¨ç¤ºã«ãªã£ãŸãŸã‚ã€æˆ¦é—˜ãŒä¸­æ–­ã•ã‚ŒãŸã€‚`),this._attackingMonster=void 0):(this.duel.log.info(`${this.attackingMonster.toString()}ãŒãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«å­˜åœ¨ã—ãªããªã£ãŸã‚ã€æˆ¦é—˜ãŒä¸­æ–­ã•ã‚ŒãŸã€‚`),this._attackingMonster=void 0),!!this.attackingMonster):!1);u(this,"setStep",a=>this.duel.clock.setStep(this.duel,a));u(this,"setStage",a=>this.duel.clock.setStage(this.duel,a))}get nextPhaseList(){return["main2"]}get attackingMonster(){return this._attackingMonster}get targetForAttack(){return this._targetForAttack}}class fs extends Da{constructor(a,i){super(a,i);u(this,"declareAttack",()=>{throw new A(`ãƒãƒˆãƒ«ãƒ•ã‚§ã‚¤ã‚ºä»¥å¤–ã§æ”»æ’ƒå®£è¨€ã‚’å®Ÿè¡Œã—ãŸã€‚${this.duel.clock.period.key}`)});u(this,"_proceed",async()=>{for(;;){this.priorityHolder=this.turnPlayer;const a=await this.duel.view.waitFieldAction(this.priorityHolder.getEnableActions(["NormalSummon","SpellTrapSet","SpecialSummon","FlipSummon","ChangeBattlePosition","IgnitionEffect","QuickEffect","CardActivation","LingeringEffect"],["Normal","Quick","Counter"],[]));if(a.actionInfo){if(await this.procChain({activator:this.priorityHolder,actionInfo:a.actionInfo},void 0)==="cancel")continue;await this.procFreeChain();continue}const i=a.phaseChange;if(i){this.priorityHolder=this.nonTurnPlayer;let r="done";for(;;){const n=await this.duel.view.waitQuickEffect(this.priorityHolder,this.priorityHolder.getEnableActions(["QuickEffect","CardActivation"],["Quick","Counter"],[]),[],"ç›¸æ‰‹ãŒãƒ•ã‚§ã‚¤ã‚ºã‚’çµ‚äº†ã—ã‚ˆã†ã¨ã—ã¦ã„ã‚‹ã€‚",!0);if(n&&(r=await this.procChain({activator:this.priorityHolder,actionInfo:n},void 0),r==="done")){await this.procTriggerEffects();break}return i==="battle1"?new Id(this.duel,i):new gs(this.duel)}if(r==="done"){await this.procFreeChain();continue}}}})}get nextPhaseList(){return this.duel.phase==="main1"&&this.duel.clock.turn>1?["battle1","end"]:["end"]}get attackingMonster(){}get targetForAttack(){}}class ep extends Da{constructor(a){super(a,"standby");u(this,"declareAttack",()=>{throw new A(`ãƒãƒˆãƒ«ãƒ•ã‚§ã‚¤ã‚ºä»¥å¤–ã§æ”»æ’ƒå®£è¨€ã‚’å®Ÿè¡Œã—ãŸã€‚${this.duel.clock.period.key}`)});u(this,"_proceed",async()=>(await this.procSpellSpeed1(),new fs(this.duel,"main1")))}get nextPhaseList(){return["main1"]}get attackingMonster(){}get targetForAttack(){}}class tp extends Da{constructor(a){super(a,"draw");u(this,"declareAttack",()=>{throw new A(`ãƒãƒˆãƒ«ãƒ•ã‚§ã‚¤ã‚ºä»¥å¤–ã§æ”»æ’ƒå®£è¨€ã‚’å®Ÿè¡Œã—ãŸã€‚${this.duel.clock.period.key}`)});u(this,"_proceed",async()=>{if(Object.values(this.duel.duelists).forEach(a=>a.initForDrawPhase()),this.turnPlayer.writeInfoLog("ãƒ‰ãƒ­ãƒ¼ãƒ•ã‚§ã‚¤ã‚ºé–‹å§‹ã€‚"),this.duel.clock.turn===1)this.turnPlayer.writeInfoLog("å…ˆæ”»ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã¯ãƒ‰ãƒ­ãƒ¼ã§ããªã„ã€‚");else{await this.turnPlayer.draw(1,void 0,void 0);for(const a of this.turnPlayer.getEnableActions(["Exodia"],["Normal"],[]))await a.action.directExecute(this.turnPlayer,void 0,!1)}return this.duel.field.getCardsOnFieldStrictly().forEach(a=>a.initForTurn()),await this.procSpellSpeed1(),new ep(this.duel)})}get nextPhaseList(){return["standby"]}get attackingMonster(){}get targetForAttack(){}}class gs extends Da{constructor(a){super(a,"end");u(this,"declareAttack",()=>{throw new A(`ãƒãƒˆãƒ«ãƒ•ã‚§ã‚¤ã‚ºä»¥å¤–ã§æ”»æ’ƒå®£è¨€ã‚’å®Ÿè¡Œã—ãŸã€‚${this.duel.clock.period.key}`)});u(this,"_proceed",async()=>{for(await this.procSpellSpeed1();;){const i=this.turnPlayer.getHandCell().cardEntities.length;if(i<7)break;await this.turnPlayer.discard(i-6,"Rule")}return this.turnPlayer.writeInfoLog("ã‚¿ãƒ¼ãƒ³çµ‚äº†ã€‚"),new tp(this.duel)})}get nextPhaseList(){return["draw"]}get attackingMonster(){}get targetForAttack(){}}const ap=["PlayFirst","DrawFirst","Random"],Th={PlayFirst:"å…ˆæ”»",DrawFirst:"å¾Œæ”»",Random:"ãƒ©ãƒ³ãƒ€ãƒ "};class Ch{constructor(t,a,i,r=[],n,s,l,o=[],c="Random"){u(this,"onDuelEndEvent",new ce);u(this,"view");u(this,"log");u(this,"chainBlockLog");u(this,"field");u(this,"clock");u(this,"duelists");u(this,"_facilitator");u(this,"isEnded");u(this,"winner");u(this,"reasonOfEnd","");u(this,"twitterShareText","");u(this,"coin",!1);u(this,"startMode");u(this,"declareAttack",(...t)=>this._facilitator.declareAttack(...t));u(this,"getTurnPlayer",()=>this.clock.turn%2===0?this.secondPlayer:this.firstPlayer);u(this,"getNonTurnPlayer",()=>this.clock.turn%2===0?this.firstPlayer:this.secondPlayer);u(this,"main",async()=>{console.info("main start!"),this.coin=this.startMode==="PlayFirst"?!0:this.startMode==="DrawFirst"?!1:Math.random()>.5;const t=(await Array.fromAsync(Og(...Object.values(this.duelists).flatMap(a=>a.deckInfo.cardNames).getDistinct()))).reduce((a,i)=>(a[i.name]=i,a),{});for(const a of Object.values(this.duelists))a.pushDeck(t),a.getDeckCell().shuffle(),a.initHand.length&&a.initHand.forEach(i=>{const r=a.getDeckCell().cardEntities.find(n=>n.origin.name===i);if(!r){this.log.info(`åˆæ‰‹æ“ä½œã«ã‚ˆã‚Š${i}ã‚’æ‰‹æœ­ã«åŠ ãˆã‚ˆã†ã¨ã—ãŸãŒã€ãƒ‡ãƒƒã‚­ã«å­˜åœ¨ã—ãªã„ã€‚`);return}r.addToHand(["System"],void 0,void 0),this.log.info(`åˆæ‰‹æ“ä½œã«ã‚ˆã‚Š${r.toString()}ã‚’æ‰‹æœ­ã«åŠ ãˆãŸ`,a)}),await a.draw(5-a.getHandCell().cardEntities.length,void 0,void 0);this.log.info(`ã€ãƒ‡ãƒ¥ã‚¨ãƒ«é–‹å§‹ã€‘${this.firstPlayer.profile.name} V.S. ${this.secondPlayer.profile.name}`),this.log.info(`å…ˆæ”»ï¼š${this.firstPlayer.profile.name} å¾Œæ”»ï¼š${this.secondPlayer.profile.name}`);try{for(const a of Object.values(this.duelists))for(const i of a.getEnableActions(["Exodia"],["Normal"],[]))await i.action.directExecute(a,void 0,!1);for(;!this.isEnded&&(this._facilitator=await this._facilitator.proceed(),!(this.clock.turn>1e3)););}catch(a){if(a instanceof ue){if(this.chainBlockLog.records.forEach(i=>{i.chainBlockInfo.state==="ready"?i.chainBlockInfo.state="failed":i.chainBlockInfo.state==="processing"&&(i.chainBlockInfo.state="done")}),await this.clock.incrementChainSeq(),console.info(a),this.isEnded=!0,this.winner=a.winner,this.reasonOfEnd=a.message,this.winner){const i=this.winner;if(this.winner.duelistType==="Player"&&this.winner.getOpponentPlayer().profile.npcType==="FtkChallenge"){this.twitterShareText=`ãƒ¯ãƒ³ã‚¿ãƒ¼ãƒ³ã‚­ãƒ«æˆåŠŸï¼ ä½¿ç”¨ãƒ‡ãƒƒã‚­ï¼š${this.winner.deckInfo.name}`;const r=this.chainBlockLog.records.filter(n=>n.chainBlockInfo.activator===i.getOpponentPlayer()).filter(n=>n.chainBlockInfo.action.entity.owner===i.getOpponentPlayer()).filter(n=>n.chainBlockInfo.action.isWithChainBlock).length;r&&(this.twitterShareText+=` å¦¨å®³è²«é€šï¼š${r}æžš æˆ‘ã“ããã‚Šã¦ã‚ã‚’æ¥µã‚ã—è€…ãªã‚Šï¼`)}}this.log.info(a.winner?`ãƒ‡ãƒ¥ã‚¨ãƒ«çµ‚äº†ã€‚å‹è€…${a.winner.profile.name}ã€‚${a.message}`:`ãƒ‡ãƒ¥ã‚¨ãƒ«çµ‚äº†ã€‚å¼•ãåˆ†ã‘ã€‚${a.message}`),this.view.requireUpdate(),this.onDuelEndEvent.trigger()}else a instanceof Error&&(console.info(a),this.log.error(a),console.info(a))}finally{this.log.dispose()}});u(this,"executeAutomaticPeriodActions",async()=>{let t=!1;for(const a of Object.values(this.duelists).flatMap(i=>i.getEnableActions(["SystemPeriodAction"],["Normal"],[]).map(r=>({duelist:i,...r}))))t=!0,await a.action.directExecute(a.duelist,void 0,!1);for(const a of[this.getTurnPlayer(),this.getNonTurnPlayer()].flatMap(i=>i.getEnableActions(["ContinuousPeriodAction"],["Normal"],[]).map(r=>({duelist:i,...r}))))t=!0,await a.action.directExecute(a.duelist,void 0,!1);t&&await this.clock.incrementChainSeq()});this.clock=new Xi,this.isEnded=!1,this.startMode=c,this.duelists={Below:new gt(this,"Below",t,a,i,r),Above:new gt(this,"Above",n,s,l,o)},this.field=new ad(this),this.clock.onStageChange.append(this.executeAutomaticPeriodActions),this.view=new Yd(this),this.log=new rd(this),this.chainBlockLog=new Jd(this),this._facilitator=new gs(this)}get onDuelEnd(){return this.onDuelEndEvent.expose()}get phase(){return this.clock.period.phase}get step(){return this.clock.period.step}get stage(){return this.clock.period.stage}get nextPhaseList(){return this.facilitator.nextPhaseList}get chainBlockInfos(){return this.facilitator.chainBlockInfos}get attackingMonster(){return this.facilitator.attackingMonster}get targetForAttack(){return this.facilitator.targetForAttack}get firstPlayer(){return this.coin?this.duelists.Below:this.duelists.Above}get secondPlayer(){return this.coin?this.duelists.Above:this.duelists.Below}get facilitator(){return this._facilitator}}const bh=["FtkChallenge","Free"],wh=["Normal","Hard"],xe=class xe{constructor(t){u(this,"id");u(this,"name");u(this,"description");u(this,"chainConfig");u(this,"previousGameMode");u(this,"previousNpcId");u(this,"previousNpcDeckId");u(this,"previousStartMode");u(this,"previousDifficulty");u(this,"npcLvl",Number.MAX_VALUE);u(this,"npcType","None");u(this,"save",async t=>{const a={id:this.id,name:this.name,description:this.description,chainConfig:this.chainConfig??{noticeSelfChain:!1,noticeFreeChainPhase:!1,noticeFreeChainStep:!1,noticeAfterChainInMainPhase:!1},previousGameMode:this.previousGameMode??"Preset",previousNpcId:this.previousNpcId??Number.MIN_SAFE_INTEGER,previousStartMode:this.previousStartMode,previousNpcDeckId:this.previousNpcDeckId>-1?this.previousNpcDeckId:Number.MIN_SAFE_INTEGER,...t},i=await xe.tblHeader.update(this.id,r=>({...r,...a}));return console.log(this.previousNpcDeckId,Number.MIN_SAFE_INTEGER,a,i),new xe(i)});var a;this.id=t.id,this.name=t.name,this.description=t.description,this.chainConfig=t.chainConfig,this.previousGameMode=t.previousGameMode,this.previousNpcId=((a=tn.find(i=>i.id===t.previousNpcId))==null?void 0:a.id)??tn.map(i=>i.id).min()??0,this.previousStartMode=ap.includes(t.previousStartMode)?t.previousStartMode:"Random",this.previousNpcDeckId=t.previousNpcDeckId,this.previousDifficulty=t.previousDifficulty}};u(xe,"tblHeader"),u(xe,"getOrCreateNew",async t=>{xe.tblHeader||(xe.tblHeader=new ip(t));const a=await xe.tblHeader.getAll();if(a.length){let r=a[0];return r.chainConfig||(r={...r,chainConfig:{noticeSelfChain:!1,noticeFreeChain:!1}}),new xe(r)}const i=await xe.tblHeader.insert({name:"ã‚ãªãŸ",description:"ã“ã“ã®æ–‡å­—åˆ—ã‚’ä½•ã«ä½¿ã†ã‹ã¯æœªå®šã€‚",chainConfig:{noticeSelfChain:!1,noticeFreeChain:!1},previousGameMode:"FtkChallenge",previousDifficulty:"Normal",previousNpcId:0,previousNpcDeckId:Number.MIN_SAFE_INTEGER,previousStartMode:"Random"});return new xe(i)});let en=xe;class ip extends dr{constructor(a){super(a,"TblDuelistProfile");u(this,"_prepareInitialRecords",()=>[])}}let Pi=-1;const tn=[{id:Pi--,name:"ã‚µãƒ³ãƒ‰ãƒãƒƒã‚°ãã‚“æ£’ç«‹ã¡",description:"æ”»æ’ƒå®£è¨€ãªã—ã€å¼·åˆ¶åŠ¹æžœä»¥å¤–ã®åŠ¹æžœã®ç™ºå‹•ãªã—ã€‚",npcLvl:0,npcType:"Normal"},{id:Pi--,name:"ã‚µãƒ³ãƒ‰ãƒãƒƒã‚°ãã‚“éžæš´åŠ›",description:"æ”»æ’ƒå®£è¨€ãªã—ã€‚",npcLvl:100,npcType:"Normal"},{id:Pi--,name:"ã‚µãƒ³ãƒ‰ãƒãƒƒã‚°ãã‚“ç™½å¸¯",description:"ã¨ãã«åˆ¶é™ãªã—ã€‚",npcLvl:200,npcType:"Normal"},{id:Number.MIN_SAFE_INTEGER,name:"FTK or Die",description:"FTKã«å¤±æ•—ã™ã‚‹ã¨æ•—åŒ—ã€‚",npcLvl:Number.MIN_SAFE_INTEGER,npcType:"FtkChallenge",difficulty:"Normal"},{id:Number.MIN_SAFE_INTEGER+1,name:"FTK or Die[HARD]",description:"FTKã«å¤±æ•—ã™ã‚‹ã¨æ•—åŒ—ã€‚æ‰‹æœ­èª˜ç™ºã‚ã‚Šã€‚",npcLvl:Number.MAX_SAFE_INTEGER,npcType:"FtkChallenge",difficulty:"Hard"}],rp=(e,t)=>Array.from({length:t-e},(a,i)=>e+i);Array.prototype.shuffle=function(){return this.map(t=>({item:t,seq:Math.random()})).toSorted((t,a)=>t.seq-a.seq).map(t=>t.item)};Array.prototype.randomPickMany=function(e){return this.shuffle().slice(0,e)};Array.prototype.randomPick=function(){return this.shuffle().slice(0,1)[0]};Array.prototype.reset=function(...e){this.splice(0),this.push(...e)};Array.prototype.union=function(e){return this.filter(t=>e.find(a=>t===a))};Array.prototype.getAllOnOffPattern=function*(e=0,t=Number.MAX_SAFE_INTEGER){const a=[[]];e<=0&&(yield[]);for(const i of this){const r=a.map(n=>[...n,i]);yield*r.filter(n=>n.length>=e&&n.length<=t),a.push(...r.filter(n=>n.length<t))}};Array.prototype.getDistinct=function(){return Array.from(new Set(this))};Array.prototype.distinct=function(){this.reset(...this.getDistinct())};Array.prototype.isAllUnique=function(){return this.length===this.getDistinct().length};Array.prototype.max=function(e){if(this.length)return this.reduce((t,a)=>e?e(a,t)>0?a:t:a>t?a:t)};Array.prototype.min=function(e){if(this.length)return this.reduce((t,a)=>e?e(a,t)<0?a:t:a<t?a:t)};const Eh=["noticeSelfChain","noticeFreeChain"],kh={noticeSelfChain:"ã‚»ãƒ«ãƒ•ãƒã‚§ãƒ¼ãƒ³",noticeFreeChain:"ãƒ•ãƒªãƒ¼ãƒã‚§ãƒ¼ãƒ³"},Ve=class Ve{constructor(t,a,i,r,n,s=[]){u(this,"duel");u(this,"seat");u(this,"profile");u(this,"deckInfo");u(this,"info");u(this,"infoOrigin");u(this,"status");u(this,"statusOrigin");u(this,"duelistType");u(this,"lifeLog");u(this,"actionBlackListForNPC");u(this,"_lp");u(this,"initHand");u(this,"chainConfig");u(this,"writeInfoLog",t=>this.duel.log.info(t,this));u(this,"writeChainBlockHeaderLog",(t,a)=>this.duel.log.pushChainBlockHeaderLog(this,t,a));u(this,"initForDrawPhase",()=>{this.info={...this.infoOrigin}});u(this,"canDiscard",t=>(this.status.canDiscardAsCost&&console.log(t),!0));u(this,"canSendToGraveyard",t=>(console.log(t),!0));u(this,"canRelease",t=>(console.log(t),!0));u(this,"canTryBanish",(t,a,i)=>this.entity.procFilterBundle.filter([a],this,this.entity,i,[t]));u(this,"battleDamage",t=>this.damage(t));u(this,"effectDamage",(t,a)=>Ve.effectDamage([{to:this,point:t}],a));u(this,"_effectDamage",(t,a)=>this.damage(Xu(t,a,this)));u(this,"damage",t=>{const a=[];if(t.point){const i=t.damageType==="Heal"?t.point:t.point*-1;a.push(this.setLp(this._lp+i,t.damageSource,t.damageType))}return t.damageToOpponent1&&a.push(this.getOpponentPlayer().setLp(this._lp-t.damageToOpponent1,t.damageSource,t.damageType)),t.damageToOpponent2&&a.push(this.getOpponentPlayer().setLp(this._lp-t.damageToOpponent2,t.damageSource,t.damageType)),a});u(this,"lostLp",(t,a)=>this.setLp(this._lp-t,a,"Lost"));u(this,"payLp",(t,a)=>{const i=this.setLp(this._lp-t,a,"Pay");if(this.lp<=0)throw new ue(this.getOpponentPlayer(),`${a.toString()}ã¸ã®ãƒ©ã‚¤ãƒ•ãƒã‚¤ãƒ³ãƒˆæ”¯æ‰•ã„ã«ã‚ˆã‚Šã€${this.name}ã®ãƒ©ã‚¤ãƒ•ãƒã‚¤ãƒ³ãƒˆãŒ0ã«ãªã£ãŸã€‚`);return i});u(this,"heal",(t,a)=>this.setLp(this._lp+t,a,"Heal"));u(this,"setLp",(t,a,i)=>{const r={duelist:this,clock:this.duel.clock.getClone(),reason:i||"Set",beforeLp:this._lp,afterLp:t,entity:a};return this.lifeLog.push(r),this._lp=t,this.writeInfoLog(`ãƒ©ã‚¤ãƒ•ãƒã‚¤ãƒ³ãƒˆå¤‰å‹•ï¼š${r.afterLp-r.beforeLp}ï¼ˆ${r.beforeLp} â‡’ ${r.afterLp}ï¼‰`),r});u(this,"getOpponentPlayer",()=>this.duel.firstPlayer===this?this.duel.secondPlayer:this.duel.firstPlayer);u(this,"getCells",(...t)=>this.duel.field.getCells(...t).filter(a=>{var i;return a.owner===this||((i=a.cardEntities[0])==null?void 0:i.controller)===this}));u(this,"getHandCell",()=>this.getCells("Hand")[0]);u(this,"getDeckCell",()=>this.getCells("Deck")[0]);u(this,"getExtraDeck",()=>this.getCells("ExtraDeck")[0]);u(this,"getGraveyard",()=>this.getCells("Graveyard")[0]);u(this,"getFieldZone",()=>this.getCells("FieldSpellZone")[0]);u(this,"getBanished",()=>this.getCells("Banished")[0]);u(this,"getMonsterZones",()=>this.getCells("MonsterZone"));u(this,"getExtraMonsterZones",()=>this.getCells("ExtraMonsterZone"));u(this,"getSpellTrapZones",()=>this.getCells("SpellAndTrapZone"));u(this,"getXyzMaterialZone",()=>this.getCells("XyzMaterialZone")[0]);u(this,"getEmptyMonsterZones",()=>this.getMonsterZones().filter(t=>t.cardEntities.length===0));u(this,"getAvailableMonsterZones",()=>this.getMonsterZones().filter(t=>t.isAvailable));u(this,"getAvailableExtraMonsterZones",()=>this.getExtraMonsterZones().length===0?this.duel.field.getCells("ExtraMonsterZone").filter(t=>t.isAvailable):[]);u(this,"getAvailableSpellTrapZones",()=>this.getSpellTrapZones().filter(t=>t.isAvailable));u(this,"getMonstersOnField",()=>this.duel.field.getMonstersOnFieldStrictly().filter(t=>t.controller===this));u(this,"getSpellTrapsOnField",()=>this.duel.field.getSpellTrapsOnFieldStrictly().filter(t=>t.controller===this));u(this,"getPendingMonstersOnField",()=>this.duel.field.getPendingMonstersOnField().filter(t=>t.controller===this));u(this,"getPendulumScaleMonsters",()=>this.duel.field.getCardsOnFieldStrictly().filter(t=>t.isPendulumScale).filter(t=>t.controller===this));u(this,"getPendulumScales",()=>{const t=this.getPendulumScaleMonsters();if(t.length<2)return;const a=t.find(s=>s.cell.column===(this.seat==="Below"?1:5)),i=t.find(s=>s.cell.column===(this.seat==="Below"?5:1));if(!a||!i)throw new A("æƒ³å®šã•ã‚Œãªã„çŠ¶æ…‹",t);const r=a.psR,n=i.psL;if(r===void 0||n===void 0)throw new A("æƒ³å®šã•ã‚Œãªã„çŠ¶æ…‹",t);return r>n?{upperBound:r,lowerBound:n}:{upperBound:n,lowerBound:r}});u(this,"getEntiteisOnField",()=>this.duel.field.getCardsOnFieldStrictly().filter(t=>t.controller===this));u(this,"pushDeck",t=>{this.deckInfo.cardNames.map(a=>t[a]).filter(a=>a).forEach(a=>L.createCardEntity(this,a)),this.duel.log.info(`ãƒ‡ãƒƒã‚­ã‚’ã‚»ãƒƒãƒˆã€‚ãƒ¡ã‚¤ãƒ³${this.getDeckCell().cardEntities.length}æžšã€‚ã‚¨ã‚¯ã‚¹ãƒˆãƒ©${this.getExtraDeck().cardEntities.length}æžšã€‚`,this)});u(this,"draw",async(t,a,i)=>{var s;if(t<1)return;const r=this.getDeckCell(),n=[];this.writeInfoLog(`ãƒ‡ãƒƒã‚­ã‹ã‚‰ã‚«ãƒ¼ãƒ‰ã‚’${t}æžšãƒ‰ãƒ­ãƒ¼ã€‚`);for(const l of Array(t)){if(!r.cardEntities.length)throw this.writeInfoLog(n.length>0?`ãƒ‡ãƒƒã‚­ã‹ã‚‰ã‚«ãƒ¼ãƒ‰ã‚’${t}æžšãƒ‰ãƒ­ãƒ¼ã—ã‚ˆã†ã¨ã—ãŸãŒã€${n.length}æžšã—ã‹ãƒ‰ãƒ­ãƒ¼ã§ããªã‹ã£ãŸã€‚${n}`:"ãƒ‡ãƒƒã‚­ã‹ã‚‰ã‚«ãƒ¼ãƒ‰ã‚’ãƒ‰ãƒ­ãƒ¼ã§ããªã‹ã£ãŸã€‚"),new ue(this.getOpponentPlayer(),`${this.name}ãŒãƒ‡ãƒƒã‚­ã‹ã‚‰ã‚«ãƒ¼ãƒ‰ã‚’ãƒ‰ãƒ­ãƒ¼ã§ããªã‹ã£ãŸã€‚`);const o=r.cardEntities[0];await o.draw(a?["Effect"]:["Rule"],a,i),n.push(((s=o.origin)==null?void 0:s.name)||"!åç§°å–å¾—å¤±æ•—!")}});u(this,"summon",async(t,a,i,r,n,s,l,o)=>(await this.summonMany(this,t,a,i,[{monster:r,posList:n,cells:s}],l,!1,1,d=>d.length===1,o)??[])[0]);u(this,"waitSelectNumberFromRange",(t,a,i,r)=>this.waitSelectNumber(t,rp(a,i),r));u(this,"waitSelectNumber",(t,a,i)=>this.duel.view.waitSelectNumber(this,t,a,i));u(this,"waitSelectEntities",(t,a,i,r,n=!1)=>this.duel.view.waitSelectEntities(this,{selectables:t,qty:a,validator:i,cancelable:n},r));u(this,"waitSelectEntity",async(t,a,i=!1)=>{const r=await this.waitSelectEntities(t,1,n=>n.length===1,a,i);return r?r[0]:void 0});u(this,"waitYesNo",t=>this.duel.view.waitYesOrNo(this,t));u(this,"waitSelectText",(t,a,i=!1)=>this.duel.view.waitSelectText(this,t,a,i));u(this,"getEnableActions",(t,a,i)=>{var n;const r=((n=i.slice(-1)[0])==null?void 0:n.nextChainBlockFilter)??(()=>!0);return[...this.duel.field.getAllCardEntities(),this.entity].flatMap(s=>s.actions).filter(s=>s.canExecute(this)).filter(s=>a.includes(s.spellSpeed)).filter(s=>t.includes(s.playType)).filter(s=>!s.isWithChainBlock||r(this,s)).map(s=>s.validate(this,i)).filter(s=>s!==void 0)});u(this,"discard",async(t,a,i=()=>!0,r,n,s,l=!1)=>{const o=this.getHandCell().cardEntities.filter(i);if(o.length<t)return[];let c=[];if(o.length===t)c=o;else if((s||this).duelistType==="NPC")c=o.randomPickMany(t);else{const d=await this.duel.view.waitSelectEntities(s||this,{selectables:o,qty:t,validator:p=>p.length===t,cancelable:l},`${t}æžšã‚«ãƒ¼ãƒ‰ã‚’æ¨ã¦ã‚‹ã€‚`);if(!d)return;c=d}return this.writeInfoLog(`æ‰‹æœ­ã‹ã‚‰ã‚«ãƒ¼ãƒ‰ã‚’${c.length}æžšæ¨ã¦ãŸã€‚${c.map(d=>d.toString())}ã€‚`),await S.discardManyForTheSameReason(c,["Discard",a],r,n),c});u(this,"getEnableSummonList",(t,a,i,r,n,s,l)=>{const o=this.duel.field.getCells("ExtraMonsterZone"),c=o.filter(p=>!s.map(f=>f.material).includes(p.cardEntities[0])).filter(p=>p.owner===this),d=[];return c.length&&d.push(...o.filter(p=>!c.includes(p)).filter(p=>p.isAvailable)),n.map(p=>({...p,summoner:this})).map(p=>{var f;return(a!=="LinkSummon"||!this.duel.field.canExtraLink(p.monster,s))&&(p.cells=p.cells.filter(h=>!d.includes(h))),(f=p.monster.status.monsterCategories)!=null&&f.includes("Link")&&(p.posList=p.posList.filter(h=>h==="Attack")),p}).map(p=>({...p,cells:p.cells.filter(f=>f.cardEntities.length===0||s.some(h=>h.material===f.cardEntities[0]))})).map(p=>{var f,h;if(p.monster.cell.cellType==="ExtraDeck"){if((f=p.monster.status.monsterCategories)!=null&&f.includes("Link")||(h=p.monster.status.monsterCategories)!=null&&h.includes("Pendulum"))return{...p,cells:p.cells.filter(y=>y.cellType==="ExtraMonsterZone"||y.linkArrowSources.filter(v=>!s.map(g=>g.material).includes(v)).length)}}else return{...p,cells:p.cells.filter(y=>y.cellType!=="ExtraMonsterZone")};return p}).filter(p=>p.cells.length&&p.posList.length).map(p=>this.entity.summonFilterBundle.filter(t,a,i,r,p,s,l)).filter(p=>p.cells.length&&p.posList.length).map(p=>p.monster.summonFilterBundle.filter(t,a,i,r,p,s,l)).filter(p=>p.cells.length&&p.posList.length).map(p=>s.map(f=>f.material.summonFilterBundle).reduce((f,h)=>h.filter(t,a,i,r,f,s,l),p)).filter(p=>p.cells.length&&p.posList.length)});u(this,"prepareToSummonMany",async(t,a,i,r,n,s,l,o,c,d,p="ç‰¹æ®Šå¬å–šã™ã‚‹ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã‚’é¸æŠžã€‚")=>{const f=this.getEnableSummonList(t,a,i,r,n,s,l);if(!f.length)return[];let h=f.map(v=>({...v,cells:[...v.cells],posList:[...v.posList]}));const y=[];for(;h.length&&y.length<(o??Number.MAX_SAFE_INTEGER);){const v=d&&!y.length||c(y.map(b=>b.monster));let g=h.randomPick();if(h.length>1){const b=await this.waitSelectEntity(h.map(O=>O.monster),p,v);if(!b)return y;g=h.find(O=>O.monster===b)??g}let _=[...g.posList].randomPick(),w=[...g.cells].randomPick();if((g.cells.length||g.posList.length)&&this.duelistType!=="NPC"){const b=await this.duel.view.waitSelectSummonDestination(g.summoner,g.monster,g.cells,g.posList,v);if(!b)return y;w=b.dest,_=b.battlePosition}y.push({summoner:this,monster:g.monster,pos:_,dest:w});const D=w.cellType==="ExtraMonsterZone";h.forEach(b=>{b.cells=b.cells.filter(O=>!y.map(ie=>ie.dest).includes(O)),D&&(b.cells=b.cells.filter(O=>O.cellType!=="ExtraMonsterZone"))}),h=h.filter(b=>b!==g).filter(b=>b.cells.length)}return y});u(this,"summonAll",(t,a,i,r,n,s,l,o,c)=>this.summonMany(t,a,i,r,n,s,l,n.length,d=>d.length===n.length,o,c));u(this,"summonOne",async(t,a,i,r,n,s,l,o,c)=>{const d=await this.summonMany(t,a,i,r,n,s,l,1,p=>p.length===1,o,c);if(d)return d[0]});u(this,"summonMany",(t,a,i,r,n,s,l,o,c,d,p)=>Ve.summonMany(t,a,i,r,n.map(f=>({...f,summoner:this})),s,l,o,c,d,p));u(this,"summonEachFields",(t,a,i,r,n,s,l,o,c,d)=>Ve._summonMany(t,a,i,r,[{duelist:this,msg:"è‡ªåˆ†"},{duelist:this.getOpponentPlayer(),msg:"ç›¸æ‰‹"}].map(p=>({summoner:this,msg:`${p.msg}ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«ç‰¹æ®Šå¬å–šã™ã‚‹ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã‚’é¸æŠžã€‚`,summonChoices:n.map(f=>({...f,cells:f.cells.filter(h=>h.owner===p.duelist)}))})),s,l,o,c,d));u(this,"selectAttackTargetForNPC",(t,a)=>{const i=t.atk??0,r=t.getAttackTargets();if(!r.length)return;const n=r.find(s=>s.entityType==="Duelist");return n&&(i>=ss(1600,this.getOpponentPlayer().lp)||t.info.battlePotisionChangeCount>0)?n:r.find(s=>s.battlePosition==="Attack"?i>=(s.atk??0):i<(s.battlePosition==="Set"?1e3:s.def??0)?!1:s.validateDestroy("Battle",this,t,a))});u(this,"selectActionForNPC",(t,a)=>{if(!t.length)return;const i=t.filter(g=>g.action.isMandatory);if(i.length)return i.randomPick();let r=t.filter(g=>!this.actionBlackListForNPC.includes(g.action.playType));const n=r.filter(g=>!Number.isNaN(g.action.priorityForNPC)).shuffle().sort((g,_)=>g.action.priorityForNPC-_.action.priorityForNPC);if(n.length)return n[0];const s=r.filter(g=>g.action.playType==="TriggerEffect");if(s.length)return s.randomPick();if(this.duel.phase!=="main1"&&this.duel.phase!=="main2"){const g=r.filter(_=>_.action.playType==="IgnitionEffect");if(g.length)return g.randomPick()}const l=r.filter(g=>g.action.playType==="DeclareAttack").sort((g,_)=>(g.action.entity.atk??0)-(_.action.entity.atk??0));if(l.length)return l.find(g=>this.selectAttackTargetForNPC(g.action.entity,g.action));r=r.filter(g=>g.action.playType!=="DeclareAttack");const o=r.length?a.slice(-1)[0]:void 0,c=r.filter(g=>g.action.negatePreviousBlock);if(o&&o.activator!==this&&c.length)return c.randomPick();if(r=r.filter(g=>!g.action.negatePreviousBlock),!r.length)return;const d=this.getOpponentPlayer().getMonstersOnField().filter(g=>g.battlePosition==="Attack").map(g=>g.atk??0).max()??1600,p=this.getOpponentPlayer().getMonstersOnField().map(g=>g.battlePosition==="Set"?1500:(g.battlePosition==="Attack"?g.atk:g.def)??0).min()??1500,h=this.getMonstersOnField().filter(g=>g.battlePosition==="Attack").map(g=>g.atk??0).max()??0;let y=r.filter(g=>g.action.playType!=="ChangeBattlePosition").filter(g=>g.action.entity.battlePosition!=="Attack").filter(g=>(g.action.entity.atk??0)>=d||(g.action.entity.atk??0)>p&&(g.action.entity.atk??0)>2300);if(y.length)return y.randomPick();r=r.filter(g=>g.action.playType!=="ChangeBattlePosition").filter(g=>g.action.playType!=="SpellTrapSet").filter(g=>g.action.entity.actions.filter(_=>_.playType!=="NormalSummon"&&_.playType!=="SpecialSummon").flatMap(_=>_.executableCells).every(_=>_!=="Hand")||g.action.playType!=="NormalSummon"&&g.action.playType!=="SpecialSummon");const v=[...r.filter(g=>g.action.playType==="NormalSummon").filter(g=>(g.action.entity.lvl??12)<5),...r.filter(g=>g.action.playType==="SpecialSummon"),...r.filter(g=>g.action.playType==="NormalSummon").filter(g=>(g.action.entity.atk??0)>2600||(g.action.entity.atk??0)>2300&&(g.action.entity.lvl??12)<7).filter(g=>(g.action.entity.atk??0)>=h),...r.filter(g=>g.action.entity.face==="FaceUp").filter(g=>g.action.entity.isOnFieldStrictly)];if(v.length)return v.randomPick();if(r=r.filter(g=>g.action.playType!=="NormalSummon").filter(g=>g.action.playType!=="SpecialSummon"),this.duel.phase==="main2"){if(y=t.filter(g=>g.action.playType==="ChangeBattlePosition").filter(g=>g.action.entity.battlePosition==="Attack").filter(g=>(g.action.entity.atk??0)<d||(g.action.entity.atk??0)>p&&(g.action.entity.atk??0)>2300),y.length)return y.randomPick();if(this.getAvailableSpellTrapZones().length>1)return t.filter(g=>g.action.playType==="SpellTrapSet").filter(g=>g.action.entity.kind!=="Spell"||g.action.entity.status.spellCategory==="QuickPlay").randomPick()}if(console.log(r),Math.random()<r.length/4)return r.randomPick()});this.duel=t,this.seat=a,this.profile=i,this.chainConfig=i.chainConfig??{noticeSelfChain:!0,noticeFreeChain:!0},this.duelistType=r,this.deckInfo=n,this.initHand=s,this.lifeLog=[],this.infoOrigin={maxRuleNormalSummonCount:1,ruleNormalSummonCount:0,ruleNormalSummonCountQty:0,effectNormalSummonCount:0,effectNormalSummonCountQty:0,specialSummonCount:0,specialSummonCountQty:0},this.info={...this.infoOrigin},this.statusOrigin={maxSpecialSummonCount:Number.MAX_VALUE,canDrawByEffect:!0,canSearchFromDeck:!0,canDiscardAsCost:!0,canDiscardAsEffect:!0},this.status={...this.statusOrigin},this._lp=8e3;const l=[];this.duelistType==="NPC"&&(this.profile.npcLvl<0&&l.push("NormalSummon","SpecialSummon","SpellTrapSet"),this.profile.npcLvl<1&&l.push("CardActivation","IgnitionEffect","TriggerEffect","QuickEffect"),this.profile.npcLvl<101&&l.push("DeclareAttack"),this.profile.npcLvl===Number.MAX_SAFE_INTEGER&&l.push("NormalSummon","SpecialSummon","SpellTrapSet","DeclareAttack")),this.actionBlackListForNPC=l}get entity(){const t=this.getHandCell().entities.find(a=>a.entityType==="Duelist");return t||L.createPlayerEntity(this)}get name(){return this.profile.name}get lp(){return this._lp}get previousHealedRecord(){return this.lifeLog.findLast(t=>t.afterLp>t.beforeLp)}get isTurnPlayer(){return this.duel.getTurnPlayer()===this}get canDraw(){return!0}get canAddToHandFromDeck(){return!0}get canAddToHandFromGraveyard(){return!0}get canSet(){return!0}};u(Ve,"summonMany",async(t,a,i,r,n,s,l,o,c,d,p="ç‰¹æ®Šå¬å–šã™ã‚‹ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã‚’é¸æŠžã€‚")=>Ve._summonMany(t,a,i,r,n.map(f=>f.summoner).getDistinct().map(f=>({summoner:f,summonChoices:n.filter(h=>h.summoner===f)})),s,l,o,c,d,p)),u(Ve,"_summonMany",async(t,a,i,r,n,s,l,o,c,d,p="ç‰¹æ®Šå¬å–šã™ã‚‹ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã‚’é¸æŠžã€‚")=>{const f=[];for(const h of n){const y={...h};y.summonChoices=y.summonChoices.filter(g=>!f.map(_=>_.monster).includes(g.monster));const v=await y.summoner.prepareToSummonMany(t,a,i,r,y.summonChoices.map(g=>({...g,summoner:y.summoner})),s,l,o,c,d,y.msg??p);f.push(...v)}if(f.length)return f.forEach(h=>h.monster.info.materials.reset(...s)),await S.moveToXyzOwner(f[0].dest,f[0].monster,s.map(h=>h.material).filter(h=>h.kind==="XyzMaterial"),["XyzMaterial","Rule"],f[0].monster,t),await L.summonMany(f,a,i,r,t),f.map(h=>h.monster)}),u(Ve,"effectDamage",(t,a)=>{if(!t.length)return[];const i=t.flatMap(n=>n.to._effectDamage(n.point,a)),r=Object.values(t[0].to.duel.duelists).filter(n=>n.lp>0);if(r.length===1)throw new ue(r[0],`${a.action.toFullString()}ã«ã‚ˆã‚Šã€${r[0].getOpponentPlayer().name}ã®ãƒ©ã‚¤ãƒ•ãƒã‚¤ãƒ³ãƒˆãŒ0ã«ãªã£ãŸã€‚`);if(!r.length)throw new ue(void 0,`${a.action.toFullString()}ã«ã‚ˆã‚Šã€ãŠäº’ã„ã®ãƒ©ã‚¤ãƒ•ãƒã‚¤ãƒ³ãƒˆãŒ0ã«ãªã£ãŸã€‚`);return i}),u(Ve,"calcBattleDamage",(t,a,i,r,n)=>({damageTo:t,...Ku(a,n.activator,t,i,r,n.action)}));let gt=Ve;const Qt=["Controller","Opponent"],np=["IfNormarlSummonSucceed","IfAdvanceSummonSucceed","IfSpecialSummonSucceed","IfFusionSummonSucceed","IfRitualSummonSucceed","IfSynchroSummonSucceed","IfXyzSummonSucceed","IfPendulumSummonSucceed","IfLinkSummonSucceed","IfFlipSummonSucceed","IfFlip"],sp=[...np,"IfDestroyed","IfDoneByBattle","IfDoneByEffect"],an=["NormalSummon","AdvanceSummon","SpecialSummon","SpecialSummonFromDeck","SendToGraveyardFromDeck","Draw","SearchFromDeck","BanishFromDeck","BanishFromGraveyard","AddToHandFromGraveyard","ReturnToDeckFromGraveyard","SpecialSummonFromGraveyard","SpecialSummonFromBanished","ReturnToHandFromGraveyard","ReturnToHandFromField","BanishFromField","BanishFromHand","Destroy","DestroyMultiple","DestroyOnField","DestroyMultipleOnField","DestroyOnOpponentField","DestroyMultipleOnOpponentField","DestroyMonsterOnField","DestroyMonstersOnField","DestroySpellTrapOnField","DestroySpellTrapsOnField","SpecialSummonFromHand","SpecialSummonFromExtraDeck","SpecialSummonToken","DamageToOpponent","DamageToSelf","PayLifePoint","DiscordAsCost","DiscordAsEffect","RollDice","BounceToHand","NegateCardEffect","NegateCardActivation","NegateNormalSummon","NegateSpecialSummon","DelegateAnotherEffect",...sp],ma=["discard","banish","release","returnToDeck","returnToHand","sendToGraveyard","xyzMaterial"],lp=e=>Object.hasOwn(e,"selectedEntities")&&Object.hasOwn(e,"chainBlockTags"),op=e=>e.triggerType==="Arrival",cp=e=>e.triggerType==="Departure",Be=class Be extends ha{constructor(a,i,r,n){super(a,i,r);u(this,"getTargetableEntities",(a,i)=>{if(this.definition.hasToTargetCards&&!this.definition.getTargetableEntities)throw new A(`å‡¦ç†å®šç¾©ãŒçŸ›ç›¾ã—ã¦ã„ã‚‹ã€‚${this.toFullString()}`,this);return this.definition.getTargetableEntities?this.definition.getTargetableEntities(a,i):[]});u(this,"toString",()=>this.playType==="CardActivation"?"ã‚«ãƒ¼ãƒ‰ã®ç™ºå‹•":this.isWithChainBlock?`Â«${this.title}Â»`:this.title);u(this,"toFullString",()=>`${this.entity.toString()}ã®${this.toString()}`);u(this,"addhocMaterialLimitation");u(this,"getClone",a=>new Be(this.seq,this.entity,this.definition,a));u(this,"validate",(a,i,r=[],n)=>{const s=r.includes("IgnoreRegularCosts"),l=r.includes("IgnoreConditions"),o=r.includes("CopyEffectOnly");if(this.isWithChainBlock&&!this.entity.status.canActivateEffect||s&&this.needsToPayRegularCosts||!this.validateCount(a,i,n))return;const c=i.map(f=>f.chainNumber??-1).max()??0,d={index:i.length,chainNumber:this.isWithChainBlock?c+1:void 0,action:this,activator:a,targetChainBlock:i.slice(-1)[0],state:"unloaded",dest:void 0,ignoreCosts:!1};if(this.definition.canPayCosts&&!s&&!this.definition.canPayCosts(d,this.playType==="AfterChainBlock"?[]:i))return;if(this.definition.triggerPattern){if(op(this.definition.triggerPattern)){if(!Be.validateArrivalTrigger(this.entity,this.definition.triggerPattern))return}else if(cp(this.definition.triggerPattern)&&!Be.validateDepartureTrigger(this.entity,this.definition.triggerPattern))return}if(this.definition.meetsConditions&&!l&&!this.definition.meetsConditions(d,this.playType==="AfterChainBlock"?[]:i))return;if(this.definition.canExecute){const f=this.definition.canExecute(d,this.playType==="AfterChainBlock"?[]:i,n);if(f==="RemoveMe"){this.entity.actions.reset(...this.entity.actions.filter(h=>h.seq!==this.seq));return}if(!f)return}const p=[];if(this.definition.getDests&&p.push(...this.definition.getDests(d,this.playType==="AfterChainBlock"?[]:i)),this.playType==="CardActivation"&&!o){const f=this.getDestForCardActivation(a);if(!f)return;p.push(...f)}else this.playType==="SpellTrapSet"&&(this.entity.status.spellCategory==="Field"?p.push(a.getFieldZone()):p.push(...a.getAvailableSpellTrapZones()));return{action:this,dests:p,originSeq:this.seq}});u(this,"validateCount",(a,i,r)=>{if(r)return!0;const n=i.filter(l=>this.isSameGroup(l.action)).length;if(this.isOnlyNTimesPerDuel>0&&this.duel.chainBlockLog.records.filter(l=>!l.chainBlockInfo.isNegatedActivationBy).filter(l=>this.isSameGroup(l.chainBlockInfo.action)).filter(l=>l.chainBlockInfo.activator===a).length+n>=this.isOnlyNTimesPerDuel||this.isOnlyNTimesPerTurn>0&&this.duel.chainBlockLog.records.filter(l=>l.clock.turn===this.duel.clock.turn).filter(l=>!l.chainBlockInfo.isNegatedActivationBy).filter(l=>this.isSameGroup(l.chainBlockInfo.action)).filter(l=>l.chainBlockInfo.activator===a).length+n>=this.isOnlyNTimesPerTurn||this.isOnlyNTimesPerChain>0&&n>=this.isOnlyNTimesPerChain)return!1;const s=n+this.entity.counterHolder.getActionCount(this);return!(this.isOnlyNTimesPerTurnIfFaceup>0&&s>=this.isOnlyNTimesPerTurnIfFaceup||this.isOnlyNTimesIfFaceup>0&&s>=this.isOnlyNTimesIfFaceup)});u(this,"getDestForCardActivation",a=>{var r;if(this.entity.info.isPending||this.entity.info.isDying||this.entity.info.isSettingSickness)return;if(this.entity.isOnFieldAsSpellTrapStrictly)return this.entity.face==="FaceDown"?[]:void 0;if(this.entity.cell.cellType!=="Hand"||this.definition.canActivateCardDirectly||!a.isTurnPlayer)return;if(this.entity.status.spellCategory==="Field")return[a.getFieldZone()];let i=a.getAvailableSpellTrapZones();return(r=this.entity.status.monsterCategories)!=null&&r.includes("Pendulum")&&(i=i.filter(n=>n.isAvailableForPendulum)),i});u(this,"prepare",async(a,i,r,n,s,l)=>{var b,O;var ie=[];try{let o=i;let c=s;const d=this.isWithChainBlock?(n.map(k=>k.chainNumber??-1).max()??0)+1:void 0;let p="";const f=[];if(this.playType==="CardActivation"||this.playType==="SpellTrapSet")if(this.entity.cell.cellType==="Hand"){let k=this.entity.status.spellCategory==="Field"?[a.getFieldZone()]:a.getAvailableSpellTrapZones();if((b=this.entity.status.monsterCategories)!=null&&b.includes("Pendulum")&&(k=k.filter(re=>re.isAvailableForPendulum)),o&&k.includes(o)&&(k=[o],o=void 0),this.entity.status.spellCategory==="Field"){const re=a.getFieldZone().cardEntities;if(re.length){const Te=re[0];f.push(async()=>{await Te.sendToGraveyard(["Rule"],this.entity,a),a.writeInfoLog(`ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰é­”æ³•ã®ä¸Šæ›¸ãã«ã‚ˆã‚Šã€${Te.toString()}ã¯å¢“åœ°ã«é€ã‚‰ã‚ŒãŸã€‚`)}),c=!1}}let se=k[0];if(k.length>1){se=k.randomPick();const re=this.playType==="SpellTrapSet"?"ã‚»ãƒƒãƒˆ":"ã‚«ãƒ¼ãƒ‰ã®ç™ºå‹•",Te=await this.duel.view.waitSelectDestination(a,this.entity,k,"ã‚«ãƒ¼ãƒ‰ã‚’ç§»å‹•å…ˆã¸ãƒ‰ãƒ©ãƒƒã‚°",re,c);if(!Te)return;se=Te}p+="æ‰‹æœ­ã‹ã‚‰",this.playType==="SpellTrapSet"?p+="é­”æ³•ãƒ»ç½ ã‚«ãƒ¼ãƒ‰ã‚’ã‚»ãƒƒãƒˆã€‚":p+=`${this.entity.toString()}ã‚’ç™ºå‹•ã€‚`,c=!1,this.playType==="CardActivation"&&(this.entity.info.isPending=!0),(O=this.entity.status.monsterCategories)!=null&&O.includes("Pendulum")?f.push(()=>this.entity.activateAsPendulumScale(se,["CardActivation"],this.entity,a)):this.playType==="CardActivation"?f.push(()=>this.entity.activateSpellTrapFromHand(se,this.entity.kind,["CardActivation"],this.entity,a)):f.push(()=>this.entity.setAsSpellTrap(se,this.entity.kind,["SpellTrapSet"],this.entity,a))}else this.entity.isOnField&&this.entity.face==="FaceDown"?(p+=`ã‚»ãƒƒãƒˆã•ã‚Œã¦ã„ãŸ${this.entity.toString()}ã‚’ç™ºå‹•ã€‚`,c=!1,this.playType==="CardActivation"&&(this.entity.info.isPending=!0),f.push(()=>this.entity.setNonFieldMonsterPosition(this.entity.origin.kind,"FaceUp",["Rule"]))):p="";else d!==void 0&&(p+=`${this.toFullString()}ã‚’ç™ºå‹•ã€‚`);const h=Er(ie,this.duel.log.openTransaction());p&&d&&a.writeChainBlockHeaderLog(d,p);for(const k of f)await k();const y={index:n.length,chainNumber:d,action:this,activator:a,targetChainBlock:r,isActivatedIn:this.entity.cell,isActivatedAt:this.duel.clock.getClone(),enableCellTypes:[...this.entity.info.isEffectiveIn],costInfo:{},state:"ready",dest:o,ignoreCosts:!1};if(this.definition.payCosts&&!l){const k=await this.definition.payCosts(y,n,c);if(!k)return;y.costInfo=k,c=!1}const v=await this.definition.prepare(y,n,c);if(v===void 0)return;const g={...v};g.selectedEntities=g.selectedEntities??[];g.chainBlockTags=[...g.chainBlockTags??[],...this.definition.fixedTags??[]];g.chainBlockTags.some(k=>k.startsWith("SpecialSummon"))&&g.chainBlockTags.push("SpecialSummon");g.chainBlockTags=g.chainBlockTags.getDistinct();if(rs.some(k=>k===this.playType)){const k=v.nextChainBlockFilter??(()=>!0);g.nextChainBlockFilter=(se,re)=>re.negateSummon&&k(se,re)}const _=new id(y.state);const w={...g,...y};Object.keys(w).filter(k=>k!=="state").forEach(k=>{_[k]=w[k]});const D=_;h.commit();return D}catch(_e){var G=_e,q=!0}finally{kr(ie,G,q)}});u(this,"execute",async(a,i,r)=>{const n=(r==null?void 0:r.indirectly)??!1;if(a.action.isLikeContinuousSpell&&(a.action.entity.face==="FaceDown"||!a.action.entity.isOnField))return this.entity.info.isPending=!1,a.state="failed",!1;a.state="processing";let s=!1;if(!n&&a.chainNumber&&a.activator.writeChainBlockHeaderLog(a.chainNumber,`${a.action.toFullString()}ã®åŠ¹æžœå‡¦ç†ã€‚`),a.isNegatedActivationBy)a.state="negated",a.chainNumber&&a.activator.writeInfoLog(`ãƒã‚§ãƒ¼ãƒ³${a.chainNumber}: ${a.action.toFullString()}ã‚’${a.isNegatedActivationBy.toFullString()}ã«ã‚ˆã£ã¦ç™ºå‹•ãŒç„¡åŠ¹ã«ã•ã‚ŒãŸã€‚`);else{const l=this.playType==="SystemPeriodAction"||this.playType==="Exodia";let o=a.action.entity.isEffective||l,c="";if(o&&!l){if(a.isNegatedEffectBy)c=`ãƒã‚§ãƒ¼ãƒ³${a.chainNumber}: ${a.action.toFullString()}ã‚’${a.isNegatedEffectBy.toFullString()}ã«ã‚ˆã£ã¦åŠ¹æžœã‚’ç„¡åŠ¹ã«ã—ãŸã€‚`,o=!1;else if(this.isWithChainBlock&&!a.enableCellTypes.includes(a.isActivatedIn.cellType)){const d=a.action.entity.moveLog.records.findLast(p=>p.face==="FaceDown"&&p.orientation==="Horizontal");o=(d&&a.activator.duel.clock.isSameChain(d.movedAt))??!1}}o?(s=await this.definition.execute(a,i),a.state=s?"done":"failed"):(a.state="negated",a.chainNumber&&(c=c||`ãƒã‚§ãƒ¼ãƒ³${a.chainNumber}: ã‚«ãƒ¼ãƒ‰ã®åŠ¹æžœãŒç„¡åŠ¹ã¨ãªã£ã¦ã„ã‚‹ãŸã‚${a.action.toFullString()}ã®åŠ¹æžœå‡¦ç†ã‚’è¡Œãˆãªã„ã€‚`),a.activator.writeInfoLog(c)),await this.entity.determine(),n||(this.entity.cell.isPlayFieldCell&&(this.isOnlyNTimesPerTurnIfFaceup>0?this.entity.counterHolder.incrementActionCountPerTurn(this):this.isOnlyNTimesIfFaceup>0&&this.entity.counterHolder.incrementActionCount(this)),this.definition.settle(a,i))}return s});u(this,"directSettle",(...a)=>this.definition.settle(...a));u(this,"directExecute",async(a,i,r)=>{const n=await this.prepare(a,void 0,i,[],!1,r);if(!n)throw new A("æƒ³å®šã•ã‚Œãªã„çŠ¶æ…‹",this,a,r);return a.duel.chainBlockLog.push(n),await this.execute(n,[])});u(this,"calcChainBlockTagsForDestroy",(a,i)=>{if(!an.length)return[];const r=["Destroy"];an.length>1&&r.push("DestroyMultiple");const n=i.filter(c=>c.isOnFieldStrictly);n.length&&(r.push("DestroyOnField"),n.length>1&&r.push("DestroyMultipleOnField"));const s=n.filter(c=>c.kind==="Monster");s.length&&(r.push("DestroyMonsterOnField"),s.length>1&&r.push("DestroyMonstersOnField")),n.filter(c=>c.kind!=="Monster").length&&(r.push("DestroySpellTrapOnField"),s.length>1&&r.push("DestroySpellTrapsOnField"));const o=n.filter(c=>c.controller!==a);return o.length&&(r.push("DestroyOnOpponentField"),o.length>1&&r.push("DestroyMultipleOnOpponentField")),r});this.addhocMaterialLimitation=n??(()=>!0)}get definition(){return super.definition}get playType(){return this.definition.playType}get spellSpeed(){return this.definition.spellSpeed}get needsToPayRegularCosts(){return this.definition.needsToPayRegularCost??!1}get hasToTargetCards(){return this.definition.hasToTargetCards??!1}get fixedTags(){return this.definition.fixedTags??[]}get isWithChainBlock(){return fr.some(a=>a===this.playType)}get isChainable(){return bu.some(a=>a===this.playType)}get isLikeContinuousSpell(){return this.definition.isLikeContinuousSpell||this.entity.isLikeContinuousSpell&&this.playType==="CardActivation"}get isNoticedForcibly(){return this.definition.isNoticedForcibly||this.isMandatory||this.definition.playType==="TriggerEffect"||this.definition.playType==="LingeringEffect"||this.negatePreviousBlock||this.negateSummon}get negatePreviousBlock(){return this.definition.negatePreviousBlock??!1}get negateSummon(){return this.definition.negateSummon??!1}get priorityForNPC(){return this.definition.priorityForNPC??Number.NaN}*getEnableMaterialPatterns(a){this.definition.getEnableMaterialPatterns&&(yield*this.definition.getEnableMaterialPatterns(a).filter(this.addhocMaterialLimitation))}};u(Be,"createNew",(a,i)=>new Be("AutoSeq",a,i)),u(Be,"validateArrivalTrigger",(a,i)=>{const r=i.needsJustNow??!1;if(!a.hasBeenArrivalNow(i.arrivalReasons,i.battlePositions??T,r))return!1;const n=a.moveLog.latestArrivalRecord;if(!n)throw new A("æƒ³å®šã•ã‚Œãªã„çŠ¶æ…‹");return!(i.needsByOpponent&&n.chooser===a.controller||i.needsByEffect&&!n.movedAs.includes("Effect")||i.causerFilter&&(!n.movedBy||!i.causerFilter(a,n.movedBy)))}),u(Be,"validateDepartureTrigger",(a,i)=>{const r=i.needsJustNow??!1,n=a.moveLog.latestRecord;if(console.log(a.toString(),a.duel.clock.toFullString(),n.movedAt),!a.duel.clock.isPreviousChain(n.movedAt)||r&&!a.duel.clock.isPreviousProc(n.movedAt)||i.from&&!i.from.includes(a.wasMovedFrom.cellType)||a.cell.cellType==="Graveyard"&&a.wasMovedFrom.cellType==="Banished"||i.needsByDestory&&!n.movedAs.includes("Destroy"))return!1;if(i.needsByBattle||i.needsByEffect){let s=!1;if((i.needsByBattle&&n.movedAs.includes("Battle")||i.needsByEffect&&n.movedAs.includes("Effect"))&&(s=!0),!s)return!1}return!(i.needsByOpponent&&(a.wasMovedFrom.owner===a.controller.getOpponentPlayer()||n.actionOwner===a.controller&&!n.movedAs.includes("Battle"))||i.causerFilter&&(!n.movedBy||!i.causerFilter(a,n.movedBy)))}),u(Be,"createDummyAction",(a,i,r,n,s)=>({action:Be.createNew(a,{title:i,isMandatory:!1,executableCells:[],executablePeriods:[],executableDuelistTypes:[],playType:"Dammy",spellSpeed:"Dammy",getDests:()=>r,prepare:async()=>{},execute:async()=>!1,settle:async()=>!1}),dests:r,battlePosition:n,originSeq:(s==null?void 0:s.seq)??-1}));let Mt=Be;const m=async()=>({selectedEntities:[]}),up=(e,t)=>e.action.getTargetableEntities(e,t).filter(a=>a.isOnField).map(a=>a.cell),rn=(e,t,a,i={})=>{const{posList:r,cells:n}={posList:T,cells:e.activator.getMonsterZones(),...i};return e.activator.getEnableSummonList(e.activator,"SpecialSummon",["Effect"],e.action,a(e,t).filter(s=>s.kind==="Monster").filter(s=>s.canBeTargetOfEffect(e)).map(s=>({monster:s,posList:r,cells:n})),[],!1)},hs=async(e,t,a=T,i=n=>n.length===1,r=1)=>{const n=e.activator.getMonsterZones(),s=e.activator.getEnableSummonList(e.activator,"SpecialSummon",["Effect"],e.action,t.filter(c=>c.kind==="Monster").filter(c=>c.canBeTargetOfEffect(e)).map(c=>({monster:c,posList:a,cells:n})),[],!1),l=await e.activator.waitSelectEntities(s.map(c=>c.monster),r,i,"ç‰¹æ®Šå¬å–šã™ã‚‹ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã‚’é¸æŠž",!1)??[];if(!l.length)throw new N(e);const o=l.map(c=>c.cell.cellType).getDistinct().filter(c=>c==="Graveyard"||c==="Banished").map(c=>c==="Graveyard"?"SpecialSummonFromGraveyard":"SpecialSummonFromBanished");return{selectedEntities:l,chainBlockTags:o}},mr=async(e,t,a)=>{const{posList:i,allOrNothing:r,cells:n,materialInfos:s}={posList:T,allOrNothing:!0,cells:e.activator.getMonsterZones(),materialInfos:[],...a},l=e.selectedEntities.filter(o=>!o.wasMovedAfter(e.isActivatedAt)).map(o=>({monster:o,posList:i,cells:n}));return r&&(l.length!==e.selectedEntities.length||n.length<l.length)?!1:(await e.activator.summonAll(e.activator,"SpecialSummon",["Effect"],e.action,l,s,!1,!1),!0)},ys=async(e,t,a)=>{const i=(a==null?void 0:a.cells)??e.activator.getMonsterZones(),r=(a==null?void 0:a.posList)??T,n=t.map(s=>({monster:s,posList:r,cells:i}));return await e.activator.summonAll(e.activator,"SpecialSummon",["Effect"],e.action,n,[],!1,!1),!0},Ye=(e,t={})=>{const a=t.qty??1;return{hasToTargetCards:!0,getTargetableEntities:e,canExecute:(i,r,n)=>(!t.canExecute||t.canExecute(i,r,n))&&rn(i,r,e,t).length>=a,prepare:async(i,r,n)=>{const s=t.tags??[],l=t.message??"ç‰¹æ®Šå¬å–šã™ã‚‹ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã‚’é¸æŠžã€‚",o=rn(i,r,e,t),c=await i.activator.waitSelectEntities(o.map(d=>d.monster),a,d=>d.length===a,l,n);if(c)return s.push(...c.map(d=>d.cell.cellType).getDistinct().filter(d=>d==="Graveyard"||d==="Banished").map(d=>d==="Graveyard"?"SpecialSummonFromGraveyard":"SpecialSummonFromBanished")),{selectedEntities:c,chainBlockTags:s,appendix:[`å¯¾è±¡ï¼š${c.map(d=>d.toString()).join(", ")}`]}},execute:async(...i)=>{const r=await mr(...i,t);return t.afterExecute?t.afterExecute(r,...i):r}}},de=(e,t={})=>{const a=(i,r,n)=>e(i,r,n).filter(s=>s.canBeTargetOfEffect(i));return{hasToTargetCards:!0,getTargetableEntities:e,canExecute:(...i)=>a(...i).length>0&&(!t.canExecute||t.canExecute(...i)),getDests:up,prepare:async(i,r,n)=>{let s=[];const l=t.tags??[],o=t.message??(t.do==="Destroy"?"ç ´å£Šã™ã‚‹ã‚«ãƒ¼ãƒ‰ã‚’é¸æŠžã€‚":"å¯¾è±¡ã¨ã™ã‚‹ã‚«ãƒ¼ãƒ‰ã‚’é¸æŠžã€‚");if(i.dest)s=[i.dest.cardEntities[0]];else{const c=await i.activator.waitSelectEntity(a(i,r),o,n);if(!c)return;s=[c]}return t.do==="Destroy"&&l.push(...i.action.calcChainBlockTagsForDestroy(i.activator,s)),{selectedEntities:s,chainBlockTags:l,appendix:[`å¯¾è±¡ï¼š${s.map(c=>c.toString()).join(", ")}`]}}}},Ki=async(e,t,a)=>{const i=(a==null?void 0:a.qty)??1,r=(a==null?void 0:a.targets)??["Opponent"],n=[];return r.includes("Self")&&n.push(...e.activator.getDeckCell().cardEntities.slice(0,i)),r.includes("Opponent")&&n.push(...e.activator.getOpponentPlayer().getDeckCell().cardEntities.slice(0,i)),await S.sendManyToGraveyardForTheSameReason(n,["Effect"],e.action.entity,e.activator),!0},_r=e=>({prepare:m,execute:(...t)=>Ki(...t,e)}),E={title:"ã‚»ãƒƒãƒˆ",playType:"SpellTrapSet",spellSpeed:"Normal",executableCells:["Hand"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],isMandatory:!1,prepare:m,execute:async()=>!0,settle:async()=>!0},lt={title:"ç™ºå‹•",isMandatory:!1,playType:"CardActivation",spellSpeed:"Normal",executableCells:["Hand","SpellAndTrapZone","FieldSpellZone"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],prepare:m,execute:async()=>!0,settle:async()=>!0},dp=async(e,t,a,i,r)=>{const n=e.action.getTargetableEntities(e,t);if(!n)throw new A("CardActionå®šç¾©ãŒæ­£ã—ããªã„",e);const s=await e.activator.waitSelectEntity(n,"è£…å‚™å¯¾è±¡ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã‚’é¸æŠž",a);if(s)return e.action.entity.info.equipedBy=s,e.action.entity.info.effectTargets[e.action.seq]=[s],{chainBlockTags:i??[],selectedEntities:[s],prepared:r}},vs=async(e,t,a=()=>!0)=>{const i=e.selectedEntities[0];return e.action.entity.info.equipedBy=i,e.action.entity.info.effectTargets[e.action.seq]=[i],a(i,e.action.entity)?(e.action.entity.info.equipedBy=i,e.action.entity.info.validateEquipOwner=a,i.info.equipEntities.push(e.action.entity),!0):(await e.action.entity.ruleDestroy(),e.activator.writeInfoLog(`${i.toString()}ãŒè£…å‚™æ¡ä»¶ã‚’æº€ãŸã•ãªããªã£ãŸãŸã‚ã€${e.action.entity.toString()}ã¯ç ´å£Šã•ã‚ŒãŸã€‚`),!1)},jt=(e=()=>!0)=>({title:"ç™ºå‹•",isMandatory:!1,playType:"CardActivation",spellSpeed:"Normal",executableCells:["Hand","SpellAndTrapZone"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],getTargetableEntities:t=>t.action.entity.field.getMonstersOnFieldStrictly().filter(a=>a.face==="FaceUp").filter(a=>a.canBeTargetOfEffect(t)).filter(a=>e(a,t.action.entity)),getDests:(t,a)=>t.action.getTargetableEntities(t,a).filter(i=>i.isOnFieldAsMonsterStrictly).map(i=>i.cell),prepare:(t,a,i)=>dp(t,a,i,[],void 0),execute:vs,settle:async()=>!0});function*pp(){yield{name:"é€£åˆè»",actions:[lt,E],continuousEffects:[Ka("ç™ºå‹•","Spell",e=>[I.createContinuous("ç™ºå‹•",t=>t.isSpawnedBy.isOnFieldStrictly&&t.isSpawnedBy.face==="FaceUp",e,(t,a)=>a.controller===t.isSpawnedBy.controller&&a.types.includes("Warrior")&&a.isOnFieldStrictly&&a.face==="FaceUp","attack","wip","Addition",(t,a,i)=>{if(!t.isEffective||a.face==="FaceDown")return i;const r=t.controller.getMonstersOnField().filter(n=>n.face==="FaceUp").filter(n=>n.types.includes("Warrior")||n.types.includes("Spellcaster")).length;return i+r*200})])]}}const ms=Object.freeze(Object.defineProperty({__proto__:null,default:pp},Symbol.toStringTag,{value:"Module"}));function*fp(){const e=[{name:"ãƒªãƒ“ãƒ³ã‚°ãƒ‡ãƒƒãƒ‰ã®å‘¼ã³å£°",pos:"Attack",filter:()=>!0},{name:"ã‚¨ãƒ³ã‚¸ã‚§ãƒ«ãƒ»ãƒªãƒ•ãƒˆ",pos:"Attack",filter:t=>(t.lvl??12)<3},{name:"æ­£çµ±ãªã‚‹è¡€çµ±",pos:"Attack",filter:t=>{var a;return!!((a=t.status.monsterCategories)!=null&&a.includes("Normal"))}},{name:"è˜‡ã‚Šã—é­‚",pos:"Defense",filter:t=>{var a;return!!((a=t.status.monsterCategories)!=null&&a.includes("Normal"))}},{name:"ãƒªãƒŸãƒƒãƒˆãƒ»ãƒªãƒãƒ¼ã‚¹",pos:"Attack",filter:t=>(t.atk??9999)<=1e3,targetImmdAction:async(t,a)=>{if(a){if(!a.isOnFieldAsMonsterStrictly||a.face==="FaceDown")return"RemoveMe";if(t.entity.isEffective&&a.battlePosition==="Defense")return t.entity.controller.writeInfoLog(`${a.toString()}ãŒå®ˆå‚™è¡¨ç¤ºã«ãªã£ãŸãŸã‚ã€${t.entity.toString()}ã¨ã¨ã‚‚ã«ç ´å£Šã•ã‚Œã‚‹ã€‚`),await S.tryMarkForDestroy([a,t.entity],{action:t,activator:t.entity.controller,selectedEntities:[a]}),"RemoveMe"}}}];for(const t of e)yield{name:t.name,actions:[{title:"ç™ºå‹•",isMandatory:!1,playType:"CardActivation",spellSpeed:"Quick",executableCells:["SpellAndTrapZone"],executablePeriods:C,executableDuelistTypes:["Controller"],fixedTags:["SpecialSummonFromGraveyard","SpecialSummon"],...Ye(a=>a.activator.getGraveyard().cardEntities.filter(i=>i.kind==="Monster").filter(t.filter).filter(i=>i.canBeTargetOfEffect(a)),{posList:["Attack"],afterExecute:async(a,i)=>!a||!i.selectedEntities.length?!1:(i.action.entity.info.effectTargets[i.action.seq]=i.selectedEntities,!0)}),settle:async()=>!0},E],immediatelyActions:[{title:"è‡ªå£Š",executableCells:Ke,executablePeriods:ae,executableFaces:hr,execute:async(a,i,r)=>{if(t.targetImmdAction&&i&&Object.values(a.entity.info.effectTargets).flatMap(l=>l).includes(i)){t.targetImmdAction(a,i,r);return}if(console.log(a.entity.toString(),a,i,r),i!==a.entity||(console.log(a.entity.toString(),a,i,r),!r))return;console.log(a.entity.toString(),a,i,r);const n=Object.values(r.info.effectTargets).flatMap(l=>l);if(!n.length)return;console.log(a.entity.toString(),a,i,r);const s=n[0];s.isOnFieldAsMonsterStrictly&&s.face==="FaceUp"&&r.status.isEffective&&r.info.isEffectiveIn.includes(r.cell.cellType)&&(a.entity.controller.writeInfoLog(`${a.entity.toString()}ãŒãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’é›¢ã‚ŒãŸãŸã‚ã€å¯¾è±¡ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼${s.toString()}ã‚’ç ´å£Šã€‚`),await S.tryMarkForDestroy([s],{action:a,activator:a.entity.controller,selectedEntities:n}))}}]}}const _s=Object.freeze(Object.defineProperty({__proto__:null,default:fp},Symbol.toStringTag,{value:"Module"}));function*gp(){yield{name:"æ˜‡å¤©ã®é»’è§’ç¬›",actions:[{title:"ç™ºå‹•",isMandatory:!1,playType:"CardActivation",spellSpeed:"Counter",executableCells:["SpellAndTrapZone"],executablePeriods:ae,executableDuelistTypes:["Controller"],negateSummon:!0,fixedTags:["NegateSpecialSummon"],canExecute:e=>(e.targetChainBlock&&e.targetChainBlock.action.playType==="SpecialSummon"&&e.targetChainBlock.activator!==e.activator&&e.activator.duel.field.getPendingMonstersOnField().length===1)??!1,prepare:m,execute:async e=>{const t=S.negateSummonMany(e.action.entity,e.activator);return await S.tryDestroy(t,e),!0},settle:async()=>!0},E]}}const Ss=Object.freeze(Object.defineProperty({__proto__:null,default:gp},Symbol.toStringTag,{value:"Module"})),ea=async(e,t,a)=>(e.activator.payLp(a,e.action.entity),{lifePoint:a}),nn=async e=>{const t=Math.floor(e.activator.lp/2);return e.activator.payLp(t,e.action.entity),{lifePoint:t}};function*hp(){yield*[{name:"å›£çµã®åŠ›",filter:e=>e.isMonster&&e.face==="FaceUp",rate:800},{name:"é­”å°Žå¸«ã®åŠ›",filter:e=>e.kind==="Spell"||e.kind==="Trap",rate:500}].map(e=>({name:e.name,actions:[jt(),E],continuousEffects:[ka(e.name,"Spell",t=>t.info.equipedBy?[t.info.equipedBy]:[],t=>["attack","defense"].map(a=>I.createContinuous("ç™ºå‹•",i=>i.isSpawnedBy.isOnFieldStrictly&&i.isSpawnedBy.face==="FaceUp",t,(i,r)=>r.isOnFieldStrictly&&r.face==="FaceUp",a,"wip","Addition",(i,r,n)=>{if(!i.isEffective)return n;const s=i.controller.getEntiteisOnField().filter(e.filter).length;return n+s*e.rate})))]})),yield{name:"æ—©ã™ãŽãŸåŸ‹è‘¬",actions:[{title:"ç™ºå‹•",isMandatory:!1,playType:"CardActivation",spellSpeed:"Normal",executableCells:["Hand","SpellAndTrapZone"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],fixedTags:["SpecialSummonFromGraveyard","PayLifePoint"],canPayCosts:e=>e.activator.lp>=800,payCosts:(e,t)=>ea(e,t,800),...Ye(e=>e.activator.getGraveyard().cardEntities.filter(t=>t.kind==="Monster").filter(t=>t.canBeTargetOfEffect(e)),{posList:["Attack"],afterExecute:async(e,t,a)=>e?vs(t,a,(i,r)=>{var n;return(n=r.info.effectTargets[t.action.seq])==null?void 0:n.includes(i)}):(await t.action.entity.ruleDestroy(),!1)}),settle:async()=>!0},E],immediatelyActions:[{title:"è‡ªå£Š",executableCells:["SpellAndTrapZone",...yi],executablePeriods:ae,executableFaces:["FaceUp"],execute:async(e,t,a)=>{if(t!==e.entity||!a)return;const i=a.info.equipedBy;i&&i.isOnFieldStrictly&&i.face==="FaceUp"&&a.status.isEffective&&a.info.isEffectiveIn.includes(a.cell.cellType)&&!t.cell.isSpellTrapZoneLikeCell&&t.moveLog.latestRecord.movedAs.some(r=>r.endsWith("Destroy"))&&(e.entity.controller.writeInfoLog(`${e.entity.toString()}ãŒç ´å£Šã•ã‚ŒãŸãŸã‚ã€å¯¾è±¡ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼${i.toString()}ã‚’ç ´å£Šã€‚`),await S.tryMarkForDestroy([i],{action:e,activator:e.entity.controller,selectedEntities:[i]}))}}]},yield{name:"å¹»æƒ‘ã®å·»ç‰©",actions:[jt(),E],continuousEffects:[]}}const Ts=Object.freeze(Object.defineProperty({__proto__:null,default:hp},Symbol.toStringTag,{value:"Module"}));function*yp(){yield*[{name:"ä¼èª¬ã®å‰£",attr:void 0,monType:"Warrior",atk:200,def:200},{name:"ç§˜è¡“ã®æ›¸",attr:void 0,monType:"Spellcaster",atk:200,def:200},{name:"ãƒã‚»ã‚¤ãƒ‰ãƒ³ã®åŠ›",attr:void 0,monType:"Aqua",atk:200,def:200},{name:"ç´«æ°´æ™¶",attr:void 0,monType:"Zombie",atk:200,def:200},{name:"çŒ›ç£ã®æ­¯",attr:void 0,monType:"Beast",atk:200,def:200},{name:"æ©Ÿæ¢°æ”¹é€ å·¥å ´",attr:void 0,monType:"Machine",atk:200,def:200},{name:"ä½“æ¸©ã®ä¸Šæ˜‡",attr:void 0,monType:"Reptile",atk:200,def:200},{name:"é­”èŒ",attr:void 0,monType:"Plant",atk:200,def:200},{name:"é—‡ãƒ»ã‚¨ãƒãƒ«ã‚®ãƒ¼",attr:void 0,monType:"Fiend",atk:200,def:200},{name:"ãƒ¬ãƒ¼ã‚¶ãƒ¼ç ²æ©Ÿç”²éŽ§",attr:void 0,monType:"Insect",atk:200,def:200},{name:"éŠ€ã®å¼“çŸ¢",attr:void 0,monType:"Fairy",atk:200,def:200},{name:"é›»æ’ƒéž­",attr:void 0,monType:"Thunder",atk:200,def:200},{name:"ãƒ‰ãƒ©ã‚´ãƒ³ã®ç§˜å®",attr:void 0,monType:"Dragon",atk:200,def:200},{name:"ãƒ•ã‚©ãƒ­ãƒ¼ãƒ»ã‚¦ã‚£ãƒ³ãƒ‰",attr:void 0,monType:"WingedBeast",atk:200,def:200},{name:"é­”æ€§ã®æœˆ",attr:void 0,monType:"BeastWarrior",atk:200,def:200},{name:"ã‚¨ãƒ«ãƒ•ã®å…‰",attr:"Light",monType:void 0,atk:400,def:-200},{name:"è¦šé†’",attr:"Earth",monType:void 0,atk:400,def:-200},{name:"ç¼ç†±ã®æ§",attr:"Fire",monType:void 0,atk:400,def:-200},{name:"çªé¢¨ã®æ‰‡",attr:"Wind",monType:void 0,atk:400,def:-200},{name:"ã¯ãŒã­ã®ç”²ç¾…",attr:"Water",monType:void 0,atk:400,def:-200},{name:"é—‡ã®ç ´ç¥žå‰£",attr:"Dark",monType:void 0,atk:400,def:-200},{name:"ç«å™¨ä»˜æ©Ÿç”²éŽ§",attr:void 0,monType:"Insect",atk:700,def:0},{name:"ã‚µãƒ©ãƒžãƒ³ãƒ‰ãƒ©",attr:"Fire",monType:void 0,atk:700,def:0},{name:"ã‚·ãƒ£ã‚¤ãƒ³ãƒ»ã‚­ãƒ£ãƒƒã‚¹ãƒ«",attr:"Light",monType:void 0,atk:700,def:0}].map(e=>({name:e.name,actions:[jt(t=>(!e.attr||t.attr.includes(e.attr))&&(!e.monType||t.types.includes(e.monType))),E],continuousEffects:[ka(e.name,"Spell",t=>t.info.equipedBy?[t.info.equipedBy]:[],t=>{const a=[];return e.atk!==0&&a.push(["attack",e.atk]),e.def!==0&&a.push(["defense",e.def]),a.map(([i,r])=>I.createContinuous("ç™ºå‹•",n=>n.isSpawnedBy.isOnFieldStrictly&&n.isSpawnedBy.face==="FaceUp",t,(n,s)=>s.isOnFieldStrictly&&s.face==="FaceUp"&&(!e.monType||s.types.includes(e.monType))&&(!e.attr||s.attr.includes(e.attr)),i,"wip","Addition",(n,s,l)=>n.isEffective?l+r:l))})]}))}const Cs=Object.freeze(Object.defineProperty({__proto__:null,default:yp},Symbol.toStringTag,{value:"Module"}));function*vp(){yield{name:"ãƒã‚­ãƒ³ãƒ¬ãƒ¼ã‚¹",actions:[lt,E,{title:"â‘¡åŠ¹æžœç™ºå‹•",isMandatory:!1,playType:"IgnitionEffect",spellSpeed:"Normal",executableCells:["FieldSpellZone"],executablePeriods:["main1","main2"],executableDuelistTypes:Qt,executableFaces:["FaceUp"],isOnlyNTimesPerTurnIfFaceup:1,canPayCosts:e=>e.activator.lp>=1e3,canExecute:e=>e.action.entity.face==="FaceUp",payCosts:(e,t)=>ea(e,t,1e3),prepare:async(e,t,a)=>{let i=[{seq:0,text:"â—ãƒ‡ãƒƒã‚­ã‹ã‚‰ï¼‘æžšãƒ‰ãƒ­ãƒ¼ã™ã‚‹ã€‚",tags:["Draw"]},{seq:1,text:"â—ã“ã®ã‚«ãƒ¼ãƒ‰ã‚’ç ´å£Šã™ã‚‹ã€‚",tags:e.action.calcChainBlockTagsForDestroy(e.activator,[e.action.entity])},{seq:2,text:"â—ç›¸æ‰‹ã¯1000LPå›žå¾©ã™ã‚‹ã€‚",tags:[]}];e.activator.getDeckCell().cardEntities.length||(i=i.filter(n=>n.seq));const r=await e.activator.waitSelectText(i,"ä½¿ç”¨ã™ã‚‹åŠ¹æžœã‚’é¸æŠž",a);if(r!==void 0)return e.data=r.seq,{selectedEntities:[],chainBlockTags:r.tags,nextChainBlockFilter:(n,s)=>!s.isWithChainBlock}},execute:async e=>{if(e.data===0)await e.activator.draw(1,e.action.entity,e.activator);else if(e.data===1)await S.tryDestroy([e.action.entity],e);else if(e.data===2)e.activator.getOpponentPlayer().heal(1e3,e.action.entity);else throw new P("IlligalActionData",e);return!0},settle:async()=>!0}],continuousEffects:[Ru("â‘ ãƒ€ãƒ¡ãƒ¼ã‚¸ç„¡åŠ¹","Spell",e=>[e.controller,e.controller.getOpponentPlayer()].map(t=>t.entity),e=>[new ls({title:"â‘ ãƒ€ãƒ¡ãƒ¼ã‚¸ç„¡åŠ¹",validateAlive:()=>!0,isContinuous:!0,isSpawnedBy:e,actionAttr:{},isApplicableTo:()=>!0,calcType:"zero_typeA",filter:(t,a,i,r)=>t.isSpawnedBy.cell.cellType!=="FieldSpellZone"?{}:r.lp>=r.getOpponentPlayer().lp?{}:(i.writeInfoLog(`${r.profile.name}ã¯ãƒã‚­ãƒ³ãƒ¬ãƒ¼ã‚¹ã®åŠ¹æžœã§ãƒ€ãƒ¡ãƒ¼ã‚¸ã‚’å—ã‘ãªã„ã€‚`),{zero_typeA:!0})})])]}}const bs=Object.freeze(Object.defineProperty({__proto__:null,default:vp},Symbol.toStringTag,{value:"Module"}));function*mp(){yield*[{name:"è‰åŽŸ",up:["Warrior","BeastWarrior"],down:[]},{name:"æ£®",up:["Insect","Plant","Beast","BeastWarrior"],down:[]},{name:"å±±",up:["Dragon","WingedBeast","Thunder"],down:[]},{name:"è’é‡Ž",up:["Dinosaur","Zombie","Rock"],down:[]},{name:"æµ·",up:["Aqua","SeaSerpent","Fish"],down:["Machine","Pyro"]},{name:"é—‡",up:["Fiend","Spellcaster"],down:["Fairy"]}].map(e=>({name:e.name,actions:[lt,E],continuousEffects:[Ka("ç™ºå‹•","Spell",t=>["attack","defense"].flatMap(a=>["up","down"].map(i=>I.createContinuous("ç™ºå‹•",r=>r.isSpawnedBy.isOnFieldStrictly&&r.isSpawnedBy.face==="FaceUp",t,(r,n)=>n.isOnFieldStrictly&&n.face==="FaceUp"&&(n.status.monsterCategories??!1)&&e[i].union(n.types).length>0,a,"wip","Addition",(r,n,s)=>!r.isEffective||n.face==="FaceDown"?s:s+(i==="up"?200:-200)))))]})),yield*[{name:"ãƒãƒ¼ãƒ‹ãƒ³ã‚°ãƒ–ãƒ©ãƒƒãƒ‰",attr:"Fire"},{name:"ã‚¦ã‚©ãƒ¼ã‚¿ãƒ¼ãƒ¯ãƒ¼ãƒ«ãƒ‰",attr:"Water"},{name:"ã‚¬ã‚¤ã‚¢ãƒ‘ãƒ¯ãƒ¼",attr:"Earth"},{name:"ã‚·ãƒ£ã‚¤ãƒ³ã‚¹ãƒ‘ãƒ¼ã‚¯",attr:"Light"},{name:"ãƒ€ãƒ¼ã‚¯ã‚¾ãƒ¼ãƒ³",attr:"Dark"},{name:"ãƒ‡ã‚¶ãƒ¼ãƒˆã‚¹ãƒˆãƒ¼ãƒ ",attr:"Wind"}].map(e=>({name:e.name,actions:[lt,E],continuousEffects:[Ka("ç™ºå‹•","Spell",t=>["attack","defense"].flatMap(a=>I.createContinuous("ç™ºå‹•",i=>i.isSpawnedBy.isOnFieldStrictly&&i.isSpawnedBy.face==="FaceUp",t,(i,r)=>r.isOnFieldStrictly&&r.face==="FaceUp"&&r.attr.includes(e.attr),a,"wip","Addition",(i,r,n)=>!i.isEffective||r.face==="FaceDown"?n:n+(a==="attack"?500:-400))))]}))}const ws=Object.freeze(Object.defineProperty({__proto__:null,default:mp},Symbol.toStringTag,{value:"Module"}));function*_p(){const e=[{name:"ã‚«ãƒ«ãƒœãƒŠãƒ¼ãƒ©æˆ¦å£«",materialInfos:[{type:"Name",cardName:"ãƒžã‚°ãƒãƒƒãƒ„ï¼‘å·"},{type:"Name",cardName:"ãƒžã‚°ãƒãƒƒãƒ„ï¼’å·"}]},{name:"ã‚¯ãƒªãƒƒãƒãƒ¼",materialInfos:[{type:"Name",cardName:"ã‚¯ãƒªãƒƒã‚¿ãƒ¼"},{type:"Name",cardName:"é»’ãæ£®ã®ã‚¦ã‚£ãƒƒãƒ"}]},{name:"ã‚¹ã‚±ãƒ«ã‚´ãƒ³",materialInfos:[{type:"Name",cardName:"ãƒ¡ãƒ‡ãƒ¥ãƒ¼ã‚µã®äº¡éœŠ"},{type:"Name",cardName:"æš—é»’ã®ç«œçŽ‹"}]},{name:"ã‚¹ãƒãƒ¼ãƒ ã‚¸ãƒ£ã‚¤ãƒ­ã‚¤ãƒ‰",materialInfos:[{type:"Name",cardName:"ã‚¸ãƒ£ã‚¤ãƒ­ã‚¤ãƒ‰"},{type:"Name",cardName:"ã‚¹ãƒãƒ¼ãƒ ãƒ­ã‚¤ãƒ‰"}]},{name:"ãƒãƒ©ã«æ£²ã‚€æ‚ªéœŠ",materialInfos:[{type:"Name",cardName:"ã‚°ãƒ¬ãƒ ãƒªãƒ³"},{type:"Name",cardName:"ã‚¹ãƒãƒ¼ã‚¯ãƒ»ãƒ‘ãƒ¼ãƒ "}]},{name:"ãƒãƒ­ãƒƒã‚¯ã‚¹",materialInfos:[{type:"Name",cardName:"ã‚­ãƒ©ãƒ¼ãƒ‘ãƒ³ãƒ€"},{type:"Name",cardName:"ã‚¬ãƒ¼ã‚´ã‚¤ãƒ«"}]},{name:"ãƒ•ãƒ¥ãƒ¼ã‚¸ãƒ§ãƒ‹ã‚¹ãƒˆ",materialInfos:[{type:"Name",cardName:"ãƒ—ãƒãƒ†ãƒ³ã‚·"},{type:"Name",cardName:"ã‚¹ãƒªãƒ¼ãƒ”ã‚£"}]},{name:"ãƒ–ãƒ©ã‚­ã‚ªãƒ¬ã‚¤ãƒ‰ã‚¹",materialInfos:[{type:"Name",cardName:"äºŒé ­ã‚’æŒã¤ã‚­ãƒ³ã‚°ãƒ»ãƒ¬ãƒƒã‚¯ã‚¹"},{type:"Name",cardName:"å±ã‚’è²ªã‚‹ç«œ"}]},{name:"ãƒ—ãƒ©ã‚°ãƒ†ã‚£ã‚«ãƒ«",materialInfos:[{type:"Name",cardName:"ãƒˆãƒ©ã‚³ãƒ‰ãƒ³"},{type:"Name",cardName:"ãƒ•ãƒ¬ã‚¤ãƒ ãƒ»ãƒ´ã‚¡ã‚¤ãƒ‘ãƒ¼"}]},{name:"ãƒžãƒ–ãƒ©ã‚¹",materialInfos:[{type:"Name",cardName:"ã‚¿ã‚¤ãƒ›ãƒ¼ãƒ³"},{type:"Name",cardName:"é‚ªç‚Žã®ç¿¼"}]},{name:"ãƒŸãƒŽã‚±ãƒ³ã‚¿ã‚¦ãƒ­ã‚¹",materialInfos:[{type:"Name",cardName:"ãƒŸãƒŽã‚¿ã‚¦ãƒ«ã‚¹"},{type:"Name",cardName:"ã‚±ãƒ³ã‚¿ã‚¦ãƒ­ã‚¹"}]},{name:"æš—é»’ç«ç‚Žé¾",materialInfos:[{type:"Name",cardName:"ç«ç‚Žè‰"},{type:"Name",cardName:"ãƒ—ãƒãƒªãƒ¥ã‚¦"}]},{name:"ç‚Žã®é¨Žå£« ã‚­ãƒ©ãƒ¼",materialInfos:[{type:"Name",cardName:"ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ãƒ»ã‚¨ãƒƒã‚°"},{type:"Name",cardName:"ã‚¹ãƒ†ã‚£ãƒ³ã‚°"}]},{name:"ç‚Žã®å‰£å£«",materialInfos:[{type:"Name",cardName:"ç‚Žã‚’æ“ã‚‹è€…"},{type:"Name",cardName:"ä¼èª¬ã®å‰£è±ª ï¼­ï¼¡ï¼³ï¼¡ï¼«ï¼©"}]},{name:"éŸ³æ¥½å®¶ã®å¸çŽ‹",materialInfos:[{type:"Name",cardName:"é»’ãæ£®ã®ã‚¦ã‚£ãƒƒãƒ"},{type:"Name",cardName:"ãƒã‚¤ãƒ»ãƒ—ãƒªãƒ¼ã‚¹ãƒ†ã‚¹"}]},{name:"é‡‘è‰²ã®é­”è±¡",materialInfos:[{type:"Name",cardName:"ãƒ¡ãƒ‡ãƒ¥ãƒ¼ã‚µã®äº¡éœŠ"},{type:"Name",cardName:"ãƒ‰ãƒ©ã‚´ãƒ³ãƒ»ã‚¾ãƒ³ãƒ“"}]},{name:"ç´…é™½é³¥",materialInfos:[{type:"Name",cardName:"ã‚»ã‚¤ãƒ³ãƒˆãƒ»ãƒãƒ¼ãƒ‰"},{type:"Name",cardName:"ã‚¹ã‚«ã‚¤ãƒ»ãƒãƒ³ã‚¿ãƒ¼"}]},{name:"è½Ÿãã®å¤§æµ·è›‡",materialInfos:[{type:"Name",cardName:"é­”æ³•ã®ãƒ©ãƒ³ãƒ—"},{type:"Name",cardName:"ã²ã‚‡ã†ã™ã¹"}]},{name:"é»’ãäººé£Ÿã„é®«",materialInfos:[{type:"Name",cardName:"ã‚·ãƒ¼ã‚«ãƒ¼ãƒ¡ãƒ³"},{type:"Name",cardName:"ã‚­ãƒ©ãƒ¼ãƒ»ãƒ–ãƒ­ãƒƒãƒ–"},{type:"Name",cardName:"æµ·åŽŸã®å¥³æˆ¦å£«"}]},{name:"ç ‚ã®é­”å¥³",materialInfos:[{type:"Name",cardName:"å²©çŸ³ã®å·¨å…µ"},{type:"Name",cardName:"ã‚¨ãƒ³ã‚·ã‚§ãƒ³ãƒˆãƒ»ã‚¨ãƒ«ãƒ•"}]},{name:"è£ãã®é·¹",materialInfos:[{type:"Name",cardName:"å† ã‚’æˆ´ãè’¼ãç¿¼"},{type:"Name",cardName:"ã‚³ã‚±"}]},{name:"è£ãã‚’ä¸‹ã™å¥³å¸",materialInfos:[{type:"Name",cardName:"å¥³çŽ‹ã®å½±æ­¦è€…"},{type:"Name",cardName:"éŸ¿å¥³"}]},{name:"æœ±é›€",materialInfos:[{type:"Name",cardName:"èµ¤ãå‰£ã®ãƒ©ã‚¤ãƒ ãƒ³ãƒ‰ã‚¹"},{type:"Name",cardName:"ç‚Žã®é­”ç¥ž"}]},{name:"æ·±æµ·ã«æ½œã‚€ã‚µãƒ¡",materialInfos:[{type:"Name",cardName:"ç¥žé­š"},{type:"Name",cardName:"èˆŒé­š"}]},{name:"æ°´é™¸ä¸¡ç”¨ãƒã‚°ãƒ­ã‚¹",materialInfos:[{type:"Name",cardName:"é™¸æˆ¦åž‹ ãƒã‚°ãƒ­ã‚¹"},{type:"Name",cardName:"æµ·ã‚’å®ˆã‚‹æˆ¦å£«"}]},{name:"æˆ¦å ´ã®æ­»è£…æŸ",materialInfos:[{type:"Name",cardName:"éŸ³å¥³"},{type:"Name",cardName:"æ–¬é¦–ã®ç¾Žå¥³"}]},{name:"é­”è£…é¨Žå£«ãƒ‰ãƒ©ã‚´ãƒã‚¹",materialInfos:[{type:"Name",cardName:"ã‚¢ãƒ¼ãƒ¡ã‚¤ãƒ«"},{type:"Name",cardName:"ä¸€çœ¼ã®ç›¾ç«œ"}]},{name:"é­”å°Žé¨Žå£«ã‚®ãƒ«ãƒ†ã‚£ã‚¢",materialInfos:[{type:"Name",cardName:"å†¥ç•Œã®ç•ªäºº"},{type:"Name",cardName:"çŽ‹åº§ã®å®ˆè­·è€…"}]},{name:"é›·ç¥žã®æ€’ã‚Š",materialInfos:[{type:"Name",cardName:"ã‚¨ãƒ³ã‚¼ãƒ«ãƒ»ã‚¤ãƒ¤ãƒ¼ã‚º"},{type:"Name",cardName:"ãƒ¡ã‚¬ãƒ»ã‚µãƒ³ãƒ€ãƒ¼ãƒœãƒ¼ãƒ«"}]},{name:"ã‚«ã‚¤ã‚¶ãƒ¼ãƒ»ãƒ‰ãƒ©ã‚´ãƒ³",materialInfos:[{type:"Name",cardName:"ç ¦ã‚’å®ˆã‚‹ç¿¼ç«œ"},{type:"Name",cardName:"ãƒ•ã‚§ã‚¢ãƒªãƒ¼ãƒ»ãƒ‰ãƒ©ã‚´ãƒ³"}]},{name:"ã‚¹ã‚«ãƒ«ãƒ“ã‚·ãƒ§ãƒƒãƒ—",materialInfos:[{type:"Name",cardName:"æ‚ªé­”ã®çŸ¥æµ"},{type:"Name",cardName:"é­”å¤©è€"}]},{name:"ãƒ‡ãƒ“ãƒ«ãƒ»ãƒœãƒƒã‚¯ã‚¹",materialInfos:[{type:"Name",cardName:"ãƒžãƒ¼ãƒ€ãƒ¼ã‚µãƒ¼ã‚«ã‚¹"},{type:"Name",cardName:"ãƒ‰ãƒªãƒ¼ãƒ ãƒ»ãƒ”ã‚¨ãƒ­"}]},{name:"ãƒ’ãƒ¥ãƒ¼ãƒžãƒŽã‚¤ãƒ‰ãƒ»ãƒ‰ãƒ¬ã‚¤ã‚¯",materialInfos:[{type:"Name",cardName:"ãƒ¯ãƒ¼ãƒ ãƒ‰ãƒ¬ã‚¤ã‚¯"},{type:"Name",cardName:"ãƒ’ãƒ¥ãƒ¼ãƒžãƒŽã‚¤ãƒ‰ãƒ»ã‚¹ãƒ©ã‚¤ãƒ "}]},{name:"ãƒ–ãƒ©ãƒƒã‚¯ãƒ»ãƒ‡ãƒ¼ãƒ¢ãƒ³ã‚ºãƒ»ãƒ‰ãƒ©ã‚´ãƒ³",materialInfos:[{type:"Name",cardName:"ãƒ‡ãƒ¼ãƒ¢ãƒ³ã®å¬å–š"},{type:"Name",cardName:"çœŸç´…çœ¼ã®é»’ç«œ"}]},{name:"ãƒžã‚¹ã‚¿ãƒ¼ãƒ»ã‚ªãƒ–ãƒ»ï¼¯ï¼º",materialInfos:[{type:"Name",cardName:"ãƒ“ãƒƒã‚°ãƒ»ã‚³ã‚¢ãƒ©"},{type:"Name",cardName:"ãƒ‡ã‚¹ãƒ»ã‚«ãƒ³ã‚¬ãƒ«ãƒ¼"}]},{name:"ãƒ¡ãƒ†ã‚ªãƒ»ãƒ–ãƒ©ãƒƒã‚¯ãƒ»ãƒ‰ãƒ©ã‚´ãƒ³",materialInfos:[{type:"Name",cardName:"çœŸç´…çœ¼ã®é»’ç«œ"},{type:"Name",cardName:"ãƒ¡ãƒ†ã‚ªãƒ»ãƒ‰ãƒ©ã‚´ãƒ³"}]},{name:"å¬å–šç£ãƒ¡ã‚¬ãƒ©ãƒ‹ã‚«",materialInfos:[{type:"Name",cardName:"å¬å–šå¸«ã‚¢ãƒ¬ã‚¤ã‚¹ã‚¿ãƒ¼"},{type:"Name",cardName:"åœ°å±žæ€§ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼"}]},{name:"è–å¥³ã‚¸ãƒ£ãƒ³ãƒŒ",materialInfos:[{type:"Name",cardName:"æ…ˆæ‚²æ·±ãä¿®é“å¥³"},{type:"Name",cardName:"å •å¤©ä½¿ãƒžãƒªãƒ¼"}]},{name:"é’çœ¼ã®ç©¶æ¥µç«œ",materialInfos:[{type:"Name",cardName:"é’çœ¼ã®ç™½é¾"},{type:"Name",cardName:"é’çœ¼ã®ç™½é¾"},{type:"Name",cardName:"é’çœ¼ã®ç™½é¾"}]},{name:"åƒå¹´ç«œ",materialInfos:[{type:"Name",cardName:"æ™‚ã®é­”è¡“å¸«"},{type:"Name",cardName:"ãƒ™ãƒ“ãƒ¼ãƒ‰ãƒ©ã‚´ãƒ³"}]},{name:"åŒé ­ã®é›·é¾",materialInfos:[{type:"Name",cardName:"ã‚µãƒ³ãƒ€ãƒ¼ãƒ»ãƒ‰ãƒ©ã‚´ãƒ³"},{type:"Name",cardName:"ã‚µãƒ³ãƒ€ãƒ¼ãƒ»ãƒ‰ãƒ©ã‚´ãƒ³"}]},{name:"è¿·å®®ã®é­”æˆ¦è»Š",materialInfos:[{type:"Name",cardName:"ã‚®ã‚¬ãƒ†ãƒƒã‚¯ãƒ»ã‚¦ãƒ«ãƒ•"},{type:"Name",cardName:"ã‚­ãƒ£ãƒŽãƒ³ãƒ»ã‚½ãƒ«ã‚¸ãƒ£ãƒ¼"}]},{name:"ç«œé¨Žå£«ã‚¬ã‚¤ã‚¢",materialInfos:[{type:"Name",cardName:"æš—é»’é¨Žå£«ã‚¬ã‚¤ã‚¢"},{type:"Name",cardName:"ã‚«ãƒ¼ã‚¹ãƒ»ã‚ªãƒ–ãƒ»ãƒ‰ãƒ©ã‚´ãƒ³"}]},{name:"ã‚¢ã‚¯ã‚¢ãƒ»ãƒ‰ãƒ©ã‚´ãƒ³",materialInfos:[{type:"Name",cardName:"ãƒ•ã‚§ã‚¢ãƒªãƒ¼ãƒ»ãƒ‰ãƒ©ã‚´ãƒ³"},{type:"Name",cardName:"æµ·åŽŸã®å¥³æˆ¦å£«"}]},{name:"ã‚¢ãƒ³ãƒ‡ãƒƒãƒˆãƒ»ã‚¦ã‚©ãƒ¼ãƒªã‚¢ãƒ¼",materialInfos:[{type:"Name",cardName:"ãƒ¯ã‚¤ãƒˆ"},{type:"Name",cardName:"æ ¼é—˜æˆ¦å£«ã‚¢ãƒ«ãƒ†ã‚£ãƒ¡ãƒ¼ã‚¿ãƒ¼"}]},{name:"ã‚«ã‚ªã‚¹ãƒ»ã‚¦ã‚£ã‚¶ãƒ¼ãƒ‰",materialInfos:[{type:"Name",cardName:"ãƒ›ãƒ¼ãƒªãƒ¼ãƒ»ã‚¨ãƒ«ãƒ•"},{type:"Name",cardName:"é»’é­”æ—ã®ã‚«ãƒ¼ãƒ†ãƒ³"}]},{name:"ã‚¯ãƒ¯ã‚¬ãƒ¼ãƒ»ãƒ˜ãƒ©ã‚¯ãƒ¬ã‚¹",materialInfos:[{type:"Name",cardName:"ã‚¯ãƒ¯ã‚¬ã‚¿ãƒ»ã‚¢ãƒ«ãƒ•ã‚¡"},{type:"Name",cardName:"ãƒ˜ãƒ©ã‚¯ãƒ¬ã‚¹ãƒ»ãƒ“ãƒ¼ãƒˆãƒ«"}]},{name:"ã‚½ã‚¦ãƒ«ãƒ»ãƒãƒ³ã‚¿ãƒ¼",materialInfos:[{type:"Name",cardName:"ãƒ©ãƒ³ãƒ—ã®é­”äºº"},{type:"Name",cardName:"ç•°æ¬¡å…ƒã‹ã‚‰ã®ä¾µç•¥è€…"}]},{name:"ãƒ‡ã‚¹ãƒ»ãƒãƒ¼ãƒ‰",materialInfos:[{type:"Name",cardName:"ã‚¿ã‚¯ãƒ’"},{type:"Name",cardName:"é«‘é«ã®å¯ºé™¢"}]},{name:"ãƒ•ãƒ©ãƒ¯ãƒ¼ãƒ»ã‚¦ãƒ«ãƒ•",materialInfos:[{type:"Name",cardName:"ã‚·ãƒ«ãƒãƒ¼ãƒ»ãƒ•ã‚©ãƒ³ã‚°"},{type:"Name",cardName:"é­”ç•Œã®ã‚¤ãƒãƒ©"}]},{name:"ãƒ•ãƒ¬ã‚¤ãƒ ãƒ»ã‚´ãƒ¼ã‚¹ãƒˆ",materialInfos:[{type:"Name",cardName:"ãƒ¯ã‚¤ãƒˆ"},{type:"Name",cardName:"ãƒžã‚°ãƒžãƒ³"}]},{name:"ãƒžãƒªãƒ³ãƒ»ãƒ“ãƒ¼ã‚¹ãƒˆ",materialInfos:[{type:"Name",cardName:"æ°´ã®é­”å°Žå¸«"},{type:"Name",cardName:"ãƒ™ãƒ’ã‚´ãƒ³"}]},{name:"ãƒ¡ã‚«ãƒ»ã‚¶ã‚¦ãƒ«ã‚¹",materialInfos:[{type:"Name",cardName:"ãƒŸã‚¹ã‚¿ãƒ¼ãƒ»ãƒœãƒ³ãƒãƒ¼"},{type:"Name",cardName:"äºŒé ­ã‚’æŒã¤ã‚­ãƒ³ã‚°ãƒ»ãƒ¬ãƒƒã‚¯ã‚¹"}]},{name:"ãƒ¡ã‚¿ãƒ«ãƒ»ãƒ‰ãƒ©ã‚´ãƒ³",materialInfos:[{type:"Name",cardName:"é‹¼é‰„ã®å·¨ç¥žåƒ"},{type:"Name",cardName:"ãƒ¬ãƒƒã‚µãƒ¼ãƒ»ãƒ‰ãƒ©ã‚´ãƒ³"}]},{name:"ãƒ¬ã‚¢ãƒ»ãƒ•ã‚£ãƒƒã‚·ãƒ¥",materialInfos:[{type:"Name",cardName:"ãƒ•ãƒ¥ãƒ¼ã‚¸ãƒ§ãƒ‹ã‚¹ãƒˆ"},{type:"Name",cardName:"ææƒšã®äººé­š"}]},{name:"ç„¡ã®ç•¢ç«Ÿ ã‚ªãƒ¼ãƒ«ãƒ´ã‚§ã‚¤ãƒ³",materialInfos:[{type:"Filter",filter:t=>{var a;return((a=t.status.monsterCategories)==null?void 0:a.includes("Normal"))??!1}},{type:"Filter",filter:t=>{var a;return((a=t.status.monsterCategories)==null?void 0:a.includes("Normal"))??!1}}]},{name:"ãƒ†ã‚»ã‚¦ã‚¹ã®é­”æ£²ç‰©",materialInfos:[{type:"Filter",filter:t=>{var a;return((a=t.status.monsterCategories)==null?void 0:a.includes("Tuner"))??!1}},{type:"Filter",filter:t=>{var a;return((a=t.status.monsterCategories)==null?void 0:a.includes("Tuner"))??!1}}]},{name:"ã‚¸ã‚§ãƒ ãƒŠã‚¤ãƒˆãƒ»ã‚¸ãƒ«ã‚³ãƒ‹ã‚¢",materialInfos:[{type:"Filter",filter:t=>{var a;return((a=t.status.nameTags)==null?void 0:a.includes("ã‚¸ã‚§ãƒ ãƒŠã‚¤ãƒˆ"))??!1}},{type:"Filter",filter:t=>t.types.includes("Rock")??!1}]},{name:"ãƒ¡ã‚¿ãƒ«ãƒ•ã‚©ãƒ¼ã‚¼ãƒ»ã‚¢ãƒ€ãƒžãƒ³ãƒ†",materialInfos:[{type:"Filter",filter:t=>{var a;return((a=t.status.nameTags)==null?void 0:a.includes("ãƒ¡ã‚¿ãƒ«ãƒ•ã‚©ãƒ¼ã‚¼"))??!1}},{type:"Filter",filter:t=>(t.atk??9999)<=2500}]},{name:"ãƒ¡ã‚¿ãƒ«ãƒ•ã‚©ãƒ¼ã‚¼ãƒ»ã‚«ãƒ¼ãƒ‡ã‚£ãƒŠãƒ«",materialInfos:[{type:"Filter",filter:t=>{var a;return((a=t.status.nameTags)==null?void 0:a.includes("ãƒ¡ã‚¿ãƒ«ãƒ•ã‚©ãƒ¼ã‚¼"))??!1}},{type:"Filter",filter:t=>(t.atk??9999)<=3e3},{type:"Filter",filter:t=>(t.atk??9999)<=3e3}]}];for(const t of e)yield{name:t.name,actions:[],fusionMaterialInfos:t.materialInfos}}const Es=Object.freeze(Object.defineProperty({__proto__:null,default:_p},Symbol.toStringTag,{value:"Module"})),Sp=async(e,t,a=!1)=>{if(!e.action.entity.lvl)return;if(e.action.entity.lvl<5)return{};const i=e.activator.getAvailableMonsterZones();let r=e.activator.getMonstersOnField().filter(c=>c.canBeReleased(e.activator,e.action.entity,["AdvanceSummonRelease"],e.action));const n=e.activator.getExtraMonsterZones(),s=e.action.entity.lvl<7?1:2;n.length>=s&&(r=r.filter(c=>c.cell.cellType!=="ExtraMonsterZone"));const l=await e.activator.waitSelectEntities(r,s,c=>(a||c.length>0)&&(s<0||c.length===s)&&(i.length>0||c.some(d=>d.cell.cellType==="ExtraMonsterZone")),"ãƒªãƒªãƒ¼ã‚¹ã™ã‚‹ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã‚’é¸æŠž",a)??[];return l.length?(await S.releaseManyForTheSameReason(l,["Cost","AdvanceSummonRelease","Rule"],e.action.entity,e.activator),{summonMaterialInfos:l.map(c=>({material:c,cell:c.cell}))}):void 0},Tp=async e=>{var r;const t=["Rule","NormalSummon"];let a="NormalSummon";(r=e.costInfo.summonMaterialInfos)!=null&&r.length&&(a="AdvanceSummon",t.push("AdvanceSummon"));const i=e.dest?[e.dest]:e.activator.getAvailableMonsterZones();return Je(e,a,t,["Attack","Set"],i)},Je=async(e,t,a,i,r)=>{let n=e.dest?[e.dest]:r;return n||(n=e.activator.getMonsterZones(),e.action.entity.cell.cellType==="ExtraDeck"&&n.push(...e.activator.duel.field.getCells("ExtraMonsterZone"))),await e.activator.summon(t,a,e.action,e.action.entity,i,n,e.costInfo.summonMaterialInfos??[],!1),{selectedEntities:[]}},Ie=async e=>{var t,a;return e.action.entity.info.isRebornable=!((t=e.action.entity.origin.monsterCategories)!=null&&t.includes("RegularSpecialSummonOnly")),await e.action.entity.determine(),(a=e.costInfo.summonMaterialInfos)==null||a.map(i=>i.material).forEach(i=>i.onUsedAsMaterial(e,e.action.entity)),!0},Cp={title:"é€šå¸¸å¬å–š",isMandatory:!1,playType:"NormalSummon",spellSpeed:"Normal",executableCells:["Hand"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],canPayCosts:e=>{if(!e.action.entity.lvl)return!1;if(e.action.entity.lvl<5)return e.activator.getEnableSummonList(e.activator,"NormalSummon",["Rule"],e.action,[{monster:e.action.entity,posList:["Attack","Set"],cells:e.activator.getMonsterZones()}],[],!1).length>0;const t=e.activator.getMonstersOnField().filter(r=>r.canBeReleased(e.activator,e.action.entity,["AdvanceSummonRelease"],e.action)),a=e.action.entity.lvl<7?1:2;return t.length<a?!1:t.getAllOnOffPattern().filter(r=>r.length===a).some(r=>e.activator.getEnableSummonList(e.activator,"AdvanceSummon",["Rule","NormalSummon"],e.action,[{monster:e.action.entity,posList:["Attack","Set"],cells:e.activator.getMonsterZones()}],r.map(n=>({material:n,cell:n.cell})),!1).length)},meetsConditions:e=>e.activator.info.ruleNormalSummonCount<e.activator.info.maxRuleNormalSummonCount&&!!e.action.entity.lvl,getDests:e=>e.action.entity.lvl?e.action.entity.lvl>4?[]:e.activator.getEnableSummonList(e.activator,"NormalSummon",["Rule"],e.action,[{monster:e.action.entity,posList:["Attack","Set"],cells:e.activator.getMonsterZones()}],[],!1).flatMap(a=>a.cells).getDistinct():[],payCosts:Sp,prepare:Tp,execute:Ie,settle:async()=>!0},We=(e,t,a,i)=>{const r=e.activator.getMonsterZones();return e.action.entity.cell.cellType==="ExtraDeck"&&r.push(...e.activator.getAvailableExtraMonsterZones()),e.activator.getEnableSummonList(e.activator,"SpecialSummon",i,e.action,[{monster:e.action.entity,posList:t,cells:r}],a,!1).flatMap(s=>s.cells)},Q=(...e)=>We(...e).length>0,bp={title:"æ”»æ’ƒå®£è¨€",isMandatory:!1,playType:"DeclareAttack",spellSpeed:"Normal",executableCells:["MonsterZone","ExtraMonsterZone"],executablePeriods:["b1Battle","b2Battle"],executableDuelistTypes:["Controller"],hasToTargetCards:!0,getTargetableEntities:e=>e.action.entity.getAttackTargets(),canExecute:(e,t)=>!e.activator.isTurnPlayer||!e.action.entity.isMonster||!e.action.entity.status.canAttack||e.action.entity.info.attackDeclareCount>0||e.action.entity.battlePosition!=="Attack"?!1:e.action.getTargetableEntities(e,t).length>0,getDests:(e,t)=>e.action.getTargetableEntities(e,t).map(a=>a.cell),prepare:async(e,t)=>{var r,n;if(e.action.entity.info.attackDeclareCount>0||e.action.entity.battlePosition!=="Attack")return;const a=e.action.getTargetableEntities(e,t);if(a.length===0)throw new A("æ”»æ’ƒå¯¾è±¡ã®é¸æŠžè‚¢ãŒãªã„çŠ¶æ…‹ã§å®Ÿè¡Œã•ã‚ŒãŸã€‚",e);let i=a[0];for(;a.length!==1;){if((r=e.dest)!=null&&r.targetForAttack){i=e.dest.entities.find(o=>o.entityType==="Duelist")??((n=e.dest)==null?void 0:n.targetForAttack);break}if(e.activator.duelistType==="NPC"){let l=e.activator.selectAttackTargetForNPC(e.action.entity,e.action);l||(e.activator.duel.log.warn("NPCã®æ”»æ’ƒå¯¾è±¡é¸æŠžã«å¤±æ•—ã—ãŸãŸã‚ã€ãƒ©ãƒ³ãƒ€ãƒ ã«æ”»æ’ƒå¯¾è±¡ã‚’é¸æŠžã€‚"),l=a.randomPick());break}const s=await e.activator.waitSelectEntity(a,"æ”»æ’ƒå¯¾è±¡ã‚’é¸æŠžã€‚",!0);if(!s)return;i=s;break}return e.action.entity.field.duel.declareAttack(e.action.entity,i,!1),{selectedEntities:[i]}},execute:async()=>!0,settle:async()=>!0},wp={title:"æˆ¦é—˜",isMandatory:!1,playType:"Battle",spellSpeed:"Normal",executableCells:["MonsterZone","ExtraMonsterZone"],executablePeriods:["b1DDmgCalc","b2DDmgCalc"],executableDuelistTypes:["Controller"],hasToTargetCards:!0,canExecute:e=>!!e.activator.duel.targetForAttack&&e.activator.duel.attackingMonster===e.action.entity&&e.action.entity.isMonster,prepare:async e=>{if(e.activator.duel.attackingMonster!==e.action.entity)throw new A("canExecuteã®åˆ¤å®šãŒæ­£ã—ãè¡Œã‚ã‚Œãªã‹ã£ãŸ",e,e.activator.duel.attackingMonster,e.activator.duel.targetForAttack);if(!e.activator.duel.targetForAttack)throw new A("canExecuteã®åˆ¤å®šãŒæ­£ã—ãè¡Œã‚ã‚Œãªã‹ã£ãŸ",e,e.activator.duel.attackingMonster,e.activator.duel.targetForAttack);return{selectedEntities:[e.activator.duel.targetForAttack]}},execute:async()=>!0,settle:async()=>!0},ks=async e=>{if(!(e.action.entity.info.battlePotisionChangeCount>0||!e.activator.isTurnPlayer))return await e.action.entity.setBattlePosition(e.action.entity.battlePosition==="Attack"?"Defense":"Attack",["Rule"],e.action.entity,e.activator),e.action.entity.info.battlePotisionChangeCount++,{selectedEntities:[]}},Ep={title:"åè»¢å¬å–š",isMandatory:!1,playType:"FlipSummon",spellSpeed:"Normal",executableCells:["MonsterZone","ExtraMonsterZone"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],canExecute:e=>e.action.entity.info.battlePotisionChangeCount===0&&e.action.entity.info.attackDeclareCount===0&&e.activator.isTurnPlayer&&e.action.entity.face==="FaceDown"&&e.action.entity.isMonster,prepare:ks,execute:async e=>(await e.action.entity.determine(),!0),settle:async()=>!0},kp={title:"è¡¨ç¤ºå½¢å¼å¤‰æ›´",isMandatory:!1,playType:"ChangeBattlePosition",spellSpeed:"Normal",executableCells:["MonsterZone","ExtraMonsterZone"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],meetsConditions:e=>e.action.entity.info.battlePotisionChangeCount===0&&e.action.entity.info.attackDeclareCount===0&&e.action.entity.status.canBattlePositionChange,canExecute:e=>e.activator.isTurnPlayer&&e.action.entity.face==="FaceUp"&&e.action.entity.isOnFieldAsMonsterStrictly,prepare:ks,execute:async e=>(await e.action.entity.determine(),!0),settle:async()=>!0},ve=async(e,t,a=["Attack","Defense"])=>{if(e.action.entity.wasMovedAfter(e.isActivatedAt))return!1;const i=ma.flatMap(s=>e.costInfo[s]??[]).map(s=>({material:s.cost,cell:s.cell})),r=t&&t.slice(-1)[0]===e?e.dest:void 0;if(r&&await e.activator.summon("SpecialSummon",["Effect"],e.action,e.action.entity,a,[r],i,!1))return!0;const n=e.activator.getMonsterZones();return!!await e.activator.summon("SpecialSummon",["Effect"],e.action,e.action.entity,a,n,i,!1)},Ds=[bp,wp],Wt=[...Ds,kp,Ep],sn=[Cp,...Wt],Yi=(e,t,a,i,r,n,s,l,o,c,d)=>{const p={posList:o,cells:c},f={posList:[],cells:[]};return t!==s||!s.isMonster||!s.origin.monsterCategories?p:s.origin.monsterCategories.includes("NormalSummonOnly")?r.includes("NormalSummon")||r.includes("AdvanceSummon")?p:f:s.origin.monsterCategories.includes("SpecialSummon")?s.origin.monsterCategories.includes("FreeReborn")?r.includes("Effect")?p:f:s.isInTrashCell&&!s.origin.monsterCategories.includes("RegularSpecialSummonOnly")?s.info.isRebornable?p:f:r.union(cs).length?p:s.origin.monsterCategories.includes("RegularSpecialSummonOnly")?d?p:f:p:p},Ai={},Dp=e=>(Ai[e]||(Ai[e]={title:`æˆ¦é—˜ç ´å£Šè€æ€§(${e})`,playType:"ContinuousEffect",isMandatory:!0,executableCells:["MonsterZone"],executablePeriods:["b1DDmgCalc","b2DDmgCalc"],executableDuelistTypes:["Controller"],isOnlyNTimesPerTurnIfFaceup:e,isApplicableTo:(t,a,i)=>i.includes(t.entity)?a!=="Battle"?[]:[t.entity]:[],substitute:async(t,a,i)=>i.includes(t.entity)?a!=="Battle"?[]:t.entity.isEffective?(t.entity.controller.writeInfoLog(`${t.entity.toString()}ã¯ï¼‘ã‚¿ãƒ¼ãƒ³ã«ï¼‘åº¦ã ã‘æˆ¦é—˜ã§ã¯ç ´å£Šã•ã‚Œãªã„ã€‚`),[t.entity]):[]:[]}),Ai[e]),xa=e=>e.activator.canRelease([e.action.entity])&&e.action.entity.canBeReleased(e.activator,e.action.entity,["ReleaseAsCost"],e.action),Pa=async e=>{const t={cost:e.action.entity,cell:e.action.entity.cell};return await e.action.entity.release(["Cost"],e.action.entity,e.activator),{release:[t]}},xs=e=>({title:"ã‚·ãƒ³ã‚¯ãƒ­å¬å–š",isMandatory:!1,playType:"QuickEffect",spellSpeed:"Quick",executableCells:x,executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],isOnlyNTimesPerChain:1,meetsConditions:t=>!t.activator.isTurnPlayer,canExecute:t=>t.activator.getExtraDeck().cardEntities.filter(a=>{var i;return(i=a.status.monsterCategories)==null?void 0:i.includes("Synchro")}).flatMap(a=>a.actions).filter(a=>a.playType==="SpecialSummon").map(a=>({index:-1,chainNumber:void 0,action:a,activator:t.activator,targetChainBlock:void 0,isActivatedIn:a.entity.cell,costInfo:{},state:"unloaded",dest:void 0,ignoreCosts:!1})).some(a=>a.action.getEnableMaterialPatterns(a).some(i=>{const r=i.map(n=>n.material);return r.every(n=>n.controller===t.activator)&&r.every(n=>n.isOnFieldAsMonsterStrictly)&&r.includes(t.action.entity)})),prepare:m,execute:async t=>{if(t.activator!==t.action.entity.controller||t.activator.getMonstersOnField().filter(s=>s.lvl!==void 0).length<2)return!1;const a=t.activator.getExtraDeck().cardEntities.filter(s=>{var l;return(l=s.status.monsterCategories)==null?void 0:l.includes("Synchro")}).flatMap(s=>s.actions).filter(s=>s.playType==="SpecialSummon").map(s=>({index:-1,chainNumber:void 0,action:s,activator:t.activator,targetChainBlock:void 0,isActivatedIn:s.entity.cell,isActivatedAt:t.isActivatedAt,costInfo:{},state:"unloaded",dest:void 0,ignoreCosts:!1})).filter(s=>s.action.getEnableMaterialPatterns(s).some(l=>{const o=l.map(c=>c.material);return o.every(c=>c.controller===t.activator)&&o.every(c=>c.isOnFieldAsMonsterStrictly)&&o.includes(t.action.entity)})).map(s=>s.action.entity).getDistinct();if(!a.length)return!1;const i=await t.activator.waitSelectEntities(a,1,s=>s.length===1,"ã‚·ãƒ³ã‚¯ãƒ­å¬å–šã™ã‚‹ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã‚’é¸æŠžã€‚",!1)??[];if(!i.length)throw new P("UnexpectedSituation",t);const r=i[0].actions.find(s=>s.playType==="SpecialSummon");if(!r)throw new P("UnexpectedSituation",t);const n=r.getClone(s=>{const l=s.map(o=>o.material);return l.every(o=>o.controller===t.activator)&&l.every(o=>o.isOnFieldAsMonsterStrictly)&&l.includes(t.action.entity)});return t.nextActionInfo={action:n,originSeq:n.seq},!0},settle:async()=>!0,...e}),xp=Vt("ç›´æŽ¥æ”»æ’ƒ","Monster",e=>[e],e=>[new ee({title:"ç›´æŽ¥æ”»æ’ƒ",validateAlive:()=>!0,isContinuous:!0,isSpawnedBy:e,actionAttr:{},isApplicableTo:(t,a)=>t.isSpawnedBy===a,statusCalculator:()=>({canDirectAttack:!0})})]),Mi={title:"èžåˆç´ æä»£ç”¨",appliableCellTypes:["MonsterZone","ExtraMonsterZone","Hand","Graveyard "],appliableDuelPeriodKeys:ae,faceList:["FaceUp","FaceDown"],canStart:()=>!0,start:async e=>{const t=new ee({title:"èžåˆç´ æä»£ç”¨",validateAlive:()=>!0,isContinuous:!0,isSpawnedBy:e,actionAttr:{},isApplicableTo:()=>!0,statusCalculator:(a,i,r)=>(i.isSpawnedBy.isEffective&&(r.fusionSubstitute=!0),r)});return e.statusOperatorBundle.push(t),{targets:[e],seq:t.seq}},finish:async(e,t)=>{t.targets.forEach(a=>a.statusOperatorBundle.removeItem(t.seq))}},Pp=(e,t,a,i)=>{if(!e.action.entity.origin.link||e.action.entity.origin.link<a.length)return;let r=a.map(s=>({material:s,cell:s.cell,link:1}));if(e.action.entity.origin.link>a.length){if(a.every(o=>(o.origin.link??1)<2))return;const s=[r];a.filter(o=>(o.origin.link??1)>1).forEach(o=>{[...s].forEach(c=>{s.push([...c.filter(d=>d.material!==o),{material:o,cell:o.cell,link:o.origin.link??1}])})});const l=s.find(o=>o.reduce((c,d)=>c+d.link,0)===e.action.entity.origin.link);if(!l)return;r=l}if(!i(a)||!e.activator.getEnableSummonList(e.activator,"LinkSummon",["Rule","SpecialSummon"],e.action,[{monster:e.action.entity,posList:["Attack"],cells:t}],r,!1).length)return;if(e.activator.getAvailableExtraMonsterZones().length)return r;const n=e.activator.duel.field.getCells("ExtraMonsterZone").map(s=>s.cardEntities[0]).filter(s=>s);if(n.filter(s=>s.controller===e.activator).length&&n.filter(s=>s.controller===e.activator).length===a.filter(s=>s.cell.cellType==="ExtraMonsterZone").length||e.activator.getMonsterZones().flatMap(s=>s.linkArrowSources).some(s=>!a.includes(s))||e.activator.duel.field.canExtraLink(e.action.entity,r))return r};function*Ap(e,t=()=>!0){let a=[...e.activator.getMonstersOnField().filter(r=>r.battlePosition!=="Set"),...e.activator.getHandCell().entities.filter(r=>r.origin.kind==="Monster")];if(a.every(r=>!r.status.allowHandLink)&&(a=a.filter(r=>r.cell.isPlayFieldCell)),a.length<1)return;const i=[...e.activator.getMonsterZones(),...e.activator.duel.field.getAvailableExtraMonsterZones()];yield*a.getAllOnOffPattern().filter(r=>r.some(n=>n.status.allowHandLink)||r.every(n=>n.isOnFieldAsMonsterStrictly)).map(r=>Pp(e,i,r,t)??[]).filter(r=>r.length)}const Mp=async(e,t,a)=>{var o;const i=e.action.getEnableMaterialPatterns(e).toArray(),r=i.map(c=>({infos:c,materialSeqList:c.map(d=>d.material.seq).sort()}));let n=i[0].map(c=>c.material);if(i.length>1){const c=i.flatMap(p=>p.map(f=>f.material)).getDistinct(),d=await e.activator.waitSelectEntities(c,void 0,p=>{const f=p.map(h=>h.seq).sort();return r.some(h=>f.length===h.materialSeqList.length&&f.every((y,v)=>y===h.materialSeqList[v]))},"ãƒªãƒ³ã‚¯ç´ æã¨ã™ã‚‹ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã‚’é¸æŠž",a);if(console.log(d),!d)return;n=d}const s=n.map(c=>c.seq).sort(),l=(o=r.find(c=>s.length===c.materialSeqList.length&&s.every((d,p)=>d===c.materialSeqList[p])))==null?void 0:o.infos;if(!l)throw new P("UnexpectedSituation",e,n);return await S.sendManyToGraveyardForTheSameReason(n,["LinkMaterial","Cost","Rule","SpecialSummonMaterial"],e.action.entity,e.activator),{summonMaterialInfos:l}},Ze=(e=()=>!0)=>({title:"ãƒªãƒ³ã‚¯å¬å–š",isMandatory:!1,playType:"SpecialSummon",spellSpeed:"Normal",executableCells:["ExtraDeck"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],getEnableMaterialPatterns:t=>Ap(t,e),canPayCosts:t=>t.action.getEnableMaterialPatterns(t).some(a=>a.length),canExecute:t=>!t.ignoreCosts||t.activator.getAvailableExtraMonsterZones().length+t.activator.getAvailableMonsterZones().length>0,payCosts:Mp,prepare:t=>Je(t,"LinkSummon",["Rule","SpecialSummon","LinkSummon"],["Attack"]),execute:Ie,settle:async()=>!0});function*Fp(){yield*[{name:"ï¼¬ï¼¡ï¼®ãƒ•ã‚©ãƒªãƒ³ã‚¯ã‚¹",validator:e=>e.length===2},{name:"ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ã‚´ãƒ¼ã‚¹ãƒˆ",validator:e=>e.length===3},{name:"å¤©å¨ã®é¬¼ç¥ž",validator:e=>e.length>1&&e.some(t=>{var a;return(a=t.status.monsterCategories)==null?void 0:a.includes("Link")})},{name:"å¤©å¨ã®æ‹³åƒ§",validator:e=>e.every(t=>{var a,i;return((a=t.status.nameTags)==null?void 0:a.includes("å¤©å¨"))&&!((i=t.status.monsterCategories)!=null&&i.includes("Link"))})},{name:"é›»å½±ã®é¨Žå£«ã‚¬ã‚¤ã‚¢ã‚»ã‚¤ãƒãƒ¼",validator:e=>e.length>1}].map(e=>({name:e.name,actions:[Ze(e.validator)]}))}const Ps=Object.freeze(Object.defineProperty({__proto__:null,default:Fp},Symbol.toStringTag,{value:"Module"}));function*Op(){yield*["ã‚µã‚¤ãƒãƒ¼ãƒ»ãƒ‰ãƒ©ã‚´ãƒ³","å…­æ­¦è¡†ã®ã”éš å±…","ã‚¢ãƒ³ãƒŽã‚¦ãƒ³ãƒ»ã‚·ãƒ³ã‚¯ãƒ­ãƒ³"].map(e=>({name:e,actions:[{title:"ç‰¹æ®Šå¬å–š",isMandatory:!1,playType:"SpecialSummon",spellSpeed:"Normal",executableCells:["Hand"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],isOnlyNTimesPerDuel:e==="ã‚¢ãƒ³ãƒŽã‚¦ãƒ³ãƒ»ã‚·ãƒ³ã‚¯ãƒ­ãƒ³"?1:void 0,canExecute:t=>{const a=t.action.entity.field.getMonstersOnFieldStrictly();return a.length>0&&a.every(i=>i.controller!==t.activator)&&Q(t,T,[],["Rule"])},getDests:t=>We(t,T,[],["Rule"]),prepare:t=>Je(t,"SpecialSummon",["SpecialSummon","Rule"],T),execute:Ie,settle:async()=>!0}]})),yield{name:"ã‚¸ãƒ£ãƒ³ã‚¯ãƒ»ãƒ•ã‚©ã‚¢ãƒ¼ãƒ‰",actions:[{title:"ç‰¹æ®Šå¬å–š",isMandatory:!1,playType:"SpecialSummon",spellSpeed:"Normal",executableCells:["Hand"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],canExecute:e=>e.activator.getMonstersOnField().length===0&&Q(e,T,[],["Rule"]),getDests:e=>We(e,T,[],["Rule"]),prepare:e=>Je(e,"SpecialSummon",["SpecialSummon","Rule"],T),execute:Ie,settle:async()=>!0}]},yield{name:"ã‚¾ãƒ³ãƒ“ã‚­ãƒ£ãƒªã‚¢",actions:[{title:"â‘ è‡ªå·±å†ç”Ÿ",isMandatory:!1,playType:"IgnitionEffect",spellSpeed:"Normal",executableCells:["Graveyard"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],executableFaces:["FaceUp"],fixedTags:["SpecialSummonFromGraveyard"],canPayCosts:e=>e.activator.getHandCell().cardEntities.length>0,canExecute:e=>Q(e,T,[],["Effect"]),payCosts:async(e,t,a)=>{const i=e.activator.getHandCell().cardEntities,r=await e.activator.waitSelectEntity(i,"ãƒ‡ãƒƒã‚­ãƒˆãƒƒãƒ—ã«æˆ»ã™ã‚«ãƒ¼ãƒ‰ã‚’ä¸€æžšé¸æŠžã€‚",a);if(!r)throw new N(e);return await r.returnToDeck("Top",["Cost"],e.action.entity,e.activator),{returnToDeck:[{cost:r,cell:e.activator.getHandCell()}]}},prepare:m,execute:async e=>await ve(e)?(e.action.entity.statusOperatorBundle.push(new ee({title:"é™¤å¤–äºˆå®š",validateAlive:()=>!0,isContinuous:!1,isSpawnedBy:e.action.entity,actionAttr:e.action,isApplicableTo:(t,a)=>a.isOnFieldAsMonsterStrictly&&a.face==="FaceUp",statusCalculator:()=>({willBeBanished:!0})})),!0):!1,settle:async()=>!0}]},yield{name:"ã‚°ãƒ­ãƒ¼ã‚¢ãƒƒãƒ—ãƒ»ãƒãƒ«ãƒ–",actions:[{title:"â‘ è‡ªå·±å†ç”Ÿ",isMandatory:!1,playType:"IgnitionEffect",spellSpeed:"Normal",executableCells:["Graveyard"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],executableFaces:["FaceUp"],isOnlyNTimesPerDuel:1,fixedTags:["SpecialSummonFromGraveyard"],canPayCosts:e=>e.activator.getDeckCell().cardEntities.length>0,getDests:e=>We(e,T,[],["Effect"]),canExecute:e=>Q(e,T,[],["Effect"]),payCosts:async e=>{const t=e.activator.getDeckCell().cardEntities[0],a={cost:t,cell:t.cell};return await t.sendToGraveyard(["Cost"],e.action.entity,e.activator),{sendToGraveyard:[a]}},prepare:m,execute:e=>ve(e),settle:async()=>!0}]},yield{name:"ã‚¹ãƒãƒ¼ã‚¢",actions:[{title:"â‘ è‡ªå·±å†ç”Ÿ",isMandatory:!1,playType:"IgnitionEffect",spellSpeed:"Normal",executableCells:["Graveyard"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],executableFaces:["FaceUp"],isOnlyNTimesPerDuel:1,fixedTags:["SpecialSummonFromGraveyard"],canPayCosts:e=>e.activator.getGraveyard().cardEntities.filter(t=>t.types.includes("Plant")).filter(t=>t.kind==="Monster").filter(t=>(t.lvl??0)>0).filter(t=>t!==e.action.entity).some(t=>t.canBeBanished("BanishAsCost",e.activator,e.action.entity,e.action)),getDests:e=>We(e,T,[],["Effect"]),canExecute:e=>Q(e,T,[],["Effect"]),payCosts:async(e,t,a)=>{const i=e.activator.getGraveyard().cardEntities.filter(s=>s.types.includes("Plant")).filter(s=>s.kind==="Monster").filter(s=>(s.lvl??0)>0).filter(s=>s!==e.action.entity).filter(s=>s.canBeBanished("BanishAsCost",e.activator,e.action.entity,e.action)),r=await e.activator.waitSelectEntity(i,"ã‚³ã‚¹ãƒˆã¨ã—ã¦é™¤å¤–ã™ã‚‹ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã‚’é¸æŠžã€‚",a);if(!r)return;const n={cost:r,cell:r.cell};return await r.banish(["Cost"],e.action.entity,e.activator),{banish:[n]}},prepare:m,execute:async e=>{var r;const t=(r=e.costInfo.banish)==null?void 0:r[0];if(!t)throw new P("IllegalActionCost",e);const a=t.cost.lvl??0,i=await ve(e);return i?(e.action.entity.numericOprsBundle.push(I.createLingeringAddition("ãƒ¬ãƒ™ãƒ«ä¸Šæ˜‡",n=>n.isSpawnedBy.isEffective,e.action.entity,e.action,"level",(n,s,l)=>l+a)),i):!1},settle:async()=>!0}]},yield{name:"çµ‚æœ«ã®é¨Žå£«",actions:[{title:"â‘ å¢“åœ°é€ã‚Š",isMandatory:!1,playType:"TriggerEffect",spellSpeed:"Normal",executableCells:["MonsterZone"],executablePeriods:[...C,...M],executableDuelistTypes:["Controller"],triggerPattern:{triggerType:"Arrival",arrivalReasons:["NormalSummon","SpecialSummon","FlipSummon"]},canExecute:e=>e.activator.getDeckCell().cardEntities.some(t=>t.attr.includes("Dark")),prepare:async e=>{const t=["SendToGraveyardFromDeck"];return e.action.entity.moveLog.latestRecord.movedAs.includes("NormalSummon")?t.push("IfNormarlSummonSucceed"):e.action.entity.moveLog.latestRecord.movedAs.includes("SpecialSummon")&&t.push("IfSpecialSummonSucceed"),{selectedEntities:[],chainBlockTags:t}},execute:async e=>{const t=e.activator.getDeckCell().cardEntities.filter(i=>i.attr.includes("Dark"));if(t.length===0)return!1;const a=await e.activator.waitSelectEntity(t,"å¢“åœ°ã«é€ã‚‹ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã‚’é¸æŠž",!1);if(!a)throw new N(e);return await a.sendToGraveyard(["Effect"],e.action.entity,e.activator),e.activator.getDeckCell().shuffle(),!0},settle:async()=>!0}]},yield{name:"ãƒžã‚¹ãƒžãƒ†ã‚£ã‚·ãƒ£ãƒ³",actions:[{title:"â‘ å¢“åœ°é€ã‚Š",isMandatory:!1,playType:"TriggerEffect",spellSpeed:"Normal",executableCells:["MonsterZone"],executablePeriods:[...C,...M],executableDuelistTypes:["Controller"],triggerPattern:{triggerType:"Arrival",arrivalReasons:["NormalSummon"]},fixedTags:["IfNormarlSummonSucceed","SendToGraveyardFromDeck"],canExecute:e=>e.activator.getDeckCell().cardEntities.some(t=>t.lvl&&t.lvl<5),prepare:m,execute:async e=>{const t=e.activator.getDeckCell().cardEntities.filter(i=>i.lvl&&i.lvl<5);if(t.length===0)return!1;const a=await e.activator.waitSelectEntity(t,"å¢“åœ°ã«é€ã‚‹ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã‚’é¸æŠž",!1);if(!a)throw new N(e);return await a.sendToGraveyard(["Effect"],e.action.entity,e.activator),e.activator.getDeckCell().shuffle(),!0},settle:async()=>!0},{title:"â‘¡ãƒ‰ãƒ­ãƒ¼",isMandatory:!1,playType:"TriggerEffect",spellSpeed:"Normal",executableCells:["Graveyard"],executablePeriods:[...C,...M],executableDuelistTypes:["Controller"],triggerPattern:{triggerType:"Departure",needsByBattle:!0,needsByDestory:!0},fixedTags:["Draw"],canExecute:e=>e.activator.getDeckCell().cardEntities.length>0&&e.activator.canDraw,prepare:m,execute:async e=>(await e.activator.draw(1,e.action.entity,e.activator),!0),settle:async()=>!0}]},yield{name:"ä¼èª¬ã®ç™½çŸ³",actions:[{title:"â‘ ã‚µãƒ¼ãƒ",isMandatory:!0,playType:"TriggerEffect",spellSpeed:"Normal",executableCells:["Graveyard"],executablePeriods:ae,executableDuelistTypes:["Controller"],triggerPattern:{triggerType:"Departure"},fixedTags:["SearchFromDeck"],canExecute:e=>e.activator.getDeckCell().cardEntities.some(t=>t.nm==="é’çœ¼ã®ç™½é¾")&&e.activator.canAddToHandFromDeck,prepare:m,execute:async e=>{const t=e.activator.getDeckCell().cardEntities.find(a=>a.nm==="é’çœ¼ã®ç™½é¾");return t?(await t.addToHand(["Effect"],e.action.entity,e.activator),e.activator.getDeckCell().shuffle(),!0):!1},settle:async()=>!0}]};for(const e of[{name:"ç°æµã†ã‚‰ã‚‰",chainBlockTags:["Draw","SearchFromDeck","SendToGraveyardFromDeck","SpecialSummonFromDeck"]},{name:"å±‹æ•·ã‚ã‚‰ã—",chainBlockTags:["BanishFromGraveyard","SpecialSummonFromGraveyard","AddToHandFromGraveyard"]}])yield{name:e.name,actions:[{title:"â‘ ç„¡åŠ¹åŒ–",isMandatory:!1,playType:"QuickEffect",spellSpeed:"Quick",executableCells:["Hand"],executablePeriods:C,executableDuelistTypes:["Controller"],isOnlyNTimesPerTurn:1,negatePreviousBlock:!0,fixedTags:["NegateCardEffect"],canPayCosts:t=>t.activator.canDiscard([t.action.entity]),canExecute:t=>(t.targetChainBlock&&t.targetChainBlock.chainBlockTags.union(e.chainBlockTags).length>0)??!1,payCosts:async t=>(await t.action.entity.discard(["Cost"],t.action.entity,t.activator),{sendToGraveyard:[{cost:t.action.entity,cell:t.activator.getHandCell()}]}),prepare:m,execute:async(t,a)=>{const i=a[t.index-1];return i.isNegatedEffectBy=t.action,!0},settle:async()=>!0}]};for(const e of["ç¿»å¼„ã™ã‚‹ã‚¨ãƒ«ãƒ•ã®å‰£å£«","ãƒ­ãƒ¼ãƒ‰ãƒ©ãƒ³ãƒŠãƒ¼","æ°·çµç•Œã®ä¿®é¨“è€…"])yield{name:e,actions:[],continuousEffects:[Ea("â‘ æˆ¦é—˜ç ´å£Šè€æ€§","Monster",t=>[t],t=>[we.createContinuous("â‘ æˆ¦é—˜ç ´å£Šè€æ€§",()=>!0,t,()=>!0,["BattleDestroy"],(a,i,r)=>!t.isEffective||(r.atk??0)<1900?!0:(t.duel.log.info(`${t.toString()}ã¯æ”»æ’ƒåŠ›1900ä»¥ä¸Šã®ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã¨ã®æˆ¦é—˜ã§ã¯ç ´å£Šã•ã‚Œãªã„ã€‚`,t.controller),!1))])]}}const As=Object.freeze(Object.defineProperty({__proto__:null,default:Op},Symbol.toStringTag,{value:"Module"})),Np=(e,t,a,i,r,n)=>{if(!e.action.entity.origin.level||i.some(c=>!c.lvl)||i.map(c=>c.lvl??0).reduce((c,d)=>c+d,0)!==e.action.entity.origin.level)return;const s=i.filter(c=>{var d;return(d=c.status.monsterCategories)==null?void 0:d.some(p=>p==="Tuner")}),l=i.filter(c=>{var d;return(d=c.status.monsterCategories)==null?void 0:d.every(p=>p!=="Tuner")});if(!r(s)||!n(l))return;const o=[...s.map(c=>({material:c,cell:c.cell,isAsTuner:!0})),...l.map(c=>({material:c,cell:c.cell,isAsTuner:!1}))];if(e.activator.getEnableSummonList(e.activator,"SynchroSummon",["Rule","SpecialSummon"],e.action,[{monster:e.action.entity,posList:t,cells:a}],o,!1).length)return o};function*Bp(e,t=i=>i.length===1,a=i=>i.length>0){let i=[...e.activator.getMonstersOnField().filter(s=>s.battlePosition!=="Set"),...e.activator.getHandCell().cardEntities.filter(s=>s.origin.kind==="Monster")];if(i.every(s=>!s.status.allowHandSynchro)&&(i=i.filter(s=>s.cell.isPlayFieldCell)),i.length<2)return;const r=[...e.activator.getMonsterZones(),...e.activator.duel.field.getCells("ExtraMonsterZone")],n=["Attack","Defense"];yield*i.getAllOnOffPattern().filter(s=>s.some(l=>l.status.allowHandSynchro)||s.every(l=>l.isOnFieldAsMonsterStrictly)).map(s=>Np(e,n,r,s,t,a)??[]).filter(s=>s.length)}const Lp=async(e,t,a)=>{var o;const i=e.action.getEnableMaterialPatterns(e).toArray(),r=i.map(c=>({infos:c,materialSeqList:c.map(d=>d.material.seq).sort()}));let n=i[0].map(c=>c.material);if(i.length>1){const c=i.flatMap(p=>p.map(f=>f.material)).getDistinct(),d=await e.activator.waitSelectEntities(c,void 0,p=>{const f=p.map(h=>h.seq).sort();return r.some(h=>f.length===h.materialSeqList.length&&f.every((y,v)=>y===h.materialSeqList[v]))},"ã‚·ãƒ³ã‚¯ãƒ­ç´ æã¨ã™ã‚‹ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã‚’é¸æŠž",a);if(!d)return;n=d}const s=n.map(c=>c.seq).sort(),l=(o=r.find(c=>s.length===c.materialSeqList.length&&s.every((d,p)=>d===c.materialSeqList[p])))==null?void 0:o.infos;if(!l)throw new P("UnexpectedSituation",e,n);return await S.sendManyToGraveyardForTheSameReason(n,["SynchroMaterial","Cost","Rule","SpecialSummonMaterial"],e.action.entity,e.activator),{summonMaterialInfos:l}},be=(e=a=>a.length===1,t=a=>a.length>0)=>({title:"ã‚·ãƒ³ã‚¯ãƒ­å¬å–š",isMandatory:!1,playType:"SpecialSummon",spellSpeed:"Normal",executableCells:["ExtraDeck"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],getEnableMaterialPatterns:a=>Bp(a,e,t),canPayCosts:a=>a.action.getEnableMaterialPatterns(a).some(i=>i.length),canExecute:a=>!a.ignoreCosts||a.activator.getAvailableExtraMonsterZones().length+a.activator.getAvailableMonsterZones().length>0,payCosts:Lp,prepare:a=>Je(a,"SynchroSummon",["Rule","SpecialSummon","SynchroSummon"],["Attack","Defense"]),execute:Ie,settle:async()=>!0}),Le=class Le{constructor(t){u(this,"validator");u(this,"minQty");u(this,"maxQty");u(this,"getAllPatterns",t=>Array.from(t).getAllOnOffPattern(this.minQty,this.maxQty).filter(this.validator));u(this,"validatePattern",t=>t.length<=this.maxQty&&t.length>=this.minQty&&this.validator(t));if(t.qty&&t.qty>0){this.minQty=t.qty,this.maxQty=t.qty,this.validator=a=>a.length===this.minQty;return}if(t.qtyList){const a=[...t.qtyList].getDistinct();if(!a.length){this.minQty=-1,this.maxQty=-1,this.validator=()=>!1;return}if(this.minQty=Vr(ss(...a),0),this.maxQty=Vr(...a),this.validator=i=>a.includes(i.length),!this.maxQty||this.maxQty<0)throw Error(`Illegal Definition. PickerDefinition:${t}`);return}if(!t.validator)throw Error(`Illegal Definition. PickerDefinition:${t}`);this.validator=t.validator,this.minQty=t.minQty??0,this.maxQty=t.maxQty??Number.MAX_SAFE_INTEGER}get qty(){return this.minQty===this.maxQty&&this.minQty>-1?this.minQty:void 0}};u(Le,"cash",{}),u(Le,"create",t=>{let a,i;if(mi(t))a=t,i={qty:a};else{if(i=t,i.validator)return new Le(i);if(i.qtyList&&i.qtyList.length>1)return new Le(i);if(i.minQty!==void 0&&i.minQty!==i.maxQty)return new Le(i);if(a=i.qty??i.minQty,i.qtyList&&!a&&(a=i.qtyList[0]),!a)throw Error(`Illegal Definition. PickerDefinition:${i}`)}return Le.cash[a]||(Le.cash[a]=new Le(i)),Le.cash[a]});let et=Le;const Si=(e,t,a,i)=>{const r=n=>a(n,e);return i.getAllPatterns(e.activator.getCells(...t).flatMap(n=>n.cardEntities).filter(r).filter(n=>n.canBeReleased(e.activator,e.action.entity,["ReleaseAsCost"],e.action)).filter(n=>e.activator.canRelease([n]))).some(()=>!0)},Ms=async(e,t,a,i,r,n)=>{const s=f=>r(f,e),l=e.activator.getCells(...i).flatMap(f=>f.cardEntities).filter(s).filter(f=>f.canBeReleased(e.activator,e.action.entity,["ReleaseAsCost"],e.action)).filter(f=>e.activator.canRelease([f])),o=[];for(const f of n.getAllPatterns(l))if(o.push(...f.filter(h=>!o.includes(h))),o.length===l.length)break;const c=n.qty;let d;if(o.length===c?d=o:d=await e.activator.waitSelectEntities(o,c,f=>n.validatePattern(f),"ã‚³ã‚¹ãƒˆã¨ã—ã¦ãƒªãƒªãƒ¼ã‚¹ã™ã‚‹ã‚«ãƒ¼ãƒ‰ã‚’é¸æŠžã€‚",a),!d)return;const p=d.map(f=>({cost:f,cell:f.cell}));return await S.releaseManyForTheSameReason(d,["Cost"],e.action.entity,e.activator),{release:p}},Fs=(e,t,...a)=>{const i=et.create(...a);return{canPayCosts:(...r)=>Si(r[0],e,t,i),payCosts:(...r)=>Ms(...r,e,t,i)}},Rp=()=>{const e=et.create(1),t=["Hand",...me];return{canPayCosts:(...a)=>Si(a[0],t,i=>a[0].action.entity===i,e),payCosts:(...a)=>Ms(...a,t,i=>a[0].action.entity===i,e)}},ln=e=>({title:"å°„å‡º",isMandatory:!1,playType:"IgnitionEffect",spellSpeed:"Normal",executableCells:x,executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],executableFaces:["FaceUp"],needsToPayRegularCost:!0,fixedTags:["DamageToOpponent"],canPayCosts:t=>Si(t,x,e.filter,et.create(1)),payCosts:async(t,a,i)=>{const r=await t.activator.waitSelectEntities(t.activator.getMonstersOnField().filter(e.filter).filter(s=>s.canBeReleased(t.activator,t.action.entity,["ReleaseAsCost"],t.action)),e.qty,s=>s.length===e.qty,"ãƒªãƒªãƒ¼ã‚¹ã™ã‚‹ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã‚’é¸æŠžã€‚",i);if(!r)return;t.data=e.calcDamage(t,r);const n=r.map(s=>({cost:s,cell:s.cell}));return await S.releaseManyForTheSameReason(r,["Cost","Release"],t.action.entity,t.activator),{release:n}},prepare:m,execute:async t=>{if(!mi(t.data))throw new P("IlligalActionData",t);return t.activator.getOpponentPlayer().effectDamage(t.data,t),!0},settle:async()=>!0,...e.otherActionProps});function*qp(){const e=[{name:"ã‚­ãƒ£ãƒŽãƒ³ãƒ»ã‚½ãƒ«ã‚¸ãƒ£ãƒ¼",qty:1,filter:()=>!0,calcDamage:()=>500,otherActionProps:{},otherActions:[]},{name:"ã‚¢ãƒžã‚¾ãƒã‚¹ã®å°„æ‰‹",qty:2,filter:()=>!0,calcDamage:()=>1200,otherActionProps:{},otherActions:[]},{name:"ãƒ¡ã‚¬ã‚­ãƒ£ãƒŽãƒ³ãƒ»ã‚½ãƒ«ã‚¸ãƒ£ãƒ¼",qty:2,filter:()=>!0,calcDamage:()=>1500,otherActionProps:{},otherActions:[]},{name:"ãƒ—ãƒªãƒ¼ã‚¹ãƒ†ã‚¹ãƒ»ã‚ªãƒ¼ãƒ ",qty:1,filter:t=>t.attr.includes("Dark"),calcDamage:()=>800,otherActionProps:{},otherActions:[]},{name:"å¯¾ç©ºæ”¾èŠ±",qty:1,filter:t=>t.types.includes("Insect"),calcDamage:()=>800,otherActionProps:{},otherActions:[]},{name:"äººæŠ•ã’ãƒˆãƒ­ãƒ¼ãƒ«",qty:1,filter:t=>{var a,i;return!!((a=t.status.monsterCategories)!=null&&a.includes("Normal")&&!((i=t.status.monsterCategories)!=null&&i.includes("Token")))},calcDamage:()=>800,otherActionProps:{},otherActions:[]},{name:"å¢“å®ˆã®å¤§ç­’æŒã¡",qty:1,filter:t=>{var a;return!!((a=t.status.nameTags)!=null&&a.includes("å¢“å®ˆ")&&t.nm!=="å¢“å®ˆã®å¤§ç­’æŒã¡")},calcDamage:()=>700,otherActionProps:{},otherActions:[]},{name:"ã‚«ã‚¿ãƒ‘ãƒ«ãƒˆãƒ»ã‚¦ã‚©ãƒªã‚¢ãƒ¼",qty:1,filter:t=>{var a;return!!((a=t.status.nameTags)!=null&&a.includes("ã‚¸ãƒ£ãƒ³ã‚¯")&&(t.origin.attack??0)>0)},calcDamage:(t,a)=>a.map(i=>i.origin.attack??0).reduce((i,r)=>i+r,0),otherActionProps:{isOnlyNTimesPerTurnIfFaceup:1},otherActions:[be()]},{name:"ãƒ€ãƒ¼ã‚¯ãƒ»ãƒ€ã‚¤ãƒ–ãƒ»ãƒœãƒ³ãƒãƒ¼",qty:1,filter:t=>!!(t.lvl&&t.lvl>0),calcDamage:(t,a)=>a.map(i=>i.lvl??0).reduce((i,r)=>i+r,0)*200,otherActionProps:{isOnlyNTimesPerTurn:1,executablePeriods:["main1"]},otherActions:[be()]}];for(const t of e)yield{name:t.name,actions:[ln(t),...t.otherActions]};yield{name:"ãƒˆã‚¥ãƒ¼ãƒ³ãƒ»ã‚­ãƒ£ãƒŽãƒ³ãƒ»ã‚½ãƒ«ã‚¸ãƒ£ãƒ¼",actions:[ln({qty:1,filter:()=>!0,calcDamage:()=>500,otherActionProps:{}})],immediatelyActions:[{title:"è‡ªå£Š",executableCells:["MonsterZone"],executablePeriods:ae.filter(t=>t!=="b1DBeforeDmgCalc"&&t!=="b2DBeforeDmgCalc"&&t!=="b1DDmgCalc"&&t!=="b2DDmgCalc"),execute:async(t,a,i)=>{a&&i&&i.status.name==="ãƒˆã‚¥ãƒ¼ãƒ³ãƒ»ãƒ¯ãƒ¼ãƒ«ãƒ‰"&&(a.moveLog.latestRecord.movedAs.every(r=>!r.endsWith("Destroy"))||(t.entity.controller.writeInfoLog(`${a.toString()}ãŒç ´å£Šã•ã‚ŒãŸãŸã‚ã€${t.entity.toString()}ã¯ç ´å£Šã•ã‚Œã‚‹ã€‚`),S.tryMarkForDestroy([t.entity],{activator:t.entity.controller,action:t,selectedEntities:[]}),t.entity.info.isDying=!0,t.entity.info.causeOfDeath=["Effect","Destroy"]))}}],continuousEffects:[Vt("å¬å–šé…”ã„","Monster",t=>[t],t=>[new ee({title:"å¬å–šé…”ã„",validateAlive:a=>{const i=a.isSpawnedBy.moveLog.latestArrivalRecord;return!i||!a.duel.clock.isSameTurn(i.movedAt)?!1:i.movedAs.union(["NormalSummon","FlipSummon","SpecialSummon"]).length>0},isContinuous:!0,isSpawnedBy:t,actionAttr:{},isApplicableTo:()=>!0,statusCalculator:()=>({canAttack:!1})})]),Vt("ç›´æŽ¥æ”»æ’ƒ","Monster",t=>[t],t=>[new ee({title:"ç›´æŽ¥æ”»æ’ƒ",validateAlive:()=>!0,isContinuous:!0,isSpawnedBy:t,actionAttr:{},isApplicableTo:()=>!0,statusCalculator:a=>a.controller.getEntiteisOnField().filter(i=>i.nm==="ãƒˆã‚¥ãƒ¼ãƒ³ãƒ»ãƒ¯ãƒ¼ãƒ«ãƒ‰").some(i=>i.face==="FaceUp")?a.controller.getOpponentPlayer().getMonstersOnField().filter(i=>{var r;return(r=i.status.monsterCategories)==null?void 0:r.includes("Toon")}).some(i=>i.face==="FaceUp")?{}:{canDirectAttack:!0}:{}})])]}}const Os=Object.freeze(Object.defineProperty({__proto__:null,default:qp},Symbol.toStringTag,{value:"Module"}));function*Hp(){yield*["ãƒ©ãƒ¼ã‚¸ãƒžã‚¦ã‚¹","ãƒ¬ã‚¤ãƒ³ãƒœãƒ¼ãƒ»ãƒ•ãƒ©ãƒ¯ãƒ¼","ãƒ¬ãƒƒã‚°ãƒ«","å¥³çŽ‹ã®å½±æ­¦è€…","äººé€ äººé–“ï¼—å·"].map(e=>({name:e,actions:[],continuousEffects:[xp]}))}const Ns=Object.freeze(Object.defineProperty({__proto__:null,default:Hp},Symbol.toStringTag,{value:"Module"}));function*Zp(){yield*[{name:"ã‚­ãƒ©ãƒ¼ãƒ»ãƒãƒ†ãƒˆ",filter:e=>e.attr.includes("Dark")&&(e.atk??9999)<=1500,qtyList:[1],posList:["Attack"],destroyTypes:["Effect"],executableCells:["Graveyard"]},{name:"ã‚­ãƒ©ãƒ¼ãƒ»ãƒˆãƒžãƒˆ",filter:e=>e.attr.includes("Dark")&&(e.atk??9999)<=1500,qtyList:[1],posList:["Attack"],destroyTypes:["Battle"],executableCells:["Graveyard"]},{name:"å·¨å¤§ãƒã‚ºãƒŸ",filter:e=>e.attr.includes("Earth")&&(e.atk??9999)<=1500,qtyList:[1],posList:["Attack"],destroyTypes:["Battle"],executableCells:["Graveyard"]},{name:"ã‚°ãƒªã‚ºãƒªãƒ¼ãƒžã‚¶ãƒ¼",filter:e=>e.attr.includes("Water")&&(e.atk??9999)<=1500,qtyList:[1],posList:["Attack"],destroyTypes:["Battle"],executableCells:["Graveyard"]},{name:"ã‚·ãƒ£ã‚¤ãƒ³ã‚¨ãƒ³ã‚¸ã‚§ãƒ«",filter:e=>e.attr.includes("Light")&&(e.atk??9999)<=1500,qtyList:[1],posList:["Attack"],destroyTypes:["Battle"],executableCells:["Graveyard"]},{name:"ãƒ‰ãƒ©ã‚´ãƒ³ãƒ•ãƒ©ã‚¤",filter:e=>e.attr.includes("Wind")&&(e.atk??9999)<=1500,qtyList:[1],posList:["Attack"],destroyTypes:["Battle"],executableCells:["Graveyard"]},{name:"ï¼µï¼¦ï¼¯ã‚¿ãƒ¼ãƒˆãƒ«",filter:e=>e.attr.includes("Fire")&&(e.atk??9999)<=1500,qtyList:[1],posList:["Attack"],destroyTypes:["Battle"],executableCells:["Graveyard"]},{name:"è’é‡Žã®å¥³æˆ¦å£«",filter:e=>e.attr.includes("Earth")&&e.types.includes("Warrior")&&(e.atk??9999)<=1500,qtyList:[1],posList:["Attack"],destroyTypes:["Battle"],executableCells:["Graveyard"]},{name:"ãƒªãƒˆãƒ«ãƒ»ãƒˆãƒ«ãƒ¼ãƒ‘ãƒ¼",filter:e=>e.types.includes("Warrior")&&(e.lvl??9999)<3,qtyList:[1],posList:["Set"],destroyTypes:["Battle"],executableCells:["Graveyard","Banished"]},{name:"ç ´é¢ç«œ",filter:e=>e.types.includes("Warrior")&&(e.def??9999)<=1500,qtyList:[1],posList:["Attack","Defense"],destroyTypes:["Battle"],executableCells:["Graveyard"]},{name:"å…±é³´è™«",filter:e=>e.types.includes("Insect")&&(e.atk??9999)<=1500,qtyList:[1],posList:["Attack","Defense"],destroyTypes:["Battle"],executableCells:["Graveyard"]},{name:"ãƒ”ãƒ©ãƒŸãƒƒãƒ‰ãƒ»ã‚¿ãƒ¼ãƒˆãƒ«",filter:e=>e.types.includes("Zombie")&&(e.def??9999)<=2e3,qtyList:[1],posList:["Attack","Defense"],destroyTypes:["Battle"],executableCells:["Graveyard"]},{name:"ãƒ¦ãƒ¼ãƒ•ã‚©ãƒ­ã‚¤ãƒ‰",filter:e=>e.types.includes("Machine")&&(e.atk??9999)<=1500,qtyList:[1],posList:["Attack"],destroyTypes:["Battle"],executableCells:["Graveyard"]},{name:"ãƒ˜ãƒ«ãƒ»ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£",filter:e=>e.types.includes("Fiend")&&(e.lvl??9999)===1,qtyList:[1],posList:["Attack","Defense"],destroyTypes:["Battle"],executableCells:["Graveyard"]},{name:"ã‚¬ã‚¹ã‚¿ãƒ»ã‚¤ã‚°ãƒ«",filter:e=>(e.status.nameTags??[]).includes("ã‚¬ã‚¹ã‚¿")&&(e.status.monsterCategories??[]).includes("Tuner"),qtyList:[1],posList:["Attack","Defense"],destroyTypes:["Battle"],executableCells:["Graveyard"]},{name:"å¹»å½±ã®é­”è¡“å£«",filter:e=>(e.status.nameTags??[]).includes("HERO")&&(e.atk??9999)<=1e3,qtyList:[1],posList:["Defense"],destroyTypes:["Battle"],executableCells:["Graveyard"]},{name:"ã‚¸ã‚§ãƒã‚¯ã‚¹ãƒ»ã‚µãƒ¼ãƒãƒ£ãƒ¼",filter:e=>(e.status.nameTags??[]).includes("ã‚¸ã‚§ãƒã‚¯ã‚¹")&&(e.atk??9999)<=1500,qtyList:[1],posList:["Attack"],destroyTypes:["Battle"],executableCells:["Graveyard"]},{name:"ç´«ç‚Žã®è¶³è»½",filter:e=>(e.status.nameTags??[]).includes("å…­æ­¦è¡†")&&(e.lvl??12)<=3,qtyList:[1],posList:["Attack","Defense"],destroyTypes:["Battle"],executableCells:["Graveyard"]},{name:"ã‚¹ãƒ¬ã‚¤ãƒ–ãƒ»ã‚¨ã‚¤ãƒ—",filter:e=>(e.status.nameTags??[]).includes("å‰£é—˜ç£")&&(e.lvl??12)<=4,qtyList:[1],posList:["Attack","Defense"],destroyTypes:["Battle"],executableCells:["Graveyard"]},{name:"ã‚¼ãƒ³ãƒžã‚¤ãƒãƒ‹ãƒ¼",filter:e=>(e.status.nameTags??[]).includes("ã‚¼ãƒ³ãƒžã‚¤")&&(e.lvl??12)<=4,qtyList:[1],posList:["Attack","Defense"],destroyTypes:["Battle"],executableCells:["Graveyard"]},{name:"ï¼¸ï¼¸ï¼ã‚»ã‚¤ãƒãƒ¼ ã‚¨ãƒžãƒ¼ã‚ºãƒ–ãƒ¬ã‚¤ãƒ‰",filter:e=>(e.status.nameTags??[]).includes("X-ã‚»ã‚¤ãƒãƒ¼")&&(e.lvl??12)<=4,qtyList:[1],posList:["Attack","Defense"],destroyTypes:["Battle"],executableCells:["Graveyard"]},{name:"è»éšŠç«œ",filter:e=>e.nm==="è»éšŠç«œ",qtyList:[1],posList:["Attack","Defense"],destroyTypes:["Battle"],executableCells:["Graveyard"]},{name:"ã‚¢ã‚µãƒ«ãƒˆãƒ»ã‚¬ãƒ³ãƒ‰ãƒƒã‚°",filter:e=>e.nm==="ã‚¢ã‚µãƒ«ãƒˆãƒ»ã‚¬ãƒ³ãƒ‰ãƒƒã‚°",qtyList:[1,2,3,4,5],posList:["Attack","Defense"],destroyTypes:["Battle"],executableCells:["Graveyard"]},{name:"ãƒã‚¤ã‚¨ãƒŠ",filter:e=>e.nm==="ãƒã‚¤ã‚¨ãƒŠ",qtyList:[1,2,3,4,5],posList:["Attack","Defense"],destroyTypes:["Battle"],executableCells:["Graveyard"]}].map(e=>({name:e.name,actions:[{title:"â‘ ãƒªã‚¯ãƒ«ãƒ¼ãƒˆ",isMandatory:!1,playType:"TriggerEffect",spellSpeed:"Normal",executableCells:e.executableCells,executablePeriods:e.destroyTypes.includes("Effect")?[...C,...M]:["b1DEnd","b2DEnd"],executableDuelistTypes:["Controller"],fixedTags:["SpecialSummonFromDeck"],meetsConditions:t=>t.action.entity.wasMovedAtPreviousChain&&t.action.entity.moveLog.latestRecord.movedAs.includes("Destroy")&&t.action.entity.moveLog.latestRecord.movedAs.union(e.destroyTypes).length>0,canExecute:t=>{const a=t.activator.getMonsterZones();return t.activator.getEnableSummonList(t.activator,"SpecialSummon",["Effect"],t.action,t.activator.getDeckCell().cardEntities.filter(e.filter).filter(r=>r.kind==="Monster").filter(r=>r.canBeTargetOfEffect(t)).map(r=>({monster:r,posList:e.posList,cells:a})),[],!1).length>0},prepare:m,execute:async t=>{const a=t.activator.getDeckCell().cardEntities.filter(e.filter),i=t.activator.getMonsterZones();return await t.activator.summonMany(t.activator,"SpecialSummon",["Effect"],t.action,a.map(n=>({monster:n,posList:e.posList,cells:i})),[],!1,e.qtyList.length>1?void 0:e.qtyList[0],n=>e.qtyList.includes(n.length),!1)?(t.activator.getDeckCell().shuffle(),!0):!1},settle:async()=>!0}]}))}const Bs=Object.freeze(Object.defineProperty({__proto__:null,default:Zp},Symbol.toStringTag,{value:"Module"}));function*Gp(){yield{name:"æ­»è€…è˜‡ç”Ÿ",actions:[{title:"ç™ºå‹•",isMandatory:!1,playType:"CardActivation",spellSpeed:"Normal",executableCells:["Hand","SpellAndTrapZone"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],fixedTags:["SpecialSummonFromGraveyard"],...Ye(t=>t.activator.duel.field.getCells("Graveyard").flatMap(a=>a.cardEntities).filter(a=>a.kind==="Monster").filter(a=>a.canBeTargetOfEffect(t))),settle:async()=>!0},E]};for(const t of[{name:"å¤§åµ",cellTypes:ga,isOnlyEnemies:!1},{name:"ãƒãƒ¼ãƒ”ã‚£ã®ç¾½æ ¹å¸š",cellTypes:ga,isOnlyEnemies:!0},{name:"ãƒ–ãƒ©ãƒƒã‚¯ãƒ»ãƒ›ãƒ¼ãƒ«",cellTypes:x,isOnlyEnemies:!1},{name:"ã‚µãƒ³ãƒ€ãƒ¼ãƒ»ãƒœãƒ«ãƒˆ",cellTypes:x,isOnlyEnemies:!0}])yield{name:t.name,actions:[{title:"ç™ºå‹•",isMandatory:!1,playType:"CardActivation",spellSpeed:"Normal",executableCells:["Hand","SpellAndTrapZone"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],fixedTags:["DestroyOnField"],canExecute:a=>{let i=a.action.entity.field.getCells(...t.cellTypes).flatMap(r=>r.cardEntities).filter(r=>r!==a.action.entity);return t.isOnlyEnemies&&(i=i.filter(r=>r.controller!==a.activator)),i.length>0},prepare:async a=>{let i=a.action.entity.field.getCells(...t.cellTypes).flatMap(r=>r.cardEntities).filter(r=>r!==a.action.entity);return t.isOnlyEnemies&&(i=i.filter(r=>r.controller!==a.activator)),{selectedEntities:[],chainBlockTags:a.action.calcChainBlockTagsForDestroy(a.activator,i)}},execute:async a=>{let i=a.action.entity.field.getCells(...t.cellTypes).flatMap(r=>r.cardEntities).filter(r=>r!==a.action.entity);return t.isOnlyEnemies&&(i=i.filter(r=>r.controller!==a.activator)),await S.tryDestroy(i,a),!0},settle:async()=>!0},E]};yield{name:"ãƒãƒªã‚±ãƒ¼ãƒ³",actions:[{title:"ç™ºå‹•",isMandatory:!1,playType:"CardActivation",spellSpeed:"Normal",executableCells:["Hand","SpellAndTrapZone"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],fixedTags:["BounceToHand"],canExecute:t=>t.action.entity.field.getCells("SpellAndTrapZone","FieldSpellZone").flatMap(a=>a.cardEntities).some(a=>a!==t.action.entity),prepare:m,execute:async(t,a)=>{const i=a.map(n=>n.action).filter(n=>n.playType==="CardActivation").map(n=>n.entity).filter(n=>n.face==="FaceUp"),r=t.action.entity.field.getCells("SpellAndTrapZone","FieldSpellZone").flatMap(n=>n.cardEntities).filter(n=>!i.includes(n));return await S.returnManyToHandForTheSameReason(r,["Effect"],t.action.entity,t.activator),!0},settle:async()=>!0},E]};const e={name:"ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒˆãƒ¼ã‚¯ãƒ³",actions:Wt,staticInfo:{name:"ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒˆãƒ¼ã‚¯ãƒ³",kind:"Monster",monsterCategories:["Normal","Token"],level:4,attack:2e3,defense:2e3,attributes:["Light"],types:["Cyberse"],wikiEncodedName:"%A5%BB%A5%AD%A5%E5%A5%EA%A5%C6%A5%A3%A5%C8%A1%BC%A5%AF%A5%F3"}};yield{name:"ãƒ¯ãƒ³ã‚¿ã‚¤ãƒ ãƒ»ãƒ‘ã‚¹ã‚³ãƒ¼ãƒ‰",actions:[{title:"ç™ºå‹•",isMandatory:!1,playType:"CardActivation",spellSpeed:"Normal",executableCells:["Hand","SpellAndTrapZone"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],isOnlyNTimesPerTurn:1,fixedTags:["SpecialSummon","SpecialSummonToken"],canExecute:t=>{const a=L.prepareTokenEntity(t.activator,t.action.entity,e),i=t.activator.getMonsterZones();return t.activator.getEnableSummonList(t.activator,"SpecialSummon",["Effect"],t.action,[{monster:a,posList:["Defense"],cells:i}],[],!1).length>0},prepare:m,execute:async t=>{const a=L.prepareTokenEntity(t.activator,t.action.entity,e),i=t.activator.getMonsterZones();return!!await t.activator.summon("SpecialSummon",["Effect"],t.action,a,["Defense"],i,[],!1)},settle:async()=>!0},E]},yield{name:"ãƒ¯ãƒ³ãƒ»ãƒ•ã‚©ãƒ¼ãƒ»ãƒ¯ãƒ³",actions:[{title:"ç™ºå‹•",isMandatory:!1,playType:"CardActivation",spellSpeed:"Normal",executableCells:["Hand","SpellAndTrapZone"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],fixedTags:["SpecialSummonFromDeck"],priorityForNPC:40,canPayCosts:t=>{if(t.activator.getDeckCell().cardEntities.every(a=>(a.lvl??12)>1)){if(t.activator.getHandCell().cardEntities.every(a=>(a.lvl??12)>1)||t.activator.getHandCell().cardEntities.filter(a=>a.kind==="Monster").length<2)return!1}else if(t.activator.getHandCell().cardEntities.filter(a=>a.kind==="Monster").length===0)return!1;return!0},canExecute:t=>{let a=[...t.activator.getDeckCell().cardEntities.filter(s=>(s.lvl??12)===1),...t.activator.getHandCell().cardEntities.filter(s=>(s.lvl??12)===1)];const i=t.activator.getHandCell().cardEntities;(i.length<2||!t.ignoreCosts)&&(a=a.filter(s=>!i.includes(s)));const r=t.activator.getMonsterZones();return t.activator.getEnableSummonList(t.activator,"SpecialSummon",["Effect"],t.action,a.map(s=>({monster:s,posList:T,cells:r})),[],!1).length>0},payCosts:async(t,a,i)=>{const r=[...t.activator.getDeckCell().cardEntities.filter(d=>(d.lvl??12)===1),...t.activator.getHandCell().cardEntities.filter(d=>(d.lvl??12)===1)],n=t.activator.getMonsterZones(),s=t.activator.getEnableSummonList(t.activator,"SpecialSummon",["Effect"],t.action,r.map(d=>({monster:d,posList:T,cells:n})),[],!1);let l=t.activator.getHandCell().cardEntities.filter(d=>d.kind==="Monster");s.length===1&&(l=l.filter(d=>!s.map(p=>p.monster).includes(d)));const o=await t.activator.waitSelectEntity(l,"å¢“åœ°ã¸é€ã‚‹ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã‚’é¸æŠž",i);if(!o)throw new N(t);const c={cost:o,cell:o.cell};return await o.sendToGraveyard(["Cost"],t.action.entity,t.activator),{sendToGraveyard:[c]}},prepare:m,execute:async t=>{const a=[...t.activator.getDeckCell().cardEntities.filter(n=>n.lvl===1),...t.activator.getHandCell().cardEntities.filter(n=>n.lvl===1)],i=t.activator.getMonsterZones();return await t.activator.summonOne(t.activator,"SpecialSummon",["Effect"],t.action,a.map(n=>({monster:n,posList:T,cells:i})),[],!1,!1)?(t.activator.getDeckCell().shuffle(),!0):!1},settle:async()=>!0},E]},yield{name:"å°å°ã®é»„é‡‘æ«ƒ",actions:[{title:"ç™ºå‹•",isMandatory:!1,playType:"CardActivation",spellSpeed:"Normal",executableCells:["Hand","SpellAndTrapZone"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],fixedTags:["BanishFromDeck"],canExecute:t=>t.activator.getDeckCell().cardEntities.some(a=>t.activator.canTryBanish(a,"BanishAsEffect",t.action)),prepare:m,execute:async t=>{const a=t.activator.getDeckCell().cardEntities.filter(n=>t.activator.canTryBanish(n,"BanishAsEffect",t.action)),i=await t.activator.waitSelectEntity(a,"é™¤å¤–ã™ã‚‹ã‚«ãƒ¼ãƒ‰ã‚’é¸æŠžã€‚",!1);if(!i)throw new N(t);return(await S.tryBanish("BanishAsEffect",[i],t)).forEach(n=>n.counterHolder.removeAll("GoldSarcophagus")),!0},settle:async()=>!0},{title:"å›žåŽã‚«ã‚¦ãƒ³ãƒˆé€²è¡Œ",playType:"SystemPeriodAction",spellSpeed:"Normal",executableCells:Ke,executablePeriods:["stanby"],executableDuelistTypes:Qt,isMandatory:!0,canExecute:t=>t.activator.isTurnPlayer&&t.action.entity.field.getCells("Banished").flatMap(a=>a.cardEntities).filter(a=>a.moveLog.latestRecord.movedBy&&t.action.entity.isSame(a.moveLog.latestRecord.movedBy)).some(a=>a.moveLog.latestRecord.actionOwner===t.activator),prepare:m,execute:async t=>(console.log(t.action.entity.toString()),t.action.entity.field.getCells("Banished").flatMap(a=>a.cardEntities).filter(a=>a.moveLog.latestRecord.movedBy&&t.action.entity.isSame(a.moveLog.latestRecord.movedBy)).filter(a=>a.moveLog.latestRecord.actionOwner===t.activator).forEach(a=>{a.counterHolder.add("GoldSarcophagus",1,t.action.entity);const i=a.counterHolder.getQty("GoldSarcophagus",t.action.entity);i<3&&t.activator.duel.log.info(`${a.toString()}ã®ã‚¿ãƒ¼ãƒ³ã‚«ã‚¦ãƒ³ãƒˆï¼š${i-1}â‡’${i}`)}),!0),settle:async()=>!0},{title:"å›žåŽ",isMandatory:!0,playType:"LingeringEffect",spellSpeed:"Normal",executableCells:Ke,executablePeriods:["stanby"],executableDuelistTypes:Qt,canExecute:t=>t.activator.isTurnPlayer&&t.action.entity.field.getCells("Banished").flatMap(a=>a.cardEntities).filter(a=>a.moveLog.latestRecord.movedBy&&t.action.entity.isSame(a.moveLog.latestRecord.movedBy)).filter(a=>a.moveLog.latestRecord.actionOwner===t.activator).some(a=>a.counterHolder.getQty("GoldSarcophagus")===2),prepare:m,execute:async t=>{const a=t.action.entity.field.getCells("Banished").flatMap(r=>r.cardEntities).filter(r=>r.moveLog.latestRecord.movedBy&&t.action.entity.isSame(r.moveLog.latestRecord.movedBy)).filter(r=>r.moveLog.latestRecord.actionOwner===t.activator).filter(r=>r.counterHolder.getQty("GoldSarcophagus")===2);if(!a.length)throw new P("UnexpectedSituation",t);let i=a[0];if(a.length>1){const r=await t.activator.waitSelectEntity(a,"å›žåŽã™ã‚‹ã‚«ãƒ¼ãƒ‰ã‚’é¸æŠžã€‚",!1);if(!r)throw new N(t);i=r}return await i.addToHand(["Effect"],t.action.entity,t.activator),!0},settle:async()=>!0},E]},yield{name:"é­”ã®è©¦ç€éƒ¨å±‹",actions:[{title:"ç™ºå‹•",isMandatory:!1,playType:"CardActivation",spellSpeed:"Normal",executableCells:["Hand","SpellAndTrapZone"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],fixedTags:["SpecialSummonFromDeck"],canPayCosts:t=>t.activator.lp>=800,canExecute:t=>t.activator.getDeckCell().cardEntities.length>0&&t.activator.getEnableSummonList(t.activator,"SpecialSummon",["Effect"],t.action,t.activator.getDeckCell().cardEntities.filter(a=>a.kind==="Monster").filter(a=>{var i;return(i=a.status.monsterCategories)==null?void 0:i.includes("Normal")}).filter(a=>(a.lvl??12)<4).map(a=>({monster:a,posList:T,cells:t.activator.getMonsterZones()})),[],!1).length>0,payCosts:(t,a)=>ea(t,a,800),prepare:m,execute:async t=>{if(t.activator.getDeckCell().cardEntities.length<4)return!1;const a=await S.excavateManyFromDeck(t.activator,4,["Effect"],t.action.entity,t.activator),i=a.filter(r=>r.kind==="Monster").filter(r=>{var n;return(n=r.status.monsterCategories)==null?void 0:n.includes("Normal")}).filter(r=>(r.lvl??12)<4);if(i.length){const r=t.activator.getMonsterZones(),n=i.length>r.length?r.length:i.length;await t.activator.summonMany(t.activator,"SpecialSummon",["Effect","Excavate"],t.action,i.map(s=>({monster:s,cells:r,posList:T})),[],!1,n,s=>s.length===n,!1)}return await S.sendManyToGraveyardForTheSameReason(i.filter(r=>!r.isOnFieldAsMonsterStrictly),["Effect","Excavate"],t.action.entity,t.activator),await S.returnManyToDeckForTheSameReason("Random",a.filter(r=>r.cell.cellType==="Deck"),["Effect"],t.action.entity,t.activator),!0},settle:async()=>!0},E]}}const Ls=Object.freeze(Object.defineProperty({__proto__:null,default:Gp},Symbol.toStringTag,{value:"Module"}));function*Up(){yield{name:"å¼·æ¬²ãªå£º",actions:[{title:"ç™ºå‹•",isMandatory:!1,playType:"CardActivation",spellSpeed:"Normal",executableCells:["Hand","SpellAndTrapZone"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],priorityForNPC:20,fixedTags:["Draw"],canExecute:e=>e.activator.getDeckCell().cardEntities.length>1&&e.activator.canDraw&&e.activator.canAddToHandFromDeck,prepare:m,execute:async e=>(await e.activator.draw(2,e.action.entity,e.activator),!0),settle:async()=>!0},E]},yield{name:"è²ªæ¬²ãªå£º",actions:[{title:"ç™ºå‹•",isMandatory:!1,playType:"CardActivation",spellSpeed:"Normal",executableCells:["Hand","SpellAndTrapZone"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],fixedTags:["Draw","ReturnToDeckFromGraveyard"],priorityForNPC:30,canExecute:e=>e.activator.getGraveyard().cardEntities.filter(t=>t.kind==="Monster").filter(t=>t.canBeTargetOfEffect(e)).length>4&&e.activator.canDraw&&e.activator.canAddToHandFromDeck,prepare:async e=>{const t=await e.activator.waitSelectEntities(e.activator.getGraveyard().cardEntities.filter(a=>a.kind==="Monster").filter(a=>a.canBeTargetOfEffect(e)),5,a=>a.length===5,"ãƒ‡ãƒƒã‚­ã«æˆ»ã™ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã‚’é¸æŠžã€‚",!1);if(t)return{selectedEntities:t}},execute:async e=>e.selectedEntities.some(t=>t.wasMovedAtCurrentChain)?!1:(await S.returnManyToDeckForTheSameReason("Random",e.selectedEntities,["Effect"],e.action.entity,e.activator),await e.activator.draw(2,e.action.entity,e.activator),!0),settle:async()=>!0},E]},yield{name:"å¤©ä½¿ã®æ–½ã—",actions:[{title:"ç™ºå‹•",isMandatory:!1,playType:"CardActivation",spellSpeed:"Normal",executableCells:["Hand","SpellAndTrapZone"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],fixedTags:["Draw","DiscordAsEffect"],priorityForNPC:30,canExecute:e=>e.activator.getDeckCell().cardEntities.length>2&&e.activator.canDraw&&e.activator.canAddToHandFromDeck&&e.activator.status.canDiscardAsEffect,prepare:m,execute:async e=>(await e.activator.draw(3,e.action.entity,e.activator),await e.activator.discard(2,"Effect",()=>!0,e.action.entity,e.activator),!0),settle:async()=>!0},E]},yield{name:"æˆé‡‘ã‚´ãƒ–ãƒªãƒ³",actions:[{title:"ç™ºå‹•",isMandatory:!1,playType:"CardActivation",spellSpeed:"Normal",executableCells:["Hand","SpellAndTrapZone"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],fixedTags:["Draw"],priorityForNPC:20,canExecute:e=>e.activator.getDeckCell().cardEntities.length>0&&e.activator.canDraw&&e.activator.canAddToHandFromDeck,prepare:m,execute:async e=>(await e.activator.draw(1,e.action.entity,e.activator),await e.action.entity.field.duel.clock.incrementProcSeq(),e.activator.getOpponentPlayer().heal(1e3,e.action.entity),!0),settle:async()=>!0},E]},yield{name:"æ‰‹æœ­æŠ¹æ®º",actions:[{title:"ç™ºå‹•",isMandatory:!1,playType:"CardActivation",spellSpeed:"Normal",executableCells:["Hand","SpellAndTrapZone"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],fixedTags:["Draw","DiscordAsEffect"],canExecute:e=>e.activator.getDeckCell().cardEntities.length>=e.activator.getHandCell().cardEntities.filter(t=>t.seq!==e.action.entity.seq).length&&e.activator.canDraw&&e.activator.canAddToHandFromDeck&&e.activator.getOpponentPlayer().canDraw&&e.activator.getOpponentPlayer().canAddToHandFromDeck&&e.action.entity.field.getAllCells().filter(t=>t.cellType==="Hand").flatMap(t=>t.cardEntities).some(t=>t.seq!==e.action.entity.seq),prepare:m,execute:async e=>{const t=e.activator.getHandCell().cardEntities.length,a=e.activator.getOpponentPlayer().getHandCell().cardEntities.length;return await S.sendManyToGraveyardForTheSameReason(e.action.entity.field.getCells("Hand").flatMap(i=>i.cardEntities),["Effect","Discard"],e.action.entity,e.activator),await e.activator.duel.clock.incrementProcSeq(),await S.drawAtSameTime(e.activator,e.action.entity,t,a),!0},settle:async()=>!0},E]},yield{name:"ä¸€æ™‚ä¼‘æˆ¦",actions:[{title:"ç™ºå‹•",isMandatory:!1,playType:"CardActivation",spellSpeed:"Normal",executableCells:["Hand","SpellAndTrapZone"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],fixedTags:["Draw"],canExecute:e=>e.activator.getDeckCell().cardEntities.length>0&&e.activator.canDraw&&e.activator.getOpponentPlayer().getDeckCell().cardEntities.length>0&&e.activator.getOpponentPlayer().canDraw,prepare:m,execute:async e=>(await S.drawAtSameTime(e.activator,e.action.entity,1,1),[e.activator,e.activator.getOpponentPlayer()].forEach(t=>t.entity.damageFilterBundle.push(new ls({title:"ãƒ€ãƒ¡ãƒ¼ã‚¸ç„¡åŠ¹",validateAlive:a=>a.duel.clock.turn-a.isSpawnedAt.turn<2,isContinuous:!1,isSpawnedBy:e.action.entity,actionAttr:e.action,isApplicableTo:()=>!0,calcType:"zero_typeA",filter:(a,i,r,n)=>(r.writeInfoLog(`${n.profile.name}ã¯${a.isSpawnedBy}ã®åŠ¹æžœã§ãƒ€ãƒ¡ãƒ¼ã‚¸ã‚’å—ã‘ãªã„ã€‚`),{zero_typeA:!0})}))),!0),settle:async()=>!0},E]},yield{name:"æ‰“ã¡å‡ºã®å°æ§Œ",actions:[{title:"ç™ºå‹•",isMandatory:!1,playType:"CardActivation",spellSpeed:"Normal",executableCells:["Hand","SpellAndTrapZone"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],fixedTags:["Draw"],canExecute:e=>e.activator.canDraw,prepare:m,execute:async e=>{const t=e.activator.getHandCell().cardEntities;if(!t.length)return!1;let a=[...t];if(a.length>1&&!await e.activator.waitYesNo("å…¨ã¦ã®æ‰‹æœ­ã‚’å…¥ã‚Œæ›¿ãˆã‚‹ï¼Ÿ")){const i=await e.activator.waitSelectEntities(t,void 0,r=>r.length>0,"ãƒ‡ãƒƒã‚­ã«æˆ»ã™ã‚«ãƒ¼ãƒ‰ã‚’é¸æŠžã€‚",!1);if(!i)throw new N(e);a=i}return await S.returnManyToDeckForTheSameReason("Random",a,["Effect"],e.action.entity,e.activator),await e.activator.duel.clock.incrementProcSeq(),await e.activator.draw(a.length,e.action.entity,e.activator),!0},settle:async()=>!0},E]}}const Rs=Object.freeze(Object.defineProperty({__proto__:null,default:Up},Symbol.toStringTag,{value:"Module"}));function*$p(){yield{name:"ãŠã‚ã‹ãªåŸ‹è‘¬",actions:[{title:"ç™ºå‹•",isMandatory:!1,playType:"CardActivation",spellSpeed:"Normal",executableCells:["Hand","SpellAndTrapZone"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],priorityForNPC:40,fixedTags:["SendToGraveyardFromDeck"],canExecute:e=>e.activator.getDeckCell().cardEntities.some(t=>t.kind==="Monster"),prepare:m,execute:async e=>{const t=e.activator.getDeckCell().cardEntities.filter(i=>i.kind==="Monster");if(t.length===0)return!1;const a=await e.activator.waitSelectEntity(t,"å¢“åœ°ã«é€ã‚‹ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã‚’é¸æŠž",!1);if(!a)throw new N(e);return await a.sendToGraveyard(["Effect"],e.action.entity,e.activator),e.activator.getDeckCell().shuffle(),!0},settle:async()=>!0},E]},yield{name:"ãŠã‚ã‹ãªå‰¯è‘¬",actions:[{title:"ç™ºå‹•",isMandatory:!1,playType:"CardActivation",spellSpeed:"Normal",executableCells:["Hand","SpellAndTrapZone"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],isOnlyNTimesPerTurn:1,priorityForNPC:40,fixedTags:["SendToGraveyardFromDeck"],canExecute:e=>e.activator.getDeckCell().cardEntities.some(t=>t.kind!=="Monster"),prepare:m,execute:async e=>{const t=e.activator.getDeckCell().cardEntities.filter(i=>i.kind!=="Monster");if(t.length===0)return!1;const a=await e.activator.waitSelectEntity(t,"å¢“åœ°ã«é€ã‚‹é­”æ³•ç½ ã‚’é¸æŠž",!1);if(!a)throw new N(e);return await a.sendToGraveyard(["Effect"],e.action.entity,e.activator),e.activator.getDeckCell().shuffle(),!0},settle:async()=>!0},E]},yield{name:"è‹¦æ¸‹ã®é¸æŠž",actions:[{title:"ç™ºå‹•",isMandatory:!1,playType:"CardActivation",spellSpeed:"Normal",executableCells:["Hand","SpellAndTrapZone"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],priorityForNPC:40,fixedTags:["SendToGraveyardFromDeck","SearchFromDeck"],canExecute:e=>e.activator.getDeckCell().cardEntities.length>4,prepare:m,execute:async e=>{const t=e.activator.getDeckCell().cardEntities;if(t.length<5)return!1;const a=await e.activator.waitSelectEntities(t,5,r=>r.length===5,"ç›¸æ‰‹ã«è¦‹ã›ã‚‹ã‚«ãƒ¼ãƒ‰ã‚’é¸æŠžã€‚",!1);if(!a)throw new N(e);const i=await e.activator.getOpponentPlayer().waitSelectEntity(a,"æ‰‹æœ­ã«åŠ ãˆã•ã›ã‚‹ã‚«ãƒ¼ãƒ‰ã‚’é¸æŠžã€‚",!1);if(!i)throw new N(e,a);return e.activator.writeInfoLog(`${e.activator.getOpponentPlayer().name}ã¯${i.toString()}ã‚’é¸æŠžã€‚`),await i.addToHand(["Effect"],e.action.entity,e.activator),await S.sendManyToGraveyardForTheSameReason(a.filter(r=>r!==i),["Effect"],e.action.entity,e.activator),e.activator.getDeckCell().shuffle(),!0},settle:async()=>!0},E]};for(const e of["ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã‚²ãƒ¼ãƒˆ","åæŽ¨ç†"]){let t={title:"ç™ºå‹•",isMandatory:!1,playType:"CardActivation",spellSpeed:"Normal",executableCells:["Hand","SpellAndTrapZone"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],fixedTags:["SpecialSummonFromDeck","SendToGraveyardFromDeck","SpecialSummon"],canExecute:a=>a.activator.getDeckCell().cardEntities.filter(i=>i.kind==="Monster").some(i=>{var r;return!((r=i.status.monsterCategories)!=null&&r.includes("SpecialSummon"))}),prepare:m,execute:async a=>{var n,s;if(!a.activator.getDeckCell().cardEntities.length||!a.activator.getAvailableMonsterZones().length)return!1;let i=-1;if(e==="åæŽ¨ç†"){const l=await a.activator.getOpponentPlayer().waitSelectNumberFromRange("ãƒ¬ãƒ™ãƒ«ã‚’é¸æŠž",1,12,!1);if(l===void 0)throw new N(a);i=l,a.activator.writeInfoLog(`${a.activator.getOpponentPlayer().name}ã¯${i}ã‚’é¸æŠžã€‚`)}const r=[...a.activator.getDeckCell().cardEntities];for(const l of a.activator.getDeckCell().cardEntities){if(await l.excavate(["Effect"],a.action.entity,a.activator),l.kind!=="Monster"){await l.sendToGraveyard(["Effect","Excavate"],a.action.entity,a.activator);continue}if((n=l.status.monsterCategories)!=null&&n.includes("SpecialSummon")){await l.sendToGraveyard(["Effect","Excavate"],a.action.entity,a.activator);continue}return(s=l.status.monsterCategories)!=null&&s.includes("NormalSummonOnly")?(await l.sendToGraveyard(["Effect","Excavate"],a.action.entity,a.activator),a.activator.writeInfoLog(`${l.toString()}ã¯é€šå¸¸å¬å–šå¯èƒ½ã ãŒç‰¹æ®Šå¬å–šã§ããªã„ãŸã‚ã€å¢“åœ°ã«é€ã‚‰ã‚ŒãŸã€‚`),!1):l.lvl===i?(await l.sendToGraveyard(["Effect","Excavate"],a.action.entity,a.activator),a.activator.writeInfoLog(`${l.toString()}ã®ãƒ¬ãƒ™ãƒ«ã¯${i}ã®ãŸã‚ã€å¢“åœ°ã«é€ã‚‰ã‚ŒãŸã€‚`),!1):!!await a.activator.summon("SpecialSummon",["Effect","Excavate"],a.action,l,T,a.activator.getAvailableMonsterZones(),[],!1)}return a.activator.writeInfoLog("é€šå¸¸å¬å–šå¯èƒ½ãªãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ãŒã‚ãã‚‰ã‚Œãªã‹ã£ãŸãŸã‚ã€å…¨ã¦ã®ã‚«ãƒ¼ãƒ‰ã‚’ãƒ‡ãƒƒã‚­ã«æˆ»ã™ã€‚"),await S.returnManyToDeckForTheSameReason("Random",r,["Effect"],a.action.entity,a.activator),!1},settle:async()=>!0};e==="ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã‚²ãƒ¼ãƒˆ"&&(t={...t,...Fs([...x],()=>!0,1)}),yield{name:e,actions:[t,E]}}}const qs=Object.freeze(Object.defineProperty({__proto__:null,default:$p},Symbol.toStringTag,{value:"Module"}));function*jp(){const e=[{name:"é­”æ³•çŸ³ã®æŽ¡æŽ˜",filter:()=>!0,discard:!0},{name:"é­”æ³•å†ç”Ÿ",filter:t=>t.kind==="Spell",discard:!1}];for(const t of e)yield{name:t.name,actions:[{title:"ç™ºå‹•",isMandatory:!1,playType:"CardActivation",spellSpeed:"Normal",executableCells:["Hand","SpellAndTrapZone"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],fixedTags:["AddToHandFromGraveyard"],canPayCosts:a=>a.activator.getHandCell().cardEntities.filter(t.filter).length>1,payCosts:async(a,i,r)=>{const n=a.activator.getHandCell().cardEntities.filter(t.filter),s=await a.activator.waitSelectEntities(n,2,o=>o.length===2,"ã‚³ã‚¹ãƒˆã¨ã™ã‚‹ã‚«ãƒ¼ãƒ‰ã‚’é¸æŠž",r);if(!s)return;const l=s.map(o=>({cost:o,cell:o.cell}));return t.discard?(await S.discardManyForTheSameReason(s,["Cost"],a.action.entity,a.activator),{discard:l}):(await S.sendManyToGraveyardForTheSameReason(s,["Cost"],a.action.entity,a.activator),{sendToGraveyard:l})},...de(a=>a.activator.getGraveyard().cardEntities.filter(i=>i.kind==="Spell"),{message:"æ‰‹æœ­ã«åŠ ãˆã‚‹é­”æ³•ã‚«ãƒ¼ãƒ‰ã‚’é¸æŠž"}),execute:async a=>{if(!a.selectedEntities.length)throw new P("UnexpectedSituation",a);const i=a.selectedEntities[0];return i.wasMovedAfter(a.isActivatedAt)?!1:(await i.addToHand(["Effect"],a.action.entity,a.activator),!0)},settle:async()=>!0},E]}}const Hs=Object.freeze(Object.defineProperty({__proto__:null,default:jp},Symbol.toStringTag,{value:"Module"})),Zs=(e,t,a)=>{const i=r=>t(r,e);return a.getAllPatterns(e.activator.getHandCell().cardEntities.filter(i).filter(r=>r.entityType!=="Token").filter(r=>e.activator.canDiscard([r]))).some(()=>!0)},Gs=async(e,t,a,i,r)=>{const n=d=>i(d,e),s=e.activator.getHandCell().cardEntities.filter(n).filter(d=>d.entityType!=="Token").filter(d=>e.activator.canDiscard([d])),l=[];for(const d of r.getAllPatterns(s))if(l.push(...d.filter(p=>!l.includes(p))),l.length===s.length)break;const o=r.qty;let c;if(o!==void 0?c=await e.activator.discard(o,"Cost",d=>i(d,e),e.action.entity,e.activator,e.activator,a):c=await e.activator.waitSelectEntities(l,o,d=>r.validatePattern(d),"ã‚³ã‚¹ãƒˆã¨ã—ã¦æ¨ã¦ã‚‹ã‚«ãƒ¼ãƒ‰ã‚’é¸æŠžã€‚",a),!!c)return{discard:c==null?void 0:c.map(d=>({cost:d,cell:e.activator.getHandCell()}))}},ta=(e,...t)=>{const a=et.create(...t);return{canPayCosts:(...i)=>Zs(i[0],e,a),payCosts:(...i)=>Gs(...i,e,a)}},zp=()=>{const e=et.create(1);return{canPayCosts:(...t)=>Zs(t[0],a=>t[0].action.entity===a,e),payCosts:(...t)=>Gs(...t,a=>t[0].action.entity===a,e)}};function*Vp(){for(const e of[{name:"ãƒˆã‚²ãƒˆã‚²ç¥žã®æ®ºè™«å‰¤",type:"Insect"},{name:"æˆ¦å£«æŠ¹æ®º",type:"Warrior"},{name:"é…¸ã®åµ",type:"Machine"},{name:"æ°¸é ã®æ¸‡æ°´",type:"Fish"},{name:"ç¥žã®æ¯å¹",type:"Rock"},{name:"é­”å¥³ç‹©ã‚Š",type:"Spellcaster"},{name:"æ‚ªé­”æ‰•ã„",type:"Fiend"}])yield{name:e.name,actions:[{title:"ç™ºå‹•",isMandatory:!1,playType:"CardActivation",spellSpeed:"Normal",executableCells:["Hand","SpellAndTrapZone"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],canExecute:t=>t.action.entity.field.getMonstersOnFieldStrictly().some(a=>a.types.includes(e.type)),prepare:async t=>{const a=t.action.entity.field.getMonstersOnFieldStrictly().filter(i=>i.types.includes(e.type));return{selectedEntities:[],chainBlockTags:t.action.calcChainBlockTagsForDestroy(t.activator,a)}},execute:async t=>{const a=t.action.entity.field.getMonstersOnFieldStrictly().filter(i=>i.types.includes(e.type));return await S.tryDestroy(a,t),!0},settle:async()=>!0},E]};yield*[{name:"å¢—æ´",filter:e=>e.origin.kind==="Monster"&&e.types.includes("Warrior")&&(e.origin.level??5)<5},{name:"åŒ–çŸ³èª¿æŸ»",filter:e=>e.origin.kind==="Monster"&&e.types.includes("Dinosaur")&&(e.origin.level??6)<6},{name:"ï¼¥ï¼ã‚¨ãƒžãƒ¼ã‚¸ã‚§ãƒ³ã‚·ãƒ¼ã‚³ãƒ¼ãƒ«",filter:e=>e.origin.kind==="Monster"&&(e.origin.nameTags??[]).includes("Eãƒ»HERO")},{name:"å¬é›†ã®è–åˆ»å°",filter:e=>e.origin.kind==="Monster"&&(e.origin.nameTags??[]).includes("è–åˆ»")},{name:"å¬å–šå¸«ã®ã‚¹ã‚­ãƒ«",filter:e=>e.origin.kind==="Monster"&&(e.origin.monsterCategories??[]).includes("Normal")&&(e.origin.level??4)>4},{name:"ãƒˆã‚¥ãƒ¼ãƒ³ã®ã‚‚ãã˜",filter:e=>(e.origin.nameTags??[]).includes("ãƒˆã‚¥ãƒ¼ãƒ³")},{name:"èžåˆè³¢è€…",filter:e=>e.origin.name==="èžåˆ"},{name:"è™¹ã®æž¶ã‘æ©‹",filter:e=>e.origin.kind!=="Monster"&&(e.origin.nameTags??[]).includes("å®çŽ‰")},{name:"ç´«ç‚Žã®ç‹¼ç…™",filter:e=>e.origin.kind==="Monster"&&(e.origin.nameTags??[]).includes("å…­æ­¦è¡†")&&(e.origin.level??4)<4},{name:"ãƒ†ãƒ©ãƒ»ãƒ•ã‚©ãƒ¼ãƒŸãƒ³ã‚°",filter:e=>e.origin.kind==="Spell"&&e.origin.spellCategory==="Field"},{name:"ã‚³ãƒ¼ãƒ«ãƒ»ãƒªã‚¾ãƒãƒ¼ã‚¿ãƒ¼",filter:e=>e.origin.kind==="Monster"&&(e.origin.nameTags??[]).includes("ãƒªã‚¾ãƒãƒ¼ã‚¿ãƒ¼")}].map(e=>({name:e.name,actions:[{title:"ç™ºå‹•",isMandatory:!1,playType:"CardActivation",spellSpeed:"Normal",executableCells:["Hand","SpellAndTrapZone"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],fixedTags:["SearchFromDeck"],priorityForNPC:40,canExecute:t=>t.activator.getDeckCell().cardEntities.some(e.filter)&&t.activator.canAddToHandFromDeck,prepare:m,execute:async t=>{const a=t.activator.getDeckCell().cardEntities.filter(e.filter);if(!a.length)return!1;const i=await t.activator.waitSelectEntity(a,"æ‰‹æœ­ã«åŠ ãˆã‚‹ã‚«ãƒ¼ãƒ‰ã‚’é¸æŠž",!1);return i?(await i.addToHand(["Effect"],t.action.entity,t.activator),t.activator.getDeckCell().shuffle(),!0):!1},settle:async()=>!0},E]})),yield*[{name:"æˆ¦å£«ã®ç”Ÿé‚„",filter:e=>e.kind==="Monster"&&e.types.includes("Warrior"),qty:1},{name:"ãƒ€ãƒ¼ã‚¯ãƒ»ãƒãƒ¼ã‚¹ãƒˆ",filter:e=>e.kind==="Monster"&&e.attr.includes("Dark")&&(e.atk??9999)<=1500,qty:1},{name:"æ‚ªå¤¢å†ã³",filter:e=>e.kind==="Monster"&&e.attr.includes("Dark")&&(e.def??9999)===0,qty:2},{name:"ã‚µãƒ«ãƒ™ãƒ¼ã‚¸",filter:e=>e.kind==="Monster"&&e.attr.includes("Water")&&(e.atk??9999)<=1500,qty:2},{name:"ãƒãƒƒãƒ†ãƒªãƒ¼ãƒªã‚µã‚¤ã‚¯ãƒ«",filter:e=>e.kind==="Monster"&&e.types.includes("Thunder")&&(e.atk??9999)<=1500,qty:2},{name:"é—‡ã®é‡ç”£å·¥å ´",filter:e=>e.kind==="Monster"&&(e.status.monsterCategories??[]).includes("Normal"),qty:2}].map(e=>({name:e.name,actions:[{title:"ç™ºå‹•",isMandatory:!1,playType:"CardActivation",spellSpeed:"Normal",executableCells:["Hand","SpellAndTrapZone"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],hasToTargetCards:!0,fixedTags:["AddToHandFromGraveyard"],priorityForNPC:40,canExecute:t=>t.activator.getGraveyard().cardEntities.filter(e.filter).length>=e.qty,prepare:m,execute:async t=>{const a=t.activator.getGraveyard().cardEntities.filter(e.filter);if(a.length===0)return!1;const i=await t.activator.waitSelectEntities(a,e.qty,r=>r.length===e.qty,"æ‰‹æœ­ã«åŠ ãˆã‚‹ã‚«ãƒ¼ãƒ‰ã‚’é¸æŠž",!1);for(const r of i??[])await r.addToHand(["Effect"],t.action.entity,t.activator);return!0},settle:async()=>!0},E]})),yield*[{name:"ãƒˆãƒ¬ãƒ¼ãƒ‰ãƒ»ã‚¤ãƒ³",filter:e=>e.kind==="Monster"&&(e.lvl??0)===8},{name:"èª¿å’Œã®å®æœ­",filter:e=>e.kind==="Monster"&&(e.origin.monsterCategories??[]).includes("Tuner")&&e.types.includes("Dragon")&&(e.atk??9999)<=1e3},{name:"ãƒ‡ã‚¹ãƒ†ãƒ‹ãƒ¼ãƒ»ãƒ‰ãƒ­ãƒ¼",filter:e=>e.kind==="Monster"&&(e.origin.nameTags??[]).includes("D-HERO")}].map(e=>({name:e.name,actions:[{title:"ç™ºå‹•",isMandatory:!1,playType:"CardActivation",spellSpeed:"Normal",executableCells:["Hand","SpellAndTrapZone"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],fixedTags:["Draw"],priorityForNPC:40,...ta(e.filter,1),canExecute:t=>t.activator.getDeckCell().cardEntities.length>1,prepare:m,execute:async t=>(await t.activator.draw(2,t.action.entity,t.activator),!0),settle:async()=>!0},E]})),yield*[{name:"ç«ã®ç²‰",calcHeal:()=>[0,-200]},{name:"é›·é³´",calcHeal:()=>[0,-300]},{name:"ãƒ•ã‚¡ã‚¤ãƒ¤ãƒ¼ãƒ»ãƒœãƒ¼ãƒ«",calcHeal:()=>[0,-500]},{name:"ç«ã‚ã¶ã‚Šã®åˆ‘",calcHeal:()=>[0,-600]},{name:"æ˜¼å¤œã®å¤§ç«äº‹",calcHeal:()=>[0,-800]},{name:"ç«ç‚Žåœ°ç„",calcHeal:()=>[-500,-1e3]},{name:"ç›—äººã‚´ãƒ–ãƒªãƒ³",calcHeal:()=>[500,-500]},{name:"ãƒ–ãƒ«ãƒ¼ãƒ»ãƒãƒ¼ã‚·ãƒ§ãƒ³",calcHeal:()=>[400,0]},{name:"ãƒ¬ãƒƒãƒ‰ãƒ»ãƒãƒ¼ã‚·ãƒ§ãƒ³",calcHeal:()=>[500,0]},{name:"ã‚´ãƒ–ãƒªãƒ³ã®ç§˜è–¬",calcHeal:()=>[600,0]},{name:"å¤©ä½¿ã®ç”Ÿãè¡€",calcHeal:()=>[800,0]},{name:"æ²»ç™‚ã®ç¥ž ãƒ‡ã‚£ã‚¢ãƒ³ãƒ»ã‚±ãƒˆ",calcHeal:()=>[1e3,0]},{name:"æµã¿ã®é›¨",calcHeal:()=>[1e3,1e3]}].map(e=>({name:e.name,actions:[{title:"ç™ºå‹•",isMandatory:!1,playType:"CardActivation",spellSpeed:"Normal",executableCells:["Hand","SpellAndTrapZone"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],prepare:async()=>{const[t,a]=e.calcHeal(),i=[];return t<0&&i.push("DamageToSelf"),a<0&&i.push("DamageToOpponent"),{selectedEntities:[],chainBlockTags:i}},execute:async t=>{const[a,i]=e.calcHeal();return i>0?t.activator.getOpponentPlayer().heal(i,t.action.entity):i<0&&t.activator.getOpponentPlayer().effectDamage(Math.abs(i),t),a>0?t.activator.heal(a,t.action.entity):a<0&&t.activator.effectDamage(Math.abs(a),t),!0},settle:async()=>!0},E]}))}const Us=Object.freeze(Object.defineProperty({__proto__:null,default:Vp},Symbol.toStringTag,{value:"Module"}));function*Qp(){yield{name:"å¼·æ¬²ãªç“¶",actions:[E,{title:"ç™ºå‹•",isMandatory:!1,playType:"CardActivation",spellSpeed:"Quick",executableCells:["SpellAndTrapZone"],executablePeriods:C,executableDuelistTypes:["Controller"],fixedTags:["Draw"],canExecute:e=>e.activator.getDeckCell().cardEntities.length>1&&e.activator.canDraw&&e.activator.canAddToHandFromDeck,prepare:m,execute:async e=>(await e.activator.draw(1,e.action.entity,e.activator),!0),settle:async()=>!0}]},yield{name:"æˆ¦ç·šå¾©å¸°",actions:[{title:"ç™ºå‹•",isMandatory:!1,playType:"CardActivation",spellSpeed:"Quick",executableCells:["SpellAndTrapZone"],executablePeriods:C,executableDuelistTypes:["Controller"],fixedTags:["SpecialSummonFromGraveyard"],...Ye(e=>e.activator.getGraveyard().cardEntities.filter(t=>t.kind==="Monster").filter(t=>t.canBeTargetOfEffect(e)),{posList:["Defense"]}),settle:async()=>!0},E]},yield{name:"ã‚µãƒ³ãƒ€ãƒ¼ãƒ»ãƒ–ãƒ¬ã‚¤ã‚¯",actions:[{title:"ç™ºå‹•",isMandatory:!1,playType:"CardActivation",spellSpeed:"Quick",executableCells:["SpellAndTrapZone"],executablePeriods:C,executableDuelistTypes:["Controller"],...ta(()=>!0,1),...de((e,t,a)=>e.action.entity.field.getCardsOnFieldStrictly().filter(i=>i!==e.action.entity).filter(i=>i.canBeTargetOfEffect(e)).filter(i=>{if(!a)return!0;const r=ma.flatMap(n=>a.costInfo[n]??[]).map(n=>n.cost);return r.push(...r.flatMap(n=>n.info.equipEntities)),!r.includes(i)}),{message:"å¯¾è±¡ã¨ã™ã‚‹ã‚«ãƒ¼ãƒ‰ã‚’é¸æŠžã€‚",do:"Destroy"}),execute:async e=>e.selectedEntities.every(t=>!t.isOnField)?!1:(await S.tryDestroy(e.selectedEntities,e),!0),settle:async()=>!0},E]},yield{name:"ã‚®ãƒ–ï¼†ãƒ†ã‚¤ã‚¯",actions:[{title:"ç™ºå‹•",isMandatory:!1,playType:"CardActivation",spellSpeed:"Quick",executableCells:["SpellAndTrapZone"],executablePeriods:C,executableDuelistTypes:["Controller"],hasToTargetCards:!0,fixedTags:["SpecialSummonFromGraveyard"],canExecute:(t,a,i)=>{const r=t.activator.getOpponentPlayer().getMonsterZones();return t.activator.getEnableSummonList(t.activator,"SpecialSummon",["Effect"],t.action,t.activator.getGraveyard().cardEntities.filter(s=>s.lvl).filter(s=>s.canBeTargetOfEffect(t)).map(s=>({monster:s,posList:["Defense"],cells:r})),[],!1).length?t.activator.getMonstersOnField().filter(s=>s.lvl).filter(s=>{if(!i)return!0;const l=ma.flatMap(o=>i.costInfo[o]??[]).map(o=>o.cost);return l.push(...l.flatMap(o=>o.info.equipEntities)),!l.includes(s)}).some(s=>s.canBeTargetOfEffect(t)):!1},prepare:async(t,a,i)=>{const r=await t.activator.waitSelectEntity(t.activator.getMonstersOnField().filter(l=>l.lvl),"ãƒ¬ãƒ™ãƒ«ã‚’ä¸Šã’ã‚‹ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã‚’é¸æŠžã€‚",i);if(!r)return;const n=await hs(t,t.activator.getGraveyard().cardEntities.filter(l=>l.lvl).filter(l=>l.canBeTargetOfEffect(t)),["Defense"]),s=[r,...n.selectedEntities];return t.data={give:n.selectedEntities[0],take:r},{...n,selectedEntities:s}},execute:async t=>{if(!t.data)throw new P("IlligalActionData",t);const{give:a,take:i}=t.data;if(!i.isOnFieldAsMonsterStrictly||!await ys(t,[a],{cells:t.activator.getOpponentPlayer().getMonsterZones(),posList:["Defense"]}))return!1;const n=a.lvl??0;return i.numericOprsBundle.push(I.createLingeringAddition("ã‚®ãƒ–ï¼†ãƒ†ã‚¤ã‚¯",s=>s.duel.clock.isSameTurn(s.isSpawnedAt),t.action.entity,t.action,"level",(s,l,o)=>o+n)),!0},settle:async()=>!0},E]}}const $s=Object.freeze(Object.defineProperty({__proto__:null,default:Qp},Symbol.toStringTag,{value:"Module"}));function*Wp(){yield{name:"ãƒžã‚¸ã‚«ãƒ«ãƒ»ã‚¨ã‚¯ã‚¹ãƒ—ãƒ­ãƒ¼ã‚¸ãƒ§ãƒ³",actions:[{title:"ç™ºå‹•",isMandatory:!1,playType:"CardActivation",spellSpeed:"Quick",executableCells:["SpellAndTrapZone"],executablePeriods:C,executableDuelistTypes:["Controller"],fixedTags:["DamageToOpponent"],meetsConditions:e=>!e.activator.getHandCell().cardEntities.length&&e.activator.getGraveyard().cardEntities.some(t=>t.kind==="Spell"),prepare:m,execute:async e=>{const t=e.activator.getGraveyard().cardEntities.filter(a=>a.kind==="Spell");return t.length?(e.activator.getOpponentPlayer().effectDamage(t.length*200,e),!0):!1},settle:async()=>!0},E]},yield{name:"æ®‹éª¸çˆ†ç ´",actions:[{title:"ç™ºå‹•",isMandatory:!1,playType:"CardActivation",spellSpeed:"Quick",executableCells:["SpellAndTrapZone"],executablePeriods:C,executableDuelistTypes:["Controller"],fixedTags:["DamageToOpponent"],meetsConditions:e=>e.activator.getGraveyard().cardEntities.length>=30,prepare:m,execute:async e=>(e.activator.getOpponentPlayer().effectDamage(3e3,e),!0),settle:async()=>!0},E]},yield{name:"ä»•è¾¼ã¿ãƒžã‚·ãƒ³ã‚¬ãƒ³",actions:[{title:"ç™ºå‹•",isMandatory:!1,playType:"CardActivation",spellSpeed:"Quick",executableCells:["SpellAndTrapZone"],executablePeriods:C,executableDuelistTypes:["Controller"],fixedTags:["DamageToOpponent"],meetsConditions:e=>!!(e.activator.getOpponentPlayer().getHandCell().cardEntities.length||e.activator.getOpponentPlayer().getEntiteisOnField().length),prepare:m,execute:async e=>{const t=e.activator.getOpponentPlayer().getHandCell().cardEntities.length+e.activator.getOpponentPlayer().getEntiteisOnField().length;return t?(e.activator.getOpponentPlayer().effectDamage(t*200,e),!0):!1},settle:async()=>!0},E]},yield{name:"ä»•è¾¼ã¿çˆ†å¼¾",actions:[{title:"ç™ºå‹•",isMandatory:!1,playType:"CardActivation",spellSpeed:"Quick",executableCells:["SpellAndTrapZone"],executablePeriods:C,executableDuelistTypes:["Controller"],fixedTags:["DamageToOpponent"],meetsConditions:e=>!!e.activator.getOpponentPlayer().getEntiteisOnField().length,prepare:m,execute:async e=>{const t=e.activator.getOpponentPlayer().getEntiteisOnField();return t.length?(e.activator.getOpponentPlayer().effectDamage(t.length*500,e),!0):!1},settle:async()=>!0},{title:"â‘¡èª˜çˆ†",isMandatory:!0,playType:"TriggerEffect",spellSpeed:"Normal",executableCells:["Graveyard"],executablePeriods:C,executableDuelistTypes:["Controller"],fixedTags:["DamageToOpponent"],triggerPattern:{triggerType:"Departure",needsByOpponent:!0,needsByDestory:!0,from:me},prepare:m,execute:async e=>(e.activator.getOpponentPlayer().effectDamage(1e3,e),!0),settle:async()=>!0},E]},yield{name:"ä¸é‹ã®çˆ†å¼¾",actions:[{title:"ç™ºå‹•",isMandatory:!1,playType:"CardActivation",spellSpeed:"Quick",executableCells:["SpellAndTrapZone"],executablePeriods:C,executableDuelistTypes:["Controller"],fixedTags:["DamageToOpponent","DamageToSelf"],isOnlyNTimesPerTurn:1,...de(e=>e.activator.getOpponentPlayer().getEntiteisOnField().filter(t=>t.face==="FaceUp").filter(t=>t.atk),{tags:["DamageToOpponent","DamageToSelf"]}),prepare:m,execute:async e=>{const t=e.selectedEntities.filter(r=>r.isOnFieldAsMonsterStrictly).filter(r=>r.face==="FaceUp").find(r=>r.atk);if(!t)return!1;const i=e.activator.effectDamage(Math.floor(t.atk??0/2),e).map(r=>r.beforeLp-r.afterLp).reduce((r,n)=>r+n);return i<1?!1:(await e.activator.duel.clock.incrementProcSeq(),e.activator.getOpponentPlayer().effectDamage(i,e),!0)},settle:async()=>!0},{title:"â‘¡èª˜çˆ†",isMandatory:!0,playType:"TriggerEffect",spellSpeed:"Normal",executableCells:["Graveyard"],executablePeriods:C,executableDuelistTypes:["Controller"],fixedTags:["DamageToOpponent"],triggerPattern:{triggerType:"Departure",needsByOpponent:!0,needsByDestory:!0,from:me},prepare:m,execute:async e=>(e.activator.getOpponentPlayer().effectDamage(1e3,e),!0),settle:async()=>!0},E]},yield{name:"è‡ªæ¥­è‡ªå¾—",actions:[{title:"ç™ºå‹•",isMandatory:!1,playType:"CardActivation",spellSpeed:"Quick",executableCells:["SpellAndTrapZone"],executablePeriods:C,executableDuelistTypes:["Controller"],fixedTags:["DamageToOpponent"],meetsConditions:e=>!!e.activator.getOpponentPlayer().getMonstersOnField().length,prepare:m,execute:async e=>{const t=e.activator.getOpponentPlayer().getMonstersOnField();return t.length?(e.activator.getOpponentPlayer().effectDamage(t.length*500,e),!0):!1},settle:async()=>!0},E]}}const js=Object.freeze(Object.defineProperty({__proto__:null,default:Wp},Symbol.toStringTag,{value:"Module"}));function*Xp(){for(const e of["ç‚¸è£‚è£…ç”²","æ¬¡å…ƒå¹½é–‰"])yield{name:e,actions:[E,{title:"ç™ºå‹•",playType:"CardActivation",spellSpeed:"Quick",isMandatory:!1,executableCells:["SpellAndTrapZone"],executablePeriods:["b1Battle","b2Battle"],executableDuelistTypes:["Controller"],hasToTargetCards:!0,isNoticedForcibly:!0,meetsConditions:(t,a)=>a.some(i=>i.action.playType==="DeclareAttack"),canExecute:t=>{if(t.activator.isTurnPlayer)return!1;const a=t.activator.duel.attackingMonster;return!(!a||!a.canBeTargetOfEffect(t)||!a.isOnFieldAsMonsterStrictly||e==="æ¬¡å…ƒå¹½é–‰"&&!t.activator.canTryBanish(a,"BanishAsEffect",t.action))},prepare:async t=>{const a=t.activator.duel.attackingMonster;if(!a)throw new P("UnexpectedSituation",t,a);const i=e==="ç‚¸è£‚è£…ç”²"?t.action.calcChainBlockTagsForDestroy(t.activator,[a]):["BanishFromField"];return{selectedEntities:[a],chainBlockTags:i}},execute:async t=>(e==="ç‚¸è£‚è£…ç”²"?await S.tryDestroy(t.selectedEntities,t):await S.tryBanish("BanishAsEffect",t.selectedEntities,t),!0),settle:async()=>!0}]}}const zs=Object.freeze(Object.defineProperty({__proto__:null,default:Xp},Symbol.toStringTag,{value:"Module"}));function*Kp(){yield{name:"ã”éš å±…ã®çŒ›æ¯’è–¬",actions:[E,{title:"ç™ºå‹•",isMandatory:!1,playType:"CardActivation",spellSpeed:"Quick",executableCells:["Hand","SpellAndTrapZone"],executablePeriods:C,executableDuelistTypes:["Controller"],prepare:async(e,t,a)=>{const i=[{seq:0,text:"â—è‡ªåˆ†ã¯ï¼‘ï¼’ï¼ï¼ï¼¬ï¼°å›žå¾©ã™ã‚‹ã€‚",tags:[]},{seq:1,text:"â—ç›¸æ‰‹ã«ï¼˜ï¼ï¼ãƒ€ãƒ¡ãƒ¼ã‚¸ã‚’ä¸Žãˆã‚‹ã€‚",tags:["DamageToOpponent"]}],r=await e.activator.waitSelectText(i,"ä½¿ç”¨ã™ã‚‹åŠ¹æžœã‚’é¸æŠž",a);if(r!==void 0)return{selectedEntities:[],chainBlockTags:r.tags}},execute:async e=>(e.chainBlockTags.includes("DamageToOpponent")?e.activator.heal(1200,e.action.entity):e.activator.getOpponentPlayer().effectDamage(800,e),!0),settle:async()=>!0}]},yield{name:"æœˆã®æ›¸",actions:[{title:"ç™ºå‹•",isMandatory:!1,playType:"CardActivation",spellSpeed:"Quick",executableCells:["Hand","SpellAndTrapZone"],executablePeriods:C,executableDuelistTypes:["Controller"],...de(e=>e.action.entity.field.getMonstersOnFieldStrictly().filter(t=>t.canBeTargetOfEffect(e)).filter(t=>t.canBeSet).filter(t=>t.face==="FaceUp"),{message:"å¯¾è±¡ã¨ã™ã‚‹ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã‚’é¸æŠžã€‚"}),execute:async e=>{const t=e.selectedEntities[0];return!t.isOnFieldAsMonsterStrictly||t.battlePosition==="Set"?!1:t.canBeEffected(e.activator,e.action.entity,e.action)?(await t.setBattlePosition("Set",["Effect"],e.action.entity,e.activator),!0):(e.activator.duel.log.info(`${t.toString()}ã¯${e.action.entity.toString()}ã®åŠ¹æžœã‚’å—ã‘ãªã„ã€‚`),!1)},settle:async()=>!0},E]},yield{name:"çªé€²",actions:[{title:"ç™ºå‹•",isMandatory:!1,playType:"CardActivation",spellSpeed:"Quick",executableCells:["Hand","SpellAndTrapZone"],executablePeriods:[...C,...M],executableDuelistTypes:["Controller"],...de(e=>e.action.entity.field.getMonstersOnFieldStrictly().filter(t=>t.face==="FaceUp").filter(t=>t.canBeTargetOfEffect(e)),{message:"å¯¾è±¡ã¨ã™ã‚‹ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã‚’é¸æŠžã€‚"}),execute:async e=>{const t=e.selectedEntities[0];return!t.isOnFieldAsMonsterStrictly||t.battlePosition==="Set"?!1:t.canBeEffected(e.activator,e.action.entity,e.action)?(t.numericOprsBundle.push(I.createLingeringAddition("æ”»æ’ƒåŠ›ä¸Šæ˜‡",a=>a.duel.clock.isSameTurn(a.isSpawnedAt),e.action.entity,e.action,"attack",(a,i,r)=>r+700)),!0):(e.activator.duel.log.info(`${t.toString()}ã¯${e.action.entity.toString()}ã®åŠ¹æžœã‚’å—ã‘ãªã„ã€‚`),!1)},settle:async()=>!0},E]},yield{name:"æ‰‹æœ­æ–­æ®º",actions:[{title:"ç™ºå‹•",isMandatory:!1,playType:"CardActivation",spellSpeed:"Quick",executableCells:["Hand","SpellAndTrapZone"],executablePeriods:[...C,...M],executableDuelistTypes:["Controller"],fixedTags:["Draw"],canExecute:e=>{for(const t of[e.activator,e.activator.getOpponentPlayer()])if(!t.canDraw||t.getHandCell().cardEntities.filter(a=>a.canBeSentToGraveyard(e.activator,e.action.entity,"SendToGraveyardAsEffect",e.action)).filter(a=>a!==e.action.entity).length<2||t.getDeckCell().cardEntities.length<2)return!1;return!0},prepare:m,execute:async e=>{if(e.activator.getHandCell().cardEntities.length<2||e.activator.getOpponentPlayer().getHandCell().cardEntities.length<2)return!1;let t=0;for(const a of[e.activator,e.activator.getOpponentPlayer()]){const i=await a.waitSelectEntities(a.getHandCell().cardEntities,2,n=>n.length===2,"å¢“åœ°ã«é€ã‚‹ã‚«ãƒ¼ãƒ‰ã‚’ï¼’æžšé¸æŠžã€‚",!1);if(!i)throw new N(e,a);const r=await S.sendManyToGraveyardForTheSameReason(i,["Effect"],e.action.entity,e.activator);t+=r.length}return t?(await e.activator.duel.clock.incrementProcSeq(),await S.drawAtSameTime(e.activator,e.action.entity,2,2),!0):!1},settle:async()=>!0},E]},yield{name:"ãƒªãƒ­ãƒ¼ãƒ‰",actions:[{title:"ç™ºå‹•",isMandatory:!1,playType:"CardActivation",spellSpeed:"Quick",executableCells:["Hand","SpellAndTrapZone"],executablePeriods:[...C,...M],executableDuelistTypes:["Controller"],fixedTags:["Draw"],hasToTargetCards:!0,canExecute:e=>e.activator.canDraw,prepare:m,execute:async e=>{const t=e.activator.getHandCell().cardEntities;return t.length?(await S.returnManyToDeckForTheSameReason("Random",t,["Effect"],e.action.entity,e.activator),await e.activator.duel.clock.incrementProcSeq(),await e.activator.draw(t.length,e.action.entity,e.activator),!0):!1},settle:async()=>!0},E]}}const Vs=Object.freeze(Object.defineProperty({__proto__:null,default:Kp},Symbol.toStringTag,{value:"Module"})),Yp=(e,t,a,i,r,n,s)=>{if(!e.lvl||r.some(d=>!d.lvl))return;const l=r.map(d=>d.lvl??0).reduce((d,p)=>d+p,0),o=r.map(d=>d.lvl??0).min()??0;if(l<e.lvl||s==="Equal"&&l!==e.lvl||s==="OrMore"&&l-o>=e.lvl||!n(r))return;const c=[...r.map(d=>({material:d,cell:d.cell}))];if(t.activator.getEnableSummonList(t.activator,"RitualSummon",["Effect","SpecialSummon"],t.action,[{monster:t.action.entity,posList:a,cells:i}],c,!1).length)return c};function*Qs(e,...t){const[a,i,r,n,s]=t,l=e.activator.getCells(...a).flatMap(p=>p.cardEntities).filter(p=>{var f;return(f=p.status.monsterCategories)==null?void 0:f.includes("Ritual")}).filter(i);if(!l.length)return;const o=e.activator.getCells(...r).flatMap(p=>p.cardEntities).filter(p=>p.lvl).filter(p=>p.canBeReleased(e.activator,e.action.entity,["RitualMaterial","ReleaseAsEffect"],e.action));if(!o.length)return;const c=e.activator.getMonsterZones(),d=["Attack","Defense"];for(const p of l)for(const f of o.filter(h=>h!==p).getAllOnOffPattern()){const h=Yp(p,e,d,c,f,n,s);h&&(yield{monster:p,materialInfos:h})}}const Jp=async(e,...t)=>{var d,p;const a=Qs(e,...t).toArray(),i=a.map(f=>f.monster).getDistinct(),r=await e.activator.waitSelectEntity(i,"å„€å¼å¬å–šã™ã‚‹ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã‚’é¸æŠžã€‚");if(!r)return!1;const n=a.filter(f=>f.monster===r).map(f=>f.materialInfos),s=n.map(f=>({infos:f,materialSeqList:f.map(h=>h.material.seq).sort()}));let l=n[0].map(f=>f.material);if(n.length>1){const f=n.flatMap(h=>h.map(y=>y.material)).getDistinct();l=await e.activator.waitSelectEntities(f,void 0,h=>{const y=h.map(v=>v.seq).sort();return s.some(v=>y.length===v.materialSeqList.length&&y.every((g,_)=>g===v.materialSeqList[_]))},"ãƒªãƒªãƒ¼ã‚¹ã™ã‚‹ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã‚’é¸æŠž",!1)??l}const o=l.map(f=>f.seq).sort(),c=(d=s.find(f=>o.length===f.materialSeqList.length&&o.every((h,y)=>h===f.materialSeqList[y])))==null?void 0:d.infos;if(!c)throw new P("UnexpectedSituation",e,l);return await S.releaseManyForTheSameReason(l,["RitualMaterial","Effect","SpecialSummonMaterial"],e.action.entity,e.activator),await e.activator.summon("RitualSummon",["Effect","SpecialSummon"],e.action,r,T,e.activator.getMonsterZones(),c,!1),r.info.isRebornable=!((p=r.origin.monsterCategories)!=null&&p.includes("RegularSpecialSummonOnly")),c.map(f=>f.material).forEach(f=>f.onUsedAsMaterial(e,e.action.entity)),!0},Ip=(e,t,a,i,r)=>({canExecute:n=>Qs(n,e,t,a,i,r).some(s=>s.materialInfos.length),prepare:async()=>{const n=[];return e.includes("Hand")&&n.push("SpecialSummonFromHand"),e.includes("Graveyard")&&n.push("SpecialSummonFromGraveyard"),e.includes("ExtraDeck")&&n.push("SpecialSummonFromExtraDeck"),e.includes("Banished")&&n.push("SpecialSummonFromBanished"),e.includes("Deck")&&n.push("SpecialSummonFromDeck"),{selectedEntities:[],chainBlockTags:n}},execute:n=>Jp(n,e,t,a,i,r),settle:async()=>!0});function*ef(){for(const e of[{spellName:"ã‚«ã‚ªã‚¹ã®å„€å¼",monsterName:"ã‚«ã‚ªã‚¹ãƒ»ã‚½ãƒ«ã‚¸ãƒ£ãƒ¼"},{spellName:"ä»®é¢é­”ç£ã®å„€å¼",monsterName:"ä»®é¢é­”ç£ãƒžã‚¹ã‚¯ãƒ‰ãƒ»ãƒ˜ãƒ«ãƒ¬ã‚¤ã‚¶ãƒ¼"},{spellName:"äº€ã®èª“ã„",monsterName:"ã‚¯ãƒ©ãƒ–ãƒ»ã‚¿ãƒ¼ãƒˆãƒ«"},{spellName:"ã‚¸ãƒ£ãƒ™ãƒªãƒ³ãƒ“ãƒ¼ãƒˆãƒ«ã®å¥‘ç´„",monsterName:"ã‚¸ãƒ£ãƒ™ãƒªãƒ³ãƒ“ãƒ¼ãƒˆãƒ«"},{spellName:"ã‚¼ãƒ©ã®å„€å¼",monsterName:"ã‚¼ãƒ©"},{spellName:"ã‚«ã‚ªã‚¹ï¼é»’é­”è¡“ã®å„€å¼",monsterName:"ãƒžã‚¸ã‚·ãƒ£ãƒ³ãƒ»ã‚ªãƒ–ãƒ»ãƒ–ãƒ©ãƒƒã‚¯ã‚«ã‚ªã‚¹"},{spellName:"ã‚¬ãƒ«ãƒžã‚½ãƒ¼ãƒ‰ã®èª“ã„",monsterName:"ã‚¬ãƒ«ãƒžã‚½ãƒ¼ãƒ‰"},{spellName:"ãƒ©ã‚¤ã‚ªãƒ³ã®å„€å¼",monsterName:"ã‚¹ãƒ¼ãƒ‘ãƒ¼ãƒ»ã‚¦ã‚©ãƒ¼ãƒ»ãƒ©ã‚¤ã‚ªãƒ³"},{spellName:"ãƒãƒ£ã‚¯ãƒ©ã®å¾©æ´»",monsterName:"ãƒãƒ£ã‚¯ãƒ©"},{spellName:"è¦å¡žã‚¯ã‚¸ãƒ©ã®èª“ã„",monsterName:"è¦å¡žã‚¯ã‚¸ãƒ©"},{spellName:"ãƒ­ãƒ¼ã®ç¥ˆã‚Š",monsterName:"ãƒ­ãƒ¼ã‚¬ãƒ¼ãƒ‡ã‚£ã‚¢ãƒ³"},{spellName:"ã‚¹ã‚«ãƒ«ãƒ©ã‚¤ãƒ€ãƒ¼ã®å¾©æ´»",monsterName:"ã‚¹ã‚«ãƒ«ãƒ©ã‚¤ãƒ€ãƒ¼"},{spellName:"è¸Šã‚Šã«ã‚ˆã‚‹èª˜ç™º",monsterName:"ãƒ€ãƒ³ã‚·ãƒ³ã‚°ãƒ»ã‚½ãƒ«ã‚¸ãƒ£ãƒ¼"},{spellName:"æ‚ªé­”é¡ã®å„€å¼",monsterName:"ãƒ‡ãƒ“ãƒ«ã‚ºãƒ»ãƒŸãƒ©ãƒ¼"},{spellName:"ãƒãƒ³ãƒãƒ¼ã‚¬ãƒ¼ã®ãƒ¬ã‚·ãƒ”",monsterName:"ãƒãƒ³ã‚°ãƒªãƒ¼ãƒãƒ¼ã‚¬ãƒ¼"}])yield{name:e.spellName,actions:[{title:"ç™ºå‹•",isMandatory:!1,playType:"CardActivation",spellSpeed:"Normal",executableCells:["Hand","SpellAndTrapZone"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],...Ip(["Hand"],t=>t.nm===e.monsterName,["Hand","MonsterZone","ExtraMonsterZone"],()=>!0,"OrMore")},E]}}const Ws=Object.freeze(Object.defineProperty({__proto__:null,default:ef},Symbol.toStringTag,{value:"Module"}));function*tf(){for(const e of["å¤§åœ°ã®é¨Žå£«ã‚¬ã‚¤ã‚¢ãƒŠã‚¤ãƒˆ","ã‚¹ã‚¯ãƒ©ãƒƒãƒ—ãƒ»ãƒ‡ã‚¹ãƒ‡ãƒ¼ãƒ¢ãƒ³"])yield{name:e,actions:[be()]};yield{name:"ãƒŠãƒãƒ¥ãƒ«ãƒ»ã‚¬ã‚ªãƒ‰ãƒ¬ã‚¤ã‚¯",actions:[be(e=>e.length===1&&e.every(t=>t.attr.some(a=>a==="Earth")),e=>e.length>0&&e.every(t=>t.attr.some(a=>a==="Earth")))]},yield{name:"ãƒžã‚¸ã‚«ãƒ«ãƒ»ã‚¢ãƒ³ãƒ‰ãƒ­ã‚¤ãƒ‰",actions:[be(),{title:"å›žå¾©",isMandatory:!0,playType:"IgnitionEffect",spellSpeed:"Normal",executableCells:["MonsterZone","ExtraMonsterZone"],executablePeriods:["end"],executableDuelistTypes:["Controller"],executableFaces:["FaceUp"],isOnlyNTimesPerTurnIfFaceup:1,meetsConditions:e=>e.activator.isTurnPlayer&&e.action.entity.face==="FaceUp",prepare:m,execute:async e=>(e.activator.heal(e.activator.getMonstersOnField().filter(t=>t.face==="FaceUp").filter(t=>t.types.includes("Psychic")).length*600,e.action.entity),!0),settle:async()=>!0}]}}const Xs=Object.freeze(Object.defineProperty({__proto__:null,default:tf},Symbol.toStringTag,{value:"Module"}));function*af(){yield{name:"ã«ã›ã‚¢ãƒã‚¿ãƒ¼",actions:[],continuousEffects:[ka("THE_DEVILS_AVATAR","Monster",e=>[e],e=>["attack","defense"].map(t=>I.createContinuous("THE_DEVILS_AVATAR",a=>a.isSpawnedBy.isOnFieldStrictly&&a.isSpawnedBy.face==="FaceUp",e,(a,i)=>i.isOnFieldStrictly&&i.face==="FaceUp",t,"calculated","THE_DEVILS_AVATAR",()=>Number.MIN_VALUE)))]},yield{name:"ã«ã›ãƒ‰ãƒ¬ãƒƒãƒ‰ãƒ»ãƒ«ãƒ¼ãƒˆ",actions:[],continuousEffects:[Ka("THE_DEVILS_DREAD-ROOT","Monster",e=>["attack","defense"].map(t=>I.createContinuous("THE_DEVILS_DREAD-ROOT",a=>a.isSpawnedBy.isOnFieldStrictly&&a.isSpawnedBy.face==="FaceUp",e,(a,i)=>i.isMonster&&i.isOnFieldStrictly&&i.face==="FaceUp"&&i!==a.isSpawnedBy,t,"calculated","THE_DEVILS_DREAD-ROOT",(a,i,r)=>Math.round(r/2))))]}}const Ks=Object.freeze(Object.defineProperty({__proto__:null,default:af},Symbol.toStringTag,{value:"Module"})),rf=(e,t,a,i,r,n)=>{const s=e.fusionMaterialInfos.filter(c=>c.type!=="Overmuch");if(!s.length||!r.length||s.length!==r.length||!n(t,e,r)||!e.validateFusionMaterials(r))return;const l=s.map(c=>{const d=[];return yt(c)?d.push(...r.filter(p=>c.cardName===p.nm||p.status.fusionSubstitute)):d.push(...r.filter(c.filter)),{require:c,materials:d}});if(l.some(c=>!c.materials.length)||l.flatMap(c=>c.materials).getDistinct().length<r.length)return;let o=[[]];for(const c of l)o=[...o.flatMap(d=>c.materials.map(p=>{if(d.some(h=>h.material===p))return[...d];const f={material:p,cell:p.cell};return yt(c.require)&&(f.name=c.require.cardName),[...d,f]}))];return o=o.filter(c=>c.length===r.length).filter(c=>c.filter(d=>d.name&&d.material.nm!==d.name).length<2),o.find(c=>t.activator.getEnableSummonList(t.activator,"FusionSummon",["Effect","SpecialSummon"],t.action,[{monster:t.action.entity,posList:a,cells:i}],c,!1).length)},Ys=(e,t,a={})=>{const i=e.activator.getCells(...t).flatMap(r=>r.cardEntities).filter(r=>r.isMonster).filter(r=>r.face==="FaceUp"||r.cell.cellType!=="Banished").filter(r=>r.canBeEffected(e.activator,e.action.entity,e.action));return a.requisitionFrom&&i.push(...e.activator.getOpponentPlayer().getCells(...a.requisitionFrom).flatMap(r=>r.cardEntities).filter(r=>r.isMonster).filter(r=>r.face==="FaceUp").filter(r=>r.canBeEffected(e.activator,e.action.entity,e.action))),i.filter(r=>{let n=r.cell.cellType==="Graveyard"?"Banished":"Graveyard";if(a.materialDestMapper){const s=a.materialDestMapper[r.cell.cellType];s&&(n=s.to??n)}return n!=="Banished"||r.canBeBanished("BanishAsEffect",e.activator,e.action.entity,e.action)})};function*Js(e,...t){const[a,i,r,n,s]=t,l=e.activator.getCells(...a).flatMap(p=>p.cardEntities).filter(p=>{var f;return(f=p.status.monsterCategories)==null?void 0:f.includes("Fusion")}).filter(p=>i(e,p));if(!l.length)return;const o=Ys(e,r,s);if(!o.length)return;const c=[...e.activator.getMonsterZones(),...e.activator.duel.field.getCells("ExtraMonsterZone")],d=T;for(const p of l){const f=p.fusionMaterialInfos.filter(_=>_.type!=="Overmuch");if(!f.length)continue;const h=f.filter(yt),y=f.filter(Ag),v=h.length>0,g=o.filter(_=>_!==p).filter(_=>_.status.fusionSubstitute&&v||h.some(w=>w.cardName===_.nm)||y.some(w=>w.filter(_)));if(!(g.length<f.length))for(const _ of g.getAllOnOffPattern(f.length,f.length)){const w=rf(p,e,d,c,_,n);w&&(yield{monster:p,materialInfos:w})}}}const nf=async(e,...t)=>{var y;const[,,a,,i]=t,r=Js(e,...t).toArray(),n=r.map(v=>v.monster).getDistinct(),s=await e.activator.waitSelectEntity(n,"èžåˆå¬å–šã™ã‚‹ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã‚’é¸æŠžã€‚");if(!s)throw new N(e,...t);const l=r.filter(v=>v.monster===s).map(v=>v.materialInfos);let o=l.flatMap(v=>v.map(g=>g.material)).getDistinct();const c=s.fusionMaterialInfos.filter(Mg);c.length&&(o=[...o,...Ys(e,a,i)].getDistinct());const d=l.map(v=>({infos:v,requiredSeqList:v.map(g=>g.material.seq)}));let p=l[0].map(v=>v.material);(l.length>1||c.length)&&(p=await e.activator.waitSelectEntities(o,void 0,v=>d.some(g=>g.requiredSeqList.every(_=>v.map(w=>w.seq).includes(_))&&v.filter(_=>!g.requiredSeqList.includes(_.seq)).every(_=>c.some(w=>w.filter(_)))),"èžåˆç´ æã¨ã™ã‚‹ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã‚’é¸æŠž",!1)??p);const f=d.find(v=>v.requiredSeqList.every(g=>p.map(_=>_.seq).includes(g))&&p.filter(g=>!v.requiredSeqList.includes(g.seq)).every(g=>c.some(_=>_.filter(g))));if(!f)throw new P("UnexpectedSituation",e);const h=f.infos;return h.push(...p.filter(v=>!f.requiredSeqList.includes(v.seq)).map(v=>({material:v,cell:v.cell}))),await L.moveMany(p.map(v=>{let g=v.cell.cellType==="Graveyard"?"Banished":"Graveyard",_=Ur[g],w=$r[g];if(i.materialDestMapper){const b=i.materialDestMapper[v.cell.cellType];b&&(g=b.to??g,_=(b==null?void 0:b.position)??Ur[g],w=(b==null?void 0:b.face)??$r[g])}const D=s.field.getCells(g).filter(b=>b.owner===e.activator)[0];return{entity:v,to:D,position:_,kind:v.origin.kind,face:w,orientation:"Vertical",pos:_,movedAs:["Effect","FusionMaterial"],movedBy:e.action.entity,actionOwner:e.activator,chooser:void 0}})),await e.activator.summon("FusionSummon",["Effect","SpecialSummon"],e.action,s,T,[...e.activator.getMonsterZones(),...e.activator.duel.field.getCells("ExtraMonsterZone")],h,!1),s.info.isRebornable=!((y=s.origin.monsterCategories)!=null&&y.includes("RegularSpecialSummonOnly")),h.map(v=>v.material).forEach(v=>v.onUsedAsMaterial(e,e.action.entity)),!0},aa=(e,t,a,i,r={})=>({fixedTags:["SpecialSummonFromExtraDeck"],canExecute:n=>Js(n,e,t,a,i,r).some(s=>s.materialInfos.length),prepare:m,execute:n=>nf(n,e,t,a,i,r),settle:async()=>!0});function*sf(){{const e=["Hand","MonsterZone","ExtraMonsterZone","Deck","ExtraDeck","Graveyard"],t=e.reduce((a,i)=>(a[i]={to:"Banished"},a),{});yield{name:"ã«ã›èžåˆ",actions:[{title:"ç™ºå‹•",isMandatory:!1,playType:"CardActivation",spellSpeed:"Normal",executableCells:["Hand","SpellAndTrapZone"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],...aa(["ExtraDeck"],()=>!0,e,()=>!0,{materialDestMapper:t})},E]}}yield{name:"ã«ã›ã‚¹ãƒˆãƒ¼ãƒ ã‚¢ã‚¯ã‚»ã‚¹",actions:[{title:"ç™ºå‹•",isMandatory:!1,playType:"CardActivation",spellSpeed:"Normal",executableCells:["Hand","SpellAndTrapZone"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],fixedTags:["SpecialSummonFromExtraDeck"],canExecute:e=>e.activator.getExtraDeck().cardEntities.some(t=>{var a;return(a=t.status.monsterCategories)==null?void 0:a.includes("Link")})&&(e.activator.getAvailableExtraMonsterZones().length>0||e.activator.getEmptyMonsterZones().some(t=>t.linkArrowSources.length)),prepare:m,execute:async e=>{const t=[...e.activator.getAvailableExtraMonsterZones(),...e.activator.getEmptyMonsterZones().filter(i=>i.linkArrowSources.length)];if(!t.length)return!1;const a=e.activator.getExtraDeck().cardEntities.filter(i=>{var r;return(r=i.status.monsterCategories)==null?void 0:r.includes("Link")});return a.length?(await e.activator.summonOne(e.activator,"LinkSummon",["Effect"],e.action,a.map(i=>({monster:i,cells:t,posList:["Attack"]})),[],!0,!1),!0):!1},settle:async()=>!0},{title:"å›žåŽ",isMandatory:!1,playType:"IgnitionEffect",spellSpeed:"Normal",executableCells:["Graveyard"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],fixedTags:["AddToHandFromGraveyard"],prepare:m,execute:async e=>(await e.action.entity.addToHand(["Effect"],e.action.entity,e.activator),!0),settle:async()=>!0},E]}}const Is=Object.freeze(Object.defineProperty({__proto__:null,default:sf},Symbol.toStringTag,{value:"Module"})),lf=(e,t,a,i,r=2,n=2,s)=>{if(!e.action.entity.origin.rank||i.length<r||i.length>n||i.some(o=>!o.lvl)||i.some(o=>o.lvl!==e.action.entity.rank)||!s(i))return;const l=i.map(o=>({material:o,cell:o.cell,level:o.status.level}));if(e.activator.getEnableSummonList(e.activator,"XyzSummon",["Rule","XyzSummon","SpecialSummon"],e.action,[{monster:e.action.entity,posList:t,cells:a}],l,!1).length)return l};function*of(e,t=2,a=2,i=r=>r.length>1){const r=e.activator.getMonstersOnField().filter(s=>s.battlePosition!=="Set");if(r.length<t)return;const n=[...e.activator.getMonsterZones(),...e.activator.getAvailableExtraMonsterZones()];yield*r.getAllOnOffPattern().filter(s=>s.length>=t).filter(s=>s.length<=a).map(s=>lf(e,T,n,s,t,a,i)??[]).filter(s=>s.length)}const cf=async(e,t,a)=>{var o;const i=e.action.getEnableMaterialPatterns(e).toArray(),r=i.map(c=>({infos:c,materialSeqList:c.map(d=>d.material.seq).sort()}));let n=i[0].map(c=>c.material);if(i.length>1){const c=i.flatMap(p=>p.map(f=>f.material)).getDistinct(),d=await e.activator.waitSelectEntities(c,void 0,p=>{const f=p.map(h=>h.seq).sort();return r.some(h=>f.length===h.materialSeqList.length&&f.every((y,v)=>y===h.materialSeqList[v]))},"ã‚¨ã‚¯ã‚·ãƒ¼ã‚ºç´ æã¨ã™ã‚‹ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã‚’é¸æŠž",a);if(!d)return;n=d}const s=n.map(c=>c.seq).sort(),l=(o=r.find(c=>s.length===c.materialSeqList.length&&s.every((d,p)=>d===c.materialSeqList[p])))==null?void 0:o.infos;if(!l)throw new P("UnexpectedSituation",e,n);return await S.convertManyToXyzMaterials(l.map(c=>c.material),["XyzMaterial","Rule","Cost"],e.action.entity,e.activator),{summonMaterialInfos:l}},el=(e=2,t=2,a=i=>i.length>1)=>({title:"ã‚¨ã‚¯ã‚·ãƒ¼ã‚ºå¬å–š",isMandatory:!1,playType:"SpecialSummon",spellSpeed:"Normal",executableCells:["ExtraDeck"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],getEnableMaterialPatterns:i=>of(i,e,t,a),canPayCosts:i=>i.action.getEnableMaterialPatterns(i).some(r=>r.length),canExecute:i=>!i.ignoreCosts||i.activator.getAvailableExtraMonsterZones().length+i.activator.getAvailableMonsterZones().length>0,payCosts:cf,prepare:i=>Je(i,"XyzSummon",["Rule","SpecialSummon","XyzSummon"],["Attack","Defense"]),execute:Ie,settle:async()=>!0}),uf=(e=1,t=1,a=()=>!0)=>({canPayCosts:(...i)=>{const[r]=i;return r.action.entity.getXyzMaterials().filter(n=>a(...i,n)).length>=e},payCosts:async(i,r,n)=>{const s=i.action.entity.getXyzMaterials().filter(c=>a(i,r,c));let l=s.slice(0,e);if(s.length>e){const c=e===t?e:void 0,d=await i.activator.waitSelectEntities(s,c,p=>p.length>=e&&p.length<=t,"ã‚³ã‚¹ãƒˆã¨ã™ã‚‹XYZç´ æã‚’é¸æŠž",n);if(!d)return;l=d}const o=l.map(c=>({cost:c,cell:c.cell}));return await S.sendManyToGraveyardForTheSameReason(l,["Cost"],i.action.entity,i.activator),{xyzMaterial:o}}});function*df(){yield*[{name:"ã‚¸ã‚§ãƒ ãƒŠã‚¤ãƒˆãƒ»ãƒ‘ãƒ¼ãƒ«",qty:2},{name:"è¦šé†’ã®å‹‡å£« ã‚¬ã‚¬ã‚®ã‚´",qty:3}].map(e=>({name:e.name,actions:[el(e.qty,e.qty)]}))}const tl=Object.freeze(Object.defineProperty({__proto__:null,default:df},Symbol.toStringTag,{value:"Module"}));function*pf(){yield{name:"ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ãƒ»ãƒ©ã‚¤ã‚¶ãƒ¼ãƒ»ãƒ‰ãƒ©ã‚´ãƒ³",actions:[be(),{title:"â‘ å¢“åœ°é€ã‚Š",isMandatory:!1,playType:"TriggerEffect",spellSpeed:"Normal",executableCells:x,executablePeriods:[...C,...M],executableDuelistTypes:["Controller"],triggerPattern:{triggerType:"Arrival",arrivalReasons:["SynchroSummon"]},fixedTags:["SendToGraveyardFromDeck","IfSpecialSummonSucceed"],isOnlyNTimesPerTurn:1,canExecute:e=>e.activator.getDeckCell().cardEntities.some(t=>(t.lvl??12)<(e.action.entity.lvl??0)),prepare:m,execute:async e=>{const t=e.activator.getDeckCell().cardEntities.filter(r=>(r.lvl??12)<(e.action.entity.lvl??0));if(t.length===0)return!1;const a=await e.activator.waitSelectEntity(t,"å¢“åœ°ã«é€ã‚‹ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã‚’é¸æŠž",!1);if(!a)throw new P("UnexpectedSituation",e);await a.sendToGraveyard(["Effect"],e.action.entity,e.activator);const i=a.lvl??0;return e.action.entity.numericOprsBundle.push(I.createLingeringAddition("ãƒ¬ãƒ™ãƒ«æ¸›å°‘",()=>!0,e.action.entity,e.action,"level",(r,n,s)=>s-i)),!0},settle:async()=>!0},xs({title:"â‘¡ã‚·ãƒ³ã‚¯ãƒ­å¬å–š",isOnlyNTimesPerChain:1})]}}const al=Object.freeze(Object.defineProperty({__proto__:null,default:pf},Symbol.toStringTag,{value:"Module"})),il=(e,t,a,i)=>{const r=n=>a(n,e);return i.getAllPatterns(e.activator.getCells(...t).flatMap(n=>n.cardEntities).filter(r).filter(n=>n.entityType!=="Token").filter(n=>e.activator.canSendToGraveyard([n]))).some(()=>!0)},rl=async(e,t,a,i,r,n)=>{const s=f=>r(f,e),l=e.activator.getCells(...i).flatMap(f=>f.cardEntities).filter(s).filter(f=>f.entityType!=="Token").filter(f=>e.activator.canSendToGraveyard([f])),o=[];for(const f of n.getAllPatterns(l))if(o.push(...f.filter(h=>!o.includes(h))),o.length===l.length)break;const c=n.qty;let d;if(o.length===c?d=o:d=await e.activator.waitSelectEntities(o,c,f=>n.validatePattern(f),"ã‚³ã‚¹ãƒˆã¨ã—ã¦å¢“åœ°ã«é€ã‚‹ã‚«ãƒ¼ãƒ‰ã‚’é¸æŠžã€‚",a),!d)return;const p=d.map(f=>({cost:f,cell:f.cell}));return await S.sendManyToGraveyardForTheSameReason(d,["Cost"],e.action.entity,e.activator),{sendToGraveyard:p}},nl=(e,t,...a)=>{const i=et.create(...a);return{canPayCosts:(...r)=>il(r[0],e,t,i),payCosts:(...r)=>rl(...r,e,t,i)}},sl=()=>{const e=et.create(1),t=["Hand",...me];return{canPayCosts:(...a)=>il(a[0],t,i=>a[0].action.entity===i,e),payCosts:(...a)=>rl(...a,t,i=>a[0].action.entity===i,e)}};function*ff(){yield{name:"ãƒ•ã‚§ãƒ‹ã‚­ã‚·ã‚¢ãƒ³ãƒ»ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ãƒ»ã‚¢ãƒžãƒªãƒªã‚¹",actions:[{title:"è‡ªçˆ†",isMandatory:!0,playType:"ContinuousPeriodAction",spellSpeed:"Normal",executableCells:["MonsterZone"],executablePeriods:["b1DAfterDmgCalc","b2DAfterDmgCalc"],executableDuelistTypes:["Controller"],meetsConditions:e=>e.activator.duel.attackingMonster===e.action.entity&&e.action.entity.isOnFieldAsMonsterStrictly,prepare:m,execute:async e=>e.action.entity.isOnFieldAsMonsterStrictly?(await S.tryDestroy([e.action.entity],e)).length>0:!1,settle:async()=>!0},{title:"ã‚¹ã‚­ãƒ£ãƒƒã‚¿ãƒ¼ãƒ»ãƒ•ãƒ¬ã‚¤ãƒ ",isMandatory:!0,playType:"TriggerEffect",spellSpeed:"Normal",executableCells:["Graveyard"],executablePeriods:ae,executableDuelistTypes:["Controller"],fixedTags:["DamageToOpponent"],triggerPattern:{triggerType:"Departure",needsByDestory:!0},prepare:m,execute:async e=>(e.activator.getOpponentPlayer().effectDamage(800,e),!0),settle:async()=>!0},{title:"è‡ªå·±å†ç”Ÿ",isMandatory:!1,playType:"IgnitionEffect",spellSpeed:"Normal",executableCells:["Graveyard"],executablePeriods:["end"],executableDuelistTypes:["Controller"],fixedTags:["SpecialSummonFromGraveyard"],isNoticedForcibly:!0,canPayCosts:e=>e.activator.getGraveyard().cardEntities.filter(t=>t.types.includes("Plant")).filter(t=>t.kind==="Monster").filter(t=>t!==e.action.entity).some(t=>t.canBeBanished("BanishAsCost",e.activator,e.action.entity,e.action)),getDests:e=>We(e,["Defense"],[],["Effect"]),canExecute:e=>e.activator.isTurnPlayer&&Q(e,["Defense"],[],["Effect"]),payCosts:async(e,t,a)=>{const i=e.activator.getGraveyard().cardEntities.filter(s=>s.types.includes("Plant")).filter(s=>s.kind==="Monster").filter(s=>s!==e.action.entity).filter(s=>s.canBeBanished("BanishAsCost",e.activator,e.action.entity,e.action)),r=await e.activator.waitSelectEntity(i,"ã‚³ã‚¹ãƒˆã¨ã—ã¦é™¤å¤–ã™ã‚‹ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã‚’é¸æŠžã€‚",a);if(!r)return;const n={cost:r,cell:r.cell};return await r.banish(["Cost"],e.action.entity,e.activator),{banish:[n]}},prepare:m,execute:(...e)=>ve(...e,["Defense"]),settle:async()=>!0}],summonFilter:(e,t,a,i,r,n,s,l,o,c)=>{const d={posList:o,cells:c},p={posList:[],cells:[]};return s!==t||n.entity===t||n.entity.origin.name==="ãƒ•ã‚§ãƒ‹ã‚­ã‚·ã‚¢ãƒ³ãƒ»ã‚·ãƒ¼ãƒ‰"?d:p}},yield{name:"ãƒ•ã‚§ãƒ‹ã‚­ã‚·ã‚¢ãƒ³ãƒ»ã‚·ãƒ¼ãƒ‰",actions:[{title:"é–‹èŠ±",isMandatory:!1,playType:"IgnitionEffect",spellSpeed:"Normal",executableCells:x,executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],executableFaces:["FaceUp"],fixedTags:["SpecialSummonFromHand"],...sl(),canExecute:e=>{const t=e.activator.getHandCell().cardEntities.filter(i=>i.nm==="ãƒ•ã‚§ãƒ‹ã‚­ã‚·ã‚¢ãƒ³ãƒ»ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ãƒ»ã‚¢ãƒžãƒªãƒªã‚¹");if(!t.length)return!1;const a=e.activator.getMonsterZones();return e.activator.getEnableSummonList(e.activator,"SpecialSummon",["Effect"],e.action,t.map(i=>({monster:i,posList:T,cells:a})),[{material:e.action.entity,cell:e.action.entity.cell}],!1).length>0},prepare:m,execute:async e=>{var i;const t=e.activator.getHandCell().cardEntities.filter(r=>r.nm==="ãƒ•ã‚§ãƒ‹ã‚­ã‚·ã‚¢ãƒ³ãƒ»ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ãƒ»ã‚¢ãƒžãƒªãƒªã‚¹");if(!t.length)return!1;const a=e.activator.getMonsterZones();return t.length?!!await e.activator.summonOne(e.activator,"SpecialSummon",["Effect"],e.action,t.map(r=>({monster:r,cells:a,posList:T})),((i=e.costInfo.sendToGraveyard)==null?void 0:i.map(r=>({material:r.cost,cell:r.cell})))??[],!1,!1):!1},settle:async()=>!0}]}}const ll=Object.freeze(Object.defineProperty({__proto__:null,default:ff},Symbol.toStringTag,{value:"Module"}));function*gf(){for(const e of["å¿ƒçœ¼ã®å¥³ç¥ž","æ²¼åœ°ã®é­”ç£çŽ‹","ã‚¤ãƒªãƒ¥ãƒ¼ã‚¸ãƒ§ãƒ³ãƒ»ã‚·ãƒ¼ãƒ—","ç ´å£Šç¥ž ãƒ´ã‚¡ã‚µãƒ¼ã‚´"])yield{name:e,actions:[],continuousEffects:[Mi]};yield{name:"æ²¼åœ°ã®é­”ç¥žçŽ‹",actions:[{title:"èžåˆã‚µãƒ¼ãƒ",isMandatory:!1,playType:"IgnitionEffect",spellSpeed:"Normal",executableCells:["Hand"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],fixedTags:["SearchFromDeck"],...zp(),canExecute:e=>e.activator.getDeckCell().cardEntities.some(t=>t.nm==="èžåˆ")&&e.activator.canAddToHandFromDeck,getDests:e=>[e.activator.getGraveyard()],prepare:m,execute:async e=>{const t=e.activator.getDeckCell().cardEntities.filter(i=>i.nm==="èžåˆ");if(!t.length)return!1;const a=await e.activator.waitSelectEntity(t,"æ‰‹æœ­ã«åŠ ãˆã‚‹ã‚«ãƒ¼ãƒ‰ã‚’é¸æŠž",!1);return a?(await a.addToHand(["Effect"],e.action.entity,e.activator),e.activator.getDeckCell().shuffle(),!0):!1},settle:async()=>!0}],continuousEffects:[Mi]},yield{name:"ãƒ‘ãƒ©ã‚µã‚¤ãƒˆãƒ»ãƒ•ãƒ¥ãƒ¼ã‚¸ãƒ§ãƒŠãƒ¼",actions:[{title:"èžåˆ",isMandatory:!1,playType:"TriggerEffect",spellSpeed:"Normal",executableCells:["MonsterZone"],executablePeriods:C,executableDuelistTypes:["Controller"],triggerPattern:{triggerType:"Arrival",arrivalReasons:["SpecialSummon"]},...aa(["ExtraDeck"],()=>!0,["MonsterZone","ExtraMonsterZone"],(e,t,a)=>a.includes(e.action.entity)),settle:async()=>!0}],summonFilter:(e,t,a,i,r,n,s,l,o,c)=>{const d={posList:o,cells:c},p={posList:[],cells:[]};if(!r.includes("FusionSummon"))return d;const f=l.find(h=>h.material===e.isSpawnedBy);return f?f.name&&f.name!==e.isSpawnedBy.nm?d:p:d},continuousEffects:[Mi]}}const ol=Object.freeze(Object.defineProperty({__proto__:null,default:gf},Symbol.toStringTag,{value:"Module"}));function*hf(){yield{name:"é­”å°Žã‚µã‚¤ã‚¨ãƒ³ãƒ†ã‚£ã‚¹ãƒˆ",actions:[{title:"ç‰¹æ®Šå¬å–š",isMandatory:!1,playType:"IgnitionEffect",spellSpeed:"Normal",executableCells:["MonsterZone"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],executableFaces:["FaceUp"],fixedTags:["SpecialSummonFromExtraDeck"],canPayCosts:e=>e.activator.lp>=1e3,canExecute:e=>{const t=e.activator.getMonsterZones();return e.activator.getEnableSummonList(e.activator,"SpecialSummon",["Effect"],e.action,e.activator.getExtraDeck().cardEntities.filter(i=>{var r;return(r=i.status.monsterCategories)==null?void 0:r.includes("Fusion")}).filter(i=>i.lvl&&i.lvl<7).map(i=>({monster:i,posList:T,cells:t})),[],!1).length>0},payCosts:(e,t)=>ea(e,t,1e3),prepare:m,execute:async e=>{const t=e.activator.getMonsterZones(),a=await e.activator.summonOne(e.activator,"SpecialSummon",["Effect"],e.action,e.activator.getExtraDeck().cardEntities.filter(i=>{var r;return(r=i.status.monsterCategories)==null?void 0:r.includes("Fusion")}).filter(i=>i.lvl&&i.lvl<7).map(i=>({monster:i,posList:T,cells:t})),[],!1,!1);return a?(a.procFilterBundle.push(we.createLingering("ç›´æŽ¥æ”»æ’ƒä¸å¯",()=>!0,e.action.entity,e.action,(i,r)=>r.face==="FaceUp"&&r.isOnFieldAsMonsterStrictly,["BattleTarget"],(i,r,n,s,l)=>i!==n?!0:l.every(o=>o.entityType!=="Duelist"))),a.counterHolder.setCurfewFlg(e.action.entity),!0):!1},settle:async()=>!0},{title:"è‡ªç™ºå¸°é‚„",isMandatory:!0,playType:"LingeringEffect",spellSpeed:"Normal",executableCells:Ke,executablePeriods:["end"],executableDuelistTypes:Qt,canExecute:e=>e.action.entity.field.getMonstersOnFieldStrictly().some(t=>t.counterHolder.getCurfewFlg(e.action.entity)),prepare:m,execute:async e=>{const t=e.action.entity.field.getMonstersOnFieldStrictly().filter(i=>i.counterHolder.getCurfewFlg(e.action.entity));if(!t.length)throw new P("UnexpectedSituation",e);let a=t[0];if(t.length>1){const i=await e.activator.waitSelectEntity(t,"å¸°é‚„ã•ã›ã‚‹ã‚«ãƒ¼ãƒ‰ã‚’é¸æŠžã€‚",!1);if(!i)throw new N(e);a=i}return await a.returnToDeck("Bottom",["Effect"],e.action.entity,e.activator),!0},settle:async()=>!0}]}}const cl=Object.freeze(Object.defineProperty({__proto__:null,default:hf},Symbol.toStringTag,{value:"Module"}));function*yf(){for(const e of[{name:"ãƒžãƒ³ã‚¸ãƒ¥ãƒ»ã‚´ãƒƒãƒ‰",kinds:["Monster","Spell"]},{name:"ã‚»ãƒ³ã‚¸ãƒ¥ãƒ»ã‚´ãƒƒãƒ‰",kinds:["Monster"]},{name:"ã‚½ãƒ‹ãƒƒã‚¯ãƒãƒ¼ãƒ‰",kinds:["Spell"]}])yield{name:e.name,actions:[{title:"â‘ å„€å¼ã‚µãƒ¼ãƒ",isMandatory:!1,playType:"TriggerEffect",spellSpeed:"Normal",executableCells:["MonsterZone"],executablePeriods:C,executableDuelistTypes:["Controller"],fixedTags:["SearchFromDeck"],meetsConditions:t=>t.action.entity.hasBeenArrivalNow(["NormalSummon","FlipSummon"]),canExecute:t=>t.activator.canAddToHandFromDeck&&t.activator.getDeckCell().cardEntities.filter(a=>e.kinds.includes(a.kind)).some(a=>{var i;return a.status.spellCategory==="Ritual"||((i=a.status.monsterCategories)==null?void 0:i.includes("Ritual"))}),prepare:m,execute:async t=>{if(!t.activator.canAddToHandFromDeck)return!1;const a=t.activator.getDeckCell().cardEntities.filter(r=>e.kinds.includes(r.kind)).filter(r=>{var n;return r.status.spellCategory==="Ritual"||((n=r.status.monsterCategories)==null?void 0:n.includes("Ritual"))});if(!a.length)return!1;const i=await t.activator.waitSelectEntity(a,"æ‰‹æœ­ã«åŠ ãˆã‚‹ã‚«ãƒ¼ãƒ‰ã‚’é¸æŠž",!1);if(!i)throw new N(t,a);return await i.addToHand(["Effect"],t.action.entity,t.activator),t.activator.getDeckCell().shuffle(),!0},settle:async()=>!0}]}}const ul=Object.freeze(Object.defineProperty({__proto__:null,default:yf},Symbol.toStringTag,{value:"Module"}));function*vf(){yield{name:"å„€å¼ã®æº–å‚™",actions:[{title:"ç™ºå‹•",isMandatory:!1,playType:"CardActivation",spellSpeed:"Normal",executableCells:["Hand","SpellAndTrapZone"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],fixedTags:["SearchFromDeck","ReturnToHandFromGraveyard"],canExecute:e=>e.activator.getDeckCell().cardEntities.filter(t=>{var a;return(a=t.status.monsterCategories)==null?void 0:a.includes("Ritual")}).some(t=>t.lvl&&t.lvl<8)&&e.activator.canAddToHandFromDeck,prepare:m,execute:async e=>{if(!e.activator.canAddToHandFromDeck)return!1;const t=e.activator.getDeckCell().cardEntities.filter(n=>{var s;return(s=n.status.monsterCategories)==null?void 0:s.includes("Ritual")}).filter(n=>n.lvl&&n.lvl<8);if(!t.length)return!1;const a=await e.activator.waitSelectEntity(t,"æ‰‹æœ­ã«åŠ ãˆã‚‹ã‚«ãƒ¼ãƒ‰ã‚’é¸æŠž",!1);if(!a)return!1;if(await a.addToHand(["Effect"],e.action.entity,e.activator),e.activator.getDeckCell().shuffle(),!e.activator.canAddToHandFromGraveyard)return!0;const i=e.activator.getGraveyard().cardEntities.filter(n=>n.status.spellCategory==="Ritual");if(i.length===1&&!await e.activator.waitYesNo("å„€å¼ã‚«ãƒ¼ãƒ‰ã‚’ã‚µãƒ«ãƒ™ãƒ¼ã‚¸ã™ã‚‹ï¼Ÿ"))return!0;const r=await e.activator.waitSelectEntity(i,"æ‰‹æœ­ã«åŠ ãˆã‚‹ã‚«ãƒ¼ãƒ‰ã‚’é¸æŠž",!0);return r&&(await e.activator.duel.clock.incrementProcSeq(),await r.addToHand(["Effect"],e.action.entity,e.activator)),!0},settle:async()=>!0},E]},yield{name:"å„€å¼ã®ä¸‹æº–å‚™",actions:[{title:"ç™ºå‹•",isMandatory:!1,playType:"CardActivation",spellSpeed:"Normal",executableCells:["Hand","SpellAndTrapZone"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],isOnlyNTimesPerTurn:1,fixedTags:["SearchFromDeck","ReturnToHandFromGraveyard"],canExecute:e=>{if(!e.activator.canAddToHandFromDeck)return!1;const t=e.activator.getDeckCell().cardEntities.filter(i=>i.status.spellCategory==="Ritual").flatMap(i=>i.status.textTags??[]),a=["Deck"];return e.activator.canAddToHandFromGraveyard&&a.push("Graveyard"),e.activator.getCells(...a).flatMap(i=>i.cardEntities).filter(i=>{var r;return(r=i.status.monsterCategories)==null?void 0:r.includes("Ritual")}).some(i=>t.includes(i.nm))},prepare:m,execute:async e=>{if(!e.activator.canAddToHandFromDeck)return!1;let t=e.activator.getDeckCell().cardEntities.filter(l=>l.status.spellCategory==="Ritual").flatMap(l=>l.status.textTags??[]);if(!t.length)return!1;const a=["Deck"];if(e.activator.canAddToHandFromGraveyard&&a.push("Graveyard"),t=e.activator.getCells(...a).flatMap(l=>l.cardEntities).filter(l=>{var o;return(o=l.status.monsterCategories)==null?void 0:o.includes("Ritual")}).filter(l=>t.includes(l.nm)).map(l=>l.nm),!t.length)return!1;const i=e.activator.getDeckCell().cardEntities.filter(l=>l.status.spellCategory==="Ritual").filter(l=>l.status.textTags&&l.status.textTags.union(t).length);if(!i.length)return!1;const r=await e.activator.waitSelectEntity(i,"æ‰‹æœ­ã«åŠ ãˆã‚‹ã‚«ãƒ¼ãƒ‰ã‚’é¸æŠž",!1);if(!r)throw new N(e);const n=e.activator.getCells(...a).flatMap(l=>l.cardEntities).filter(l=>{var o;return(o=l.status.monsterCategories)==null?void 0:o.includes("Ritual")}).filter(l=>{var o;return(o=r.status.textTags)==null?void 0:o.includes(l.nm)});if(!n.length)throw new P("UnexpectedSituation",e,r,r.status.textTags);const s=await e.activator.waitSelectEntity(n,"æ‰‹æœ­ã«åŠ ãˆã‚‹ã‚«ãƒ¼ãƒ‰ã‚’é¸æŠž",!1);if(!s)throw new N(e,i);return await S.addManyToHand([r,s],["Effect"],e.action.entity,e.activator),e.activator.getDeckCell().shuffle(),!0},settle:async()=>!0},E]}}const dl=Object.freeze(Object.defineProperty({__proto__:null,default:vf},Symbol.toStringTag,{value:"Module"}));function*mf(){yield{name:"ã‚¢ãƒ­ãƒžã‚»ãƒ©ãƒ•ã‚£ï¼ã‚¸ãƒ£ã‚¹ãƒŸãƒ³",actions:[Ze(e=>e.length===2&&e.every(t=>t.types.includes("Plant"))),{title:"â‘¡ãƒªã‚¯ãƒ«ãƒ¼ãƒˆ",isMandatory:!1,playType:"IgnitionEffect",spellSpeed:"Normal",executableCells:x,executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],executableFaces:["FaceUp"],isOnlyNTimesPerTurn:1,fixedTags:["SpecialSummonFromDeck"],canPayCosts:e=>e.action.entity.pointedToEntities.some(t=>t.canBeReleased(e.activator,e.action.entity,["ReleaseAsCost"],e.action)),canExecute:e=>{const t=e.action.entity.pointedToEntities.filter(r=>r.canBeReleased(e.activator,e.action.entity,["ReleaseAsCost"],e.action));if(!t.length)return!1;const a=e.activator.getDeckCell().cardEntities.filter(r=>r.kind==="Monster").filter(r=>r.types.includes("Plant"));if(!a.length)return!1;const i=e.activator.getMonsterZones();return t.some(r=>e.activator.getEnableSummonList(e.activator,"SpecialSummon",["Effect"],e.action,a.map(s=>({monster:s,posList:["Defense"],cells:i})),[{material:r,cell:r.cell}],!1).length>0)},payCosts:async(e,t,a)=>{const i=e.action.entity.pointedToEntities.filter(c=>c.canBeReleased(e.activator,e.action.entity,["ReleaseAsCost"],e.action));if(!i.length)throw new P("UnexpectedSituation",e);const r=e.activator.getDeckCell().cardEntities.filter(c=>c.kind==="Monster").filter(c=>c.types.includes("Plant"));if(!r.length)throw new P("UnexpectedSituation",e);const n=e.activator.getMonsterZones(),s=i.map(c=>({cost:c,list:e.activator.getEnableSummonList(e.activator,"SpecialSummon",["Effect"],e.action,r.map(d=>({monster:d,posList:["Defense"],cells:n})),[{material:c,cell:c.cell}],!1)})).filter(c=>c.list.length),l=await e.activator.waitSelectEntity(s.map(c=>c.cost),"ãƒªãƒªãƒ¼ã‚¹ã™ã‚‹ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã‚’é¸æŠžã€‚",a);if(!l&&!a)throw new N(e);if(!l)return;const o={cost:l,cell:l.cell};return await l.release(["Cost"],e.action.entity,e.activator),{release:[o]}},prepare:m,execute:async e=>{const t=e.activator.getDeckCell().cardEntities.filter(r=>r.kind==="Monster").filter(r=>r.types.includes("Plant")),a=e.activator.getMonsterZones();return await e.activator.summonOne(e.activator,"SpecialSummon",["Effect"],e.action,t.map(r=>({monster:r,posList:["Defense"],cells:a})),(e.costInfo.release??[]).map(r=>({material:r.cost,cell:r.cell})),!1,!1)?(e.activator.getDeckCell().shuffle(),!0):!1},settle:async()=>!0},{title:"â‘¢ã‚µãƒ¼ãƒ",isMandatory:!0,playType:"TriggerEffect",spellSpeed:"Normal",executableCells:x,executablePeriods:ae,executableDuelistTypes:["Controller"],isOnlyNTimesPerTurnIfFaceup:1,fixedTags:["SearchFromDeck"],meetsConditions:e=>{var i;if(!e.action.entity.isOnFieldAsMonsterStrictly)return!1;console.log(e.action.entity.controller.previousHealedRecord);const t=(i=e.action.entity.controller.previousHealedRecord)==null?void 0:i.clock;if(!t||(console.log(t),!e.activator.duel.clock.isPreviousChain(t)))return!1;console.log(t);const a=e.action.entity.hadArrivedToFieldAt();return console.log(a),a?t.totalProcSeq>a.totalProcSeq:!1},canExecute:e=>e.activator.getDeckCell().cardEntities.filter(t=>t.kind==="Monster").some(t=>t.types.includes("Plant"))&&e.activator.canAddToHandFromDeck,prepare:m,execute:async e=>{const t=e.activator.getDeckCell().cardEntities.filter(i=>i.kind==="Monster").filter(i=>i.types.includes("Plant"));if(!t.length)return!1;const a=await e.activator.waitSelectEntity(t,"æ‰‹æœ­ã«åŠ ãˆã‚‹ã‚«ãƒ¼ãƒ‰ã‚’é¸æŠž",!1);return a?(await a.addToHand(["Effect"],e.action.entity,e.activator),e.activator.getDeckCell().shuffle(),!0):!1},settle:async()=>!0}],continuousEffects:[gr("â‘¢æˆ¦é—˜ç ´å£Šè€æ€§","Monster",e=>[we.createContinuous("â‘¢æˆ¦é—˜ç ´å£Šè€æ€§",t=>t.isSpawnedBy.isOnFieldStrictly&&t.isEffective,e,(t,a)=>t.isSpawnedBy===a||t.isSpawnedBy.pointedToEntities.includes(a),["BattleDestroy"],t=>t.controller.lp<=t.controller.getOpponentPlayer().lp?!0:(t.duel.log.info(`è‡ªåˆ†ã®LPãŒç›¸æ‰‹ã‚ˆã‚Šå¤šã„å ´åˆã€${e.toString()}ã¨ãã®ãƒªãƒ³ã‚¯å…ˆã®ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã¯æˆ¦é—˜ã§ã¯ç ´å£Šã•ã‚Œãªã„ã€‚`,e.controller),!1))])]}}const pl=Object.freeze(Object.defineProperty({__proto__:null,default:mf},Symbol.toStringTag,{value:"Module"}));function*_f(){yield{name:"æŠ˜ã‚Œç«¹å…‰",actions:[jt(),E]},yield{name:"å¦–åˆ€ç«¹å…‰",actions:[jt(),E,{title:"â‘¡ç›´æŽ¥æ”»æ’ƒä»˜ä¸Ž",isMandatory:!1,playType:"IgnitionEffect",spellSpeed:"Normal",executableCells:["SpellAndTrapZone"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],executableFaces:["FaceUp"],isOnlyNTimesPerTurn:1,...de(e=>e.activator.getSpellTrapsOnField().filter(t=>{var a;return(a=t.status.nameTags)==null?void 0:a.includes("ç«¹å…‰")}).filter(t=>t!==e.action.entity).filter(t=>t.status.spellCategory==="Equip"),{message:"æ‰‹æœ­ã«æˆ»ã™ã‚«ãƒ¼ãƒ‰ã‚’é¸æŠžã€‚",tags:["BounceToHand"]}),execute:async e=>{const t=e.action.entity.info.equipedBy;return t?(await S.returnManyToHandForTheSameReason(e.selectedEntities,["Effect"],e.action.entity,e.activator),t.statusOperatorBundle.push(new ee({title:"ç›´æŽ¥æ”»æ’ƒ",validateAlive:a=>a.duel.clock.isSameTurn(a.isSpawnedAt),isContinuous:!1,isSpawnedBy:e.action.entity,actionAttr:e.action,isApplicableTo:(a,i)=>i.isOnFieldAsMonsterStrictly&&i.face==="FaceUp",statusCalculator:()=>({canDirectAttack:!0})})),!0):!1},settle:async()=>!0},{title:"â‘¢ã‚µãƒ¼ãƒ",isMandatory:!1,playType:"TriggerEffect",spellSpeed:"Normal",executableCells:["Graveyard"],executablePeriods:[...C,...M],executableDuelistTypes:["Controller"],fixedTags:["SearchFromDeck"],meetsConditions:e=>e.action.entity.wasMovedAtPreviousChain&&e.action.entity.wasMovedFrom.cellType!=="Banished",canExecute:e=>e.activator.canAddToHandFromDeck&&e.activator.getDeckCell().cardEntities.filter(t=>{var a;return(a=t.status.nameTags)==null?void 0:a.includes("ç«¹å…‰")}).some(t=>t.status.name!=="å¦–åˆ€ç«¹å…‰"),prepare:m,execute:async e=>{const t=e.activator.getDeckCell().cardEntities.filter(i=>{var r;return(r=i.status.nameTags)==null?void 0:r.includes("ç«¹å…‰")}).filter(i=>i.status.name!=="å¦–åˆ€ç«¹å…‰");if(!t.length)return!1;const a=await e.activator.waitSelectEntity(t,"æ‰‹æœ­ã«åŠ ãˆã‚‹ã‚«ãƒ¼ãƒ‰ã‚’é¸æŠžã€‚",!1);if(!a)throw new N(e);return await a.addToHand(["Effect"],e.action.entity,e.activator),e.activator.getDeckCell().shuffle(),!0},settle:async()=>!0}]},yield{name:"çœŸåˆ€ç«¹å…‰",actions:[jt(),E,{title:"â‘¡ç›¸æ‰‹ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ç ´å£Š",isMandatory:!1,playType:"TriggerEffect",spellSpeed:"Normal",executableCells:["SpellAndTrapZone"],executablePeriods:["b1DAfterDmgCalc","b2DAfterDmgCalc"],executableDuelistTypes:["Controller"],canExecute:e=>{const t=e.action.entity.info.equipedBy;return!(!t||!t.info.battleLog.filter(a=>e.activator.duel.clock.isPreviousStage(a.timestamp)).some(a=>a.enemy.entityType==="Duelist")||!e.activator.getOpponentPlayer().getMonstersOnField().length||!e.activator.getOpponentPlayer().lifeLog.filter(a=>e.activator.duel.clock.isPreviousStage(a.clock)).some(a=>a.entity===t))},prepare:async e=>({selectedEntities:[],chainBlockTags:e.action.calcChainBlockTagsForDestroy(e.activator,e.activator.getOpponentPlayer().getMonstersOnField()),prepared:void 0}),execute:async e=>(await S.tryDestroy(e.activator.getOpponentPlayer().getMonstersOnField(),e)).length>0,settle:async()=>!0},{title:"â‘¢ç«¹å…‰å…¥æ›¿",isMandatory:!1,playType:"IgnitionEffect",spellSpeed:"Normal",executableCells:["SpellAndTrapZone"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],executableFaces:["FaceUp"],...sl(),canExecute:e=>!!(e.action.entity.info.equipedBy&&e.activator.getDeckCell().cardEntities.filter(t=>{var a;return(a=t.status.nameTags)==null?void 0:a.includes("ç«¹å…‰")}).filter(t=>t.status.name!=="çœŸåˆ€ç«¹å…‰").some(t=>t.status.spellCategory==="Equip"))&&e.activator.duel.field.getMonstersOnFieldStrictly().some(t=>t.canBeTargetOfEffect(e)),prepare:m,execute:async e=>{const t=e.activator.getDeckCell().cardEntities.filter(l=>{var o;return(o=l.status.nameTags)==null?void 0:o.includes("ç«¹å…‰")}).filter(l=>l.status.name!=="çœŸåˆ€ç«¹å…‰").filter(l=>l.status.spellCategory==="Equip");if(!t.length)return!1;const a=e.activator.getAvailableSpellTrapZones();if(!a.length)return!1;const i=e.activator.duel.field.getMonstersOnFieldStrictly().filter(l=>l.canBeTargetOfEffect(e));if(!i.length)return!1;const r=await e.activator.waitSelectEntity(t,"è£…å‚™ã™ã‚‹ã‚«ãƒ¼ãƒ‰ã‚’é¸æŠžã€‚",!1);if(!r)throw new N("ç«¹å…‰é¸æŠž",e);const n=await e.activator.duel.view.waitSelectDestination(e.activator,r,a,"è£…å‚™ã‚«ãƒ¼ãƒ‰ã‚’ç½®ãå ´æ‰€ã‚’é¸æŠžã€‚","è£…å‚™",!1);if(!n)throw new N("é…ç½®å ´æ‰€é¸æŠž",e);await r.putDirectly(n,"Spell",["Effect"],e.action.entity,e.activator),e.activator.getDeckCell().shuffle();const s=await e.activator.waitSelectEntity(i,"è£…å‚™ã™ã‚‹å¯¾è±¡ã‚’é¸æŠžã€‚",!1);if(!s)throw new N("è£…å‚™å¯¾è±¡é¸æŠž",e);return r.info.equipedBy=s,r.info.effectTargets[e.action.seq]=[s],s.info.equipEntities.push(r),!0},settle:async()=>!0}]}}const fl=Object.freeze(Object.defineProperty({__proto__:null,default:_f},Symbol.toStringTag,{value:"Module"}));function*Sf(){yield{name:"é»„é‡‘è‰²ã®ç«¹å…‰",actions:[{title:"ç™ºå‹•",isMandatory:!1,playType:"CardActivation",spellSpeed:"Normal",executableCells:["Hand","SpellAndTrapZone"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],priorityForNPC:20,fixedTags:["Draw"],meetsConditions:e=>e.activator.getSpellTrapsOnField().filter(t=>{var a;return(a=t.status.nameTags)==null?void 0:a.includes("ç«¹å…‰")}).filter(t=>t.face==="FaceUp").some(t=>t.status.spellCategory==="Equip"),canExecute:e=>e.activator.getDeckCell().cardEntities.length>0&&e.activator.canDraw,prepare:m,execute:async e=>(await e.activator.draw(2,e.action.entity,e.activator),!0),settle:async()=>!0},E]}}const gl=Object.freeze(Object.defineProperty({__proto__:null,default:Sf},Symbol.toStringTag,{value:"Module"}));function*Tf(){yield{name:"ï¼¢ï¼¦ï¼ç–¾é¢¨ã®ã‚²ã‚¤ãƒ«",actions:[{title:"â‘ ç‰¹æ®Šå¬å–š",isMandatory:!1,playType:"SpecialSummon",spellSpeed:"Normal",executableCells:["Hand"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],canExecute:e=>e.activator.getMonstersOnField().filter(t=>(t.status.nameTags??[]).includes("BF")).some(t=>t.nm!==e.action.entity.origin.name)&&Q(e,T,[],["Rule"]),getDests:e=>We(e,T,[],["Rule"]),prepare:e=>Je(e,"SpecialSummon",["SpecialSummon","Rule"],T),execute:Ie,settle:async()=>!0},{title:"â‘¡æ”»å®ˆåŠæ¸›",isMandatory:!1,playType:"IgnitionEffect",spellSpeed:"Normal",executableCells:["MonsterZone"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],executableFaces:["FaceUp"],isOnlyNTimesPerTurnIfFaceup:1,...de(e=>e.activator.getOpponentPlayer().getMonstersOnField().filter(t=>t.face==="FaceUp").filter(t=>t.canBeTargetOfEffect(e)),{message:"å¯¾è±¡ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã‚’é¸æŠžã€‚"}),execute:async e=>{const t=e.selectedEntities.filter(a=>a.isOnFieldAsMonsterStrictly).filter(a=>a.face==="FaceUp").find(a=>a.canBeEffected(e.activator,e.action.entity,e.action));return t?(["attack","defense"].map(a=>I.createLingeringFixation("â‘¡æ”»å®ˆåŠæ¸›",()=>!0,e.action.entity,e.action,a,(i,r,n)=>Math.round(n/2))).forEach(a=>t.numericOprsBundle.push(a)),!0):!1},settle:async()=>!0}]}}const hl=Object.freeze(Object.defineProperty({__proto__:null,default:Tf},Symbol.toStringTag,{value:"Module"})),on=e=>e.activator.canTryBanish(e.action.entity,"BanishAsCost",e.action)&&e.action.entity.canBeBanished("BanishAsCost",e.activator,e.action.entity,e.action),Cf=async e=>(await e.action.entity.banish(["Cost"],e.action.entity,e.activator),{banish:[{cost:e.action.entity,cell:e.action.entity.cell}]}),bf=(e,t,a=1)=>t.filter(i=>e.activator.canTryBanish(i,"BanishAsCost",e.action)).filter(i=>i.canBeBanished("BanishAsCost",e.activator,e.action.entity,e.action)).length>=a,wf=async(e,t,a,i=1,r=1)=>{const n=t.filter(c=>e.activator.canTryBanish(c,"BanishAsCost",e.action)).filter(c=>c.canBeBanished("BanishAsCost",e.activator,e.action.entity,e.action)),s=i===r?i:void 0,l=await e.activator.waitSelectEntities(n,s,c=>a(c,e),"ã‚³ã‚¹ãƒˆã¨ã—ã¦é™¤å¤–ã™ã‚‹ã‚«ãƒ¼ãƒ‰ã‚’é¸æŠž",!1)??[],o=l.map(c=>({cost:c,cell:c.cell}));return await S.banishManyForTheSameReason(l,["Cost"],e.action.entity,e.activator),{banish:o}},Aa=(e,t=()=>!0,a=1,i=1)=>({canPayCosts:(...r)=>bf(r[0],e(...r),a),payCosts:(...r)=>wf(r[0],e(r[0],r[1]),t,a,i)}),Ti=()=>Aa(e=>[e.action.entity],e=>e.length===1),cn={name:"æœ§å½±ãƒˆãƒ¼ã‚¯ãƒ³",actions:Wt,staticInfo:{name:"æœ§å½±ãƒˆãƒ¼ã‚¯ãƒ³",kind:"Monster",monsterCategories:["Normal","Token"],level:1,attack:0,defense:0,attributes:["Dark"],types:["WingedBeast"],wikiEncodedName:"%DB%B0%B1%C6%A5%C8%A1%BC%A5%AF%A5%F3"},continuousEffects:[Ea("ãƒªãƒªãƒ¼ã‚¹ä¸å¯","Monster",e=>[e],e=>[we.createContinuous("â‘¡ãƒªãƒªãƒ¼ã‚¹ä¸å¯",()=>!0,e,()=>!0,["AdvanceSummonRelease","ReleaseAsEffect","ReleaseAsCost"],()=>!1)])],summonFilter:(e,t,a,i,r,n,s,l,o,c)=>{const d={posList:o,cells:c},p={posList:[],cells:[]};return console.log(t,r),r.includes("SynchroSummon")?p:d}};function*Ef(){yield{name:"ï¼¢ï¼¦ï¼æœ§å½±ã®ã‚´ã‚¦ãƒ•ã‚¦",actions:[{title:"ç‰¹æ®Šå¬å–š",isMandatory:!1,playType:"SpecialSummon",spellSpeed:"Normal",executableCells:["Hand"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],canExecute:e=>Q(e,T,[],["Rule"])&&!e.activator.getMonstersOnField().length,getDests:e=>We(e,T,[],["Rule"]),prepare:e=>Je(e,"SpecialSummon",["SpecialSummon","Rule"],T),execute:Ie,settle:async()=>!0},{title:"â‘ ãƒˆãƒ¼ã‚¯ãƒ³ç”Ÿæˆ",isMandatory:!1,playType:"TriggerEffect",spellSpeed:"Normal",executableCells:["MonsterZone"],executablePeriods:C,executableDuelistTypes:["Controller"],fixedTags:["SpecialSummonToken"],triggerPattern:{triggerType:"Arrival",arrivalReasons:["SpecialSummon"],from:["Hand"]},canExecute:e=>{const t=L.prepareTokenEntities(e.activator,e.action.entity,cn,2),a=e.activator.getMonsterZones(),i=e.activator.getEnableSummonList(e.activator,"SpecialSummon",["Effect"],e.action,t.map(r=>({monster:r,cells:a,posList:T})),[],!1);return i.length>1&&i.flatMap(r=>r.cells).getDistinct().length>1},prepare:m,execute:async e=>{const t=L.prepareTokenEntities(e.activator,e.action.entity,cn,2),a=e.activator.getMonsterZones();return!!(await e.activator.summonMany(e.activator,"SpecialSummon",["Effect"],e.action,t.map(r=>({monster:r,cells:a,posList:T})),[],!1,2,r=>r.length==2,!1)??[]).length},settle:async()=>!0},{title:"â‘¡ãƒ•ã‚¡ãƒ³ãƒˆãƒ ã‚·ãƒ³ã‚¯ãƒ­",isMandatory:!1,playType:"IgnitionEffect",spellSpeed:"Normal",executableCells:["MonsterZone"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],executableFaces:["FaceUp"],hasToTargetCards:!0,...Aa(e=>{const t=e.activator.getMonstersOnField().filter(s=>s!==e.action.entity).filter(s=>s.lvl).filter(s=>{var l;return!((l=s.status.monsterCategories)!=null&&l.includes("Tuner"))});if(!t.length)return[];const a=e.action.entity.lvl;if(!a)return[];const i=e.activator.getGraveyard().cardEntities.filter(s=>{var l;return(l=s.status.nameTags)==null?void 0:l.includes("ï¼¢ï¼¦")}).filter(s=>{var l;return(l=s.status.monsterCategories)==null?void 0:l.includes("Synchro")}).filter(s=>s.lvl&&s.lvl>a);if(!i.length)return[];const r=e.activator.getMonsterZones(),n=new Set;for(const s of t.getAllOnOffPattern(1)){const l=a+s.map(c=>c.lvl??0).reduce((c,d)=>c+d,0);if(e.activator.getEnableSummonList(e.activator,"SpecialSummon",["Effect"],e.action,i.filter(c=>c.lvl===l).map(c=>({monster:c,cells:r,posList:T})),[e.action.entity,...s].map(c=>({material:c,cell:c.cell})),!1).length&&(s.forEach(n.add),n.size===t.length))break}return n.size?[e.action.entity,...n]:[]},(e,t)=>{if(!e.includes(t.action.entity)||e.length<2)return!1;const a=e.map(s=>s.lvl??0).reduce((s,l)=>s+l,0),i=t.activator.getMonsterZones(),r=t.activator.getGraveyard().cardEntities.filter(s=>{var l;return(l=s.status.nameTags)==null?void 0:l.includes("ï¼¢ï¼¦")}).filter(s=>{var l;return(l=s.status.monsterCategories)==null?void 0:l.includes("Synchro")}).filter(s=>s.lvl===a);return r.length?!!t.activator.getEnableSummonList(t.activator,"SpecialSummon",["Effect"],t.action,r.filter(s=>s.lvl===a).map(s=>({monster:s,cells:i,posList:T})),e.map(s=>({material:s,cell:s.cell})),!1).length:!1},2),prepare:async e=>{const t=e.costInfo.banish;if(!t||!t.length)throw new P("IllegalActionCost",e);const a=t.map(r=>r.cost.lvl??0).reduce((r,n)=>r+n,0);if(!a)throw new P("IllegalActionCost",e);const i=e.activator.getGraveyard().cardEntities.filter(r=>r.lvl===a).filter(r=>{var n;return(n=r.status.nameTags)==null?void 0:n.includes("ï¼¢ï¼¦")}).filter(r=>{var n;return(n=r.status.monsterCategories)==null?void 0:n.includes("Synchro")});if(!i.length)throw new P("IllegalActionCost",e);return hs(e,i,T)},execute:async(e,t)=>mr(e)?(e.selectedEntities.forEach(a=>{a.statusOperatorBundle.push(new ee({title:"ãƒãƒ¥ãƒ¼ãƒŠãƒ¼æ‰±ã„",validateAlive:i=>!0,isContinuous:!1,isSpawnedBy:e.action.entity,actionAttr:e.action,isApplicableTo:(i,r)=>r.isOnFieldAsMonsterStrictly&&r.face==="FaceUp",statusCalculator:(i,r,n)=>({monsterCategories:["Tuner",...n.monsterCategories??[]]})}))}),!0):!1,settle:async()=>!0}]}}const yl=Object.freeze(Object.defineProperty({__proto__:null,default:Ef},Symbol.toStringTag,{value:"Module"}));function*kf(){yield{name:"æ°´æ™¶æ©Ÿå·§ï¼ãƒãƒªãƒ•ã‚¡ã‚¤ãƒãƒ¼",actions:[Ze(e=>e.length===2&&e.some(t=>{var a;return(a=t.status.monsterCategories)==null?void 0:a.includes("Tuner")})),{title:"â‘ ãƒªã‚¯ãƒ«ãƒ¼ãƒˆ",isMandatory:!1,playType:"TriggerEffect",spellSpeed:"Normal",executableCells:x,executablePeriods:[...C,...M],executableDuelistTypes:["Controller"],fixedTags:["SpecialSummonFromDeck"],meetsConditions:e=>e.action.entity.hasBeenArrivalNow(["LinkSummon"]),canExecute:e=>{const t=[e.activator.getHandCell(),e.activator.getDeckCell()].flatMap(r=>r.cardEntities).filter(r=>(r.lvl??12)<4).filter(r=>{var n;return(n=r.status.monsterCategories)==null?void 0:n.includes("Tuner")}),a=e.activator.getMonsterZones();return e.activator.getEnableSummonList(e.activator,"SpecialSummon",["Effect"],e.action,t.map(r=>({monster:r,cells:a,posList:["Defense"]})),[],!1).length>0},prepare:m,execute:async e=>{const t=[e.activator.getHandCell(),e.activator.getDeckCell()].flatMap(r=>r.cardEntities).filter(r=>(r.lvl??12)<4).filter(r=>{var n;return(n=r.status.monsterCategories)==null?void 0:n.includes("Tuner")}),a=e.activator.getMonsterZones(),i=await e.activator.summonOne(e.activator,"SpecialSummon",["Effect"],e.action,t.map(r=>({monster:r,cells:a,posList:["Defense"]})),[],!1,!1);return i?(i.statusOperatorBundle.push(new ee({title:"åŠ¹æžœç™ºå‹•ä¸å¯",validateAlive:r=>r.duel.clock.isSameTurn(r.isSpawnedAt),isContinuous:!1,isSpawnedBy:e.action.entity,actionAttr:e.action,isApplicableTo:(r,n)=>r.duel.clock.isSameTurn(r.isSpawnedAt)&&n.isOnFieldAsMonsterStrictly&&n.face==="FaceUp",statusCalculator:()=>({canActivateEffect:!1})})),!0):!1},settle:async()=>!0},{title:"â‘¡ã‚·ãƒ³ã‚¯ãƒ­å¬å–š",isMandatory:!1,playType:"QuickEffect",spellSpeed:"Quick",executableCells:x,executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],isOnlyNTimesPerChain:1,...Ti(),meetsConditions:e=>!e.activator.isTurnPlayer,canExecute:e=>{const t=[...e.activator.getMonsterZones(),...e.activator.duel.field.getCells("ExtraMonsterZone")],a=e.activator.getExtraDeck().cardEntities.filter(r=>{var n;return(n=r.status.monsterCategories)==null?void 0:n.includes("Synchro")}).filter(r=>{var n;return(n=r.status.monsterCategories)==null?void 0:n.includes("Tuner")});return e.activator.getEnableSummonList(e.activator,"SynchroSummon",["SpecialSummon","Effect"],e.action,a.map(r=>({monster:r,cells:t,posList:T})),[{material:e.action.entity,cell:e.action.entity.cell}],!1).length>0},prepare:m,execute:async e=>{const t=[...e.activator.getMonsterZones(),...e.activator.duel.field.getCells("ExtraMonsterZone")],a=e.activator.getExtraDeck().cardEntities.filter(r=>{var n;return(n=r.status.monsterCategories)==null?void 0:n.includes("Synchro")}).filter(r=>{var n;return(n=r.status.monsterCategories)==null?void 0:n.includes("Tuner")});return!!await e.activator.summonOne(e.activator,"SynchroSummon",["SpecialSummon","Effect"],e.action,a.map(r=>({monster:r,cells:t,posList:T})),[],!1,!1)},settle:async()=>!0}]}}const vl=Object.freeze(Object.defineProperty({__proto__:null,default:kf},Symbol.toStringTag,{value:"Module"}));function*Df(){yield{name:"D-HERO ãƒ‡ã‚£ã‚¹ã‚¯ã‚¬ã‚¤[ã‚¨ãƒ©ãƒƒã‚¿å‰]",actions:[{title:"ãƒ‰ãƒ­ãƒ¼",isMandatory:!0,playType:"TriggerEffect",spellSpeed:"Normal",executableCells:["MonsterZone"],executablePeriods:[...C,...M],executableDuelistTypes:["Controller"],triggerPattern:{triggerType:"Arrival",arrivalReasons:["SpecialSummon"],from:["Graveyard"]},fixedTags:["IfSpecialSummonSucceed","Draw"],canExecute:e=>e.activator.canDraw&&e.activator.canAddToHandFromDeck,prepare:m,execute:async e=>(await e.activator.draw(2,e.action.entity,e.activator),!0),settle:async()=>!0}]}}const ml=Object.freeze(Object.defineProperty({__proto__:null,default:Df},Symbol.toStringTag,{value:"Module"}));function*xf(){yield{name:"ï¼¤ï¼ï¼¨ï¼¥ï¼²ï¼¯ ãƒ€ã‚¤ãƒ¤ãƒ¢ãƒ³ãƒ‰ã‚¬ã‚¤",actions:[{title:"é­”æ³•åŠ¹æžœäºˆç´„",isMandatory:!1,playType:"IgnitionEffect",spellSpeed:"Normal",executableCells:["MonsterZone"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],executableFaces:["FaceUp"],isOnlyNTimesPerTurnIfFaceup:1,canExecute:e=>e.action.entity.face==="FaceUp"&&e.activator.getDeckCell().cardEntities.length>0,prepare:m,execute:async e=>{const t=await S.excavateFromDeck(e.activator,["Effect"],e.action.entity,e.activator);if(!t)return!1;if(t.kind!=="Spell"||t.status.spellCategory!=="Normal")return e.activator.duel.view.requireUpdate(),await ya(500),e.activator.writeInfoLog(`${t.toString()}ã¯é€šå¸¸é­”æ³•ã§ã¯ãªã„ãŸã‚ã€ãƒ‡ãƒƒã‚­ãƒœãƒˆãƒ ã«æˆ»ã£ãŸã€‚`),await t.returnToDeck("Bottom",["Effect"],e.action.entity,e.activator),!1;await t.sendToGraveyard(["Effect"],e.action.entity,e.activator);const a=t.actions.filter(n=>n.playType==="CardActivation").find(n=>!n.needsToPayRegularCosts);if(!a)return e.activator.writeInfoLog(`${t.toString()}ã¯${e.action.entity.toString()}ã®åŠ¹æžœã§ã¯ç™ºå‹•ã§ããªã„ã€‚`),!0;const i=e.activator.duel.clock.getClone(),r={...a.definition};return r.title+=`(${e.action.entity.toString()})`,r.playType="IgnitionEffect",r.canExecute=(n,s)=>n.activator.duel.clock.turn>i.turn+2||n.action.entity.wasMovedAfter(i)?"RemoveMe":n.activator.duel.clock.turn<i.turn+2?!1:!a.definition.canExecute||a.definition.canExecute(n,s),r.executableCells=["Graveyard"],r.meetsConditions=void 0,r.canPayCosts=void 0,r.payCosts=void 0,r.settle=async()=>!0,r.isOnlyNTimesPerTurn=1,t.actions.push(Mt.createNew(t,r)),!0},settle:async()=>!0}]}}const _l=Object.freeze(Object.defineProperty({__proto__:null,default:xf},Symbol.toStringTag,{value:"Module"}));function*Pf(){yield{name:"ï¼¤ï¼ï¼¨ï¼¥ï¼²ï¼¯ ãƒ‡ã‚£ã‚¢ãƒœãƒªãƒƒã‚¯ã‚¬ã‚¤",actions:[{title:"â‘ ãƒªã‚¯ãƒ«ãƒ¼ãƒˆ",isMandatory:!1,playType:"IgnitionEffect",spellSpeed:"Normal",executableCells:["Graveyard"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],executableFaces:["FaceUp"],fixedTags:["SpecialSummonFromDeck"],priorityForNPC:10,...Ti(),canExecute:e=>{const t=e.activator.getDeckCell().cardEntities.find(r=>r.nm==="ï¼¤ï¼ï¼¨ï¼¥ï¼²ï¼¯ ãƒ‡ã‚£ã‚¢ãƒœãƒªãƒƒã‚¯ã‚¬ã‚¤");if(!t)return!1;const a=e.activator.getMonsterZones();return e.activator.getEnableSummonList(e.activator,"SpecialSummon",["Effect"],e.action,[{monster:t,posList:T,cells:a}],[],!1).length>0},prepare:m,execute:async e=>{const t=e.activator.getDeckCell().cardEntities.find(a=>a.nm==="ï¼¤ï¼ï¼¨ï¼¥ï¼²ï¼¯ ãƒ‡ã‚£ã‚¢ãƒœãƒªãƒƒã‚¯ã‚¬ã‚¤");return t?ys(e,[t]):!1},settle:async()=>!0}]}}const Sl=Object.freeze(Object.defineProperty({__proto__:null,default:Pf},Symbol.toStringTag,{value:"Module"}));function*Af(){yield{name:"ï¼¥ãƒ»ï¼¨ï¼¥ï¼²ï¼¯ ãƒ—ãƒªã‚ºãƒžãƒ¼",actions:[{title:"ãƒªãƒ•ãƒ¬ã‚¯ãƒˆãƒ»ãƒã‚§ãƒ³ã‚¸",isMandatory:!1,playType:"IgnitionEffect",spellSpeed:"Normal",executableCells:["MonsterZone"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],executableFaces:["FaceUp"],isOnlyNTimesPerTurnIfFaceup:1,needsToPayRegularCost:!0,canPayCosts:e=>{const t=e.activator.getExtraDeck().cardEntities.flatMap(a=>a.fusionMaterialInfos).filter(yt).map(a=>a.cardName).getDistinct();return e.activator.getDeckCell().cardEntities.filter(a=>t.includes(a.nm)).some(a=>a.canBeSentToGraveyard(e.activator,e.action.entity,"SendToGraveyardAsCost",e.action))},canExecute:e=>e.action.entity.face==="FaceUp",payCosts:async(e,t,a)=>{const i=e.activator.getExtraDeck().cardEntities.flatMap(c=>c.fusionMaterialInfos).filter(yt).map(c=>c.cardName).getDistinct(),r=e.activator.getDeckCell().cardEntities.filter(c=>i.includes(c.nm)).filter(c=>c.canBeSentToGraveyard(e.activator,e.action.entity,"SendToGraveyardAsCost",e.action));if(r.length===0)throw new P("UnexpectedSituation",e);const n=await e.activator.waitSelectEntity(r,"å¢“åœ°ã«é€ã‚‹ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã‚’é¸æŠž",a);if(!n){if(!a)throw new N(e);return}const s=e.activator.getExtraDeck().cardEntities.filter(c=>c.fusionMaterialInfos.filter(yt).some(d=>d.cardName===n.nm)),l=await e.activator.waitSelectEntity(s,"å…¬é–‹ã™ã‚‹ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã‚’é¸æŠž",a);if(!l)throw new P("UnexpectedSituation",e);e.activator.writeInfoLog(`å…¬é–‹ï¼š${l.toString()}`);const o={cost:n,cell:n.cell};return await n.sendToGraveyard(["Effect"],e.action.entity,e.activator),e.activator.getDeckCell().shuffle(),{sendToGraveyard:[o]}},prepare:m,execute:async e=>{const t=e.costInfo.sendToGraveyard;if(!t||!t.length)throw new P("IllegalActionCost",e);const a=t[0].cost;return e.action.entity.statusOperatorBundle.push(new ee({title:e.action.title,validateAlive:i=>i.duel.clock.isSameTurn(i.isSpawnedAt),isContinuous:!1,isSpawnedBy:e.action.entity,actionAttr:e.action,isApplicableTo:(i,r)=>r.isOnFieldAsMonsterStrictly&&r.face==="FaceUp",statusCalculator:()=>({name:a.origin.name})})),!0},settle:async()=>!0}]}}const Tl=Object.freeze(Object.defineProperty({__proto__:null,default:Af},Symbol.toStringTag,{value:"Module"})),Ji=(e,t)=>{const a=t?`é­”åŠ›å……å¡«å¯èƒ½(${t})`:"é­”åŠ›å……å¡«å¯èƒ½";return Vt(a,e,i=>[i],i=>[new ee({title:a,validateAlive:()=>!0,isContinuous:!0,isSpawnedBy:i,actionAttr:{},isApplicableTo:(r,n)=>r.isSpawnedBy===n,statusCalculator:(r,n,s)=>(s.maxCounterQty.SpellCounter=t??Number.MAX_VALUE,{maxCounterQty:s.maxCounterQty})})])},Fi={},Mf=(e,t=1)=>(Fi[t]||(Fi[t]={title:`é­”åŠ›å›žåŽ(${t})`,isMandatory:!0,playType:"AfterChainBlock",spellSpeed:"Normal",executableCells:["MonsterZone"],executablePeriods:ae,executableDuelistTypes:["Controller"],canExecute:a=>{var i;return!!(a.targetChainBlock&&a.targetChainBlock.action.playType==="CardActivation"&&a.targetChainBlock.action.entity.kind==="Spell"&&a.action.entity.isEffective&&a.action.entity.face==="FaceUp"&&a.action.entity.counterHolder.getQty("SpellCounter")<(a.action.entity.status.maxCounterQty.SpellCounter??0)&&(((i=a.action.entity.hadArrivedToFieldAt())==null?void 0:i.totalProcSeq)??Number.MAX_SAFE_INTEGER)<=a.targetChainBlock.isActivatedAt.totalProcSeq)},prepare:m,execute:async a=>a.action.entity.face==="FaceDown"||!a.action.entity.isOnFieldAsMonsterStrictly||!a.action.entity.isEffective?!1:(a.action.entity.counterHolder.add("SpellCounter",t,a.action.entity),!0),settle:async()=>!0}),{...Fi[t],title:`${e}é­”åŠ›å›žåŽ(${t})`}),Ff=(e,t,a)=>e.action.entity.counterHolder.getQty("SpellCounter")>=a,Of=async(e,t,a,i)=>{const r=i.filter(s=>s<=e.action.entity.counterHolder.getQty("SpellCounter"));let n=r[0];if(!(r.length>1&&(n=await e.activator.waitSelectNumber("å–ã‚Šé™¤ãé­”åŠ›ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼ã®å€‹æ•°ã‚’é¸æŠžã€‚",r,a)??0,!n)))return e.action.entity.counterHolder.remove("SpellCounter",n),{counter:n}},Ii=e=>({canPayCosts:(...t)=>Ff(...t,e.min()??0),payCosts:(...t)=>Of(...t,e)});function*Nf(){yield{name:"ç¥žè–é­”çš‡åŽã‚»ãƒ¬ãƒ¼ãƒ",actions:[Ze(e=>e.flatMap(t=>t.types).includes("Spellcaster")&&e.length>1),{title:"â‘ é­”åŠ›å……å¡«",isMandatory:!0,playType:"TriggerEffect",spellSpeed:"Normal",executableCells:x,executablePeriods:[...C,...M],executableDuelistTypes:["Controller"],executableFaces:["FaceUp"],triggerPattern:{triggerType:"Arrival",arrivalReasons:["LinkSummon"]},fixedTags:["IfLinkSummonSucceed"],prepare:m,execute:async e=>{if(!e.action.entity.isOnFieldAsMonsterStrictly)return!1;const t=[...e.action.entity.field.getCardsOnFieldStrictly(),...e.action.entity.field.getCells("Graveyard").flatMap(a=>a.cardEntities)].filter(a=>a.face==="FaceUp").filter(a=>a.kind==="Spell").length;return e.action.entity.counterHolder.setQty("SpellCounter",t,e.action.entity),!0},settle:async()=>!0},{title:"â‘¢è˜‡ç”Ÿ",isMandatory:!0,playType:"QuickEffect",spellSpeed:"Quick",executableCells:x,executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],fixedTags:["SpecialSummon"],isOnlyNTimesIfFaceup:1,...Ii([3]),canExecute:e=>{const t=e.activator.getCells("Graveyard","Hand").flatMap(r=>r.cardEntities).filter(r=>r.types.includes("Spellcaster")),a=e.action.entity.linkArrowDests;return e.activator.getEnableSummonList(e.activator,"SpecialSummon",["Effect"],e.action,t.map(r=>({monster:r,posList:["Defense"],cells:a})),[],!1).length>0},prepare:m,execute:async e=>{const t=e.activator.getCells("Graveyard","Hand").flatMap(r=>r.cardEntities).filter(r=>r.types.includes("Spellcaster")),a=e.action.entity.linkArrowDests;return!!await e.activator.summonOne(e.activator,"SpecialSummon",["Effect"],e.action,t.map(r=>({monster:r,posList:["Defense"],cells:a})),[],!1,!1)},settle:async()=>!0}],continuousEffects:[Ji("Monster"),Ea("â‘¡æ”»æ’ƒå¯¾è±¡è€æ€§","Monster",e=>[e],e=>[we.createContinuous("â‘¡æ”»æ’ƒå¯¾è±¡è€æ€§",()=>!0,e,()=>!0,["BattleTarget"],(t,a)=>t.controller===a?!0:t.controller.getEntiteisOnField().every(i=>{var r;return!((r=i.status.nameTags)!=null&&r.includes("ã‚¨ãƒ³ãƒ‡ã‚£ãƒŸã‚ªãƒ³"))}))])]}}const Cl=Object.freeze(Object.defineProperty({__proto__:null,default:Nf},Symbol.toStringTag,{value:"Module"}));function*Bf(){yield{name:"å°å°ã•ã‚Œã—ã‚¨ã‚¯ã‚¾ãƒ‡ã‚£ã‚¢",actions:[{title:"å°å°é–‹æ”¾",isMandatory:!0,playType:"Exodia",spellSpeed:"Normal",executableCells:["Hand"],executablePeriods:ae,executableDuelistTypes:["Controller"],canExecute:e=>e.activator.getHandCell().cardEntities.filter(a=>{var i;return(i=a.origin.nameTags)==null?void 0:i.includes("å°å°ã•ã‚Œã—")}).map(a=>a.origin.name).getDistinct().length===5,prepare:async e=>(await S.sendManyToGraveyardForTheSameReason(e.activator.duel.field.getCardsOnFieldStrictly(),["Rule"],e.action.entity,e.activator),{selectedEntities:[],chainBlockTags:[],nextChainBlockFilter:()=>!1}),execute:async e=>{const t=e.activator.getOpponentPlayer().getHandCell().cardEntities.filter(i=>{var r;return(r=i.origin.nameTags)==null?void 0:r.includes("å°å°ã•ã‚Œã—")}).map(i=>i.origin.name).getDistinct().length===5,a=[{name:"å°å°ã•ã‚Œã—è€…ã®å·¦è¶³",column:4},{name:"å°å°ã•ã‚Œã—è€…ã®å³è¶³",column:2},{name:"å°å°ã•ã‚Œã—è€…ã®å·¦è…•",column:5},{name:"å°å°ã•ã‚Œã—è€…ã®å³è…•",column:1},{name:"å°å°ã•ã‚Œã—ã‚¨ã‚¯ã‚¾ãƒ‡ã‚£ã‚¢",column:3}];for(const i of a){const r=[e.activator.getHandCell().cardEntities.find(n=>n.origin.name===i.name),e.activator.getOpponentPlayer().getHandCell().cardEntities.find(n=>n.origin.name===i.name)].filter(n=>n!==void 0);if(!r.length)throw new P("UnexpectedSituation",e,e.activator.getHandCell().cardEntities,i.name);await L.moveMany(r.map(n=>({entity:n,to:n.controller.getMonsterZones().find(s=>s.column===(n.controller.seat==="Above"?6-i.column:i.column))??n.controller.getFieldZone(),kind:"Monster",face:"FaceUp",orientation:"Vertical",pos:"Top",movedAs:["Rule"],movedBy:void 0,actionOwner:void 0,chooser:void 0})))}throw t?new ue(void 0,`ãŠäº’ã„ãŒã€${e.action.entity.toString()}ã®ç‰¹æ®Šå‹åˆ©æ¡ä»¶ã‚’åŒæ™‚ã«æº€ãŸã—ãŸã€‚`):new ue(e.activator,`${e.activator.name}ãŒ${e.action.entity.toString()}ã®ç‰¹æ®Šå‹åˆ©æ¡ä»¶ã‚’æº€ãŸã—ãŸã€‚`)},settle:async()=>!0}]}}const bl=Object.freeze(Object.defineProperty({__proto__:null,default:Bf},Symbol.toStringTag,{value:"Module"}));function*Lf(){{const e=a=>{const i="selectedEntities"in a?a.selectedEntities:a.action.entity.field.getCells("Graveyard").flatMap(n=>n.cardEntities).filter(n=>n.isMonster).filter(n=>n.canBeTargetOfEffect(a));if(i.length<2)return;let r=[a.activator,a.activator.getOpponentPlayer()].map(n=>a.activator.getEnableSummonList(a.activator,"SpecialSummon",["Effect"],a.action,i.map(s=>({monster:s,cells:n.getMonsterZones(),posList:T})),[],!1));if(!r.some(n=>!n.length)){if(r.every(n=>n.length===1)){if(r.flat().map(n=>n.monster.seq).getDistinct().length===1)return}else if(r.some(n=>n.length===1)){const n=r.filter(s=>s.length===1).flat().map(s=>s.monster);r=r.map(s=>s.length<2?s:s.filter(l=>!n.includes(l.monster)))}return r}},t=a=>a.activator.duel.field.getCells(...x).filter(i=>i.row===3||i.column===3).filter(i=>i.cardEntities.length).map(i=>i.cardEntities[0]).filter(i=>i.canBeReleased(a.activator,a.action.entity,["ReleaseAsCost"],a.action));yield{name:"çœŸç‚Žç«œã‚¢ãƒ«ãƒ“ã‚ªãƒ³",fusionMaterialInfos:[{type:"Name",cardName:"ã‚¢ãƒ«ãƒã‚¹ã®è½èƒ¤"},{type:"Filter",filter:a=>a.attr.includes("Light")&&a.types.includes("Spellcaster")}],actions:[{title:"â‘¡è˜‡ç”Ÿ",isMandatory:!1,playType:"QuickEffect",spellSpeed:"Quick",executableCells:me,executablePeriods:C,executableDuelistTypes:["Controller"],executableFaces:["FaceUp"],fixedTags:["SpecialSummonFromGraveyard"],isOnlyNTimesPerTurn:1,canExecute:a=>!a.activator.isTurnPlayer&&!!e(a),prepare:async(a,i,r)=>{const n=e(a);if(!n)throw new P("UnexpectedSituation",a);return{selectedEntities:await a.activator.waitSelectEntities(n.flat().map(l=>l.monster).getDistinct(),2,l=>l.length==2&&n.every(o=>o.map(c=>c.monster).some(c=>l.includes(c))),"è˜‡ç”Ÿã™ã‚‹ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã‚’é¸æŠžã€‚",r)}},execute:async a=>{if(a.selectedEntities.some(r=>r.wasMovedAfter(a.isActivatedAt)))return!1;const i=e(a);return i?(await a.activator.summonEachFields(a.activator,"SpecialSummon",["Effect"],a.action,i.flat(),[],!1,1,r=>r.length===1,!1),!0):!1},settle:async()=>!0},{title:"â‘¢è‡ªå·±å†ç”Ÿ",isMandatory:!1,playType:"IgnitionEffect",spellSpeed:"Normal",executableCells:["Graveyard"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],executableFaces:["FaceUp"],fixedTags:["SpecialSummonFromGraveyard"],isOnlyNTimesPerTurn:1,canPayCosts:a=>t(a).length===4,canExecute:a=>Q(a,T,t(a).map(i=>({material:i,cell:i.cell,isAsEffectCost:!0})),["Effect"]),payCosts:async a=>{const i=t(a);return await S.releaseManyForTheSameReason(i,["Release","Cost"],a.action.entity,a.activator),{release:i.map(r=>({cost:r,cell:r.cell}))}},prepare:m,execute:ve,settle:async()=>!0}],continuousEffects:[Ea("â‘ å¯¾è±¡è€æ€§","Monster",a=>[a],a=>[we.createContinuous("â‘ å¯¾è±¡è€æ€§",()=>!0,a,()=>!0,["EffectTarget"],(i,r)=>i.controller===r)])],summonFilter:(...a)=>{const[i,,,,r,,,n]=a,s={posList:[],cells:[]};return r.includes("FusionSummon")?n.some(l=>l.material===i.isSpawnedBy)?s:Yi(...a):Yi(...a)}}}}const wl=Object.freeze(Object.defineProperty({__proto__:null,default:Lf},Symbol.toStringTag,{value:"Module"}));function*Rf(){{yield{name:"ã‚¢ãƒ«ãƒã‚¹ã®è½èƒ¤",actions:[{title:"èžåˆ",isMandatory:!1,playType:"TriggerEffect",spellSpeed:"Normal",executableCells:["MonsterZone"],executablePeriods:C,executableDuelistTypes:["Controller"],triggerPattern:{triggerType:"Arrival",arrivalReasons:["NormalSummon","SpecialSummon"]},...ta(()=>!0,1),...aa(["ExtraDeck"],()=>!0,["MonsterZone"],(e,t,a)=>a.includes(e.action.entity)&&a.every(i=>i===e.action.entity||i.controller!==e.activator),{requisitionFrom:x}),settle:async()=>!0}]};{const e=t=>{const a=[];return Q(t,T,[],["Effect"])&&a.push("Hand"),(t.activator.canDraw||t.action.entity.cell.cellType==="Graveyard")&&a.push("Deck"),t.activator.getCells(...a).flatMap(i=>i.cardEntities).filter(i=>{var r;return i.nm==="ã‚¢ãƒ«ãƒã‚¹ã®è½èƒ¤"||((r=i.status.nameTags)==null?void 0:r.includes("çƒ™å°"))&&i.kind!=="Monster"}).filter(i=>i.canBeSentToGraveyard(t.activator,t.action.entity,"SendToGraveyardAsCost",t.action))};yield{name:"é»’è¡£ç«œã‚¢ãƒ«ãƒ“ã‚ªãƒ³",actions:[{title:"â‘¡è‡ªå·±ç‰¹æ®Šå¬å–šorè‡ªå·±ãƒ‡ãƒƒã‚­ãƒã‚¦ãƒ³ã‚¹",isMandatory:!1,playType:"IgnitionEffect",spellSpeed:"Normal",executableCells:["Hand","Graveyard"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],isOnlyNTimesPerTurn:1,needsToPayRegularCost:!0,canPayCosts:t=>e(t).length>0,payCosts:async(t,a,i)=>{const r=await t.activator.waitSelectEntity(e(t),"å¢“åœ°ã«é€ã‚‹ã‚«ãƒ¼ãƒ‰ã‚’é¸æŠžã€‚",i);if(!r)return;t.data=r.cell.cellType;const n={cost:r,cell:r.cell};return await r.sendToGraveyard(["Cost"],t.action.entity,t.activator),{sendToGraveyard:[n]}},prepare:async t=>{const a=[];return t.data==="Hand"?(a.push("SpecialSummon"),t.action.entity.cell.cellType==="Graveyard"&&a.push("SpecialSummonFromGraveyard")):t.data==="Deck"&&t.action.entity.cell.cellType==="Hand"&&a.push("Draw"),{chainBlockTags:a}},execute:async t=>{if(t.action.entity.wasMovedAfter(t.isActivatedAt))return!1;if(t.data==="Hand")return!!await t.activator.summon("SpecialSummon",["Effect"],t.action,t.action.entity,T,t.activator.getMonsterZones(),[],!1);if(t.data==="Deck"){const a=t.action.entity.cell.cellType==="Hand";return await t.action.entity.returnToDeck("Bottom",["Effect"],t.action.entity,t.activator),a&&await t.activator.draw(1,t.action.entity,t.activator),!0}throw new P("IlligalActionData",t)},settle:async()=>!0}],continuousEffects:[{title:"â‘ åç§°å¤‰æ›´",appliableCellTypes:["MonsterZone","Graveyard"],appliableDuelPeriodKeys:ae,faceList:hr,canStart:t=>t.isEffective&&!t.info.isPending&&!t.info.isDying,start:async t=>{const a=[new ee({title:"â‘ åç§°å¤‰æ›´",validateAlive:()=>!0,isContinuous:!1,isSpawnedBy:t,actionAttr:{},isApplicableTo:()=>!0,statusCalculator:()=>({name:"ã‚¢ãƒ«ãƒã‚¹ã®è½èƒ¤"})})],i=[t];return console.info(`start : ${t.toString()} â‡’ ${i.map(r=>r.toString()).join(" ")} (${a.map(r=>r.title).join(" ")})`),i.forEach(r=>r.statusOperatorBundle.push(...a)),{targets:i,seqList:a.map(r=>r.seq)}},finish:async(t,a)=>{a.targets.forEach(i=>a.seqList.forEach(i.statusOperatorBundle.removeItem))}}]}}}}const El=Object.freeze(Object.defineProperty({__proto__:null,default:Rf},Symbol.toStringTag,{value:"Module"})),Oi={},qf=e=>(Oi[e]||(Oi[e]={title:`${e}è‡ªå·±ã‚»ãƒƒãƒˆ`,isMandatory:!1,playType:"IgnitionEffect",spellSpeed:"Normal",executableCells:["Graveyard"],executablePeriods:["end"],executableDuelistTypes:["Controller"],executableFaces:["FaceUp"],isOnlyNTimesPerTurn:1,isNoticedForcibly:!0,meetsConditions:t=>{var i;const a=t.action.entity.moveLog.latestRecord;return!(!a.movedAs.includes("Cost")||((i=a.movedBy)==null?void 0:i.nm)!=="ã‚¢ãƒ«ãƒã‚¹ã®è½èƒ¤"||!t.activator.duel.clock.isSameTurn(a.movedAt))},canExecute:t=>t.activator.getAvailableSpellTrapZones().length?t.activator.canSet:!1,prepare:m,execute:async t=>{if(t.action.entity.wasMovedAfter(t.isActivatedAt))return!1;const a=t.activator.getAvailableSpellTrapZones();if(!a.length||!t.activator.canSet)return!1;const i=await t.activator.duel.view.waitSelectDestination(t.activator,t.action.entity,a,"ã‚»ãƒƒãƒˆã™ã‚‹å ´æ‰€ã‚’é¸æŠžã€‚","ã‚»ãƒƒãƒˆ",!1);if(!i)throw new N("é…ç½®å ´æ‰€é¸æŠž",t);return await t.action.entity.setAsSpellTrap(i,t.action.entity.origin.kind,["Effect"],t.action.entity,t.activator),!0},settle:async()=>!0}),Oi[e]);function*Hf(){yield{name:"ç™½ã®çƒ™å°",actions:[{title:"â‘ ç™ºå‹•",isMandatory:!1,playType:"CardActivation",spellSpeed:"Normal",executableCells:["Hand","SpellAndTrapZone"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],...aa(["ExtraDeck"],()=>!0,["Hand","MonsterZone","ExtraMonsterZone","Graveyard"],(e,t,a)=>a.flatMap(i=>i.types??[]).includes("Dragon")&&(a.map(i=>i.nm).includes("ã‚¢ãƒ«ãƒã‚¹ã®è½èƒ¤")||!a.map(i=>i.cell.cellType).includes("Graveyard")))},qf("â‘¡"),E]}}const kl=Object.freeze(Object.defineProperty({__proto__:null,default:Hf},Symbol.toStringTag,{value:"Module"}));function*Zf(){{const e=a=>!!(a.share||a.takeAll),t=(a,i,r)=>{var d;const n=r||a.activator.duel.field.getCells("Graveyard","Banished").flatMap(p=>p.cardEntities).filter(p=>p.isMonster).filter(p=>{var f;return!((f=p.status.monsterCategories)!=null&&f.includes("Fusion"))}).filter(p=>p.canBeTargetOfEffect(a));if(n.length<2)return;const s=!!((d=i.release)!=null&&d.flatMap(p=>p.cost.fusionMaterialInfos).filter(yt).map(p=>p.cardName).includes("ã‚¢ãƒ«ãƒã‚¹ã®è½èƒ¤")),l=ma.flatMap(p=>i[p]??[]).map(p=>({material:p.cost,isAsEffectCost:!0,cell:p.cell})),o={};if(s){const p=a.activator.getEnableSummonList(a.activator,"SpecialSummon",["Effect"],a.action,n.map(f=>({monster:f,cells:a.activator.getMonsterZones(),posList:["Defense"]})),l,!1);p.length>1&&p.flatMap(f=>f.cells).getDistinct().length>1&&(o.takeAll=p)}const c=[a.activator,a.activator.getOpponentPlayer()].map(p=>a.activator.getEnableSummonList(a.activator,"SpecialSummon",["Effect"],a.action,n.map(f=>({monster:f,cells:p.getMonsterZones(),posList:T})),l,!1));if(!c.some(p=>!p.length))if(c.every(p=>p.length===1))c.flat().map(p=>p.monster.seq).getDistinct().length!==1&&(o.share=c);else if(c.some(p=>p.length===1)){const p=c.filter(f=>f.length===1).flat().map(f=>f.monster);o.share=c.map(f=>f.length<2?f:f.filter(h=>!p.includes(h.monster)))}else o.share=c;return e(o)?o:void 0};yield{name:"åˆ†ã‹ã¤çƒ™å°",actions:[{title:"ç™ºå‹•",isMandatory:!1,playType:"CardActivation",spellSpeed:"Quick",executableCells:["SpellAndTrapZone"],executablePeriods:C,executableDuelistTypes:["Controller"],fixedTags:["SpecialSummonFromGraveyard"],isOnlyNTimesPerTurn:1,canPayCosts:a=>Si(a,x,i=>{var r;return!!((r=i.status.monsterCategories)!=null&&r.includes("Fusion"))},et.create(1)),canExecute:(a,i,r)=>r?!!t(a,r.costInfo):a.activator.getMonstersOnField().filter(n=>{var s;return(s=n.status.monsterCategories)==null?void 0:s.includes("Fusion")}).filter(n=>n.canBeReleased(a.activator,a.action.entity,["ReleaseAsCost"],a.action)).some(n=>t(a,{release:[{cost:n,cell:n.cell}]})),payCosts:async(a,i,r)=>{const n=await a.activator.waitSelectEntity(a.activator.getMonstersOnField().filter(l=>{var o;return(o=l.status.monsterCategories)==null?void 0:o.includes("Fusion")}).filter(l=>l.canBeReleased(a.activator,a.action.entity,["ReleaseAsCost"],a.action)).filter(l=>t(a,{release:[{cost:l,cell:l.cell}]})),"ãƒªãƒªãƒ¼ã‚¹ã™ã‚‹ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã‚’é¸æŠžã€‚",r);if(!n)return;const s={cost:n,cell:n.cell};return await n.release(["Cost"],a.action.entity,a.activator),{release:[s]}},prepare:async(a,i,r)=>{const n=t(a,a.costInfo);if(!n)throw new P("UnexpectedSituation",a);const s=[];return n.share&&s.push(...n.share.flat().map(o=>o.monster)),n.takeAll&&s.push(...n.takeAll.map(o=>o.monster)),{selectedEntities:await a.activator.waitSelectEntities(s.getDistinct(),2,o=>{if(o.length!==2)return!1;if(n.share&&n.share.every(c=>c.map(d=>d.monster).some(d=>o.includes(d))))return!0;if(n.takeAll){const c=n.takeAll;if(o.every(d=>c.map(p=>p.monster).includes(d)))return!0}return!1},"è˜‡ç”Ÿã™ã‚‹ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã‚’é¸æŠžã€‚",r)}},execute:async(a,i)=>{if(a.selectedEntities.some(s=>s.wasMovedAfter(a.isActivatedAt)))return!1;const r=t(a,a.costInfo,a.selectedEntities);if(!r)return!1;let n=!!r.takeAll;if(r.share&&r.takeAll&&(n=await a.activator.waitYesNo("è‡ªåˆ†ã®å ´ã«ä¸¡æ–¹ã®ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã‚’ç‰¹æ®Šå¬å–šã™ã‚‹ï¼Ÿ")),n)return mr(a,i,{posList:["Defense"],allOrNothing:!0});if(!r.share)throw new P("UnexpectedSituation",a);return await a.activator.summonEachFields(a.activator,"SpecialSummon",["Effect"],a.action,r.share.flat(),ma.flatMap(s=>a.costInfo[s]??[]).map(s=>({material:s.cost,isAsEffectCost:!0,cell:s.cell})),!1,1,s=>s.length===1,!1),!0},settle:async()=>!0},E]}}}const Dl=Object.freeze(Object.defineProperty({__proto__:null,default:Zf},Symbol.toStringTag,{value:"Module"}));function*Gf(){yield{name:"ãƒ•ã‚¡ã‚¤ã‚¢ã‚¦ã‚©ãƒ¼ãƒ«ãƒ»ãƒ‰ãƒ©ã‚´ãƒ³ãƒ»ã‚·ãƒ³ã‚®ãƒ¥ãƒ©ãƒªãƒ†ã‚£",actions:[Ze(e=>e.length>2),{title:"â‘ ãƒã‚¦ãƒ³ã‚¹ï¼†è‡ªå·±å¼·åŒ–",isMandatory:!1,playType:"QuickEffect",spellSpeed:"Quick",executableCells:x,executablePeriods:[...C,...M],executableDuelistTypes:["Controller"],isOnlyNTimesPerTurn:1,hasToTargetCards:!0,fixedTags:["BounceToHand"],canExecute:e=>[...e.activator.getGraveyard().cardEntities,...e.activator.getMonstersOnField()].flatMap(r=>r.status.monsterCategories??[]).getDistinct().union(["Ritual","Fusion","Synchro","Xyz"]).length<1?!1:[...e.activator.getOpponentPlayer().getGraveyard().cardEntities,...e.activator.getOpponentPlayer().getEntiteisOnField()].filter(r=>r.canBeTargetOfEffect(e)).length>0,prepare:async(e,t,a)=>{const r=[...e.activator.getGraveyard().cardEntities,...e.activator.getMonstersOnField()].flatMap(o=>o.status.monsterCategories??[]).getDistinct().union(["Ritual","Fusion","Synchro","Xyz"]).length;if(r<1)return;const n=[...e.activator.getOpponentPlayer().getGraveyard().cardEntities,...e.activator.getOpponentPlayer().getEntiteisOnField()].filter(o=>o.canBeTargetOfEffect(e));if(n.length<1)return;const s=n.length===1?1:void 0,l=await e.activator.waitSelectEntities(n,s,o=>o.length>0&&o.length<=r,"æ‰‹æœ­ã«æˆ»ã™ã‚«ãƒ¼ãƒ‰ã‚’é¸æŠžã€‚",a);if(l)return{selectedEntities:l}},execute:async e=>{const t=e.selectedEntities.filter(i=>i.isOnFieldStrictly||i.cell.cellType==="Graveyard").filter(i=>i.canBeEffected(e.activator,e.action.entity,e.action));await S.returnManyToHandForTheSameReason(t,["Effect"],e.action.entity,e.activator);const a=t.filter(i=>i.cell.cellType==="Hand"||i.cell.cellType==="ExtraDeck").length;return e.action.entity.numericOprsBundle.push(I.createLingeringAddition(e.action.title,i=>i.isSpawnedBy.isEffective,e.action.entity,e.action,"attack",(i,r,n)=>n+500*a)),!0},settle:async()=>!0},{title:"â‘¡è˜‡ç”Ÿ",isMandatory:!1,playType:"TriggerEffect",spellSpeed:"Normal",executableCells:x,executablePeriods:ae,executableDuelistTypes:["Controller"],isOnlyNTimesPerTurn:1,fixedTags:["SpecialSummonFromGraveyard"],meetsConditions:e=>{const t=e.action.entity.moveLog.latestRecord.movedAt,a=e.action.duel.field.moveLog.getPriviousChainLog().filter(i=>i.entity.cell.cellType==="Graveyard"||i.movedAs.includes("Battle")&&i.movedAs.includes("Destroy")).filter(i=>i.movedAt.totalProcSeq>t.totalProcSeq).map(i=>i.entity.wasMovedFrom).toArray();return e.action.entity.linkArrowDests.union(a).length>0},...Ye(e=>e.activator.getGraveyard().cardEntities.filter(t=>t.kind==="Monster").filter(t=>t.types.includes("Cyberse")).filter(t=>t.canBeTargetOfEffect(e))),settle:async()=>!0}]}}const xl=Object.freeze(Object.defineProperty({__proto__:null,default:Gf},Symbol.toStringTag,{value:"Module"}));function*Uf(){yield{name:"èžåˆ",actions:[{title:"ç™ºå‹•",isMandatory:!1,playType:"CardActivation",spellSpeed:"Normal",executableCells:["Hand","SpellAndTrapZone"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],...aa(["ExtraDeck"],()=>!0,["Hand","MonsterZone","ExtraMonsterZone"],()=>!0)},E]};for(const e of[{name:"ç°¡æ˜“èžåˆ",lvlUpperBound:5,filter:()=>!0},{name:"ç°¡ç´ èžåˆ",lvlUpperBound:6,filter:t=>{var a;return!((a=t.status.monsterCategories)!=null&&a.includes("Effect"))}}])yield{name:e.name,actions:[{title:"ç™ºå‹•",isMandatory:!1,playType:"CardActivation",spellSpeed:"Normal",executableCells:["Hand","SpellAndTrapZone"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],isOnlyNTimesPerTurn:1,fixedTags:["SpecialSummonFromExtraDeck"],canPayCosts:t=>t.activator.lp>=1e3,canExecute:t=>{const a=t.activator.getMonsterZones();return t.activator.getEnableSummonList(t.activator,"FusionSummon",["Effect"],t.action,t.activator.getExtraDeck().cardEntities.filter(r=>{var n;return(n=r.status.monsterCategories)==null?void 0:n.includes("Fusion")}).filter(r=>r.lvl&&r.lvl<=e.lvlUpperBound).filter(e.filter).map(r=>({monster:r,posList:T,cells:a})),[],!1).length>0},payCosts:(t,a)=>ea(t,a,1e3),prepare:m,execute:async t=>{var r;const a=t.activator.getMonsterZones(),i=await t.activator.summonOne(t.activator,"FusionSummon",["Effect"],t.action,t.activator.getExtraDeck().cardEntities.filter(n=>{var s;return(s=n.status.monsterCategories)==null?void 0:s.includes("Fusion")}).filter(n=>n.lvl&&n.lvl<=e.lvlUpperBound).filter(e.filter).map(n=>({monster:n,posList:T,cells:a})),[],!1,!1);return i?(i.statusOperatorBundle.push(new ee({title:"æ”»æ’ƒä¸å¯",validateAlive:()=>!0,isContinuous:!1,isSpawnedBy:t.action.entity,actionAttr:t.action,isApplicableTo:(n,s)=>s.face==="FaceUp"&&s.isOnFieldAsMonsterStrictly,statusCalculator:()=>({canAttack:!1})})),i.counterHolder.setSelfDestructionFlg(t.action.entity),i.info.isRebornable=!((r=i.origin.monsterCategories)!=null&&r.includes("RegularSpecialSummonOnly")),!0):!1},settle:async()=>!0},E,{title:"è‡ªå£Š",isMandatory:!0,playType:"LingeringEffect",spellSpeed:"Normal",executableCells:Ke,executablePeriods:["end"],executableDuelistTypes:Qt,canExecute:t=>t.action.entity.field.getMonstersOnFieldStrictly().some(a=>a.counterHolder.getSelfDestructionFlg(t.action.entity)),prepare:m,execute:async t=>{const a=t.action.entity.field.getMonstersOnFieldStrictly().filter(r=>r.counterHolder.getSelfDestructionFlg(t.action.entity));if(!a.length)throw new P("UnexpectedSituation",t);let i=a[0];if(a.length>1){const r=await t.activator.waitSelectEntity(a,"è‡ªå£Šã•ã›ã‚‹ã‚«ãƒ¼ãƒ‰ã‚’é¸æŠžã€‚",!1);if(!r)throw new N(t);i=r}return await S.tryDestroy([i],t),!0},settle:async()=>!0}]}}const Pl=Object.freeze(Object.defineProperty({__proto__:null,default:Uf},Symbol.toStringTag,{value:"Module"}));function*$f(){yield*["ã‚¤ã‚°ãƒŠã‚¤ãƒˆãƒ»ã‚¤ãƒ¼ã‚°ãƒ«","ã‚¤ã‚°ãƒŠã‚¤ãƒˆãƒ»ãƒžã‚°ãƒŠãƒ ","ã‚¤ã‚°ãƒŠã‚¤ãƒˆãƒ»ãƒ‰ãƒ©ã‚°ãƒŽãƒ•","ã‚¤ã‚°ãƒŠã‚¤ãƒˆãƒ»ãƒžã‚¹ã‚±ãƒƒãƒˆ","ã‚¤ã‚°ãƒŠã‚¤ãƒˆãƒ»ãƒ‡ãƒªãƒ³ã‚¸ãƒ£ãƒ¼","ã‚¤ã‚°ãƒŠã‚¤ãƒˆãƒ»ãƒ©ã‚¤ã‚ªãƒƒãƒˆ","ã‚¤ã‚°ãƒŠã‚¤ãƒˆãƒ»ã‚¦ãƒ¼ã‚¸ãƒ¼","ã‚¤ã‚°ãƒŠã‚¤ãƒˆãƒ»ã‚­ãƒ£ãƒªãƒãƒ¼"].map(e=>({name:e,actions:[lt,{title:"â‘ ã‚µãƒ¼ãƒ",isMandatory:!1,playType:"IgnitionEffect",spellSpeed:"Normal",executableCells:["SpellAndTrapZone"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],executableFaces:["FaceUp"],fixedTags:["Destroy","DestroyMultiple","DestroyMultipleOnField","DestroySpellTrapOnField","DestroySpellTrapsOnField"],meetsConditions:t=>{var i;const a=t.activator.getPendulumScaleMonsters().find(r=>r!==t.action.entity);return!(!a||!((i=a.status.nameTags)!=null&&i.includes("ã‚¤ã‚°ãƒŠã‚¤ãƒˆ")))},canExecute:t=>t.activator.getDeckCell().cardEntities.some(a=>{var i;return(i=a.status.nameTags)==null?void 0:i.includes("ã‚¤ã‚°ãƒŠã‚¤ãƒˆ")}),prepare:async t=>({selectedEntities:[],chainBlockTags:["SearchFromDeck",...t.action.calcChainBlockTagsForDestroy(t.activator,t.activator.getPendulumScaleMonsters())],prepared:void 0}),execute:async t=>{if(!(await S.tryDestroy(t.activator.getPendulumScaleMonsters(),t)).length)return!1;const i=t.activator.getDeckCell().cardEntities.filter(n=>{var s;return(s=n.status.nameTags)==null?void 0:s.includes("ã‚¤ã‚°ãƒŠã‚¤ãƒˆ")});if(!i.length)return!1;const r=await t.activator.waitSelectEntity(i,"æ‰‹æœ­ã«åŠ ãˆã‚‹ã‚«ãƒ¼ãƒ‰ã‚’é¸æŠžã€‚",!1);return r?(await r.addToHand(["Effect"],t.action.entity,t.activator),!0):!1},settle:async()=>!0}]}))}const Al=Object.freeze(Object.defineProperty({__proto__:null,default:$f},Symbol.toStringTag,{value:"Module"}));function*jf(){{const e=(t,a)=>{const i=a.opponent??!1,r=a.banish??!1,n=a.target??!1;let l=(i?t.activator.getOpponentPlayer():t.activator).getGraveyard().cardEntities.filter(o=>o.kind==="Trap").filter(o=>o.status.trapCategory==="Normal").filter(o=>{var c;return!(((c=a.costInfo.banish)==null?void 0:c.map(d=>d.cost))??[]).includes(o)}).filter(o=>o!==t.action.entity);return r&&(l=l.filter(o=>t.activator.canTryBanish(o,"BanishAsCost",t.action)).filter(o=>o.canBeBanished("BanishAsCost",t.activator,t.action.entity,t.action))),n&&(l=l.filter(o=>o.canBeTargetOfEffect(t))),l.flatMap(o=>o.actions).filter(o=>o.playType==="CardActivation").filter(o=>!o.needsToPayRegularCosts).filter(o=>{const c=a.costInfo??{};return r&&(c.banish=[{cost:o.entity,cell:o.entity.cell},...c.banish??[]]),o.validate(t.activator,[],["IgnoreRegularCosts","CopyEffectOnly"],{executeBy:t.action.entity,costInfo:c})})};yield{name:"ã‚¸ãƒ£ãƒ³ã‚¯ãƒ»ã‚³ãƒ¬ã‚¯ã‚¿ãƒ¼",actions:[{title:"ç½ ã‚³ãƒ”ãƒ¼",isMandatory:!1,playType:"QuickEffect",spellSpeed:"Quick",executableCells:x,executablePeriods:C,executableDuelistTypes:["Controller"],executableFaces:["FaceUp"],needsToPayRegularCost:!0,fixedTags:["DelegateAnotherEffect"],canPayCosts:t=>on(t)&&e(t,{banish:!0,costInfo:{banish:[{cost:t.action.entity,cell:t.action.entity.cell}]}}).length>0,payCosts:async(t,a,i)=>{const r=e(t,{banish:!0,costInfo:{banish:[{cost:t.action.entity,cell:t.action.entity.cell}]}}).map(l=>l.entity),n=await t.activator.waitSelectEntity(r,"ã‚³ãƒ”ãƒ¼ã™ã‚‹ç½ ã‚’é¸æŠžã€‚",i);if(!n)return;const s=[t.action.entity,n];return await S.banishManyForTheSameReason(s,["Cost"],t.action.entity,t.activator),{banish:s.map(l=>({cost:l,cell:l.cell}))}},prepare:async(t,a)=>{var s,l;const i=(l=(s=t.costInfo.banish)==null?void 0:s.find(o=>o.cost!==t.action.entity))==null?void 0:l.cost;if(!i)throw new P("IllegalActionCopy",t);const r=i.actions.find(o=>o.playType==="CardActivation");if(!r)throw new P("IllegalActionCopy",t);const n={...await r.prepare(t.activator,void 0,void 0,a,!1,!0)};return n.appendix=[`ã‚³ãƒ”ãƒ¼å¯¾è±¡ï¼š${i.toString()}`,...n.appendix??[]],n.chainBlockTags=[],n},execute:async(t,a)=>{var n,s;const i=(s=(n=t.costInfo.banish)==null?void 0:n.find(l=>l.cost!==t.action.entity))==null?void 0:s.cost;if(!i)throw new P("UnexpectedSituation",t);const r=i.actions.find(l=>l.playType==="CardActivation");if(!r)throw new P("UnexpectedSituation",t);return await r.execute(t,a,{indirectly:!0})},settle:async()=>!0}]},yield{name:"ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ãƒ»ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯",actions:[E,{title:"ç™ºå‹•",isMandatory:!1,playType:"CardActivation",spellSpeed:"Quick",executableCells:["SpellAndTrapZone"],executablePeriods:C,executableDuelistTypes:["Controller"],isOnlyNTimesPerTurn:1,actionGroupName:"ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ãƒ»ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯",fixedTags:["DelegateAnotherEffect"],canExecute:t=>e(t,{opponent:!0,target:!0,costInfo:{}}).length>0,payCosts:nn,prepare:async(t,a,i)=>{const r=e(t,{opponent:!0,target:!0,costInfo:t.costInfo}).map(o=>o.entity),n=await t.activator.waitSelectEntity(r,"ã‚³ãƒ”ãƒ¼ã™ã‚‹ç½ ã‚’é¸æŠžã€‚",i);if(!n)return;const s=n.actions.find(o=>o.playType==="CardActivation");if(!s)throw new P("IllegalActionCopy",t);const l={...await s.prepare(t.activator,void 0,void 0,a,!1,!0)};return l.appendix=[`ã‚³ãƒ”ãƒ¼å¯¾è±¡ï¼š${n.toString()}`,...l.appendix??[]],l.selectedEntities=[...l.selectedEntities??[],n],l},execute:async(t,a)=>{const i=t.selectedEntities.pop();if(!i)throw new P("UnexpectedSituation",t);if(i.wasMovedAfter(t.isActivatedAt))return!1;const r=i.actions.find(n=>n.playType==="CardActivation");if(!r)throw new P("UnexpectedSituation",t);return await r.execute(t,a,{indirectly:!0})},settle:async(t,a)=>{const i=t.selectedEntities.pop();if(!i)throw new P("UnexpectedSituation",t);if(i.wasMovedAfter(t.isActivatedAt))return!1;const r=i.actions.find(n=>n.playType==="CardActivation");if(!r)throw new P("UnexpectedSituation",t);return await r.directSettle(t,a)}},{title:"â‘¡ç½ ã‚³ãƒ”ãƒ¼",isMandatory:!1,playType:"QuickEffect",spellSpeed:"Quick",executableCells:["Graveyard"],executablePeriods:C,executableDuelistTypes:["Controller"],isOnlyNTimesPerTurn:1,actionGroupName:"ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ãƒ»ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯",fixedTags:["DelegateAnotherEffect"],canExecute:t=>on(t)&&e(t,{target:!0,costInfo:{banish:[{cost:t.action.entity,cell:t.action.entity.cell}]}}).length>0,payCosts:async t=>{const a=await nn(t),i=await Cf(t);return{...a,...i}},prepare:async(t,a,i)=>{const r=e(t,{target:!0,costInfo:t.costInfo}).map(o=>o.entity),n=await t.activator.waitSelectEntity(r,"ã‚³ãƒ”ãƒ¼ã™ã‚‹ç½ ã‚’é¸æŠžã€‚",i);if(!n)return;const s=n.actions.find(o=>o.playType==="CardActivation");if(!s)throw new P("IllegalActionCopy",t);const l={...await s.prepare(t.activator,void 0,void 0,a,!1,!0)};return l.appendix=[`ã‚³ãƒ”ãƒ¼å¯¾è±¡ï¼š${n.toString()}`,...l.appendix??[]],l.selectedEntities=[...l.selectedEntities??[],n],l},execute:async(t,a)=>{const i=t.selectedEntities.pop();if(!i)throw new P("UnexpectedSituation",t);if(i.wasMovedAfter(t.isActivatedAt))return!1;const r=i.actions.find(n=>n.playType==="CardActivation");if(!r)throw new P("UnexpectedSituation",t);return await r.execute(t,a,{indirectly:!0})},settle:async()=>!0}]}}}const Ml=Object.freeze(Object.defineProperty({__proto__:null,default:jf},Symbol.toStringTag,{value:"Module"}));function*zf(){for(const e of[{name:"ãƒˆãƒ­ã‚¤ãƒ¡ã‚¢ãƒ»ã‚±ãƒ«ãƒ™ãƒ­ã‚¹",trrigerEffectTitle:"â‘ ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ç ´å£Š",getTrrigerEffectTarget:t=>t.activator.getOpponentPlayer().getMonstersOnField().filter(a=>a.cell.cellType==="MonsterZone"),destroyType:"Effect"},{name:"ãƒˆãƒ­ã‚¤ãƒ¡ã‚¢ãƒ»ãƒ•ã‚§ãƒ‹ãƒƒã‚¯ã‚¹",trrigerEffectTitle:"â‘ é­”æ³•ç½ ç ´å£Š",getTrrigerEffectTarget:t=>t.activator.getOpponentPlayer().getEntiteisOnField().filter(a=>ga.includes(a.cell.cellType)),destroyType:"Battle"}]){const t=de(e.getTrrigerEffectTarget,{do:"Destroy"}),a={...t,prepare:(...i)=>{const r=i[0];return r.data=!!r.action.entity.coLinkedEntities.length,t.prepare(...i)}};yield{name:e.name,actions:[Ze(i=>i.length===2&&i.map(r=>r.nm).isAllUnique()),{title:e.trrigerEffectTitle,isMandatory:!1,playType:"TriggerEffect",spellSpeed:"Normal",executableCells:x,executablePeriods:C,executableDuelistTypes:["Controller"],triggerPattern:{triggerType:"Arrival",arrivalReasons:["LinkSummon"]},isOnlyNTimesPerTurn:1,...ta(()=>!0,1),...a,execute:async i=>i.selectedEntities.every(n=>!n.isOnField)||!(await S.tryDestroy(i.selectedEntities,i)).length?!1:(i.data&&(await i.activator.duel.clock.incrementProcSeq(),await i.activator.draw(1,i.action.entity,i.activator)),!0),settle:async()=>!0}],substituteEffects:[{title:`${Xr[e.destroyType]}ç ´å£Šä½“åˆ¶ä»˜ä¸Ž`,playType:"ContinuousEffect",isMandatory:!0,executableCells:x,executablePeriods:ae,executableDuelistTypes:["Controller"],isApplicableTo:(i,r,n)=>i.entity.isEffective?r!==e.destroyType?[]:n.filter(s=>s.controller===i.entity.controller).filter(s=>s.coLinkedEntities.length):[],substitute:async(i,r,n)=>{if(!i.entity.isEffective)return[];if(r!==e.destroyType)return[];const s=n.filter(l=>l.controller===i.entity.controller).filter(l=>l.coLinkedEntities.length);return s.forEach(l=>{i.entity.controller.writeInfoLog(`${i.entity.toString()}ã®åŠ¹æžœã«ã‚ˆã‚Š${l.toString()}ã¯${Xr[r]}ã§ã¯ç ´å£Šã•ã‚Œãªã„ã€‚`)}),s}}]}}}const Fl=Object.freeze(Object.defineProperty({__proto__:null,default:zf},Symbol.toStringTag,{value:"Module"}));function*Vf(){yield{name:"ãƒªãƒ³ã‚¯ãƒªãƒœãƒ¼",actions:[Ze(e=>e.length===1&&e.every(t=>t.lvl===1)),{title:"â‘ å¼±ä½“åŒ–",isMandatory:!1,playType:"QuickEffect",spellSpeed:"Quick",executableCells:x,executablePeriods:["b1Battle","b2Battle"],executableDuelistTypes:["Controller"],meetsConditions:(e,t)=>t.some(a=>a.action.playType==="DeclareAttack"&&a.activator!==e.activator),...de((e,t)=>t.filter(a=>a.action.playType==="DeclareAttack"&&a.activator!==e.activator).map(a=>a.action.entity)),...Rp(),execute:async e=>{if(!e.selectedEntities.length)return!1;const t=e.selectedEntities[0];return!t.isOnFieldAsMonsterStrictly||t.face==="FaceDown"?!1:(t.numericOprsBundle.push(I.createLingeringFixation("æ”»æ’ƒåŠ›ã‚¼ãƒ­",a=>a.duel.clock.isSameTurn(a.isSpawnedAt),e.action.entity,e.action,"attack",()=>0)),!0)},settle:async()=>!0},{title:"â‘¡è‡ªå·±å†ç”Ÿ",isMandatory:!1,playType:"QuickEffect",spellSpeed:"Quick",executableCells:["Graveyard"],executablePeriods:C,executableDuelistTypes:["Controller"],executableFaces:["FaceUp"],fixedTags:["SpecialSummonFromGraveyard"],isOnlyNTimesPerTurn:1,...Fs(["MonsterZone","ExtraMonsterZone"],(e,t)=>e.lvl===1&&Q(t,["Attack"],[{cell:e.cell,material:e}],["Effect"]),1),canExecute:e=>e.activator.getCells("MonsterZone","ExtraMonsterZone").flatMap(t=>t.cardEntities).filter(t=>t.lvl===1).some(t=>Q(e,["Attack"],[{cell:t.cell,material:t}],["Effect"])),prepare:m,execute:ve,settle:async()=>!0}]}}const Ol=Object.freeze(Object.defineProperty({__proto__:null,default:Vf},Symbol.toStringTag,{value:"Module"}));function*Qf(){yield{name:"ãƒ©ã‚¤ãƒˆãƒ­ãƒ¼ãƒ‰ãƒ»ãƒ‰ãƒŸãƒ‹ã‚ªãƒ³ ã‚­ãƒ¥ãƒªã‚ªã‚¹",actions:[Ze(e=>e.flatMap(t=>t.types).getDistinct().length===3&&Yn.some(t=>e.every(a=>a.attr.includes(t)))),{title:"â‘ å¢“åœ°é€ã‚Š",isMandatory:!1,playType:"TriggerEffect",spellSpeed:"Normal",executableCells:x,executablePeriods:[...C,...M],executableDuelistTypes:["Controller"],executableFaces:["FaceUp"],isOnlyNTimesPerTurn:1,triggerPattern:{triggerType:"Arrival",arrivalReasons:["LinkSummon"]},fixedTags:["SendToGraveyardFromDeck"],canExecute:e=>e.activator.getDeckCell().cardEntities.length>0,prepare:m,execute:async e=>{const t=e.activator.getDeckCell().cardEntities;if(!t.length)return!1;const a=await e.activator.waitSelectEntity(t,"å¢“åœ°ã«é€ã‚‹ã‚«ãƒ¼ãƒ‰ã‚’é¸æŠž",!1);if(!a)throw new N(e);return await a.sendToGraveyard(["Effect"],e.action.entity,e.activator),e.activator.getDeckCell().shuffle(),!0},settle:async()=>!0},{title:"â‘¡å¢“åœ°é€ã‚Š",isMandatory:!0,playType:"TriggerEffect",spellSpeed:"Normal",executableCells:x,executablePeriods:[...C,...M],executableDuelistTypes:["Controller"],isOnlyNTimesPerTurn:1,fixedTags:["SpecialSummonFromGraveyard"],meetsConditions:e=>{const t=e.action.entity.moveLog.latestRecord.movedAt;return e.action.duel.field.moveLog.getPriviousChainLog().filter(a=>a.entity.cell.cellType==="Graveyard").filter(a=>a.movedAt.totalProcSeq>t.totalProcSeq).map(a=>a.entity.wasMovedFrom).filter(a=>a.owner===e.activator).some(a=>a.cellType==="Deck")},..._r({targets:["Self"],qty:3}),settle:async()=>!0},{title:"â‘¢ã‚µãƒ«ãƒ™ãƒ¼ã‚¸",isMandatory:!1,playType:"TriggerEffect",spellSpeed:"Normal",executableCells:["Graveyard","Banished"],executablePeriods:[...C,...M],executableDuelistTypes:["Controller"],triggerPattern:{triggerType:"Departure",needsByBattle:!0,needsByEffect:!0,needsByOpponent:!0,from:x},fixedTags:["ReturnToHandFromGraveyard"],...de(e=>e.activator.getGraveyard().cardEntities,{message:"æ‰‹æœ­ã«åŠ ãˆã‚‹ã‚«ãƒ¼ãƒ‰ã‚’é¸æŠžã€‚"}),execute:async e=>e.selectedEntities.some(t=>t.wasMovedAfter(e.isActivatedAt))?!1:(await S.addManyToHand(e.selectedEntities,["Effect"],e.action.entity,e.activator),!0),settle:async()=>!0}]}}const Nl=Object.freeze(Object.defineProperty({__proto__:null,default:Qf},Symbol.toStringTag,{value:"Module"}));function*Wf(){yield{name:"ã‚½ãƒ¼ãƒ©ãƒ¼ãƒ»ã‚¨ã‚¯ã‚¹ãƒã‚§ãƒ³ã‚¸",actions:[{title:"ç™ºå‹•",isMandatory:!1,playType:"CardActivation",spellSpeed:"Normal",executableCells:["Hand","SpellAndTrapZone"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],fixedTags:["Draw","SendToGraveyardFromDeck","DiscordAsCost"],priorityForNPC:40,...ta(e=>{var t;return e.kind==="Monster"&&!!((t=e.status.nameTags)!=null&&t.includes("ãƒ©ã‚¤ãƒˆãƒ­ãƒ¼ãƒ‰"))},1),canExecute:e=>e.activator.getDeckCell().cardEntities.length>3,prepare:m,execute:async e=>{await e.activator.draw(2,e.action.entity,e.activator),await e.activator.duel.clock.incrementProcSeq();const t=e.activator.getDeckCell().cardEntities.slice(0,2);return await S.sendManyToGraveyardForTheSameReason(t,["Effect"],e.action.entity,e.activator),!0},settle:async()=>!0},E]},yield{name:"å…‰ã®æ´è»",actions:[{title:"ç™ºå‹•",isMandatory:!1,playType:"CardActivation",spellSpeed:"Normal",executableCells:["Hand","SpellAndTrapZone"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],fixedTags:["SearchFromDeck","SendToGraveyardFromDeck"],priorityForNPC:40,canPayCosts:e=>e.activator.getDeckCell().cardEntities.length>3,canExecute:e=>e.activator.getDeckCell().cardEntities.filter(t=>t.kind==="Monster").filter(t=>(t.lvl??13)<5).some(t=>t.status.nameTags&&t.status.nameTags.includes("ãƒ©ã‚¤ãƒˆãƒ­ãƒ¼ãƒ‰")),payCosts:async e=>{const t=e.activator.getDeckCell().cardEntities.slice(0,3),a=t.map(i=>({cost:i,cell:i.cell}));return await S.sendManyToGraveyardForTheSameReason(t,["Cost"],e.action.entity,e.activator),{sendToGraveyard:a}},prepare:m,execute:async e=>{const t=e.activator.getDeckCell().cardEntities.filter(i=>i.kind==="Monster").filter(i=>(i.lvl??13)<5).filter(i=>i.status.nameTags&&i.status.nameTags.includes("ãƒ©ã‚¤ãƒˆãƒ­ãƒ¼ãƒ‰"));if(t.length===0)return!1;const a=await e.activator.waitSelectEntity(t,"æ‰‹æœ­ã«åŠ ãˆã‚‹ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã‚’é¸æŠž",!1);if(!a)throw new N(e);return await a.addToHand(["Effect"],e.action.entity,e.activator),e.activator.getDeckCell().shuffle(),!0},settle:async()=>!0},E]}}const Bl=Object.freeze(Object.defineProperty({__proto__:null,default:Wf},Symbol.toStringTag,{value:"Module"}));function*Xf(){yield{name:"ãƒ©ã‚¤ãƒˆãƒ­ãƒ¼ãƒ‰ãƒ»ã‚»ã‚¤ãƒ³ãƒˆ ãƒŸãƒãƒ«ãƒ",actions:[el(2,2),{title:"â‘ å¢“åœ°é€ã‚Šï¼†ãƒ‰ãƒ­ãƒ¼",isMandatory:!1,playType:"IgnitionEffect",spellSpeed:"Normal",executableCells:x,executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],executableFaces:["FaceUp"],fixedTags:["SendToGraveyardFromDeck"],isOnlyNTimesPerTurn:1,...uf(),canExecute:e=>e.activator.getDeckCell().cardEntities.length>2,prepare:m,execute:async e=>{const t=e.activator.getDeckCell().cardEntities.slice(0,3);await S.sendManyToGraveyardForTheSameReason(t,["Effect"],e.action.entity,e.activator);const a=t.filter(i=>i.kind==="Monster").filter(i=>{var r;return(r=i.status.nameTags)==null?void 0:r.includes("ãƒ©ã‚¤ãƒˆãƒ­ãƒ¼ãƒ‰")}).length;return a&&await e.activator.draw(a,e.action.entity,e.activator),!0},settle:async()=>!0},{title:"â‘¡å¢“åœ°é€ã‚Šï¼†ç ´å£Š",isMandatory:!1,playType:"TriggerEffect",spellSpeed:"Normal",executableCells:["Graveyard"],executablePeriods:[...C,...M],executableDuelistTypes:["Controller"],triggerPattern:{triggerType:"Departure",needsByBattle:!0,needsByEffect:!0,needsByOpponent:!0,needsByDestory:!0},fixedTags:["SendToGraveyardFromDeck"],canExecute:e=>e.activator.getDeckCell().cardEntities.length>2,prepare:m,execute:async e=>{const t=e.activator.getDeckCell().cardEntities.slice(0,3);await S.sendManyToGraveyardForTheSameReason(t,["Effect"],e.action.entity,e.activator);const a=t.filter(i=>i.kind==="Monster").filter(i=>{var r;return(r=i.status.nameTags)==null?void 0:r.includes("ãƒ©ã‚¤ãƒˆãƒ­ãƒ¼ãƒ‰")}).length;if(a){const i=a===1?1:void 0,r=await e.activator.waitSelectEntities(e.action.entity.field.getCardsOnFieldStrictly(),i,n=>n.length<=a,"ã‚«ãƒ¼ãƒ‰ã‚’ç ´å£Šã™ã‚‹å ´åˆã€ç ´å£Šã™ã‚‹ã‚«ãƒ¼ãƒ‰ã‚’é¸æŠžã€‚",!0)??[];r.length&&await S.tryDestroy(r,e)}return!0},settle:async()=>!0}]}}const Ll=Object.freeze(Object.defineProperty({__proto__:null,default:Xf},Symbol.toStringTag,{value:"Module"})),Ya=(e,t)=>({title:`${e}å¢“åœ°é€ã‚Š(${t})`,isMandatory:!0,playType:"IgnitionEffect",spellSpeed:"Normal",executableCells:x,executablePeriods:["end"],executableDuelistTypes:["Controller"],executableFaces:["FaceUp"],fixedTags:["SendToGraveyardFromDeck"],isOnlyNTimesPerTurnIfFaceup:1,meetsConditions:a=>a.activator.isTurnPlayer,..._r({targets:["Self"],qty:t}),settle:async()=>!0}),Kf=(e,t)=>({title:`${e}å¢“åœ°é€ã‚Š(${t})`,isMandatory:!0,playType:"TriggerEffect",spellSpeed:"Normal",executableCells:x,executablePeriods:[...C,...M],executableDuelistTypes:["Controller"],executableFaces:["FaceUp"],isOnlyNTimesPerTurnIfFaceup:1,fixedTags:["SendToGraveyardFromDeck"],meetsConditions:a=>a.activator.duel.chainBlockLog.records.filter(i=>{var r;return(r=i.chainBlockInfo.action.entity.status.nameTags)==null?void 0:r.includes("ãƒ©ã‚¤ãƒˆãƒ­ãƒ¼ãƒ‰")}).filter(i=>i.chainBlockInfo.action.entity.kind==="Monster").filter(i=>i.chainBlockInfo.action.entity!==a.action.entity).filter(i=>i.chainBlockInfo.action.isWithChainBlock).filter(i=>a.activator.duel.clock.isPreviousChain(i.clock)).filter(i=>i.clock.totalProcSeq>a.action.entity.moveLog.latestRecord.movedAt.totalProcSeq).filter(i=>!i.chainBlockInfo.isNegatedActivationBy).some(i=>i.chainBlockInfo.activator===a.activator),..._r({targets:["Self"],qty:t}),settle:async()=>!0});function*Yf(){yield{name:"ãƒ©ã‚¤ãƒˆãƒ­ãƒ¼ãƒ‰ãƒ»ã‚µãƒ¢ãƒŠãƒ¼ ãƒ«ãƒŸãƒŠã‚¹",actions:[{title:"â‘ è˜‡ç”Ÿ",isMandatory:!1,playType:"IgnitionEffect",spellSpeed:"Normal",executableCells:x,executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],executableFaces:["FaceUp"],isOnlyNTimesPerTurnIfFaceup:1,fixedTags:["SpecialSummonFromGraveyard","DiscordAsCost"],...ta(()=>!0,1),...Ye(e=>e.activator.getGraveyard().cardEntities.filter(t=>t.kind==="Monster").filter(t=>(t.lvl??12)<5).filter(t=>{var a;return(a=t.status.nameTags)==null?void 0:a.includes("ãƒ©ã‚¤ãƒˆãƒ­ãƒ¼ãƒ‰")})),settle:async()=>!0},Ya("â‘¡",3)]},yield{name:"ãƒˆãƒ¯ã‚¤ãƒ©ã‚¤ãƒˆãƒ­ãƒ¼ãƒ‰ãƒ»ã‚·ãƒ£ãƒ¼ãƒžãƒ³ ãƒ«ãƒŸãƒŠã‚¹",actions:[{title:"â‘ è˜‡ç”Ÿå¸°é‚„",isMandatory:!1,playType:"IgnitionEffect",spellSpeed:"Normal",executableCells:x,executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],executableFaces:["FaceUp"],isOnlyNTimesPerTurnIfFaceup:1,fixedTags:["SpecialSummonFromGraveyard","DiscordAsCost"],...Aa(e=>e.activator.getCells("Hand","Graveyard").flatMap(t=>t.cardEntities).filter(t=>{var a;return(a=t.status.nameTags)==null?void 0:a.includes("ãƒ©ã‚¤ãƒˆãƒ­ãƒ¼ãƒ‰")}).filter(t=>t.kind==="Monster")),...Ye(e=>e.activator.getBanished().cardEntities.filter(t=>t.kind==="Monster").filter(t=>{var a;return(a=t.status.nameTags)==null?void 0:a.includes("ãƒ©ã‚¤ãƒˆãƒ­ãƒ¼ãƒ‰")})),settle:async()=>!0},Kf("â‘¡",3)]},yield{name:"ãƒ©ã‚¤ãƒˆãƒ­ãƒ¼ãƒ‰ãƒ»ãƒ¡ã‚¤ãƒ‡ãƒ³ ãƒŸãƒãƒ«ãƒ",actions:[{title:"â‘ ã‚µãƒ¼ãƒ",isMandatory:!1,playType:"IgnitionEffect",spellSpeed:"Normal",executableCells:x,executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],executableFaces:["FaceUp"],isOnlyNTimesPerTurnIfFaceup:1,triggerPattern:{triggerType:"Arrival",arrivalReasons:["NormalSummon"]},fixedTags:["SearchFromDeck"],canExecute:e=>e.activator.getDeckCell().cardEntities.filter(t=>t.attr.includes("Light")).filter(t=>t.types.includes("Dragon")).some(t=>t.lvl&&t.lvl<=e.activator.getGraveyard().cardEntities.filter(a=>{var i;return(i=a.status.nameTags)==null?void 0:i.includes("ãƒ©ã‚¤ãƒˆãƒ­ãƒ¼ãƒ‰")}).filter(a=>a.kind).map(a=>a.nm).getDistinct().length),prepare:m,execute:async e=>{if(!e.activator.canAddToHandFromDeck)return!1;const t=e.activator.getDeckCell().cardEntities.filter(i=>i.attr.includes("Light")).filter(i=>i.types.includes("Dragon")).filter(i=>i.lvl&&i.lvl<=e.activator.getGraveyard().cardEntities.filter(r=>{var n;return(n=r.status.nameTags)==null?void 0:n.includes("ãƒ©ã‚¤ãƒˆãƒ­ãƒ¼ãƒ‰")}).filter(r=>r.kind).map(r=>r.nm).getDistinct().length),a=await e.activator.waitSelectEntity(t,"æ‰‹æœ­ã«åŠ ãˆã‚‹ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã‚’é¸æŠž",!1);return a?(await a.addToHand(["Effect"],e.action.entity,e.activator),!0):!1},settle:async()=>!0},{title:"â‘¡å¢“åœ°é€ã‚Š",isMandatory:!0,playType:"TriggerEffect",spellSpeed:"Normal",executableCells:["Graveyard"],executablePeriods:[...C,...M],executableDuelistTypes:["Controller"],triggerPattern:{triggerType:"Departure",from:["Deck","Hand"]},fixedTags:["SendToGraveyardFromDeck"],prepare:m,execute:async e=>{const t=e.activator.getDeckCell().cardEntities[0];return t?(await t.sendToGraveyard(["Effect"],e.action.entity,e.activator),!0):!1},settle:async()=>!0},Ya("â‘¢",2)]}}const Rl=Object.freeze(Object.defineProperty({__proto__:null,default:Yf},Symbol.toStringTag,{value:"Module"}));function*Jf(){yield{name:"ãƒ©ã‚¤ãƒˆãƒ­ãƒ¼ãƒ‰ãƒ»ã‚¢ã‚µã‚·ãƒ³ ãƒ©ã‚¤ãƒ‡ãƒ³",actions:[{title:"â‘ å¢“åœ°é€ã‚Šï¼†è‡ªå·±å¼·åŒ–",isMandatory:!1,playType:"IgnitionEffect",spellSpeed:"Normal",executableCells:x,executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],executableFaces:["FaceUp"],isOnlyNTimesPerTurn:1,fixedTags:["SendToGraveyardFromDeck"],canExecute:e=>e.activator.getDeckCell().cardEntities.length>1,prepare:m,execute:async e=>{const t=e.activator.getDeckCell().cardEntities.slice(0,2);await S.sendManyToGraveyardForTheSameReason(t,["Effect"],e.action.entity,e.activator);const a=t.filter(i=>i.kind==="Monster").filter(i=>{var r;return(r=i.status.nameTags)==null?void 0:r.includes("ãƒ©ã‚¤ãƒˆãƒ­ãƒ¼ãƒ‰")}).length;return a&&e.action.entity.numericOprsBundle.push(I.createLingeringAddition(e.action.title,i=>i.isSpawnedBy.isEffective&&i.duel.clock.turn-i.isSpawnedAt.turn<2,e.action.entity,e.action,"attack",(i,r,n)=>n+200*a)),!0},settle:async()=>!0},Ya("â‘¡",2)]},yield{name:"ãƒ©ã‚¤ãƒˆãƒ­ãƒ¼ãƒ‰ãƒ»ãƒ“ãƒ¼ã‚¹ãƒˆ ã‚¦ã‚©ãƒ«ãƒ•",actions:[{title:"â‘ è‡ªå·±å†ç”Ÿ",isMandatory:!0,playType:"TriggerEffect",spellSpeed:"Normal",executableCells:["Graveyard"],executablePeriods:[...C,...M],executableDuelistTypes:["Controller"],triggerPattern:{triggerType:"Departure",from:["Deck"]},fixedTags:["SpecialSummonFromGraveyard"],canExecute:e=>Q(e,T,[],["Effect"]),prepare:m,execute:ve,settle:async()=>!0}]},yield{name:"ãƒ©ã‚¤ãƒˆãƒ­ãƒ¼ãƒ‰ãƒ»ã‚¢ãƒ¼ãƒãƒ£ãƒ¼ ãƒ•ã‚§ãƒªã‚¹",actions:[{title:"â‘ è‡ªå·±å†ç”Ÿ",isMandatory:!0,playType:"TriggerEffect",spellSpeed:"Normal",executableCells:["Graveyard"],executablePeriods:[...C,...M],executableDuelistTypes:["Controller"],triggerPattern:{triggerType:"Departure",from:["Deck"],needsByEffect:!0,causerFilter:(e,t)=>t.kind==="Monster"},fixedTags:["SpecialSummonFromGraveyard"],canExecute:e=>Q(e,T,[],["Effect"]),prepare:m,execute:ve,settle:async()=>!0},{title:"â‘¡ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ç ´å£Šï¼†å¢“åœ°é€ã‚Š",isMandatory:!1,playType:"IgnitionEffect",spellSpeed:"Normal",executableCells:x,executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],executableFaces:["FaceUp"],fixedTags:["Destroy","DestroyMonsterOnField","DestroyOnOpponentField","DestroyOnField","SendToGraveyardFromDeck"],canPayCosts:xa,canExecute:e=>e.activator.getDeckCell().cardEntities.length>2,payCosts:Pa,...de(e=>e.activator.getOpponentPlayer().getMonstersOnField().filter(t=>t.canBeTargetOfEffect(e)),{do:"Destroy"}),execute:async(e,t)=>e.selectedEntities.every(i=>!i.isOnField)||!await S.tryDestroy(e.selectedEntities,e)?!1:(await e.activator.duel.clock.incrementProcSeq(),Ki(e,t,{qty:3,targets:["Self"]})),settle:async()=>!0}]},yield{name:"å…‰é“ã®é¾",actions:[{title:"â‘ è‡ªå·±ç‰¹æ®Šå¬å–š",isMandatory:!1,playType:"IgnitionEffect",spellSpeed:"Normal",executableCells:["Hand"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],fixedTags:["SpecialSummonFromHand","SpecialSummon"],isOnlyNTimesPerTurn:1,canExecute:e=>e.activator.getGraveyard().cardEntities.filter(t=>t.kind==="Monster").some(t=>{var a;return(a=t.status.nameTags)==null?void 0:a.includes("ãƒ©ã‚¤ãƒˆãƒ­ãƒ¼ãƒ‰")}),prepare:m,execute:ve,settle:async()=>!0},{title:"â‘¡å¢“åœ°é€ã‚Š",isMandatory:!1,playType:"TriggerEffect",spellSpeed:"Normal",executableCells:["MonsterZone"],executablePeriods:[...C,...M],executableDuelistTypes:["Controller"],isOnlyNTimesPerTurn:1,triggerPattern:{triggerType:"Arrival",arrivalReasons:["SpecialSummon"]},fixedTags:["SendToGraveyardFromDeck","IfSpecialSummonSucceed","SendToGraveyardFromDeck"],canExecute:e=>e.activator.getDeckCell().cardEntities.filter(t=>{var a;return(a=t.status.nameTags)==null?void 0:a.includes("ãƒ©ã‚¤ãƒˆãƒ­ãƒ¼ãƒ‰")}).some(t=>t.nm!=="å…‰é“ã®é¾"),prepare:m,execute:async e=>{const t=e.activator.getDeckCell().cardEntities.filter(i=>{var r;return(r=i.status.nameTags)==null?void 0:r.includes("ãƒ©ã‚¤ãƒˆãƒ­ãƒ¼ãƒ‰")}).filter(i=>i.nm!=="å…‰é“ã®é¾");if(t.length===0)return!1;const a=await e.activator.waitSelectEntity(t,"å¢“åœ°ã«é€ã‚‹ã‚«ãƒ¼ãƒ‰ã‚’é¸æŠž",!1);if(!a)throw new N(e);return await a.sendToGraveyard(["Effect"],e.action.entity,e.activator),e.activator.getDeckCell().shuffle(),!0},settle:async()=>!0},{title:"â‘¢ã‚µãƒ¼ãƒ",isMandatory:!1,playType:"TriggerEffect",spellSpeed:"Normal",executableCells:["Graveyard"],executablePeriods:[...C,...M],executableDuelistTypes:["Controller"],triggerPattern:{triggerType:"Departure"},isOnlyNTimesPerTurn:1,fixedTags:["SearchFromDeck"],canExecute:e=>e.activator.getDeckCell().cardEntities.some(t=>t.atk===3e3&&t.def===2600),prepare:m,execute:async e=>{const t=e.activator.getDeckCell().cardEntities.filter(i=>i.atk===3e3&&i.def===2600),a=await e.activator.waitSelectEntity(t,"æ‰‹æœ­ã«åŠ ãˆã‚‹ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã‚’é¸æŠž",!1);return a?(await a.addToHand(["Effect"],e.action.entity,e.activator),e.activator.getDeckCell().shuffle(),!0):!1},settle:async()=>!0}]},yield{name:"ãƒ©ã‚¤ãƒˆãƒ­ãƒ¼ãƒ‰ãƒ»ãƒ‡ãƒ¼ãƒ¢ãƒ³ ãƒ´ã‚¡ã‚¤ã‚¹",actions:[{title:"â‘ è‡ªå·±ç‰¹æ®Šå¬å–š",isMandatory:!1,playType:"IgnitionEffect",spellSpeed:"Normal",executableCells:["Hand"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],fixedTags:["SpecialSummonFromHand","SendToGraveyardFromDeck"],isOnlyNTimesPerTurn:1,canPayCosts:e=>e.activator.getHandCell().cardEntities.length>1,canExecute:e=>e.activator.getDeckCell().cardEntities.length>1&&Q(e,T,[],["Effect"]),payCosts:async(e,t,a)=>{const i=e.activator.getHandCell().cardEntities.filter(n=>n!==e.action.entity),r=await e.activator.waitSelectEntity(i,"ãƒ‡ãƒƒã‚­ãƒˆãƒƒãƒ—ã«æˆ»ã™ã‚«ãƒ¼ãƒ‰ã‚’ä¸€æžšé¸æŠžã€‚",a);if(!r)throw new N(e);return await r.returnToDeck("Top",["Cost"],e.action.entity,e.activator),{returnToDeck:[{cost:r,cell:e.activator.getHandCell()}]}},prepare:m,execute:async(e,t)=>await ve(e)?(await e.activator.duel.clock.incrementProcSeq(),Ki(e,t,{qty:2,targets:["Self"]})):!1,settle:async()=>!0},{title:"â‘¡è˜‡ç”Ÿ",isMandatory:!1,playType:"TriggerEffect",spellSpeed:"Normal",executableCells:["Graveyard"],executablePeriods:[...C,...M],executableDuelistTypes:["Controller"],isOnlyNTimesPerTurn:1,triggerPattern:{triggerType:"Departure",from:["Deck"]},fixedTags:["SpecialSummonFromGraveyard"],...Ye(e=>e.activator.getGraveyard().cardEntities.filter(t=>t.kind==="Monster").filter(t=>{var a;return(a=t.status.nameTags)==null?void 0:a.includes("ãƒ©ã‚¤ãƒˆãƒ­ãƒ¼ãƒ‰")}).filter(t=>t.nm!=="ãƒ©ã‚¤ãƒˆãƒ­ãƒ¼ãƒ‰ãƒ»ãƒ‡ãƒ¼ãƒ¢ãƒ³ ãƒ´ã‚¡ã‚¤ã‚¹")),settle:async()=>!0}]},yield{name:"ãƒ©ã‚¤ãƒˆãƒ­ãƒ¼ãƒ‰ãƒ»ãƒžã‚¸ã‚·ãƒ£ãƒ³ ãƒ©ã‚¤ãƒ©",actions:[{title:"â‘¢é­”æ³•ç½ ç ´å£Š",isMandatory:!1,playType:"IgnitionEffect",spellSpeed:"Normal",executableCells:["MonsterZone"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],executableFaces:["FaceUp"],fixedTags:["Destroy","DestroyOnField","DestroySpellTrapOnField"],...de(e=>e.activator.getOpponentPlayer().getSpellTrapsOnField().filter(t=>t.canBeTargetOfEffect(e)),{message:"ç ´å£Šã™ã‚‹å¯¾è±¡ã‚’é¸æŠžã€‚",do:"Destroy",canExecute:e=>e.action.entity.battlePosition==="Attack"}),execute:async e=>(e.action.entity.battlePosition==="Attack"&&(await S.tryDestroy(e.selectedEntities,e),await e.action.entity.setBattlePosition("Defense",["Effect"],e.action.entity,e.activator)),e.action.entity.statusOperatorBundle.push(new ee({title:"è¡¨ç¤ºå½¢å¼å¤‰æ›´ä¸å¯",validateAlive:t=>t.duel.clock.turn-t.isSpawnedAt.turn<3,isContinuous:!1,isSpawnedBy:e.action.entity,actionAttr:e.action,isApplicableTo:()=>!0,statusCalculator:()=>({canBattlePositionChange:!1})})),!0),settle:async()=>!0},Ya("â‘¡",3)]}}const ql=Object.freeze(Object.defineProperty({__proto__:null,default:Jf},Symbol.toStringTag,{value:"Module"}));function*If(){yield{name:"ãƒ©ã‚¤ãƒˆãƒ­ãƒ¼ãƒ‰ãƒ»ã‚¢ãƒ†ãƒŠ ãƒŸãƒãƒ«ãƒ",actions:[be(),{title:"â‘ å¢“åœ°é€ã‚Š",isMandatory:!1,playType:"TriggerEffect",spellSpeed:"Normal",executableCells:x,executablePeriods:[...C,...M],executableDuelistTypes:["Controller"],executableFaces:["FaceUp"],isOnlyNTimesPerTurn:1,fixedTags:["SendToGraveyardFromDeck"],triggerPattern:{triggerType:"Arrival",arrivalReasons:["SynchroSummon"]},canExecute:e=>e.activator.getDeckCell().cardEntities.filter(t=>t.kind==="Monster").some(t=>{var a;return(a=t.status.nameTags)==null?void 0:a.includes("ãƒ©ã‚¤ãƒˆãƒ­ãƒ¼ãƒ‰")})&&e.action.entity.info.materials.map(t=>t.material).filter(t=>t.kind==="Monster").some(t=>{var a;return(a=t.status.nameTags)==null?void 0:a.includes("ãƒ©ã‚¤ãƒˆãƒ­ãƒ¼ãƒ‰")}),prepare:m,execute:async e=>{const t=e.activator.getDeckCell().cardEntities.filter(n=>n.kind==="Monster").filter(n=>{var s;return(s=n.status.nameTags)==null?void 0:s.includes("ãƒ©ã‚¤ãƒˆãƒ­ãƒ¼ãƒ‰")});if(!t.length)return!1;const a=e.action.entity.info.materials.map(n=>n.material).filter(n=>n.kind==="Monster").filter(n=>{var s;return(s=n.status.nameTags)==null?void 0:s.includes("ãƒ©ã‚¤ãƒˆãƒ­ãƒ¼ãƒ‰")}).length,i=a===1?1:void 0,r=await e.activator.waitSelectEntities(t,i,n=>n.length>0&&n.length<=a&&n.length===n.flatMap(s=>s.types).getDistinct().length,"å¢“åœ°ã«é€ã‚‹ã‚«ãƒ¼ãƒ‰ã‚’é¸æŠž",!1);if(!r)throw new N(e);return await S.sendManyToGraveyardForTheSameReason(r,["Effect"],e.action.entity,e.activator),e.activator.getDeckCell().shuffle(),!0},settle:async()=>!0},{title:"â‘¢å¢“åœ°é€ã‚Š",isMandatory:!1,playType:"IgnitionEffect",spellSpeed:"Normal",executableCells:x,executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],executableFaces:["FaceUp"],isOnlyNTimesPerTurn:1,needsToPayRegularCost:!0,fixedTags:["SendToGraveyardFromDeck"],...Aa(e=>e.activator.getGraveyard().cardEntities.filter(t=>t.kind==="Monster").filter(t=>{var a;return(a=t.status.nameTags)==null?void 0:a.includes("ãƒ©ã‚¤ãƒˆãƒ­ãƒ¼ãƒ‰")}),(e,t)=>e.length>0&&e.length<5&&e.length<=t.activator.getDeckCell().cardEntities.length,1,4),canExecute:e=>e.activator.getDeckCell().cardEntities.length>0,prepare:m,execute:async e=>{var i;const t=((i=e.costInfo.banish)==null?void 0:i.length)??0;if(!t)throw new P("IllegalActionCost",e);const a=e.activator.getDeckCell().cardEntities.slice(0,t);return await S.sendManyToGraveyardForTheSameReason(a,["Effect"],e.action.entity,e.activator),!0},settle:async()=>!0}],continuousEffects:[gr("â‘¡é™¤å¤–ä¸å¯","Monster",e=>[we.createContinuous("â‘¡é™¤å¤–ä¸å¯",t=>t.isSpawnedBy.isOnFieldStrictly&&t.isSpawnedBy.face==="FaceUp",e,(t,a)=>{var i;return a.controller===t.isSpawnedBy.controller&&!!((i=a.status.nameTags)!=null&&i.includes("ãƒ©ã‚¤ãƒˆãƒ­ãƒ¼ãƒ‰"))&&a.isOnFieldAsMonsterStrictly&&a.face==="FaceUp"},["BanishAsEffect"],()=>!1)])]}}const Hl=Object.freeze(Object.defineProperty({__proto__:null,default:If},Symbol.toStringTag,{value:"Module"}));function*eg(){for(const e of["ãƒ¡ã‚¿ãƒ«ãƒ•ã‚©ãƒ¼ã‚¼ãƒ»ã‚´ãƒ«ãƒ‰ãƒ©ã‚¤ãƒãƒ¼","ãƒ¡ã‚¿ãƒ«ãƒ•ã‚©ãƒ¼ã‚¼ãƒ»ã‚·ãƒ«ãƒãƒ¼ãƒ‰","ãƒ¡ã‚¿ãƒ«ãƒ•ã‚©ãƒ¼ã‚¼ãƒ»ã‚¹ãƒ†ã‚£ã‚¨ãƒ¬ãƒ³","ãƒ¡ã‚¿ãƒ«ãƒ•ã‚©ãƒ¼ã‚¼ãƒ»ãƒ´ã‚©ãƒ«ãƒ•ãƒ¬ã‚¤ãƒ "])yield{name:e,actions:[lt,{title:"â‘ ã‚µãƒ¼ãƒ",isMandatory:!1,playType:"IgnitionEffect",spellSpeed:"Normal",executableCells:["SpellAndTrapZone"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],executableFaces:["FaceUp"],isOnlyNTimesPerTurnIfFaceup:1,fixedTags:["Destroy"],...de(t=>{let a=t.activator.getEntiteisOnField().filter(i=>i.face==="FaceUp").filter(i=>i.canBeTargetOfEffect(t)).filter(i=>i!==t.action.entity);return t.activator.getAvailableSpellTrapZones.length||(a=a.filter(i=>i.cell.cellType==="SpellAndTrapZone")),a},{message:"ç ´å£Šã™ã‚‹ã‚«ãƒ¼ãƒ‰ã‚’é¸æŠžã€‚",do:"Destroy",canExecute:t=>t.activator.canSet&&t.activator.getDeckCell().cardEntities.filter(a=>a.kind==="Spell"||a.kind==="Trap").some(a=>{var i;return(i=a.status.nameTags)==null?void 0:i.includes("ãƒ¡ã‚¿ãƒ«ãƒ•ã‚©ãƒ¼ã‚¼")})}),execute:async t=>{if(!(await S.tryDestroy(t.selectedEntities,t)).length||!t.activator.canSet)return!1;const i=t.activator.getAvailableSpellTrapZones();if(!i.length)return!1;const r=t.activator.getDeckCell().cardEntities.filter(l=>l.kind==="Spell"||l.kind==="Trap").filter(l=>{var o;return(o=l.status.nameTags)==null?void 0:o.includes("ãƒ¡ã‚¿ãƒ«ãƒ•ã‚©ãƒ¼ã‚¼")});if(!r.length)return!1;const n=await t.activator.waitSelectEntity(r,"ã‚»ãƒƒãƒˆã™ã‚‹ã‚«ãƒ¼ãƒ‰ã‚’é¸æŠžã€‚",!1);if(!n)return!1;const s=await t.activator.duel.view.waitSelectDestination(t.activator,n,i,"ã‚»ãƒƒãƒˆã™ã‚‹å…ˆã‚’é¸æŠž","ã‚»ãƒƒãƒˆ",!1);if(!s)throw new N("ã‚»ãƒƒãƒˆå…ˆé¸æŠž",t);return await n.setAsSpellTrap(s,n.kind,["Effect"],t.action.entity,t.activator),!0},settle:async()=>!0}]}}const Zl=Object.freeze(Object.defineProperty({__proto__:null,default:eg},Symbol.toStringTag,{value:"Module"}));function*tg(){yield{name:"éŒ¬è£…èžåˆ",actions:[{title:"ç™ºå‹•",isMandatory:!1,playType:"CardActivation",spellSpeed:"Normal",executableCells:["Hand","SpellAndTrapZone"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],...aa(["ExtraDeck"],(e,t)=>{var a;return!!((a=t.status.nameTags)!=null&&a.includes("ãƒ¡ã‚¿ãƒ«ãƒ•ã‚©ãƒ¼ã‚¼"))},["Hand","MonsterZone","ExtraMonsterZone"],()=>!0)},{title:"â‘¡ãƒ‰ãƒ­ãƒ¼",isMandatory:!1,playType:"IgnitionEffect",spellSpeed:"Normal",executableCells:["Graveyard"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],executableFaces:["FaceUp"],isOnlyNTimesPerTurn:1,canExecute:e=>e.activator.getDeckCell().cardEntities.length>0&&e.activator.canDraw,prepare:async e=>(await e.action.entity.returnToDeck("Random",["Effect"],e.action.entity,e.activator),{selectedEntities:[],chainBlockTags:["Draw"]}),execute:async e=>(await e.activator.draw(1,e.action.entity,e.activator),!0),settle:async()=>!0},E]}}const Gl=Object.freeze(Object.defineProperty({__proto__:null,default:tg},Symbol.toStringTag,{value:"Module"}));function*ag(){yield{name:"ãƒ•ã‚©ãƒˆãƒ³ãƒ»ã‚¹ãƒ©ãƒƒã‚·ãƒ£ãƒ¼",actions:[{title:"ç‰¹æ®Šå¬å–š",isMandatory:!1,playType:"SpecialSummon",spellSpeed:"Normal",executableCells:["Hand"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],canExecute:e=>Q(e,T,[],["Rule"])&&!e.activator.getMonstersOnField().length,getDests:e=>We(e,T,[],["Rule"]),prepare:e=>Je(e,"SpecialSummon",["SpecialSummon","Rule"],T),execute:Ie,settle:async()=>!0}],continuousEffects:[Vt("æ”»æ’ƒä¸å¯","Monster",e=>[e],e=>[new ee({title:"æ”»æ’ƒä¸å¯",validateAlive:()=>!0,isContinuous:!0,isSpawnedBy:e,actionAttr:{},isApplicableTo:()=>!0,statusCalculator:t=>({canAttack:t.controller.getMonstersOnField().length===1})})])]}}const Ul=Object.freeze(Object.defineProperty({__proto__:null,default:ag},Symbol.toStringTag,{value:"Module"}));function*ig(){yield{name:"æ•é£Ÿæ¤ç‰©ã‚ªãƒ•ãƒªã‚¹ãƒ»ã‚¹ã‚³ãƒ¼ãƒ”ã‚ª",actions:[{title:"æ•é£Ÿæ¤ç‰©ãƒªã‚¯ãƒ«ãƒ¼ãƒˆ",isMandatory:!1,playType:"TriggerEffect",spellSpeed:"Normal",executableCells:["MonsterZone"],executablePeriods:[...C,...M],executableDuelistTypes:["Controller"],triggerPattern:{triggerType:"Arrival",arrivalReasons:["NormalSummon","SpecialSummon","FlipSummon"]},executableFaces:["FaceUp"],isOnlyNTimesPerTurn:1,fixedTags:["SpecialSummonFromDeck"],...nl(["Hand"],e=>e.kind==="Monster",1),canExecute:e=>{const t=e.activator.getDeckCell().cardEntities.filter(r=>r.kind==="Monster").filter(r=>{var n;return(n=r.status.nameTags)==null?void 0:n.includes("æ•é£Ÿæ¤ç‰©")}).filter(r=>r.nm!=="æ•é£Ÿæ¤ç‰©ã‚ªãƒ•ãƒªã‚¹ãƒ»ã‚¹ã‚³ãƒ¼ãƒ”ã‚ª"),a=e.activator.getMonsterZones();return e.activator.getEnableSummonList(e.activator,"SpecialSummon",["Effect"],e.action,t.map(r=>({monster:r,posList:T,cells:a})),[],!1).length>0},prepare:m,execute:async e=>{const t=e.activator.getDeckCell().cardEntities.filter(r=>r.kind==="Monster").filter(r=>{var n;return(n=r.status.nameTags)==null?void 0:n.includes("æ•é£Ÿæ¤ç‰©")}).filter(r=>r.nm!=="æ•é£Ÿæ¤ç‰©ã‚ªãƒ•ãƒªã‚¹ãƒ»ã‚¹ã‚³ãƒ¼ãƒ”ã‚ª"),a=e.activator.getMonsterZones();return await e.activator.summonOne(e.activator,"SpecialSummon",["Effect"],e.action,t.map(r=>({monster:r,posList:T,cells:a})),[],!1,!1)?(e.activator.getDeckCell().shuffle(),!0):!1},settle:async()=>!0}]},yield{name:"æ•é£Ÿæ¤ç‰©ãƒ€ãƒ¼ãƒªãƒ³ã‚°ãƒ»ã‚³ãƒ–ãƒ©",actions:[{title:"èžåˆã‚µãƒ¼ãƒ",isMandatory:!1,playType:"TriggerEffect",spellSpeed:"Normal",executableCells:["MonsterZone"],executablePeriods:[...C,...M],executableDuelistTypes:["Controller"],triggerPattern:{triggerType:"Arrival",arrivalReasons:["NormalSummon","SpecialSummon","FlipSummon"],causerFilter:(e,t)=>t.nm.includes("æ•é£Ÿæ¤ç‰©")&&t.kind==="Monster"},executableFaces:["FaceUp"],isOnlyNTimesPerDuel:1,fixedTags:["SearchFromDeck"],canExecute:e=>e.activator.canAddToHandFromDeck&&e.activator.getDeckCell().cardEntities.filter(t=>t.kind==="Spell").some(t=>{var a,i;return((a=t.status.nameTags)==null?void 0:a.includes("èžåˆ"))||((i=t.status.nameTags)==null?void 0:i.includes("ãƒ•ãƒ¥ãƒ¼ã‚¸ãƒ§ãƒ³"))}),prepare:m,execute:async e=>{if(!e.activator.canAddToHandFromDeck)return!1;const t=e.activator.getDeckCell().cardEntities.filter(i=>i.kind==="Spell").filter(i=>{var r,n;return((r=i.status.nameTags)==null?void 0:r.includes("èžåˆ"))||((n=i.status.nameTags)==null?void 0:n.includes("ãƒ•ãƒ¥ãƒ¼ã‚¸ãƒ§ãƒ³"))});if(!t.length)return!1;const a=await e.activator.waitSelectEntity(t,"æ‰‹æœ­ã«åŠ ãˆã‚‹ã‚«ãƒ¼ãƒ‰ã‚’é¸æŠž",!1);return a?(await a.addToHand(["Effect"],e.action.entity,e.activator),e.activator.getDeckCell().shuffle(),!0):!1},settle:async()=>!0}]}}const $l=Object.freeze(Object.defineProperty({__proto__:null,default:ig},Symbol.toStringTag,{value:"Module"}));function*rg(){yield{name:"ãƒ€ãƒ¼ã‚¯ãƒ»ãƒªã‚¾ãƒãƒ¼ã‚¿ãƒ¼",actions:[],substituteEffects:[Dp(1)]},yield{name:"ãƒ¬ãƒƒãƒ‰ãƒ»ãƒªã‚¾ãƒãƒ¼ã‚¿ãƒ¼",actions:[{title:"â‘ ç‰¹æ®Šå¬å–š",isMandatory:!1,playType:"TriggerEffect",spellSpeed:"Normal",executableCells:["MonsterZone"],executablePeriods:[...C,...M],executableDuelistTypes:["Controller"],fixedTags:["SpecialSummonFromHand","IfNormarlSummonSucceed","SpecialSummon"],meetsConditions:e=>e.action.entity.hasBeenArrivalNow(["NormalSummon"]),canExecute:e=>{const t=e.activator.getMonsterZones();return e.activator.getEnableSummonList(e.activator,"SpecialSummon",["Effect"],e.action,e.activator.getHandCell().cardEntities.filter(i=>i.kind==="Monster").filter(i=>(i.lvl??12)<5).map(i=>({monster:i,posList:T,cells:t})),[],!1).length>0},prepare:m,execute:async e=>{const t=e.activator.getMonsterZones(),a=e.activator.getHandCell().cardEntities.filter(r=>r.kind==="Monster").filter(r=>(r.lvl??12)<5).map(r=>({monster:r,posList:T,cells:t}));return!!await e.activator.summonOne(e.activator,"SpecialSummon",["Effect"],e.action,a,[],!1,!1)},settle:async()=>!0},{title:"â‘¡å›žå¾©",isMandatory:!1,playType:"TriggerEffect",spellSpeed:"Normal",executableCells:["MonsterZone"],executablePeriods:[...C,...M],executableDuelistTypes:["Controller"],isOnlyNTimesPerTurn:1,meetsConditions:e=>e.action.entity.hasBeenArrivalNow(["SpecialSummon"]),...de(e=>e.activator.getMonstersOnField().filter(t=>t.canBeTargetOfEffect(e)).filter(t=>(t.atk??0)>0).filter(t=>t.info.summonKinds.includes("SpecialSummon")),{message:"å¯¾è±¡ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã‚’é¸æŠžã€‚"}),execute:async e=>{const t=e.activator.lp;return e.selectedEntities.filter(a=>a.isOnFieldAsMonsterStrictly).forEach(a=>e.activator.heal(a.atk??0,e.action.entity)),e.activator.lp!==t},settle:async()=>!0}]}}const jl=Object.freeze(Object.defineProperty({__proto__:null,default:rg},Symbol.toStringTag,{value:"Module"}));function*ng(){yield{name:"é­”å°Žæˆ¦å£« ãƒ–ãƒ¬ã‚¤ã‚«ãƒ¼",actions:[{title:"â‘ é­”åŠ›å……å¡«",isMandatory:!0,playType:"TriggerEffect",spellSpeed:"Normal",executableCells:["MonsterZone"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],fixedTags:["IfNormarlSummonSucceed"],meetsConditions:e=>e.action.entity.hasBeenArrivalNow(["NormalSummon"]),prepare:m,execute:async e=>e.action.entity.face==="FaceDown"?!1:(e.action.entity.counterHolder.setQty("SpellCounter",1,e.action.entity),!0),settle:async()=>!0},{title:"â‘¢ãƒžãƒŠãƒ–ãƒ¬ã‚¤ã‚¯",isMandatory:!1,playType:"IgnitionEffect",spellSpeed:"Normal",executableCells:["MonsterZone"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],executableFaces:["FaceUp"],fixedTags:["Destroy","DestroyOnField","DestroySpellTrapOnField"],...Ii([1]),...de(e=>e.activator.duel.field.getSpellTrapsOnFieldStrictly().filter(t=>t.canBeTargetOfEffect(e)),{message:"ç ´å£Šã™ã‚‹å¯¾è±¡ã‚’é¸æŠžã€‚",do:"Destroy"}),execute:async e=>e.selectedEntities.every(t=>!t.isOnFieldAsSpellTrapStrictly)?!1:(await S.tryDestroy(e.selectedEntities,e),!0),settle:async()=>!0}],continuousEffects:[Ji("Monster",1),ka("â‘¡æ”»æ’ƒåŠ›ä¸Šæ˜‡","Monster",e=>[e],e=>[I.createContinuous("â‘¡æ”»æ’ƒåŠ›ä¸Šæ˜‡",()=>!0,e,()=>!0,"attack","wip","Addition",(t,a,i)=>t.isEffective?i+t.counterHolder.getQty("SpellCounter")*300:i)])]},yield{name:"çŽ‹ç«‹é­”æ³•å›³æ›¸é¤¨",actions:[{...Mf("â‘ ",1)},{title:"â‘¡ãƒ‰ãƒ­ãƒ¼",isMandatory:!1,playType:"IgnitionEffect",spellSpeed:"Normal",executableCells:["MonsterZone"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],executableFaces:["FaceUp"],...Ii([3]),canExecute:e=>e.activator.getDeckCell().cardEntities.length>0,prepare:m,execute:async e=>(await e.activator.draw(1,e.action.entity,e.activator),!0),settle:async()=>!0}],continuousEffects:[Ji("Monster",3)]}}const zl=Object.freeze(Object.defineProperty({__proto__:null,default:ng},Symbol.toStringTag,{value:"Module"}));function*sg(){yield{name:"ã‚¹ã‚¿ãƒ¼ãƒ€ã‚¹ãƒˆãƒ»ãƒ‰ãƒ©ã‚´ãƒ³",actions:[be(),{title:"â‘ ãƒ´ã‚£ã‚¯ãƒ†ãƒ ãƒ»ã‚µãƒ³ã‚¯ãƒãƒ¥ã‚¢ãƒª",isMandatory:!1,playType:"QuickEffect",spellSpeed:"Quick",executableCells:["MonsterZone","ExtraMonsterZone"],executablePeriods:ae,executableDuelistTypes:["Controller"],executableFaces:["FaceUp"],canPayCosts:xa,canExecute:e=>!!(e.targetChainBlock&&e.targetChainBlock.action.isWithChainBlock&&e.targetChainBlock.chainBlockTags.includes("DestroyOnField")),payCosts:Pa,prepare:async e=>{if(!e.targetChainBlock)throw new P("UnexpectedSituation",e);return{selectedEntities:[],chainBlockTags:e.action.calcChainBlockTagsForDestroy(e.activator,[e.targetChainBlock.action.entity]),prepared:void 0}},execute:async(e,t)=>{const a=t[e.index-1];return a.isNegatedActivationBy=e.action,await S.tryDestroy([a.action.entity],e),!0},settle:async()=>!0},{title:"â‘¡è‡ªå·±å†ç”Ÿ",playType:"IgnitionEffect",isMandatory:!1,spellSpeed:"Normal",executableCells:["Graveyard"],executablePeriods:["end"],executableDuelistTypes:["Controller"],executableFaces:["FaceUp"],fixedTags:["SpecialSummonFromGraveyard"],canExecute:e=>{const t=e.action.entity.moveLog.latestRecord;if(!t.movedBy||!e.action.entity.isSame(t.movedBy)||!e.activator.duel.clock.isSameTurn(t.movedAt)||!t.movedAs.includes("Cost"))return!1;const a=e.activator.duel,i=e.action.entity.actionLogRecords.filter(r=>a.clock.isSameTurn(r.clock)).map(r=>r.chainBlockInfo).findLast(r=>r.action.title==="â‘ ãƒ´ã‚£ã‚¯ãƒ†ãƒ ãƒ»ã‚µãƒ³ã‚¯ãƒãƒ¥ã‚¢ãƒª");return!i||i.state!=="done"?!1:Q(e,T,[],["Effect"])},prepare:m,execute:ve,settle:async()=>!0}]},yield{name:"é–ƒç–ç«œ ã‚¹ã‚¿ãƒ¼ãƒ€ã‚¹ãƒˆ",actions:[be(),{title:"æ³¢å‹•éŸ³å£",isMandatory:!1,playType:"QuickEffect",spellSpeed:"Quick",executableCells:x,executablePeriods:C,executableDuelistTypes:["Controller"],executableFaces:["FaceUp"],isOnlyNTimesPerTurnIfFaceup:1,...de(e=>e.activator.getEntiteisOnField().filter(t=>t.face==="FaceUp").filter(t=>t.canBeTargetOfEffect(e))),execute:async e=>(e.selectedEntities.filter(t=>t.isOnFieldStrictly).filter(t=>t.face==="FaceUp").filter(t=>t.canBeEffected(e.activator,e.action.entity,e.action)).forEach(t=>{t.counterHolder.add("SonicBarrier",1,e.action.entity)}),!0),settle:async()=>!0}],substituteEffects:[{title:"æ³¢å‹•éŸ³å£ï¼ˆé©ç”¨ï¼‰",playType:"LingeringEffect",isMandatory:!0,executableCells:Ke,executablePeriods:ae,executableDuelistTypes:["Controller"],isApplicableTo:(e,t,a)=>a.filter(i=>i.counterHolder.getQty("SonicBarrier",e.entity)>0),substitute:async(e,t,a)=>{const i=a.filter(r=>r.counterHolder.getQty("SonicBarrier",e.entity)>0);return i.forEach(r=>{r.counterHolder.removeAll("SonicBarrier",e.entity),e.entity.controller.writeInfoLog(`æ³¢å‹•éŸ³å£ã«ã‚ˆã‚Š${r.toString()}ã¯ï¼‘ã‚¿ãƒ¼ãƒ³ã«ï¼‘åº¦ã ã‘æˆ¦é—˜åŠ¹æžœã§ã¯ç ´å£Šã•ã‚Œãªã„ã€‚`)}),i}}]},yield{name:"çœŸé–ƒç–ç«œ ã‚¹ã‚¿ãƒ¼ãƒ€ã‚¹ãƒˆãƒ»ã‚¯ãƒ­ãƒ‹ã‚¯ãƒ«",actions:[be(e=>e.length===1&&e.every(t=>{var a;return(a=t.status.monsterCategories)==null?void 0:a.includes("Synchro")}),e=>e.length>0&&e.every(t=>{var a;return(a=t.status.monsterCategories)==null?void 0:a.includes("Synchro")})),{title:"æ³¢å‹•è­·é­‚",isMandatory:!1,playType:"QuickEffect",spellSpeed:"Quick",executableCells:x,executablePeriods:C,executableDuelistTypes:["Controller"],executableFaces:["FaceUp"],isOnlyNTimesPerTurnIfFaceup:1,...Aa(e=>e.activator.getGraveyard().cardEntities.filter(t=>{var a;return(a=t.status.monsterCategories)==null?void 0:a.includes("Synchro")})),prepare:m,execute:async e=>(e.action.entity.procFilterBundle.push(we.createLingering(e.action.title,t=>t.duel.clock.isSameTurn(t.isSpawnedAt),e.action.entity,e.action,()=>!0,["Effect"],()=>!1)),!0),settle:async()=>!0},{title:"â‘¡è˜‡ç”Ÿ",isMandatory:!1,playType:"TriggerEffect",spellSpeed:"Normal",executableCells:["Banished"],executablePeriods:[...C,...M],executableDuelistTypes:["Controller"],fixedTags:["SpecialSummonFromGraveyard"],meetsConditions:e=>e.action.entity.wasMovedAtPreviousChain&&e.action.entity.moveLog.latestRecord.actionOwner!==e.activator&&(e.action.entity.wasMovedFrom.owner===e.activator||e.action.entity.wasMovedFrom.cellType==="ExtraMonsterZone"),...Ye(e=>e.activator.getBanished().cardEntities.filter(t=>t.kind==="Monster").filter(t=>t.face==="FaceUp").filter(t=>t.types.includes("Dragon")).filter(t=>{var a;return(a=t.status.monsterCategories)==null?void 0:a.includes("Synchro")}).filter(t=>t.canBeTargetOfEffect(e))),settle:async()=>!0}]},yield{name:"è–ç–ç¥žç«œ ã‚¹ã‚¿ãƒ¼ãƒ€ã‚¹ãƒˆãƒ»ã‚·ãƒ•ãƒ«",actions:[be(e=>e.length===1&&e.every(t=>{var a;return(a=t.status.monsterCategories)==null?void 0:a.includes("Synchro")}),e=>e.length>1&&e.every(t=>{var a;return(a=t.status.monsterCategories)==null?void 0:a.includes("Synchro")})),{title:"â‘¡ç–æ³¢å‹•åæ’ƒ",isMandatory:!1,playType:"QuickEffect",spellSpeed:"Quick",executableCells:["Hand"],executablePeriods:C,executableDuelistTypes:["Controller"],executableFaces:["FaceUp"],isOnlyNTimesPerTurnIfFaceup:1,negatePreviousBlock:!0,fixedTags:["NegateCardEffect","DestroyOnField"],canExecute:e=>!!(e.targetChainBlock&&e.targetChainBlock.action.entity.isMonster&&e.targetChainBlock.action.isWithChainBlock&&e.activator!==e.targetChainBlock.activator),prepare:m,execute:async e=>{if(!e.targetChainBlock)return!1;const t=e.targetChainBlock;t.isNegatedEffectBy=e.action;const a=await e.activator.waitSelectEntity(e.action.duel.field.getCardsOnFieldStrictly(),"ç ´å£Šã™ã‚‹ã‚«ãƒ¼ãƒ‰ã‚’é¸æŠžã€‚",!1);return(await S.tryDestroy(a?[a]:[],e)).length>0},settle:async()=>!0},{title:"â‘¢è˜‡ç”Ÿ",isMandatory:!1,playType:"IgnitionEffect",spellSpeed:"Normal",executableCells:["Graveyard"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],executableFaces:["FaceUp"],priorityForNPC:10,fixedTags:["SpecialSummonFromGraveyard"],...Ti(),...Ye(e=>e.activator.getGraveyard().cardEntities.filter(t=>{var a;return(a=t.status.nameTags)==null?void 0:a.includes("ã‚¹ã‚¿ãƒ¼ãƒ€ã‚¹ãƒˆ")}).filter(t=>(t.lvl??12)<9)),settle:async()=>!0}],substituteEffects:[{title:"æ³¢å‹•è–å¥",playType:"ContinuousEffect",isMandatory:!0,executableCells:x,executablePeriods:ae,executableDuelistTypes:["Controller"],isApplicableTo:(e,t,a)=>a.filter(i=>i.controller===e.entity.controller).filter(i=>i.counterHolder.getQty("SonicVerse",e.entity)===0),substitute:async(e,t,a)=>{if(!e.entity.isEffective)return[];const i=a.filter(r=>r.controller===e.entity.controller).filter(r=>r.counterHolder.getQty("SonicVerse",e.entity)===0);return i.forEach(r=>{r.counterHolder.add("SonicVerse",1,e.entity),e.entity.controller.writeInfoLog(`${e.entity.toString()}ã®åŠ¹æžœã«ã‚ˆã‚Š${r.toString()}ã¯ï¼‘ã‚¿ãƒ¼ãƒ³ã«ï¼‘åº¦ã ã‘ç ´å£Šã•ã‚Œãªã„ã€‚`)}),i}}]}}const Vl=Object.freeze(Object.defineProperty({__proto__:null,default:sg},Symbol.toStringTag,{value:"Module"}));function*lg(){yield{name:"èª¿å¾‹",actions:[{title:"ç™ºå‹•",isMandatory:!1,playType:"CardActivation",spellSpeed:"Normal",executableCells:["Hand","SpellAndTrapZone"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],fixedTags:["SearchFromDeck","SendToGraveyardFromDeck"],priorityForNPC:40,canExecute:e=>{const t=e.activator.getDeckCell().cardEntities;return t.length<2?!1:t.filter(a=>{var i;return(i=a.status.nameTags)==null?void 0:i.includes("ã‚·ãƒ³ã‚¯ãƒ­ãƒ³")}).some(a=>{var i;return(i=a.status.monsterCategories)==null?void 0:i.includes("Tuner")})},prepare:m,execute:async e=>{const t=e.activator.getDeckCell().cardEntities;if(t.length<2)return!1;const a=t.filter(r=>{var n;return(n=r.status.nameTags)==null?void 0:n.includes("ã‚·ãƒ³ã‚¯ãƒ­ãƒ³")}).filter(r=>{var n;return(n=r.status.monsterCategories)==null?void 0:n.includes("Tuner")});if(a.length===0)return!1;const i=await e.activator.waitSelectEntity(a,"æ‰‹æœ­ã«åŠ ãˆã‚‹ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã‚’é¸æŠž",!1);if(!i)throw new N(e);return await i.addToHand(["Effect"],e.action.entity,e.activator),e.activator.getDeckCell().shuffle(),await e.activator.duel.clock.incrementProcSeq(),await e.activator.getDeckCell().cardEntities[0].sendToGraveyard(["Effect"],e.action.entity,e.activator),!0},settle:async()=>!0},E]}}const Ql=Object.freeze(Object.defineProperty({__proto__:null,default:lg},Symbol.toStringTag,{value:"Module"}));function*og(){yield{name:"ãƒ•ã‚©ãƒ¼ãƒŸãƒ¥ãƒ©ãƒ»ã‚·ãƒ³ã‚¯ãƒ­ãƒ³",actions:[be(),{title:"â‘ ãƒ‰ãƒ­ãƒ¼",isMandatory:!1,playType:"TriggerEffect",spellSpeed:"Normal",executableCells:x,executablePeriods:[...C,...M],executableDuelistTypes:["Controller"],fixedTags:["Draw","IfSpecialSummonSucceed"],meetsConditions:e=>e.action.entity.hasBeenArrivalNow(["SynchroSummon"],T,!0),canExecute:e=>e.activator.canDraw&&e.activator.getDeckCell().cardEntities.length>0,prepare:m,execute:async e=>(await e.activator.draw(1,e.action.entity,e.activator),!0),settle:async()=>!0},xs({title:"â‘¡ã‚·ãƒ³ã‚¯ãƒ­å¬å–š",isOnlyNTimesPerChain:1})]}}const Wl=Object.freeze(Object.defineProperty({__proto__:null,default:og},Symbol.toStringTag,{value:"Module"}));function*cg(){yield{name:"ãƒˆã‚¥ãƒ¼ãƒ³ãƒ»ãƒ¯ãƒ¼ãƒ«ãƒ‰",actions:[{...lt,canPayCosts:e=>e.activator.lp>=1e3,payCosts:(e,t)=>ea(e,t,1e3)},E]}}const Xl=Object.freeze(Object.defineProperty({__proto__:null,default:cg},Symbol.toStringTag,{value:"Module"}));function*ug(){yield{name:"ãƒˆãƒãƒ­ã‚¸ãƒƒã‚¯ãƒ»ãƒœãƒžãƒ¼ãƒ»ãƒ‰ãƒ©ã‚´ãƒ³",actions:[Ze(e=>e.length>1&&e.every(t=>{var a;return(a=t.status.monsterCategories)==null?void 0:a.includes("Effect")})),{title:"ãƒ•ãƒ«ã‚ªãƒ¼ãƒãƒ¼ãƒ©ãƒƒãƒ—",isMandatory:!0,playType:"TriggerEffect",spellSpeed:"Normal",executableCells:x,executablePeriods:[...C,...M],executableDuelistTypes:["Controller"],fixedTags:["DestroyMonsterOnField"],canExecute:e=>{if(!e.activator.duel.field.getMonstersOnFieldStrictly().filter(i=>i.wasMovedAtPreviousChain).filter(i=>i.linkedEntities.length).length)return!1;const a=e.action.entity.hadArrivedToFieldAt();return a?e.activator.duel.field.getMonstersOnFieldStrictly().filter(i=>i.hasBeenArrivalNow(["SpecialSummon"])).filter(i=>{var r;return(((r=i.hadArrivedToFieldAt())==null?void 0:r.totalProcSeq)??0)>(a==null?void 0:a.totalProcSeq)}).some(i=>{const r=i.hadArrivedToFieldAt();return r?i.linkArrowSources.some(n=>n.wasMovedBefore(r)):!1}):!1},prepare:async e=>{const t=e.action.entity.field.getMonstersOnFieldStrictly().filter(a=>a.cell.cellType==="MonsterZone");return{selectedEntities:[],chainBlockTags:e.action.calcChainBlockTagsForDestroy(e.activator,t)}},execute:async e=>{const t=e.action.entity.field.getMonstersOnFieldStrictly().filter(a=>a.cell.cellType==="MonsterZone");return await S.tryDestroy(t,e),!e.activator.isTurnPlayer||e.activator.duel.clock.period.phase==="end"||e.activator.duel.clock.period.phase==="main2"||e.activator.duel.field.statusOperatorPool.push(new ee({title:"æ”»æ’ƒæŠ‘æ­¢",validateAlive:a=>a.duel.clock.isSameTurn(a.isSpawnedAt),isContinuous:!1,isSpawnedBy:e.action.entity,actionAttr:e.action,isApplicableTo:(a,i)=>i.controller===a.effectOwner&&i!==a.isSpawnedBy&&i.isOnFieldAsMonsterStrictly,statusCalculator:()=>({canAttack:!1})})),!0},settle:async()=>!0},{title:"ã‚¨ã‚¤ãƒŸãƒ³ã‚°ãƒ»ãƒ–ãƒ©ã‚¹ãƒˆ",isMandatory:!0,playType:"TriggerEffect",spellSpeed:"Normal",executableCells:[...x,"Graveyard","Banished"],executablePeriods:["b1DAfterDmgCalc","b2DAfterDmgCalc"],executableDuelistTypes:["Controller"],fixedTags:["DamageToOpponent"],meetsConditions:e=>!!(e.activator.duel.attackingMonster===e.action.entity&&e.activator.duel.targetForAttack&&e.activator.duel.targetForAttack.entityType==="Card"&&(e.activator.duel.targetForAttack.origin.attack??0)>0),prepare:m,execute:async e=>{if(!e.activator.duel.targetForAttack)throw new P("UnexpectedSituation",e);return e.activator.getOpponentPlayer().effectDamage(e.activator.duel.targetForAttack.atk??0,e),!0},settle:async()=>!0}]}}const Kl=Object.freeze(Object.defineProperty({__proto__:null,default:ug},Symbol.toStringTag,{value:"Module"}));function*dg(){yield{name:"ç„¡ã®ç…‰ç„",actions:[{title:"ç™ºå‹•",isMandatory:!1,playType:"CardActivation",spellSpeed:"Normal",executableCells:["Hand","SpellAndTrapZone"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],fixedTags:["Draw","DiscordAsEffect"],meetsConditions:e=>e.activator.getHandCell().cardEntities.length>2,canExecute:e=>e.activator.canDraw&&e.activator.status.canDiscardAsEffect&&e.activator.getDeckCell().cardEntities.length>0,prepare:m,execute:async e=>(await e.activator.draw(1,e.action.entity,e.activator),e.activator.entity.counterHolder.add("IntoTheVoid",1,e.action.entity),!0),settle:async()=>!0},{title:"æ‰‹æœ­æŠ¹æ®º",isMandatory:!0,playType:"LingeringEffect",spellSpeed:"Normal",executableCells:Ke,executablePeriods:["end"],executableDuelistTypes:Qt,meetsConditions:e=>e.activator.entity.counterHolder.getQty("IntoTheVoid",e.action.entity)>0,prepare:m,execute:async e=>(await S.discardManyForTheSameReason(e.activator.getHandCell().cardEntities,["Effect"],e.action.entity,e.activator),e.activator.entity.counterHolder.remove("IntoTheVoid",1,e.action.entity),!0),settle:async()=>!0},E]}}const Yl=Object.freeze(Object.defineProperty({__proto__:null,default:dg},Symbol.toStringTag,{value:"Module"}));function*pg(){yield{name:"æ˜Ÿæ¯ã®å¦–ç²¾ãƒªãƒ¼ã‚¹",actions:[{title:"â‘ ã‚µãƒ¼ãƒ",isMandatory:!1,playType:"TriggerEffect",spellSpeed:"Normal",executableCells:["MonsterZone"],executablePeriods:[...C,...M],executableDuelistTypes:["Controller"],isOnlyNTimesPerTurn:1,fixedTags:["SearchFromDeck"],meetsConditions:e=>e.action.entity.hasBeenArrivalNow(["NormalSummon","SpecialSummon"]),canExecute:e=>e.activator.canAddToHandFromDeck&&e.activator.getDeckCell().cardEntities.filter(t=>t.kind==="Monster").some(t=>{var a;return(a=t.status.nameTags)==null?void 0:a.includes("æ˜Ÿæ¯")}),prepare:async e=>{const t=e.action.entity.hasBeenArrivalNow(["NormalSummon"])?["IfNormarlSummonSucceed"]:["IfSpecialSummonSucceed"];return{selectedEntities:[],chainBlockTags:t}},execute:async e=>{const t=e.activator.getDeckCell().cardEntities.filter(i=>i.kind==="Monster").filter(i=>{var r;return(r=i.status.nameTags)==null?void 0:r.includes("æ˜Ÿæ¯")});if(t.length===0)return!1;const a=await e.activator.waitSelectEntity(t,"æ‰‹æœ­ã«åŠ ãˆã‚‹ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã‚’é¸æŠž",!1);if(!a)throw new P("UnexpectedSituation",e);return await a.addToHand(["Effect"],e.action.entity,e.activator),e.activator.getDeckCell().shuffle(),!0},settle:async()=>!0},{title:"â‘¡è‡ªå·±ã‚µãƒ«ãƒ™ãƒ¼ã‚¸",isMandatory:!1,playType:"IgnitionEffect",spellSpeed:"Normal",executableCells:["Graveyard"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],executableFaces:["FaceUp"],isOnlyNTimesPerTurn:1,canPayCosts:e=>[...e.activator.getMonstersOnField(),...e.activator.getHandCell().cardEntities.filter(t=>t.kind==="Monster")].some(t=>t.canBeSentToGraveyard(e.activator,e.action.entity,"SendToGraveyardAsCost",e.action)),payCosts:async e=>{const t=[...e.activator.getMonstersOnField(),...e.activator.getHandCell().cardEntities.filter(r=>r.kind==="Monster")].filter(r=>r.canBeSentToGraveyard(e.activator,e.action.entity,"SendToGraveyardAsCost",e.action)),a=await e.activator.waitSelectEntity(t,"å¢“åœ°ã«é€ã‚‹ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã‚’é¸æŠžã€‚",!0);if(!a)return;const i={cost:a,cell:a.cell};return await a.sendToGraveyard(["Cost"],e.action.entity,e.activator),{sendToGraveyard:[i]}},fixedTags:["SearchFromDeck"],prepare:m,execute:async e=>e.action.entity.wasMovedAfter(e.isActivatedAt)?!1:(await e.action.entity.addToHand(["Effect"],e.action.entity,e.activator),!0),settle:async()=>!0}]},yield{name:"æ˜Ÿéºç‰©ï¼ã€Žæ˜Ÿæ¯ã€",actions:[{title:"â‘ å¢“åœ°é€ã‚Š",isMandatory:!1,playType:"TriggerEffect",spellSpeed:"Normal",executableCells:["MonsterZone"],executablePeriods:[...C,...M],executableDuelistTypes:["Controller"],canPayCosts:xa,canExecute:e=>e.activator.duel.field.moveLog.getPriviousChainLog().filter(t=>t.movedAs.includes("SpecialSummon")).map(t=>t.entity).some(t=>t.wasMovedFrom.cellType==="ExtraDeck"),payCosts:Pa,prepare:m,execute:async e=>{const t=e.activator.duel.field.moveLog.getPriviousChainLog().filter(a=>a.movedAs.includes("SpecialSummon")).map(a=>a.entity).filter(a=>a.wasMovedFrom.cellType==="ExtraDeck").filter(a=>a.isOnFieldAsMonsterStrictly).filter(a=>a.canBeEffected(e.activator,e.action.entity,e.action)).toArray();return await S.sendManyToGraveyardForTheSameReason(t,["Effect"],e.action.entity,e.activator),!0},settle:async()=>!0},{title:"â‘¡ãƒªã‚¯ãƒ«ãƒ¼ãƒˆ",isMandatory:!1,playType:"TriggerEffect",spellSpeed:"Normal",executableCells:["Hand","Graveyard","Banished"],executablePeriods:[...C,...M],executableDuelistTypes:["Controller"],meetsConditions:e=>e.action.entity.wasMovedAtPreviousChain&&e.action.entity.info.summonKinds.includes("NormalSummon")&&e.action.entity.moveLog.previousPlaceRecord.face==="FaceUp",canExecute:e=>{const t=e.activator.getDeckCell().cardEntities.filter(r=>r.kind==="Monster").filter(r=>{var n;return(n=r.status.nameTags)==null?void 0:n.includes("æ˜Ÿæ¯")}).filter(r=>r.nm!=="æ˜Ÿéºç‰©ï¼ã€Žæ˜Ÿæ¯ã€"),a=e.activator.getMonsterZones(),i=e.activator.getEnableSummonList(e.activator,"SpecialSummon",["Effect"],e.action,t.map(r=>({monster:r,cells:a,posList:T})),[],!1);return i.length>1&&i.flatMap(r=>r.cells).getDistinct().length>1},prepare:m,execute:async e=>{const t=e.activator.getDeckCell().cardEntities.filter(r=>r.kind==="Monster").filter(r=>{var n;return(n=r.status.nameTags)==null?void 0:n.includes("æ˜Ÿæ¯")}).filter(r=>r.nm!=="æ˜Ÿéºç‰©ï¼ã€Žæ˜Ÿæ¯ã€"),a=e.activator.getMonsterZones();return(await e.activator.summonMany(e.activator,"SpecialSummon",["Effect"],e.action,t.map(r=>({monster:r,cells:a,posList:T})),[],!1,2,r=>r.length==2,!1)??[]).length?(e.activator.getDeckCell().shuffle(),!0):!1},settle:async()=>!0},{title:"â‘¢ã‚µãƒ¼ãƒ",isMandatory:!1,playType:"IgnitionEffect",spellSpeed:"Normal",executableCells:["Graveyard"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],executableFaces:["FaceUp"],...Ti(),meetsConditions:e=>!e.action.entity.wasMovedAtCurrentTurn,canExecute:e=>e.activator.canAddToHandFromDeck&&e.activator.getDeckCell().cardEntities.filter(t=>{var a;return(a=t.status.nameTags)==null?void 0:a.includes("æ˜Ÿéºç‰©")}).length>0,fixedTags:["SearchFromDeck"],prepare:m,execute:async e=>{const t=await e.activator.waitSelectEntity(e.activator.getDeckCell().cardEntities.filter(a=>{var i;return(i=a.status.nameTags)==null?void 0:i.includes("æ˜Ÿéºç‰©")}),"æ‰‹æœ­ã«åŠ ãˆã‚‹ã‚«ãƒ¼ãƒ‰ã‚’é¸æŠž",!1);return t?(await t.addToHand(["Effect"],e.action.entity,e.activator),!0):!1},settle:async()=>!0}]}}const Jl=Object.freeze(Object.defineProperty({__proto__:null,default:pg},Symbol.toStringTag,{value:"Module"}));function*fg(){yield{name:"ãƒ‰ãƒƒãƒˆã‚¹ã‚±ãƒ¼ãƒ‘ãƒ¼",actions:[{title:"â‘ è‡ªå·±å†ç”Ÿ",isMandatory:!1,playType:"TriggerEffect",spellSpeed:"Normal",executableCells:["Graveyard"],executablePeriods:[...C,...M],executableDuelistTypes:["Controller"],isOnlyNTimesPerDuel:1,actionGroupName:"ãƒ‰ãƒƒãƒˆã‚¹ã‚±ãƒ¼ãƒ‘ãƒ¼",fixedTags:["SpecialSummonFromGraveyard"],meetsConditions:e=>e.action.entity.wasMovedAtPreviousChain&&e.action.entity.wasMovedFrom.cellType!=="Banished",canExecute:e=>Q(e,T,[],["Effect"]),prepare:m,execute:ve,settle:async()=>!0},{title:"â‘¡è‡ªå·±å¸°é‚„",isMandatory:!1,playType:"TriggerEffect",spellSpeed:"Normal",executableCells:["Banished"],executablePeriods:[...C,...M],executableDuelistTypes:["Controller"],isOnlyNTimesPerDuel:1,actionGroupName:"ãƒ‰ãƒƒãƒˆã‚¹ã‚±ãƒ¼ãƒ‘ãƒ¼",fixedTags:["SpecialSummonFromBanished"],meetsConditions:e=>e.action.entity.wasMovedAtPreviousChain,canExecute:e=>Q(e,T,[],["Effect"]),prepare:m,execute:ve,settle:async()=>!0}]}}const Il=Object.freeze(Object.defineProperty({__proto__:null,default:fg},Symbol.toStringTag,{value:"Module"}));function*gg(){yield{name:"éŽ–é¾è›‡ï¼ã‚¹ã‚«ãƒ«ãƒ‡ãƒƒãƒˆ",actions:[Ze(e=>e.length>1&&e.length===e.map(t=>t.nm).getDistinct().length),{title:"æ”»å®ˆå¼·åŒ–",isMandatory:!0,playType:"TriggerEffect",spellSpeed:"Normal",executableCells:x,executablePeriods:[...C,...M],executableDuelistTypes:["Controller"],meetsConditions:e=>e.action.entity.info.materials.length>1,canExecute:e=>{const t=e.action.entity.moveLog.latestRecord.movedAt;return e.action.entity.linkArrowDests.filter(a=>a.cardEntities.length).map(a=>a.cardEntities[0]).filter(a=>a.wasMovedAfter(t)).filter(a=>a.hasBeenArrivalNow(["NormalSummon","SpecialSummon"])).some(a=>a.face==="FaceUp")},prepare:async e=>{const t=e.action.entity.moveLog.latestRecord.movedAt;return e.data=e.action.entity.linkArrowDests.filter(a=>a.cardEntities.length).map(a=>a.cardEntities[0]).filter(a=>a.wasMovedAfter(t)).filter(a=>a.hasBeenArrivalNow(["NormalSummon","SpecialSummon"])).filter(a=>a.face==="FaceUp"),{}},execute:async e=>e.data?(e.data.filter(t=>t.face==="FaceUp").filter(t=>t.isOnFieldAsMonsterStrictly).forEach(t=>{["attack","defense"].map(a=>I.createLingeringAddition(e.action.title,i=>i.isSpawnedBy.isEffective,e.action.entity,e.action,a,(i,r,n)=>n+300)).forEach(a=>t.numericOprsBundle.push(a))}),!0):!1,settle:async()=>!0},{title:"ç‰¹æ®Šå¬å–š",isMandatory:!1,playType:"IgnitionEffect",spellSpeed:"Normal",executableCells:x,executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],executableFaces:["FaceUp"],isOnlyNTimesPerTurnIfFaceup:1,fixedTags:["SpecialSummonFromHand"],canExecute:e=>{const t=e.activator.getMonsterZones();return e.activator.getEnableSummonList(e.activator,"SpecialSummon",["Effect"],e.action,e.activator.getHandCell().cardEntities.filter(i=>i.kind==="Monster").map(i=>({monster:i,posList:T,cells:t})),[],!1).length>0},prepare:m,execute:async e=>{const t=e.activator.getMonsterZones();return!!await e.activator.summonOne(e.activator,"SpecialSummon",["Effect"],e.action,e.activator.getHandCell().cardEntities.filter(i=>i.kind==="Monster").map(i=>({monster:i,posList:T,cells:t})),[],!1,!1)},settle:async()=>!0},{title:"æ‰‹æœ­äº¤æ›",isMandatory:!1,playType:"TriggerEffect",spellSpeed:"Normal",executableCells:x,executablePeriods:C,executableDuelistTypes:["Controller"],fixedTags:["Draw"],meetsConditions:e=>e.action.entity.hasBeenArrivalNow(["LinkSummon"]),canExecute:e=>e.activator.getDeckCell().cardEntities.length>3,prepare:m,execute:async e=>{if(e.activator.getDeckCell().cardEntities.length<4)return!1;await e.activator.draw(4,e.action.entity,e.activator),await e.action.duel.clock.incrementProcSeq();for(const t of[1,2,3]){const a=await e.activator.waitSelectEntity(e.activator.getHandCell().cardEntities,`ãƒ‡ãƒƒã‚­ã®ä¸€ç•ªä¸‹ã«æˆ»ã™ã‚«ãƒ¼ãƒ‰ã‚’é¸æŠžï¼ˆ${t}æžšç›®ï¼‰ã€‚`);if(!a)throw new N(e);await a.returnToDeck("Bottom",["Effect"],e.action.entity,e.activator)}return!0},settle:async()=>!0}]}}const eo=Object.freeze(Object.defineProperty({__proto__:null,default:gg},Symbol.toStringTag,{value:"Module"}));function*hg(){yield{name:"ã‚¼ãƒ©ã®å¤©ä½¿",actions:[be(),{title:"â‘¡è‡ªå·±å¸°é‚„",isMandatory:!0,playType:"IgnitionEffect",spellSpeed:"Normal",executableCells:["Banished"],executablePeriods:["stanby"],executableDuelistTypes:["Controller"],executableFaces:["FaceUp"],fixedTags:["SpecialSummonFromBanished"],meetsConditions:e=>e.action.entity.wasMovedAtPreviousTurn,canExecute:e=>Q(e,T,[],["Effect"]),prepare:m,execute:ve,settle:async()=>!0}],continuousEffects:[ka("â‘¡æ”»æ’ƒåŠ›ä¸Šæ˜‡","Monster",e=>[e],e=>[I.createContinuous("â‘ æ”»æ’ƒåŠ›ä¸Šæ˜‡",()=>!0,e,()=>!0,"attack","wip","Addition",(t,a,i)=>t.isEffective?i+t.controller.getOpponentPlayer().getBanished().cardEntities.length*100:i)])]}}const to=Object.freeze(Object.defineProperty({__proto__:null,default:hg},Symbol.toStringTag,{value:"Module"}));function*yg(){yield{name:"æ­»éœŠé¨Žå£«ãƒ‡ã‚¹ã‚«ãƒªãƒãƒ¼ãƒ»ãƒŠã‚¤ãƒˆ",actions:[{title:"â‘ ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼åŠ¹æžœç„¡åŠ¹",isMandatory:!0,playType:"TriggerEffect",spellSpeed:"Quick",executableCells:x,executablePeriods:[...C,...M],executableDuelistTypes:["Controller"],negatePreviousBlock:!0,canPayCosts:xa,canExecute:e=>!!(e.targetChainBlock&&e.targetChainBlock.action.entity.isMonster&&e.targetChainBlock.action.isWithChainBlock),payCosts:Pa,prepare:async(e,t)=>{const a=e.targetChainBlock,i=t[e.index-1];return a!==i?{selectedEntities:[]}:{selectedEntities:[],chainBlockTags:["NegateCardEffect",...e.action.calcChainBlockTagsForDestroy(e.activator,[a.action.entity])],prepared:void 0}},execute:async(e,t)=>{const a=t.find(r=>r.action.entity.isMonster&&r.action.isWithChainBlock),i=t[e.index-1];return i!==a?!1:(i.isNegatedActivationBy=e.action,await S.tryDestroy([i.action.entity],e),!0)},settle:async()=>!0}]},yield{name:"ï¼§ãƒ»ã‚³ã‚¶ãƒƒã‚­ãƒ¼",actions:[{title:"è‡ªæ»…ãƒ€ãƒ¡ãƒ¼ã‚¸",isMandatory:!0,playType:"TriggerEffect",spellSpeed:"Normal",executableCells:yi,executablePeriods:[...C,...M],executableDuelistTypes:["Controller"],triggerPattern:{triggerType:"Departure",from:me},meetsConditions:e=>e.action.entity.moveLog.previousPlaceRecord.face==="FaceUp",prepare:async e=>e.action.entity.moveLog.previousPlaceRecord.cell.owner!==e.action.entity.controller?{chainBlockTags:["DamageToOpponent"]}:{chainBlockTags:["DamageToSelf"]},execute:async e=>(e.chainBlockTags.includes("DamageToOpponent")?e.activator.getOpponentPlayer():e.activator).effectDamage(e.action.entity.origin.attack??0,e).length>0,settle:async()=>!0}],immediatelyActions:[{title:"è‡ªå£Š",executableCells:["MonsterZone"],executablePeriods:ae.filter(e=>e!=="b1DBeforeDmgCalc"&&e!=="b2DBeforeDmgCalc"&&e!=="b1DDmgCalc"&&e!=="b2DDmgCalc"),executableFaces:["FaceUp"],execute:async e=>{e.entity.field.getCardsOnFieldStrictly().some(t=>t.nm==="ã‚³ã‚¶ãƒƒã‚­ãƒ¼")||e.entity.isEffective&&e.entity.isOnFieldAsMonsterStrictly&&(e.entity.controller.writeInfoLog(`ã‚³ã‚¶ãƒƒã‚­ãƒ¼ãŒãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ä¸Šã«å­˜åœ¨ã—ãªã„ãŸã‚ã€${e.entity.toString()}ã¯ç ´å£Šã•ã‚Œã‚‹ã€‚`),S.tryMarkForDestroy([e.entity],{activator:e.entity.controller,action:e,selectedEntities:[]}),e.entity.info.isDying=!0,e.entity.info.causeOfDeath=["Effect","Destroy"])}}]}}const ao=Object.freeze(Object.defineProperty({__proto__:null,default:yg},Symbol.toStringTag,{value:"Module"}));function*vg(){yield{name:"é­”ã‚µã‚¤ã®æˆ¦å£«",actions:[{title:"â‘¡å¢“åœ°é€ã‚Š",isMandatory:!1,playType:"TriggerEffect",spellSpeed:"Normal",executableCells:["Graveyard"],executablePeriods:[...C,...M],executableDuelistTypes:["Controller"],triggerPattern:{triggerType:"Departure"},fixedTags:["SendToGraveyardFromDeck"],isOnlyNTimesPerTurn:1,canExecute:e=>e.activator.getDeckCell().cardEntities.some(t=>t.types.includes("Fiend")),prepare:m,execute:async e=>{const t=e.activator.getDeckCell().cardEntities.filter(i=>i.types.includes("Fiend"));if(!t.length)return!1;const a=await e.activator.waitSelectEntity(t,"å¢“åœ°ã«é€ã‚‹ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã‚’é¸æŠžã€‚",!1);if(!a)throw new N(e);return await a.sendToGraveyard(["Effect"],e.action.entity,e.activator),e.activator.getDeckCell().shuffle(),!0},settle:async()=>!0}],continuousEffects:[gr("â‘ ç ´å£Šè€æ€§ä»˜ä¸Ž","Monster",e=>[we.createContinuous("â‘ ç ´å£Šè€æ€§ä»˜ä¸Ž",()=>!0,e,(t,a)=>a.types.includes("Fiend")&&a.face==="FaceUp"&&a.isOnFieldAsMonsterStrictly&&a.nm!=="é­”ã‚µã‚¤ã®æˆ¦å£«",["EffectDestroy","BattleDestroy"],()=>!1)])]}}const io=Object.freeze(Object.defineProperty({__proto__:null,default:vg},Symbol.toStringTag,{value:"Module"}));function*mg(){yield{name:"ã‚¬ãƒ«ã‚¬ãƒ«ãƒ‰ã®å±ç…‰é­”",actions:[lt]}}const ro=Object.freeze(Object.defineProperty({__proto__:null,default:mg},Symbol.toStringTag,{value:"Module"}));function*_g(){yield{name:"ã‚¤ãƒ¼ãƒ“ãƒ«ãƒ»ã‚½ãƒ¼ãƒ³",actions:[{title:"â‘ ã‚¤ãƒ¼ãƒ“ãƒ«ãƒ»ãƒãƒ¼ã‚¹ãƒˆ",isMandatory:!1,playType:"IgnitionEffect",spellSpeed:"Normal",executableCells:x,executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],executableFaces:["FaceUp"],fixedTags:["SpecialSummonFromDeck","DamageToOpponent"],canPayCosts:xa,canExecute:e=>{var a;const t=e.action.entity.moveLog.latestArrivalRecord;return!(t&&t.movedAs.includes("Effect")&&((a=t.movedBy)==null?void 0:a.origin.name)==="ã‚¤ãƒ¼ãƒ“ãƒ«ãƒ»ã‚½ãƒ¼ãƒ³")},payCosts:Pa,prepare:m,execute:async e=>{if(!e.activator.getOpponentPlayer().effectDamage(300,e).some(n=>n.duelist===e.activator.getOpponentPlayer()))return!1;const a=e.activator.getDeckCell().cardEntities.filter(n=>n.nm==="ã‚¤ãƒ¼ãƒ“ãƒ«ãƒ»ã‚½ãƒ¼ãƒ³");if(!a.length)return!0;const i=e.activator.getMonsterZones();return i.length&&await e.activator.summonMany(e.activator,"SpecialSummon",["Effect"],e.action,a.map(n=>({monster:n,cells:i,posList:["Attack"]})),[],!1,void 0,n=>n.length<3,!0)&&e.activator.getDeckCell().shuffle(),!0},settle:async()=>!0}]}}const no=Object.freeze(Object.defineProperty({__proto__:null,default:_g},Symbol.toStringTag,{value:"Module"}));function*Sg(){yield{name:"ã«ã‚“äºº",actions:[{title:"è‡ªå·±å†ç”Ÿ",isMandatory:!1,playType:"IgnitionEffect",spellSpeed:"Normal",executableCells:["Graveyard"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],executableFaces:["FaceUp"],fixedTags:["SpecialSummonFromGraveyard"],isOnlyNTimesPerTurn:1,...nl(["Hand","MonsterZone","ExtraMonsterZone"],(e,t)=>e.types.includes("Plant")&&e.nm!=="ã«ã‚“äºº"&&Q(t,T,[{cell:e.cell,material:e}],["Effect"])&&(e.cell.cellType==="Hand"||e.face==="FaceUp"),1),canExecute:e=>e.activator.getCells("Hand","MonsterZone","ExtraMonsterZone").flatMap(t=>t.cardEntities).filter(t=>t.types.includes("Plant")).filter(t=>t.nm!=="ã«ã‚“äºº").filter(t=>t.cell.cellType==="Hand"||t.face==="FaceUp").some(t=>Q(e,T,[{cell:t.cell,material:t}],["Effect"])),prepare:m,execute:ve,settle:async()=>!0}]}}const so=Object.freeze(Object.defineProperty({__proto__:null,default:Sg},Symbol.toStringTag,{value:"Module"})),un={name:"ç¶¿æ¯›ãƒˆãƒ¼ã‚¯ãƒ³",actions:Wt,staticInfo:{name:"ç¶¿æ¯›ãƒˆãƒ¼ã‚¯ãƒ³",kind:"Monster",monsterCategories:["Normal","Token"],level:1,attack:0,defense:0,attributes:["Wind"],types:["Plant"],wikiEncodedName:"%CC%CA%CC%D3%A5%C8%A1%BC%A5%AF%A5%F3"}};function*Tg(){yield{name:"ãƒ€ãƒ³ãƒ‡ã‚£ãƒ©ã‚¤ã‚ªãƒ³",actions:[{title:"ç¶¿æ¯›ãƒˆãƒ¼ã‚¯ãƒ³ç”Ÿæˆ",isMandatory:!0,playType:"TriggerEffect",spellSpeed:"Normal",executableCells:["Graveyard"],executablePeriods:[...C,...M],executableDuelistTypes:["Controller"],fixedTags:["SpecialSummonToken"],triggerPattern:{triggerType:"Departure"},canExecute:e=>{const t=L.prepareTokenEntities(e.activator,e.action.entity,un,2),a=e.activator.getMonsterZones(),i=e.activator.getEnableSummonList(e.activator,"SpecialSummon",["Effect"],e.action,t.map(r=>({monster:r,cells:a,posList:["Defense"]})),[],!1);return i.length>1&&i.flatMap(r=>r.cells).getDistinct().length>1},prepare:m,execute:async e=>{const t=e.activator.getAvailableMonsterZones();if(t.length<1)return!1;const i=L.prepareTokenEntities(e.activator,e.action.entity,un,2).map(n=>({monster:n,cells:t,posList:["Defense"]}));t.length===2&&(i[0].cells=[t[0]],i[1].cells=[t[1]]);const r=await e.activator.summonMany(e.activator,"SpecialSummon",["Effect"],e.action,i,[],!1,2,n=>n.length==2,!1)??[];return r.length?(r.forEach(n=>{n.procFilterBundle.push(new we({title:"ã‚¢ãƒ‰ãƒãƒ³ã‚¹å¬å–šãƒªãƒªãƒ¼ã‚¹ä¸å¯",validateAlive:s=>s.duel.clock.isSameTurn(s.isSpawnedAt),isContinuous:!1,isSpawnedBy:e.action.entity,actionAttr:e.action,isApplicableTo:(s,l)=>l.parent===e.action.entity,procTypes:["AdvanceSummonRelease"],filter:()=>!1}))}),!0):!1},settle:async()=>!0}]}}const lo=Object.freeze(Object.defineProperty({__proto__:null,default:Tg},Symbol.toStringTag,{value:"Module"}));function*Cg(){yield{name:"ãƒ­ãƒ¼ãƒ³ãƒ•ã‚¡ã‚¤ã‚¢ãƒ»ãƒ–ãƒ­ãƒƒã‚µãƒ ",actions:[{title:"æ¤ç‰©æ—ãƒªã‚¯ãƒ«ãƒ¼ãƒˆ",isMandatory:!1,playType:"IgnitionEffect",spellSpeed:"Normal",executableCells:x,executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],executableFaces:["FaceUp"],fixedTags:["SpecialSummonFromDeck"],isOnlyNTimesPerTurnIfFaceup:1,canPayCosts:e=>e.activator.getMonstersOnField().filter(t=>t.types.includes("Plant")).filter(t=>t.face==="FaceUp").filter(t=>e.activator.canRelease([t])).some(t=>t.canBeReleased(e.activator,e.action.entity,["ReleaseAsCost"],e.action)),canExecute:e=>{const t=e.activator.getDeckCell().cardEntities.filter(i=>i.types.includes("Plant"));if(!t.length)return!1;const a=e.activator.getMonsterZones();return e.activator.getMonstersOnField().filter(i=>i.types.includes("Plant")).filter(i=>i.face==="FaceUp").filter(i=>e.activator.canRelease([i])).filter(i=>i.canBeReleased(e.activator,e.action.entity,["ReleaseAsCost"],e.action)).some(i=>e.activator.getEnableSummonList(e.activator,"SpecialSummon",["Effect"],e.action,t.map(n=>({monster:n,cells:a,posList:T})),[{material:i,cell:i.cell}],!1).length)},payCosts:async e=>{const t=e.activator.getDeckCell().cardEntities.filter(s=>s.types.includes("Plant")),a=e.activator.getMonsterZones(),i=e.activator.getMonstersOnField().filter(s=>s.types.includes("Plant")).filter(s=>s.face==="FaceUp").filter(s=>e.activator.canRelease([s])).filter(s=>s.canBeReleased(e.activator,e.action.entity,["ReleaseAsCost"],e.action)).filter(s=>e.activator.getEnableSummonList(e.activator,"SpecialSummon",["Effect"],e.action,t.map(o=>({monster:o,cells:a,posList:T})),[{material:s,cell:s.cell}],!1).length),r=await e.activator.waitSelectEntity(i,"ãƒªãƒªãƒ¼ã‚¹ã™ã‚‹æ¤ç‰©æ—ã‚’é¸æŠžã€‚",!0);if(!r)return;const n={cost:r,cell:r.cell};return await r.release(["Cost"],e.action.entity,e.activator),{release:[n]}},prepare:m,execute:async e=>{const t=e.activator.getDeckCell().cardEntities.filter(r=>r.types.includes("Plant")),a=e.activator.getMonsterZones();return!!await e.activator.summonOne(e.activator,"SpecialSummon",["Effect"],e.action,t.map(r=>({monster:r,posList:T,cells:a})),(e.costInfo.release??[]).map(r=>({material:r.cost,cell:r.cell})),!1,!1)},settle:async()=>!0}]}}const oo=Object.freeze(Object.defineProperty({__proto__:null,default:Cg},Symbol.toStringTag,{value:"Module"}));function*bg(){yield{name:"ã‚µãƒ¢ãƒ³ãƒ»ã‚½ãƒ¼ã‚µãƒ¬ã‚¹[ã‚¨ãƒ©ãƒƒã‚¿å‰]",actions:[Ze(e=>e.length>1&&e.every(t=>t.entityType!=="Token")&&e.flatMap(t=>t.types).getDistinct().some(t=>e.every(a=>a.types.includes(t)))),{title:"â‘ é€ã‚Šã¤ã‘",isMandatory:!1,playType:"TriggerEffect",spellSpeed:"Normal",executableCells:["ExtraMonsterZone"],executablePeriods:[...C,...M],executableDuelistTypes:["Controller"],fixedTags:["SpecialSummonFromHand"],meetsConditions:e=>e.action.entity.hasBeenArrivalNow(["LinkSummon"]),canExecute:e=>{const t=e.activator.getHandCell().cardEntities.filter(r=>r.kind==="Monster"),a=e.action.entity.linkArrowDests.filter(r=>r.owner===e.activator.getOpponentPlayer());return e.activator.getEnableSummonList(e.activator,"SpecialSummon",["Effect"],e.action,t.map(r=>({monster:r,cells:a,posList:["Defense"]})),[],!1).length>0},prepare:m,execute:async e=>{const t=e.activator.getHandCell().cardEntities.filter(r=>r.kind==="Monster"),a=e.action.entity.linkArrowDests.filter(r=>r.owner===e.activator.getOpponentPlayer());return!!await e.activator.summonOne(e.activator,"SpecialSummon",["Effect"],e.action,t.map(r=>({monster:r,cells:a,posList:["Defense"]})),[],!1,!1)},settle:async()=>!0},{title:"â‘¡ãƒªã‚¯ãƒ«ãƒ¼ãƒˆ",isMandatory:!1,playType:"IgnitionEffect",spellSpeed:"Normal",executableCells:["ExtraMonsterZone"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],fixedTags:["SpecialSummonFromDeck"],isOnlyNTimesPerTurn:1,...de(e=>{const t=e.action.entity.linkArrowDests.filter(s=>s.isAvailable);if(!t.length)return[];const a=e.action.entity.linkArrowDests.flatMap(s=>s.cardEntities);if(!a.length)return[];let i=a.flatMap(s=>s.types);const r=e.activator.getDeckCell().cardEntities.filter(s=>s.types.union(i).length);return i=e.activator.getEnableSummonList(e.activator,"SpecialSummon",["Effect"],e.action,r.map(s=>({monster:s,cells:t,posList:["Defense"]})),[],!1).flatMap(s=>s.monster.types).getDistinct(),a.filter(s=>i.some(l=>s.types.includes(l)))},{tags:["SpecialSummonFromHand"]}),execute:async e=>{const t=e.action.entity.linkArrowDests.filter(n=>n.isAvailable);if(!t.length)return!1;const a=e.selectedEntities.flatMap(n=>n.types);if(!a.length)return!1;const i=e.activator.getDeckCell().cardEntities.filter(n=>n.types.union(a).length),r=await e.activator.summonOne(e.activator,"SpecialSummon",["Effect","NonEffectiveSummon"],e.action,i.map(n=>({monster:n,cells:t,posList:["Defense"]})),[],!1,!1);return r?(r.statusOperatorBundle.push(new ee({title:"åŠ¹æžœç„¡åŠ¹",validateAlive:()=>!0,isContinuous:!1,isSpawnedBy:e.action.entity,actionAttr:e.action,isApplicableTo:(n,s)=>s.isOnFieldAsMonsterStrictly&&s.face==="FaceUp",statusCalculator:()=>({isEffective:!1})})),!!r):!1},settle:async()=>!0}]}}const co=Object.freeze(Object.defineProperty({__proto__:null,default:bg},Symbol.toStringTag,{value:"Module"}));function*wg(){yield{name:"å¬å–šåƒ§ã‚µãƒ¢ãƒ³ãƒ—ãƒªãƒ¼ã‚¹ãƒˆ",actions:[{title:"â‘ è¡¨ç¤ºå½¢å¼å¤‰æ›´",isMandatory:!0,playType:"TriggerEffect",spellSpeed:"Normal",executableCells:["MonsterZone"],executablePeriods:[...C,...M],executableDuelistTypes:["Controller"],meetsConditions:e=>e.action.entity.hasBeenArrivalNow(["NormalSummon","FlipSummon"]),fixedTags:["IfNormarlSummonSucceed"],prepare:m,execute:async e=>e.action.entity.battlePosition!=="Attack"||!e.action.entity.isOnFieldAsMonsterStrictly?!1:(await e.action.entity.setBattlePosition("Defense",["Effect"],e.action.entity,e.activator),!0),settle:async()=>!0},{title:"â‘¢ãƒªã‚¯ãƒ«ãƒ¼ãƒˆ",isMandatory:!1,playType:"IgnitionEffect",spellSpeed:"Normal",executableCells:["MonsterZone"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],executableFaces:["FaceUp"],isOnlyNTimesPerTurnIfFaceup:1,fixedTags:["SpecialSummonFromDeck"],canPayCosts:e=>e.activator.status.canDiscardAsCost?e.activator.getHandCell().cardEntities.some(t=>t.kind==="Spell"):!1,canExecute:e=>{const t=e.activator.getDeckCell().cardEntities.filter(r=>r.kind==="Monster").filter(r=>r.lvl===4),a=e.activator.getMonsterZones();return e.activator.getEnableSummonList(e.activator,"SpecialSummon",["Effect"],e.action,t.map(r=>({monster:r,posList:T,cells:a})),[],!1).length>0},payCosts:async(e,t,a)=>{const i=e.activator.getHandCell().cardEntities.filter(n=>n.kind==="Spell"),r=await e.activator.waitSelectEntity(i,"æ‰‹æœ­ã‚³ã‚¹ãƒˆã‚’é¸æŠž",a);if(!r&&!a)throw new N(e);if(r)return await r.discard(["Cost"],e.action.entity,e.activator),{discard:[{cost:r,cell:e.activator.getHandCell()}]}},prepare:m,execute:async e=>{const t=e.activator.getDeckCell().cardEntities.filter(r=>r.lvl===4),a=e.activator.getMonsterZones(),i=await e.activator.summonOne(e.activator,"SpecialSummon",["Effect"],e.action,t.map(r=>({monster:r,posList:T,cells:a})),[],!1,!1);return!i||(i.statusOperatorBundle.push(new ee({title:"æ”»æ’ƒä¸å¯",validateAlive:r=>r.duel.clock.isSameTurn(r.isSpawnedAt),isContinuous:!1,isSpawnedBy:e.action.entity,actionAttr:e.action,isApplicableTo:()=>!0,statusCalculator:()=>({canAttack:!1})})),!i)?!1:(e.activator.getDeckCell().shuffle(),!0)},settle:async()=>!0}],continuousEffects:[Ea("â‘¡ãƒªãƒªãƒ¼ã‚¹ä¸å¯","Monster",e=>[e],e=>[we.createContinuous("â‘¡ãƒªãƒªãƒ¼ã‚¹ä¸å¯",()=>!0,e,()=>!0,["AdvanceSummonRelease","ReleaseAsEffect","ReleaseAsCost"],()=>!1)])]}}const uo=Object.freeze(Object.defineProperty({__proto__:null,default:wg},Symbol.toStringTag,{value:"Module"}));function*Eg(){yield{name:"ã‚¢ãƒ³ã‚«ãƒ¢ãƒ•ãƒ©ã‚¤ãƒˆ",actions:[lt,{title:"ç‰¹æ®Šå¬å–š",isMandatory:!1,playType:"SpecialSummon",spellSpeed:"Normal",executableCells:["ExtraDeck"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],isOnlyNTimesPerDuel:1,meetsConditions:e=>e.activator.getExtraDeck().cardEntities.every(t=>t.nm==="ã‚¢ãƒ³ã‚«ãƒ¢ãƒ•ãƒ©ã‚¤ãƒˆ"),canExecute:e=>e.action.entity.face==="FaceUp"&&Q(e,T,[],["Rule"]),getDests:e=>We(e,T,[],["Rule"]),prepare:e=>Je(e,"SpecialSummon",["SpecialSummon","Rule"],T),execute:Ie,settle:async()=>!0},{title:"â‘ ãƒ‰ãƒ­ãƒ¼",isMandatory:!1,playType:"IgnitionEffect",spellSpeed:"Normal",executableCells:["SpellAndTrapZone"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],executableFaces:["FaceUp"],priorityForNPC:20,isOnlyNTimesPerTurn:1,fixedTags:["DestroySpellTrapOnField","Draw"],meetsConditions:e=>e.activator.getExtraDeck().cardEntities.every(t=>t.nm==="ã‚¢ãƒ³ã‚«ãƒ¢ãƒ•ãƒ©ã‚¤ãƒˆ"),canExecute:e=>e.activator.getDeckCell().cardEntities.length>0&&e.activator.canDraw,prepare:async()=>({selectedEntities:[]}),execute:async e=>(await S.tryDestroy([e.action.entity],e)).length?(await e.action.entity.field.duel.clock.incrementProcSeq(),await e.activator.draw(1,e.action.entity,e.activator),!0):!1,settle:async()=>!0}],summonFilter:(e,t,a,i,r,n,s,l,o,c)=>{const d={posList:o,cells:c},p={posList:[],cells:[]};return s!==t||n.entity===t?d:p},continuousEffects:[Vt("é™¤å¤–äºˆå®š","Monster",e=>[e],e=>[new ee({title:"é™¤å¤–äºˆå®š",validateAlive:()=>!0,isContinuous:!0,isSpawnedBy:e,actionAttr:{},isApplicableTo:(t,a)=>a.isOnFieldAsMonsterStrictly&&a.face==="FaceUp",statusCalculator:()=>({willBeBanished:!0})})])]}}const po=Object.freeze(Object.defineProperty({__proto__:null,default:Eg},Symbol.toStringTag,{value:"Module"}));function*kg(){yield{name:"ã‚¨ã‚­ã‚»ãƒ³ãƒˆãƒªãƒƒã‚¯ãƒ»ãƒœãƒ¼ã‚¤",actions:[],summonFilter:(e,t,a,i,r,n,s,l,o,c)=>{const d={posList:o,cells:c},p={posList:[],cells:[]};if(!r.includes("SynchroSummon"))return d;const f=l.find(h=>h.material===e.isSpawnedBy);return f?!f.cell.isMonsterZoneLikeCell||l.length!==2?p:l.filter(h=>h!==f).every(h=>h.cell.cellType==="Hand")?d:p:d},defaultStatus:{allowHandSynchro:!0},onUsedAsMaterial:(e,t,a)=>{a.info.summonKinds.includes("SynchroSummon")&&(t.action.entity.statusOperatorBundle.push(new ee({title:"é™¤å¤–äºˆå®š",validateAlive:()=>!0,isContinuous:!1,isSpawnedBy:e,actionAttr:t.action,isApplicableTo:(i,r)=>r.isOnFieldAsMonsterStrictly&&r.face==="FaceUp",statusCalculator:()=>({willBeBanished:!0})})),a.info.isEffectiveIn=a.info.isEffectiveIn.filter(i=>i!=="ExtraMonsterZone").filter(i=>i!=="MonsterZone"))}}}const fo=Object.freeze(Object.defineProperty({__proto__:null,default:kg},Symbol.toStringTag,{value:"Module"})),Dg={title:"ãƒšãƒ³ãƒ‡ãƒ¥ãƒ©ãƒ å¬å–š",isMandatory:!1,playType:"SpecialSummon",spellSpeed:"Normal",executableCells:["Hand"],executablePeriods:["main1","main2"],executableDuelistTypes:["Controller"],isOnlyNTimesPerTurn:1,canExecute:e=>{const t=e.activator.getPendulumScales();if(!t||t.upperBound-t.lowerBound<2)return!1;const a=[...e.activator.getHandCell().cardEntities.filter(n=>n.kind==="Monster"),...e.activator.getExtraDeck().cardEntities.filter(n=>n.face==="FaceUp")].filter(n=>n.kind==="Monster").filter(n=>n.lvl&&n.lvl>t.lowerBound).filter(n=>n.lvl&&n.lvl<t.upperBound);if(!a.length)return!1;const i=[...e.activator.getMonsterZones(),...e.activator.getAvailableMonsterZones()];return e.activator.getEnableSummonList(e.activator,"PendulumSummon",["Rule"],e.action,a.map(n=>({monster:n,cells:i,posList:T})),[],!1).length>0},prepare:async e=>{const t=e.activator.getPendulumScales();if(!t||t.upperBound-t.lowerBound<2)return;const a=[...e.activator.getHandCell().cardEntities.filter(r=>r.kind==="Monster"),...e.activator.getExtraDeck().cardEntities.filter(r=>r.face==="FaceUp")].filter(r=>r.kind==="Monster").filter(r=>r.lvl&&r.lvl>t.lowerBound).filter(r=>r.lvl&&r.lvl<t.upperBound);if(!a.length)return;const i=[...e.activator.getMonsterZones(),...e.activator.getAvailableExtraMonsterZones()];return await e.activator.summonMany(e.activator,"PendulumSummon",["Rule"],e.action,a.map(r=>({monster:r,posList:T,cells:i})),[],!1,void 0,r=>r.length>0,!1),m()},execute:async e=>{for(const t of e.activator.getPendingMonstersOnField())await t.determine();return!0},settle:async()=>!0},xg={title:"å¼·åˆ¶å‹åˆ©",isMandatory:!0,playType:"LingeringEffect",spellSpeed:"Normal",executableCells:["Hand"],executablePeriods:["main2"],executableDuelistTypes:["Controller"],isOnlyNTimesPerTurn:1,canExecute:e=>e.activator.duel.clock.turn>1,prepare:async e=>(await S.sendManyToGraveyardForTheSameReason(e.activator.duel.field.getCardsOnFieldStrictly(),["Rule"],e.action.entity,e.activator),{selectedEntities:[],nextChainBlockFilter:()=>!1}),execute:async e=>{const t=[{name:"å°å°ã•ã‚Œã—è€…ã®å·¦è¶³",column:4},{name:"å°å°ã•ã‚Œã—è€…ã®å³è¶³",column:2},{name:"å°å°ã•ã‚Œã—è€…ã®å·¦è…•",column:5},{name:"å°å°ã•ã‚Œã—è€…ã®å³è…•",column:1},{name:"å°å°ã•ã‚Œã—ã‚¨ã‚¯ã‚¾ãƒ‡ã‚£ã‚¢",column:3}];for(const a of t){const i=[e.activator.duel.field.getAllCardEntities().filter(r=>r.owner===e.activator).find(r=>r.origin.name===a.name),e.activator.getOpponentPlayer().getHandCell().cardEntities.find(r=>r.origin.name===a.name)].filter(r=>r!==void 0);if(!i.length)throw new P("UnexpectedSituation",e,e.activator.getHandCell().cardEntities,a.name);await L.moveMany(i.map(r=>({entity:r,to:r.controller.getMonsterZones().find(n=>n.column===(r.controller.seat==="Above"?6-a.column:a.column))??r.controller.getFieldZone(),kind:"Monster",face:"FaceUp",orientation:"Vertical",pos:"Top",movedAs:["Rule"],movedBy:void 0,actionOwner:void 0,chooser:void 0})))}throw new ue(e.activator,`${e.activator.getOpponentPlayer().name}ãŒãƒ¯ãƒ³ã‚¿ãƒ¼ãƒ³ã‚­ãƒ«ã«å¤±æ•—ã—ãŸã€‚`)},settle:async()=>!0},Pg=e=>{const t=[Dg];return e.profile.npcType==="FtkChallenge"&&t.push(xg),{name:e.profile.name,actions:t,staticInfo:{name:e.profile.name,kind:"Monster",wikiEncodedName:"%A5%D7%A5%EC%A5%A4%A5%E4%A1%BC"}}},yt=e=>e.type==="Name",Ag=e=>e.type==="Filter",Mg=e=>e.type==="Overmuch";function*Fg(){const e={...Object.assign({"/src/ygo_entity_proc/card_proc_definitions/CardProcDefinitions_ContinuousSpell.ts":ms,"/src/ygo_entity_proc/card_proc_definitions/CardProcDefinitions_ContinuousTrap.ts":_s,"/src/ygo_entity_proc/card_proc_definitions/CardProcDefinitions_CounterTrap.ts":Ss,"/src/ygo_entity_proc/card_proc_definitions/CardProcDefinitions_EquipSpell.ts":Ts,"/src/ygo_entity_proc/card_proc_definitions/CardProcDefinitions_EquipSpell_Preset.ts":Cs,"/src/ygo_entity_proc/card_proc_definitions/CardProcDefinitions_FieldSpell.ts":bs,"/src/ygo_entity_proc/card_proc_definitions/CardProcDefinitions_FieldSpell_Preset.ts":ws,"/src/ygo_entity_proc/card_proc_definitions/CardProcDefinitions_FusionMonster.ts":Es,"/src/ygo_entity_proc/card_proc_definitions/CardProcDefinitions_LinkMonster.ts":Ps,"/src/ygo_entity_proc/card_proc_definitions/CardProcDefinitions_Monster.ts":As,"/src/ygo_entity_proc/card_proc_definitions/CardProcDefinitions_Monster_Preset_Catapult.ts":Os,"/src/ygo_entity_proc/card_proc_definitions/CardProcDefinitions_Monster_Preset_DirectAttacker.ts":Ns,"/src/ygo_entity_proc/card_proc_definitions/CardProcDefinitions_Monster_Preset_Recruiter.ts":Bs,"/src/ygo_entity_proc/card_proc_definitions/CardProcDefinitions_NormalSpell.ts":Ls,"/src/ygo_entity_proc/card_proc_definitions/CardProcDefinitions_NormalSpell_General_Draw.ts":Rs,"/src/ygo_entity_proc/card_proc_definitions/CardProcDefinitions_NormalSpell_General_Mill.ts":qs,"/src/ygo_entity_proc/card_proc_definitions/CardProcDefinitions_NormalSpell_General_Salvage.ts":Hs,"/src/ygo_entity_proc/card_proc_definitions/CardProcDefinitions_NormalSpell_Preset.ts":Us,"/src/ygo_entity_proc/card_proc_definitions/CardProcDefinitions_NormalTrap.ts":$s,"/src/ygo_entity_proc/card_proc_definitions/CardProcDefinitions_NormalTrap_Burn .ts":js,"/src/ygo_entity_proc/card_proc_definitions/CardProcDefinitions_NormalTrap_UponAttackDeclaration.ts":zs,"/src/ygo_entity_proc/card_proc_definitions/CardProcDefinitions_QuickPlaySpell.ts":Vs,"/src/ygo_entity_proc/card_proc_definitions/CardProcDefinitions_RitualSpell.ts":Ws,"/src/ygo_entity_proc/card_proc_definitions/CardProcDefinitions_SynchroMonster.ts":Xs,"/src/ygo_entity_proc/card_proc_definitions/CardProcDefinitions_Test_Monster.ts":Ks,"/src/ygo_entity_proc/card_proc_definitions/CardProcDefinitions_Test_NormalSpell.ts":Is,"/src/ygo_entity_proc/card_proc_definitions/CardProcDefinitions_XyzMonster.ts":tl}),...Object.assign({"/src/ygo_entity_proc/card_proc_definitions/character_yusei/CardProcDefinitions_Yusei_SynchroTunerMonster.ts":al,"/src/ygo_entity_proc/card_proc_definitions/grp_p/CardProcDefinitions_Phoenixian_Monster.ts":ll,"/src/ygo_entity_proc/card_proc_definitions/support_fusion/CardProcDefinitions_FustionSubstitude_Monster.ts":ol,"/src/ygo_entity_proc/card_proc_definitions/support_fusion/CardProcDefinitions_FustionSupport_Monster.ts":cl,"/src/ygo_entity_proc/card_proc_definitions/support_retual/CardProcDefinitions_RetualSupport_Monster.ts":ul,"/src/ygo_entity_proc/card_proc_definitions/support_retual/CardProcDefinitions_RetualSupport_NormalSpell.ts":dl,"/src/ygo_entity_proc/card_proc_definitions/tag_a/CardProcDefinitions_Aroma_LinkMonster.ts":pl,"/src/ygo_entity_proc/card_proc_definitions/tag_b/CardProcDefinitions_BambooSword_EquipSpell.ts":fl,"/src/ygo_entity_proc/card_proc_definitions/tag_b/CardProcDefinitions_BambooSword_NormalSpell.ts":gl,"/src/ygo_entity_proc/card_proc_definitions/tag_b/CardProcDefinitions_Blackwing_lv3_Monster.ts":hl,"/src/ygo_entity_proc/card_proc_definitions/tag_b/CardProcDefinitions_Blackwing_lv5_Monster.ts":yl,"/src/ygo_entity_proc/card_proc_definitions/tag_c/CardProcDefinitions_Crystron_LinkMonster.ts":vl,"/src/ygo_entity_proc/card_proc_definitions/tag_d/CardProcDefinitions_DestinyHero_lv1_Monster.ts":ml,"/src/ygo_entity_proc/card_proc_definitions/tag_d/CardProcDefinitions_DestinyHero_lv4_Monster.ts":_l,"/src/ygo_entity_proc/card_proc_definitions/tag_d/CardProcDefinitions_DestinyHero_lv6_Monster.ts":Sl,"/src/ygo_entity_proc/card_proc_definitions/tag_e/CardProcDefinitions_ElementalHero_Monster.ts":Tl,"/src/ygo_entity_proc/card_proc_definitions/tag_e/CardProcDefinitions_Endymion_LinkMonster.ts":Cl,"/src/ygo_entity_proc/card_proc_definitions/tag_e/CardProcDefinitions_Exodia_Monster.ts":bl,"/src/ygo_entity_proc/card_proc_definitions/tag_f/CardProcDefinitions_FallenOfAlbaz_FusionMonster.ts":wl,"/src/ygo_entity_proc/card_proc_definitions/tag_f/CardProcDefinitions_FallenOfAlbaz_Monster.ts":El,"/src/ygo_entity_proc/card_proc_definitions/tag_f/CardProcDefinitions_FallenOfAlbaz_NormalSpell.ts":kl,"/src/ygo_entity_proc/card_proc_definitions/tag_f/CardProcDefinitions_FallenOfAlbaz_NormalTrap.ts":Dl,"/src/ygo_entity_proc/card_proc_definitions/tag_f/CardProcDefinitions_Firewall_LinkMonster.ts":xl,"/src/ygo_entity_proc/card_proc_definitions/tag_f/CardProcDefinitions_Fusion_NormalSpell.ts":Pl,"/src/ygo_entity_proc/card_proc_definitions/tag_i/CardProcDefinitions_Igknight_Monster.ts":Al,"/src/ygo_entity_proc/card_proc_definitions/tag_j/CardProcDefinitions_Junk_Monster.ts":Ml,"/src/ygo_entity_proc/card_proc_definitions/tag_k/CardProcDefinitions_Knightmare_LinkMonster.ts":Fl,"/src/ygo_entity_proc/card_proc_definitions/tag_k/CardProcDefinitions_Kuriboh_LinkMonster.ts":Ol,"/src/ygo_entity_proc/card_proc_definitions/tag_l/CardProcDefinitions_Lightsworn_LinkMonster.ts":Nl,"/src/ygo_entity_proc/card_proc_definitions/tag_l/CardProcDefinitions_Lightsworn_NormalSpell.ts":Bl,"/src/ygo_entity_proc/card_proc_definitions/tag_l/CardProcDefinitions_Lightsworn_Rk4_XyzMonster.ts":Ll,"/src/ygo_entity_proc/card_proc_definitions/tag_l/CardProcDefinitions_Lightsworn_lv3_Monster.ts":Rl,"/src/ygo_entity_proc/card_proc_definitions/tag_l/CardProcDefinitions_Lightsworn_lv4_Monster.ts":ql,"/src/ygo_entity_proc/card_proc_definitions/tag_l/CardProcDefinitions_Lightsworn_lv8_SynchroMonster.ts":Hl,"/src/ygo_entity_proc/card_proc_definitions/tag_m/CardProcDefinitions_Metalfoes_Monster.ts":Zl,"/src/ygo_entity_proc/card_proc_definitions/tag_m/CardProcDefinitions_Metalfoes_NormalSpell.ts":Gl,"/src/ygo_entity_proc/card_proc_definitions/tag_p/CardProcDefinitions_Photon_lv4_Monster.ts":Ul,"/src/ygo_entity_proc/card_proc_definitions/tag_p/CardProcDefinitions_Predaplant_lv3_Monster.ts":$l,"/src/ygo_entity_proc/card_proc_definitions/tag_r/CardProcDefinitions_Resonator_Monster.ts":jl,"/src/ygo_entity_proc/card_proc_definitions/tag_s/CardProcDefinitions_SpellCounter_Monster.ts":zl,"/src/ygo_entity_proc/card_proc_definitions/tag_s/CardProcDefinitions_Stardust_Monster.ts":Vl,"/src/ygo_entity_proc/card_proc_definitions/tag_s/CardProcDefinitions_Synchron_NormalSpell.ts":Ql,"/src/ygo_entity_proc/card_proc_definitions/tag_s/CardProcDefinitions_Synchron_SynchroMonster.ts":Wl,"/src/ygo_entity_proc/card_proc_definitions/tag_t/CardProcDefinitions_Toon_ContinuousSpell.ts":Xl,"/src/ygo_entity_proc/card_proc_definitions/tag_t/CardProcDefinitions_Topologic_LinkMonster.ts":Kl,"/src/ygo_entity_proc/card_proc_definitions/tag_v/CardProcDefinitions_Void_NormalSpell.ts":Yl,"/src/ygo_entity_proc/card_proc_definitions/tag_w/CardProcDefinitions_WorldChalice_Monster.ts":Jl,"/src/ygo_entity_proc/card_proc_definitions/type_Cyberse/CardProcDefinitions_Earth_Cyberse_lvl1_Monster.ts":Il,"/src/ygo_entity_proc/card_proc_definitions/type_Dragon/CardProcDefinitions_Earth_Dragon_LinkMonster.ts":eo,"/src/ygo_entity_proc/card_proc_definitions/type_Fairy/CardProcDefinitions_Light_Fairy_lvl8_SynchroMonster.ts":to,"/src/ygo_entity_proc/card_proc_definitions/type_Fiend/CardProcDefinitions_Dark_Fiend_lvl4_Monster.ts":ao,"/src/ygo_entity_proc/card_proc_definitions/type_Fiend/CardProcDefinitions_Earth_Fiend_lvl3_Monster.ts":io,"/src/ygo_entity_proc/card_proc_definitions/type_Fiend/CardProcDefinitions_Fire_Fiend_lvl6_Monster.ts":ro,"/src/ygo_entity_proc/card_proc_definitions/type_Plant/CardProcDefinitions_Dark_Plant_lvl1_Monster.ts":no,"/src/ygo_entity_proc/card_proc_definitions/type_Plant/CardProcDefinitions_Dark_Plant_lvl4_Monster.ts":so,"/src/ygo_entity_proc/card_proc_definitions/type_Plant/CardProcDefinitions_Earth_Plant_lvl3_Monster.ts":lo,"/src/ygo_entity_proc/card_proc_definitions/type_Plant/CardProcDefinitions_Fire_Plant_lvl3_Monster.ts":oo,"/src/ygo_entity_proc/card_proc_definitions/type_Spellcaster/CardProcDefinitions_Dark_Spellcaster_lnk3_LinklMonster.ts":co,"/src/ygo_entity_proc/card_proc_definitions/type_Spellcaster/CardProcDefinitions_Dark_Spellcaster_lvl4_Monster.ts":uo,"/src/ygo_entity_proc/card_proc_definitions/type_Spellcaster/CardProcDefinitions_Light_Spellcaster_lvl5_PendulumMonster.ts":po,"/src/ygo_entity_proc/card_proc_definitions/type_Spellcaster/CardProcDefinitions_Wind_Spellcaster_lvl3_Monster.ts":fo})};for(const t of Object.keys(e))e[t].default&&(yield*e[t].default())}async function*Og(...e){var r,n;const t={...Object.assign({"/src/ygo_entity_proc/card_proc_definitions/CardProcDefinitions_ContinuousSpell.ts":ms,"/src/ygo_entity_proc/card_proc_definitions/CardProcDefinitions_ContinuousTrap.ts":_s,"/src/ygo_entity_proc/card_proc_definitions/CardProcDefinitions_CounterTrap.ts":Ss,"/src/ygo_entity_proc/card_proc_definitions/CardProcDefinitions_EquipSpell.ts":Ts,"/src/ygo_entity_proc/card_proc_definitions/CardProcDefinitions_EquipSpell_Preset.ts":Cs,"/src/ygo_entity_proc/card_proc_definitions/CardProcDefinitions_FieldSpell.ts":bs,"/src/ygo_entity_proc/card_proc_definitions/CardProcDefinitions_FieldSpell_Preset.ts":ws,"/src/ygo_entity_proc/card_proc_definitions/CardProcDefinitions_FusionMonster.ts":Es,"/src/ygo_entity_proc/card_proc_definitions/CardProcDefinitions_LinkMonster.ts":Ps,"/src/ygo_entity_proc/card_proc_definitions/CardProcDefinitions_Monster.ts":As,"/src/ygo_entity_proc/card_proc_definitions/CardProcDefinitions_Monster_Preset_Catapult.ts":Os,"/src/ygo_entity_proc/card_proc_definitions/CardProcDefinitions_Monster_Preset_DirectAttacker.ts":Ns,"/src/ygo_entity_proc/card_proc_definitions/CardProcDefinitions_Monster_Preset_Recruiter.ts":Bs,"/src/ygo_entity_proc/card_proc_definitions/CardProcDefinitions_NormalSpell.ts":Ls,"/src/ygo_entity_proc/card_proc_definitions/CardProcDefinitions_NormalSpell_General_Draw.ts":Rs,"/src/ygo_entity_proc/card_proc_definitions/CardProcDefinitions_NormalSpell_General_Mill.ts":qs,"/src/ygo_entity_proc/card_proc_definitions/CardProcDefinitions_NormalSpell_General_Salvage.ts":Hs,"/src/ygo_entity_proc/card_proc_definitions/CardProcDefinitions_NormalSpell_Preset.ts":Us,"/src/ygo_entity_proc/card_proc_definitions/CardProcDefinitions_NormalTrap.ts":$s,"/src/ygo_entity_proc/card_proc_definitions/CardProcDefinitions_NormalTrap_Burn .ts":js,"/src/ygo_entity_proc/card_proc_definitions/CardProcDefinitions_NormalTrap_UponAttackDeclaration.ts":zs,"/src/ygo_entity_proc/card_proc_definitions/CardProcDefinitions_QuickPlaySpell.ts":Vs,"/src/ygo_entity_proc/card_proc_definitions/CardProcDefinitions_RitualSpell.ts":Ws,"/src/ygo_entity_proc/card_proc_definitions/CardProcDefinitions_SynchroMonster.ts":Xs,"/src/ygo_entity_proc/card_proc_definitions/CardProcDefinitions_Test_Monster.ts":Ks,"/src/ygo_entity_proc/card_proc_definitions/CardProcDefinitions_Test_NormalSpell.ts":Is,"/src/ygo_entity_proc/card_proc_definitions/CardProcDefinitions_XyzMonster.ts":tl}),...Object.assign({"/src/ygo_entity_proc/card_proc_definitions/character_yusei/CardProcDefinitions_Yusei_SynchroTunerMonster.ts":al,"/src/ygo_entity_proc/card_proc_definitions/grp_p/CardProcDefinitions_Phoenixian_Monster.ts":ll,"/src/ygo_entity_proc/card_proc_definitions/support_fusion/CardProcDefinitions_FustionSubstitude_Monster.ts":ol,"/src/ygo_entity_proc/card_proc_definitions/support_fusion/CardProcDefinitions_FustionSupport_Monster.ts":cl,"/src/ygo_entity_proc/card_proc_definitions/support_retual/CardProcDefinitions_RetualSupport_Monster.ts":ul,"/src/ygo_entity_proc/card_proc_definitions/support_retual/CardProcDefinitions_RetualSupport_NormalSpell.ts":dl,"/src/ygo_entity_proc/card_proc_definitions/tag_a/CardProcDefinitions_Aroma_LinkMonster.ts":pl,"/src/ygo_entity_proc/card_proc_definitions/tag_b/CardProcDefinitions_BambooSword_EquipSpell.ts":fl,"/src/ygo_entity_proc/card_proc_definitions/tag_b/CardProcDefinitions_BambooSword_NormalSpell.ts":gl,"/src/ygo_entity_proc/card_proc_definitions/tag_b/CardProcDefinitions_Blackwing_lv3_Monster.ts":hl,"/src/ygo_entity_proc/card_proc_definitions/tag_b/CardProcDefinitions_Blackwing_lv5_Monster.ts":yl,"/src/ygo_entity_proc/card_proc_definitions/tag_c/CardProcDefinitions_Crystron_LinkMonster.ts":vl,"/src/ygo_entity_proc/card_proc_definitions/tag_d/CardProcDefinitions_DestinyHero_lv1_Monster.ts":ml,"/src/ygo_entity_proc/card_proc_definitions/tag_d/CardProcDefinitions_DestinyHero_lv4_Monster.ts":_l,"/src/ygo_entity_proc/card_proc_definitions/tag_d/CardProcDefinitions_DestinyHero_lv6_Monster.ts":Sl,"/src/ygo_entity_proc/card_proc_definitions/tag_e/CardProcDefinitions_ElementalHero_Monster.ts":Tl,"/src/ygo_entity_proc/card_proc_definitions/tag_e/CardProcDefinitions_Endymion_LinkMonster.ts":Cl,"/src/ygo_entity_proc/card_proc_definitions/tag_e/CardProcDefinitions_Exodia_Monster.ts":bl,"/src/ygo_entity_proc/card_proc_definitions/tag_f/CardProcDefinitions_FallenOfAlbaz_FusionMonster.ts":wl,"/src/ygo_entity_proc/card_proc_definitions/tag_f/CardProcDefinitions_FallenOfAlbaz_Monster.ts":El,"/src/ygo_entity_proc/card_proc_definitions/tag_f/CardProcDefinitions_FallenOfAlbaz_NormalSpell.ts":kl,"/src/ygo_entity_proc/card_proc_definitions/tag_f/CardProcDefinitions_FallenOfAlbaz_NormalTrap.ts":Dl,"/src/ygo_entity_proc/card_proc_definitions/tag_f/CardProcDefinitions_Firewall_LinkMonster.ts":xl,"/src/ygo_entity_proc/card_proc_definitions/tag_f/CardProcDefinitions_Fusion_NormalSpell.ts":Pl,"/src/ygo_entity_proc/card_proc_definitions/tag_i/CardProcDefinitions_Igknight_Monster.ts":Al,"/src/ygo_entity_proc/card_proc_definitions/tag_j/CardProcDefinitions_Junk_Monster.ts":Ml,"/src/ygo_entity_proc/card_proc_definitions/tag_k/CardProcDefinitions_Knightmare_LinkMonster.ts":Fl,"/src/ygo_entity_proc/card_proc_definitions/tag_k/CardProcDefinitions_Kuriboh_LinkMonster.ts":Ol,"/src/ygo_entity_proc/card_proc_definitions/tag_l/CardProcDefinitions_Lightsworn_LinkMonster.ts":Nl,"/src/ygo_entity_proc/card_proc_definitions/tag_l/CardProcDefinitions_Lightsworn_NormalSpell.ts":Bl,"/src/ygo_entity_proc/card_proc_definitions/tag_l/CardProcDefinitions_Lightsworn_Rk4_XyzMonster.ts":Ll,"/src/ygo_entity_proc/card_proc_definitions/tag_l/CardProcDefinitions_Lightsworn_lv3_Monster.ts":Rl,"/src/ygo_entity_proc/card_proc_definitions/tag_l/CardProcDefinitions_Lightsworn_lv4_Monster.ts":ql,"/src/ygo_entity_proc/card_proc_definitions/tag_l/CardProcDefinitions_Lightsworn_lv8_SynchroMonster.ts":Hl,"/src/ygo_entity_proc/card_proc_definitions/tag_m/CardProcDefinitions_Metalfoes_Monster.ts":Zl,"/src/ygo_entity_proc/card_proc_definitions/tag_m/CardProcDefinitions_Metalfoes_NormalSpell.ts":Gl,"/src/ygo_entity_proc/card_proc_definitions/tag_p/CardProcDefinitions_Photon_lv4_Monster.ts":Ul,"/src/ygo_entity_proc/card_proc_definitions/tag_p/CardProcDefinitions_Predaplant_lv3_Monster.ts":$l,"/src/ygo_entity_proc/card_proc_definitions/tag_r/CardProcDefinitions_Resonator_Monster.ts":jl,"/src/ygo_entity_proc/card_proc_definitions/tag_s/CardProcDefinitions_SpellCounter_Monster.ts":zl,"/src/ygo_entity_proc/card_proc_definitions/tag_s/CardProcDefinitions_Stardust_Monster.ts":Vl,"/src/ygo_entity_proc/card_proc_definitions/tag_s/CardProcDefinitions_Synchron_NormalSpell.ts":Ql,"/src/ygo_entity_proc/card_proc_definitions/tag_s/CardProcDefinitions_Synchron_SynchroMonster.ts":Wl,"/src/ygo_entity_proc/card_proc_definitions/tag_t/CardProcDefinitions_Toon_ContinuousSpell.ts":Xl,"/src/ygo_entity_proc/card_proc_definitions/tag_t/CardProcDefinitions_Topologic_LinkMonster.ts":Kl,"/src/ygo_entity_proc/card_proc_definitions/tag_v/CardProcDefinitions_Void_NormalSpell.ts":Yl,"/src/ygo_entity_proc/card_proc_definitions/tag_w/CardProcDefinitions_WorldChalice_Monster.ts":Jl,"/src/ygo_entity_proc/card_proc_definitions/type_Cyberse/CardProcDefinitions_Earth_Cyberse_lvl1_Monster.ts":Il,"/src/ygo_entity_proc/card_proc_definitions/type_Dragon/CardProcDefinitions_Earth_Dragon_LinkMonster.ts":eo,"/src/ygo_entity_proc/card_proc_definitions/type_Fairy/CardProcDefinitions_Light_Fairy_lvl8_SynchroMonster.ts":to,"/src/ygo_entity_proc/card_proc_definitions/type_Fiend/CardProcDefinitions_Dark_Fiend_lvl4_Monster.ts":ao,"/src/ygo_entity_proc/card_proc_definitions/type_Fiend/CardProcDefinitions_Earth_Fiend_lvl3_Monster.ts":io,"/src/ygo_entity_proc/card_proc_definitions/type_Fiend/CardProcDefinitions_Fire_Fiend_lvl6_Monster.ts":ro,"/src/ygo_entity_proc/card_proc_definitions/type_Plant/CardProcDefinitions_Dark_Plant_lvl1_Monster.ts":no,"/src/ygo_entity_proc/card_proc_definitions/type_Plant/CardProcDefinitions_Dark_Plant_lvl4_Monster.ts":so,"/src/ygo_entity_proc/card_proc_definitions/type_Plant/CardProcDefinitions_Earth_Plant_lvl3_Monster.ts":lo,"/src/ygo_entity_proc/card_proc_definitions/type_Plant/CardProcDefinitions_Fire_Plant_lvl3_Monster.ts":oo,"/src/ygo_entity_proc/card_proc_definitions/type_Spellcaster/CardProcDefinitions_Dark_Spellcaster_lnk3_LinklMonster.ts":co,"/src/ygo_entity_proc/card_proc_definitions/type_Spellcaster/CardProcDefinitions_Dark_Spellcaster_lvl4_Monster.ts":uo,"/src/ygo_entity_proc/card_proc_definitions/type_Spellcaster/CardProcDefinitions_Light_Spellcaster_lvl5_PendulumMonster.ts":po,"/src/ygo_entity_proc/card_proc_definitions/type_Spellcaster/CardProcDefinitions_Wind_Spellcaster_lvl3_Monster.ts":fo})},a=[],i=await Gg;for(const s of Object.values(t))if(s.default){for(const l of s.default())if(e.includes(l.name)){const o=i.getCardInfo(l.name);if(o){const c={...o};let d=l.summonFilter;c.kind==="Monster"&&c.monsterCategories&&!l.summonFilter&&c.monsterCategories.union(Kn).length&&(d=Yi),l.fusionMaterialInfos&&l.fusionMaterialInfos.some(f=>f.type==="Name")&&(c.textTags=[...c.textTags??[],...l.fusionMaterialInfos.filter(yt).map(f=>f.cardName)]);const p={...l,summonFilter:d,staticInfo:c};(r=c.monsterCategories)!=null&&r.includes("Link")?p.actions=[...Ds,...p.actions]:(n=c.monsterCategories)!=null&&n.includes("SpecialSummon")?p.actions=[...Wt,...p.actions]:p.actions=[...sn,...l.actions],p.actions.filter(f=>f.fixedTags&&f.fixedTags.some(h=>h.startsWith("SpecialSummon"))&&!f.fixedTags.includes("SpecialSummon")).forEach(f=>{var h;return(h=f.fixedTags)==null?void 0:h.push("SpecialSummon")}),yield p,a.push(l.name)}}}yield*e.filter(s=>!a.includes(s)).map(s=>i.getCardInfo(s)).filter(s=>s!==void 0).filter(s=>s.kind==="Monster").filter(s=>{var l;return!((l=s.monsterCategories)!=null&&l.includes("Effect"))}).filter(s=>{var l;return!((l=s.monsterCategories)!=null&&l.includes("Pendulum"))}).map(s=>{var l;return a.push(s.name),{name:s.name,actions:(l=s.monsterCategories)!=null&&l.includes("SpecialSummon")?Wt:sn,staticInfo:s}}),a.length!==e.length&&console.log(e.filter(s=>!a.includes(s)))}const Ng=e=>({...Pg(e),staticInfo:{name:e.profile.name,kind:"Monster",wikiEncodedName:"%A5%D7%A5%EC%A5%A4%A5%E4%A1%BC"}}),Bg=new Set,Lg={...Do,...ko,...Eo},{promise:Rg,resolve:qg}=_i(),xt={treePrms:Rg,knmCount:0,definitionCount:0,nonDefinitionCount:0,testCardCount:0,getCardInfo:e=>{}},_a={},go={};xt.getCardInfo=e=>_a[e]??go[e.toNarrow().replaceAll("ï¼","-")];const ho=e=>{var t;if(!e)throw new Error(e);e.kind==="Monster"&&e.monsterCategories&&!((t=e.monsterCategories)!=null&&t.includes("Effect"))&&!e.monsterCategories.includes("Pendulum")&&(e.isImplemented=!0,xt.nonDefinitionCount++),e.isForTest&&e.isImplemented&&xt.testCardCount++,_a[e.name]=e,go[e.name.toNarrow().replaceAll("ï¼","-")]=e};Object.values(Lg).forEach(ho);const{promise:Hg,resolve:Zg}=_i(),Gg=Hg,er=[],yo=e=>`/stk_ygo_svelte/json/${e}`,Dh=async e=>{const t=(await Promise.all((await Promise.all(e.map(a=>Math.floor(a/1e3)*1e3).getDistinct().map(a=>`cardInfoText_cid${a.toString().padStart(6,"0")}.json`).map(yo).filter(a=>!er.includes(a)).map(a=>(er.push(a),console.info(`${a} starts loading`),fetch(a))))).map(a=>(console.log(`${a.url} has been loaded`),a.json())))).flatMap(a=>a);for(const a of Object.values(_a))for(const i of t)if(a.cardId===i[0]){let r=0;a.nameKana=i[++r],a.description=i[++r],a.pendulumDescription=i[++r],a.wikiEncodedName=i[++r]}},Ug=async()=>{const e=new Date().getTime();await Promise.all(xo.statusJsons.map(yo).map(async t=>{const a=new Date().getTime();er.push(t),console.info(`${t} starts loading `);const i=await fetch(t);console.info(`res=${i.status} ${i.statusText} ${i.url}`),(await i.json()).map(mu).forEach(ho),console.info(`${t} has been loaded.ã€€elapsed time : ${new Date().getTime()-a}ms  `)})),console.info(`All status json files has been loaded.ã€€elapsed time : ${new Date().getTime()-e}ms `),xt.knmCount=Object.values(_a).map(t=>t.cardId).getDistinct().map(mi).length;for(const t of Fg()){if(Bg.has(t.name))throw new Error(`ã‚«ãƒ¼ãƒ‰å®šç¾©é‡è¤‡${t.name}`);const a=xt.getCardInfo(t.name);a&&(a.isImplemented=!0,xt.definitionCount++)}console.info("All isImplemented Flg has been updated "),Zg(xt),ya(200).then(()=>{const t=_u(Object.values(_a));console.info("Card Tree has been created "),Object.values(t).forEach(a=>a.sort(es)),console.info("Card Tree has been sorted "),qg(t)})};Ug();const $g=e=>{if(!Au(e))return!1;const t=e;return mi(t.id)&&typeof t.name=="string"&&typeof t.description=="string"&&typeof t.lastUsedAt=="string"&&Array.isArray(t.cardNames)&&t.cardNames.every(a=>typeof a=="string")},B=class B{constructor(t,a){u(this,"id");u(this,"name");u(this,"deckType");u(this,"description");u(this,"lastUsedAt");u(this,"cardNames");u(this,"updateTimestamp",async()=>{await B.tblHeader.update(this.id,t=>({...t,lastUsedAt:new Date}))});u(this,"saveDeckInfo",async t=>{const a=t??this;await B.tblHeader.update(this.id,n=>({...n,name:a.name,description:a.description,deckType:"User",lastUsedAt:new Date}));const i=(await B.tblDetail.getAll()).filter(n=>n.deckId===this.id);await B.tblDetail.delete(i.map(n=>n.id));const r=await B.tblDetail.insertMany(a.cardNames.map((n,s)=>({deckId:this.id,seq:s,name:n,description:""})));return new B(await B.tblHeader.get(this.id),r)});u(this,"delete",async()=>{await B.remove(this.id)});this.id=t.id,this.name=t.name,this.deckType=t.deckType,this.description=t.description,this.lastUsedAt=t.lastUsedAt,this.cardNames=a.filter(i=>i.deckId===this.id).map(i=>i.name)}};u(B,"toJson",t=>{const a=t.map(i=>{const{id:r,name:n,description:s,lastUsedAt:l,cardNames:o}=i;return{id:r,name:n,description:s,lastUsedAt:l,cardNames:o}});return JSON.stringify(a,null,2)}),u(B,"createfromJson",async t=>{let a;try{const r=await t.text();a=JSON.parse(r)}catch(r){throw console.error(r),new Error(`${t.name}ã¯æ­£ã—ã„JSONãƒ•ã‚¡ã‚¤ãƒ«å½¢å¼ã§ã¯ãªã„ã€‚`)}if(!Array.isArray(a))throw new Error(`${t.name}ã¯æ­£ã—ã„ãƒ‡ãƒƒã‚­æƒ…å ±ã®å½¢å¼ã§ã¯ãªã„ã€‚`);if(!a.length)throw new Error(`${t.name}ã«ãƒ‡ãƒƒã‚­æƒ…å ±ãŒå«ã¾ã‚Œã¦ã„ãªã„ã€‚`);const i=a.filter($g).map(r=>({...r,deckType:"User",id:Number(r.id),lastUsedAt:new Date(r.lastUsedAt)}));if(a.length!==i.length)throw new Error(`${t.name}ã®ãƒ‡ãƒƒã‚­æƒ…å ±${a.length}ä»¶ã®ã†ã¡ã€${a.length-i.length}ä»¶ãŒæ­£ã—ã„ãƒ‡ãƒƒã‚­æƒ…å ±ã®å½¢å¼ã§ã¯ãªã‹ã£ãŸã€‚`);return i}),u(B,"convertToObjectURL",t=>{const a=B.toJson(t),i=new Blob([a],{type:"text/plain"});return window.URL.createObjectURL(i)}),u(B,"idb"),u(B,"tblHeader"),u(B,"tblDetail"),u(B,"getAllDeckInfo",async t=>{if(t&&(B.idb=t),!B.idb)throw new Error("illegal argument: idb is undefined.");B.tblHeader||(B.tblHeader=new jg(B.idb)),B.tblDetail||(B.tblDetail=new zg(B.idb));const a=await B.tblHeader.getAll(),i=await B.tblDetail.getAll();return a.length?a.map(r=>new B(r,i)):[await B.prepareSampleDeck()]}),u(B,"createNewDeck",async(t,a,i,r)=>{const n=await B.tblHeader.insert({name:t,description:a,deckType:"User",lastUsedAt:r??new Date}),s=await B.tblDetail.insertMany(i.map((l,o)=>({deckId:n.id,seq:o,name:l,description:""})));return new B(n,s)}),u(B,"prepareSampleDeck",async()=>{const t=Ni.find(a=>a.deckType==="Preset")??Ni.slice(-1)[0];return await B.createNewDeck(t.name,t.description,t.cardNames)}),u(B,"remove",async t=>{await B.tblHeader.delete([t]);const a=(await B.tblDetail.getAll()).filter(i=>i.deckId===t);await B.tblDetail.delete(a.map(i=>i.id))});let dn=B;class jg extends dr{constructor(a){super(a,"TblDeckHeader");u(this,"_prepareInitialRecords",()=>[])}}class zg extends dr{constructor(a){super(a,"TblDeckDetail");u(this,"_prepareInitialRecords",()=>[])}}const xh=Ni.map(e=>({...e,lastUsedAt:new Date})).filter(e=>e.id<0);export{oh as $,ds as A,nh as B,pa as C,A as D,ge as E,_h as F,Ig as G,Mu as H,Yg as I,dh as J,ya as K,Xg as L,Kg as M,Gg as N,Dh as O,Ac as P,yh as Q,hu as R,gu as S,ou as T,lu as U,th as V,pr as W,du as X,fu as Y,ed as Z,kh as _,J as a,Eh as a0,Xi as a1,rh as a2,Sh as a3,ph as a4,hh as a5,gh as a6,es as a7,au as a8,mi as a9,ah as aA,ih as aB,Th as aC,Ch as aD,wh as aE,eh as aF,vh as aa,yr as ab,At as ac,ch as ad,dn as ae,zd as af,nd as ag,Vi as ah,pu as ai,uu as aj,cu as ak,Yn as al,su as am,yu as an,mh as ao,Jg as ap,lh as aq,sh as ar,_u as as,uh as at,fh as au,en as av,bh as aw,tn as ax,xh as ay,xi as az,it as b,te as c,hi as d,H as e,K as f,F as g,Y as h,It as i,rt as j,oe as k,Qc as l,$a as m,Br as n,Ct as o,mt as p,R as q,St as r,he as s,U as t,_t as u,Wg as v,Dt as w,Re as x,X as y,fa as z};
