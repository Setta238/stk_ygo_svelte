var Za=Object.defineProperty;var Ea=f=>{throw TypeError(f)};var er=(f,i,t)=>i in f?Za(f,i,{enumerable:!0,configurable:!0,writable:!0,value:t}):f[i]=t;var it=(f,i,t)=>er(f,typeof i!="symbol"?i+"":i,t),ja=(f,i,t)=>i.has(f)||Ea("Cannot "+t);var ft=(f,i,t)=>(ja(f,i,"read from private field"),t?t.call(f):i.get(f)),oa=(f,i,t)=>i.has(f)?Ea("Cannot add the same private member more than once"):i instanceof WeakSet?i.add(f):i.set(f,t),ba=(f,i,t,l)=>(ja(f,i,"write to private field"),l?l.call(f,t):i.set(f,t),t);import{s as Ba,r as tr,a as $,b as ar,l as rr,g as e,d as Wa,p as dt,c as je,m as ne,i as ct,t as o,e as a,f as C,h as m,j as le,k as Be,n as tt,o as J,q as r,u as _t,v as he,D as sr,w as xe,x as P,y as s,z as de,A as Kt,B as oe,C as _e,E as b,F as ir,G as et,H as Wt,I as nr,J as za,K as ea,L as ca,M as Da,N as la,O as ka,P as zt,Q as pt,R as $a,S as ga,T as Sa,U as va,V as _a,W as Va,X as ya,Y as ha,Z as or,_ as lr,$ as vr,a0 as dr,a1 as cr,a2 as _r,a3 as ur,a4 as ua,a5 as Xa,a6 as ta,a7 as Ga,a8 as fa,a9 as At,aa as fr,ab as pr,ac as aa,ad as mr,ae as Dt,af as gr,ag as yr,ah as hr,ai as Aa,aj as La,ak as qa,al as Ya,am as Ua,an as Ha,ao as br,ap as Ft,aq as Nt,ar as Et,as as kr,at as Zt,au as xr,av as wr,aw as Pa,ax as Jt,ay as Rt,az as Cr,aA as Dr,aB as $r,aC as Na,aD as Sr,aE as Mr,aF as Tr}from"../chunk/entity_proc_20260121_220607.js";import"../chunk/json_20260121_220607.js";(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const g of document.querySelectorAll('link[rel="modulepreload"]'))l(g);new MutationObserver(g=>{for(const c of g)if(c.type==="childList")for(const u of c.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&l(u)}).observe(document,{childList:!0,subtree:!0});function t(g){const c={};return g.integrity&&(c.integrity=g.integrity),g.referrerPolicy&&(c.referrerPolicy=g.referrerPolicy),g.crossOrigin==="use-credentials"?c.credentials="include":g.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function l(g){if(g.ep)return;g.ep=!0;const c=t(g);fetch(g.href,c)}})();const Er=f=>f;function Ma(f){const i=f-1;return i*i*i+1}function Fa(f){const i=typeof f=="string"&&f.match(/^\s*(-?[\d.]+)([^\s]*)\s*$/);return i?[parseFloat(i[1]),i[2]||"px"]:[f,"px"]}function jr(f,{delay:i=0,duration:t=400,easing:l=Er}={}){const g=+getComputedStyle(f).opacity;return{delay:i,duration:t,easing:l,css:c=>`opacity: ${c*g}`}}function Br(f,{delay:i=0,duration:t=400,easing:l=Ma,x:g=0,y:c=0,opacity:u=0}={}){const v=getComputedStyle(f),A=+v.opacity,B=v.transform==="none"?"":v.transform,M=A*(1-u),[S,n]=Fa(g),[q,R]=Fa(c);return{delay:i,duration:t,easing:l,css:(I,_)=>`
			transform: ${B} translate(${(1-I)*S}${n}, ${(1-I)*q}${R});
			opacity: ${A-M*_}`}}function ke(f,{delay:i=0,duration:t=400,easing:l=Ma,axis:g="y"}={}){const c=getComputedStyle(f),u=+c.opacity,v=g==="y"?"height":"width",A=parseFloat(c[v]),B=g==="y"?["top","bottom"]:["left","right"],M=B.map(p=>`${p[0].toUpperCase()}${p.slice(1)}`),S=parseFloat(c[`padding${M[0]}`]),n=parseFloat(c[`padding${M[1]}`]),q=parseFloat(c[`margin${M[0]}`]),R=parseFloat(c[`margin${M[1]}`]),I=parseFloat(c[`border${M[0]}Width`]),_=parseFloat(c[`border${M[1]}Width`]);return{delay:i,duration:t,easing:l,css:p=>`overflow: hidden;opacity: ${Math.min(p*20,1)*u};${v}: ${p*A}px;padding-${B[0]}: ${p*S}px;padding-${B[1]}: ${p*n}px;margin-${B[0]}: ${p*q}px;margin-${B[1]}: ${p*R}px;border-${B[0]}-width: ${p*I}px;border-${B[1]}-width: ${p*_}px;min-${v}: 0`}}function Ia(f,i){for(const t in i)f[t]=i[t];return f}function Ar({fallback:f,...i}){const t=new Map,l=new Map;function g(u,v,A){const{delay:B=0,duration:M=U=>Math.sqrt(U)*30,easing:S=Ma}=Ia(Ia({},i),A),n=u.getBoundingClientRect(),q=v.getBoundingClientRect(),R=n.left-q.left,I=n.top-q.top,_=n.width/q.width,p=n.height/q.height,K=Math.sqrt(R*R+I*I),Z=getComputedStyle(v),we=Z.transform==="none"?"":Z.transform,j=+Z.opacity;return{delay:B,duration:typeof M=="function"?M(K):M,easing:S,css:(U,ve)=>`
			   opacity: ${U*j};
			   transform-origin: top left;
			   transform: ${we} translate(${ve*R}px,${ve*I}px) scale(${U+(1-U)*_}, ${U+(1-U)*p});
		   `}}function c(u,v,A){return(B,M)=>(u.set(M.key,B),()=>{if(v.has(M.key)){const S=v.get(M.key);return v.delete(M.key),g(S,B,M)}return u.delete(M.key),f&&f(B,M,A)})}return[c(l,t,!1),c(t,l,!0)]}function Oa(f){return Object.prototype.toString.call(f)==="[object Date]"}function Lr(f){return f}function xa(f){const i=f-1;return i*i*i+1}function wa(f,i){if(f===i||f!==f)return()=>f;const t=typeof f;if(t!==typeof i||Array.isArray(f)!==Array.isArray(i))throw new Error("Cannot interpolate values of different type");if(Array.isArray(f)){const l=i.map((g,c)=>wa(f[c],g));return g=>l.map(c=>c(g))}if(t==="object"){if(!f||!i)throw new Error("Object cannot be null");if(Oa(f)&&Oa(i)){const c=f.getTime(),v=i.getTime()-c;return A=>new Date(c+A*v)}const l=Object.keys(i),g={};return l.forEach(c=>{g[c]=wa(f[c],i[c])}),c=>{const u={};return l.forEach(v=>{u[v]=g[v](c)}),u}}if(t==="number"){const l=i-f;return g=>f+g*l}return()=>i}var Lt,ra,da,Vt;const Ta=class Ta{constructor(i,t={}){oa(this,Lt,Ba(void 0));oa(this,ra,Ba(void 0));oa(this,da);oa(this,Vt,null);ft(this,Lt).v=ft(this,ra).v=i,ba(this,da,t)}static of(i,t){const l=new Ta(i(),t);return tr(()=>{l.set(i())}),l}set(i,t){var S;$(ft(this,ra),i);let{delay:l=0,duration:g=400,easing:c=Lr,interpolate:u=wa}={...ft(this,da),...t};if(g===0)return(S=ft(this,Vt))==null||S.abort(),$(ft(this,Lt),i),Promise.resolve();const v=ar.now()+l;let A,B=!1,M=ft(this,Vt);return ba(this,Vt,rr(n=>{if(n<v)return!0;if(!B){B=!0;const R=ft(this,Lt).v;A=u(R,i),typeof g=="function"&&(g=g(R,i)),M==null||M.abort()}const q=n-v;return q>g?($(ft(this,Lt),i),!1):($(ft(this,Lt),A(c(q/g))),!0)})),ft(this,Vt).promise}get current(){return e(ft(this,Lt))}get target(){return e(ft(this,ra))}set target(i){this.set(i)}};Lt=new WeakMap,ra=new WeakMap,da=new WeakMap,Vt=new WeakMap;let pa=Ta;var qr=o('<div class="phase_display svelte-1boxe40"><span class="svelte-1boxe40"> </span> </div>'),Yr=o('<div class="lifepoint_display svelte-1boxe40"><div class="svelte-1boxe40"> </div> <div class="svelte-1boxe40"> </div></div>'),Ur=(f,i,t)=>i(e(t)),Hr=o('<div class="svelte-1boxe40"><button class="phase_button svelte-1boxe40"> </button></div>'),Pr=o("<div><!></div>"),Nr=o('<div class="svelte-1boxe40"><!></div>'),Fr=o("<div><!></div>"),Ir=o('<div class="config_button_wrapper svelte-1boxe40"><button id="config_button" class="svelte-1boxe40">⚙</button></div>'),Or=o("<!> <!> <!> <!>",1),Rr=o('<div style="position: absolute;" class="card_animation_receiver svelte-1boxe40"><!></div>'),Kr=o('<div style="position: absolute; top:0rem" class="svelte-1boxe40">｛効果対象｝</div>'),Wr=o('<!> <div style="position: absolute; display:flex;justify-content: center;"><!></div>',1),zr=o(" <!> 】",1),Vr=o('<div style="position: absolute; bottom:0rem" class="svelte-1boxe40"> <!></div>'),Xr=o("<!> <!>",1),Gr=o('<div class="badge svelte-1boxe40"> </div>'),Qr=o('<div class="card_animation_receiver svelte-1boxe40"><!></div>'),Jr=o("<!> <!> <!> <!>",1),Zr=o('<td><div role="listitem"><!></div></td>');function es(f,i){dt(i,!1);let t=je(i,"view",12),l=je(i,"row",8),g=je(i,"column",8),c=je(i,"selectedEntities",28,()=>[]),u=je(i,"selectedCells",28,()=>[]),v=ne(t().getCell(l(),g())),A=ne(new pa(e(v).field.duel.duelists.Above.lp,{duration:400,easing:xa})),B=ne(new pa(e(v).field.duel.duelists.Below.lp,{duration:400,easing:xa}));const M=()=>{$(v,t().getCell(l(),g())),he(A,e(A).target=e(v).field.duel.duelists.Above.lp),he(B,e(B).target=e(v).field.duel.duelists.Below.lp)};e(v).onUpdate.append(M),t().onDuelUpdate.append(M),t().modalController.onUpdate.append(M);let S,n=ne([]),q=()=>console.log("hoge"),R,I=ne([]),_=ne(!1),p=ne(!1),K=!1;const Z=w=>{var F,z;$(se,[]),c().reset(),S=w.activator,q=w.resolve,$(n,w.dummyActionInfos),$(I,w.chainBlockInfos.flatMap(G=>G.selectedEntities).getDistinct()),R=w.entitiesChoices,$(_,!1),$(p,((F=w.cellsChoices)==null?void 0:F.selectables.includes(e(v)))??!1),K=e(p)&&((z=w.cellsChoices)==null?void 0:z.qty)===1,M()};t().onWaitStart.append(Z);const we=()=>{S=void 0,$(n,[]),q=()=>{console.log("hoge")},R=void 0,$(I,[]),$(_,!1),$(p,!1),K=!1};t().onWaitEnd.append(we);let j=ne(!1),U=[];const ve=w=>{U=w.filter(F=>F.dests.includes(e(v))),$(j,U.length>0),M()},Me=()=>{U=[],$(j,!1),M()};t().onDragStart.append(ve),t().onDragEnd.append(Me);const[ge,ue]=ui;let se=ne([]);const Ee=w=>{if(S=void 0,e(v)===w.to||e(v).entities.includes(w.entity)){$(se,[...e(se),w]);const F=w.resolve;$(v,e(v)),setTimeout(()=>{$(se,e(se).filter(z=>z!==w)),w.count++,w.count>1&&F()},600)}};t().onAnimation.append(Ee);const ye=w=>{q({phaseChange:w})},Y=()=>e(v).isStackCell&&e(v).entities.flatMap(w=>w.actions).filter(w=>e(n).map(F=>F.action.seq).some(F=>F===w.seq)).length>0,N=w=>{var F;if(((F=w.target)==null?void 0:F.id)==="config_button"){t(t().infoBoardState="Config",!0),t().requireUpdate();return}if(t(t().infoBoardState="Default",!0),K)q({selectedCells:[e(v)]});else if(e(p))$(_,!e(_)),u(e(_)?[...u(),e(v)]:u().filter(z=>z!==e(v)));else if(e(v).isStackCell){t(t().infoBoardState="CellInfo",!0),t(t().infoBoardCell=e(v),!0),t().requireUpdate();const z=e(v).entities.flatMap(V=>V.actions).map(V=>V.seq),G=e(n).filter(V=>z.includes(V.action.seq));if(G.length){if(!S)return;t().modalController.actionSelector.show({title:"カードを選択。",position:"Bottom",activator:S,dummyActionInfos:G,cancelable:!0}).then(V=>{V&&q({actionInfo:V})});return}}t().requireUpdate(),console.info(e(v),Te(...e(v).visibleEntities))},fe=w=>{w.preventDefault(),w.dataTransfer&&(w.dataTransfer.dropEffect="move")},ae=w=>{w.preventDefault(),console.info("drop",w,e(j),U),w.dataTransfer&&(w.dataTransfer.dropEffect="move");try{if(e(j)&&U){if(U.length===1){const F=U[0];q({actionInfo:{...F,dest:e(v)}})}else if(U.length>1){if(!S)throw new sr("想定されない状態");e(v).field.duel.view.modalController.terminateAll(),e(v).field.duel.view.modalController.actionSelector.show({title:"選択",position:"Bottom",activator:S,dummyActionInfos:U.map(F=>({...F,dest:e(v)})),cancelable:!1}).then(F=>{q({actionInfo:F})})}}}finally{t().removeDraggingActions()}},Te=(...w)=>{if(t().waitMode==="Animation")return"Disabled";if(R&&R.selectables.find(z=>w.find(G=>z===G)))return"Selectable";if(!e(n)||e(n).length===0||t().waitMode!=="Free"||Object.values(t().modalController.modals).some(z=>z.state==="Shown"))return"Disabled";const F=e(n).filter(z=>w.includes(z.action.entity));return F.length===0?"Disabled":e(v).isStackCell||F[0].action.entity!==w[0]?"Clickable":F.some(z=>z.dests.length)?"Draggable":"Clickable"};ct();var E=Zr(),x=a(E);x.__click=N;var L=a(x);{var W=w=>{var F=xe(),z=P(F);{var G=V=>{var ce=xe(),T=P(ce);{var D=y=>{var H=qr(),X=a(H),Ce=a(X),De=s(X,1,!0);m((pe,ie)=>{b(Ce,pe),b(De,ie)},[()=>String(e(v).field.duel.clock.turn).padStart(2,"0"),()=>e(v).field.duel.phase.toUpperCase()],le),r(y,H)},d=y=>{var H=xe(),X=P(H);{var Ce=pe=>{var ie=Yr(),re=a(ie),te=a(re),$e=s(re,2),Fe=a($e);m((Ne,Ie)=>{b(te,Ne),b(Fe,Ie)},[()=>Math.floor(e(A).current),()=>Math.floor(e(B).current)],le),r(pe,ie)},De=pe=>{var ie=xe(),re=P(ie);{var te=$e=>{var Fe=xe(),Ne=P(Fe);{var Ie=qe=>{var Ve=xe(),nt=P(Ve);{var Le=be=>{var Ae=xe(),Ye=P(Ae);de(Ye,1,()=>t().duel.nextPhaseList,_e,(Oe,at)=>{var ze=Hr(),Qe=a(ze);Qe.__click=[Ur,ye,at];var $t=a(Qe);m(vt=>b($t,vt),[()=>e(at).toUpperCase()],le),r(Oe,ze)}),r(be,Ae)};C(nt,be=>{t().duel.isEnded||be(Le)})}r(qe,Ve)};C(Ne,qe=>{t().waitMode==="Free"&&qe(Ie)})}r($e,Fe)};C(re,$e=>{e(v).column===5&&$e(te)},!0)}r(pe,ie)};C(X,pe=>{e(v).column===3?pe(Ce):pe(De,!1)},!0)}r(y,H)};C(T,y=>{e(v).column===1?y(D):y(d,!1)})}r(V,ce)};C(z,V=>{e(v).row===3&&V(G)})}r(w,F)},ee=w=>{var F=xe(),z=P(F);{var G=ce=>{var T=Or();const D=le(()=>e(se).find(ie=>ie.to===e(v)));var d=P(T);{var y=ie=>{var re=Pr(),te=a(re);Kt(te,{get entity(){return e(D).entity},state:"Disabled",dummyActionInfos:[],cardActionResolve:void 0}),m(()=>Be(re,`card_animation_receiver ${e(v).cellType??""} svelte-1boxe40`)),oe(1,re,()=>ue,()=>({key:e(D).entity.seq})),r(ie,re)};C(d,ie=>{e(D)&&e(D).index==="Top"&&ie(y)})}var H=s(d,2);de(H,1,()=>e(v).visibleEntities,_e,(ie,re)=>{var te=xe(),$e=P(te);{var Fe=Ne=>{var Ie=Nr(),qe=a(Ie);const Ve=le(()=>Te(e(re))),nt=le(()=>e(n).filter(Le=>Le.action.entity===e(re)));Kt(qe,{get entity(){return e(re)},get state(){return e(Ve)},get dummyActionInfos(){return e(nt)},cardActionResolve:void 0,get selectedList(){return c()},set selectedList(Le){c(Le)},$$legacy:!0}),oe(2,Ie,()=>ge,()=>({key:e(re).seq})),r(Ne,Ie)};C($e,Ne=>{e(se).every(Ie=>Ie.entity.seq!==e(re).seq)&&Ne(Fe)})}r(ie,te)});var X=s(H,2);{var Ce=ie=>{var re=Fr(),te=a(re);Kt(te,{get entity(){return e(D).entity},state:"Disabled",dummyActionInfos:[],cardActionResolve:void 0}),m(()=>Be(re,`card_animation_receiver ${e(v).cellType??""} svelte-1boxe40`)),oe(1,re,()=>ue,()=>({key:e(D).entity.seq})),r(ie,re)};C(X,ie=>{e(D)&&e(D).index!=="Top"&&ie(Ce)})}var De=s(X,2);{var pe=ie=>{var re=Ir();r(ie,re)};C(De,ie=>{e(v).owner.seat==="Below"&&ie(pe)})}r(ce,T)},V=ce=>{var T=Jr();const D=le(()=>e(se).find(re=>re.to===e(v)));var d=P(T);{var y=re=>{var te=Rr(),$e=a(te);Kt($e,{get entity(){return e(D).entity},state:"Disabled",dummyActionInfos:[],cardActionResolve:void 0}),oe(1,te,()=>ue,()=>({key:e(D).entity.seq})),r(re,te)};C(d,re=>{e(D)&&e(D).index!=="Top"&&re(y)})}var H=s(d,2);{var X=re=>{var te=Xr(),$e=P(te);de($e,1,()=>e(v).visibleEntities.map((Ie,qe)=>({index:qe,entity:Ie})).toReversed(),_e,(Ie,qe)=>{var Ve=xe(),nt=P(Ve);{var Le=be=>{var Ae=Wr();const Ye=le(()=>!e(v).isStackCell&&e(qe).index===0?Te(...e(v).visibleEntities):void 0);var Oe=P(Ae);{var at=vt=>{var St=Kr();r(vt,St)};C(Oe,vt=>{e(I).includes(e(qe).entity)&&vt(at)})}var ze=s(Oe,2),Qe=a(ze);const $t=le(()=>e(qe).index===0?e(n).filter(vt=>e(v).visibleEntities.includes(vt.action.entity)):void 0);Kt(Qe,{get entity(){return e(qe).entity},get state(){return e(Ye)},get dummyActionInfos(){return e($t)},cardActionResolve:void 0,get selectedList(){return c()},set selectedList(vt){c(vt)},$$legacy:!0}),m(()=>Be(ze,`duel_card_wrapper ${(e(qe).entity.exist?"duel_card_wrapper_exists":"")??""} svelte-1boxe40`)),oe(2,ze,()=>ge,()=>({key:e(qe).entity.seq})),r(be,Ae)};C(nt,be=>{e(se).every(Ae=>Ae.entity.seq!==e(qe).entity.seq)&&be(Le)})}r(Ie,Ve)});var Fe=s($e,2);{var Ne=Ie=>{var qe=Vr(),Ve=a(qe),nt=s(Ve);de(nt,1,()=>Wt(e(v).visibleEntities[0].status.maxCounterQty),_e,(Le,be)=>{var Ae=zr(),Ye=P(Ae),Oe=s(Ye);{var at=ze=>{var Qe=et();m(()=>b(Qe,`/${e(v).visibleEntities[0].status.maxCounterQty[e(be)]??""}`)),r(ze,Qe)};C(Oe,ze=>{(e(v).visibleEntities[0].status.maxCounterQty[e(be)]??9999)<100&&ze(at)})}m((ze,Qe)=>b(Ye,`【
              ${ze??""}${Qe??""} `),[()=>ir(e(be)),()=>e(v).visibleEntities[0].counterHolder.getQty(e(be))],le),r(Le,Ae)}),m(()=>b(Ve,`【${e(v).visibleEntities[0].battlePositionName??""}】 `)),r(Ie,qe)};C(Fe,Ie=>{e(v).visibleEntities[0].battlePosition&&Ie(Ne)})}r(re,te)};C(H,re=>{e(v).visibleEntities.length>0&&re(X)})}var Ce=s(H,2);{var De=re=>{var te=Gr(),$e=a(te);m(()=>b($e,e(v).visibleEntities.length)),r(re,te)};C(Ce,re=>{e(v).isStackCell&&re(De)})}var pe=s(Ce,2);{var ie=re=>{var te=Qr(),$e=a(te);Kt($e,{get entity(){return e(D).entity},state:"Disabled",dummyActionInfos:[],cardActionResolve:void 0}),oe(1,te,()=>ue,()=>({key:e(D).entity.seq})),r(re,te)};C(pe,re=>{e(D)&&e(D).index==="Top"&&re(ie)})}r(ce,T)};C(z,ce=>{e(v).cellType==="Hand"?ce(G):ce(V,!1)},!0)}r(w,F)};C(L,w=>{e(v).isDisabledCell?w(W):w(ee,!1)})}m(w=>{Be(E,`${`duel_field_cell duel_field_cell_${e(v).cellType} ${e(v).linkArrowSources.length===0?"":"duel_field_cell_linked"}`??""} svelte-1boxe40`),tt(E,"colspan",e(v).cellType==="Hand"?7:1),Be(x,`${w??""} svelte-1boxe40`)},[()=>`duel_field_cell_inner_box ${e(v).cellType} ${e(j)?"can_accept_drop":""} ${Y()?"can_action":""} ${e(_)?"is_selected":e(p)?"is_selectable":""} `],le),J("dragover",x,fe),J("drop",x,ae),r(f,E),_t()}Wa(["click"]);const ts=(f,i,t=void 0,l="!!!circular reference!!!")=>{let g=[];return JSON.stringify(f,(c,u)=>{if(typeof u=="object"){if(g.indexOf(u)>-1)return l;g.push(u)}let v=u;if(i&&(v=i(c,u)),typeof v=="function")return v.toString();if(v!==u&&typeof v=="object"){if(g.indexOf(v)>-1)return l;g.push(v)}return v},t)};var as=o('<div class="title svelte-14z6bdh"> </div>'),rs=o('<div class="title svelte-14z6bdh"> </div>'),ss=o('<div class="duel_log_chain_number svelte-14z6bdh"> </div>'),is=o('<div><a class="white_button" download="error_info.json">エラー情報ダウンロード</a></div>'),ns=o("<div><!> <!></div>"),os=o('<div><div style="display: flex;    justify-content: space-between;"><div style=" white-space: nowrap;text-align: center;"> </div> <!></div> <!></div>'),ls=o("<div><!> <!></div>"),vs=o("<div><!> <!></div>"),ds=o('<div class="duel_log svelte-14z6bdh"><div class="duel_log_header svelte-14z6bdh"></div> <div class="duel_log_body svelte-14z6bdh"></div> <div class="duel_log_footer svelte-14z6bdh"></div></div>');function cs(f,i){dt(i,!1);let t=ne(void 0),l=je(i,"log",8),g,c=ne([]);const u=()=>{const M=((g==null?void 0:g.seq)??-1)+1;l().records.slice(M).forEach(S=>{if(!g){$(c,[[[[S]]]]),g=S;return}if(!e(c)[S.clock.turn]){he(c,e(c)[S.clock.turn]=[[[S]]]),g=S;return}if(!e(c)[S.clock.turn][S.clock.phaseSeq]){he(c,e(c)[S.clock.turn][S.clock.phaseSeq]=[[S]]),g=S;return}if(g.clock.chainSeq===S.clock.chainSeq&&g.clock.chainBlockSeq===S.clock.chainBlockSeq&&g.duelist===S.duelist){e(c)[S.clock.turn][S.clock.phaseSeq].slice(-1)[0].push(S),g=S;return}e(c)[S.clock.turn][S.clock.phaseSeq].push([S]),g=S}),$(c,e(c)),nr().then(()=>e(t)&&e(t).scroll(0,e(t).clientHeight*990))};l().onUpdate.append(u),l().duel.view.onDuelUpdate.append(u),u(),ct();var v=xe(),A=P(v);{var B=M=>{var S=ds(),n=s(a(S),2);de(n,5,()=>e(c),_e,(q,R)=>{var I=vs(),_=a(I);{var p=Z=>{var we=as(),j=a(we);m(()=>b(j,`ターン：${e(R)[0][0][0].clock.turn??""}`)),r(Z,we)};C(_,Z=>{e(R)[0][0][0].clock.turn>0&&Z(p)})}var K=s(_,2);de(K,1,()=>e(R),_e,(Z,we)=>{var j=ls(),U=a(j);{var ve=ge=>{var ue=rs(),se=a(ue);m(()=>b(se,e(we)[0][0].clock.period.name)),r(ge,ue)};C(U,ge=>{e(we)[0][0].clock.turn>0&&ge(ve)})}var Me=s(U,2);de(Me,1,()=>e(we),_e,(ge,ue)=>{var se=os();const Ee=le(()=>{var E;return((E=e(ue).find(x=>x.chainNumber!==void 0))==null?void 0:E.chainNumber)??0});var ye=a(se),Y=a(ye),N=a(Y),fe=s(Y,2);{var ae=E=>{var x=ss(),L=a(x);m(()=>b(L,`チェーン：${e(Ee)??""}`)),r(E,x)};C(fe,E=>{e(Ee)&&E(ae)})}var Te=s(ye,2);de(Te,1,()=>e(ue),_e,(E,x)=>{var L=ns(),W=a(L);{var ee=G=>{var V=et();m(()=>b(V,e(x).text)),r(G,V)},w=G=>{var V=xe(),ce=P(V);{var T=d=>{var y=et();m((H,X,Ce)=>b(y,`移動：${H??""} ${X??""} ⇒ ${Ce??""}`),[()=>{var H;return(H=e(x).mainEntity)==null?void 0:H.toString()},()=>{var H;return(H=e(x).from)==null?void 0:H.toString()},()=>{var H;return(H=e(x).to)==null?void 0:H.toString()}],le),r(d,y)},D=d=>{var y=xe(),H=P(y);{var X=De=>{var pe=et();m((ie,re)=>b(pe,`生成：${ie??""} void ⇒ ${re??""}`),[()=>{var ie;return(ie=e(x).mainEntity)==null?void 0:ie.toString()},()=>{var ie;return(ie=e(x).to)==null?void 0:ie.toString()}],le),r(De,pe)},Ce=De=>{var pe=xe(),ie=P(pe);{var re=$e=>{var Fe=et();m((Ne,Ie)=>b(Fe,`消滅：${Ne??""} ${Ie??""} ⇒ void`),[()=>{var Ne;return(Ne=e(x).mainEntity)==null?void 0:Ne.toString()},()=>{var Ne;return(Ne=e(x).from)==null?void 0:Ne.toString()}],le),r($e,Fe)},te=$e=>{var Fe=et();m(()=>b(Fe,e(x).text)),r($e,Fe)};C(ie,$e=>{e(x).type==="EntityDisappear"?$e(re):$e(te,!1)},!0)}r(De,pe)};C(H,De=>{e(x).type==="EntityAppear"?De(X):De(Ce,!1)},!0)}r(d,y)};C(ce,d=>{e(x).type==="EntityMove"?d(T):d(D,!1)},!0)}r(G,V)};C(W,G=>{e(x).type==="ChainBlockHeader"?G(ee):G(w,!1)})}var F=s(W,2);{var z=G=>{var V=is(),ce=a(V);m(T=>tt(ce,"href",T),[()=>window.URL.createObjectURL(new Blob([ts(e(x).error,(T,D)=>["pool","bundles","duel"].includes(T)||typeof D=="function"?void 0:D,4)],{type:"text/plain"}))],le),r(G,V)};C(F,G=>{e(x).error&&G(z)})}m(G=>Be(L,`duel_log_record duel_log_record_${G??""} svelte-14z6bdh`),[()=>e(x).type.toSnakeCase()],le),r(E,L)}),m(()=>{var E,x,L;Be(se,`duel_log_block_duelist duel_log_block_duelist_${((E=e(ue)[0].duelist)==null?void 0:E.seat)??"system"} svelte-14z6bdh`),Be(Y,`duelist ${((x=e(ue)[0].duelist)==null?void 0:x.seat)??""} svelte-14z6bdh`),b(N,((L=e(ue)[0].duelist)==null?void 0:L.profile.name)||"SYSTEM")}),r(ge,se)}),m(()=>Be(j,`duel_log_block_phase duel_log_block_phase_${e(we)[0][0].clock.period.key??""} svelte-14z6bdh`)),r(Z,j)}),m(()=>Be(I,`duel_log_block_turn duel_log_block_turn_${e(R)[0][0][0].clock.turn??""} svelte-14z6bdh`)),r(q,I)}),za(n,q=>$(t,q),()=>e(t)),r(M,S)};C(A,M=>{(l().duel.view.infoBoardState==="Log"||l().duel.view.infoBoardState==="Default")&&M(B)})}r(f,v),_t()}var _s=o("<div><div> </div> <div> </div></div>");function Ra(f,i){dt(i,!1);let t=je(i,"duelist",12),l=ne(0),g=ne();const c=async()=>{const n=t().lp-e(l);if(!e(g)||Math.abs(n)<10){$(l,t().lp),e(g)&&(e(g)(),$(g,void 0));return}$(l,e(l)+Math.floor(Math.random()*n)),await ea(100),c()},u=()=>{t(t()),!e(g)&&t().lp!==e(l)&&new Promise(n=>{$(g,n),Math.abs(t().lp-e(l)),c()})};t().duel.log.onUpdate.append(u),c(),ct();var v=_s(),A=a(v),B=a(A),M=s(A,2),S=a(M);m(n=>{Be(v,`duelist duelist_${n??""} svelte-1sy3trd`),Be(A,`duelist_name duelist_${n??""}_name svelte-1sy3trd`),b(B,t().profile.name),Be(M,`duelist_lp ${(e(g)?"vibration":"")??""} svelte-1sy3trd`),b(S,e(l))},[()=>t().seat.toLowerCase()],le),r(f,v),_t()}const us=(f,i,t)=>(i(i()!=="Detail"?"Detail":"Normal"),console.info(t()),!0),fs=(f,i,t)=>(i(i()!=="Debug"?"Debug":"Normal"),console.info(t()),!0);var ps=o('<div class="svelte-1uevs9j"> </div>'),ms=o('<div class="svelte-1uevs9j"> </div>'),gs=o('<div class="link_arrow_emoji svelte-1uevs9j"> </div>'),ys=o('<div class="duel_card_info_row svelte-1uevs9j" style=" justify-content: space-between;"><div class="svelte-1uevs9j"> </div> <div class="svelte-1uevs9j"> </div></div>'),hs=o('<div></div> <div class="svelte-1uevs9j"> </div>',1),bs=o("<div> </div>"),ks=o('<span class="svelte-1uevs9j">/</span> <div class="monster_defense svelte-1uevs9j"> </div>',1),xs=o("<div> </div>"),ws=o('<div class="duel_card_info_row svelte-1uevs9j"><!> <!> <div style="flex-grow: 1;" class="svelte-1uevs9j"></div> <div class="monster_attack svelte-1uevs9j"> </div> <!></div> <div class="duel_card_info_row svelte-1uevs9j"></div>',1),Cs=o('<div class="duel_card_row svelte-1uevs9j"><div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"> </div></div>'),Ds=o('<div class="duel_card_row svelte-1uevs9j"><div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"> </div></div>'),$s=o("<!> <!>",1),Ss=o('<pre class="description svelte-1uevs9j"> </pre>'),Ms=o('<div class="duel_card_info_row svelte-1uevs9j" style="border-style: solid; border-width: 1px;"><!></div>'),Ts=o('<pre class="description svelte-1uevs9j"> </pre>'),Es=o('<!> <div class="duel_card_info_row svelte-1uevs9j"><!></div>',1),js=o('<div class="effect_counter_area_item svelte-1uevs9j"><span class="svelte-1uevs9j"> </span> <span class="svelte-1uevs9j"> </span> <span class="svelte-1uevs9j">/</span> <span class="svelte-1uevs9j"> </span></div>'),Bs=o('<div class="duel_card_info_row effect_counter_area svelte-1uevs9j"><div class="effect_counter_area_title svelte-1uevs9j">効果使用状況</div> <div class="effect_counter_area_body svelte-1uevs9j"></div></div>'),As=o("[ <!> ],",1),Ls=o('<div class="svelte-1uevs9j"> <!></div>'),qs=o('<div class="svelte-1uevs9j"> </div> <!> <div class="svelte-1uevs9j"></div>',1),Ys=o('<div class="svelte-1uevs9j"> </div>'),Us=o('<div class="svelte-1uevs9j"> </div>'),Hs=o('<div class="svelte-1uevs9j"> </div>'),Ps=o('<div class="svelte-1uevs9j"> </div>'),Ns=o('<div class="svelte-1uevs9j"> </div>'),Fs=o('<div class="svelte-1uevs9j"> </div>'),Is=o('<div class="duel_card_info_row svelte-1uevs9j"><div class="svelte-1uevs9j"><!> <div class="svelte-1uevs9j"></div> <!> <div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"></div> <!> <div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"></div> <!> <div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"></div> <!> <div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"></div> <!> <div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"></div> <!> <div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"> </div> <div class="svelte-1uevs9j"> </div> <div class="svelte-1uevs9j"> </div> <div class="svelte-1uevs9j"></div></div></div>'),Os=o('<div class="svelte-1uevs9j">※エラッタ前のカードです</div>'),Rs=o('<div class="svelte-1uevs9j">※テスト用カードです</div>'),Ks=o('<a target="_blank" rel="noopener noreferrer" title="コナミカードデータベース" class="svelte-1uevs9j"> </a>'),Ws=o('<a target="_blank" rel="noopener noreferrer" title="遊戯王カードWiki" class="svelte-1uevs9j">⇒遊戯王カードWiki</a>'),zs=o('<div class="duel_card_info_links svelte-1uevs9j"><!> <!> <a target="_blank" rel="noopener noreferrer" title="google" class="svelte-1uevs9j">⇒google検索</a></div>'),Vs=o("<!> <!>",1),Xs=o('<div role="contentinfo"><div class="duel_card_info_header svelte-1uevs9j"><div class="duel_card_info_row svelte-1uevs9j"><div class="svelte-1uevs9j"> </div></div> <div class="duel_card_info_row svelte-1uevs9j" style="position:sticky; top:0;"><!> <div class="svelte-1uevs9j"> </div></div> <!></div> <div class="duel_card_info_body svelte-1uevs9j"><!></div> <div class="duel_card_info_footer svelte-1uevs9j"><!></div></div>');function Gs(f,i){dt(i,!1);let t=je(i,"entity",8),l=je(i,"mode",12,"Normal"),g=ne(new Promise(()=>{}));const c=()=>{var M,S;let B=t()&&t().entityType==="Card"?t().origin.cardId:(S=(M=t())==null?void 0:M.parent)==null?void 0:S.origin.cardId;return B??!1?`https://www.db.yugioh-card.com/yugiohdb/card_search.action?ope=2&cid=${B}`:t()?`https://www.db.yugioh-card.com/yugiohdb/card_search.action?ope=1&sess=1&rp=10&mode=&sort=1&keyword=${t().origin.name}&stype=1&ctype=&othercon=2&starfr=&starto=&pscalefr=&pscaleto=&linkmarkerfr=&linkmarkerto=&link_m=2&atkfr=&atkto=&deffr=&defto=&releaseDStart=1&releaseMStart=1&releaseYStart=1999&releaseDEnd=&releaseMEnd=&releaseYEnd=`:""};ca(()=>(zt(t()),ka),()=>{$(g,la.then(async B=>{if(t().origin.description||t().origin.pendulumDescription||t().origin.wikiEncodedName)return t().origin;const M=B.getCardInfo(t().origin.name);if(M)return M.cardId!==void 0&&!M.description&&!M.pendulumDescription&&await ka([M.cardId]),M}))}),Da(),ct();var u=xe(),v=P(u);{var A=B=>{var M=Xs();M.__click=[us,l,t],M.__contextmenu=[fs,l,t];var S=a(M),n=a(S),q=a(n),R=a(q),I=s(n,2),_=a(I);{var p=Y=>{var N=ps(),fe=a(N);m(ae=>b(fe,ae),[()=>"★".repeat(t().lvl)],le),r(Y,N)},K=Y=>{var N=xe(),fe=P(N);{var ae=E=>{var x=ms(),L=a(x);m(W=>b(L,W),[()=>"☆".repeat(t().rank)],le),r(E,x)},Te=E=>{var x=xe(),L=P(x);{var W=ee=>{var w=gs(),F=a(w);m(z=>b(F,z),[()=>t().origin.linkArrowKeys.map(z=>Va[z].emoji).join("")],le),r(ee,w)};C(L,ee=>{t().origin.linkArrowKeys&&ee(W)},!0)}r(E,x)};C(fe,E=>{t().rank&&t().rank>0?E(ae):E(Te,!1)},!0)}r(Y,N)};C(_,Y=>{t().lvl&&t().lvl>0?Y(p):Y(K,!1)})}var Z=s(_,2),we=a(Z),j=s(I,2);{var U=Y=>{var N=$s(),fe=P(N);{var ae=L=>{var W=ys(),ee=a(W),w=a(ee),F=s(ee,2),z=a(F);m(()=>{b(w,`◀ ${t().psL??""}`),b(z,`${t().psR??""} ▶`)}),r(L,W)};C(fe,L=>{var W;(W=t().origin.monsterCategories)!=null&&W.includes("Pendulum")&&L(ae)})}var Te=s(fe,2);{var E=L=>{var W=ws(),ee=P(W),w=a(ee);de(w,1,()=>t().attr,_e,(D,d)=>{var y=hs(),H=P(y),X=s(H,2),Ce=a(X);m(()=>{Be(H,`monster_attr ${e(d)??""} svelte-1uevs9j`),b(Ce,`${$a[e(d)]??""}属性`)}),r(D,y)});var F=s(w,2);de(F,1,()=>t().types,_e,(D,d)=>{var y=bs(),H=a(y);m(()=>{Be(y,`monster_cat ${e(d)??""} svelte-1uevs9j`),b(H,`${ga[e(d)]??""}${Sa[e(d)]??""}族`)}),r(D,y)});var z=s(F,4),G=a(z),V=s(z,2);{var ce=D=>{var d=ks(),y=s(P(d),2),H=a(y);m(()=>b(H,t().def??"?")),r(D,d)};C(V,D=>{var d;(d=t().status.monsterCategories)!=null&&d.includes("Link")||D(ce)})}var T=s(ee,2);de(T,5,()=>t().status.monsterCategories??[],_e,(D,d)=>{var y=xs(),H=a(y);m(()=>{Be(y,`monster_cat ${e(d)??""} svelte-1uevs9j`),b(H,`${va[e(d)]??""}${_a[e(d)]??""}`)}),r(D,y)}),m(()=>b(G,t().atk??"?")),r(L,W)},x=L=>{var W=xe(),ee=P(W);{var w=z=>{var G=Cs(),V=s(a(G),2),ce=a(V);m(()=>b(ce,`${ya[t().status.spellCategory]??""}魔法`)),r(z,G)},F=z=>{var G=xe(),V=P(G);{var ce=T=>{var D=Ds(),d=s(a(D),2),y=a(d);m(()=>b(y,`${ha[t().status.trapCategory]??""}罠`)),r(T,D)};C(V,T=>{t().kind==="Trap"&&t().status.trapCategory&&T(ce)},!0)}r(z,G)};C(ee,z=>{t().kind==="Spell"&&t().status.spellCategory?z(w):z(F,!1)},!0)}r(L,W)};C(Te,L=>{t().kind==="Monster"?L(E):L(x,!1)})}r(Y,N)};C(j,Y=>{l()!=="Debug"&&Y(U)})}var ve=s(S,2),Me=a(ve);{var ge=Y=>{var N=Es(),fe=P(N);{var ae=x=>{var L=Ms(),W=a(L);pt(W,()=>e(g),ee=>{var w=et('"読み込み中"');r(ee,w)},(ee,w)=>{var F=Ss(),z=a(F);m(()=>{var G;return b(z,(G=e(w))==null?void 0:G.pendulumDescription)}),r(ee,F)}),r(x,L)};C(fe,x=>{var L;(L=t().status.monsterCategories)!=null&&L.includes("Pendulum")&&x(ae)})}var Te=s(fe,2),E=a(Te);pt(E,()=>e(g),x=>{var L=et('"読み込み中"');r(x,L)},(x,L)=>{var W=Ts(),ee=a(W);m(()=>{var w;return b(ee,(w=e(L))==null?void 0:w.description)}),r(x,W)}),r(Y,N)},ue=Y=>{var N=xe(),fe=P(N);{var ae=E=>{var x=xe(),L=P(x);{var W=ee=>{var w=Bs(),F=s(a(w),2);de(F,5,()=>t().actions,_e,(z,G)=>{var V=xe();const ce=le(()=>e(G).actionCountUpperBound),T=le(()=>e(G).actionCount);var D=P(V);{var d=y=>{var H=js(),X=a(H),Ce=a(X),De=s(X,2),pe=a(De),ie=s(De,4),re=a(ie);m(()=>{b(Ce,e(G).title),b(pe,e(T)),b(re,e(ce))}),r(y,H)};C(D,y=>{e(ce)!==void 0&&e(T)!==void 0&&y(d)})}r(z,V)}),r(ee,w)};C(L,ee=>{t().actions.some(w=>w.actionCountUpperBoundKey)&&ee(W)})}r(E,x)},Te=E=>{var x=Is(),L=a(x),W=a(L);de(W,0,()=>["info","status"],_e,(Le,be)=>{var Ae=qs(),Ye=P(Ae),Oe=a(Ye),at=s(Ye,2);de(at,1,()=>Object.entries(t()[be]),_e,(Qe,$t)=>{let vt=()=>e($t)[0],St=()=>e($t)[1];var jt=Ls(),qt=a(jt),sa=s(qt);{var Yt=kt=>{var Mt=As(),xt=s(P(Mt));de(xt,1,St,_e,(ia,na)=>{var h=et();m(k=>b(h,`${k??""},`),[()=>e(na).toString()],le),r(ia,h)}),r(kt,Mt)},Xt=kt=>{var Mt=et();m(xt=>b(Mt,`${xt??""},`),[()=>{var xt;return(xt=St())==null?void 0:xt.toString()}],le),r(kt,Mt)};C(sa,kt=>{Array.isArray(St())?kt(Yt):kt(Xt,!1)})}m(()=>b(qt,`"${vt()??""}" : `)),r(Qe,jt)});var ze=s(at,2);ze.textContent="},",m(()=>b(Oe,`"${be??""}" :{`)),r(Le,Ae)});var ee=s(W,2);ee.textContent='"actions" :[';var w=s(ee,2);de(w,1,()=>t().actions,_e,(Le,be)=>{var Ae=Ys(),Ye=a(Ae);m(()=>b(Ye,`"${e(be).playType??""} ${e(be).title??""}",`)),r(Le,Ae)});var F=s(w,2);F.textContent="],";var z=s(F,2);z.textContent='"substituteEffects" :[';var G=s(z,2);de(G,1,()=>t().substituteEffects,_e,(Le,be)=>{var Ae=Us(),Ye=a(Ae);m(()=>b(Ye,`"${e(be).title??""}",`)),r(Le,Ae)});var V=s(G,2);V.textContent="],";var ce=s(V,2);ce.textContent='"continuousEffects" :[';var T=s(ce,2);de(T,1,()=>t().continuousEffects,_e,(Le,be)=>{var Ae=Hs(),Ye=a(Ae);m(()=>b(Ye,`"${e(be).isStarted??""}",`)),r(Le,Ae)});var D=s(T,2);D.textContent="],";var d=s(D,2);d.textContent='"procFilters" :[';var y=s(d,2);de(y,1,()=>t().procFilterBundle.operators,_e,(Le,be)=>{var Ae=Ps(),Ye=a(Ae);m(Oe=>b(Ye,`"${Oe??""} ${e(be).title??""} ${e(be).isEffective??""} ",`),[()=>e(be).isSpawnedBy.toString()],le),r(Le,Ae)});var H=s(y,2);H.textContent="],";var X=s(H,2);X.textContent='"numericStateOperators" :[';var Ce=s(X,2);de(Ce,1,()=>t().numericOprsBundle.operators,_e,(Le,be)=>{var Ae=Ns(),Ye=a(Ae);m(Oe=>b(Ye,`"${Oe??""} ${e(be).title??""} ${e(be).isEffective??""} ${e(be).isContinuous??""} ${e(be).targetState??""} ${e(be).targetStateGen??""} ",`),[()=>e(be).isSpawnedBy.toString()],le),r(Le,Ae)});var De=s(Ce,2);De.textContent="],";var pe=s(De,2);pe.textContent='"stateOperators" :[';var ie=s(pe,2);de(ie,1,()=>t().statusOperatorBundle.operators,_e,(Le,be)=>{var Ae=Fs(),Ye=a(Ae);m(Oe=>b(Ye,`"${Oe??""} ${e(be).title??""} ${e(be).isEffective??""} ",`),[()=>e(be).isSpawnedBy.toString()],le),r(Le,Ae)});var re=s(ie,2);re.textContent="],";var te=s(re,2);te.textContent='"lastMoveLogRecord" :{';var $e=s(te,2),Fe=a($e),Ne=s($e,2),Ie=a(Ne),qe=s(Ne,2),Ve=a(qe),nt=s(qe,2);nt.textContent="},",m((Le,be)=>{b(Fe,`"movedBy":"${Le??""}",`),b(Ie,`"movedAs":"${be??""}",`),b(Ve,`"movedAt":"${t().moveLog.latestRecord.movedAt.totalProcSeq??""}",`)},[()=>{var Le;return(Le=t().moveLog.latestRecord.movedBy)==null?void 0:Le.toString()},()=>t().moveLog.latestRecord.movedAs.join(" ")],le),r(E,x)};C(fe,E=>{l()==="Detail"?E(ae):E(Te,!1)},!0)}r(Y,N)};C(Me,Y=>{l()==="Normal"?Y(ge):Y(ue,!1)})}var se=s(ve,2),Ee=a(se);{var ye=Y=>{var N=Vs(),fe=P(N);{var ae=L=>{var W=Os();r(L,W)};C(fe,L=>{t().origin.isOldVersion&&L(ae)})}var Te=s(fe,2);{var E=L=>{var W=Rs();r(L,W)},x=L=>{var W=zs(),ee=a(W);{var w=G=>{var V=Ks();const ce=le(()=>t().entityType==="Card"?t():t().parent);var T=a(V);m(D=>{var d;tt(V,"href",D),b(T,`⇒${((d=e(ce))!=null&&d.origin.cardId?"公式カードページ":"公式で検索")??""}`)},[c],le),r(G,V)};C(ee,G=>{var V;t()&&(t().entityType==="Card"||((V=t().parent)==null?void 0:V.entityType)==="Card")&&G(w)})}var F=s(ee,2);pt(F,()=>e(g),null,(G,V)=>{var ce=xe(),T=P(ce);{var D=d=>{var y=Ws();m(()=>tt(y,"href",`https://yugioh-wiki.net/index.php?${e(V).wikiEncodedName}`)),r(d,y)};C(T,d=>{e(V)&&e(V).wikiEncodedName&&d(D)})}r(G,ce)});var z=s(F,2);m(()=>tt(z,"href",`https://www.google.com/search?q=遊戯王 ${t().origin.name}`)),r(L,W)};C(Te,L=>{t().origin.isForTest?L(E):L(x,!1)})}r(Y,N)};C(Ee,Y=>{t()&&Y(ye)})}m((Y,N)=>{Be(M,`duel_card duel_card_info ${t().origin.kind??""} ${Y??""} svelte-1uevs9j`),b(R,t().nm),b(we,N)},[()=>{var Y;return(Y=t().origin.monsterCategories)==null?void 0:Y.join(" ")},()=>"★".repeat(t().lvl||0)],le),r(B,M)};C(v,B=>{t()&&B(A)})}r(f,u),_t()}Wa(["click","contextmenu"]);var Qs=o('<div class="duel_field_cell_info_item svelte-1xj7qf1"><!></div>'),Js=o('<div class="duel_field_cell_info_box svelte-1xj7qf1"><div class="duel_field_cell_info_label svelte-1xj7qf1"> </div> <!></div>'),Zs=o('<div class="duel_field_cell_info svelte-1xj7qf1"><div class="duel_field_cell_info_header item_btn svelte-1xj7qf1"><div class="svelte-1xj7qf1"> </div> <div class="svelte-1xj7qf1"> </div></div> <div class="duel_field_cell_info_body svelte-1xj7qf1"></div></div>');function ei(f,i){dt(i,!1);let t=je(i,"cell",12);const l=()=>{t(t())},g=A=>t().cardEntities.filter(B=>B.face===A);t().field.duel.view.onDuelUpdate.append(l),ct();var c=xe(),u=P(c);{var v=A=>{var B=Zs(),M=a(B),S=a(M),n=a(S),q=s(S,2),R=a(q),I=s(M,2);de(I,4,()=>["FaceUp","FaceDown"],_e,(_,p)=>{var K=xe(),Z=P(K);{var we=j=>{var U=Js(),ve=a(U),Me=a(ve),ge=s(ve,2);de(ge,1,()=>g(p).toSorted(or),_e,(ue,se)=>{var Ee=Qs(),ye=a(Ee);const Y=le(()=>t().owner===t().field.duel.duelists.Below);Kt(ye,{get entity(){return e(se)},get isVisibleForcibly(){return e(Y)},isWideMode:!0,cardActionResolve:void 0}),r(ue,Ee)}),m(()=>b(Me,p==="FaceUp"?"表向き":"裏向き")),r(j,U)};C(Z,j=>{g(p).length&&j(we)})}r(_,K)}),m(()=>{var _;b(n,(_=t().owner)==null?void 0:_.profile.name),b(R,t().cellType)}),r(A,B)};C(u,A=>{t().field.duel.view.infoBoardState==="CellInfo"&&A(v)})}r(f,c),_t()}var ti=o('<div class="duel_config_item svelte-y4u26k"><label class="toggle svelte-y4u26k"><input type="checkbox" class="svelte-y4u26k"></label> <span class="svelte-y4u26k"> </span></div>'),ai=o('<div class="duel_config svelte-y4u26k"><div class="duel_config_title svelte-y4u26k">デュエル設定</div> <div class="duel_config_group svelte-y4u26k"><div class="duel_config_group_title svelte-y4u26k">チェーン設定</div> <!></div></div>');function ri(f,i){dt(i,!1);let t=je(i,"viewController",8),l=je(i,"userProfile",12);ct();var g=xe(),c=P(g);{var u=v=>{var A=ai(),B=s(a(A),2),M=s(a(B),2);de(M,1,()=>dr,_e,(S,n)=>{var q=ti(),R=a(q),I=a(R),_=s(R,2),p=a(_);m(()=>b(p,lr[e(n)])),vr(I,()=>l().chainConfig[e(n)],K=>l(l().chainConfig[e(n)]=K,!0)),J("change",I,()=>l().save()),r(S,q)}),r(v,A)};C(c,v=>{t().infoBoardState==="Config"&&v(u)})}r(f,g),_t()}function si(f,{from:i,to:t},l={}){var{delay:g=0,duration:c=U=>Math.sqrt(U)*120,easing:u=xa}=l,v=getComputedStyle(f),A=v.transform==="none"?"":v.transform,[B,M]=v.transformOrigin.split(" ").map(parseFloat);B/=f.clientWidth,M/=f.clientHeight;var S=ii(f),n=f.clientWidth/t.width/S,q=f.clientHeight/t.height/S,R=i.left+i.width*B,I=i.top+i.height*M,_=t.left+t.width*B,p=t.top+t.height*M,K=(R-_)*n,Z=(I-p)*q,we=i.width/t.width,j=i.height/t.height;return{delay:g,duration:typeof c=="function"?c(Math.sqrt(K*K+Z*Z)):c,easing:u,css:(U,ve)=>{var Me=ve*K,ge=ve*Z,ue=U+ve*we,se=U+ve*j;return`transform: ${A} translate(${Me}px, ${ge}px) scale(${ue}, ${se});`}}}function ii(f){if("currentCSSZoom"in f)return f.currentCSSZoom;for(var i=f,t=1;i!==null;)t*=+getComputedStyle(i).zoom,i=i.parentElement;return t}var ni=o('<div class="chain_number svelte-lqu21u"> </div>'),oi=o('<div class="duel_card_row svelte-lqu21u"> </div>'),li=o('<div class="appendix svelte-lqu21u"> </div>'),vi=o('<div class="appendix_wrapper svelte-lqu21u"></div>'),di=o('<div><div><!> <div> </div> <div><!> <div class="duel_card_row svelte-lqu21u"><div> </div> <!></div></div></div></div>'),ci=o("<div></div>");function _i(f,i){dt(i,!1);let t=je(i,"duel",8),l=je(i,"position",8,"left");const g=-100,c=()=>l()==="left"?-100:100;let u=ne([]),v=Promise.resolve(),A=Promise.resolve();const B=1e3,M=500,S=400,n=R=>{const I={...R};I.isKnown=R.chainBlockInfo.action.entity.controller.duelistType==="Player"||R.chainBlockInfo.action.entity.face==="FaceUp",I.chainBlockInfo.onStateChange.append(_=>{if(_==="done"||_==="failed"||_==="negated")return v=v.then(async()=>{const p=new Date().getTime()-I.chainBlockInfo.wasSpawnedAt.getTime();p<B&&await ea(B-p),$(u,e(u).filter(K=>K.seq!==I.seq)),await ea(M+S)}).then(),"RemoveMe";$(u,e(u))}),A=A.then(async()=>{$(u,[I,...e(u)].sort((_,p)=>cr.isSameChain(_.clock,p.clock)&&_.chainBlockInfo.action.isWithChainBlock&&p.chainBlockInfo.action.isWithChainBlock?p.clock.totalProcSeq-_.clock.totalProcSeq:_.clock.totalProcSeq-p.clock.totalProcSeq)),await ea(300)}),v=v.then(()=>ea(1e3))};t().chainBlockLog.onInsert.append(n),ct();var q=ci();de(q,13,()=>e(u),R=>R.seq,(R,I)=>{var _=di();const p=le(()=>{const{activator:N,action:fe,appendix:ae}=e(I).chainBlockInfo;return{activator:N,action:fe,appendix:ae}});var K=a(_),Z=a(K);{var we=N=>{var fe=ni(),ae=a(fe);m(()=>b(ae,`チェーン：${e(I).chainBlockInfo.chainNumber??""}`)),r(N,fe)};C(Z,N=>{e(I).chainBlockInfo.chainNumber&&N(we)})}var j=s(Z,2),U=a(j),ve=s(j,2),Me=a(ve);{var ge=N=>{var fe=oi(),ae=a(fe);m(()=>b(ae,e(I).isKnown?e(p).action.entity.nm:"？？？")),r(N,fe)};C(Me,N=>{(e(p).action.entity.entityType==="Card"||e(p).action.entity.entityType==="Token")&&N(ge)})}var ue=s(Me,2),se=a(ue),Ee=a(se),ye=s(se,2);{var Y=N=>{var fe=vi();de(fe,5,()=>e(p).appendix,_e,(ae,Te)=>{var E=li(),x=a(E);m(()=>b(x,e(Te))),r(ae,E)}),r(N,fe)};C(ye,N=>{e(p).appendix&&N(Y)})}m((N,fe,ae)=>{Be(_,`cut_in_row ${(!e(I).chainBlockInfo.chainNumber||e(I).chainBlockInfo.chainNumber===1?"cut_in_row_first":"")??""} svelte-lqu21u`),Be(K,`cut_in_item cut_in_item_${N??""} cut_in_item_${e(I).chainBlockInfo.state??""} svelte-lqu21u`),Be(j,`duelist_name duelist_${N??""}_name svelte-lqu21u`),b(U,e(p).activator.profile.name),Be(ve,`duel_card duel_card_${N??""} ${fe??""} ${(e(I).isKnown?e(p).action.entity.origin.kind:"")??""} ${e(p).action.entity.entityType??""}  svelte-lqu21u`),b(Ee,ae)},[()=>e(p).activator.seat.toLowerCase(),()=>e(I).isKnown?(e(p).action.entity.status.monsterCategories??[]).join(" "):"Token",()=>e(p).action.toString()],le),oe(3,K,()=>Br,()=>new Date().getTime()-e(I).chainBlockInfo.wasSpawnedAt.getTime()<B?{x:c(),duration:S}:{y:g,duration:S}),_r(_,()=>si,()=>({duration:M})),r(R,_)}),m(()=>Be(q,`cut_in_container cut_in_container_${l()??""} svelte-lqu21u`)),r(f,q),_t()}const ui=Ar({duration:400});var fi=o('<div class="duel_desk_left v_flex svelte-1w535im"><!> <!> <!></div>'),pi=o('<button class="duel_field_header_message svelte-1w535im"> </button> <div class="duel_field_header_buttons svelte-1w535im"><button class="svelte-1w535im">サレンダー</button></div>',1),mi=o("<tr></tr>"),gi=o('<table class="duel_field svelte-1w535im"><tbody class="svelte-1w535im"></tbody></table>'),yi=o('<button class="svelte-1w535im">OK</button>'),hi=o('<button class="svelte-1w535im">cancel</button>'),bi=o("<!> <!>",1),ki=o('<button class="svelte-1w535im"> </button>'),xi=o('<div style="text-align: left;"><!> <!> <!></div>'),wi=o('<div><!> <div class=" duel_desk_center v_flex svelte-1w535im"><div class="duel_field_header svelte-1w535im"><!></div> <div class="duel_field_body svelte-1w535im"><!></div> <div class="duel_field_footer svelte-1w535im"><!></div></div> <!></div> <div style="position:fixed;bottom:0"> </div> <!> <div><!></div>',1);function Ci(f,i){dt(i,!1);let t=je(i,"duel",12),l=je(i,"userProfile",8),g=ne(0),c=ne(0),u=ne([]),v=ne([]),A=()=>{},B=ne([]),M=ne(),S=ne(),n=ne(()=>!1),q=ne(!1);const R=d=>{A=d.resolve,$(B,d.dummyActionInfos.filter(y=>y.action.entity.entityType==="Duelist").filter(y=>y.action.entity.controller.seat==="Below")),$(M,void 0),$(S,void 0),$(v,[]),$(u,[]),$(q,!1),d.entitiesChoices&&($(M,d.entitiesChoices),$(n,()=>{var y;return((y=d.entitiesChoices)==null?void 0:y.validator(e(u)))??!1}),$(q,d.entitiesChoices.cancelable),e(M).selectables.every(y=>y.cell.isPlayFieldCell&&y.getIndexInCell()===0||y.cell.cellType==="Hand"&&y.controller.duelistType==="Player"||y.entityType==="Duelist")||t().view.modalController.entitySelector.show({title:t().view.message,position:"Middle",entitiesChoices:d.entitiesChoices,chainBlockInfos:d.chainBlockInfos,cancelable:d.entitiesChoices.cancelable}).then(y=>{A({selectedEntities:y})})),d.cellsChoices&&($(S,d.cellsChoices),$(n,()=>{var y;return((y=d.cellsChoices)==null?void 0:y.validator(e(v)))??!1}),$(q,d.cellsChoices.cancelable))};t().view.onWaitStart.append(R);const I=()=>{A=()=>{},$(S,void 0),$(M,void 0),$(v,[]),$(u,[]),$(n,()=>!1),$(q,!1)};t().view.onWaitEnd.append(I);let _=ne(void 0),p=ne("Normal");const K=({card:d,mode:y})=>{$(_,d),$(p,y??(e(_)===d||e(p)==="Normal"?"Detail":"Normal"))};t().view.onShowCardEntity.append(K);const Z=()=>{t(t())};t().view.onDuelUpdate.append(Z),t().log.onUpdate.append(Z);const we=()=>{e(M)&&e(M).validator(e(u))&&A({selectedEntities:e(u)}),e(S)&&e(S).validator(e(v))&&A({selectedCells:e(v)})},j=()=>{A({})},U=d=>{A({actionInfo:d})},ve=()=>{A({surrender:!0})};t().main();const Me=()=>e(g)<=1400?"compact":"wide";ct();var ge=wi(),ue=P(ge),se=a(ue);{var Ee=d=>{var y=fi(),H=a(y);Ra(H,{get duelist(){return t().duelists.Above}});var X=s(H,2);{var Ce=pe=>{Gs(pe,{get entity(){return e(_)},get mode(){return e(p)}})};C(X,pe=>{e(_)&&pe(Ce)})}var De=s(X,2);Ra(De,{get duelist(){return t().duelists.Below}}),r(d,y)};C(se,d=>{Me()==="wide"&&d(Ee)})}var ye=s(se,2),Y=a(ye),N=a(Y);{var fe=d=>{var y=pi(),H=P(y),X=a(H),Ce=s(H,2),De=a(Ce);m(()=>b(X,`[TURN:${t().clock.turn}][PHASE:${t().phase}] ${t().view.message}`)),J("click",H,()=>{t(t().view.infoBoardState="Log",!0)}),J("click",De,ve),r(d,y)};C(N,d=>{t().isEnded||d(fe)})}var ae=s(Y,2),Te=a(ae);{var E=d=>{var y=gi(),H=a(y);de(H,5,()=>t().field.cells,_e,(X,Ce,De)=>{var pe=mi();Be(pe,`${`duel_desk_row_${De}`??""} svelte-1w535im`),de(pe,5,()=>e(Ce),_e,(ie,re,te)=>{es(ie,{get view(){return t().view},row:De,column:te,get selectedEntities(){return e(u)},set selectedEntities($e){$(u,$e)},get selectedCells(){return e(v)},set selectedCells($e){$(v,$e)},$$legacy:!0})}),r(X,pe)}),r(d,y)};C(Te,d=>{t().clock.turn>0&&d(E)})}var x=s(ae,2),L=a(x);{var W=d=>{var y=bi(),H=P(y);{var X=pe=>{var ie=yi();m(re=>ie.disabled=re,[()=>!e(n)()],le),J("click",ie,we),r(pe,ie)};C(H,pe=>{((e(M)&&e(M).qty)??(e(S)&&e(S).qty)??9999)>1&&pe(X)})}var Ce=s(H,2);{var De=pe=>{var ie=hi();J("click",ie,j),r(pe,ie)};C(Ce,pe=>{e(q)&&pe(De)})}r(d,y)},ee=d=>{var y=xe(),H=P(y);de(H,1,()=>e(B),_e,(X,Ce)=>{var De=ki(),pe=a(De);m(()=>b(pe,e(Ce).action.title)),J("click",De,()=>U(e(Ce))),r(X,De)}),r(d,y)};C(L,d=>{e(M)&&e(M).selectables.length||e(S)&&e(S).selectables?d(W):d(ee,!1)})}var w=s(ye,2);{var F=d=>{var y=xi(),H=a(y);cs(H,{get log(){return t().log}});var X=s(H,2);ei(X,{get cell(){return t().view.infoBoardCell}});var Ce=s(X,2);ri(Ce,{get userProfile(){return l()},get viewController(){return t().view}}),m(De=>Be(y,`duel_desk_right duel_desk_right_${De??""}  svelte-1w535im`),[()=>t().view.infoBoardState.toLowerCase()],le),oe(3,y,()=>ke,()=>({duration:e(g)>1400?0:200,axis:"x"})),r(d,y)};C(w,d=>{(e(g)>1400||t().view.infoBoardState!=="Default")&&d(F)})}var z=s(ue,2),G=a(z),V=s(z,2);ur(V,{get modalController(){return t().view.modalController}});var ce=s(V,2),T=a(ce);const D=le(()=>Me()==="wide"?"right":"left");_i(T,{get duel(){return t()},get position(){return e(D)}}),m((d,y)=>{Be(ue,`flex duel_desk ${d??""}_mode svelte-1w535im`),b(G,y),Be(ce,`cutin ${d??""}_mode svelte-1w535im`)},[Me,()=>t().clock.toFullString()],le),ua("innerWidth",d=>$(g,d)),ua("innerHeight",d=>$(c,d)),r(f,ge),_t()}var Di=o("<div></div>"),$i=o("<!> <!> <!> <!>",1),Si=o('<span class="atk svelte-1y1qbq4"> </span> <span class="slash svelte-1y1qbq4">/</span> <span class="def svelte-1y1qbq4"> </span>',1),Mi=o('<div role="listitem"><div class="svelte-1y1qbq4"><div class="duel_card_row card_name svelte-1y1qbq4"> </div> <div style="display:flex; flex-wrap: wrap;" class="svelte-1y1qbq4"><div style="" class="svelte-1y1qbq4"><!> <!> <!></div> <div class="atk_def svelte-1y1qbq4"><!></div></div></div></div>');function Qa(f,i){dt(i,!1);let t=je(i,"mode",8),l=je(i,"cardInfo",8),g=je(i,"onAttention",8),c=je(i,"cardControlEventHandlers",8);ct();var u=Mi(),v=a(u),A=a(v),B=a(A),M=s(A,2),S=a(M),n=a(S);{var q=j=>{var U=$i(),ve=P(U);{var Me=ye=>{var Y=et();m(()=>b(Y,`★${l().level??""}`)),r(ye,Y)},ge=ye=>{var Y=xe(),N=P(Y);{var fe=Te=>{var E=et();m(()=>b(E,`☆${l().rank??""}`)),r(Te,E)},ae=Te=>{var E=xe(),x=P(E);{var L=W=>{var ee=et();m(()=>b(ee,`Ｌ${l().link??""}`)),r(W,ee)};C(x,W=>{l().link&&W(L)},!0)}r(Te,E)};C(N,Te=>{l().rank?Te(fe):Te(ae,!1)},!0)}r(ye,Y)};C(ve,ye=>{l().level?ye(Me):ye(ge,!1)})}var ue=s(ve,2);de(ue,1,()=>l().attributes??[],_e,(ye,Y)=>{var N=Di();m(()=>Be(N,`monster_attr ${e(Y)??""} svelte-1y1qbq4`)),r(ye,N)});var se=s(ue,2);de(se,1,()=>l().types??[],_e,(ye,Y)=>{var N=et();m(()=>b(N,ga[e(Y)])),r(ye,N)});var Ee=s(se,2);de(Ee,1,()=>l().monsterCategories??[],_e,(ye,Y)=>{var N=et();m(()=>b(N,va[e(Y)])),r(ye,N)}),r(j,U)};C(n,j=>{l().kind==="Monster"&&j(q)})}var R=s(n,2);{var I=j=>{var U=et();m(()=>b(U,`${ya[l().spellCategory]??""}魔法`)),r(j,U)};C(R,j=>{l().spellCategory&&j(I)})}var _=s(R,2);{var p=j=>{var U=et();m(()=>b(U,`${ha[l().trapCategory]??""}罠`)),r(j,U)};C(_,j=>{l().trapCategory&&j(p)})}var K=s(S,2),Z=a(K);{var we=j=>{var U=Si(),ve=P(U),Me=a(ve),ge=s(ve,4),ue=a(ge);m(()=>{b(Me,l().attack??"?"),b(ue,l().defense??"?")}),r(j,U)};C(Z,j=>{l().kind==="Monster"&&j(we)})}m(j=>{Be(u,`${j??""} svelte-1y1qbq4`),b(B,l().name)},[()=>{var j,U;return`deck_editor_card duel_card ${l().kind} ${(U=(j=l())==null?void 0:j.monsterCategories)==null?void 0:U.join(" ")} ${l().isImplemented?"is_implemented":"is_not_implemented"}`}],le),J("click",u,()=>g()(l())),J("touchstart",u,j=>c().onCardDragStart(j,t(),l())),J("touchmove",u,j=>c().onCardDragging(j,t())),J("touchend",u,function(...j){var U;(U=c().onCardDragEnd)==null||U.apply(this,j)}),J("touchcancel",u,function(...j){var U;(U=c().onCardDragCancel)==null||U.apply(this,j)}),J("mousedown",u,j=>c().onCardDragStart(j,t(),l())),J("mousemove",u,j=>c().onCardDragging(j,t())),J("mouseup",u,function(...j){var U;(U=c().onCardDragEnd)==null||U.apply(this,j)}),r(f,u),_t()}var Ti=o('<button class="button_style_reset plus_minus_button svelte-1ty6ui7">+</button> <button class="button_style_reset plus_minus_button svelte-1ty6ui7">-</button>',1),Ei=o('<li class="deck_editor_item svelte-1ty6ui7"><!> <!></li>'),ji=o('<div class="deck_editor_card_list_wrapper svelte-1ty6ui7"><ul></ul></div>');function Bi(f,i){dt(i,!1);let t=je(i,"cardList",8),l=je(i,"mode",8),g=je(i,"state",8),c=je(i,"onAttention",8),u=je(i,"cardControlEventHandlers",8);const v=20;let A=ne(0),B=ne(v),M=ne(0),S=ne(0),n=ne(0),q=ne();ca(()=>(e(q),zt(l()),zt(t()),e(n),e(S)),()=>{if(e(q))if(he(q,e(q).scrollTop=0),l()==="List"){const _=t().length>v?v:t().length;e(n)||($(S,e(q).scrollHeight/_),$(n,Math.ceil(e(S)))),$(M,e(n)*(t().length-v*2)+Math.ceil(e(S)*(v*2-1)))}else $(B,t().length)}),Da(),ct();var R=ji(),I=a(R);de(I,5,t,_e,(_,p,K)=>{var Z=xe(),we=P(Z);{var j=U=>{var ve=Ei(),Me=a(ve);Qa(Me,{get mode(){return l()},get cardInfo(){return e(p)},get onAttention(){return c()},get cardControlEventHandlers(){return u()}});var ge=s(Me,2);{var ue=se=>{var Ee=Ti(),ye=P(Ee),Y=s(ye,2);m(N=>{ye.disabled=!e(p).isImplemented,tt(ye,"title",e(p).isImplemented?`※shiftキー同時押しで一括投入
※ctrlキー同時押しで枚数制限無視`:""),Y.disabled=N,tt(Y,"title",e(p).isImplemented?"※shiftキー同時押しで一括外し":"")},[()=>t().every(N=>N.name!==e(p).name)],le),J("click",ye,N=>u().onCardAppend(N,e(p))),J("click",Y,N=>u().onCardRemove(N,e(p))),r(se,Ee)};C(ge,se=>{l()==="Deck"&&se(ue)})}r(U,ve)};C(we,U=>{K>=e(A)&&K<=e(B)&&U(j)})}r(_,Z)}),za(I,_=>$(q,_),()=>e(q)),m(_=>{Be(I,`deck_editor_card_list ${_??""}  indexLowerBound_${e(A)??""} indexUpperBound=${e(B)??""} svelte-1ty6ui7`),tt(I,"style",`height: ${(e(M)?e(M)+"px":"fit-content")??""};padding-top: ${e(A)*e(n)}px`)},[()=>g().toLowerCase()],le),J("scroll",R,_=>{if(!e(n))return;const p=Math.ceil(_.currentTarget.scrollTop/e(n));$(A,p<v?0:p-v),$(B,p+v)}),r(f,R),_t()}var Ai=o('<div class="svelte-m6gfl0"><button class="button_style_reset svelte-m6gfl0">クリア</button></div>'),Li=o('<div class="deck_editor_card_kind_header svelte-m6gfl0"><div class="svelte-m6gfl0"> <!> 枚）</div> <div style="display: flex;" class="svelte-m6gfl0"><!> <div class="triangle svelte-m6gfl0">▲</div></div></div> <div class="deck_editor_card_kind_body svelte-m6gfl0"><!></div>',1),qi=o("<div><!></div>"),Yi=o('<div class="deck_editor_card_list svelte-m6gfl0"></div>');function Ka(f,i){dt(i,!1);let t=je(i,"allCardTree",8),l=je(i,"deckCardTree",12),g=je(i,"mode",8),c=je(i,"onAttention",8),u=je(i,"searchCondition",8,void 0),v=je(i,"cardControlEventHandlers",8),A=ne("ExtraMonster");const B=ne(g()==="List"?t():l()),M=(..._)=>{const p=_.length?_:Wt(e(B)),K=(Z,we)=>{var j;return Ga(Z,we,(j=u())==null?void 0:j.sort.filter(U=>U.priority>0).toSorted((U,ve)=>U.priority-ve.priority))};p.forEach(Z=>e(B)[Z].sort(K))},S=(_,p)=>{l(l()[p]=[],!0)};let n=ne(structuredClone(e(B))),q=ne("");const R=_=>{if(!u())return!0;if(_.kind==="XyzMaterial")return!1;const p=fa(_);if(!u().deckCardKinds.includes(p)||u().name.trim().length&&[_.name,..._.nameTags??[],..._.textTags??[]].every(Z=>!Z.includes(u().name))||!_.isImplemented&&!u().others.includes("implemented")||_.isForTest&&!u().others.includes("test")||_.isOldVersion&&!u().others.includes("oldVersion"))return!1;if(_.kind==="Monster"){if(_.attributes&&!u().monsterAttributes.union(_.attributes).length||_.types&&!u().monsterTypes.union(_.types).length)return!1;const K=_.level??_.rank??_.link;return At(u().starLowerBound)&&(K??0)<u().starLowerBound||At(u().starUpperBound)&&(K??0)>u().starUpperBound||At(u().atkLowerBound)&&(_.attack??0)<u().atkLowerBound||At(u().atkUpperBound)&&(_.attack??0)>u().atkUpperBound||At(u().defLowerBound)&&(_.defense??0)<u().defLowerBound||At(u().defUpperBound)&&(_.defense??0)>u().defUpperBound||At(u().atkPlusDef)&&(!At(_.attack)||!At(_.defense)||_.attack+_.defense!==u().atkPlusDef)||!_.monsterCategories||p==="ExtraMonster"&&!_.monsterCategories.union(u().exMonsterCategories).length?!1:_.monsterCategories.union(u().monsterCategories).length}if(_.kind==="Spell")return _.spellCategory&&u().spellCategories.includes(_.spellCategory);if(_.kind==="Trap")return _.trapCategory&&u().trapCategories.includes(_.trapCategory)};ca(()=>(zt(g()),e(B),zt(l()),e(A),e(n)),()=>{if(g()==="Deck"){if(Wt(e(B)).forEach(_=>he(B,e(B)[_]=l()[_])),!e(B)[e(A)].length)$(A,Wt(e(B)).find(_=>e(B)[_].find(R))??"ExtraMonster");else{const _=Wt(e(B)).map(p=>({kind:p,cardInfos:e(B)[p]})).filter(({cardInfos:p})=>p.length).find(({kind:p,cardInfos:K})=>K.length!==e(n)[p].length);_&&e(A)!==_.kind&&$(A,_.kind)}$(n,structuredClone(e(B)))}}),ca(()=>(zt(g()),zt(u()),e(q)),()=>{var _;if(g()==="List"){const p=JSON.stringify((_=u())==null?void 0:_.sort);e(q)!==p&&($(q,p),M())}}),Da(),ct();var I=Yi();de(I,5,()=>ta,_e,(_,p,K)=>{var Z=qi();const we=le(()=>e(B)[e(p)].filter(R));var j=a(Z);{var U=ve=>{var Me=Li(),ge=P(Me),ue=a(ge),se=a(ue),Ee=s(se);{var ye=x=>{var L=et();m(W=>b(L,`/ ${W??""}`),[()=>e(B)[e(p)].length.toLocaleString()],le),r(x,L)};C(Ee,x=>{g()==="List"&&x(ye)})}var Y=s(ue,2),N=a(Y);{var fe=x=>{var L=Ai(),W=a(L);J("click",W,ee=>S(ee,e(p))),r(x,L)};C(N,x=>{g()==="Deck"&&e(we).length&&x(fe)})}var ae=s(ge,2),Te=a(ae);const E=le(()=>e(A)===e(p)?"Open":"Close");Bi(Te,{get mode(){return g()},get cardList(){return e(we)},get onAttention(){return c()},get cardControlEventHandlers(){return v()},get state(){return e(E)}}),m(x=>b(se,`${Xa[e(p)]??""}（${x??""} `),[()=>e(we).length.toLocaleString()],le),J("click",ge,()=>{if(e(A)!==e(p)){$(A,e(p));return}$(A,ta.map((x,L)=>L+K).map(x=>x%ta.length).map(x=>ta[x]).filter(x=>x!==e(p)).find(x=>e(B)[x].find(R))??e(p))}),r(ve,Me)};C(j,ve=>{e(we).length&&ve(U)})}m(()=>Be(Z,`deck_editor_card_kind deckCardKind ${(e(p)===e(A)?"selected":"")??""} ${(e(we).length?"":"empty")??""} svelte-m6gfl0`)),r(_,Z)}),r(f,I),_t()}var Ui=o('<div class="svelte-7xhk0x"> </div>'),Hi=o('<div class="svelte-7xhk0x"> </div>'),Pi=o('<div class="link_arrow_emoji svelte-7xhk0x"> </div>'),Ni=o('<div class="duel_card_info_row svelte-7xhk0x" style="position:sticky; top:0;"><!></div>'),Fi=o('<div class="duel_card_info_row svelte-7xhk0x"><div class="svelte-7xhk0x"><pre class="description svelte-7xhk0x"> </pre></div></div> <div class="duel_card_info_row svelte-7xhk0x" style=" justify-content: space-between;"><div class="svelte-7xhk0x"> </div> <div class="svelte-7xhk0x"> </div></div>',1),Ii=o('<div></div> <div class="svelte-7xhk0x"> </div>',1),Oi=o("<div> </div>"),Ri=o('<span class="svelte-7xhk0x">/</span> <div class="monster_defense svelte-7xhk0x"> </div>',1),Ki=o("<div> </div>"),Wi=o('<div class="duel_card_info_row svelte-7xhk0x"><!> <!> <div style="flex-grow: 1;" class="svelte-7xhk0x"></div> <div class="monster_attack svelte-7xhk0x"> </div> <!></div> <div class="duel_card_info_row svelte-7xhk0x"></div>',1),zi=o('<div class="duel_card_row svelte-7xhk0x"><div class="svelte-7xhk0x"></div> <div class="svelte-7xhk0x"> </div></div>'),Vi=o('<div class="duel_card_row svelte-7xhk0x"><div class="svelte-7xhk0x"></div> <div class="svelte-7xhk0x"> </div></div>'),Xi=o('<div class="duel_card_info_row svelte-7xhk0x"><div class="svelte-7xhk0x">※エラッタ前カードです</div></div>'),Gi=o('<div class="duel_card_info_row svelte-7xhk0x"><div class="svelte-7xhk0x">※テスト用カードです</div></div>'),Qi=o('<div class="duel_card_info_links svelte-7xhk0x"><a target="_blank" rel="noopener noreferrer" title="コナミカードデータベース" class="svelte-7xhk0x"> </a> <a target="_blank" rel="noopener noreferrer" title="遊戯王カードWiki" class="svelte-7xhk0x">⇒遊戯王カードWiki</a> <a target="_blank" rel="noopener noreferrer" title="google" class="svelte-7xhk0x">⇒google検索</a></div>'),Ji=o('<div><div class="duel_card_info_header svelte-7xhk0x"><div class="duel_card_info_row svelte-7xhk0x"><div class="svelte-7xhk0x"> </div></div> <!> <div class="plus_minus_button_area svelte-7xhk0x"><button class="button_style_reset plus_minus_button svelte-7xhk0x">+</button> <button class="button_style_reset plus_minus_button svelte-7xhk0x">-</button></div></div> <div class="duel_card_info_body svelte-7xhk0x"><!> <!> <div class="duel_card_info_row description svelte-7xhk0x"><div class="svelte-7xhk0x"><pre class="description svelte-7xhk0x"> </pre></div></div> <!> <!></div></div>');function Zi(f,i){dt(i,!1);let t=je(i,"cardInfo",8,void 0),l=je(i,"onAttention",8),g=je(i,"cardControlEventHandlers",8),c=je(i,"deckCardTree",8);ct();var u=xe(),v=P(u);{var A=B=>{var M=Ji(),S=a(M),n=a(S),q=a(n),R=a(q),I=s(n,2);{var _=E=>{var x=Ni(),L=a(x);{var W=w=>{var F=Ui(),z=a(F);m(G=>b(z,G),[()=>"★".repeat(t().level)],le),r(w,F)},ee=w=>{var F=xe(),z=P(F);{var G=ce=>{var T=Hi(),D=a(T);m(d=>b(D,d),[()=>"★".repeat(t().rank)],le),r(ce,T)},V=ce=>{var T=xe(),D=P(T);{var d=y=>{var H=Pi(),X=a(H);m(Ce=>b(X,Ce),[()=>t().linkArrowKeys.map(Ce=>Va[Ce].emoji).join("")],le),r(y,H)};C(D,y=>{t().linkArrowKeys&&y(d)},!0)}r(ce,T)};C(z,ce=>{t().rank&&t().rank>0?ce(G):ce(V,!1)},!0)}r(w,F)};C(L,w=>{t().level&&t().level>0?w(W):w(ee,!1)})}r(E,x)};C(I,E=>{t().kind==="Monster"&&E(_)})}var p=s(I,2),K=a(p),Z=s(K,2),we=s(S,2),j=a(we);{var U=E=>{var x=Fi(),L=P(x),W=a(L),ee=a(W),w=a(ee),F=s(L,2),z=a(F),G=a(z),V=s(z,2),ce=a(V);m(()=>{b(w,t().pendulumDescription),b(G,`◀ ${t().pendulumScaleL??""}`),b(ce,`${t().pendulumScaleR??""} ▶`)}),r(E,x)};C(j,E=>{var x;(x=t().monsterCategories)!=null&&x.includes("Pendulum")&&E(U)})}var ve=s(j,2);{var Me=E=>{var x=Wi(),L=P(x),W=a(L);{var ee=D=>{var d=Ii(),y=P(d),H=s(y,2),X=a(H);m(()=>{Be(y,`monster_attr ${t().attributes[0]??""} svelte-7xhk0x`),b(X,`${$a[t().attributes[0]]??""}属性`)}),r(D,d)};C(W,D=>{t().attributes&&D(ee)})}var w=s(W,2);{var F=D=>{var d=Oi(),y=a(d);m(()=>{Be(d,`monster_cat ${t().types[0]??""} svelte-7xhk0x`),b(y,`${ga[t().types[0]]??""}${Sa[t().types[0]]??""}族`)}),r(D,d)};C(w,D=>{t().types&&D(F)})}var z=s(w,4),G=a(z),V=s(z,2);{var ce=D=>{var d=Ri(),y=s(P(d),2),H=a(y);m(()=>b(H,t().defense??"?")),r(D,d)};C(V,D=>{var d;(d=t().monsterCategories)!=null&&d.includes("Link")||D(ce)})}var T=s(L,2);de(T,5,()=>t().monsterCategories??[],_e,(D,d)=>{var y=Ki(),H=a(y);m(()=>{Be(y,`monster_cat ${e(d)??""} svelte-7xhk0x`),b(H,`${va[e(d)]??""}${_a[e(d)]??""}`)}),r(D,y)}),m(()=>b(G,t().attack??"?")),r(E,x)},ge=E=>{var x=xe(),L=P(x);{var W=w=>{var F=zi(),z=s(a(F),2),G=a(z);m(()=>b(G,`${ya[t().spellCategory]??""}魔法`)),r(w,F)},ee=w=>{var F=xe(),z=P(F);{var G=V=>{var ce=Vi(),T=s(a(ce),2),D=a(T);m(()=>b(D,`${ha[t().trapCategory]??""}罠`)),r(V,ce)};C(z,V=>{t().kind==="Trap"&&t().trapCategory&&V(G)},!0)}r(w,F)};C(L,w=>{t().kind==="Spell"&&t().spellCategory?w(W):w(ee,!1)},!0)}r(E,x)};C(ve,E=>{t().kind==="Monster"?E(Me):E(ge,!1)})}var ue=s(ve,2),se=a(ue),Ee=a(se),ye=a(Ee),Y=s(ue,2);{var N=E=>{var x=Xi();r(E,x)};C(Y,E=>{t().isOldVersion&&E(N)})}var fe=s(Y,2);{var ae=E=>{var x=Gi();r(E,x)},Te=E=>{var x=Qi(),L=a(x),W=a(L),ee=s(L,2),w=s(ee,2);m(F=>{tt(L,"href",F),b(W,`⇒${(t().cardId?"公式カードページ":"公式で検索")??""}`),tt(ee,"href",`https://yugioh-wiki.net/index.php?${t().wikiEncodedName}`),tt(w,"href",`https://www.google.com/search?q=遊戯王 ${t().name}`)},[()=>fr(t())],le),r(E,x)};C(fe,E=>{t().isForTest?E(ae):E(Te,!1)})}m((E,x)=>{Be(M,`duel_card duel_card_info ${t().kind??""} ${E??""} svelte-7xhk0x`),b(R,t().name),K.disabled=!t().isImplemented,tt(K,"title",t().isImplemented?`※shiftキー同時押しで一括投入
※ctrlキー同時押しで枚数制限無視`:""),Z.disabled=x,tt(Z,"title",t().isImplemented?"※shiftキー同時押しで一括外し":""),b(ye,t().description)},[()=>{var E;return(E=t().monsterCategories)==null?void 0:E.join(" ")},()=>c()[fa(t())].every(E=>E.name!==t().name)],le),J("click",K,E=>g().onCardAppend(E,t())),J("click",Z,E=>g().onCardRemove(E,t())),J("click",M,()=>l()(t())),r(B,M)};C(v,B=>{t()&&B(A)})}r(f,u),_t()}const en={0:{aaa:"日",aaaa:"日曜日",ddd:"Sun",dddd:"Sunday"},1:{aaa:"月",aaaa:"月曜日",ddd:"Mon",dddd:"Monday"},2:{aaa:"火",aaaa:"火曜日",ddd:"Tue",dddd:"Tuesday"},3:{aaa:"水",aaaa:"水曜日",ddd:"Wed",dddd:"Wednesday"},4:{aaa:"木",aaaa:"木曜日",ddd:"Thu",dddd:"Thursday"},5:{aaa:"金",aaaa:"金曜日",ddd:"Fri",dddd:"Friday"},6:{aaa:"土",aaaa:"土曜日",ddd:"Sat",dddd:"Saturday"}};class tn{constructor(){it(this,"DefaultSeparator1","/");it(this,"DefaultSeparator2"," ");it(this,"DefaultSeparator3",":");it(this,"createDate",i=>{if(!i)return;const t=new Date(i);if(!isNaN(t.getTime()))return t});it(this,"createDateOr",(i,t)=>this.createDate(i)||t||new Date);it(this,"truncateDate",i=>{const t=i||new Date;return new Date(t.getFullYear(),t.getMonth(),t.getDate())});it(this,"addDate",(i,t)=>{const l=this.createDateOr(i);return l.setDate(l.getDate()+t),l});it(this,"addMonth",(i,t)=>{const l=this.createDateOr(i);return l.setMonth(l.getMonth()+t),l});it(this,"addYear",(i,t)=>{const l=this.createDateOr(i);return l.setFullYear(l.getFullYear()+t),l});it(this,"getDayOfWeek",(i,t="dddd")=>{const l=this.createDate(i);return l?en[l.getDay()][t]:""});it(this,"formatToYYYYMMDD",(i,t=this.DefaultSeparator1)=>{const l=this.createDate(i);if(!l)return"";const g=l.getFullYear().toString(),c=("0"+(l.getMonth()+1)).slice(-2),u=("0"+l.getDate()).slice(-2);return g+t+c+t+u});it(this,"formatToYYYYMM",(i,t=this.DefaultSeparator1)=>{const l=this.createDate(i);if(!l)return"";t||(t="");const g=l.getFullYear().toString(),c=("0"+(l.getMonth()+1)).slice(-2);return g+t+c});it(this,"formatToHHMMSS",(i,t=this.DefaultSeparator3)=>{const l=this.createDate(i);if(!l)return"";t||(t="");const g=l.getHours(),c=l.getMinutes(),u=l.getSeconds();return("0"+g).slice(-2)+t+("0"+c).slice(-2)+t+("0"+u).slice(-2)});it(this,"formatToHHMM",(i,t=this.DefaultSeparator3)=>{const l=this.createDate(i);if(!l)return"";t||(t="");const g=("0"+l.getHours()).slice(-2),c=("0"+l.getMinutes()).slice(-2);return g+t+c});it(this,"formatToYYYYMMDD_HHMM",(i,t=this.DefaultSeparator1,l=this.DefaultSeparator2,g=this.DefaultSeparator3)=>{const c=this.createDate(i);return c?this.formatToYYYYMMDD(c,t)+l+this.formatToHHMM(c,g):""});it(this,"formatToYYYYMMDD_HHMMSS",(i,t=this.DefaultSeparator1,l=this.DefaultSeparator2,g=this.DefaultSeparator3)=>{const c=this.createDate(i);return c?this.formatToYYYYMMDD(c,t)+l+this.formatToHHMMSS(c,g):""})}}const bt=new tn;Date.prototype.truncateDate=function(){return bt.truncateDate(this)};Date.prototype.getCloneOr=function(f){return bt.createDateOr(this,f)};Date.prototype.addDate=function(f){return bt.addDate(this,f)};Date.prototype.addMonth=function(f){return bt.addDate(this,f)};Date.prototype.addYear=function(f){return bt.addDate(this,f)};Date.prototype.getDayOfWeek=function(f="dddd"){return bt.getDayOfWeek(this,f)};Date.prototype.formatToYYYYMM=function(f){return bt.formatToYYYYMM(this,f)};Date.prototype.formatToYYYYMMDD=function(f){return bt.formatToYYYYMMDD(this,f)};Date.prototype.formatToYYYYMMDD_HHMM=function(f,i,t){return bt.formatToYYYYMMDD_HHMM(this,f,i,t)};Date.prototype.formatToYYYYMMDD_HHMMSS=function(f,i,t){return bt.formatToYYYYMMDD_HHMMSS(this,f,i,t)};Date.prototype.formatToHHMM=function(f){return bt.formatToHHMM(this,f)};Date.prototype.formatToHHMMSS=function(f){return bt.formatToHHMMSS(this,f)};var an=o('<li class="deck_info_list_item svelte-2wdgc8"><div class="svelte-2wdgc8"> </div> <div class="svelte-2wdgc8"> </div> <div class="svelte-2wdgc8"> </div></li>'),rn=o('<ul class="deck_info_list svelte-2wdgc8"></ul>'),sn=o('<label for="file_selector" class="upload_area svelte-2wdgc8" role="region" aria-label="ファイルアップロードエリア"><div class="upload_area_message svelte-2wdgc8">ここにファイルをドロップ</div> <div class="upload_area_footer svelte-2wdgc8"><input type="file" id="file_selector" name="file_selector" accept=".json" multiple></div></label>'),nn=o('<div slot="body" class="modal_body svelte-2wdgc8"><!></div>'),on=o('<button class="svelte-2wdgc8">追加</button> <button class="svelte-2wdgc8">削除して追加</button> <button class="svelte-2wdgc8">戻る</button>',1),ln=o('<button class="svelte-2wdgc8">Cancel</button>'),vn=o('<div slot="footer" class="modal_window_footer svelte-2wdgc8"><!></div>');function dn(f,i){dt(i,!1);let t=je(i,"eventHolder",8),l=je(i,"args",8),g=je(i,"resolve",8),c=ne(Promise.resolve([])),u=ne();const v=()=>{$(u,new DataTransfer().files),$(c,Promise.resolve([]))},A=async q=>{q.preventDefault(),console.log("hoge",q)},B=async q=>{q.preventDefault(),q.dataTransfer&&S(q.dataTransfer.files)},M=()=>{S(e(u))},S=async q=>{if(!q.length)return;const R=[],I=[];for(const _ of q)try{I.push(...await Dt.createfromJson(_))}catch(p){p instanceof Error&&R.push(p.message)}if(R.length){console.log(...R);return}$(c,e(c).then(()=>I))},n=v;ct(),pr(f,{get eventHolder(){return t()},get args(){return l()},$$slots:{body:(q,R)=>{var I=nn(),_=a(I);pt(_,()=>la,null,(p,K)=>{var Z=xe(),we=P(Z);pt(we,()=>e(c),null,(j,U)=>{var ve=xe(),Me=P(ve);{var ge=se=>{var Ee=rn();de(Ee,5,()=>e(U),_e,(ye,Y)=>{var N=an(),fe=a(N),ae=a(fe),Te=s(fe,2),E=a(Te),x=s(Te,2),L=a(x);m((W,ee,w)=>{b(ae,e(Y).name),b(E,`${W??""}
                  /
                  ${ee??""}`),b(L,`最終使用日時 ： ${w??""}`)},[()=>e(Y).cardNames.filter(W=>{var ee,w;return!((w=(ee=e(K).getCardInfo(W))==null?void 0:ee.monsterCategories)!=null&&w.union(aa).length)}).length,()=>e(Y).cardNames.filter(W=>{var ee,w;return(w=(ee=e(K).getCardInfo(W))==null?void 0:ee.monsterCategories)==null?void 0:w.union(aa).length}).length,()=>e(Y).lastUsedAt.formatToYYYYMMDD_HHMM("/"," ",":")],le),r(ye,N)}),r(se,Ee)},ue=se=>{var Ee=sn(),ye=s(a(Ee),2),Y=a(ye);mr(Y,()=>e(u),N=>$(u,N)),J("change",Y,M),J("cancel",Y,n),J("drop",Ee,B),J("dragover",Ee,A),r(se,Ee)};C(Me,se=>{e(U).length?se(ge):se(ue,!1)})}r(j,ve)}),r(p,Z)}),r(q,I)},footer:(q,R)=>{var I=vn(),_=a(I);pt(_,()=>e(c),null,(p,K)=>{var Z=xe(),we=P(Z);{var j=ve=>{var Me=on(),ge=P(Me),ue=s(ge,2),se=s(ue,2);m(()=>{ge.disabled=e(K).length===0,ue.disabled=e(K).length===0}),J("click",ge,()=>g()({deckInfos:e(K),replaceAll:!1})),J("click",ue,()=>g()({deckInfos:e(K),replaceAll:!0})),J("click",se,n),r(ve,Me)},U=ve=>{var Me=xe(),ge=P(Me);{var ue=se=>{var Ee=ln();J("click",Ee,()=>g()(void 0)),r(se,Ee)};C(ge,se=>{l().cancelable&&se(ue)},!0)}r(ve,Me)};C(we,ve=>{e(K).length?ve(j):ve(U,!1)})}r(p,Z)}),r(q,I)}}}),_t()}const ma=class ma extends yr{constructor(i,t){super(i,...Object.values(t))}};it(ma,"createModalController",i=>{const t={deckUploader:new hr({title:"デッキ情報をアップロード",position:"Middle",cancelable:!1})};return Object.assign(new ma(i,t),t)});let Ca=ma;function cn(f,i){dt(i,!1);let t=je(i,"modalController",8);ct(),gr(f,{get modalController(){return t()},children:(l,g)=>{var c=xe(),u=P(c);{var v=A=>{dn(A,{get eventHolder(){return t().eventHolder},get args(){return t().deckUploader.args},get resolve(){return t().deckUploader.resolve}})};C(u,A=>{t().deckUploader.state==="Shown"&&A(v)})}r(l,c)},$$slots:{default:!0}}),_t()}var _n=o("<button> </button>"),un=o('<label class="svelte-4vrmcs"><input type="checkbox" class="search_condition svelte-4vrmcs"> </label>'),fn=o('<label class="svelte-4vrmcs"><input type="checkbox" class="search_condition svelte-4vrmcs"> </label>'),pn=o('<div class="deck_editor_search_box_row monster_ex_categories svelte-4vrmcs"><div class="svelte-4vrmcs"><button class="search_condition_title black_button svelte-4vrmcs">エクストラ</button></div> <div class="svelte-4vrmcs"></div></div>'),mn=o('<label class="svelte-4vrmcs"><input type="checkbox" class="search_condition svelte-4vrmcs"> </label>'),gn=o('<label class="svelte-4vrmcs"><input type="checkbox" class="search_condition svelte-4vrmcs"> <div style="display: inline-block;"></div> </label>'),yn=o('<label class="svelte-4vrmcs"><input type="checkbox" class="search_condition svelte-4vrmcs"> </label>'),hn=o('<div class="deck_editor_search_box_row monster_categories svelte-4vrmcs"><div class="svelte-4vrmcs"><button class="search_condition_title black_button svelte-4vrmcs">モンスター</button></div> <div class="svelte-4vrmcs"></div></div> <div class="deck_editor_search_box_row monster_attributes svelte-4vrmcs"><div class="svelte-4vrmcs"><button class="search_condition_title black_button svelte-4vrmcs">属性</button></div> <div class="svelte-4vrmcs"></div></div> <div class="deck_editor_search_box_row svelte-4vrmcs"><div class="svelte-4vrmcs"><button class="search_condition_title black_button svelte-4vrmcs">種族</button></div> <div class="svelte-4vrmcs"></div></div> <div class="deck_editor_search_box_row svelte-4vrmcs"><div class="svelte-4vrmcs"><button class="search_condition_title black_button svelte-4vrmcs">星攻守</button></div> <div class="svelte-4vrmcs"><div class="star_range svelte-4vrmcs"><span class="svelte-4vrmcs">星</span> <input type="number" min="0" max="13" class="svelte-4vrmcs"> <span class="svelte-4vrmcs">～</span> <input type="number" min="0" max="13" class="svelte-4vrmcs"></div> <div class="atk_range svelte-4vrmcs"><span class="svelte-4vrmcs">攻</span> <input type="number" min="0" max="5000" step="100" class="svelte-4vrmcs"> <span class="svelte-4vrmcs">～</span> <input type="number" min="0" max="5000" step="100" class="svelte-4vrmcs"></div> <div class="def_range svelte-4vrmcs"><span class="svelte-4vrmcs">守</span> <input type="number" min="0" max="5000" step="100" class="svelte-4vrmcs"> <span class="svelte-4vrmcs">～</span> <input type="number" min="0" max="5000" step="100" class="svelte-4vrmcs"></div> <div class="atk_plus_def svelte-4vrmcs"><span class="svelte-4vrmcs">攻+守</span> <input type="number" min="0" max="10000" step="100" class="svelte-4vrmcs"></div></div></div>',1),bn=o('<label class="svelte-4vrmcs"><input type="checkbox" class="search_condition svelte-4vrmcs"> </label>'),kn=o('<div class="deck_editor_search_box_row svelte-4vrmcs"><div class="svelte-4vrmcs"><button class="search_condition_title black_button svelte-4vrmcs">魔法</button></div> <div class="svelte-4vrmcs"></div></div>'),xn=o('<label class="svelte-4vrmcs"><input type="checkbox" class="search_condition svelte-4vrmcs"> </label>'),wn=o('<div class="deck_editor_search_box_row svelte-4vrmcs"><div class="svelte-4vrmcs"><button class="search_condition_title black_button svelte-4vrmcs">罠</button></div> <div class="svelte-4vrmcs"></div></div>'),Cn=o('<label class="svelte-4vrmcs"><input type="checkbox" class="search_condition svelte-4vrmcs"> </label>'),Dn=o('<div class="deck_editor_card_detail svelte-4vrmcs"><!></div>'),$n=o("<div>カード情報読込中</div>"),Sn=o("<option> </option>"),Mn=o('<div class="svelte-4vrmcs"><a class="white_button svelte-4vrmcs" download="SVS_DeckInfos.json">ダウンロード</a></div>'),Tn=o('<div class="svelte-4vrmcs"></div>'),En=o('<div class="svelte-4vrmcs"><a class="white_button svelte-4vrmcs" download="SVS_DeckInfos.json">ダウンロード(一括)</a></div>'),jn=o('<div class="svelte-4vrmcs"></div>'),Bn=o('<div class="deck_editor_body_right_header svelte-4vrmcs"><div class="deck_editor_body_right_header_row svelte-4vrmcs"><div class="svelte-4vrmcs">編集対象</div> <div class="svelte-4vrmcs"><select style="width:100%" class="svelte-4vrmcs"></select></div></div> <div class="deck_editor_body_right_header_row svelte-4vrmcs"><div class="svelte-4vrmcs">新規名称</div> <div class="svelte-4vrmcs"><input type="text" style="width:100%" class="svelte-4vrmcs"></div></div> <div class="deck_editor_body_right_header_row svelte-4vrmcs"></div> <div class="deck_editor_body_right_header_row svelte-4vrmcs"><div class="svelte-4vrmcs">基本操作</div> <div class="svelte-4vrmcs"><button class="white_button svelte-4vrmcs">デッキを保存</button></div> <div class="svelte-4vrmcs"><button class="white_button svelte-4vrmcs">デッキを複製</button></div> <div class="svelte-4vrmcs"><button class="white_button svelte-4vrmcs" title="shiftキー押下で確認メッセージスキップ">デッキを削除</button></div></div> <div class="deck_editor_body_right_header_row svelte-4vrmcs"><div class="svelte-4vrmcs">DL/UL</div> <!> <!> <div class="svelte-4vrmcs"><button class="white_button svelte-4vrmcs">アップロード</button></div></div></div> <div><!></div>',1),An=o("<div>デッキ情報読込中</div>"),Ln=o('<div class="deck_editor_body_right_dummy svelte-4vrmcs"></div>'),qn=o("<div><!></div>"),Yn=o('<div><div class="deck_editor_header svelte-4vrmcs"></div> <div class="deck_editor_body svelte-4vrmcs"><div class="deck_editor_body_left svelte-4vrmcs"><div role="contentinfo" class="deck_editor_search_box svelte-4vrmcs"><div class="deck_editor_search_box_header svelte-4vrmcs"><div class="svelte-4vrmcs"><button class="deck_editor_search_box_title svelte-4vrmcs">検索条件</button></div> <div class="deck_editor_sort_setting_container svelte-4vrmcs"></div></div> <div class="deck_editor_search_box_body svelte-4vrmcs"><div class="deck_editor_search_box_row svelte-4vrmcs"><div class="svelte-4vrmcs"><button class="search_condition_title black_button svelte-4vrmcs">名称</button></div> <div class="svelte-4vrmcs"><input type="text" style="width:100%" placeholder="※ルビには対応していません" class="svelte-4vrmcs"></div></div> <div class="deck_editor_search_box_row card_kind svelte-4vrmcs"><div class="svelte-4vrmcs"><button class="search_condition_title black_button svelte-4vrmcs">種類</button></div> <div class="svelte-4vrmcs"></div></div> <!> <!> <!> <!> <div class="deck_editor_search_box_row svelte-4vrmcs"><div class="svelte-4vrmcs"><button class="search_condition_title black_button svelte-4vrmcs">その他</button></div> <div class="svelte-4vrmcs"></div></div></div></div> <!></div> <div class="deck_editor_body_center svelte-4vrmcs"><div class="deck_editor_body_center_body svelte-4vrmcs"><!></div></div>  <div class="deck_editor_body_right svelte-4vrmcs"><!></div></div> <div class="footer svelte-4vrmcs"></div></div> <!> <!>',1);function Un(f,i){dt(i,!1);const t=[],l=[],g=[],c=[],u=[],v=[],A=[],B=[],M=Ca.createModalController({onDragStart:{append:()=>{},remove:()=>{}},onDragEnd:{append:()=>{},remove:()=>{}}}),S={name:"",deckCardKinds:[...ta],exMonsterCategories:[...aa],monsterCategories:Ua.filter(h=>!aa.includes(h)),monsterAttributes:[...Ya],monsterTypes:[...qa],spellCategories:La.filter(h=>h!=="PendulumScale"),trapCategories:[...Aa],starLowerBound:0,starUpperBound:13,atkLowerBound:0,atkUpperBound:5e3,defLowerBound:0,defUpperBound:5e3,atkPlusDef:void 0,others:["test","oldVersion","implemented"],sort:[...Ha]},n=ne(structuredClone(S));he(n,e(n).others=["oldVersion"]),he(n,e(n).monsterCategories=["Effect","Tuner","Pendulum"]);let q=ne("DeckEdit"),R=ne("SearchCondition");const I=()=>{if(!e(n).deckCardKinds.length){Wt(e(n)).forEach(h=>{Array.isArray(e(n)[h])&&Array.isArray(S[h])?he(n,e(n)[h]=[...S[h]]):he(n,e(n)[h]=S[h])});return}he(n,e(n).name=""),he(n,e(n).deckCardKinds=[]),he(n,e(n).exMonsterCategories=[]),he(n,e(n).monsterCategories=[]),he(n,e(n).monsterAttributes=[]),he(n,e(n).monsterTypes=[]),he(n,e(n).spellCategories=[]),he(n,e(n).trapCategories=[]),he(n,e(n).others=[]),he(n,e(n).atkLowerBound=0),he(n,e(n).atkUpperBound=5e3),he(n,e(n).defLowerBound=0),he(n,e(n).defUpperBound=5e3),he(n,e(n).atkPlusDef=void 0),he(n,e(n).sort=[...Ha])},_=h=>{h.forEach(k=>{Array.isArray(e(n)[k])&&Array.isArray(S[k])?he(n,e(n)[k]=e(n)[k].length?[]:[...S[k]]):he(n,e(n)[k]=S[k])})};let p=ne(),K,Z=ne(!1);const we=200,j=()=>{$(Z,!1),$(p,void 0),K=void 0},U=(h,k)=>{const O=fa(k),Q=e(ae).cardTree[O].filter(Ue=>Ue.name===k.name).length;let me=h.shiftKey?3-Q:1;console.debug(k,O,Q,me),!h.ctrlKey&&Q>2&&(me=0),me&&he(ae,e(ae).cardTree[O]=[...e(ae).cardTree[O],...Array(me).fill(k)].sort(Ga)),j(),x(k)},ve=(h,k)=>{const O=fa(k);let Q=0;he(ae,e(ae).cardTree[O]=e(ae).cardTree[O].filter(me=>me.name!==k.name?!0:(Q++,!h.shiftKey&&Q>1))),j(),x(k)},Me=h=>{if(h.changedTouches&&h.changedTouches.length!==1)return;const{clientX:k,clientY:O}=h.changedTouches?h.changedTouches[0]:h;return{clientX:k,clientY:O}},ge={onCardAppend:U,onCardRemove:ve,onCardDragCancel:j,onCardDragStart:(h,k,O)=>{if(x(O),k!=="List"&&k!=="Deck"){j();return}if(k==="List"&&!O.isImplemented){j();return}const Q=Me(h);if(!Q){j();return}K={from:k,cardInfo:O,pos:Q,startPos:Q},ea(we).then(()=>{(K==null?void 0:K.cardInfo)===O&&$(p,K)}),$(Z,!1)},onCardDragging:(h,k)=>{if(e(p)&&h.preventDefault&&h.preventDefault(),e(p)&&h.stopPropagation&&h.stopPropagation(),!K){j();return}const O=Me(h);if(!O){j();return}const Q=e(p)||K;$(Z,!!(Q.from==="List"&&Q.cardInfo.isImplemented&&document.elementsFromPoint(O.clientX,O.clientY).some(me=>me.classList.contains("deck_editor_body_right_body")||me.classList.contains("deck_editor_body_right_dummy")))),e(Z)&&$(q,"DeckEdit"),e(p)?$(p,{...e(p),pos:O}):K.pos={...O}},onCardDragEnd:h=>{if(!K||!e(p)){j();return}const k=Me(h);if(!k){j();return}e(p).from==="List"&&e(p).cardInfo.isImplemented&&document.elementsFromPoint(k.clientX,k.clientY).some(O=>O.classList.contains("deck_editor_body_right_body"))&&U(h,e(p).cardInfo),e(p).from==="Deck"&&!document.elementsFromPoint(k.clientX,k.clientY).some(O=>O.classList.contains("deck_editor_body_right_body"))&&ve(h,e(p).cardInfo),j()}},ue=(h,k,O)=>{Array.isArray(e(n)[k])&&Array.isArray(S[k])&&he(n,e(n)[k]=[O])},se=async()=>{const k=(await e(Y)).find(Q=>Q.id===e(ye));if(!k)return;const O=await la;$(ae,{...k,cardTree:kr(k.cardNames.map(Q=>{const me=O.getCardInfo(Q);return me===void 0&&console.error(Q),me}).filter(Q=>Q!==void 0))})},Ee=()=>Dt.getAllDeckInfo().then(h=>($(ye,(h.find(k=>k.lastUsedAt.getTime()===Math.max(...h.map(O=>O.lastUsedAt.getTime())))??h[0]).id),h));let ye=ne(-1),Y=ne(Ee()),N=ne(e(Y).then(h=>Dt.convertToObjectURL(h)));e(Y).then(se);const fe=()=>{$(Y,Ee()),$(N,e(Y).then(h=>Dt.convertToObjectURL(h))),se()};let ae=ne({id:-Number.MAX_VALUE,name:"",description:"",lastUsedAt:new Date,cardTree:{ExtraMonster:[],Monster:[],Spell:[],Trap:[]}}),Te=ne(void 0),E=0;const x=h=>{$(R,"CardDetail"),h.cardId!==void 0&&!h.description&&!h.pendulumDescription&&(E=h.cardId,ka([h.cardId]).then(()=>{h.cardId===E&&$(Te,h)})),$(Te,h)},L=async()=>{const k=(await e(Y)).find(O=>O.id===e(ye));if(!k)throw new Error("illegal state");return k},W=async()=>{const h=await L();await h.saveDeckInfo({...h,name:e(ae).name,cardNames:Object.values(e(ae).cardTree).flatMap(k=>k).map(k=>k.name),lastUsedAt:new Date}),fe()},ee=async()=>{(await Dt.createNewDeck(`デッキ_${new Date().formatToYYYYMMDD_HHMMSS("","","")}`,`コピー日時：${new Date().formatToYYYYMMDD_HHMMSS("-"," ",":")}`,Object.values(e(ae).cardTree).flatMap(k=>k).map(k=>k.name))).saveDeckInfo(),fe()},w=async h=>{const k=await L();!h.shiftKey&&!confirm(`デッキ【${k.name}】を削除します。
よろしいですか？`)||(await k.delete(),fe())},F=async()=>{const h=await M.deckUploader.show({title:"デッキ情報アップロード",position:"Middle",cancelable:!0});if(!h)return;const k=[];if(h.replaceAll){if(!confirm(`既存デッキ情報を全て削除し、アップロードしたファイルに置き換えます。
よろしいですか？`))return;k.push(...(await e(Y)).map(O=>O.id))}await Promise.all(h.deckInfos.map(O=>Dt.createNewDeck(O.name,O.description,O.cardNames,O.lastUsedAt))),k.length&&await Promise.all(k.map(Dt.remove)),fe()},z=()=>innerWidth<=1400?"compact":"wide";ct();var G=Yn(),V=P(G),ce=s(a(V),2),T=a(ce),D=a(T),d=a(D),y=a(d),H=a(y),X=s(y,2);de(X,5,()=>e(n).sort,_e,(h,k,O)=>{var Q=_n(),me=a(Q);m(()=>{Be(Q,`deck_editor_sort_setting_item ${e(k).order??""} priority_${e(k).priority??""} svelte-4vrmcs`),b(me,`${br[e(k).key]??""}
                ${(e(k).order==="asc"?"▲":"▼")??""}`)}),J("click",Q,()=>{e(n).sort.forEach(Ue=>Ue.priority++),e(k).order=e(k).order==="asc"?"desc":"asc",Ft(()=>e(n).sort),e(k).priority=1,Ft(()=>e(n).sort)}),r(h,Q)});var Ce=s(d,2),De=a(Ce),pe=a(De),ie=a(pe),re=s(pe,2),te=a(re),$e=s(De,2),Fe=a($e),Ne=a(Fe),Ie=s(Fe,2);de(Ie,5,()=>ta,_e,(h,k)=>{var O=un(),Q=a(O),me,Ue=s(Q);m(()=>{me!==(me=e(k))&&(Q.value=(Q.__value=e(k))==null?"":e(k)),b(Ue,` ${Xa[e(k)]??""}`)}),Nt(t,[],Q,()=>(e(k),e(n).deckCardKinds),Se=>he(n,e(n).deckCardKinds=Se)),r(h,O)});var qe=s($e,2);{var Ve=h=>{var k=pn(),O=a(k),Q=a(O),me=s(O,2);de(me,5,()=>aa,_e,(Ue,Se)=>{var Ke=fn(),Re=a(Ke),We,Je=s(Re);m(()=>{We!==(We=e(Se))&&(Re.value=(Re.__value=e(Se))==null?"":e(Se)),b(Je,` ${va[e(Se)]??""}${_a[e(Se)]??""}`)}),Nt(l,[],Re,()=>(e(Se),e(n).exMonsterCategories),ut=>he(n,e(n).exMonsterCategories=ut)),r(Ue,Ke)}),J("click",Q,()=>_(["exMonsterCategories"])),oe(3,k,()=>ke,()=>({delay:0,duration:100})),r(h,k)};C(qe,h=>{e(n).deckCardKinds.includes("ExtraMonster")&&h(Ve)})}var nt=s(qe,2);{var Le=h=>{var k=hn(),O=P(k),Q=a(O),me=a(Q),Ue=s(Q,2);de(Ue,5,()=>Ua.filter(He=>!aa.includes(He)),_e,(He,Pe)=>{var st=mn(),Ze=a(st),Ct,Pt=s(Ze);m(()=>{Ct!==(Ct=e(Pe))&&(Ze.value=(Ze.__value=e(Pe))==null?"":e(Pe)),b(Pt,` ${va[e(Pe)]??""}${_a[e(Pe)]??""}`)}),Nt(g,[],Ze,()=>(e(Pe),e(n).monsterCategories),Ot=>he(n,e(n).monsterCategories=Ot)),r(He,st)});var Se=s(O,2),Ke=a(Se),Re=a(Ke),We=s(Ke,2);de(We,5,()=>Ya,_e,(He,Pe)=>{var st=gn(),Ze=a(st),Ct,Pt=s(Ze,2),Ot=s(Pt);m(()=>{Ct!==(Ct=e(Pe))&&(Ze.value=(Ze.__value=e(Pe))==null?"":e(Pe)),Be(Pt,`monster_attr ${e(Pe)??""} svelte-4vrmcs`),b(Ot,` ${$a[e(Pe)]??""}`)}),Nt(c,[],Ze,()=>(e(Pe),e(n).monsterAttributes),Ja=>he(n,e(n).monsterAttributes=Ja)),r(He,st)});var Je=s(Se,2),ut=a(Je),Ut=a(ut),Tt=s(ut,2);de(Tt,5,()=>qa,_e,(He,Pe)=>{var st=yn(),Ze=a(st),Ct,Pt=s(Ze);m(()=>{Ct!==(Ct=e(Pe))&&(Ze.value=(Ze.__value=e(Pe))==null?"":e(Pe)),b(Pt,` ${ga[e(Pe)]??""}
                    ${Sa[e(Pe)]??""}`)}),Nt(u,[],Ze,()=>(e(Pe),e(n).monsterTypes),Ot=>he(n,e(n).monsterTypes=Ot)),J("dblclick",st,Ot=>ue(Ot,"monsterTypes",e(Pe))),r(He,st)});var wt=s(Je,2),gt=a(wt),mt=a(gt),Ht=s(gt,2),Bt=a(Ht),It=s(a(Bt),2),Gt=s(It,4),ot=s(Bt,2),Xe=s(a(ot),2),lt=s(Xe,4),yt=s(ot,2),ht=s(a(yt),2),Qt=s(ht,4),Ge=s(yt,2),rt=s(a(Ge),2);J("click",me,()=>_(["monsterCategories"])),oe(3,O,()=>ke,()=>({delay:0,duration:100})),J("click",Re,()=>_(["monsterAttributes"])),oe(3,Se,()=>ke,()=>({delay:0,duration:100})),J("click",Ut,()=>_(["monsterTypes"])),oe(3,Je,()=>ke,()=>({delay:0,duration:100})),J("click",mt,()=>_(["starLowerBound","starUpperBound","atkLowerBound","atkUpperBound","defLowerBound","defUpperBound","atkPlusDef"])),Et(It,()=>e(n).starLowerBound,He=>he(n,e(n).starLowerBound=He)),Et(Gt,()=>e(n).starUpperBound,He=>he(n,e(n).starUpperBound=He)),Et(Xe,()=>e(n).atkLowerBound,He=>he(n,e(n).atkLowerBound=He)),Et(lt,()=>e(n).atkUpperBound,He=>he(n,e(n).atkUpperBound=He)),Et(ht,()=>e(n).defLowerBound,He=>he(n,e(n).defLowerBound=He)),Et(Qt,()=>e(n).defUpperBound,He=>he(n,e(n).defUpperBound=He)),Et(rt,()=>e(n).atkPlusDef,He=>he(n,e(n).atkPlusDef=He)),oe(3,wt,()=>ke,()=>({delay:0,duration:100})),r(h,k)};C(nt,h=>{(e(n).deckCardKinds.includes("Monster")||e(n).deckCardKinds.includes("ExtraMonster"))&&h(Le)})}var be=s(nt,2);{var Ae=h=>{var k=kn(),O=a(k),Q=a(O),me=s(O,2);de(me,5,()=>La.filter(Ue=>Ue!=="PendulumScale"),_e,(Ue,Se)=>{var Ke=bn(),Re=a(Ke),We,Je=s(Re);m(()=>{We!==(We=e(Se))&&(Re.value=(Re.__value=e(Se))==null?"":e(Se)),b(Je,` ${ya[e(Se)]??""}`)}),Nt(v,[],Re,()=>(e(Se),e(n).spellCategories),ut=>he(n,e(n).spellCategories=ut)),r(Ue,Ke)}),J("click",Q,()=>_(["spellCategories"])),oe(3,k,()=>ke,()=>({delay:0,duration:100})),r(h,k)};C(be,h=>{e(n).deckCardKinds.includes("Spell")&&h(Ae)})}var Ye=s(be,2);{var Oe=h=>{var k=wn(),O=a(k),Q=a(O),me=s(O,2);de(me,5,()=>Aa,_e,(Ue,Se)=>{var Ke=xn(),Re=a(Ke),We,Je=s(Re);m(()=>{We!==(We=e(Se))&&(Re.value=(Re.__value=e(Se))==null?"":e(Se)),b(Je,` ${ha[e(Se)]??""}`)}),Nt(A,[],Re,()=>(e(Se),e(n).trapCategories),ut=>he(n,e(n).trapCategories=ut)),r(Ue,Ke)}),J("click",Q,()=>_(["trapCategories"])),oe(3,k,()=>ke,()=>({delay:0,duration:100})),r(h,k)};C(Ye,h=>{e(n).deckCardKinds.includes("Trap")&&h(Oe)})}var at=s(Ye,2),ze=a(at),Qe=a(ze),$t=s(ze,2);de($t,4,()=>[{key:"test",text:"テスト用カード"},{key:"oldVersion",text:"エラッタ前カード"},{key:"implemented",text:"未実装カード"}],_e,(h,k)=>{var O=Cn(),Q=a(O),me,Ue=s(Q);m(()=>{me!==(me=k.key)&&(Q.value=(Q.__value=k.key)==null?"":k.key),b(Ue,` ${k.text??""}`)}),Nt(B,[],Q,()=>(k.key,e(n).others),Se=>he(n,e(n).others=Se)),r(h,O)});var vt=s(D,2);{var St=h=>{var k=Dn(),O=a(k);Zi(O,{get cardInfo(){return e(Te)},onAttention:x,cardControlEventHandlers:ge,get deckCardTree(){return e(ae).cardTree}}),r(h,k)};C(vt,h=>{e(R)==="CardDetail"&&e(Te)&&h(St)})}var jt=s(T,2),qt=a(jt),sa=a(qt);pt(sa,()=>la,h=>{var k=$n();r(h,k)},(h,k)=>{Ka(h,{mode:"List",get allCardTree(){return e(k).tree},onAttention:x,get searchCondition(){return e(n)},cardControlEventHandlers:ge,get deckCardTree(){return e(ae).cardTree},set deckCardTree(O){he(ae,e(ae).cardTree=O)},$$legacy:!0})});var Yt=s(jt,2),Xt=a(Yt);{var kt=h=>{var k=xe(),O=P(k);pt(O,()=>e(Y),Q=>{var me=An();r(Q,me)},(Q,me)=>{var Ue=Bn(),Se=P(Ue),Ke=a(Se),Re=s(a(Ke),2),We=a(Re);m(()=>{e(ye),Ft(()=>{e(me)})}),de(We,5,()=>e(me),_e,(Ge,rt)=>{var He=Sn(),Pe={},st=a(He);m(()=>{Pe!==(Pe=e(rt).id)&&(He.value=(He.__value=e(rt).id)==null?"":e(rt).id),b(st,e(rt).name)}),r(Ge,He)});var Je=s(Ke,2),ut=s(a(Je),2),Ut=a(ut),Tt=s(Je,4),wt=s(a(Tt),2),gt=a(wt),mt=s(wt,2),Ht=a(mt),Bt=s(mt,2),It=a(Bt),Gt=s(Tt,2),ot=s(a(Gt),2);pt(ot,L,Ge=>{var rt=Tn();r(Ge,rt)},(Ge,rt)=>{var He=Mn(),Pe=a(He);m(st=>tt(Pe,"href",st),[()=>Dt.convertToObjectURL([e(rt)])],le),r(Ge,He)});var Xe=s(ot,2);pt(Xe,()=>e(N),Ge=>{var rt=jn();r(Ge,rt)},(Ge,rt)=>{var He=En(),Pe=a(He);m(()=>tt(Pe,"href",e(rt))),r(Ge,He)});var lt=s(Xe,2),yt=a(lt),ht=s(Se,2),Qt=a(ht);Ka(Qt,{mode:"Deck",allCardTree:{ExtraMonster:[],Monster:[],Spell:[],Trap:[]},onAttention:x,cardControlEventHandlers:ge,get deckCardTree(){return e(ae).cardTree},set deckCardTree(Ge){he(ae,e(ae).cardTree=Ge)},$$legacy:!0}),m(()=>Be(ht,`deck_editor_body_right_body ${(e(Z)?"can_drop":"")??""} svelte-4vrmcs`)),Zt(We,()=>e(ye),Ge=>$(ye,Ge)),J("change",We,se),Et(Ut,()=>e(ae).name,Ge=>he(ae,e(ae).name=Ge)),J("click",gt,W),J("click",Ht,ee),J("click",It,w),J("click",yt,F),r(Q,Ue)}),r(h,k)},Mt=h=>{var k=Ln();r(h,k)};C(Xt,h=>{e(q)==="DeckEdit"||z()==="wide"?h(kt):h(Mt,!1)})}var xt=s(V,2);{var ia=h=>{var k=qn(),O=a(k);Qa(O,{mode:"Dragging",get cardInfo(){return e(p).cardInfo},onAttention:x,cardControlEventHandlers:ge}),m(()=>tt(k,"style",`position: fixed;
          top:${e(p).pos.clientY??""}px;
          left:${e(p).pos.clientX??""}px;
          z-index:3; 
          filter: opacity(0.8);
        	transform: translateX(-50%) translateY(-50%);`)),r(h,k)};C(xt,h=>{e(p)&&h(ia)})}var na=s(xt,2);cn(na,{modalController:M}),m((h,k,O)=>Be(V,`deck_editor
         screen_size_${h??""}
         left_pain_mode_${k??""}
         main_view_mode_${O??""}
         ${(e(p)?"dragging_card":"")??""}
          svelte-4vrmcs`),[z,()=>e(R).toLowerCase(),()=>e(q).toLowerCase()],le),J("click",H,I),J("click",ie,()=>_(["name"])),Et(te,()=>e(n).name,h=>he(n,e(n).name=h)),J("click",Ne,()=>_(["deckCardKinds"])),J("click",Qe,()=>_(["others"])),oe(3,at,()=>ke,()=>({delay:0,duration:100})),J("focusin",D,()=>{$(R,"SearchCondition"),$(q,"SearchCondition")}),J("click",D,()=>{$(R,"SearchCondition"),$(q,"SearchCondition")}),J("click",Yt,()=>{$(q,"DeckEdit")}),J("focusin",Yt,()=>{$(q,"DeckEdit")}),J("touchmove",V,h=>e(p)&&ge.onCardDragging(h,"Overlay")),J("mousemove",V,h=>e(p)&&ge.onCardDragging(h,"Overlay")),r(f,G),_t()}const Hn=["TblDeckHeader","TblDeckDetail","TblDuelistProfile"],Pn=3;var Nn=o('<input class="game_mode_radio svelte-sy4ydn" type="radio" name="game_mode"> <label> </label>',1),Fn=o('<option class="svelte-sy4ydn"> </option>'),In=o('<option class="svelte-sy4ydn"> </option>'),On=o('<option class="svelte-sy4ydn"> </option>'),Rn=o('<tr class="config_row svelte-sy4ydn"><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><label for="npc_deck_selector" class="config_row_label deck_selector svelte-sy4ydn">デッキ：</label></div></td><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><select id="npc_deck_selector" class="deck_selector svelte-sy4ydn"><option class="svelte-sy4ydn">デフォルト</option><!></select></div></td></tr>'),Kn=o('<option class="svelte-sy4ydn"> </option>'),Wn=o('<tr class="config_row svelte-sy4ydn"><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><label for="npc_selector" class="config_row_label npc_selector svelte-sy4ydn">対戦相手：</label></div></td><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><select id="npc_selector" class="npc_selector svelte-sy4ydn"></select> <div class="svelte-sy4ydn"> </div></div></td></tr> <!> <tr class="config_row svelte-sy4ydn"><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><label for="npc_selector" class="config_row_label npc_selector svelte-sy4ydn">先攻後攻：</label></div></td><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><select id="npc_selector" class="npc_selector svelte-sy4ydn"></select></div></td></tr>',1),zn=o('<option class="svelte-sy4ydn"> </option>'),Vn=o('<tr class="config_row svelte-sy4ydn"><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><label for="difficulty_selector" class="config_row_label difficulty_selector svelte-sy4ydn">難易度：</label></div></td><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><select id="difficulty_selector" class="difficulty_selector svelte-sy4ydn"></select></div></td></tr>'),Xn=o('<tr class="config_row svelte-sy4ydn"><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><label class="config_row_label svelte-sy4ydn" for="game_mode_radio_preset">ゲームモード：</label></div></td><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"></div></td></tr> <tr class="config_row svelte-sy4ydn"><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><label for="deck_selector" class="config_row_label deck_selector svelte-sy4ydn">デッキ：</label></div></td><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><select id="deck_selector" class="deck_selector svelte-sy4ydn"></select></div></td></tr> <!> <tr><td colspan="2" class="svelte-sy4ydn"><div><button class="btn svelte-sy4ydn">duel start!</button></div></td></tr>',1),Gn=o('<tr><td colspan="2" class="svelte-sy4ydn"><div>デッキ情報の読み込み、もしくは作成中...</div></td></tr>'),Qn=o('<tr><td colspan="2" class="svelte-sy4ydn"><div><button class="btn svelte-sy4ydn">deck edit</button></div></td></tr>'),Jn=o('<tr class="config_row svelte-sy4ydn"><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><label for="duelist_name" class="config_row_label duelist_name svelte-sy4ydn">名前：</label></div></td><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><input id="duelist_name" class="duelist_name svelte-sy4ydn" type="text"></div></td></tr> <!> <!>',1),Zn=o('<tr><td colspan="2" class="svelte-sy4ydn"><div>デュエリスト情報の読み込み、もしくは作成中...</div></td></tr>'),eo=o('<div class="app_body svelte-sy4ydn"><table class="config_table svelte-sy4ydn"><tbody><!></tbody></table></div>'),to=o('<span class="svelte-sy4ydn"> </span> <span class="svelte-sy4ydn"> </span>',1),ao=o('<div class="result_title result_win svelte-sy4ydn">YOU WIN</div>'),ro=o('<div class="result_title result_lose svelte-sy4ydn">YOU LOSE</div>'),so=o('<div class="result_title result_draw svelte-sy4ydn">DRAW</div>'),io=o('<div class="twitter_share_button_wrapper svelte-sy4ydn"><a rel="nofollow" target="_blank" class="twitter_share_button svelte-sy4ydn">X(twitter)でシェアする</a></div>'),no=o('<div class="result svelte-sy4ydn"><!> <div class="reason_of_end svelte-sy4ydn"> </div> <!> <div class="svelte-sy4ydn"><button class="white_button svelte-sy4ydn">TOPへ戻る</button></div></div>'),oo=o('<main style="flex-direction: column; display :flex" class="svelte-sy4ydn"><div class="link link_left svelte-sy4ydn"><a href="https://github.com/Setta238/stk_ygo_svelte" target="_blank" rel="noopener noreferrer" title="repository" class="svelte-sy4ydn">repository</a> <a href="https://x.com/ninja_no" target="_blank" rel="noopener noreferrer" title="repository" class="svelte-sy4ydn">X(Twitter)</a> <a href="https://posfie.com/@ninja_no/p/Lx7FLj3" target="_blank" rel="noopener noreferrer" title="posfie" class="svelte-sy4ydn">posfie(toggeter)</a></div> <div class="link link_right svelte-sy4ydn"><a class="a_button svelte-sy4ydn" role="button" tabindex="0">TOPへ戻る</a> <a href="/stk_ygo_svelte/note.html" target="_blank" rel="noopener noreferrer" title="repository" class="svelte-sy4ydn">現時点とこの先のこと</a></div> <!> <div class="footer card_summary svelte-sy4ydn"><!></div> <div class="footer debug_info svelte-sy4ydn"><span class="svelte-sy4ydn"> </span> <span class="user_agent_info svelte-sy4ydn"> </span> <span class="screen_info svelte-sy4ydn"> </span></div> <!></main>');function lo(f,i){dt(i,!1);const t=new xr("stk_ygo_svelte",Pn,Hn);let l=ne(0),g=ne(0),c=ne(),u=ne("FtkChallenge"),v=ne("None"),A=ne(0),B=ne(""),M=ne(void 0);const S="https://setta238.github.io/stk_ygo_svelte/",n="遊戯王deそりてあ",q="ninja_no",R=wr.getOrCreateNew(t).then(T=>($(u,Pa.includes(T.previousGameMode)?T.previousGameMode:"FtkChallenge"),Ee(T.previousNpcId),T)),I=T=>{var d;const D=T.find(y=>y.lastUsedAt.getTime()===Math.max(...T.map(H=>H.lastUsedAt.getTime())))??T[0];$(A,D.id),e(u)==="FtkChallenge"&&D.deckType!=="Preset"&&$(A,((d=Rt.find(y=>y.deckType==="Preset"))==null?void 0:d.id)??e(A))};let _=ne(Dt.getAllDeckInfo(t).then(T=>(Promise.all(T.filter(D=>!D.lastUsedAt).map(D=>{D.saveDeckInfo()})),I(T),T)));const p=async()=>{const T=e(A);let D=(await e(_)).find(y=>y.id===T)??(await Z()).find(y=>y.id===T);D&&await D.updateTimestamp();let d=D;if(d||(d=Rt.find(y=>y.id===T)),!d)throw new Error("illegal state");return d},K=async()=>{(await R).save({previousGameMode:e(u)})},Z=()=>($(_,Dt.getAllDeckInfo(t).then(T=>(I(T),T))),e(_)),we=async()=>{(await e(_)).length||(await Dt.prepareSampleDeck(),Z())},j=async()=>{await Promise.all([K(),we()]);const T=await p(),D=await R;let d=Jt.find(X=>X.id===Number.MIN_SAFE_INTEGER)??Jt[0],y=Rt.find(X=>X.id===Number.MIN_SAFE_INTEGER)??Rt[0],H="PlayFirst";e(u)==="FtkChallenge"?d=Jt.filter(X=>X.npcType==="FtkChallenge").find(X=>X.difficulty===D.previousDifficulty)??d:e(u)==="Free"&&(d=Jt.find(X=>X.id===D.previousNpcId)??d,y=Rt.slice(-1)[0],H=D.previousStartMode),d.npcType!=="FtkChallenge"&&D.previousNpcDeckId>-1?y=(await e(_)).find(X=>X.id===D.previousNpcDeckId)??y:y=Rt.find(X=>X.id===d.id)??y,$(c,new Sr(D,"Player",T,[],d,"NPC",y,[],H)),e(c).onDuelEnd.append(()=>($(c,e(c)),"RemoveMe"))},U=async()=>{await Promise.all([K(),we()]),$(v,"DeckEdit")},ve=async T=>{await K(),T.key==="Enter"&&!T.repeat&&(await R).save()},Me=()=>{$(_,Z()),$(c,void 0),$(v,"None")};let ge=Date.now();const ue=T=>{Date.now()-ge<200||(ge=Date.now(),$(u,T),Z())},se=T=>{Ee(Number(T.currentTarget.value))},Ee=T=>{var D;$(M,Jt.find(d=>d.id===T)),$(B,((D=e(M))==null?void 0:D.description)??"")};we(),ct();var ye=oo(),Y=s(a(ye),2),N=a(Y),fe=s(Y,2);{var ae=T=>{var D=xe(),d=P(D);pt(d,()=>R,null,(y,H)=>{Ci(y,{get duel(){return e(c)},get userProfile(){return e(H)}})}),r(T,D)},Te=T=>{var D=xe(),d=P(D);{var y=X=>{Un(X,{})},H=X=>{var Ce=eo(),De=a(Ce),pe=a(De),ie=a(pe);pt(ie,()=>R,re=>{var te=Zn();r(re,te)},(re,te)=>{var $e=Jn(),Fe=P($e),Ne=a(Fe),Ie=a(Ne),qe=s(Ne),Ve=a(qe),nt=a(Ve),Le=s(Fe,2);pt(Le,()=>e(_),Ye=>{var Oe=Gn();r(Ye,Oe)},(Ye,Oe)=>{var at=Xn(),ze=P(at),Qe=a(ze),$t=a(Qe),vt=s(Qe),St=a(vt);de(St,5,()=>Pa,_e,(Q,me)=>{var Ue=Nn(),Se=P(Ue),Ke=s(Se,2),Re=a(Ke);m(We=>{tt(Se,"id",`game_mode_radio_${We??""}`),Dr(Se,e(me)),$r(Se,e(u)===e(me)),Be(Ke,`game_mode_tab_label game_mode_tab_${We??""} svelte-sy4ydn`),tt(Ke,"for",`game_mode_radio_${We??""}`),b(Re,e(me))},[()=>e(me).toLowerCase()],le),J("change",Se,()=>ue(e(me))),r(Q,Ue)});var jt=s(ze,2),qt=a(jt),sa=a(qt),Yt=s(qt),Xt=a(Yt),kt=a(Xt);m(()=>{e(A),Ft(()=>{e(u),e(Oe)})}),de(kt,5,()=>e(u)==="FtkChallenge"?Rt.filter(Q=>Q.deckType==="Preset"):e(Oe),_e,(Q,me)=>{var Ue=Fn(),Se={},Ke=a(Ue);m(()=>{Se!==(Se=e(me).id)&&(Ue.value=(Ue.__value=e(me).id)==null?"":e(me).id),b(Ke,e(me).name)}),r(Q,Ue)});var Mt=s(jt,2);{var xt=Q=>{var me=Wn(),Ue=P(me),Se=a(Ue),Ke=a(Se),Re=s(Se),We=a(Re),Je=a(We);m(()=>{e(te),Ft(()=>{})}),de(Je,5,()=>Jt,_e,(ot,Xe)=>{var lt=In(),yt={},ht=a(lt);m(()=>{yt!==(yt=e(Xe).id)&&(lt.value=(lt.__value=e(Xe).id)==null?"":e(Xe).id),b(ht,e(Xe).name)}),r(ot,lt)});var ut=s(Je,2),Ut=a(ut),Tt=s(Ue,2);{var wt=ot=>{var Xe=Rn(),lt=a(Xe),yt=a(lt),ht=s(lt),Qt=a(ht),Ge=a(Qt);m(()=>{e(te),Ft(()=>{e(Oe)})});var rt=a(Ge);rt.value=(rt.__value=Number.MIN_SAFE_INTEGER)==null?"":Number.MIN_SAFE_INTEGER;var He=s(rt);de(He,1,()=>e(Oe),_e,(Pe,st)=>{var Ze=On(),Ct={},Pt=a(Ze);m(()=>{Ct!==(Ct=e(st).id)&&(Ze.value=(Ze.__value=e(st).id)==null?"":e(st).id),b(Pt,e(st).name)}),r(Pe,Ze)}),oe(3,yt,()=>ke,()=>({duration:200})),oe(3,lt,()=>ke,()=>({duration:200})),Zt(Ge,()=>e(te).previousNpcDeckId,Pe=>e(te).previousNpcDeckId=Pe),oe(3,Qt,()=>ke,()=>({duration:200})),oe(3,ht,()=>ke,()=>({duration:200})),oe(3,Xe,()=>ke,()=>({duration:200})),r(ot,Xe)};C(Tt,ot=>{var Xe;((Xe=e(M))==null?void 0:Xe.npcType)!=="FtkChallenge"&&ot(wt)})}var gt=s(Tt,2),mt=a(gt),Ht=a(mt),Bt=s(mt),It=a(Bt),Gt=a(It);m(()=>{e(te),Ft(()=>{})}),de(Gt,5,()=>Wt(Na),_e,(ot,Xe)=>{var lt=Kn(),yt={},ht=a(lt);m(()=>{yt!==(yt=e(Xe))&&(lt.value=(lt.__value=e(Xe))==null?"":e(Xe)),b(ht,Na[e(Xe)])}),r(ot,lt)}),m(()=>b(Ut,`※${e(B)??""}`)),oe(3,Ke,()=>ke,()=>({duration:200})),oe(3,Se,()=>ke,()=>({duration:200})),J("change",Je,se),Zt(Je,()=>e(te).previousNpcId,ot=>e(te).previousNpcId=ot),oe(3,We,()=>ke,()=>({duration:200})),oe(3,Re,()=>ke,()=>({duration:200})),oe(3,Ue,()=>ke,()=>({duration:200})),oe(3,Ht,()=>ke,()=>({duration:200})),oe(3,mt,()=>ke,()=>({duration:200})),Zt(Gt,()=>e(te).previousStartMode,ot=>e(te).previousStartMode=ot),oe(3,It,()=>ke,()=>({duration:200})),oe(3,Bt,()=>ke,()=>({duration:200})),oe(3,gt,()=>ke,()=>({duration:200})),r(Q,me)},ia=Q=>{var me=xe(),Ue=P(me);{var Se=Ke=>{var Re=Vn(),We=a(Re),Je=a(We),ut=s(We),Ut=a(ut),Tt=a(Ut);m(()=>{e(te),Ft(()=>{})}),de(Tt,5,()=>Mr,_e,(wt,gt)=>{var mt=zn(),Ht={},Bt=a(mt);m(()=>{Ht!==(Ht=e(gt))&&(mt.value=(mt.__value=e(gt))==null?"":e(gt)),b(Bt,e(gt))}),r(wt,mt)}),oe(3,Je,()=>ke,()=>({duration:200})),oe(3,We,()=>ke,()=>({duration:200})),Zt(Tt,()=>e(te).previousDifficulty,wt=>e(te).previousDifficulty=wt),oe(3,Ut,()=>ke,()=>({duration:200})),oe(3,ut,()=>ke,()=>({duration:200})),oe(3,Re,()=>ke,()=>({duration:200})),r(Ke,Re)};C(Ue,Ke=>{e(u)==="FtkChallenge"&&Ke(Se)},!0)}r(Q,me)};C(Mt,Q=>{e(u)==="Free"?Q(xt):Q(ia,!1)})}var na=s(Mt,2),h=a(na),k=a(h),O=a(k);oe(3,$t,()=>ke,()=>({duration:200})),oe(3,Qe,()=>ke,()=>({duration:200})),oe(3,St,()=>ke,()=>({duration:200})),oe(3,vt,()=>ke,()=>({duration:200})),oe(3,ze,()=>ke,()=>({duration:200})),oe(3,sa,()=>ke,()=>({duration:200})),oe(3,qt,()=>ke,()=>({duration:200})),Zt(kt,()=>e(A),Q=>$(A,Q)),oe(3,Xt,()=>ke,()=>({duration:200})),oe(3,Yt,()=>ke,()=>({duration:200})),oe(3,jt,()=>ke,()=>({duration:200})),J("click",O,j),oe(3,k,()=>ke,()=>({duration:200})),r(Ye,at)});var be=s(Le,2);{var Ae=Ye=>{var Oe=Qn(),at=a(Oe),ze=a(at),Qe=a(ze);J("click",Qe,U),oe(3,ze,()=>ke,()=>({duration:200})),oe(3,at,()=>ke,()=>({duration:200})),oe(3,Oe,()=>ke,()=>({duration:200})),r(Ye,Oe)};C(be,Ye=>{e(u)==="Free"&&Ye(Ae)})}oe(3,Ie,()=>ke,()=>({duration:200})),oe(3,Ne,()=>ke,()=>({duration:200})),Et(nt,()=>e(te).name,Ye=>e(te).name=Ye),J("keypress",nt,ve),oe(3,Ve,()=>ke,()=>({duration:200})),oe(3,qe,()=>ke,()=>({duration:200})),oe(3,Fe,()=>ke,()=>({duration:200})),r(re,$e)}),r(X,Ce)};C(d,X=>{e(v)==="DeckEdit"?X(y):X(H,!1)},!0)}r(T,D)};C(fe,T=>{e(c)?T(ae):T(Te,!1)})}var E=s(fe,2),x=a(E);pt(x,()=>la,T=>{var D=et("読み込み中");r(T,D)},(T,D)=>{var d=to(),y=P(d),H=a(y),X=s(y,2),Ce=a(X);m((De,pe,ie)=>{b(H,`公式DB上のカード${De??""}枚`),b(Ce,`実装済カード（効果あり）${pe??""}枚 （効果なし）${ie??""}枚`)},[()=>e(D).knmCount.toLocaleString(),()=>e(D).definitionCount.toLocaleString(),()=>e(D).nonDefinitionCount.toLocaleString()],le),r(T,d)});var L=s(E,2),W=a(L),ee=a(W),w=s(W,2),F=a(w),z=s(w,2),G=a(z),V=s(L,2);{var ce=T=>{var D=no(),d=a(D);{var y=te=>{var $e=xe(),Fe=P($e);{var Ne=qe=>{var Ve=ao();r(qe,Ve)},Ie=qe=>{var Ve=xe(),nt=P(Ve);{var Le=be=>{var Ae=ro();r(be,Ae)};C(nt,be=>{e(c).winner.seat==="Above"&&be(Le)},!0)}r(qe,Ve)};C(Fe,qe=>{e(c).winner.seat==="Below"?qe(Ne):qe(Ie,!1)})}r(te,$e)},H=te=>{var $e=so();r(te,$e)};C(d,te=>{e(c).winner?te(y):te(H,!1)})}var X=s(d,2),Ce=a(X),De=s(X,2);{var pe=te=>{var $e=io(),Fe=a($e);m(()=>tt(Fe,"href",`https://x.com/share?url=${S}&text=${e(c).twitterShareText??""}&hashtags=${n}&via=${q}`)),r(te,$e)};C(De,te=>{e(c).twitterShareText&&te(pe)})}var ie=s(De,2),re=a(ie);m(()=>b(Ce,e(c).reasonOfEnd)),J("click",re,Me),oe(3,D,()=>jr,()=>({delay:200,duration:200})),r(T,D)};C(V,T=>{e(c)&&e(c).isEnded&&T(ce)})}m(()=>{b(ee,"build at: 20260121_220607"),b(F,Cr.text),b(G,`w:${e(l)??""}px h:${e(g)??""}px`)}),ua("innerWidth",T=>$(l,T)),ua("innerHeight",T=>$(g,T)),J("click",N,Me),r(f,ye),_t()}Tr(lo,{target:document.getElementById("app")});
