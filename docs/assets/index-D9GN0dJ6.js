var Za=Object.defineProperty;var za=_=>{throw TypeError(_)};var er=(_,i,t)=>i in _?Za(_,i,{enumerable:!0,configurable:!0,writable:!0,value:t}):_[i]=t;var st=(_,i,t)=>er(_,typeof i!="symbol"?i+"":i,t),ja=(_,i,t)=>i.has(_)||za("Cannot "+t);var ft=(_,i,t)=>(ja(_,i,"read from private field"),t?t.call(_):i.get(_)),na=(_,i,t)=>i.has(_)?za("Cannot add the same private member more than once"):i instanceof WeakSet?i.add(_):i.set(_,t),ha=(_,i,t,v)=>(ja(_,i,"write to private field"),v?v.call(_,t):i.set(_,t),t);import{s as Ea,r as tr,a as C,b as ar,l as rr,g as e,d as Wa,p as ct,c as Ue,m as _e,i as _t,t as l,e as a,f as w,h as p,j as ve,k as ze,n as it,o as Z,q as r,u as ut,v as xe,D as sr,w as $e,x as N,y as s,z as ce,A as Rt,B as le,C as me,E as g,F as ir,G as Qe,H as Wt,I as nr,J as lr,K as Kt,L as ba,M as Ka,N as oa,O as ka,P as la,Q as pt,R as $a,S as ma,T as Sa,U as va,V as ca,W as Va,X as ya,Y as ga,Z as or,_ as vr,$ as dr,a0 as cr,a1 as _r,a2 as ur,a3 as fr,a4 as _a,a5 as Xa,a6 as pr,a7 as ea,a8 as xa,a9 as mr,aa as Ga,ab as ua,ac as Bt,ad as yr,ae as gr,af as ta,ag as hr,ah as Dt,ai as br,aj as kr,ak as xr,al as Ba,am as Aa,an as La,ao as Ya,ap as qa,aq as Ua,ar as wr,as as Ht,at as Nt,au as zt,av as Cr,aw as Zt,ax as Dr,ay as $r,az as Pa,aA as Jt,aB as Ot,aC as Sr,aD as Tr,aE as Na,aF as Mr,aG as zr,aH as jr}from"../chunk/entity_proc_20260120_185916.js";import"../chunk/json_20260120_185916.js";(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const m of document.querySelectorAll('link[rel="modulepreload"]'))v(m);new MutationObserver(m=>{for(const c of m)if(c.type==="childList")for(const u of c.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&v(u)}).observe(document,{childList:!0,subtree:!0});function t(m){const c={};return m.integrity&&(c.integrity=m.integrity),m.referrerPolicy&&(c.referrerPolicy=m.referrerPolicy),m.crossOrigin==="use-credentials"?c.credentials="include":m.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function v(m){if(m.ep)return;m.ep=!0;const c=t(m);fetch(m.href,c)}})();const Er=_=>_;function Ta(_){const i=_-1;return i*i*i+1}function Ha(_){const i=typeof _=="string"&&_.match(/^\s*(-?[\d.]+)([^\s]*)\s*$/);return i?[parseFloat(i[1]),i[2]||"px"]:[_,"px"]}function Br(_,{delay:i=0,duration:t=400,easing:v=Er}={}){const m=+getComputedStyle(_).opacity;return{delay:i,duration:t,easing:v,css:c=>`opacity: ${c*m}`}}function Ar(_,{delay:i=0,duration:t=400,easing:v=Ta,x:m=0,y:c=0,opacity:u=0}={}){const d=getComputedStyle(_),Y=+d.opacity,R=d.transform==="none"?"":d.transform,S=Y*(1-u),[D,n]=Ha(m),[A,Q]=Ha(c);return{delay:i,duration:t,easing:v,css:(G,U)=>`
			transform: ${R} translate(${(1-G)*D}${n}, ${(1-G)*A}${Q});
			opacity: ${Y-S*U}`}}function we(_,{delay:i=0,duration:t=400,easing:v=Ta,axis:m="y"}={}){const c=getComputedStyle(_),u=+c.opacity,d=m==="y"?"height":"width",Y=parseFloat(c[d]),R=m==="y"?["top","bottom"]:["left","right"],S=R.map(z=>`${z[0].toUpperCase()}${z.slice(1)}`),D=parseFloat(c[`padding${S[0]}`]),n=parseFloat(c[`padding${S[1]}`]),A=parseFloat(c[`margin${S[0]}`]),Q=parseFloat(c[`margin${S[1]}`]),G=parseFloat(c[`border${S[0]}Width`]),U=parseFloat(c[`border${S[1]}Width`]);return{delay:i,duration:t,easing:v,css:z=>`overflow: hidden;opacity: ${Math.min(z*20,1)*u};${d}: ${z*Y}px;padding-${R[0]}: ${z*D}px;padding-${R[1]}: ${z*n}px;margin-${R[0]}: ${z*A}px;margin-${R[1]}: ${z*Q}px;border-${R[0]}-width: ${z*G}px;border-${R[1]}-width: ${z*U}px;min-${d}: 0`}}function Fa(_,i){for(const t in i)_[t]=i[t];return _}function Lr({fallback:_,...i}){const t=new Map,v=new Map;function m(u,d,Y){const{delay:R=0,duration:S=q=>Math.sqrt(q)*30,easing:D=Ta}=Fa(Fa({},i),Y),n=u.getBoundingClientRect(),A=d.getBoundingClientRect(),Q=n.left-A.left,G=n.top-A.top,U=n.width/A.width,z=n.height/A.height,ee=Math.sqrt(Q*Q+G*G),ue=getComputedStyle(d),E=ue.transform==="none"?"":ue.transform,b=+ue.opacity;return{delay:R,duration:typeof S=="function"?S(ee):S,easing:D,css:(q,ne)=>`
			   opacity: ${q*b};
			   transform-origin: top left;
			   transform: ${E} translate(${ne*Q}px,${ne*G}px) scale(${q+(1-q)*U}, ${q+(1-q)*z});
		   `}}function c(u,d,Y){return(R,S)=>(u.set(S.key,R),()=>{if(d.has(S.key)){const D=d.get(S.key);return d.delete(S.key),m(D,R,S)}return u.delete(S.key),_&&_(R,S,Y)})}return[c(v,t,!1),c(t,v,!0)]}function Ia(_){return Object.prototype.toString.call(_)==="[object Date]"}function Yr(_){return _}function wa(_){const i=_-1;return i*i*i+1}function Ca(_,i){if(_===i||_!==_)return()=>_;const t=typeof _;if(t!==typeof i||Array.isArray(_)!==Array.isArray(i))throw new Error("Cannot interpolate values of different type");if(Array.isArray(_)){const v=i.map((m,c)=>Ca(_[c],m));return m=>v.map(c=>c(m))}if(t==="object"){if(!_||!i)throw new Error("Object cannot be null");if(Ia(_)&&Ia(i)){const c=_.getTime(),d=i.getTime()-c;return Y=>new Date(c+Y*d)}const v=Object.keys(i),m={};return v.forEach(c=>{m[c]=Ca(_[c],i[c])}),c=>{const u={};return v.forEach(d=>{u[d]=m[d](c)}),u}}if(t==="number"){const v=i-_;return m=>_+m*v}return()=>i}var At,aa,da,Vt;const Ma=class Ma{constructor(i,t={}){na(this,At,Ea(void 0));na(this,aa,Ea(void 0));na(this,da);na(this,Vt,null);ft(this,At).v=ft(this,aa).v=i,ha(this,da,t)}static of(i,t){const v=new Ma(i(),t);return tr(()=>{v.set(i())}),v}set(i,t){var D;C(ft(this,aa),i);let{delay:v=0,duration:m=400,easing:c=Yr,interpolate:u=Ca}={...ft(this,da),...t};if(m===0)return(D=ft(this,Vt))==null||D.abort(),C(ft(this,At),i),Promise.resolve();const d=ar.now()+v;let Y,R=!1,S=ft(this,Vt);return ha(this,Vt,rr(n=>{if(n<d)return!0;if(!R){R=!0;const Q=ft(this,At).v;Y=u(Q,i),typeof m=="function"&&(m=m(Q,i)),S==null||S.abort()}const A=n-d;return A>m?(C(ft(this,At),i),!1):(C(ft(this,At),Y(c(A/m))),!0)})),ft(this,Vt).promise}get current(){return e(ft(this,At))}get target(){return e(ft(this,aa))}set target(i){this.set(i)}};At=new WeakMap,aa=new WeakMap,da=new WeakMap,Vt=new WeakMap;let fa=Ma;var qr=l('<div class="phase_display svelte-1boxe40"><span class="svelte-1boxe40"> </span> </div>'),Ur=l('<div class="lifepoint_display svelte-1boxe40"><div class="svelte-1boxe40"> </div> <div class="svelte-1boxe40"> </div></div>'),Pr=(_,i,t)=>i(e(t)),Nr=l('<div class="svelte-1boxe40"><button class="phase_button svelte-1boxe40"> </button></div>'),Hr=l("<div><!></div>"),Fr=l('<div class="svelte-1boxe40"><!></div>'),Ir=l("<div><!></div>"),Or=l('<div class="config_button_wrapper svelte-1boxe40"><button id="config_button" class="svelte-1boxe40">⚙</button></div>'),Rr=l("<!> <!> <!> <!>",1),Wr=l('<div style="position: absolute;" class="card_animation_receiver svelte-1boxe40"><!></div>'),Kr=l('<div style="position: absolute; top:0rem" class="svelte-1boxe40">｛効果対象｝</div>'),Vr=l('<!> <div style="position: absolute; display:flex;justify-content: center;"><!></div>',1),Xr=l(" <!> 】",1),Gr=l('<div style="position: absolute; bottom:0rem" class="svelte-1boxe40"> <!></div>'),Qr=l("<!> <!>",1),Jr=l('<div class="badge svelte-1boxe40"> </div>'),Zr=l('<div class="card_animation_receiver svelte-1boxe40"><!></div>'),es=l("<!> <!> <!> <!>",1),ts=l('<td><div role="listitem"><!></div></td>');function as(_,i){ct(i,!1);let t=Ue(i,"view",12),v=Ue(i,"row",8),m=Ue(i,"column",8),c=Ue(i,"selectedEntities",28,()=>[]),u=Ue(i,"selectedCells",28,()=>[]),d=_e(t().getCell(v(),m())),Y=_e(new fa(e(d).field.duel.duelists.Above.lp,{duration:400,easing:wa})),R=_e(new fa(e(d).field.duel.duelists.Below.lp,{duration:400,easing:wa}));const S=()=>{C(d,t().getCell(v(),m())),xe(Y,e(Y).target=e(d).field.duel.duelists.Above.lp),xe(R,e(R).target=e(d).field.duel.duelists.Below.lp)};e(d).onUpdate.append(S),t().onDuelUpdate.append(S),t().modalController.onUpdate.append(S);let D,n=_e([]),A=()=>console.log("hoge"),Q,G=_e([]),U=_e(!1),z=_e(!1),ee=!1;const ue=k=>{var $,B;C(ie,[]),c().reset(),D=k.activator,A=k.resolve,C(n,k.dummyActionInfos),C(G,k.chainBlockInfos.flatMap(F=>F.selectedEntities).getDistinct()),Q=k.entitiesChoices,C(U,!1),C(z,(($=k.cellsChoices)==null?void 0:$.selectables.includes(e(d)))??!1),ee=e(z)&&((B=k.cellsChoices)==null?void 0:B.qty)===1,S()};t().onWaitStart.append(ue);const E=()=>{D=void 0,C(n,[]),A=()=>{console.log("hoge")},Q=void 0,C(G,[]),C(U,!1),C(z,!1),ee=!1};t().onWaitEnd.append(E);let b=_e(!1),q=[];const ne=k=>{q=k.filter($=>$.dests.includes(e(d))),C(b,q.length>0),S()},Ce=()=>{q=[],C(b,!1),S()};t().onDragStart.append(ne),t().onDragEnd.append(Ce);const[he,fe]=pi;let ie=_e([]);const je=k=>{if(D=void 0,e(d)===k.to||e(d).entities.includes(k.entity)){C(ie,[...e(ie),k]);const $=k.resolve;C(d,e(d)),setTimeout(()=>{C(ie,e(ie).filter(B=>B!==k)),k.count++,k.count>1&&$()},600)}};t().onAnimation.append(je);const De=k=>{A({phaseChange:k})},H=()=>e(d).isStackCell&&e(d).entities.flatMap(k=>k.actions).filter(k=>e(n).map($=>$.action.seq).some($=>$===k.seq)).length>0,W=k=>{var $;if((($=k.target)==null?void 0:$.id)==="config_button"){t(t().infoBoardState="Config",!0),t().requireUpdate();return}if(t(t().infoBoardState="Default",!0),ee)A({selectedCells:[e(d)]});else if(e(z))C(U,!e(U)),u(e(U)?[...u(),e(d)]:u().filter(B=>B!==e(d)));else if(e(d).isStackCell){t(t().infoBoardState="CellInfo",!0),t(t().infoBoardCell=e(d),!0),t().requireUpdate();const B=e(d).entities.flatMap(I=>I.actions).map(I=>I.seq),F=e(n).filter(I=>B.includes(I.action.seq));if(F.length){if(!D)return;t().modalController.actionSelector.show({title:"カードを選択。",position:"Bottom",activator:D,dummyActionInfos:F,cancelable:!0}).then(I=>{I&&A({actionInfo:I})});return}}t().requireUpdate(),console.info(e(d),Me(...e(d).visibleEntities))},pe=k=>{k.preventDefault(),k.dataTransfer&&(k.dataTransfer.dropEffect="move")},se=k=>{k.preventDefault(),console.info("drop",k,e(b),q),k.dataTransfer&&(k.dataTransfer.dropEffect="move");try{if(e(b)&&q){if(q.length===1){const $=q[0];A({actionInfo:{...$,dest:e(d)}})}else if(q.length>1){if(!D)throw new sr("想定されない状態");e(d).field.duel.view.modalController.terminateAll(),e(d).field.duel.view.modalController.actionSelector.show({title:"選択",position:"Bottom",activator:D,dummyActionInfos:q.map($=>({...$,dest:e(d)})),cancelable:!1}).then($=>{A({actionInfo:$})})}}}finally{t().removeDraggingActions()}},Me=(...k)=>{if(t().waitMode==="Animation")return"Disabled";if(Q&&Q.selectables.find(B=>k.find(F=>B===F)))return"Selectable";if(!e(n)||e(n).length===0||t().waitMode!=="Free"||Object.values(t().modalController.modals).some(B=>B.state==="Shown"))return"Disabled";const $=e(n).filter(B=>k.includes(B.action.entity));return $.length===0?"Disabled":e(d).isStackCell||$[0].action.entity!==k[0]?"Clickable":$.some(B=>B.dests.length)?"Draggable":"Clickable"};_t();var j=ts(),T=a(j);T.__click=W;var P=a(T);{var X=k=>{var $=$e(),B=N($);{var F=I=>{var de=$e(),M=N(de);{var x=f=>{var L=qr(),K=a(L),ge=a(K),be=s(K,1,!0);p((oe,ae)=>{g(ge,oe),g(be,ae)},[()=>String(e(d).field.duel.clock.turn).padStart(2,"0"),()=>e(d).field.duel.phase.toUpperCase()],ve),r(f,L)},o=f=>{var L=$e(),K=N(L);{var ge=oe=>{var ae=Ur(),V=a(ae),re=a(V),Se=s(V,2),He=a(Se);p((Ne,Fe)=>{g(re,Ne),g(He,Fe)},[()=>Math.floor(e(Y).current),()=>Math.floor(e(R).current)],ve),r(oe,ae)},be=oe=>{var ae=$e(),V=N(ae);{var re=Se=>{var He=$e(),Ne=N(He);{var Fe=Ae=>{var Ve=$e(),nt=N(Ve);{var Be=ke=>{var Ee=$e(),Le=N(Ee);ce(Le,1,()=>t().duel.nextPhaseList,me,(Ie,tt)=>{var Ke=Nr(),Je=a(Ke);Je.__click=[Pr,De,tt];var $t=a(Je);p(vt=>g($t,vt),[()=>e(tt).toUpperCase()],ve),r(Ie,Ke)}),r(ke,Ee)};w(nt,ke=>{t().duel.isEnded||ke(Be)})}r(Ae,Ve)};w(Ne,Ae=>{t().waitMode==="Free"&&Ae(Fe)})}r(Se,He)};w(V,Se=>{e(d).column===5&&Se(re)},!0)}r(oe,ae)};w(K,oe=>{e(d).column===3?oe(ge):oe(be,!1)},!0)}r(f,L)};w(M,f=>{e(d).column===1?f(x):f(o,!1)})}r(I,de)};w(B,I=>{e(d).row===3&&I(F)})}r(k,$)},te=k=>{var $=$e(),B=N($);{var F=de=>{var M=Rr();const x=ve(()=>e(ie).find(ae=>ae.to===e(d)));var o=N(M);{var f=ae=>{var V=Hr(),re=a(V);Rt(re,{get entity(){return e(x).entity},state:"Disabled",dummyActionInfos:[],cardActionResolve:void 0}),p(()=>ze(V,`card_animation_receiver ${e(d).cellType??""} svelte-1boxe40`)),le(1,V,()=>fe,()=>({key:e(x).entity.seq})),r(ae,V)};w(o,ae=>{e(x)&&e(x).index==="Top"&&ae(f)})}var L=s(o,2);ce(L,1,()=>e(d).visibleEntities,me,(ae,V)=>{var re=$e(),Se=N(re);{var He=Ne=>{var Fe=Fr(),Ae=a(Fe);const Ve=ve(()=>Me(e(V))),nt=ve(()=>e(n).filter(Be=>Be.action.entity===e(V)));Rt(Ae,{get entity(){return e(V)},get state(){return e(Ve)},get dummyActionInfos(){return e(nt)},cardActionResolve:void 0,get selectedList(){return c()},set selectedList(Be){c(Be)},$$legacy:!0}),le(2,Fe,()=>he,()=>({key:e(V).seq})),r(Ne,Fe)};w(Se,Ne=>{e(ie).every(Fe=>Fe.entity.seq!==e(V).seq)&&Ne(He)})}r(ae,re)});var K=s(L,2);{var ge=ae=>{var V=Ir(),re=a(V);Rt(re,{get entity(){return e(x).entity},state:"Disabled",dummyActionInfos:[],cardActionResolve:void 0}),p(()=>ze(V,`card_animation_receiver ${e(d).cellType??""} svelte-1boxe40`)),le(1,V,()=>fe,()=>({key:e(x).entity.seq})),r(ae,V)};w(K,ae=>{e(x)&&e(x).index!=="Top"&&ae(ge)})}var be=s(K,2);{var oe=ae=>{var V=Or();r(ae,V)};w(be,ae=>{e(d).owner.seat==="Below"&&ae(oe)})}r(de,M)},I=de=>{var M=es();const x=ve(()=>e(ie).find(V=>V.to===e(d)));var o=N(M);{var f=V=>{var re=Wr(),Se=a(re);Rt(Se,{get entity(){return e(x).entity},state:"Disabled",dummyActionInfos:[],cardActionResolve:void 0}),le(1,re,()=>fe,()=>({key:e(x).entity.seq})),r(V,re)};w(o,V=>{e(x)&&e(x).index!=="Top"&&V(f)})}var L=s(o,2);{var K=V=>{var re=Qr(),Se=N(re);ce(Se,1,()=>e(d).visibleEntities.map((Fe,Ae)=>({index:Ae,entity:Fe})).toReversed(),me,(Fe,Ae)=>{var Ve=$e(),nt=N(Ve);{var Be=ke=>{var Ee=Vr();const Le=ve(()=>!e(d).isStackCell&&e(Ae).index===0?Me(...e(d).visibleEntities):void 0);var Ie=N(Ee);{var tt=vt=>{var St=Kr();r(vt,St)};w(Ie,vt=>{e(G).includes(e(Ae).entity)&&vt(tt)})}var Ke=s(Ie,2),Je=a(Ke);const $t=ve(()=>e(Ae).index===0?e(n).filter(vt=>e(d).visibleEntities.includes(vt.action.entity)):void 0);Rt(Je,{get entity(){return e(Ae).entity},get state(){return e(Le)},get dummyActionInfos(){return e($t)},cardActionResolve:void 0,get selectedList(){return c()},set selectedList(vt){c(vt)},$$legacy:!0}),p(()=>ze(Ke,`duel_card_wrapper ${(e(Ae).entity.exist?"duel_card_wrapper_exists":"")??""} svelte-1boxe40`)),le(2,Ke,()=>he,()=>({key:e(Ae).entity.seq})),r(ke,Ee)};w(nt,ke=>{e(ie).every(Ee=>Ee.entity.seq!==e(Ae).entity.seq)&&ke(Be)})}r(Fe,Ve)});var He=s(Se,2);{var Ne=Fe=>{var Ae=Gr(),Ve=a(Ae),nt=s(Ve);ce(nt,1,()=>Wt(e(d).visibleEntities[0].status.maxCounterQty),me,(Be,ke)=>{var Ee=Xr(),Le=N(Ee),Ie=s(Le);{var tt=Ke=>{var Je=Qe();p(()=>g(Je,`/${e(d).visibleEntities[0].status.maxCounterQty[e(ke)]??""}`)),r(Ke,Je)};w(Ie,Ke=>{(e(d).visibleEntities[0].status.maxCounterQty[e(ke)]??9999)<100&&Ke(tt)})}p((Ke,Je)=>g(Le,`【
              ${Ke??""}${Je??""} `),[()=>ir(e(ke)),()=>e(d).visibleEntities[0].counterHolder.getQty(e(ke))],ve),r(Be,Ee)}),p(()=>g(Ve,`【${e(d).visibleEntities[0].battlePositionName??""}】 `)),r(Fe,Ae)};w(He,Fe=>{e(d).visibleEntities[0].battlePosition&&Fe(Ne)})}r(V,re)};w(L,V=>{e(d).visibleEntities.length>0&&V(K)})}var ge=s(L,2);{var be=V=>{var re=Jr(),Se=a(re);p(()=>g(Se,e(d).visibleEntities.length)),r(V,re)};w(ge,V=>{e(d).isStackCell&&V(be)})}var oe=s(ge,2);{var ae=V=>{var re=Zr(),Se=a(re);Rt(Se,{get entity(){return e(x).entity},state:"Disabled",dummyActionInfos:[],cardActionResolve:void 0}),le(1,re,()=>fe,()=>({key:e(x).entity.seq})),r(V,re)};w(oe,V=>{e(x)&&e(x).index==="Top"&&V(ae)})}r(de,M)};w(B,de=>{e(d).cellType==="Hand"?de(F):de(I,!1)},!0)}r(k,$)};w(P,k=>{e(d).isDisabledCell?k(X):k(te,!1)})}p(k=>{ze(j,`${`duel_field_cell duel_field_cell_${e(d).cellType} ${e(d).linkArrowSources.length===0?"":"duel_field_cell_linked"}`??""} svelte-1boxe40`),it(j,"colspan",e(d).cellType==="Hand"?7:1),ze(T,`${k??""} svelte-1boxe40`)},[()=>`duel_field_cell_inner_box ${e(d).cellType} ${e(b)?"can_accept_drop":""} ${H()?"can_action":""} ${e(U)?"is_selected":e(z)?"is_selectable":""} `],ve),Z("dragover",T,pe),Z("drop",T,se),r(_,j),ut()}Wa(["click"]);const rs=(_,i,t=void 0,v="!!!circular reference!!!")=>{let m=[];return JSON.stringify(_,(c,u)=>{if(typeof u=="object"){if(m.indexOf(u)>-1)return v;m.push(u)}let d=u;if(i&&(d=i(c,u)),typeof d=="function")return d.toString();if(d!==u&&typeof d=="object"){if(m.indexOf(d)>-1)return v;m.push(d)}return d},t)};var ss=l('<div class="title svelte-14z6bdh"> </div>'),is=l('<div class="title svelte-14z6bdh"> </div>'),ns=l('<div class="duel_log_chain_number svelte-14z6bdh"> </div>'),ls=l('<div><a class="white_button" download="error_info.json">エラー情報ダウンロード</a></div>'),os=l("<div><!> <!></div>"),vs=l('<div><div style="display: flex;    justify-content: space-between;"><div style=" white-space: nowrap;text-align: center;"> </div> <!></div> <!></div>'),ds=l("<div><!> <!></div>"),cs=l("<div><!> <!></div>"),_s=l('<div class="duel_log svelte-14z6bdh"><div class="duel_log_header svelte-14z6bdh"></div> <div class="duel_log_body svelte-14z6bdh"></div> <div class="duel_log_footer svelte-14z6bdh"></div></div>');function us(_,i){ct(i,!1);let t=_e(void 0),v=Ue(i,"log",8),m,c=_e([]);const u=()=>{const S=((m==null?void 0:m.seq)??-1)+1;v().records.slice(S).forEach(D=>{if(!m){C(c,[[[[D]]]]),m=D;return}if(!e(c)[D.clock.turn]){xe(c,e(c)[D.clock.turn]=[[[D]]]),m=D;return}if(!e(c)[D.clock.turn][D.clock.phaseSeq]){xe(c,e(c)[D.clock.turn][D.clock.phaseSeq]=[[D]]),m=D;return}if(m.clock.chainSeq===D.clock.chainSeq&&m.clock.chainBlockSeq===D.clock.chainBlockSeq&&m.duelist===D.duelist){e(c)[D.clock.turn][D.clock.phaseSeq].slice(-1)[0].push(D),m=D;return}e(c)[D.clock.turn][D.clock.phaseSeq].push([D]),m=D}),C(c,e(c)),nr().then(()=>e(t)&&e(t).scroll(0,e(t).clientHeight*990))};v().onUpdate.append(u),v().duel.view.onDuelUpdate.append(u),u(),_t();var d=$e(),Y=N(d);{var R=S=>{var D=_s(),n=s(a(D),2);ce(n,5,()=>e(c),me,(A,Q)=>{var G=cs(),U=a(G);{var z=ue=>{var E=ss(),b=a(E);p(()=>g(b,`ターン：${e(Q)[0][0][0].clock.turn??""}`)),r(ue,E)};w(U,ue=>{e(Q)[0][0][0].clock.turn>0&&ue(z)})}var ee=s(U,2);ce(ee,1,()=>e(Q),me,(ue,E)=>{var b=ds(),q=a(b);{var ne=he=>{var fe=is(),ie=a(fe);p(()=>g(ie,e(E)[0][0].clock.period.name)),r(he,fe)};w(q,he=>{e(E)[0][0].clock.turn>0&&he(ne)})}var Ce=s(q,2);ce(Ce,1,()=>e(E),me,(he,fe)=>{var ie=vs();const je=ve(()=>{var j;return((j=e(fe).find(T=>T.chainNumber!==void 0))==null?void 0:j.chainNumber)??0});var De=a(ie),H=a(De),W=a(H),pe=s(H,2);{var se=j=>{var T=ns(),P=a(T);p(()=>g(P,`チェーン：${e(je)??""}`)),r(j,T)};w(pe,j=>{e(je)&&j(se)})}var Me=s(De,2);ce(Me,1,()=>e(fe),me,(j,T)=>{var P=os(),X=a(P);{var te=F=>{var I=Qe();p(()=>g(I,e(T).text)),r(F,I)},k=F=>{var I=$e(),de=N(I);{var M=o=>{var f=Qe();p((L,K,ge)=>g(f,`移動：${L??""} ${K??""} ⇒ ${ge??""}`),[()=>{var L;return(L=e(T).mainEntity)==null?void 0:L.toString()},()=>{var L;return(L=e(T).from)==null?void 0:L.toString()},()=>{var L;return(L=e(T).to)==null?void 0:L.toString()}],ve),r(o,f)},x=o=>{var f=$e(),L=N(f);{var K=be=>{var oe=Qe();p((ae,V)=>g(oe,`生成：${ae??""} void ⇒ ${V??""}`),[()=>{var ae;return(ae=e(T).mainEntity)==null?void 0:ae.toString()},()=>{var ae;return(ae=e(T).to)==null?void 0:ae.toString()}],ve),r(be,oe)},ge=be=>{var oe=$e(),ae=N(oe);{var V=Se=>{var He=Qe();p((Ne,Fe)=>g(He,`消滅：${Ne??""} ${Fe??""} ⇒ void`),[()=>{var Ne;return(Ne=e(T).mainEntity)==null?void 0:Ne.toString()},()=>{var Ne;return(Ne=e(T).from)==null?void 0:Ne.toString()}],ve),r(Se,He)},re=Se=>{var He=Qe();p(()=>g(He,e(T).text)),r(Se,He)};w(ae,Se=>{e(T).type==="EntityDisappear"?Se(V):Se(re,!1)},!0)}r(be,oe)};w(L,be=>{e(T).type==="EntityAppear"?be(K):be(ge,!1)},!0)}r(o,f)};w(de,o=>{e(T).type==="EntityMove"?o(M):o(x,!1)},!0)}r(F,I)};w(X,F=>{e(T).type==="ChainBlockHeader"?F(te):F(k,!1)})}var $=s(X,2);{var B=F=>{var I=ls(),de=a(I);p(M=>it(de,"href",M),[()=>window.URL.createObjectURL(new Blob([rs(e(T).error,(M,x)=>["pool","bundles","duel"].includes(M)||typeof x=="function"?void 0:x,4)],{type:"text/plain"}))],ve),r(F,I)};w($,F=>{e(T).error&&F(B)})}p(F=>ze(P,`duel_log_record duel_log_record_${F??""} svelte-14z6bdh`),[()=>e(T).type.toSnakeCase()],ve),r(j,P)}),p(()=>{var j,T,P;ze(ie,`duel_log_block_duelist duel_log_block_duelist_${((j=e(fe)[0].duelist)==null?void 0:j.seat)??"system"} svelte-14z6bdh`),ze(H,`duelist ${((T=e(fe)[0].duelist)==null?void 0:T.seat)??""} svelte-14z6bdh`),g(W,((P=e(fe)[0].duelist)==null?void 0:P.profile.name)||"SYSTEM")}),r(he,ie)}),p(()=>ze(b,`duel_log_block_phase duel_log_block_phase_${e(E)[0][0].clock.period.key??""} svelte-14z6bdh`)),r(ue,b)}),p(()=>ze(G,`duel_log_block_turn duel_log_block_turn_${e(Q)[0][0][0].clock.turn??""} svelte-14z6bdh`)),r(A,G)}),lr(n,A=>C(t,A),()=>e(t)),r(S,D)};w(Y,S=>{(v().duel.view.infoBoardState==="Log"||v().duel.view.infoBoardState==="Default")&&S(R)})}r(_,d),ut()}var fs=l("<div><div> </div> <div> </div></div>");function Oa(_,i){ct(i,!1);let t=Ue(i,"duelist",12),v=_e(0),m=_e();const c=async()=>{const n=t().lp-e(v);if(!e(m)||Math.abs(n)<10){C(v,t().lp),e(m)&&(e(m)(),C(m,void 0));return}C(v,e(v)+Math.floor(Math.random()*n)),await Kt(100),c()},u=()=>{t(t()),!e(m)&&t().lp!==e(v)&&new Promise(n=>{C(m,n),Math.abs(t().lp-e(v)),c()})};t().duel.log.onUpdate.append(u),c(),_t();var d=fs(),Y=a(d),R=a(Y),S=s(Y,2),D=a(S);p(n=>{ze(d,`duelist duelist_${n??""} svelte-1sy3trd`),ze(Y,`duelist_name duelist_${n??""}_name svelte-1sy3trd`),g(R,t().profile.name),ze(S,`duelist_lp ${(e(m)?"vibration":"")??""} svelte-1sy3trd`),g(D,e(v))},[()=>t().seat.toLowerCase()],ve),r(_,d),ut()}const ps=(_,i,t)=>(i(i()!=="Detail"?"Detail":"Normal"),console.info(t()),!0),ms=(_,i,t)=>(i(i()!=="Debug"?"Debug":"Normal"),console.info(t()),!0);var ys=l('<div class="svelte-1uevs9j"> </div>'),gs=l('<div class="svelte-1uevs9j"> </div>'),hs=l('<div class="link_arrow_emoji svelte-1uevs9j"> </div>'),bs=l('<div class="duel_card_info_row svelte-1uevs9j" style=" justify-content: space-between;"><div class="svelte-1uevs9j"> </div> <div class="svelte-1uevs9j"> </div></div>'),ks=l('<div></div> <div class="svelte-1uevs9j"> </div>',1),xs=l("<div> </div>"),ws=l('<span class="svelte-1uevs9j">/</span> <div class="monster_defense svelte-1uevs9j"> </div>',1),Cs=l("<div> </div>"),Ds=l('<div class="duel_card_info_row svelte-1uevs9j"><!> <!> <div style="flex-grow: 1;" class="svelte-1uevs9j"></div> <div class="monster_attack svelte-1uevs9j"> </div> <!></div> <div class="duel_card_info_row svelte-1uevs9j"></div>',1),$s=l('<div class="duel_card_row svelte-1uevs9j"><div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"> </div></div>'),Ss=l('<div class="duel_card_row svelte-1uevs9j"><div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"> </div></div>'),Ts=l("<!> <!>",1),Ms=l('<pre class="description svelte-1uevs9j"> </pre>'),zs=l('<div class="duel_card_info_row svelte-1uevs9j" style="border-style: solid; border-width: 1px;"><!></div>'),js=l('<pre class="description svelte-1uevs9j"> </pre>'),Es=l('<!> <div class="duel_card_info_row svelte-1uevs9j"><!></div>',1),Bs=l('<div class="effect_counter_area_item svelte-1uevs9j"><span class="svelte-1uevs9j"> </span> <span class="svelte-1uevs9j"> </span> <span class="svelte-1uevs9j">/</span> <span class="svelte-1uevs9j"> </span></div>'),As=l('<div class="duel_card_info_row effect_counter_area svelte-1uevs9j"><div class="effect_counter_area_title svelte-1uevs9j">効果使用状況</div> <div class="effect_counter_area_body svelte-1uevs9j"></div></div>'),Ls=l("[ <!> ],",1),Ys=l('<div class="svelte-1uevs9j"> <!></div>'),qs=l('<div class="svelte-1uevs9j"> </div> <!> <div class="svelte-1uevs9j"></div>',1),Us=l('<div class="svelte-1uevs9j"> </div>'),Ps=l('<div class="svelte-1uevs9j"> </div>'),Ns=l('<div class="svelte-1uevs9j"> </div>'),Hs=l('<div class="svelte-1uevs9j"> </div>'),Fs=l('<div class="svelte-1uevs9j"> </div>'),Is=l('<div class="svelte-1uevs9j"> </div>'),Os=l('<div class="duel_card_info_row svelte-1uevs9j"><div class="svelte-1uevs9j"><!> <div class="svelte-1uevs9j"></div> <!> <div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"></div> <!> <div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"></div> <!> <div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"></div> <!> <div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"></div> <!> <div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"></div> <!> <div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"> </div> <div class="svelte-1uevs9j"> </div> <div class="svelte-1uevs9j"> </div> <div class="svelte-1uevs9j"></div></div></div>'),Rs=l('<div class="svelte-1uevs9j">※エラッタ前のカードです</div>'),Ws=l('<div class="svelte-1uevs9j">※テスト用カードです</div>'),Ks=l('<a target="_blank" rel="noopener noreferrer" title="コナミカードデータベース" class="svelte-1uevs9j"> </a>'),Vs=l('<a target="_blank" rel="noopener noreferrer" title="遊戯王カードWiki" class="svelte-1uevs9j">⇒遊戯王カードWiki</a>'),Xs=l('<div class="duel_card_info_links svelte-1uevs9j"><!> <!> <a target="_blank" rel="noopener noreferrer" title="google" class="svelte-1uevs9j">⇒google検索</a></div>'),Gs=l("<!> <!>",1),Qs=l('<div role="contentinfo"><div class="duel_card_info_header svelte-1uevs9j"><div class="duel_card_info_row svelte-1uevs9j"><div class="svelte-1uevs9j"> </div></div> <div class="duel_card_info_row svelte-1uevs9j" style="position:sticky; top:0;"><!> <div class="svelte-1uevs9j"> </div></div> <!></div> <div class="duel_card_info_body svelte-1uevs9j"><!></div> <div class="duel_card_info_footer svelte-1uevs9j"><!></div></div>');function Js(_,i){ct(i,!1);let t=Ue(i,"entity",8),v=Ue(i,"mode",12,"Normal"),m=_e(new Promise(()=>{}));const c=()=>{var S,D;let R=t()&&t().entityType==="Card"?t().origin.cardId:(D=(S=t())==null?void 0:S.parent)==null?void 0:D.origin.cardId;return R??!1?`https://www.db.yugioh-card.com/yugiohdb/card_search.action?ope=2&cid=${R}`:t()?`https://www.db.yugioh-card.com/yugiohdb/card_search.action?ope=1&sess=1&rp=10&mode=&sort=1&keyword=${t().origin.name}&stype=1&ctype=&othercon=2&starfr=&starto=&pscalefr=&pscaleto=&linkmarkerfr=&linkmarkerto=&link_m=2&atkfr=&atkto=&deffr=&defto=&releaseDStart=1&releaseMStart=1&releaseYStart=1999&releaseDEnd=&releaseMEnd=&releaseYEnd=`:""};ba(()=>(la(t()),ka),()=>{C(m,oa.then(async R=>{if(t().origin.description||t().origin.pendulumDescription||t().origin.wikiEncodedName)return t().origin;const S=R.getCardInfo(t().origin.name);if(S)return S.cardId!==void 0&&!S.description&&!S.pendulumDescription&&await ka([S.cardId]),S}))}),Ka(),_t();var u=$e(),d=N(u);{var Y=R=>{var S=Qs();S.__click=[ps,v,t],S.__contextmenu=[ms,v,t];var D=a(S),n=a(D),A=a(n),Q=a(A),G=s(n,2),U=a(G);{var z=H=>{var W=ys(),pe=a(W);p(se=>g(pe,se),[()=>"★".repeat(t().lvl)],ve),r(H,W)},ee=H=>{var W=$e(),pe=N(W);{var se=j=>{var T=gs(),P=a(T);p(X=>g(P,X),[()=>"☆".repeat(t().rank)],ve),r(j,T)},Me=j=>{var T=$e(),P=N(T);{var X=te=>{var k=hs(),$=a(k);p(B=>g($,B),[()=>t().origin.linkArrowKeys.map(B=>Va[B].emoji).join("")],ve),r(te,k)};w(P,te=>{t().origin.linkArrowKeys&&te(X)},!0)}r(j,T)};w(pe,j=>{t().rank&&t().rank>0?j(se):j(Me,!1)},!0)}r(H,W)};w(U,H=>{t().lvl&&t().lvl>0?H(z):H(ee,!1)})}var ue=s(U,2),E=a(ue),b=s(G,2);{var q=H=>{var W=Ts(),pe=N(W);{var se=P=>{var X=bs(),te=a(X),k=a(te),$=s(te,2),B=a($);p(()=>{g(k,`◀ ${t().psL??""}`),g(B,`${t().psR??""} ▶`)}),r(P,X)};w(pe,P=>{var X;(X=t().origin.monsterCategories)!=null&&X.includes("Pendulum")&&P(se)})}var Me=s(pe,2);{var j=P=>{var X=Ds(),te=N(X),k=a(te);ce(k,1,()=>t().attr,me,(x,o)=>{var f=ks(),L=N(f),K=s(L,2),ge=a(K);p(()=>{ze(L,`monster_attr ${e(o)??""} svelte-1uevs9j`),g(ge,`${$a[e(o)]??""}属性`)}),r(x,f)});var $=s(k,2);ce($,1,()=>t().types,me,(x,o)=>{var f=xs(),L=a(f);p(()=>{ze(f,`monster_cat ${e(o)??""} svelte-1uevs9j`),g(L,`${ma[e(o)]??""}${Sa[e(o)]??""}族`)}),r(x,f)});var B=s($,4),F=a(B),I=s(B,2);{var de=x=>{var o=ws(),f=s(N(o),2),L=a(f);p(()=>g(L,t().def??"?")),r(x,o)};w(I,x=>{var o;(o=t().status.monsterCategories)!=null&&o.includes("Link")||x(de)})}var M=s(te,2);ce(M,5,()=>t().status.monsterCategories??[],me,(x,o)=>{var f=Cs(),L=a(f);p(()=>{ze(f,`monster_cat ${e(o)??""} svelte-1uevs9j`),g(L,`${va[e(o)]??""}${ca[e(o)]??""}`)}),r(x,f)}),p(()=>g(F,t().atk??"?")),r(P,X)},T=P=>{var X=$e(),te=N(X);{var k=B=>{var F=$s(),I=s(a(F),2),de=a(I);p(()=>g(de,`${ya[t().status.spellCategory]??""}魔法`)),r(B,F)},$=B=>{var F=$e(),I=N(F);{var de=M=>{var x=Ss(),o=s(a(x),2),f=a(o);p(()=>g(f,`${ga[t().status.trapCategory]??""}罠`)),r(M,x)};w(I,M=>{t().kind==="Trap"&&t().status.trapCategory&&M(de)},!0)}r(B,F)};w(te,B=>{t().kind==="Spell"&&t().status.spellCategory?B(k):B($,!1)},!0)}r(P,X)};w(Me,P=>{t().kind==="Monster"?P(j):P(T,!1)})}r(H,W)};w(b,H=>{v()!=="Debug"&&H(q)})}var ne=s(D,2),Ce=a(ne);{var he=H=>{var W=Es(),pe=N(W);{var se=T=>{var P=zs(),X=a(P);pt(X,()=>e(m),te=>{var k=Qe('"読み込み中"');r(te,k)},(te,k)=>{var $=Ms(),B=a($);p(()=>{var F;return g(B,(F=e(k))==null?void 0:F.pendulumDescription)}),r(te,$)}),r(T,P)};w(pe,T=>{var P;(P=t().status.monsterCategories)!=null&&P.includes("Pendulum")&&T(se)})}var Me=s(pe,2),j=a(Me);pt(j,()=>e(m),T=>{var P=Qe('"読み込み中"');r(T,P)},(T,P)=>{var X=js(),te=a(X);p(()=>{var k;return g(te,(k=e(P))==null?void 0:k.description)}),r(T,X)}),r(H,W)},fe=H=>{var W=$e(),pe=N(W);{var se=j=>{var T=$e(),P=N(T);{var X=te=>{var k=As(),$=s(a(k),2);ce($,5,()=>t().actions,me,(B,F)=>{var I=$e();const de=ve(()=>e(F).actionCountUpperBound),M=ve(()=>e(F).actionCount);var x=N(I);{var o=f=>{var L=Bs(),K=a(L),ge=a(K),be=s(K,2),oe=a(be),ae=s(be,4),V=a(ae);p(()=>{g(ge,e(F).title),g(oe,e(M)),g(V,e(de))}),r(f,L)};w(x,f=>{e(de)!==void 0&&e(M)!==void 0&&f(o)})}r(B,I)}),r(te,k)};w(P,te=>{t().actions.some(k=>k.actionCountUpperBoundKey)&&te(X)})}r(j,T)},Me=j=>{var T=Os(),P=a(T),X=a(P);ce(X,0,()=>["info","status"],me,(Be,ke)=>{var Ee=qs(),Le=N(Ee),Ie=a(Le),tt=s(Le,2);ce(tt,1,()=>Object.entries(t()[ke]),me,(Je,$t)=>{let vt=()=>e($t)[0],St=()=>e($t)[1];var jt=Ys(),Lt=a(jt),ra=s(Lt);{var Yt=kt=>{var Tt=Ls(),xt=s(N(Tt));ce(xt,1,St,me,(sa,ia)=>{var y=Qe();p(h=>g(y,`${h??""},`),[()=>e(ia).toString()],ve),r(sa,y)}),r(kt,Tt)},Xt=kt=>{var Tt=Qe();p(xt=>g(Tt,`${xt??""},`),[()=>{var xt;return(xt=St())==null?void 0:xt.toString()}],ve),r(kt,Tt)};w(ra,kt=>{Array.isArray(St())?kt(Yt):kt(Xt,!1)})}p(()=>g(Lt,`"${vt()??""}" : `)),r(Je,jt)});var Ke=s(tt,2);Ke.textContent="},",p(()=>g(Ie,`"${ke??""}" :{`)),r(Be,Ee)});var te=s(X,2);te.textContent='"actions" :[';var k=s(te,2);ce(k,1,()=>t().actions,me,(Be,ke)=>{var Ee=Us(),Le=a(Ee);p(()=>g(Le,`"${e(ke).playType??""} ${e(ke).title??""}",`)),r(Be,Ee)});var $=s(k,2);$.textContent="],";var B=s($,2);B.textContent='"substituteEffects" :[';var F=s(B,2);ce(F,1,()=>t().substituteEffects,me,(Be,ke)=>{var Ee=Ps(),Le=a(Ee);p(()=>g(Le,`"${e(ke).title??""}",`)),r(Be,Ee)});var I=s(F,2);I.textContent="],";var de=s(I,2);de.textContent='"continuousEffects" :[';var M=s(de,2);ce(M,1,()=>t().continuousEffects,me,(Be,ke)=>{var Ee=Ns(),Le=a(Ee);p(()=>g(Le,`"${e(ke).isStarted??""}",`)),r(Be,Ee)});var x=s(M,2);x.textContent="],";var o=s(x,2);o.textContent='"procFilters" :[';var f=s(o,2);ce(f,1,()=>t().procFilterBundle.operators,me,(Be,ke)=>{var Ee=Hs(),Le=a(Ee);p(Ie=>g(Le,`"${Ie??""} ${e(ke).title??""} ${e(ke).isEffective??""} ",`),[()=>e(ke).isSpawnedBy.toString()],ve),r(Be,Ee)});var L=s(f,2);L.textContent="],";var K=s(L,2);K.textContent='"numericStateOperators" :[';var ge=s(K,2);ce(ge,1,()=>t().numericOprsBundle.operators,me,(Be,ke)=>{var Ee=Fs(),Le=a(Ee);p(Ie=>g(Le,`"${Ie??""} ${e(ke).title??""} ${e(ke).isEffective??""} ${e(ke).isContinuous??""} ${e(ke).targetState??""} ${e(ke).targetStateGen??""} ",`),[()=>e(ke).isSpawnedBy.toString()],ve),r(Be,Ee)});var be=s(ge,2);be.textContent="],";var oe=s(be,2);oe.textContent='"stateOperators" :[';var ae=s(oe,2);ce(ae,1,()=>t().statusOperatorBundle.operators,me,(Be,ke)=>{var Ee=Is(),Le=a(Ee);p(Ie=>g(Le,`"${Ie??""} ${e(ke).title??""} ${e(ke).isEffective??""} ",`),[()=>e(ke).isSpawnedBy.toString()],ve),r(Be,Ee)});var V=s(ae,2);V.textContent="],";var re=s(V,2);re.textContent='"lastMoveLogRecord" :{';var Se=s(re,2),He=a(Se),Ne=s(Se,2),Fe=a(Ne),Ae=s(Ne,2),Ve=a(Ae),nt=s(Ae,2);nt.textContent="},",p((Be,ke)=>{g(He,`"movedBy":"${Be??""}",`),g(Fe,`"movedAs":"${ke??""}",`),g(Ve,`"movedAt":"${t().moveLog.latestRecord.movedAt.totalProcSeq??""}",`)},[()=>{var Be;return(Be=t().moveLog.latestRecord.movedBy)==null?void 0:Be.toString()},()=>t().moveLog.latestRecord.movedAs.join(" ")],ve),r(j,T)};w(pe,j=>{v()==="Detail"?j(se):j(Me,!1)},!0)}r(H,W)};w(Ce,H=>{v()==="Normal"?H(he):H(fe,!1)})}var ie=s(ne,2),je=a(ie);{var De=H=>{var W=Gs(),pe=N(W);{var se=P=>{var X=Rs();r(P,X)};w(pe,P=>{t().origin.isOldVersion&&P(se)})}var Me=s(pe,2);{var j=P=>{var X=Ws();r(P,X)},T=P=>{var X=Xs(),te=a(X);{var k=F=>{var I=Ks();const de=ve(()=>t().entityType==="Card"?t():t().parent);var M=a(I);p(x=>{var o;it(I,"href",x),g(M,`⇒${((o=e(de))!=null&&o.origin.cardId?"公式カードページ":"公式で検索")??""}`)},[c],ve),r(F,I)};w(te,F=>{var I;t()&&(t().entityType==="Card"||((I=t().parent)==null?void 0:I.entityType)==="Card")&&F(k)})}var $=s(te,2);pt($,()=>e(m),null,(F,I)=>{var de=$e(),M=N(de);{var x=o=>{var f=Vs();p(()=>it(f,"href",`https://yugioh-wiki.net/index.php?${e(I).wikiEncodedName}`)),r(o,f)};w(M,o=>{e(I)&&e(I).wikiEncodedName&&o(x)})}r(F,de)});var B=s($,2);p(()=>it(B,"href",`https://www.google.com/search?q=遊戯王 ${t().origin.name}`)),r(P,X)};w(Me,P=>{t().origin.isForTest?P(j):P(T,!1)})}r(H,W)};w(je,H=>{t()&&H(De)})}p((H,W)=>{ze(S,`duel_card duel_card_info ${t().origin.kind??""} ${H??""} svelte-1uevs9j`),g(Q,t().nm),g(E,W)},[()=>{var H;return(H=t().origin.monsterCategories)==null?void 0:H.join(" ")},()=>"★".repeat(t().lvl||0)],ve),r(R,S)};w(d,R=>{t()&&R(Y)})}r(_,u),ut()}Wa(["click","contextmenu"]);var Zs=l('<div class="duel_field_cell_info_item svelte-1xj7qf1"><!></div>'),ei=l('<div class="duel_field_cell_info_box svelte-1xj7qf1"><div class="duel_field_cell_info_label svelte-1xj7qf1"> </div> <!></div>'),ti=l('<div class="duel_field_cell_info svelte-1xj7qf1"><div class="duel_field_cell_info_header item_btn svelte-1xj7qf1"><div class="svelte-1xj7qf1"> </div> <div class="svelte-1xj7qf1"> </div></div> <div class="duel_field_cell_info_body svelte-1xj7qf1"></div></div>');function ai(_,i){ct(i,!1);let t=Ue(i,"cell",12);const v=()=>{t(t())},m=Y=>t().cardEntities.filter(R=>R.face===Y);t().field.duel.view.onDuelUpdate.append(v),_t();var c=$e(),u=N(c);{var d=Y=>{var R=ti(),S=a(R),D=a(S),n=a(D),A=s(D,2),Q=a(A),G=s(S,2);ce(G,4,()=>["FaceUp","FaceDown"],me,(U,z)=>{var ee=$e(),ue=N(ee);{var E=b=>{var q=ei(),ne=a(q),Ce=a(ne),he=s(ne,2);ce(he,1,()=>m(z).toSorted(or),me,(fe,ie)=>{var je=Zs(),De=a(je);const H=ve(()=>t().owner===t().field.duel.duelists.Below);Rt(De,{get entity(){return e(ie)},get isVisibleForcibly(){return e(H)},isWideMode:!0,cardActionResolve:void 0}),r(fe,je)}),p(()=>g(Ce,z==="FaceUp"?"表向き":"裏向き")),r(b,q)};w(ue,b=>{m(z).length&&b(E)})}r(U,ee)}),p(()=>{var U;g(n,(U=t().owner)==null?void 0:U.profile.name),g(Q,t().cellType)}),r(Y,R)};w(u,Y=>{t().field.duel.view.infoBoardState==="CellInfo"&&Y(d)})}r(_,c),ut()}var ri=l('<div class="duel_config_item svelte-y4u26k"><label class="toggle svelte-y4u26k"><input type="checkbox" class="svelte-y4u26k"></label> <span class="svelte-y4u26k"> </span></div>'),si=l('<div class="duel_config svelte-y4u26k"><div class="duel_config_title svelte-y4u26k">デュエル設定</div> <div class="duel_config_group svelte-y4u26k"><div class="duel_config_group_title svelte-y4u26k">チェーン設定</div> <!></div></div>');function ii(_,i){ct(i,!1);let t=Ue(i,"viewController",8),v=Ue(i,"userProfile",12);_t();var m=$e(),c=N(m);{var u=d=>{var Y=si(),R=s(a(Y),2),S=s(a(R),2);ce(S,1,()=>cr,me,(D,n)=>{var A=ri(),Q=a(A),G=a(Q),U=s(Q,2),z=a(U);p(()=>g(z,vr[e(n)])),dr(G,()=>v().chainConfig[e(n)],ee=>v(v().chainConfig[e(n)]=ee,!0)),Z("change",G,()=>v().save()),r(D,A)}),r(d,Y)};w(c,d=>{t().infoBoardState==="Config"&&d(u)})}r(_,m),ut()}function ni(_,{from:i,to:t},v={}){var{delay:m=0,duration:c=q=>Math.sqrt(q)*120,easing:u=wa}=v,d=getComputedStyle(_),Y=d.transform==="none"?"":d.transform,[R,S]=d.transformOrigin.split(" ").map(parseFloat);R/=_.clientWidth,S/=_.clientHeight;var D=li(_),n=_.clientWidth/t.width/D,A=_.clientHeight/t.height/D,Q=i.left+i.width*R,G=i.top+i.height*S,U=t.left+t.width*R,z=t.top+t.height*S,ee=(Q-U)*n,ue=(G-z)*A,E=i.width/t.width,b=i.height/t.height;return{delay:m,duration:typeof c=="function"?c(Math.sqrt(ee*ee+ue*ue)):c,easing:u,css:(q,ne)=>{var Ce=ne*ee,he=ne*ue,fe=q+ne*E,ie=q+ne*b;return`transform: ${Y} translate(${Ce}px, ${he}px) scale(${fe}, ${ie});`}}}function li(_){if("currentCSSZoom"in _)return _.currentCSSZoom;for(var i=_,t=1;i!==null;)t*=+getComputedStyle(i).zoom,i=i.parentElement;return t}var oi=l('<div class="chain_number svelte-lqu21u"> </div>'),vi=l('<div class="duel_card_row svelte-lqu21u"> </div>'),di=l('<div class="appendix svelte-lqu21u"> </div>'),ci=l('<div class="appendix_wrapper svelte-lqu21u"></div>'),_i=l('<div><div><!> <div> </div> <div><!> <div class="duel_card_row svelte-lqu21u"><div> </div> <!></div></div></div></div>'),ui=l("<div></div>");function fi(_,i){ct(i,!1);let t=Ue(i,"duel",8),v=Ue(i,"position",8,"left");const m=-100,c=()=>v()==="left"?-100:100;let u=_e([]),d=Promise.resolve(),Y=Promise.resolve();const R=1e3,S=500,D=400,n=Q=>{const G={...Q};G.isKnown=Q.chainBlockInfo.action.entity.controller.duelistType==="Player"||Q.chainBlockInfo.action.entity.face==="FaceUp",G.chainBlockInfo.onStateChange.append(U=>{if(U==="done"||U==="failed"||U==="negated")return d=d.then(async()=>{const z=new Date().getTime()-G.chainBlockInfo.wasSpawnedAt.getTime();z<R&&await Kt(R-z),C(u,e(u).filter(ee=>ee.seq!==G.seq)),await Kt(S+D)}).then(),"RemoveMe";C(u,e(u))}),Y=Y.then(async()=>{C(u,[G,...e(u)].sort((U,z)=>_r.isSameChain(U.clock,z.clock)&&U.chainBlockInfo.action.isWithChainBlock&&z.chainBlockInfo.action.isWithChainBlock?z.clock.totalProcSeq-U.clock.totalProcSeq:U.clock.totalProcSeq-z.clock.totalProcSeq)),await Kt(300)}),d=d.then(()=>Kt(1e3))};t().chainBlockLog.onInsert.append(n),_t();var A=ui();ce(A,13,()=>e(u),Q=>Q.seq,(Q,G)=>{var U=_i();const z=ve(()=>{const{activator:W,action:pe,appendix:se}=e(G).chainBlockInfo;return{activator:W,action:pe,appendix:se}});var ee=a(U),ue=a(ee);{var E=W=>{var pe=oi(),se=a(pe);p(()=>g(se,`チェーン：${e(G).chainBlockInfo.chainNumber??""}`)),r(W,pe)};w(ue,W=>{e(G).chainBlockInfo.chainNumber&&W(E)})}var b=s(ue,2),q=a(b),ne=s(b,2),Ce=a(ne);{var he=W=>{var pe=vi(),se=a(pe);p(()=>g(se,e(G).isKnown?e(z).action.entity.nm:"？？？")),r(W,pe)};w(Ce,W=>{(e(z).action.entity.entityType==="Card"||e(z).action.entity.entityType==="Token")&&W(he)})}var fe=s(Ce,2),ie=a(fe),je=a(ie),De=s(ie,2);{var H=W=>{var pe=ci();ce(pe,5,()=>e(z).appendix,me,(se,Me)=>{var j=di(),T=a(j);p(()=>g(T,e(Me))),r(se,j)}),r(W,pe)};w(De,W=>{e(z).appendix&&W(H)})}p((W,pe,se)=>{ze(U,`cut_in_row ${(!e(G).chainBlockInfo.chainNumber||e(G).chainBlockInfo.chainNumber===1?"cut_in_row_first":"")??""} svelte-lqu21u`),ze(ee,`cut_in_item cut_in_item_${W??""} cut_in_item_${e(G).chainBlockInfo.state??""} svelte-lqu21u`),ze(b,`duelist_name duelist_${W??""}_name svelte-lqu21u`),g(q,e(z).activator.profile.name),ze(ne,`duel_card duel_card_${W??""} ${pe??""} ${(e(G).isKnown?e(z).action.entity.origin.kind:"")??""} ${e(z).action.entity.entityType??""}  svelte-lqu21u`),g(je,se)},[()=>e(z).activator.seat.toLowerCase(),()=>e(G).isKnown?(e(z).action.entity.status.monsterCategories??[]).join(" "):"Token",()=>e(z).action.toString()],ve),le(3,ee,()=>Ar,()=>new Date().getTime()-e(G).chainBlockInfo.wasSpawnedAt.getTime()<R?{x:c(),duration:D}:{y:m,duration:D}),ur(U,()=>ni,()=>({duration:S})),r(Q,U)}),p(()=>ze(A,`cut_in_container cut_in_container_${v()??""} svelte-lqu21u`)),r(_,A),ut()}const pi=Lr({duration:400});var mi=l('<div class="duel_desk_left v_flex svelte-1w535im"><!> <!> <!></div>'),yi=l('<button class="duel_field_header_message svelte-1w535im"> </button> <div class="duel_field_header_buttons svelte-1w535im"><button class="svelte-1w535im">サレンダー</button></div>',1),gi=l("<tr></tr>"),hi=l('<table class="duel_field svelte-1w535im"><tbody class="svelte-1w535im"></tbody></table>'),bi=l('<button class="svelte-1w535im">OK</button>'),ki=l('<button class="svelte-1w535im">cancel</button>'),xi=l("<!> <!>",1),wi=l('<button class="svelte-1w535im"> </button>'),Ci=l('<div style="text-align: left;"><!> <!> <!></div>'),Di=l('<div><!> <div class=" duel_desk_center v_flex svelte-1w535im"><div class="duel_field_header svelte-1w535im"><!></div> <div class="duel_field_body svelte-1w535im"><!></div> <div class="duel_field_footer svelte-1w535im"><!></div></div> <!></div> <div style="position:fixed;bottom:0"> </div> <!> <div><!></div>',1);function $i(_,i){ct(i,!1);let t=Ue(i,"duel",12),v=Ue(i,"userProfile",8),m=_e(0),c=_e(0),u=_e([]),d=_e([]),Y=()=>{},R=_e([]),S=_e(),D=_e(),n=_e(()=>!1),A=_e(!1);const Q=o=>{Y=o.resolve,C(R,o.dummyActionInfos.filter(f=>f.action.entity.entityType==="Duelist").filter(f=>f.action.entity.controller.seat==="Below")),C(S,void 0),C(D,void 0),C(d,[]),C(u,[]),C(A,!1),o.entitiesChoices&&(C(S,o.entitiesChoices),C(n,()=>{var f;return((f=o.entitiesChoices)==null?void 0:f.validator(e(u)))??!1}),C(A,o.entitiesChoices.cancelable),e(S).selectables.every(f=>f.cell.isPlayFieldCell&&f.getIndexInCell()===0||f.cell.cellType==="Hand"&&f.controller.duelistType==="Player"||f.entityType==="Duelist")||t().view.modalController.entitySelector.show({title:t().view.message,position:"Middle",entitiesChoices:o.entitiesChoices,chainBlockInfos:o.chainBlockInfos,cancelable:o.entitiesChoices.cancelable}).then(f=>{Y({selectedEntities:f})})),o.cellsChoices&&(C(D,o.cellsChoices),C(n,()=>{var f;return((f=o.cellsChoices)==null?void 0:f.validator(e(d)))??!1}),C(A,o.cellsChoices.cancelable))};t().view.onWaitStart.append(Q);const G=()=>{Y=()=>{},C(D,void 0),C(S,void 0),C(d,[]),C(u,[]),C(n,()=>!1),C(A,!1)};t().view.onWaitEnd.append(G);let U=_e(void 0),z=_e("Normal");const ee=({card:o,mode:f})=>{C(U,o),C(z,f??(e(U)===o||e(z)==="Normal"?"Detail":"Normal"))};t().view.onShowCardEntity.append(ee);const ue=()=>{t(t())};t().view.onDuelUpdate.append(ue),t().log.onUpdate.append(ue);const E=()=>{e(S)&&e(S).validator(e(u))&&Y({selectedEntities:e(u)}),e(D)&&e(D).validator(e(d))&&Y({selectedCells:e(d)})},b=()=>{Y({})},q=o=>{Y({actionInfo:o})},ne=()=>{Y({surrender:!0})};t().main();const Ce=()=>e(m)<=1400?"compact":"wide";_t();var he=Di(),fe=N(he),ie=a(fe);{var je=o=>{var f=mi(),L=a(f);Oa(L,{get duelist(){return t().duelists.Above}});var K=s(L,2);{var ge=oe=>{Js(oe,{get entity(){return e(U)},get mode(){return e(z)}})};w(K,oe=>{e(U)&&oe(ge)})}var be=s(K,2);Oa(be,{get duelist(){return t().duelists.Below}}),r(o,f)};w(ie,o=>{Ce()==="wide"&&o(je)})}var De=s(ie,2),H=a(De),W=a(H);{var pe=o=>{var f=yi(),L=N(f),K=a(L),ge=s(L,2),be=a(ge);p(()=>g(K,`[TURN:${t().clock.turn}][PHASE:${t().phase}] ${t().view.message}`)),Z("click",L,()=>{t(t().view.infoBoardState="Log",!0)}),Z("click",be,ne),r(o,f)};w(W,o=>{t().isEnded||o(pe)})}var se=s(H,2),Me=a(se);{var j=o=>{var f=hi(),L=a(f);ce(L,5,()=>t().field.cells,me,(K,ge,be)=>{var oe=gi();ze(oe,`${`duel_desk_row_${be}`??""} svelte-1w535im`),ce(oe,5,()=>e(ge),me,(ae,V,re)=>{as(ae,{get view(){return t().view},row:be,column:re,get selectedEntities(){return e(u)},set selectedEntities(Se){C(u,Se)},get selectedCells(){return e(d)},set selectedCells(Se){C(d,Se)},$$legacy:!0})}),r(K,oe)}),r(o,f)};w(Me,o=>{t().clock.turn>0&&o(j)})}var T=s(se,2),P=a(T);{var X=o=>{var f=xi(),L=N(f);{var K=oe=>{var ae=bi();p(V=>ae.disabled=V,[()=>!e(n)()],ve),Z("click",ae,E),r(oe,ae)};w(L,oe=>{((e(S)&&e(S).qty)??(e(D)&&e(D).qty)??9999)>1&&oe(K)})}var ge=s(L,2);{var be=oe=>{var ae=ki();Z("click",ae,b),r(oe,ae)};w(ge,oe=>{e(A)&&oe(be)})}r(o,f)},te=o=>{var f=$e(),L=N(f);ce(L,1,()=>e(R),me,(K,ge)=>{var be=wi(),oe=a(be);p(()=>g(oe,e(ge).action.title)),Z("click",be,()=>q(e(ge))),r(K,be)}),r(o,f)};w(P,o=>{e(S)&&e(S).selectables.length||e(D)&&e(D).selectables?o(X):o(te,!1)})}var k=s(De,2);{var $=o=>{var f=Ci(),L=a(f);us(L,{get log(){return t().log}});var K=s(L,2);ai(K,{get cell(){return t().view.infoBoardCell}});var ge=s(K,2);ii(ge,{get userProfile(){return v()},get viewController(){return t().view}}),p(be=>ze(f,`duel_desk_right duel_desk_right_${be??""}  svelte-1w535im`),[()=>t().view.infoBoardState.toLowerCase()],ve),le(3,f,()=>we,()=>({duration:e(m)>1400?0:200,axis:"x"})),r(o,f)};w(k,o=>{(e(m)>1400||t().view.infoBoardState!=="Default")&&o($)})}var B=s(fe,2),F=a(B),I=s(B,2);fr(I,{get modalController(){return t().view.modalController}});var de=s(I,2),M=a(de);const x=ve(()=>Ce()==="wide"?"right":"left");fi(M,{get duel(){return t()},get position(){return e(x)}}),p((o,f)=>{ze(fe,`flex duel_desk ${o??""}_mode svelte-1w535im`),g(F,f),ze(de,`cutin ${o??""}_mode svelte-1w535im`)},[Ce,()=>t().clock.toFullString()],ve),_a("innerWidth",o=>C(m,o)),_a("innerHeight",o=>C(c,o)),r(_,he),ut()}var Si=l("<div></div>"),Ti=l("<!> <!> <!> <!>",1),Mi=l('<span class="atk svelte-1y1qbq4"> </span> <span class="slash svelte-1y1qbq4">/</span> <span class="def svelte-1y1qbq4"> </span>',1),zi=l('<div role="listitem"><div class="svelte-1y1qbq4"><div class="duel_card_row card_name svelte-1y1qbq4"> </div> <div style="display:flex; flex-wrap: wrap;" class="svelte-1y1qbq4"><div style="" class="svelte-1y1qbq4"><!> <!> <!></div> <div class="atk_def svelte-1y1qbq4"><!></div></div></div></div>');function Qa(_,i){ct(i,!1);let t=Ue(i,"mode",8),v=Ue(i,"cardInfo",8),m=Ue(i,"onAttention",8),c=Ue(i,"cardControlEventHandlers",8);_t();var u=zi(),d=a(u),Y=a(d),R=a(Y),S=s(Y,2),D=a(S),n=a(D);{var A=b=>{var q=Ti(),ne=N(q);{var Ce=De=>{var H=Qe();p(()=>g(H,`★${v().level??""}`)),r(De,H)},he=De=>{var H=$e(),W=N(H);{var pe=Me=>{var j=Qe();p(()=>g(j,`☆${v().rank??""}`)),r(Me,j)},se=Me=>{var j=$e(),T=N(j);{var P=X=>{var te=Qe();p(()=>g(te,`Ｌ${v().link??""}`)),r(X,te)};w(T,X=>{v().link&&X(P)},!0)}r(Me,j)};w(W,Me=>{v().rank?Me(pe):Me(se,!1)},!0)}r(De,H)};w(ne,De=>{v().level?De(Ce):De(he,!1)})}var fe=s(ne,2);ce(fe,1,()=>v().attributes??[],me,(De,H)=>{var W=Si();p(()=>ze(W,`monster_attr ${e(H)??""} svelte-1y1qbq4`)),r(De,W)});var ie=s(fe,2);ce(ie,1,()=>v().types??[],me,(De,H)=>{var W=Qe();p(()=>g(W,ma[e(H)])),r(De,W)});var je=s(ie,2);ce(je,1,()=>v().monsterCategories??[],me,(De,H)=>{var W=Qe();p(()=>g(W,va[e(H)])),r(De,W)}),r(b,q)};w(n,b=>{v().kind==="Monster"&&b(A)})}var Q=s(n,2);{var G=b=>{var q=Qe();p(()=>g(q,`${ya[v().spellCategory]??""}魔法`)),r(b,q)};w(Q,b=>{v().spellCategory&&b(G)})}var U=s(Q,2);{var z=b=>{var q=Qe();p(()=>g(q,`${ga[v().trapCategory]??""}罠`)),r(b,q)};w(U,b=>{v().trapCategory&&b(z)})}var ee=s(D,2),ue=a(ee);{var E=b=>{var q=Mi(),ne=N(q),Ce=a(ne),he=s(ne,4),fe=a(he);p(()=>{g(Ce,v().attack??"?"),g(fe,v().defense??"?")}),r(b,q)};w(ue,b=>{v().kind==="Monster"&&b(E)})}p(b=>{ze(u,`${b??""} svelte-1y1qbq4`),g(R,v().name)},[()=>{var b,q;return`deck_editor_card duel_card ${v().kind} ${(q=(b=v())==null?void 0:b.monsterCategories)==null?void 0:q.join(" ")} ${v().isImplemented?"is_implemented":"is_not_implemented"}`}],ve),Z("click",u,()=>m()(v())),Z("touchstart",u,b=>c().onCardDragStart(b,t(),v())),Z("touchmove",u,b=>c().onCardDragging(b,t())),Z("touchend",u,function(...b){var q;(q=c().onCardDragEnd)==null||q.apply(this,b)}),Z("touchcancel",u,function(...b){var q;(q=c().onCardDragCancel)==null||q.apply(this,b)}),Z("mousedown",u,b=>c().onCardDragStart(b,t(),v())),Z("mousemove",u,b=>c().onCardDragging(b,t())),Z("mouseup",u,function(...b){var q;(q=c().onCardDragEnd)==null||q.apply(this,b)}),r(_,u),ut()}var ji=l('<div class="svelte-1a76gvv"><button class="button_style_reset svelte-1a76gvv">クリア</button></div>'),Ei=l('<button class="button_style_reset plus_minus_button svelte-1a76gvv">+</button> <button class="button_style_reset plus_minus_button svelte-1a76gvv">-</button>',1),Bi=l('<li class="deck_editor_item svelte-1a76gvv"><!> <!></li>'),Ai=l('<div class="deck_editor_card_kind_header svelte-1a76gvv"><div class="svelte-1a76gvv"> <!> 枚） <!></div> <div style="display: flex;" class="svelte-1a76gvv"><!> <div class="triangle svelte-1a76gvv">▲</div></div></div> <div class="deck_editor_card_kind_body svelte-1a76gvv"><ul></ul></div>',1),Li=l("<div><!></div>"),Yi=l('<div class="deck_editor_card_list svelte-1a76gvv"></div>');function Ra(_,i){ct(i,!1);let t=Ue(i,"allCardTree",8),v=Ue(i,"deckCardTree",12),m=Ue(i,"mode",8),c=Ue(i,"onAttention",8),u=Ue(i,"searchCondition",8,void 0),d=Ue(i,"cardControlEventHandlers",8),Y=_e("ExtraMonster");const R=xa.terminalTypeName==="PC"?500:xa.terminalTypeName==="Tablet Device"?300:100,S=20;let D=_e(S);const n=(E=!1)=>{if(E||C(D,S),C(D,e(D)+10),m()==="List"){if(e(D)>=R)return}else if(e(D)>mr(...Object.values(v()).map(b=>b.length)))return;Kt(100).then(()=>n(!0))},A=_e(m()==="List"?t():v()),Q=(...E)=>{const b=E.length?E:Wt(e(A)),q=(ne,Ce)=>{var he;return Ga(ne,Ce,(he=u())==null?void 0:he.sort.filter(fe=>fe.priority>0).toSorted((fe,ie)=>fe.priority-ie.priority))};b.forEach(ne=>e(A)[ne].sort(q))},G=(E,b)=>{v(v()[b]=[],!0)};let U=_e(structuredClone(e(A))),z=_e("");const ee=E=>{if(!u())return!0;if(E.kind==="XyzMaterial")return!1;const b=ua(E);if(!u().deckCardKinds.includes(b)||u().name.trim().length&&[E.name,...E.nameTags??[],...E.textTags??[]].every(ne=>!ne.includes(u().name))||!E.isImplemented&&!u().others.includes("implemented")||E.isForTest&&!u().others.includes("test")||E.isOldVersion&&!u().others.includes("oldVersion"))return!1;if(E.kind==="Monster"){if(E.attributes&&!u().monsterAttributes.union(E.attributes).length||E.types&&!u().monsterTypes.union(E.types).length)return!1;const q=E.level??E.rank??E.link;return Bt(u().starLowerBound)&&(q??0)<u().starLowerBound||Bt(u().starUpperBound)&&(q??0)>u().starUpperBound||Bt(u().atkLowerBound)&&(E.attack??0)<u().atkLowerBound||Bt(u().atkUpperBound)&&(E.attack??0)>u().atkUpperBound||Bt(u().defLowerBound)&&(E.defense??0)<u().defLowerBound||Bt(u().defUpperBound)&&(E.defense??0)>u().defUpperBound||Bt(u().atkPlusDef)&&(!Bt(E.attack)||!Bt(E.defense)||E.attack+E.defense!==u().atkPlusDef)||!E.monsterCategories||b==="ExtraMonster"&&!E.monsterCategories.union(u().exMonsterCategories).length?!1:E.monsterCategories.union(u().monsterCategories).length}if(E.kind==="Spell")return E.spellCategory&&u().spellCategories.includes(E.spellCategory);if(E.kind==="Trap")return E.trapCategory&&u().trapCategories.includes(E.trapCategory)};ba(()=>(la(m()),e(A),la(v()),e(Y),e(U)),()=>{if(m()==="Deck"){if(Wt(e(A)).forEach(E=>xe(A,e(A)[E]=v()[E])),!e(A)[e(Y)].length)C(Y,Wt(e(A)).find(E=>e(A)[E].find(ee))??"ExtraMonster");else{const E=Wt(e(A)).map(b=>({kind:b,cardInfos:e(A)[b]})).filter(({cardInfos:b})=>b.length).find(({kind:b,cardInfos:q})=>q.length!==e(U)[b].length);E&&e(Y)!==E.kind&&C(Y,E.kind)}C(U,structuredClone(e(A)))}}),ba(()=>(la(m()),la(u()),e(z)),()=>{var E;if(m()==="List"){const b=JSON.stringify((E=u())==null?void 0:E.sort);e(z)!==b&&(C(z,b),Q()),n()}}),Ka(),_t();var ue=Yi();ce(ue,5,()=>ea,me,(E,b,q)=>{var ne=Li();const Ce=ve(()=>e(A)[e(b)].filter(ee));var he=a(ne);{var fe=ie=>{var je=Ai(),De=N(je),H=a(De),W=a(H),pe=s(W);{var se=$=>{var B=Qe();p(F=>g(B,`/ ${F??""}`),[()=>e(A)[e(b)].length.toLocaleString()],ve),r($,B)};w(pe,$=>{m()==="List"&&$(se)})}var Me=s(pe,2);{var j=$=>{var B=Qe();p(F=>g(B,`※表示上限${F??""}枚`),[()=>R.toLocaleString()],ve),r($,B)};w(Me,$=>{e(Ce).length>R&&$(j)})}var T=s(H,2),P=a(T);{var X=$=>{var B=ji(),F=a(B);Z("click",F,I=>G(I,e(b))),r($,B)};w(P,$=>{m()==="Deck"&&e(Ce).length&&$(X)})}var te=s(De,2),k=a(te);ce(k,5,()=>e(Ce),me,($,B,F)=>{var I=$e(),de=N(I);{var M=x=>{var o=Bi(),f=a(o);Qa(f,{get mode(){return m()},get cardInfo(){return e(B)},get onAttention(){return c()},get cardControlEventHandlers(){return d()}});var L=s(f,2);{var K=ge=>{var be=Ei(),oe=N(be),ae=s(oe,2);p(V=>{oe.disabled=!e(B).isImplemented,it(oe,"title",e(B).isImplemented?`※shiftキー同時押しで一括投入
※ctrlキー同時押しで枚数制限無視`:""),ae.disabled=V,it(ae,"title",e(B).isImplemented?"※shiftキー同時押しで一括外し":"")},[()=>m()!=="Deck"&&v()[e(b)].every(V=>V.name!==e(B).name)],ve),Z("click",oe,V=>d().onCardAppend(V,e(B))),Z("click",ae,V=>d().onCardRemove(V,e(B))),r(ge,be)};w(L,ge=>{m()==="Deck"&&ge(K)})}r(x,o)};w(de,x=>{F<e(D)&&(F<20||e(Y)===e(b))&&x(M)})}r($,I)}),p($=>{g(W,`${Xa[e(b)]??""}（${$??""} `),ze(k,pr(e(b)),"svelte-1a76gvv")},[()=>e(Ce).length.toLocaleString()],ve),Z("click",De,()=>{if(e(Y)!==e(b)){C(Y,e(b));return}C(Y,ea.map(($,B)=>B+q).map($=>$%ea.length).map($=>ea[$]).filter($=>$!==e(b)).find($=>e(A)[$].find(ee))??e(b))}),r(ie,je)};w(he,ie=>{e(Ce).length&&ie(fe)})}p(()=>ze(ne,`deck_editor_card_kind deckCardKind ${(e(b)===e(Y)?"selected":"")??""} ${(e(Ce).length?"":"empty")??""} svelte-1a76gvv`)),r(E,ne)}),r(_,ue),ut()}var qi=l('<div class="svelte-7xhk0x"> </div>'),Ui=l('<div class="svelte-7xhk0x"> </div>'),Pi=l('<div class="link_arrow_emoji svelte-7xhk0x"> </div>'),Ni=l('<div class="duel_card_info_row svelte-7xhk0x" style="position:sticky; top:0;"><!></div>'),Hi=l('<div class="duel_card_info_row svelte-7xhk0x"><div class="svelte-7xhk0x"><pre class="description svelte-7xhk0x"> </pre></div></div> <div class="duel_card_info_row svelte-7xhk0x" style=" justify-content: space-between;"><div class="svelte-7xhk0x"> </div> <div class="svelte-7xhk0x"> </div></div>',1),Fi=l('<div></div> <div class="svelte-7xhk0x"> </div>',1),Ii=l("<div> </div>"),Oi=l('<span class="svelte-7xhk0x">/</span> <div class="monster_defense svelte-7xhk0x"> </div>',1),Ri=l("<div> </div>"),Wi=l('<div class="duel_card_info_row svelte-7xhk0x"><!> <!> <div style="flex-grow: 1;" class="svelte-7xhk0x"></div> <div class="monster_attack svelte-7xhk0x"> </div> <!></div> <div class="duel_card_info_row svelte-7xhk0x"></div>',1),Ki=l('<div class="duel_card_row svelte-7xhk0x"><div class="svelte-7xhk0x"></div> <div class="svelte-7xhk0x"> </div></div>'),Vi=l('<div class="duel_card_row svelte-7xhk0x"><div class="svelte-7xhk0x"></div> <div class="svelte-7xhk0x"> </div></div>'),Xi=l('<div class="duel_card_info_row svelte-7xhk0x"><div class="svelte-7xhk0x">※エラッタ前カードです</div></div>'),Gi=l('<div class="duel_card_info_row svelte-7xhk0x"><div class="svelte-7xhk0x">※テスト用カードです</div></div>'),Qi=l('<div class="duel_card_info_links svelte-7xhk0x"><a target="_blank" rel="noopener noreferrer" title="コナミカードデータベース" class="svelte-7xhk0x"> </a> <a target="_blank" rel="noopener noreferrer" title="遊戯王カードWiki" class="svelte-7xhk0x">⇒遊戯王カードWiki</a> <a target="_blank" rel="noopener noreferrer" title="google" class="svelte-7xhk0x">⇒google検索</a></div>'),Ji=l('<div><div class="duel_card_info_header svelte-7xhk0x"><div class="duel_card_info_row svelte-7xhk0x"><div class="svelte-7xhk0x"> </div></div> <!> <div class="plus_minus_button_area svelte-7xhk0x"><button class="button_style_reset plus_minus_button svelte-7xhk0x">+</button> <button class="button_style_reset plus_minus_button svelte-7xhk0x">-</button></div></div> <div class="duel_card_info_body svelte-7xhk0x"><!> <!> <div class="duel_card_info_row description svelte-7xhk0x"><div class="svelte-7xhk0x"><pre class="description svelte-7xhk0x"> </pre></div></div> <!> <!></div></div>');function Zi(_,i){ct(i,!1);let t=Ue(i,"cardInfo",8,void 0),v=Ue(i,"onAttention",8),m=Ue(i,"cardControlEventHandlers",8),c=Ue(i,"deckCardTree",8);_t();var u=$e(),d=N(u);{var Y=R=>{var S=Ji(),D=a(S),n=a(D),A=a(n),Q=a(A),G=s(n,2);{var U=j=>{var T=Ni(),P=a(T);{var X=k=>{var $=qi(),B=a($);p(F=>g(B,F),[()=>"★".repeat(t().level)],ve),r(k,$)},te=k=>{var $=$e(),B=N($);{var F=de=>{var M=Ui(),x=a(M);p(o=>g(x,o),[()=>"★".repeat(t().rank)],ve),r(de,M)},I=de=>{var M=$e(),x=N(M);{var o=f=>{var L=Pi(),K=a(L);p(ge=>g(K,ge),[()=>t().linkArrowKeys.map(ge=>Va[ge].emoji).join("")],ve),r(f,L)};w(x,f=>{t().linkArrowKeys&&f(o)},!0)}r(de,M)};w(B,de=>{t().rank&&t().rank>0?de(F):de(I,!1)},!0)}r(k,$)};w(P,k=>{t().level&&t().level>0?k(X):k(te,!1)})}r(j,T)};w(G,j=>{t().kind==="Monster"&&j(U)})}var z=s(G,2),ee=a(z),ue=s(ee,2),E=s(D,2),b=a(E);{var q=j=>{var T=Hi(),P=N(T),X=a(P),te=a(X),k=a(te),$=s(P,2),B=a($),F=a(B),I=s(B,2),de=a(I);p(()=>{g(k,t().pendulumDescription),g(F,`◀ ${t().pendulumScaleL??""}`),g(de,`${t().pendulumScaleR??""} ▶`)}),r(j,T)};w(b,j=>{var T;(T=t().monsterCategories)!=null&&T.includes("Pendulum")&&j(q)})}var ne=s(b,2);{var Ce=j=>{var T=Wi(),P=N(T),X=a(P);{var te=x=>{var o=Fi(),f=N(o),L=s(f,2),K=a(L);p(()=>{ze(f,`monster_attr ${t().attributes[0]??""} svelte-7xhk0x`),g(K,`${$a[t().attributes[0]]??""}属性`)}),r(x,o)};w(X,x=>{t().attributes&&x(te)})}var k=s(X,2);{var $=x=>{var o=Ii(),f=a(o);p(()=>{ze(o,`monster_cat ${t().types[0]??""} svelte-7xhk0x`),g(f,`${ma[t().types[0]]??""}${Sa[t().types[0]]??""}族`)}),r(x,o)};w(k,x=>{t().types&&x($)})}var B=s(k,4),F=a(B),I=s(B,2);{var de=x=>{var o=Oi(),f=s(N(o),2),L=a(f);p(()=>g(L,t().defense??"?")),r(x,o)};w(I,x=>{var o;(o=t().monsterCategories)!=null&&o.includes("Link")||x(de)})}var M=s(P,2);ce(M,5,()=>t().monsterCategories??[],me,(x,o)=>{var f=Ri(),L=a(f);p(()=>{ze(f,`monster_cat ${e(o)??""} svelte-7xhk0x`),g(L,`${va[e(o)]??""}${ca[e(o)]??""}`)}),r(x,f)}),p(()=>g(F,t().attack??"?")),r(j,T)},he=j=>{var T=$e(),P=N(T);{var X=k=>{var $=Ki(),B=s(a($),2),F=a(B);p(()=>g(F,`${ya[t().spellCategory]??""}魔法`)),r(k,$)},te=k=>{var $=$e(),B=N($);{var F=I=>{var de=Vi(),M=s(a(de),2),x=a(M);p(()=>g(x,`${ga[t().trapCategory]??""}罠`)),r(I,de)};w(B,I=>{t().kind==="Trap"&&t().trapCategory&&I(F)},!0)}r(k,$)};w(P,k=>{t().kind==="Spell"&&t().spellCategory?k(X):k(te,!1)},!0)}r(j,T)};w(ne,j=>{t().kind==="Monster"?j(Ce):j(he,!1)})}var fe=s(ne,2),ie=a(fe),je=a(ie),De=a(je),H=s(fe,2);{var W=j=>{var T=Xi();r(j,T)};w(H,j=>{t().isOldVersion&&j(W)})}var pe=s(H,2);{var se=j=>{var T=Gi();r(j,T)},Me=j=>{var T=Qi(),P=a(T),X=a(P),te=s(P,2),k=s(te,2);p($=>{it(P,"href",$),g(X,`⇒${(t().cardId?"公式カードページ":"公式で検索")??""}`),it(te,"href",`https://yugioh-wiki.net/index.php?${t().wikiEncodedName}`),it(k,"href",`https://www.google.com/search?q=遊戯王 ${t().name}`)},[()=>yr(t())],ve),r(j,T)};w(pe,j=>{t().isForTest?j(se):j(Me,!1)})}p((j,T)=>{ze(S,`duel_card duel_card_info ${t().kind??""} ${j??""} svelte-7xhk0x`),g(Q,t().name),ee.disabled=!t().isImplemented,it(ee,"title",t().isImplemented?`※shiftキー同時押しで一括投入
※ctrlキー同時押しで枚数制限無視`:""),ue.disabled=T,it(ue,"title",t().isImplemented?"※shiftキー同時押しで一括外し":""),g(De,t().description)},[()=>{var j;return(j=t().monsterCategories)==null?void 0:j.join(" ")},()=>c()[ua(t())].every(j=>j.name!==t().name)],ve),Z("click",ee,j=>m().onCardAppend(j,t())),Z("click",ue,j=>m().onCardRemove(j,t())),Z("click",S,()=>v()(t())),r(R,S)};w(d,R=>{t()&&R(Y)})}r(_,u),ut()}const en={0:{aaa:"日",aaaa:"日曜日",ddd:"Sun",dddd:"Sunday"},1:{aaa:"月",aaaa:"月曜日",ddd:"Mon",dddd:"Monday"},2:{aaa:"火",aaaa:"火曜日",ddd:"Tue",dddd:"Tuesday"},3:{aaa:"水",aaaa:"水曜日",ddd:"Wed",dddd:"Wednesday"},4:{aaa:"木",aaaa:"木曜日",ddd:"Thu",dddd:"Thursday"},5:{aaa:"金",aaaa:"金曜日",ddd:"Fri",dddd:"Friday"},6:{aaa:"土",aaaa:"土曜日",ddd:"Sat",dddd:"Saturday"}};class tn{constructor(){st(this,"DefaultSeparator1","/");st(this,"DefaultSeparator2"," ");st(this,"DefaultSeparator3",":");st(this,"createDate",i=>{if(!i)return;const t=new Date(i);if(!isNaN(t.getTime()))return t});st(this,"createDateOr",(i,t)=>this.createDate(i)||t||new Date);st(this,"truncateDate",i=>{const t=i||new Date;return new Date(t.getFullYear(),t.getMonth(),t.getDate())});st(this,"addDate",(i,t)=>{const v=this.createDateOr(i);return v.setDate(v.getDate()+t),v});st(this,"addMonth",(i,t)=>{const v=this.createDateOr(i);return v.setMonth(v.getMonth()+t),v});st(this,"addYear",(i,t)=>{const v=this.createDateOr(i);return v.setFullYear(v.getFullYear()+t),v});st(this,"getDayOfWeek",(i,t="dddd")=>{const v=this.createDate(i);return v?en[v.getDay()][t]:""});st(this,"formatToYYYYMMDD",(i,t=this.DefaultSeparator1)=>{const v=this.createDate(i);if(!v)return"";const m=v.getFullYear().toString(),c=("0"+(v.getMonth()+1)).slice(-2),u=("0"+v.getDate()).slice(-2);return m+t+c+t+u});st(this,"formatToYYYYMM",(i,t=this.DefaultSeparator1)=>{const v=this.createDate(i);if(!v)return"";t||(t="");const m=v.getFullYear().toString(),c=("0"+(v.getMonth()+1)).slice(-2);return m+t+c});st(this,"formatToHHMMSS",(i,t=this.DefaultSeparator3)=>{const v=this.createDate(i);if(!v)return"";t||(t="");const m=v.getHours(),c=v.getMinutes(),u=v.getSeconds();return("0"+m).slice(-2)+t+("0"+c).slice(-2)+t+("0"+u).slice(-2)});st(this,"formatToHHMM",(i,t=this.DefaultSeparator3)=>{const v=this.createDate(i);if(!v)return"";t||(t="");const m=("0"+v.getHours()).slice(-2),c=("0"+v.getMinutes()).slice(-2);return m+t+c});st(this,"formatToYYYYMMDD_HHMM",(i,t=this.DefaultSeparator1,v=this.DefaultSeparator2,m=this.DefaultSeparator3)=>{const c=this.createDate(i);return c?this.formatToYYYYMMDD(c,t)+v+this.formatToHHMM(c,m):""});st(this,"formatToYYYYMMDD_HHMMSS",(i,t=this.DefaultSeparator1,v=this.DefaultSeparator2,m=this.DefaultSeparator3)=>{const c=this.createDate(i);return c?this.formatToYYYYMMDD(c,t)+v+this.formatToHHMMSS(c,m):""})}}const bt=new tn;Date.prototype.truncateDate=function(){return bt.truncateDate(this)};Date.prototype.getCloneOr=function(_){return bt.createDateOr(this,_)};Date.prototype.addDate=function(_){return bt.addDate(this,_)};Date.prototype.addMonth=function(_){return bt.addDate(this,_)};Date.prototype.addYear=function(_){return bt.addDate(this,_)};Date.prototype.getDayOfWeek=function(_="dddd"){return bt.getDayOfWeek(this,_)};Date.prototype.formatToYYYYMM=function(_){return bt.formatToYYYYMM(this,_)};Date.prototype.formatToYYYYMMDD=function(_){return bt.formatToYYYYMMDD(this,_)};Date.prototype.formatToYYYYMMDD_HHMM=function(_,i,t){return bt.formatToYYYYMMDD_HHMM(this,_,i,t)};Date.prototype.formatToYYYYMMDD_HHMMSS=function(_,i,t){return bt.formatToYYYYMMDD_HHMMSS(this,_,i,t)};Date.prototype.formatToHHMM=function(_){return bt.formatToHHMM(this,_)};Date.prototype.formatToHHMMSS=function(_){return bt.formatToHHMMSS(this,_)};var an=l('<li class="deck_info_list_item svelte-2wdgc8"><div class="svelte-2wdgc8"> </div> <div class="svelte-2wdgc8"> </div> <div class="svelte-2wdgc8"> </div></li>'),rn=l('<ul class="deck_info_list svelte-2wdgc8"></ul>'),sn=l('<label for="file_selector" class="upload_area svelte-2wdgc8" role="region" aria-label="ファイルアップロードエリア"><div class="upload_area_message svelte-2wdgc8">ここにファイルをドロップ</div> <div class="upload_area_footer svelte-2wdgc8"><input type="file" id="file_selector" name="file_selector" accept=".json" multiple></div></label>'),nn=l('<div slot="body" class="modal_body svelte-2wdgc8"><!></div>'),ln=l('<button class="svelte-2wdgc8">追加</button> <button class="svelte-2wdgc8">削除して追加</button> <button class="svelte-2wdgc8">戻る</button>',1),on=l('<button class="svelte-2wdgc8">Cancel</button>'),vn=l('<div slot="footer" class="modal_window_footer svelte-2wdgc8"><!></div>');function dn(_,i){ct(i,!1);let t=Ue(i,"eventHolder",8),v=Ue(i,"args",8),m=Ue(i,"resolve",8),c=_e(Promise.resolve([])),u=_e();const d=()=>{C(u,new DataTransfer().files),C(c,Promise.resolve([]))},Y=async A=>{A.preventDefault(),console.log("hoge",A)},R=async A=>{A.preventDefault(),A.dataTransfer&&D(A.dataTransfer.files)},S=()=>{D(e(u))},D=async A=>{if(!A.length)return;const Q=[],G=[];for(const U of A)try{G.push(...await Dt.createfromJson(U))}catch(z){z instanceof Error&&Q.push(z.message)}if(Q.length){console.log(...Q);return}C(c,e(c).then(()=>G))},n=d;_t(),gr(_,{get eventHolder(){return t()},get args(){return v()},$$slots:{body:(A,Q)=>{var G=nn(),U=a(G);pt(U,()=>oa,null,(z,ee)=>{var ue=$e(),E=N(ue);pt(E,()=>e(c),null,(b,q)=>{var ne=$e(),Ce=N(ne);{var he=ie=>{var je=rn();ce(je,5,()=>e(q),me,(De,H)=>{var W=an(),pe=a(W),se=a(pe),Me=s(pe,2),j=a(Me),T=s(Me,2),P=a(T);p((X,te,k)=>{g(se,e(H).name),g(j,`${X??""}
                  /
                  ${te??""}`),g(P,`最終使用日時 ： ${k??""}`)},[()=>e(H).cardNames.filter(X=>{var te,k;return!((k=(te=e(ee).getCardInfo(X))==null?void 0:te.monsterCategories)!=null&&k.union(ta).length)}).length,()=>e(H).cardNames.filter(X=>{var te,k;return(k=(te=e(ee).getCardInfo(X))==null?void 0:te.monsterCategories)==null?void 0:k.union(ta).length}).length,()=>e(H).lastUsedAt.formatToYYYYMMDD_HHMM("/"," ",":")],ve),r(De,W)}),r(ie,je)},fe=ie=>{var je=sn(),De=s(a(je),2),H=a(De);hr(H,()=>e(u),W=>C(u,W)),Z("change",H,S),Z("cancel",H,n),Z("drop",je,R),Z("dragover",je,Y),r(ie,je)};w(Ce,ie=>{e(q).length?ie(he):ie(fe,!1)})}r(b,ne)}),r(z,ue)}),r(A,G)},footer:(A,Q)=>{var G=vn(),U=a(G);pt(U,()=>e(c),null,(z,ee)=>{var ue=$e(),E=N(ue);{var b=ne=>{var Ce=ln(),he=N(Ce),fe=s(he,2),ie=s(fe,2);p(()=>{he.disabled=e(ee).length===0,fe.disabled=e(ee).length===0}),Z("click",he,()=>m()({deckInfos:e(ee),replaceAll:!1})),Z("click",fe,()=>m()({deckInfos:e(ee),replaceAll:!0})),Z("click",ie,n),r(ne,Ce)},q=ne=>{var Ce=$e(),he=N(Ce);{var fe=ie=>{var je=on();Z("click",je,()=>m()(void 0)),r(ie,je)};w(he,ie=>{v().cancelable&&ie(fe)},!0)}r(ne,Ce)};w(E,ne=>{e(ee).length?ne(b):ne(q,!1)})}r(z,ue)}),r(A,G)}}}),ut()}const pa=class pa extends kr{constructor(i,t){super(i,...Object.values(t))}};st(pa,"createModalController",i=>{const t={deckUploader:new xr({title:"デッキ情報をアップロード",position:"Middle",cancelable:!1})};return Object.assign(new pa(i,t),t)});let Da=pa;function cn(_,i){ct(i,!1);let t=Ue(i,"modalController",8);_t(),br(_,{get modalController(){return t()},children:(v,m)=>{var c=$e(),u=N(c);{var d=Y=>{dn(Y,{get eventHolder(){return t().eventHolder},get args(){return t().deckUploader.args},get resolve(){return t().deckUploader.resolve}})};w(u,Y=>{t().deckUploader.state==="Shown"&&Y(d)})}r(v,c)},$$slots:{default:!0}}),ut()}var _n=l("<button> </button>"),un=l('<label class="svelte-1mhlzty"><input type="checkbox" class="search_condition svelte-1mhlzty"> </label>'),fn=l('<label class="svelte-1mhlzty"><input type="checkbox" class="search_condition svelte-1mhlzty"> </label>'),pn=l('<div class="deck_editor_search_box_row monster_ex_categories svelte-1mhlzty"><div class="svelte-1mhlzty"><button class="search_condition_title black_button svelte-1mhlzty">エクストラ</button></div> <div class="svelte-1mhlzty"></div></div>'),mn=l('<label class="svelte-1mhlzty"><input type="checkbox" class="search_condition svelte-1mhlzty"> </label>'),yn=l('<label class="svelte-1mhlzty"><input type="checkbox" class="search_condition svelte-1mhlzty"> <div style="display: inline-block;"></div> </label>'),gn=l('<label class="svelte-1mhlzty"><input type="checkbox" class="search_condition svelte-1mhlzty"> </label>'),hn=l('<div class="deck_editor_search_box_row monster_categories svelte-1mhlzty"><div class="svelte-1mhlzty"><button class="search_condition_title black_button svelte-1mhlzty">モンスター</button></div> <div class="svelte-1mhlzty"></div></div> <div class="deck_editor_search_box_row monster_attributes svelte-1mhlzty"><div class="svelte-1mhlzty"><button class="search_condition_title black_button svelte-1mhlzty">属性</button></div> <div class="svelte-1mhlzty"></div></div> <div class="deck_editor_search_box_row svelte-1mhlzty"><div class="svelte-1mhlzty"><button class="search_condition_title black_button svelte-1mhlzty">種族</button></div> <div class="svelte-1mhlzty"></div></div> <div class="deck_editor_search_box_row svelte-1mhlzty"><div class="svelte-1mhlzty"><button class="search_condition_title black_button svelte-1mhlzty">星攻守</button></div> <div class="svelte-1mhlzty"><div class="star_range svelte-1mhlzty"><span class="svelte-1mhlzty">星</span> <input type="number" min="0" max="13" class="svelte-1mhlzty"> <span class="svelte-1mhlzty">～</span> <input type="number" min="0" max="13" class="svelte-1mhlzty"></div> <div class="atk_range svelte-1mhlzty"><span class="svelte-1mhlzty">攻</span> <input type="number" min="0" max="5000" step="100" class="svelte-1mhlzty"> <span class="svelte-1mhlzty">～</span> <input type="number" min="0" max="5000" step="100" class="svelte-1mhlzty"></div> <div class="def_range svelte-1mhlzty"><span class="svelte-1mhlzty">守</span> <input type="number" min="0" max="5000" step="100" class="svelte-1mhlzty"> <span class="svelte-1mhlzty">～</span> <input type="number" min="0" max="5000" step="100" class="svelte-1mhlzty"></div> <div class="atk_plus_def svelte-1mhlzty"><span class="svelte-1mhlzty">攻+守</span> <input type="number" min="0" max="10000" step="100" class="svelte-1mhlzty"></div></div></div>',1),bn=l('<label class="svelte-1mhlzty"><input type="checkbox" class="search_condition svelte-1mhlzty"> </label>'),kn=l('<div class="deck_editor_search_box_row svelte-1mhlzty"><div class="svelte-1mhlzty"><button class="search_condition_title black_button svelte-1mhlzty">魔法</button></div> <div class="svelte-1mhlzty"></div></div>'),xn=l('<label class="svelte-1mhlzty"><input type="checkbox" class="search_condition svelte-1mhlzty"> </label>'),wn=l('<div class="deck_editor_search_box_row svelte-1mhlzty"><div class="svelte-1mhlzty"><button class="search_condition_title black_button svelte-1mhlzty">罠</button></div> <div class="svelte-1mhlzty"></div></div>'),Cn=l('<label class="svelte-1mhlzty"><input type="checkbox" class="search_condition svelte-1mhlzty"> </label>'),Dn=l('<div class="deck_editor_card_detail svelte-1mhlzty"><!></div>'),$n=l("<div>カード情報読込中</div>"),Sn=l("<option> </option>"),Tn=l('<div class="svelte-1mhlzty"><a class="white_button svelte-1mhlzty" download="SVS_DeckInfos.json">ダウンロード</a></div>'),Mn=l('<div class="svelte-1mhlzty"></div>'),zn=l('<div class="svelte-1mhlzty"><a class="white_button svelte-1mhlzty" download="SVS_DeckInfos.json">ダウンロード(一括)</a></div>'),jn=l('<div class="svelte-1mhlzty"></div>'),En=l('<div class="deck_editor_body_right_header svelte-1mhlzty"><div class="deck_editor_body_right_header_row svelte-1mhlzty"><div class="svelte-1mhlzty">編集対象</div> <div class="svelte-1mhlzty"><select style="width:100%" class="svelte-1mhlzty"></select></div></div> <div class="deck_editor_body_right_header_row svelte-1mhlzty"><div class="svelte-1mhlzty">新規名称</div> <div class="svelte-1mhlzty"><input type="text" style="width:100%" class="svelte-1mhlzty"></div></div> <div class="deck_editor_body_right_header_row svelte-1mhlzty"></div> <div class="deck_editor_body_right_header_row svelte-1mhlzty"><div class="svelte-1mhlzty">基本操作</div> <div class="svelte-1mhlzty"><button class="white_button svelte-1mhlzty">デッキを保存</button></div> <div class="svelte-1mhlzty"><button class="white_button svelte-1mhlzty">デッキを複製</button></div> <div class="svelte-1mhlzty"><button class="white_button svelte-1mhlzty" title="shiftキー押下で確認メッセージスキップ">デッキを削除</button></div></div> <div class="deck_editor_body_right_header_row svelte-1mhlzty"><div class="svelte-1mhlzty">DL/UL</div> <!> <!> <div class="svelte-1mhlzty"><button class="white_button svelte-1mhlzty">アップロード</button></div></div></div> <div><!></div>',1),Bn=l("<div>デッキ情報読込中</div>"),An=l('<div class="deck_editor_body_right_dummy svelte-1mhlzty"></div>'),Ln=l("<div><!></div>"),Yn=l('<div><div class="deck_editor_header svelte-1mhlzty"></div> <div class="deck_editor_body svelte-1mhlzty"><div class="deck_editor_body_left svelte-1mhlzty"><div role="contentinfo" class="deck_editor_search_box svelte-1mhlzty"><div class="deck_editor_search_box_header svelte-1mhlzty"><div class="svelte-1mhlzty"><button class="deck_editor_search_box_title svelte-1mhlzty">検索条件</button></div> <div class="deck_editor_sort_setting_container svelte-1mhlzty"></div></div> <div class="deck_editor_search_box_body svelte-1mhlzty"><div class="deck_editor_search_box_row svelte-1mhlzty"><div class="svelte-1mhlzty"><button class="search_condition_title black_button svelte-1mhlzty">名称</button></div> <div class="svelte-1mhlzty"><input type="text" style="width:100%" placeholder="※ルビには対応していません" class="svelte-1mhlzty"></div></div> <div class="deck_editor_search_box_row card_kind svelte-1mhlzty"><div class="svelte-1mhlzty"><button class="search_condition_title black_button svelte-1mhlzty">種類</button></div> <div class="svelte-1mhlzty"></div></div> <!> <!> <!> <!> <div class="deck_editor_search_box_row svelte-1mhlzty"><div class="svelte-1mhlzty"><button class="search_condition_title black_button svelte-1mhlzty">その他</button></div> <div class="svelte-1mhlzty"></div></div></div></div> <!></div> <div class="deck_editor_body_center svelte-1mhlzty"><div class="deck_editor_body_center_body svelte-1mhlzty"><!></div></div>  <div class="deck_editor_body_right svelte-1mhlzty"><!></div></div> <div class="footer svelte-1mhlzty"></div></div> <!> <!>',1);function qn(_,i){ct(i,!1);const t=[],v=[],m=[],c=[],u=[],d=[],Y=[],R=[],S=Da.createModalController({onDragStart:{append:()=>{},remove:()=>{}},onDragEnd:{append:()=>{},remove:()=>{}}}),D={name:"",deckCardKinds:[...ea],exMonsterCategories:[...ta],monsterCategories:qa.filter(y=>!ta.includes(y)),monsterAttributes:[...Ya],monsterTypes:[...La],spellCategories:Aa.filter(y=>y!=="PendulumScale"),trapCategories:[...Ba],starLowerBound:0,starUpperBound:13,atkLowerBound:0,atkUpperBound:5e3,defLowerBound:0,defUpperBound:5e3,atkPlusDef:void 0,others:["test","oldVersion","implemented"],sort:[...Ua]},n=_e(structuredClone(D));xe(n,e(n).others=["oldVersion"]),xe(n,e(n).monsterCategories=["Effect","Tuner","Pendulum"]);let A=_e("DeckEdit"),Q=_e("SearchCondition");const G=()=>{if(!e(n).deckCardKinds.length){Wt(e(n)).forEach(y=>{Array.isArray(e(n)[y])&&Array.isArray(D[y])?xe(n,e(n)[y]=[...D[y]]):xe(n,e(n)[y]=D[y])});return}xe(n,e(n).name=""),xe(n,e(n).deckCardKinds=[]),xe(n,e(n).exMonsterCategories=[]),xe(n,e(n).monsterCategories=[]),xe(n,e(n).monsterAttributes=[]),xe(n,e(n).monsterTypes=[]),xe(n,e(n).spellCategories=[]),xe(n,e(n).trapCategories=[]),xe(n,e(n).others=[]),xe(n,e(n).atkLowerBound=0),xe(n,e(n).atkUpperBound=5e3),xe(n,e(n).defLowerBound=0),xe(n,e(n).defUpperBound=5e3),xe(n,e(n).atkPlusDef=void 0),xe(n,e(n).sort=[...Ua])},U=y=>{y.forEach(h=>{Array.isArray(e(n)[h])&&Array.isArray(D[h])?xe(n,e(n)[h]=e(n)[h].length?[]:[...D[h]]):xe(n,e(n)[h]=D[h])})};let z=_e(),ee,ue=_e(!1);const E=200,b=()=>{C(ue,!1),C(z,void 0),ee=void 0},q=(y,h)=>{const O=ua(h),J=e(se).cardTree[O].filter(Ye=>Ye.name===h.name).length;let ye=y.shiftKey?3-J:1;console.debug(h,O,J,ye),!y.ctrlKey&&J>2&&(ye=0),ye&&xe(se,e(se).cardTree[O]=[...e(se).cardTree[O],...Array(ye).fill(h)].sort(Ga)),b(),T(h)},ne=(y,h)=>{const O=ua(h);let J=0;xe(se,e(se).cardTree[O]=e(se).cardTree[O].filter(ye=>ye.name!==h.name?!0:(J++,!y.shiftKey&&J>1))),b(),T(h)},Ce=y=>{if(y.changedTouches&&y.changedTouches.length!==1)return;const{clientX:h,clientY:O}=y.changedTouches?y.changedTouches[0]:y;return{clientX:h,clientY:O}},he={onCardAppend:q,onCardRemove:ne,onCardDragCancel:b,onCardDragStart:(y,h,O)=>{if(T(O),h!=="List"&&h!=="Deck"){b();return}if(h==="List"&&!O.isImplemented){b();return}const J=Ce(y);if(!J){b();return}ee={from:h,cardInfo:O,pos:J,startPos:J},Kt(E).then(()=>{(ee==null?void 0:ee.cardInfo)===O&&C(z,ee)}),C(ue,!1)},onCardDragging:(y,h)=>{if(e(z)&&y.preventDefault&&y.preventDefault(),e(z)&&y.stopPropagation&&y.stopPropagation(),!ee){b();return}const O=Ce(y);if(!O){b();return}const J=e(z)||ee;C(ue,!!(J.from==="List"&&J.cardInfo.isImplemented&&document.elementsFromPoint(O.clientX,O.clientY).some(ye=>ye.classList.contains("deck_editor_body_right_body")||ye.classList.contains("deck_editor_body_right_dummy")))),e(ue)&&C(A,"DeckEdit"),e(z)?C(z,{...e(z),pos:O}):ee.pos={...O}},onCardDragEnd:y=>{if(!ee||!e(z)){b();return}const h=Ce(y);if(!h){b();return}e(z).from==="List"&&e(z).cardInfo.isImplemented&&document.elementsFromPoint(h.clientX,h.clientY).some(O=>O.classList.contains("deck_editor_body_right_body"))&&q(y,e(z).cardInfo),e(z).from==="Deck"&&!document.elementsFromPoint(h.clientX,h.clientY).some(O=>O.classList.contains("deck_editor_body_right_body"))&&ne(y,e(z).cardInfo),b()}},fe=(y,h,O)=>{Array.isArray(e(n)[h])&&Array.isArray(D[h])&&xe(n,e(n)[h]=[O])},ie=async()=>{const h=(await e(H)).find(J=>J.id===e(De));if(!h)return;const O=await oa;C(se,{...h,cardTree:Cr(h.cardNames.map(J=>{const ye=O.getCardInfo(J);return ye===void 0&&console.error(J),ye}).filter(J=>J!==void 0))})},je=()=>Dt.getAllDeckInfo().then(y=>(C(De,(y.find(h=>h.lastUsedAt.getTime()===Math.max(...y.map(O=>O.lastUsedAt.getTime())))??y[0]).id),y));let De=_e(-1),H=_e(je()),W=_e(e(H).then(y=>Dt.convertToObjectURL(y)));e(H).then(ie);const pe=()=>{C(H,je()),C(W,e(H).then(y=>Dt.convertToObjectURL(y))),ie()};let se=_e({id:-Number.MAX_VALUE,name:"",description:"",lastUsedAt:new Date,cardTree:{ExtraMonster:[],Monster:[],Spell:[],Trap:[]}}),Me=_e(void 0),j=0;const T=y=>{C(Q,"CardDetail"),y.cardId!==void 0&&!y.description&&!y.pendulumDescription&&(j=y.cardId,ka([y.cardId]).then(()=>{y.cardId===j&&C(Me,y)})),C(Me,y)},P=async()=>{const h=(await e(H)).find(O=>O.id===e(De));if(!h)throw new Error("illegal state");return h},X=async()=>{const y=await P();await y.saveDeckInfo({...y,name:e(se).name,cardNames:Object.values(e(se).cardTree).flatMap(h=>h).map(h=>h.name),lastUsedAt:new Date}),pe()},te=async()=>{(await Dt.createNewDeck(`デッキ_${new Date().formatToYYYYMMDD_HHMMSS("","","")}`,`コピー日時：${new Date().formatToYYYYMMDD_HHMMSS("-"," ",":")}`,Object.values(e(se).cardTree).flatMap(h=>h).map(h=>h.name))).saveDeckInfo(),pe()},k=async y=>{const h=await P();!y.shiftKey&&!confirm(`デッキ【${h.name}】を削除します。
よろしいですか？`)||(await h.delete(),pe())},$=async()=>{const y=await S.deckUploader.show({title:"デッキ情報アップロード",position:"Middle",cancelable:!0});if(!y)return;const h=[];if(y.replaceAll){if(!confirm(`既存デッキ情報を全て削除し、アップロードしたファイルに置き換えます。
よろしいですか？`))return;h.push(...(await e(H)).map(O=>O.id))}await Promise.all(y.deckInfos.map(O=>Dt.createNewDeck(O.name,O.description,O.cardNames,O.lastUsedAt))),h.length&&await Promise.all(h.map(Dt.remove)),pe()},B=()=>innerWidth<=1400?"compact":"wide";_t();var F=Yn(),I=N(F),de=s(a(I),2),M=a(de),x=a(M),o=a(x),f=a(o),L=a(f),K=s(f,2);ce(K,5,()=>e(n).sort,me,(y,h,O)=>{var J=_n(),ye=a(J);p(()=>{ze(J,`deck_editor_sort_setting_item ${e(h).order??""} priority_${e(h).priority??""} svelte-1mhlzty`),g(ye,`${wr[e(h).key]??""}
                ${(e(h).order==="asc"?"▲":"▼")??""}`)}),Z("click",J,()=>{e(n).sort.forEach(Ye=>Ye.priority++),e(h).order=e(h).order==="asc"?"desc":"asc",Ht(()=>e(n).sort),e(h).priority=1,Ht(()=>e(n).sort)}),r(y,J)});var ge=s(o,2),be=a(ge),oe=a(be),ae=a(oe),V=s(oe,2),re=a(V),Se=s(be,2),He=a(Se),Ne=a(He),Fe=s(He,2);ce(Fe,5,()=>ea,me,(y,h)=>{var O=un(),J=a(O),ye,Ye=s(J);p(()=>{ye!==(ye=e(h))&&(J.value=(J.__value=e(h))==null?"":e(h)),g(Ye,` ${Xa[e(h)]??""}`)}),Nt(t,[],J,()=>(e(h),e(n).deckCardKinds),Te=>xe(n,e(n).deckCardKinds=Te)),r(y,O)});var Ae=s(Se,2);{var Ve=y=>{var h=pn(),O=a(h),J=a(O),ye=s(O,2);ce(ye,5,()=>ta,me,(Ye,Te)=>{var Re=fn(),Oe=a(Re),We,Ze=s(Oe);p(()=>{We!==(We=e(Te))&&(Oe.value=(Oe.__value=e(Te))==null?"":e(Te)),g(Ze,` ${va[e(Te)]??""}${ca[e(Te)]??""}`)}),Nt(v,[],Oe,()=>(e(Te),e(n).exMonsterCategories),dt=>xe(n,e(n).exMonsterCategories=dt)),r(Ye,Re)}),Z("click",J,()=>U(["exMonsterCategories"])),le(3,h,()=>we,()=>({delay:0,duration:100})),r(y,h)};w(Ae,y=>{e(n).deckCardKinds.includes("ExtraMonster")&&y(Ve)})}var nt=s(Ae,2);{var Be=y=>{var h=hn(),O=N(h),J=a(O),ye=a(J),Ye=s(J,2);ce(Ye,5,()=>qa.filter(qe=>!ta.includes(qe)),me,(qe,Pe)=>{var rt=mn(),et=a(rt),Ct,Pt=s(et);p(()=>{Ct!==(Ct=e(Pe))&&(et.value=(et.__value=e(Pe))==null?"":e(Pe)),g(Pt,` ${va[e(Pe)]??""}${ca[e(Pe)]??""}`)}),Nt(m,[],et,()=>(e(Pe),e(n).monsterCategories),It=>xe(n,e(n).monsterCategories=It)),r(qe,rt)});var Te=s(O,2),Re=a(Te),Oe=a(Re),We=s(Re,2);ce(We,5,()=>Ya,me,(qe,Pe)=>{var rt=yn(),et=a(rt),Ct,Pt=s(et,2),It=s(Pt);p(()=>{Ct!==(Ct=e(Pe))&&(et.value=(et.__value=e(Pe))==null?"":e(Pe)),ze(Pt,`monster_attr ${e(Pe)??""} svelte-1mhlzty`),g(It,` ${$a[e(Pe)]??""}`)}),Nt(c,[],et,()=>(e(Pe),e(n).monsterAttributes),Ja=>xe(n,e(n).monsterAttributes=Ja)),r(qe,rt)});var Ze=s(Te,2),dt=a(Ze),qt=a(dt),Mt=s(dt,2);ce(Mt,5,()=>La,me,(qe,Pe)=>{var rt=gn(),et=a(rt),Ct,Pt=s(et);p(()=>{Ct!==(Ct=e(Pe))&&(et.value=(et.__value=e(Pe))==null?"":e(Pe)),g(Pt,` ${ma[e(Pe)]??""}
                    ${Sa[e(Pe)]??""}`)}),Nt(u,[],et,()=>(e(Pe),e(n).monsterTypes),It=>xe(n,e(n).monsterTypes=It)),Z("dblclick",rt,It=>fe(It,"monsterTypes",e(Pe))),r(qe,rt)});var wt=s(Ze,2),yt=a(wt),mt=a(yt),Ut=s(yt,2),Et=a(Ut),Ft=s(a(Et),2),Gt=s(Ft,4),lt=s(Et,2),Xe=s(a(lt),2),ot=s(Xe,4),gt=s(lt,2),ht=s(a(gt),2),Qt=s(ht,4),Ge=s(gt,2),at=s(a(Ge),2);Z("click",ye,()=>U(["monsterCategories"])),le(3,O,()=>we,()=>({delay:0,duration:100})),Z("click",Oe,()=>U(["monsterAttributes"])),le(3,Te,()=>we,()=>({delay:0,duration:100})),Z("click",qt,()=>U(["monsterTypes"])),le(3,Ze,()=>we,()=>({delay:0,duration:100})),Z("click",mt,()=>U(["starLowerBound","starUpperBound","atkLowerBound","atkUpperBound","defLowerBound","defUpperBound","atkPlusDef"])),zt(Ft,()=>e(n).starLowerBound,qe=>xe(n,e(n).starLowerBound=qe)),zt(Gt,()=>e(n).starUpperBound,qe=>xe(n,e(n).starUpperBound=qe)),zt(Xe,()=>e(n).atkLowerBound,qe=>xe(n,e(n).atkLowerBound=qe)),zt(ot,()=>e(n).atkUpperBound,qe=>xe(n,e(n).atkUpperBound=qe)),zt(ht,()=>e(n).defLowerBound,qe=>xe(n,e(n).defLowerBound=qe)),zt(Qt,()=>e(n).defUpperBound,qe=>xe(n,e(n).defUpperBound=qe)),zt(at,()=>e(n).atkPlusDef,qe=>xe(n,e(n).atkPlusDef=qe)),le(3,wt,()=>we,()=>({delay:0,duration:100})),r(y,h)};w(nt,y=>{(e(n).deckCardKinds.includes("Monster")||e(n).deckCardKinds.includes("ExtraMonster"))&&y(Be)})}var ke=s(nt,2);{var Ee=y=>{var h=kn(),O=a(h),J=a(O),ye=s(O,2);ce(ye,5,()=>Aa.filter(Ye=>Ye!=="PendulumScale"),me,(Ye,Te)=>{var Re=bn(),Oe=a(Re),We,Ze=s(Oe);p(()=>{We!==(We=e(Te))&&(Oe.value=(Oe.__value=e(Te))==null?"":e(Te)),g(Ze,` ${ya[e(Te)]??""}`)}),Nt(d,[],Oe,()=>(e(Te),e(n).spellCategories),dt=>xe(n,e(n).spellCategories=dt)),r(Ye,Re)}),Z("click",J,()=>U(["spellCategories"])),le(3,h,()=>we,()=>({delay:0,duration:100})),r(y,h)};w(ke,y=>{e(n).deckCardKinds.includes("Spell")&&y(Ee)})}var Le=s(ke,2);{var Ie=y=>{var h=wn(),O=a(h),J=a(O),ye=s(O,2);ce(ye,5,()=>Ba,me,(Ye,Te)=>{var Re=xn(),Oe=a(Re),We,Ze=s(Oe);p(()=>{We!==(We=e(Te))&&(Oe.value=(Oe.__value=e(Te))==null?"":e(Te)),g(Ze,` ${ga[e(Te)]??""}`)}),Nt(Y,[],Oe,()=>(e(Te),e(n).trapCategories),dt=>xe(n,e(n).trapCategories=dt)),r(Ye,Re)}),Z("click",J,()=>U(["trapCategories"])),le(3,h,()=>we,()=>({delay:0,duration:100})),r(y,h)};w(Le,y=>{e(n).deckCardKinds.includes("Trap")&&y(Ie)})}var tt=s(Le,2),Ke=a(tt),Je=a(Ke),$t=s(Ke,2);ce($t,4,()=>[{key:"test",text:"テスト用カード"},{key:"oldVersion",text:"エラッタ前カード"},{key:"implemented",text:"未実装カード"}],me,(y,h)=>{var O=Cn(),J=a(O),ye,Ye=s(J);p(()=>{ye!==(ye=h.key)&&(J.value=(J.__value=h.key)==null?"":h.key),g(Ye,` ${h.text??""}`)}),Nt(R,[],J,()=>(h.key,e(n).others),Te=>xe(n,e(n).others=Te)),r(y,O)});var vt=s(x,2);{var St=y=>{var h=Dn(),O=a(h);Zi(O,{get cardInfo(){return e(Me)},onAttention:T,cardControlEventHandlers:he,get deckCardTree(){return e(se).cardTree}}),r(y,h)};w(vt,y=>{e(Q)==="CardDetail"&&e(Me)&&y(St)})}var jt=s(M,2),Lt=a(jt),ra=a(Lt);pt(ra,()=>oa,y=>{var h=$n();r(y,h)},(y,h)=>{Ra(y,{mode:"List",get allCardTree(){return e(h).tree},onAttention:T,get searchCondition(){return e(n)},cardControlEventHandlers:he,get deckCardTree(){return e(se).cardTree},set deckCardTree(O){xe(se,e(se).cardTree=O)},$$legacy:!0})});var Yt=s(jt,2),Xt=a(Yt);{var kt=y=>{var h=$e(),O=N(h);pt(O,()=>e(H),J=>{var ye=Bn();r(J,ye)},(J,ye)=>{var Ye=En(),Te=N(Ye),Re=a(Te),Oe=s(a(Re),2),We=a(Oe);p(()=>{e(De),Ht(()=>{e(ye)})}),ce(We,5,()=>e(ye),me,(Ge,at)=>{var qe=Sn(),Pe={},rt=a(qe);p(()=>{Pe!==(Pe=e(at).id)&&(qe.value=(qe.__value=e(at).id)==null?"":e(at).id),g(rt,e(at).name)}),r(Ge,qe)});var Ze=s(Re,2),dt=s(a(Ze),2),qt=a(dt),Mt=s(Ze,4),wt=s(a(Mt),2),yt=a(wt),mt=s(wt,2),Ut=a(mt),Et=s(mt,2),Ft=a(Et),Gt=s(Mt,2),lt=s(a(Gt),2);pt(lt,P,Ge=>{var at=Mn();r(Ge,at)},(Ge,at)=>{var qe=Tn(),Pe=a(qe);p(rt=>it(Pe,"href",rt),[()=>Dt.convertToObjectURL([e(at)])],ve),r(Ge,qe)});var Xe=s(lt,2);pt(Xe,()=>e(W),Ge=>{var at=jn();r(Ge,at)},(Ge,at)=>{var qe=zn(),Pe=a(qe);p(()=>it(Pe,"href",e(at))),r(Ge,qe)});var ot=s(Xe,2),gt=a(ot),ht=s(Te,2),Qt=a(ht);Ra(Qt,{mode:"Deck",allCardTree:{ExtraMonster:[],Monster:[],Spell:[],Trap:[]},onAttention:T,cardControlEventHandlers:he,get deckCardTree(){return e(se).cardTree},set deckCardTree(Ge){xe(se,e(se).cardTree=Ge)},$$legacy:!0}),p(()=>ze(ht,`deck_editor_body_right_body ${(e(ue)?"can_drop":"")??""} svelte-1mhlzty`)),Zt(We,()=>e(De),Ge=>C(De,Ge)),Z("change",We,ie),zt(qt,()=>e(se).name,Ge=>xe(se,e(se).name=Ge)),Z("click",yt,X),Z("click",Ut,te),Z("click",Ft,k),Z("click",gt,$),r(J,Ye)}),r(y,h)},Tt=y=>{var h=An();r(y,h)};w(Xt,y=>{e(A)==="DeckEdit"||B()==="wide"?y(kt):y(Tt,!1)})}var xt=s(I,2);{var sa=y=>{var h=Ln(),O=a(h);Qa(O,{mode:"Dragging",get cardInfo(){return e(z).cardInfo},onAttention:T,cardControlEventHandlers:he}),p(()=>it(h,"style",`position: fixed;
          top:${e(z).pos.clientY??""}px;
          left:${e(z).pos.clientX??""}px;
          z-index:3; 
          filter: opacity(0.8);
        	transform: translateX(-50%) translateY(-50%);`)),r(y,h)};w(xt,y=>{e(z)&&y(sa)})}var ia=s(xt,2);cn(ia,{modalController:S}),p((y,h,O)=>ze(I,`deck_editor
         screen_size_${y??""}
         left_pain_mode_${h??""}
         main_view_mode_${O??""}
         ${(e(z)?"dragging_card":"")??""}
          svelte-1mhlzty`),[B,()=>e(Q).toLowerCase(),()=>e(A).toLowerCase()],ve),Z("click",L,G),Z("click",ae,()=>U(["name"])),zt(re,()=>e(n).name,y=>xe(n,e(n).name=y)),Z("click",Ne,()=>U(["deckCardKinds"])),Z("click",Je,()=>U(["others"])),le(3,tt,()=>we,()=>({delay:0,duration:100})),Z("focusin",x,()=>{C(Q,"SearchCondition"),C(A,"SearchCondition")}),Z("click",x,()=>{C(Q,"SearchCondition"),C(A,"SearchCondition")}),Z("click",Yt,()=>{C(A,"DeckEdit")}),Z("focusin",Yt,()=>{C(A,"DeckEdit")}),Z("touchmove",I,y=>e(z)&&he.onCardDragging(y,"Overlay")),Z("mousemove",I,y=>e(z)&&he.onCardDragging(y,"Overlay")),r(_,F),ut()}const Un=["TblDeckHeader","TblDeckDetail","TblDuelistProfile"],Pn=3;var Nn=l('<input class="game_mode_radio svelte-sy4ydn" type="radio" name="game_mode"> <label> </label>',1),Hn=l('<option class="svelte-sy4ydn"> </option>'),Fn=l('<option class="svelte-sy4ydn"> </option>'),In=l('<option class="svelte-sy4ydn"> </option>'),On=l('<tr class="config_row svelte-sy4ydn"><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><label for="npc_deck_selector" class="config_row_label deck_selector svelte-sy4ydn">デッキ：</label></div></td><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><select id="npc_deck_selector" class="deck_selector svelte-sy4ydn"><option class="svelte-sy4ydn">デフォルト</option><!></select></div></td></tr>'),Rn=l('<option class="svelte-sy4ydn"> </option>'),Wn=l('<tr class="config_row svelte-sy4ydn"><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><label for="npc_selector" class="config_row_label npc_selector svelte-sy4ydn">対戦相手：</label></div></td><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><select id="npc_selector" class="npc_selector svelte-sy4ydn"></select> <div class="svelte-sy4ydn"> </div></div></td></tr> <!> <tr class="config_row svelte-sy4ydn"><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><label for="npc_selector" class="config_row_label npc_selector svelte-sy4ydn">先攻後攻：</label></div></td><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><select id="npc_selector" class="npc_selector svelte-sy4ydn"></select></div></td></tr>',1),Kn=l('<option class="svelte-sy4ydn"> </option>'),Vn=l('<tr class="config_row svelte-sy4ydn"><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><label for="difficulty_selector" class="config_row_label difficulty_selector svelte-sy4ydn">難易度：</label></div></td><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><select id="difficulty_selector" class="difficulty_selector svelte-sy4ydn"></select></div></td></tr>'),Xn=l('<tr class="config_row svelte-sy4ydn"><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><label class="config_row_label svelte-sy4ydn" for="game_mode_radio_preset">ゲームモード：</label></div></td><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"></div></td></tr> <tr class="config_row svelte-sy4ydn"><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><label for="deck_selector" class="config_row_label deck_selector svelte-sy4ydn">デッキ：</label></div></td><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><select id="deck_selector" class="deck_selector svelte-sy4ydn"></select></div></td></tr> <!> <tr><td colspan="2" class="svelte-sy4ydn"><div><button class="btn svelte-sy4ydn">duel start!</button></div></td></tr>',1),Gn=l('<tr><td colspan="2" class="svelte-sy4ydn"><div>デッキ情報の読み込み、もしくは作成中...</div></td></tr>'),Qn=l('<tr><td colspan="2" class="svelte-sy4ydn"><div><button class="btn svelte-sy4ydn">deck edit</button></div></td></tr>'),Jn=l('<tr class="config_row svelte-sy4ydn"><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><label for="duelist_name" class="config_row_label duelist_name svelte-sy4ydn">名前：</label></div></td><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><input id="duelist_name" class="duelist_name svelte-sy4ydn" type="text"></div></td></tr> <!> <!>',1),Zn=l('<tr><td colspan="2" class="svelte-sy4ydn"><div>デュエリスト情報の読み込み、もしくは作成中...</div></td></tr>'),el=l('<div class="app_body svelte-sy4ydn"><table class="config_table svelte-sy4ydn"><tbody><!></tbody></table></div>'),tl=l('<span class="svelte-sy4ydn"> </span> <span class="svelte-sy4ydn"> </span>',1),al=l('<div class="result_title result_win svelte-sy4ydn">YOU WIN</div>'),rl=l('<div class="result_title result_lose svelte-sy4ydn">YOU LOSE</div>'),sl=l('<div class="result_title result_draw svelte-sy4ydn">DRAW</div>'),il=l('<div class="twitter_share_button_wrapper svelte-sy4ydn"><a rel="nofollow" target="_blank" class="twitter_share_button svelte-sy4ydn">X(twitter)でシェアする</a></div>'),nl=l('<div class="result svelte-sy4ydn"><!> <div class="reason_of_end svelte-sy4ydn"> </div> <!> <div class="svelte-sy4ydn"><button class="white_button svelte-sy4ydn">TOPへ戻る</button></div></div>'),ll=l('<main style="flex-direction: column; display :flex" class="svelte-sy4ydn"><div class="link link_left svelte-sy4ydn"><a href="https://github.com/Setta238/stk_ygo_svelte" target="_blank" rel="noopener noreferrer" title="repository" class="svelte-sy4ydn">repository</a> <a href="https://x.com/ninja_no" target="_blank" rel="noopener noreferrer" title="repository" class="svelte-sy4ydn">X(Twitter)</a> <a href="https://posfie.com/@ninja_no/p/Lx7FLj3" target="_blank" rel="noopener noreferrer" title="posfie" class="svelte-sy4ydn">posfie(toggeter)</a></div> <div class="link link_right svelte-sy4ydn"><a class="a_button svelte-sy4ydn" role="button" tabindex="0">TOPへ戻る</a> <a href="/stk_ygo_svelte/note.html" target="_blank" rel="noopener noreferrer" title="repository" class="svelte-sy4ydn">現時点とこの先のこと</a></div> <!> <div class="footer card_summary svelte-sy4ydn"><!></div> <div class="footer debug_info svelte-sy4ydn"><span class="svelte-sy4ydn"> </span> <span class="user_agent_info svelte-sy4ydn"> </span> <span class="screen_info svelte-sy4ydn"> </span></div> <!></main>');function ol(_,i){ct(i,!1);const t=new Dr("stk_ygo_svelte",Pn,Un);let v=_e(0),m=_e(0),c=_e(),u=_e("FtkChallenge"),d=_e("None"),Y=_e(0),R=_e(""),S=_e(void 0);const D="https://setta238.github.io/stk_ygo_svelte/",n="遊戯王deそりてあ",A="ninja_no",Q=$r.getOrCreateNew(t).then(M=>(C(u,Pa.includes(M.previousGameMode)?M.previousGameMode:"FtkChallenge"),je(M.previousNpcId),M)),G=M=>{var o;const x=M.find(f=>f.lastUsedAt.getTime()===Math.max(...M.map(L=>L.lastUsedAt.getTime())))??M[0];C(Y,x.id),e(u)==="FtkChallenge"&&x.deckType!=="Preset"&&C(Y,((o=Ot.find(f=>f.deckType==="Preset"))==null?void 0:o.id)??e(Y))};let U=_e(Dt.getAllDeckInfo(t).then(M=>(Promise.all(M.filter(x=>!x.lastUsedAt).map(x=>{x.saveDeckInfo()})),G(M),M)));const z=async()=>{const M=e(Y);let x=(await e(U)).find(f=>f.id===M)??(await ue()).find(f=>f.id===M);x&&await x.updateTimestamp();let o=x;if(o||(o=Ot.find(f=>f.id===M)),!o)throw new Error("illegal state");return o},ee=async()=>{(await Q).save({previousGameMode:e(u)})},ue=()=>(C(U,Dt.getAllDeckInfo(t).then(M=>(G(M),M))),e(U)),E=async()=>{(await e(U)).length||(await Dt.prepareSampleDeck(),ue())},b=async()=>{await Promise.all([ee(),E()]);const M=await z(),x=await Q;let o=Jt.find(K=>K.id===Number.MIN_SAFE_INTEGER)??Jt[0],f=Ot.find(K=>K.id===Number.MIN_SAFE_INTEGER)??Ot[0],L="PlayFirst";e(u)==="FtkChallenge"?o=Jt.filter(K=>K.npcType==="FtkChallenge").find(K=>K.difficulty===x.previousDifficulty)??o:e(u)==="Free"&&(o=Jt.find(K=>K.id===x.previousNpcId)??o,f=Ot.slice(-1)[0],L=x.previousStartMode),o.npcType!=="FtkChallenge"&&x.previousNpcDeckId>-1?f=(await e(U)).find(K=>K.id===x.previousNpcDeckId)??f:f=Ot.find(K=>K.id===o.id)??f,C(c,new Mr(x,"Player",M,[],o,"NPC",f,[],L)),e(c).onDuelEnd.append(()=>(C(c,e(c)),"RemoveMe"))},q=async()=>{await Promise.all([ee(),E()]),C(d,"DeckEdit")},ne=async M=>{await ee(),M.key==="Enter"&&!M.repeat&&(await Q).save()},Ce=()=>{C(U,ue()),C(c,void 0),C(d,"None")};let he=Date.now();const fe=M=>{Date.now()-he<200||(he=Date.now(),C(u,M),ue())},ie=M=>{je(Number(M.currentTarget.value))},je=M=>{var x;C(S,Jt.find(o=>o.id===M)),C(R,((x=e(S))==null?void 0:x.description)??"")};E(),_t();var De=ll(),H=s(a(De),2),W=a(H),pe=s(H,2);{var se=M=>{var x=$e(),o=N(x);pt(o,()=>Q,null,(f,L)=>{$i(f,{get duel(){return e(c)},get userProfile(){return e(L)}})}),r(M,x)},Me=M=>{var x=$e(),o=N(x);{var f=K=>{qn(K,{})},L=K=>{var ge=el(),be=a(ge),oe=a(be),ae=a(oe);pt(ae,()=>Q,V=>{var re=Zn();r(V,re)},(V,re)=>{var Se=Jn(),He=N(Se),Ne=a(He),Fe=a(Ne),Ae=s(Ne),Ve=a(Ae),nt=a(Ve),Be=s(He,2);pt(Be,()=>e(U),Le=>{var Ie=Gn();r(Le,Ie)},(Le,Ie)=>{var tt=Xn(),Ke=N(tt),Je=a(Ke),$t=a(Je),vt=s(Je),St=a(vt);ce(St,5,()=>Pa,me,(J,ye)=>{var Ye=Nn(),Te=N(Ye),Re=s(Te,2),Oe=a(Re);p(We=>{it(Te,"id",`game_mode_radio_${We??""}`),Sr(Te,e(ye)),Tr(Te,e(u)===e(ye)),ze(Re,`game_mode_tab_label game_mode_tab_${We??""} svelte-sy4ydn`),it(Re,"for",`game_mode_radio_${We??""}`),g(Oe,e(ye))},[()=>e(ye).toLowerCase()],ve),Z("change",Te,()=>fe(e(ye))),r(J,Ye)});var jt=s(Ke,2),Lt=a(jt),ra=a(Lt),Yt=s(Lt),Xt=a(Yt),kt=a(Xt);p(()=>{e(Y),Ht(()=>{e(u),e(Ie)})}),ce(kt,5,()=>e(u)==="FtkChallenge"?Ot.filter(J=>J.deckType==="Preset"):e(Ie),me,(J,ye)=>{var Ye=Hn(),Te={},Re=a(Ye);p(()=>{Te!==(Te=e(ye).id)&&(Ye.value=(Ye.__value=e(ye).id)==null?"":e(ye).id),g(Re,e(ye).name)}),r(J,Ye)});var Tt=s(jt,2);{var xt=J=>{var ye=Wn(),Ye=N(ye),Te=a(Ye),Re=a(Te),Oe=s(Te),We=a(Oe),Ze=a(We);p(()=>{e(re),Ht(()=>{})}),ce(Ze,5,()=>Jt,me,(lt,Xe)=>{var ot=Fn(),gt={},ht=a(ot);p(()=>{gt!==(gt=e(Xe).id)&&(ot.value=(ot.__value=e(Xe).id)==null?"":e(Xe).id),g(ht,e(Xe).name)}),r(lt,ot)});var dt=s(Ze,2),qt=a(dt),Mt=s(Ye,2);{var wt=lt=>{var Xe=On(),ot=a(Xe),gt=a(ot),ht=s(ot),Qt=a(ht),Ge=a(Qt);p(()=>{e(re),Ht(()=>{e(Ie)})});var at=a(Ge);at.value=(at.__value=Number.MIN_SAFE_INTEGER)==null?"":Number.MIN_SAFE_INTEGER;var qe=s(at);ce(qe,1,()=>e(Ie),me,(Pe,rt)=>{var et=In(),Ct={},Pt=a(et);p(()=>{Ct!==(Ct=e(rt).id)&&(et.value=(et.__value=e(rt).id)==null?"":e(rt).id),g(Pt,e(rt).name)}),r(Pe,et)}),le(3,gt,()=>we,()=>({duration:200})),le(3,ot,()=>we,()=>({duration:200})),Zt(Ge,()=>e(re).previousNpcDeckId,Pe=>e(re).previousNpcDeckId=Pe),le(3,Qt,()=>we,()=>({duration:200})),le(3,ht,()=>we,()=>({duration:200})),le(3,Xe,()=>we,()=>({duration:200})),r(lt,Xe)};w(Mt,lt=>{var Xe;((Xe=e(S))==null?void 0:Xe.npcType)!=="FtkChallenge"&&lt(wt)})}var yt=s(Mt,2),mt=a(yt),Ut=a(mt),Et=s(mt),Ft=a(Et),Gt=a(Ft);p(()=>{e(re),Ht(()=>{})}),ce(Gt,5,()=>Wt(Na),me,(lt,Xe)=>{var ot=Rn(),gt={},ht=a(ot);p(()=>{gt!==(gt=e(Xe))&&(ot.value=(ot.__value=e(Xe))==null?"":e(Xe)),g(ht,Na[e(Xe)])}),r(lt,ot)}),p(()=>g(qt,`※${e(R)??""}`)),le(3,Re,()=>we,()=>({duration:200})),le(3,Te,()=>we,()=>({duration:200})),Z("change",Ze,ie),Zt(Ze,()=>e(re).previousNpcId,lt=>e(re).previousNpcId=lt),le(3,We,()=>we,()=>({duration:200})),le(3,Oe,()=>we,()=>({duration:200})),le(3,Ye,()=>we,()=>({duration:200})),le(3,Ut,()=>we,()=>({duration:200})),le(3,mt,()=>we,()=>({duration:200})),Zt(Gt,()=>e(re).previousStartMode,lt=>e(re).previousStartMode=lt),le(3,Ft,()=>we,()=>({duration:200})),le(3,Et,()=>we,()=>({duration:200})),le(3,yt,()=>we,()=>({duration:200})),r(J,ye)},sa=J=>{var ye=$e(),Ye=N(ye);{var Te=Re=>{var Oe=Vn(),We=a(Oe),Ze=a(We),dt=s(We),qt=a(dt),Mt=a(qt);p(()=>{e(re),Ht(()=>{})}),ce(Mt,5,()=>zr,me,(wt,yt)=>{var mt=Kn(),Ut={},Et=a(mt);p(()=>{Ut!==(Ut=e(yt))&&(mt.value=(mt.__value=e(yt))==null?"":e(yt)),g(Et,e(yt))}),r(wt,mt)}),le(3,Ze,()=>we,()=>({duration:200})),le(3,We,()=>we,()=>({duration:200})),Zt(Mt,()=>e(re).previousDifficulty,wt=>e(re).previousDifficulty=wt),le(3,qt,()=>we,()=>({duration:200})),le(3,dt,()=>we,()=>({duration:200})),le(3,Oe,()=>we,()=>({duration:200})),r(Re,Oe)};w(Ye,Re=>{e(u)==="FtkChallenge"&&Re(Te)},!0)}r(J,ye)};w(Tt,J=>{e(u)==="Free"?J(xt):J(sa,!1)})}var ia=s(Tt,2),y=a(ia),h=a(y),O=a(h);le(3,$t,()=>we,()=>({duration:200})),le(3,Je,()=>we,()=>({duration:200})),le(3,St,()=>we,()=>({duration:200})),le(3,vt,()=>we,()=>({duration:200})),le(3,Ke,()=>we,()=>({duration:200})),le(3,ra,()=>we,()=>({duration:200})),le(3,Lt,()=>we,()=>({duration:200})),Zt(kt,()=>e(Y),J=>C(Y,J)),le(3,Xt,()=>we,()=>({duration:200})),le(3,Yt,()=>we,()=>({duration:200})),le(3,jt,()=>we,()=>({duration:200})),Z("click",O,b),le(3,h,()=>we,()=>({duration:200})),r(Le,tt)});var ke=s(Be,2);{var Ee=Le=>{var Ie=Qn(),tt=a(Ie),Ke=a(tt),Je=a(Ke);Z("click",Je,q),le(3,Ke,()=>we,()=>({duration:200})),le(3,tt,()=>we,()=>({duration:200})),le(3,Ie,()=>we,()=>({duration:200})),r(Le,Ie)};w(ke,Le=>{e(u)==="Free"&&Le(Ee)})}le(3,Fe,()=>we,()=>({duration:200})),le(3,Ne,()=>we,()=>({duration:200})),zt(nt,()=>e(re).name,Le=>e(re).name=Le),Z("keypress",nt,ne),le(3,Ve,()=>we,()=>({duration:200})),le(3,Ae,()=>we,()=>({duration:200})),le(3,He,()=>we,()=>({duration:200})),r(V,Se)}),r(K,ge)};w(o,K=>{e(d)==="DeckEdit"?K(f):K(L,!1)},!0)}r(M,x)};w(pe,M=>{e(c)?M(se):M(Me,!1)})}var j=s(pe,2),T=a(j);pt(T,()=>oa,M=>{var x=Qe("読み込み中");r(M,x)},(M,x)=>{var o=tl(),f=N(o),L=a(f),K=s(f,2),ge=a(K);p((be,oe,ae)=>{g(L,`公式DB上のカード${be??""}枚`),g(ge,`実装済カード（効果あり）${oe??""}枚 （効果なし）${ae??""}枚`)},[()=>e(x).knmCount.toLocaleString(),()=>e(x).definitionCount.toLocaleString(),()=>e(x).nonDefinitionCount.toLocaleString()],ve),r(M,o)});var P=s(j,2),X=a(P),te=a(X),k=s(X,2),$=a(k),B=s(k,2),F=a(B),I=s(P,2);{var de=M=>{var x=nl(),o=a(x);{var f=re=>{var Se=$e(),He=N(Se);{var Ne=Ae=>{var Ve=al();r(Ae,Ve)},Fe=Ae=>{var Ve=$e(),nt=N(Ve);{var Be=ke=>{var Ee=rl();r(ke,Ee)};w(nt,ke=>{e(c).winner.seat==="Above"&&ke(Be)},!0)}r(Ae,Ve)};w(He,Ae=>{e(c).winner.seat==="Below"?Ae(Ne):Ae(Fe,!1)})}r(re,Se)},L=re=>{var Se=sl();r(re,Se)};w(o,re=>{e(c).winner?re(f):re(L,!1)})}var K=s(o,2),ge=a(K),be=s(K,2);{var oe=re=>{var Se=il(),He=a(Se);p(()=>it(He,"href",`https://x.com/share?url=${D}&text=${e(c).twitterShareText??""}&hashtags=${n}&via=${A}`)),r(re,Se)};w(be,re=>{e(c).twitterShareText&&re(oe)})}var ae=s(be,2),V=a(ae);p(()=>g(ge,e(c).reasonOfEnd)),Z("click",V,Ce),le(3,x,()=>Br,()=>({delay:200,duration:200})),r(M,x)};w(I,M=>{e(c)&&e(c).isEnded&&M(de)})}p(()=>{g(te,"build at: 20260120_185916"),g($,xa.text),g(F,`w:${e(v)??""}px h:${e(m)??""}px`)}),_a("innerWidth",M=>C(v,M)),_a("innerHeight",M=>C(m,M)),Z("click",W,Ce),r(_,De),ut()}jr(ol,{target:document.getElementById("app")});
