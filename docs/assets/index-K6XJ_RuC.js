var Ga=Object.defineProperty;var Da=d=>{throw TypeError(d)};var Qa=(d,i,t)=>i in d?Ga(d,i,{enumerable:!0,configurable:!0,writable:!0,value:t}):d[i]=t;var dt=(d,i,t)=>Qa(d,typeof i!="symbol"?i+"":i,t),$a=(d,i,t)=>i.has(d)||Da("Cannot "+t);var mt=(d,i,t)=>($a(d,i,"read from private field"),t?t.call(d):i.get(d)),Qt=(d,i,t)=>i.has(d)?Da("Cannot add the same private member more than once"):i instanceof WeakSet?i.add(d):i.set(d,t),_a=(d,i,t,c)=>($a(d,i,"write to private field"),c?c.call(d,t):i.set(d,t),t);import{s as Sa,r as Xa,a as C,b as Ja,l as Za,g as e,d as Ra,p as gt,c as We,m as me,i as ht,t as l,e as a,f as b,h as _,j as oe,k as Ee,n as xt,o as _e,q as r,u as bt,v as xe,D as er,w as De,x as U,y as s,z as ce,A as Pt,B as se,C as ue,E as p,F as tr,G as rt,H as Ft,I as ar,J as rr,K as It,L as kt,M as Xt,N as Wa,O as ga,P as la,Q as ha,R as Jt,S as ra,T as Ka,U as oa,V as va,W as sr,X as ir,Y as nr,Z as lr,_ as or,$ as vr,a0 as dr,a1 as sa,a2 as Ma,a3 as cr,a4 as Ia,a5 as _r,a6 as zt,a7 as fa,a8 as ua,a9 as At,aa as Ta,ab as aa,ac as ur,ad as fr,ae as pr,af as Vt,ag as yr,ah as Dt,ai as mr,aj as gr,ak as hr,al as ja,am as Ba,an as Ea,ao as Aa,ap as La,aq as Ua,ar as br,as as Yt,at as Ut,au as Tt,av as kr,aw as Kt,ax as xr,ay as wr,az as Ya,aA as Wt,aB as qt,aC as Cr,aD as Dr,aE as Na,aF as $r,aG as Sr,aH as Mr}from"../chunk/entity_proc_20260112_140533.js";import"../chunk/json_20260112_140533.js";(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const u of document.querySelectorAll('link[rel="modulepreload"]'))c(u);new MutationObserver(u=>{for(const v of u)if(v.type==="childList")for(const y of v.addedNodes)y.tagName==="LINK"&&y.rel==="modulepreload"&&c(y)}).observe(document,{childList:!0,subtree:!0});function t(u){const v={};return u.integrity&&(v.integrity=u.integrity),u.referrerPolicy&&(v.referrerPolicy=u.referrerPolicy),u.crossOrigin==="use-credentials"?v.credentials="include":u.crossOrigin==="anonymous"?v.credentials="omit":v.credentials="same-origin",v}function c(u){if(u.ep)return;u.ep=!0;const v=t(u);fetch(u.href,v)}})();const Tr=d=>d;function ba(d){const i=d-1;return i*i*i+1}function qa(d){const i=typeof d=="string"&&d.match(/^\s*(-?[\d.]+)([^\s]*)\s*$/);return i?[parseFloat(i[1]),i[2]||"px"]:[d,"px"]}function jr(d,{delay:i=0,duration:t=400,easing:c=Tr}={}){const u=+getComputedStyle(d).opacity;return{delay:i,duration:t,easing:c,css:v=>`opacity: ${v*u}`}}function Br(d,{delay:i=0,duration:t=400,easing:c=ba,x:u=0,y:v=0,opacity:y=0}={}){const o=getComputedStyle(d),q=+o.opacity,Q=o.transform==="none"?"":o.transform,D=q*(1-y),[S,n]=qa(u),[H,Z]=qa(v);return{delay:i,duration:t,easing:c,css:(V,N)=>`
			transform: ${Q} translate(${(1-V)*S}${n}, ${(1-V)*H}${Z});
			opacity: ${q-D*N}`}}function ge(d,{delay:i=0,duration:t=400,easing:c=ba,axis:u="y"}={}){const v=getComputedStyle(d),y=+v.opacity,o=u==="y"?"height":"width",q=parseFloat(v[o]),Q=u==="y"?["top","bottom"]:["left","right"],D=Q.map(F=>`${F[0].toUpperCase()}${F.slice(1)}`),S=parseFloat(v[`padding${D[0]}`]),n=parseFloat(v[`padding${D[1]}`]),H=parseFloat(v[`margin${D[0]}`]),Z=parseFloat(v[`margin${D[1]}`]),V=parseFloat(v[`border${D[0]}Width`]),N=parseFloat(v[`border${D[1]}Width`]);return{delay:i,duration:t,easing:c,css:F=>`overflow: hidden;opacity: ${Math.min(F*20,1)*y};${o}: ${F*q}px;padding-${Q[0]}: ${F*S}px;padding-${Q[1]}: ${F*n}px;margin-${Q[0]}: ${F*H}px;margin-${Q[1]}: ${F*Z}px;border-${Q[0]}-width: ${F*V}px;border-${Q[1]}-width: ${F*N}px;min-${o}: 0`}}function Pa(d,i){for(const t in i)d[t]=i[t];return d}function Er({fallback:d,...i}){const t=new Map,c=new Map;function u(y,o,q){const{delay:Q=0,duration:D=j=>Math.sqrt(j)*30,easing:S=ba}=Pa(Pa({},i),q),n=y.getBoundingClientRect(),H=o.getBoundingClientRect(),Z=n.left-H.left,V=n.top-H.top,N=n.width/H.width,F=n.height/H.height,fe=Math.sqrt(Z*Z+V*V),we=getComputedStyle(o),Se=we.transform==="none"?"":we.transform,k=+we.opacity;return{delay:Q,duration:typeof D=="function"?D(fe):D,easing:S,css:(j,te)=>`
			   opacity: ${j*k};
			   transform-origin: top left;
			   transform: ${Se} translate(${te*Z}px,${te*V}px) scale(${j+(1-j)*N}, ${j+(1-j)*F});
		   `}}function v(y,o,q){return(Q,D)=>(y.set(D.key,Q),()=>{if(o.has(D.key)){const S=o.get(D.key);return o.delete(D.key),u(S,Q,D)}return y.delete(D.key),d&&d(Q,D,q)})}return[v(c,t,!1),v(t,c,!0)]}function Fa(d){return Object.prototype.toString.call(d)==="[object Date]"}function Ar(d){return d}function pa(d){const i=d-1;return i*i*i+1}function ya(d,i){if(d===i||d!==d)return()=>d;const t=typeof d;if(t!==typeof i||Array.isArray(d)!==Array.isArray(i))throw new Error("Cannot interpolate values of different type");if(Array.isArray(d)){const c=i.map((u,v)=>ya(d[v],u));return u=>c.map(v=>v(u))}if(t==="object"){if(!d||!i)throw new Error("Object cannot be null");if(Fa(d)&&Fa(i)){const v=d.getTime(),o=i.getTime()-v;return q=>new Date(v+q*o)}const c=Object.keys(i),u={};return c.forEach(v=>{u[v]=ya(d[v],i[v])}),v=>{const y={};return c.forEach(o=>{y[o]=u[o](v)}),y}}if(t==="number"){const c=i-d;return u=>d+u*c}return()=>i}var Lt,Gt,Zt,Ht;const ka=class ka{constructor(i,t={}){Qt(this,Lt,Sa(void 0));Qt(this,Gt,Sa(void 0));Qt(this,Zt);Qt(this,Ht,null);mt(this,Lt).v=mt(this,Gt).v=i,_a(this,Zt,t)}static of(i,t){const c=new ka(i(),t);return Xa(()=>{c.set(i())}),c}set(i,t){var S;C(mt(this,Gt),i);let{delay:c=0,duration:u=400,easing:v=Ar,interpolate:y=ya}={...mt(this,Zt),...t};if(u===0)return(S=mt(this,Ht))==null||S.abort(),C(mt(this,Lt),i),Promise.resolve();const o=Ja.now()+c;let q,Q=!1,D=mt(this,Ht);return _a(this,Ht,Za(n=>{if(n<o)return!0;if(!Q){Q=!0;const Z=mt(this,Lt).v;q=y(Z,i),typeof u=="function"&&(u=u(Z,i)),D==null||D.abort()}const H=n-o;return H>u?(C(mt(this,Lt),i),!1):(C(mt(this,Lt),q(v(H/u))),!0)})),mt(this,Ht).promise}get current(){return e(mt(this,Lt))}get target(){return e(mt(this,Gt))}set target(i){this.set(i)}};Lt=new WeakMap,Gt=new WeakMap,Zt=new WeakMap,Ht=new WeakMap;let ia=ka;var Lr=l('<div class="phase_display svelte-1boxe40"><span class="svelte-1boxe40"> </span> </div>'),Ur=l('<div class="lifepoint_display svelte-1boxe40"><div class="svelte-1boxe40"> </div> <div class="svelte-1boxe40"> </div></div>'),Yr=(d,i,t)=>i(e(t)),Nr=l('<div class="svelte-1boxe40"><button class="phase_button svelte-1boxe40"> </button></div>'),qr=l("<div><!></div>"),Pr=l('<div class="svelte-1boxe40"><!></div>'),Fr=l("<div><!></div>"),Hr=l('<div class="config_button_wrapper svelte-1boxe40"><button id="config_button" class="svelte-1boxe40">⚙</button></div>'),Or=l("<!> <!> <!> <!>",1),Rr=l('<div style="position: absolute;" class="card_animation_receiver svelte-1boxe40"><!></div>'),Wr=l('<div style="position: absolute; top:0rem" class="svelte-1boxe40">｛効果対象｝</div>'),Kr=l('<!> <div style="position: absolute; display:flex;justify-content: center;"><!></div>',1),Ir=l(" <!> 】",1),zr=l('<div style="position: absolute; bottom:0rem" class="svelte-1boxe40"> <!></div>'),Vr=l("<!> <!>",1),Gr=l('<div class="badge svelte-1boxe40"> </div>'),Qr=l('<div class="card_animation_receiver svelte-1boxe40"><!></div>'),Xr=l("<!> <!> <!> <!>",1),Jr=l('<td><div role="listitem"><!></div></td>');function Zr(d,i){gt(i,!1);let t=We(i,"view",12),c=We(i,"row",8),u=We(i,"column",8),v=We(i,"selectedEntities",28,()=>[]),y=We(i,"selectedCells",28,()=>[]),o=me(t().getCell(c(),u())),q=me(new ia(e(o).field.duel.duelists.Above.lp,{duration:400,easing:pa})),Q=me(new ia(e(o).field.duel.duelists.Below.lp,{duration:400,easing:pa}));const D=()=>{C(o,t().getCell(c(),u())),xe(q,e(q).target=e(o).field.duel.duelists.Above.lp),xe(Q,e(Q).target=e(o).field.duel.duelists.Below.lp)};e(o).onUpdate.append(D),t().onDuelUpdate.append(D),t().modalController.onUpdate.append(D);let S,n=me([]),H=()=>console.log("hoge"),Z,V=me([]),N=me(!1),F=me(!1),fe=!1;const we=h=>{var O,x;C(ie,[]),v().reset(),S=h.activator,H=h.resolve,C(n,h.dummyActionInfos),C(V,h.chainBlockInfos.flatMap(m=>m.selectedEntities).getDistinct()),Z=h.entitiesChoices,C(N,!1),C(F,((O=h.cellsChoices)==null?void 0:O.selectables.includes(e(o)))??!1),fe=e(F)&&((x=h.cellsChoices)==null?void 0:x.qty)===1,D()};t().onWaitStart.append(we);const Se=()=>{S=void 0,C(n,[]),H=()=>{console.log("hoge")},Z=void 0,C(V,[]),C(N,!1),C(F,!1),fe=!1};t().onWaitEnd.append(Se);let k=me(!1),j=[];const te=h=>{j=h.filter(O=>O.dests.includes(e(o))),C(k,j.length>0),D()},ee=()=>{j=[],C(k,!1),D()};t().onDragStart.append(te),t().onDragEnd.append(ee);const[ne,he]=ci;let ie=me([]);const je=h=>{if(S=void 0,e(o)===h.to||e(o).entities.includes(h.entity)){C(ie,[...e(ie),h]);const O=h.resolve;C(o,e(o)),setTimeout(()=>{C(ie,e(ie).filter(x=>x!==h)),h.count++,h.count>1&&O()},600)}};t().onAnimation.append(je);const Oe=h=>{H({phaseChange:h})},B=()=>e(o).isStackCell&&e(o).entities.flatMap(h=>h.actions).filter(h=>e(n).map(O=>O.action.seq).some(O=>O===h.seq)).length>0,A=h=>{var O;if(((O=h.target)==null?void 0:O.id)==="config_button"){t(t().infoBoardState="Config",!0),t().requireUpdate();return}if(t(t().infoBoardState="Default",!0),fe)H({selectedCells:[e(o)]});else if(e(F))C(N,!e(N)),y(e(N)?[...y(),e(o)]:y().filter(x=>x!==e(o)));else if(e(o).isStackCell){t(t().infoBoardState="CellInfo",!0),t(t().infoBoardCell=e(o),!0),t().requireUpdate();const x=e(o).entities.flatMap(R=>R.actions).map(R=>R.seq),m=e(n).filter(R=>x.includes(R.action.seq));if(m.length){if(!S)return;t().modalController.actionSelector.show({title:"カードを選択。",position:"Bottom",activator:S,dummyActionInfos:m,cancelable:!0}).then(R=>{R&&H({actionInfo:R})});return}}t().requireUpdate(),console.info(e(o),Be(...e(o).visibleEntities))},re=h=>{h.preventDefault(),h.dataTransfer&&(h.dataTransfer.dropEffect="move")},pe=h=>{h.preventDefault(),console.info("drop",h,e(k),j),h.dataTransfer&&(h.dataTransfer.dropEffect="move");try{if(e(k)&&j){if(j.length===1){const O=j[0];H({actionInfo:{...O,dest:e(o)}})}else if(j.length>1){if(!S)throw new er("想定されない状態");e(o).field.duel.view.modalController.terminateAll(),e(o).field.duel.view.modalController.actionSelector.show({title:"選択",position:"Bottom",activator:S,dummyActionInfos:j.map(O=>({...O,dest:e(o)})),cancelable:!1}).then(O=>{H({actionInfo:O})})}}}finally{t().removeDraggingActions()}},Be=(...h)=>{if(t().waitMode==="Animation")return"Disabled";if(Z&&Z.selectables.find(x=>h.find(m=>x===m)))return"Selectable";if(!e(n)||e(n).length===0||t().waitMode!=="Free"||Object.values(t().modalController.modals).some(x=>x.state==="Shown"))return"Disabled";const O=e(n).filter(x=>h.includes(x.action.entity));return O.length===0?"Disabled":e(o).isStackCell||O[0].action.entity!==h[0]?"Clickable":O.some(x=>x.dests.length)?"Draggable":"Clickable"};ht();var P=Jr(),E=a(P);E.__click=A;var Y=a(E);{var W=h=>{var O=De(),x=U(O);{var m=R=>{var ye=De(),M=U(ye);{var T=g=>{var L=Lr(),K=a(L),$e=a(K),Ce=s(K,1,!0);_((be,J)=>{p($e,be),p(Ce,J)},[()=>String(e(o).field.duel.clock.turn).padStart(2,"0"),()=>e(o).field.duel.phase.toUpperCase()],oe),r(g,L)},f=g=>{var L=De(),K=U(L);{var $e=be=>{var J=Ur(),G=a(J),I=a(G),ke=s(G,2),He=a(ke);_((qe,Pe)=>{p(I,qe),p(He,Pe)},[()=>Math.floor(e(q).current),()=>Math.floor(e(Q).current)],oe),r(be,J)},Ce=be=>{var J=De(),G=U(J);{var I=ke=>{var He=De(),qe=U(He);{var Pe=Le=>{var ze=De(),nt=U(ze);{var Te=ve=>{var z=De(),de=U(z);ce(de,1,()=>t().duel.nextPhaseList,ue,(Ne,Ze)=>{var Re=Nr(),Ve=a(Re);Ve.__click=[Yr,Oe,Ze];var $=a(Ve);_(w=>p($,w),[()=>e(Ze).toUpperCase()],oe),r(Ne,Re)}),r(ve,z)};b(nt,ve=>{t().duel.isEnded||ve(Te)})}r(Le,ze)};b(qe,Le=>{t().waitMode==="Free"&&Le(Pe)})}r(ke,He)};b(G,ke=>{e(o).column===5&&ke(I)},!0)}r(be,J)};b(K,be=>{e(o).column===3?be($e):be(Ce,!1)},!0)}r(g,L)};b(M,g=>{e(o).column===1?g(T):g(f,!1)})}r(R,ye)};b(x,R=>{e(o).row===3&&R(m)})}r(h,O)},ae=h=>{var O=De(),x=U(O);{var m=ye=>{var M=Or();const T=oe(()=>e(ie).find(J=>J.to===e(o)));var f=U(M);{var g=J=>{var G=qr(),I=a(G);Pt(I,{get entity(){return e(T).entity},state:"Disabled",dummyActionInfos:[],cardActionResolve:void 0}),_(()=>Ee(G,`card_animation_receiver ${e(o).cellType??""} svelte-1boxe40`)),se(1,G,()=>he,()=>({key:e(T).entity.seq})),r(J,G)};b(f,J=>{e(T)&&e(T).index==="Top"&&J(g)})}var L=s(f,2);ce(L,1,()=>e(o).visibleEntities,ue,(J,G)=>{var I=De(),ke=U(I);{var He=qe=>{var Pe=Pr(),Le=a(Pe);const ze=oe(()=>Be(e(G))),nt=oe(()=>e(n).filter(Te=>Te.action.entity===e(G)));Pt(Le,{get entity(){return e(G)},get state(){return e(ze)},get dummyActionInfos(){return e(nt)},cardActionResolve:void 0,get selectedList(){return v()},set selectedList(Te){v(Te)},$$legacy:!0}),se(2,Pe,()=>ne,()=>({key:e(G).seq})),r(qe,Pe)};b(ke,qe=>{e(ie).every(Pe=>Pe.entity.seq!==e(G).seq)&&qe(He)})}r(J,I)});var K=s(L,2);{var $e=J=>{var G=Fr(),I=a(G);Pt(I,{get entity(){return e(T).entity},state:"Disabled",dummyActionInfos:[],cardActionResolve:void 0}),_(()=>Ee(G,`card_animation_receiver ${e(o).cellType??""} svelte-1boxe40`)),se(1,G,()=>he,()=>({key:e(T).entity.seq})),r(J,G)};b(K,J=>{e(T)&&e(T).index!=="Top"&&J($e)})}var Ce=s(K,2);{var be=J=>{var G=Hr();r(J,G)};b(Ce,J=>{e(o).owner.seat==="Below"&&J(be)})}r(ye,M)},R=ye=>{var M=Xr();const T=oe(()=>e(ie).find(G=>G.to===e(o)));var f=U(M);{var g=G=>{var I=Rr(),ke=a(I);Pt(ke,{get entity(){return e(T).entity},state:"Disabled",dummyActionInfos:[],cardActionResolve:void 0}),se(1,I,()=>he,()=>({key:e(T).entity.seq})),r(G,I)};b(f,G=>{e(T)&&e(T).index!=="Top"&&G(g)})}var L=s(f,2);{var K=G=>{var I=Vr(),ke=U(I);ce(ke,1,()=>e(o).visibleEntities.map((Pe,Le)=>({index:Le,entity:Pe})).toReversed(),ue,(Pe,Le)=>{var ze=De(),nt=U(ze);{var Te=ve=>{var z=Kr();const de=oe(()=>!e(o).isStackCell&&e(Le).index===0?Be(...e(o).visibleEntities):void 0);var Ne=U(z);{var Ze=w=>{var X=Wr();r(w,X)};b(Ne,w=>{e(V).includes(e(Le).entity)&&w(Ze)})}var Re=s(Ne,2),Ve=a(Re);const $=oe(()=>e(Le).index===0?e(n).filter(w=>e(o).visibleEntities.includes(w.action.entity)):void 0);Pt(Ve,{get entity(){return e(Le).entity},get state(){return e(de)},get dummyActionInfos(){return e($)},cardActionResolve:void 0,get selectedList(){return v()},set selectedList(w){v(w)},$$legacy:!0}),_(()=>Ee(Re,`duel_card_wrapper ${(e(Le).entity.exist?"duel_card_wrapper_exists":"")??""} svelte-1boxe40`)),se(2,Re,()=>ne,()=>({key:e(Le).entity.seq})),r(ve,z)};b(nt,ve=>{e(ie).every(z=>z.entity.seq!==e(Le).entity.seq)&&ve(Te)})}r(Pe,ze)});var He=s(ke,2);{var qe=Pe=>{var Le=zr(),ze=a(Le),nt=s(ze);ce(nt,1,()=>Ft(e(o).visibleEntities[0].status.maxCounterQty),ue,(Te,ve)=>{var z=Ir(),de=U(z),Ne=s(de);{var Ze=Re=>{var Ve=rt();_(()=>p(Ve,`/${e(o).visibleEntities[0].status.maxCounterQty[e(ve)]??""}`)),r(Re,Ve)};b(Ne,Re=>{(e(o).visibleEntities[0].status.maxCounterQty[e(ve)]??9999)<100&&Re(Ze)})}_((Re,Ve)=>p(de,`【
              ${Re??""}${Ve??""} `),[()=>tr(e(ve)),()=>e(o).visibleEntities[0].counterHolder.getQty(e(ve))],oe),r(Te,z)}),_(()=>p(ze,`【${e(o).visibleEntities[0].battlePositionName??""}】 `)),r(Pe,Le)};b(He,Pe=>{e(o).visibleEntities[0].battlePosition&&Pe(qe)})}r(G,I)};b(L,G=>{e(o).visibleEntities.length>0&&G(K)})}var $e=s(L,2);{var Ce=G=>{var I=Gr(),ke=a(I);_(()=>p(ke,e(o).visibleEntities.length)),r(G,I)};b($e,G=>{e(o).isStackCell&&G(Ce)})}var be=s($e,2);{var J=G=>{var I=Qr(),ke=a(I);Pt(ke,{get entity(){return e(T).entity},state:"Disabled",dummyActionInfos:[],cardActionResolve:void 0}),se(1,I,()=>he,()=>({key:e(T).entity.seq})),r(G,I)};b(be,G=>{e(T)&&e(T).index==="Top"&&G(J)})}r(ye,M)};b(x,ye=>{e(o).cellType==="Hand"?ye(m):ye(R,!1)},!0)}r(h,O)};b(Y,h=>{e(o).isDisabledCell?h(W):h(ae,!1)})}_(h=>{Ee(P,`${`duel_field_cell duel_field_cell_${e(o).cellType} ${e(o).linkArrowSources.length===0?"":"duel_field_cell_linked"}`??""} svelte-1boxe40`),xt(P,"colspan",e(o).cellType==="Hand"?7:1),Ee(E,`${h??""} svelte-1boxe40`)},[()=>`duel_field_cell_inner_box ${e(o).cellType} ${e(k)?"can_accept_drop":""} ${B()?"can_action":""} ${e(N)?"is_selected":e(F)?"is_selectable":""} `],oe),_e("dragover",E,re),_e("drop",E,pe),r(d,P),bt()}Ra(["click"]);const es=(d,i,t=void 0,c="!!!circular reference!!!")=>{let u=[];return JSON.stringify(d,(v,y)=>{if(typeof y=="object"){if(u.indexOf(y)>-1)return c;u.push(y)}let o=y;if(i&&(o=i(v,y)),typeof o=="function")return o.toString();if(o!==y&&typeof o=="object"){if(u.indexOf(o)>-1)return c;u.push(o)}return o},t)};var ts=l('<div class="title svelte-14z6bdh"> </div>'),as=l('<div class="title svelte-14z6bdh"> </div>'),rs=l('<div class="duel_log_chain_number svelte-14z6bdh"> </div>'),ss=l('<div><a class="white_button" download="error_info.json">エラー情報ダウンロード</a></div>'),is=l("<div><!> <!></div>"),ns=l('<div><div style="display: flex;    justify-content: space-between;"><div style=" white-space: nowrap;text-align: center;"> </div> <!></div> <!></div>'),ls=l("<div><!> <!></div>"),os=l("<div><!> <!></div>"),vs=l('<div class="duel_log svelte-14z6bdh"><div class="duel_log_header svelte-14z6bdh"></div> <div class="duel_log_body svelte-14z6bdh"></div> <div class="duel_log_footer svelte-14z6bdh"></div></div>');function ds(d,i){gt(i,!1);let t=me(void 0),c=We(i,"log",8),u,v=me([]);const y=()=>{const D=((u==null?void 0:u.seq)??-1)+1;c().records.slice(D).forEach(S=>{if(!u){C(v,[[[[S]]]]),u=S;return}if(!e(v)[S.clock.turn]){xe(v,e(v)[S.clock.turn]=[[[S]]]),u=S;return}if(!e(v)[S.clock.turn][S.clock.phaseSeq]){xe(v,e(v)[S.clock.turn][S.clock.phaseSeq]=[[S]]),u=S;return}if(u.clock.chainSeq===S.clock.chainSeq&&u.clock.chainBlockSeq===S.clock.chainBlockSeq&&u.duelist===S.duelist){e(v)[S.clock.turn][S.clock.phaseSeq].slice(-1)[0].push(S),u=S;return}e(v)[S.clock.turn][S.clock.phaseSeq].push([S]),u=S}),C(v,e(v)),ar().then(()=>e(t)&&e(t).scroll(0,e(t).clientHeight*990))};c().onUpdate.append(y),c().duel.view.onDuelUpdate.append(y),y(),ht();var o=De(),q=U(o);{var Q=D=>{var S=vs(),n=s(a(S),2);ce(n,5,()=>e(v),ue,(H,Z)=>{var V=os(),N=a(V);{var F=we=>{var Se=ts(),k=a(Se);_(()=>p(k,`ターン：${e(Z)[0][0][0].clock.turn??""}`)),r(we,Se)};b(N,we=>{e(Z)[0][0][0].clock.turn>0&&we(F)})}var fe=s(N,2);ce(fe,1,()=>e(Z),ue,(we,Se)=>{var k=ls(),j=a(k);{var te=ne=>{var he=as(),ie=a(he);_(()=>p(ie,e(Se)[0][0].clock.period.name)),r(ne,he)};b(j,ne=>{e(Se)[0][0].clock.turn>0&&ne(te)})}var ee=s(j,2);ce(ee,1,()=>e(Se),ue,(ne,he)=>{var ie=ns();const je=oe(()=>{var P;return((P=e(he).find(E=>E.chainNumber!==void 0))==null?void 0:P.chainNumber)??0});var Oe=a(ie),B=a(Oe),A=a(B),re=s(B,2);{var pe=P=>{var E=rs(),Y=a(E);_(()=>p(Y,`チェーン：${e(je)??""}`)),r(P,E)};b(re,P=>{e(je)&&P(pe)})}var Be=s(Oe,2);ce(Be,1,()=>e(he),ue,(P,E)=>{var Y=is(),W=a(Y);{var ae=m=>{var R=rt();_(()=>p(R,e(E).text)),r(m,R)},h=m=>{var R=De(),ye=U(R);{var M=f=>{var g=rt();_((L,K,$e)=>p(g,`移動：${L??""} ${K??""} ⇒ ${$e??""}`),[()=>{var L;return(L=e(E).mainEntity)==null?void 0:L.toString()},()=>{var L;return(L=e(E).from)==null?void 0:L.toString()},()=>{var L;return(L=e(E).to)==null?void 0:L.toString()}],oe),r(f,g)},T=f=>{var g=De(),L=U(g);{var K=Ce=>{var be=rt();_((J,G)=>p(be,`生成：${J??""} void ⇒ ${G??""}`),[()=>{var J;return(J=e(E).mainEntity)==null?void 0:J.toString()},()=>{var J;return(J=e(E).to)==null?void 0:J.toString()}],oe),r(Ce,be)},$e=Ce=>{var be=De(),J=U(be);{var G=ke=>{var He=rt();_((qe,Pe)=>p(He,`消滅：${qe??""} ${Pe??""} ⇒ void`),[()=>{var qe;return(qe=e(E).mainEntity)==null?void 0:qe.toString()},()=>{var qe;return(qe=e(E).from)==null?void 0:qe.toString()}],oe),r(ke,He)},I=ke=>{var He=rt();_(()=>p(He,e(E).text)),r(ke,He)};b(J,ke=>{e(E).type==="EntityDisappear"?ke(G):ke(I,!1)},!0)}r(Ce,be)};b(L,Ce=>{e(E).type==="EntityAppear"?Ce(K):Ce($e,!1)},!0)}r(f,g)};b(ye,f=>{e(E).type==="EntityMove"?f(M):f(T,!1)},!0)}r(m,R)};b(W,m=>{e(E).type==="ChainBlockHeader"?m(ae):m(h,!1)})}var O=s(W,2);{var x=m=>{var R=ss(),ye=a(R);_(M=>xt(ye,"href",M),[()=>window.URL.createObjectURL(new Blob([es(e(E).error,(M,T)=>["pool","bundles","duel"].includes(M)||typeof T=="function"?void 0:T,4)],{type:"text/plain"}))],oe),r(m,R)};b(O,m=>{e(E).error&&m(x)})}_(m=>Ee(Y,`duel_log_record duel_log_record_${m??""} svelte-14z6bdh`),[()=>e(E).type.toSnakeCase()],oe),r(P,Y)}),_(()=>{var P,E,Y;Ee(ie,`duel_log_block_duelist duel_log_block_duelist_${((P=e(he)[0].duelist)==null?void 0:P.seat)??"system"} svelte-14z6bdh`),Ee(B,`duelist ${((E=e(he)[0].duelist)==null?void 0:E.seat)??""} svelte-14z6bdh`),p(A,((Y=e(he)[0].duelist)==null?void 0:Y.profile.name)||"SYSTEM")}),r(ne,ie)}),_(()=>Ee(k,`duel_log_block_phase duel_log_block_phase_${e(Se)[0][0].clock.period.key??""} svelte-14z6bdh`)),r(we,k)}),_(()=>Ee(V,`duel_log_block_turn duel_log_block_turn_${e(Z)[0][0][0].clock.turn??""} svelte-14z6bdh`)),r(H,V)}),rr(n,H=>C(t,H),()=>e(t)),r(D,S)};b(q,D=>{(c().duel.view.infoBoardState==="Log"||c().duel.view.infoBoardState==="Default")&&D(Q)})}r(d,o),bt()}var cs=l("<div><div> </div> <div> </div></div>");function Ha(d,i){gt(i,!1);let t=We(i,"duelist",12),c=me(0),u=me();const v=async()=>{const n=t().lp-e(c);if(!e(u)||Math.abs(n)<10){C(c,t().lp),e(u)&&(e(u)(),C(u,void 0));return}C(c,e(c)+Math.floor(Math.random()*n)),await It(100),v()},y=()=>{t(t()),!e(u)&&t().lp!==e(c)&&new Promise(n=>{C(u,n),Math.abs(t().lp-e(c)),v()})};t().duel.log.onUpdate.append(y),v(),ht();var o=cs(),q=a(o),Q=a(q),D=s(q,2),S=a(D);_(n=>{Ee(o,`duelist duelist_${n??""} svelte-1sy3trd`),Ee(q,`duelist_name duelist_${n??""}_name svelte-1sy3trd`),p(Q,t().profile.name),Ee(D,`duelist_lp ${(e(u)?"vibration":"")??""} svelte-1sy3trd`),p(S,e(c))},[()=>t().seat.toLowerCase()],oe),r(d,o),bt()}const _s=(d,i,t)=>(i(i()!=="Detail"?"Detail":"Normal"),console.info(t()),!0),us=(d,i,t)=>(i(i()!=="Debug"?"Debug":"Normal"),console.info(t()),!0);var fs=l('<div class="svelte-1uevs9j"> </div>'),ps=l('<div class="svelte-1uevs9j"> </div>'),ys=l('<div class="link_arrow_emoji svelte-1uevs9j"> </div>'),ms=l('<div class="duel_card_info_row svelte-1uevs9j" style=" justify-content: space-between;"><div class="svelte-1uevs9j"> </div> <div class="svelte-1uevs9j"> </div></div>'),gs=l('<div></div> <div class="svelte-1uevs9j"> </div>',1),hs=l("<div> </div>"),bs=l('<span class="svelte-1uevs9j">/</span> <div class="monster_defense svelte-1uevs9j"> </div>',1),ks=l("<div> </div>"),xs=l('<div class="duel_card_info_row svelte-1uevs9j"><!> <!> <div style="flex-grow: 1;" class="svelte-1uevs9j"></div> <div class="monster_attack svelte-1uevs9j"> </div> <!></div> <div class="duel_card_info_row svelte-1uevs9j"></div>',1),ws=l('<div class="duel_card_row svelte-1uevs9j"><div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"> </div></div>'),Cs=l('<div class="duel_card_row svelte-1uevs9j"><div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"> </div></div>'),Ds=l("<!> <!>",1),$s=l('<pre class="description svelte-1uevs9j"> </pre>'),Ss=l('<div class="duel_card_info_row svelte-1uevs9j" style="border-style: solid; border-width: 1px;"><!></div>'),Ms=l('<pre class="description svelte-1uevs9j"> </pre>'),Ts=l('<!> <div class="duel_card_info_row svelte-1uevs9j"><!></div>',1),js=l('<div class="effect_counter_area_item svelte-1uevs9j"><span class="svelte-1uevs9j"> </span> <span class="svelte-1uevs9j"> </span> <span class="svelte-1uevs9j">/</span> <span class="svelte-1uevs9j"> </span></div>'),Bs=l('<div class="duel_card_info_row effect_counter_area svelte-1uevs9j"><div class="effect_counter_area_title svelte-1uevs9j">効果使用状況</div> <div class="effect_counter_area_body svelte-1uevs9j"></div></div>'),Es=l("[ <!> ],",1),As=l('<div class="svelte-1uevs9j"> <!></div>'),Ls=l('<div class="svelte-1uevs9j"> </div> <!> <div class="svelte-1uevs9j"></div>',1),Us=l('<div class="svelte-1uevs9j"> </div>'),Ys=l('<div class="svelte-1uevs9j"> </div>'),Ns=l('<div class="svelte-1uevs9j"> </div>'),qs=l('<div class="svelte-1uevs9j"> </div>'),Ps=l('<div class="svelte-1uevs9j"> </div>'),Fs=l('<div class="svelte-1uevs9j"> </div>'),Hs=l('<div class="duel_card_info_row svelte-1uevs9j"><div class="svelte-1uevs9j"><!> <div class="svelte-1uevs9j"></div> <!> <div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"></div> <!> <div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"></div> <!> <div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"></div> <!> <div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"></div> <!> <div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"></div> <!> <div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"> </div> <div class="svelte-1uevs9j"> </div> <div class="svelte-1uevs9j"> </div> <div class="svelte-1uevs9j"></div></div></div>'),Os=l('<div class="svelte-1uevs9j">※エラッタ前のカードです</div>'),Rs=l('<div class="svelte-1uevs9j">※テスト用カードです</div>'),Ws=l('<a target="_blank" rel="noopener noreferrer" title="コナミカードデータベース" class="svelte-1uevs9j"> </a>'),Ks=l('<div class="duel_card_info_links svelte-1uevs9j"><a target="_blank" rel="noopener noreferrer" title="遊戯王カードWiki" class="svelte-1uevs9j">⇒遊戯王カードWiki</a> <!></div>'),Is=l("<!> <!>",1),zs=l('<div role="contentinfo"><div class="duel_card_info_header svelte-1uevs9j"><div class="duel_card_info_row svelte-1uevs9j"><div class="svelte-1uevs9j"> </div></div> <div class="duel_card_info_row svelte-1uevs9j" style="position:sticky; top:0;"><!> <div class="svelte-1uevs9j"> </div></div> <!></div> <div class="duel_card_info_body svelte-1uevs9j"><!></div> <div class="duel_card_info_footer svelte-1uevs9j"><!></div></div>');function Vs(d,i){gt(i,!1);let t=We(i,"entity",8,void 0),c=We(i,"mode",12,"Normal");const u=async()=>{if(!t())return;const D=(await Xt).getCardInfo(t().origin.name);if(D)return D.cardId!==void 0&&!D.description&&!D.pendulumDescription&&await Wa([D.cardId]),D},v=()=>t()&&t().entityType==="Card"&&(t().origin.cardId??!1)?`https://www.db.yugioh-card.com/yugiohdb/card_search.action?ope=2&cid=${t().origin.cardId}`:t()?`https://www.db.yugioh-card.com/yugiohdb/card_search.action?ope=1&sess=1&rp=10&mode=&sort=1&keyword=${t().origin.name}&stype=1&ctype=&othercon=2&starfr=&starto=&pscalefr=&pscaleto=&linkmarkerfr=&linkmarkerto=&link_m=2&atkfr=&atkto=&deffr=&defto=&releaseDStart=1&releaseMStart=1&releaseYStart=1999&releaseDEnd=&releaseMEnd=&releaseYEnd=`:"";ht();var y=De(),o=U(y);{var q=Q=>{var D=zs();D.__click=[_s,c,t],D.__contextmenu=[us,c,t];var S=a(D),n=a(S),H=a(n),Z=a(H),V=s(n,2),N=a(V);{var F=B=>{var A=fs(),re=a(A);_(pe=>p(re,pe),[()=>"★".repeat(t().lvl)],oe),r(B,A)},fe=B=>{var A=De(),re=U(A);{var pe=P=>{var E=ps(),Y=a(E);_(W=>p(Y,W),[()=>"☆".repeat(t().rank)],oe),r(P,E)},Be=P=>{var E=De(),Y=U(E);{var W=ae=>{var h=ys(),O=a(h);_(x=>p(O,x),[()=>t().origin.linkArrowKeys.map(x=>Ka[x].emoji).join("")],oe),r(ae,h)};b(Y,ae=>{t().origin.linkArrowKeys&&ae(W)},!0)}r(P,E)};b(re,P=>{t().rank&&t().rank>0?P(pe):P(Be,!1)},!0)}r(B,A)};b(N,B=>{t().lvl&&t().lvl>0?B(F):B(fe,!1)})}var we=s(N,2),Se=a(we),k=s(V,2);{var j=B=>{var A=Ds(),re=U(A);{var pe=Y=>{var W=ms(),ae=a(W),h=a(ae),O=s(ae,2),x=a(O);_(()=>{p(h,`◀ ${t().psL??""}`),p(x,`${t().psR??""} ▶`)}),r(Y,W)};b(re,Y=>{var W;(W=t().origin.monsterCategories)!=null&&W.includes("Pendulum")&&Y(pe)})}var Be=s(re,2);{var P=Y=>{var W=xs(),ae=U(W),h=a(ae);ce(h,1,()=>t().attr,ue,(T,f)=>{var g=gs(),L=U(g),K=s(L,2),$e=a(K);_(()=>{Ee(L,`monster_attr ${e(f)??""} svelte-1uevs9j`),p($e,`${ga[e(f)]??""}属性`)}),r(T,g)});var O=s(h,2);ce(O,1,()=>t().types,ue,(T,f)=>{var g=hs(),L=a(g);_(()=>{Ee(g,`monster_cat ${e(f)??""} svelte-1uevs9j`),p(L,`${la[e(f)]??""}${ha[e(f)]??""}族`)}),r(T,g)});var x=s(O,4),m=a(x),R=s(x,2);{var ye=T=>{var f=bs(),g=s(U(f),2),L=a(g);_(()=>p(L,t().def??"?")),r(T,f)};b(R,T=>{var f;(f=t().status.monsterCategories)!=null&&f.includes("Link")||T(ye)})}var M=s(ae,2);ce(M,5,()=>t().status.monsterCategories??[],ue,(T,f)=>{var g=ks(),L=a(g);_(()=>{Ee(g,`monster_cat ${e(f)??""} svelte-1uevs9j`),p(L,`${Jt[e(f)]??""}${ra[e(f)]??""}`)}),r(T,g)}),_(()=>p(m,t().atk??"?")),r(Y,W)},E=Y=>{var W=De(),ae=U(W);{var h=x=>{var m=ws(),R=s(a(m),2),ye=a(R);_(()=>p(ye,`${oa[t().status.spellCategory]??""}魔法`)),r(x,m)},O=x=>{var m=De(),R=U(m);{var ye=M=>{var T=Cs(),f=s(a(T),2),g=a(f);_(()=>p(g,`${va[t().status.trapCategory]??""}罠`)),r(M,T)};b(R,M=>{t().kind==="Trap"&&t().status.trapCategory&&M(ye)},!0)}r(x,m)};b(ae,x=>{t().kind==="Spell"&&t().status.spellCategory?x(h):x(O,!1)},!0)}r(Y,W)};b(Be,Y=>{t().kind==="Monster"?Y(P):Y(E,!1)})}r(B,A)};b(k,B=>{c()!=="Debug"&&B(j)})}var te=s(S,2),ee=a(te);{var ne=B=>{var A=Ts(),re=U(A);{var pe=E=>{var Y=Ss(),W=a(Y);kt(W,u,ae=>{var h=rt('"読み込み中"');r(ae,h)},(ae,h)=>{var O=$s(),x=a(O);_(()=>{var m;return p(x,(m=e(h))==null?void 0:m.pendulumDescription)}),r(ae,O)}),r(E,Y)};b(re,E=>{var Y;(Y=t().status.monsterCategories)!=null&&Y.includes("Pendulum")&&E(pe)})}var Be=s(re,2),P=a(Be);kt(P,u,E=>{var Y=rt('"読み込み中"');r(E,Y)},(E,Y)=>{var W=Ms(),ae=a(W);_(()=>{var h;return p(ae,(h=e(Y))==null?void 0:h.description)}),r(E,W)}),r(B,A)},he=B=>{var A=De(),re=U(A);{var pe=P=>{var E=De(),Y=U(E);{var W=ae=>{var h=Bs(),O=s(a(h),2);ce(O,5,()=>t().actions,ue,(x,m)=>{var R=De();const ye=oe(()=>e(m).actionCountUpperBound),M=oe(()=>e(m).actionCount);var T=U(R);{var f=g=>{var L=js(),K=a(L),$e=a(K),Ce=s(K,2),be=a(Ce),J=s(Ce,4),G=a(J);_(()=>{p($e,e(m).title),p(be,e(M)),p(G,e(ye))}),r(g,L)};b(T,g=>{e(ye)!==void 0&&e(M)!==void 0&&g(f)})}r(x,R)}),r(ae,h)};b(Y,ae=>{t().actions.some(h=>h.actionCountUpperBoundKey)&&ae(W)})}r(P,E)},Be=P=>{var E=Hs(),Y=a(E),W=a(Y);ce(W,0,()=>["info","status"],ue,(Te,ve)=>{var z=Ls(),de=U(z),Ne=a(de),Ze=s(de,2);ce(Ze,1,()=>Object.entries(t()[ve]),ue,(Ve,$)=>{let w=()=>e($)[0],X=()=>e($)[1];var le=As(),Me=a(le),Ge=s(Me);{var Ue=Ye=>{var Ie=Es(),Xe=s(U(Ie));ce(Xe,1,X,ue,(lt,$t)=>{var jt=rt();_(St=>p(jt,`${St??""},`),[()=>e($t).toString()],oe),r(lt,jt)}),r(Ye,Ie)},Ke=Ye=>{var Ie=rt();_(Xe=>p(Ie,`${Xe??""},`),[()=>{var Xe;return(Xe=X())==null?void 0:Xe.toString()}],oe),r(Ye,Ie)};b(Ge,Ye=>{Array.isArray(X())?Ye(Ue):Ye(Ke,!1)})}_(()=>p(Me,`"${w()??""}" : `)),r(Ve,le)});var Re=s(Ze,2);Re.textContent="},",_(()=>p(Ne,`"${ve??""}" :{`)),r(Te,z)});var ae=s(W,2);ae.textContent='"actions" :[';var h=s(ae,2);ce(h,1,()=>t().actions,ue,(Te,ve)=>{var z=Us(),de=a(z);_(()=>p(de,`"${e(ve).playType??""} ${e(ve).title??""}",`)),r(Te,z)});var O=s(h,2);O.textContent="],";var x=s(O,2);x.textContent='"substituteEffects" :[';var m=s(x,2);ce(m,1,()=>t().substituteEffects,ue,(Te,ve)=>{var z=Ys(),de=a(z);_(()=>p(de,`"${e(ve).title??""}",`)),r(Te,z)});var R=s(m,2);R.textContent="],";var ye=s(R,2);ye.textContent='"continuousEffects" :[';var M=s(ye,2);ce(M,1,()=>t().continuousEffects,ue,(Te,ve)=>{var z=Ns(),de=a(z);_(()=>p(de,`"${e(ve).isStarted??""}",`)),r(Te,z)});var T=s(M,2);T.textContent="],";var f=s(T,2);f.textContent='"procFilters" :[';var g=s(f,2);ce(g,1,()=>t().procFilterBundle.operators,ue,(Te,ve)=>{var z=qs(),de=a(z);_(Ne=>p(de,`"${Ne??""} ${e(ve).title??""} ${e(ve).isEffective??""} ",`),[()=>e(ve).isSpawnedBy.toString()],oe),r(Te,z)});var L=s(g,2);L.textContent="],";var K=s(L,2);K.textContent='"numericStateOperators" :[';var $e=s(K,2);ce($e,1,()=>t().numericOprsBundle.operators,ue,(Te,ve)=>{var z=Ps(),de=a(z);_(Ne=>p(de,`"${Ne??""} ${e(ve).title??""} ${e(ve).isEffective??""} ${e(ve).isContinuous??""} ${e(ve).targetState??""} ${e(ve).targetStateGen??""} ",`),[()=>e(ve).isSpawnedBy.toString()],oe),r(Te,z)});var Ce=s($e,2);Ce.textContent="],";var be=s(Ce,2);be.textContent='"stateOperators" :[';var J=s(be,2);ce(J,1,()=>t().statusOperatorBundle.operators,ue,(Te,ve)=>{var z=Fs(),de=a(z);_(Ne=>p(de,`"${Ne??""} ${e(ve).title??""} ${e(ve).isEffective??""} ",`),[()=>e(ve).isSpawnedBy.toString()],oe),r(Te,z)});var G=s(J,2);G.textContent="],";var I=s(G,2);I.textContent='"lastMoveLogRecord" :{';var ke=s(I,2),He=a(ke),qe=s(ke,2),Pe=a(qe),Le=s(qe,2),ze=a(Le),nt=s(Le,2);nt.textContent="},",_((Te,ve)=>{p(He,`"movedBy":"${Te??""}",`),p(Pe,`"movedAs":"${ve??""}",`),p(ze,`"movedAt":"${t().moveLog.latestRecord.movedAt.totalProcSeq??""}",`)},[()=>{var Te;return(Te=t().moveLog.latestRecord.movedBy)==null?void 0:Te.toString()},()=>t().moveLog.latestRecord.movedAs.join(" ")],oe),r(P,E)};b(re,P=>{c()==="Detail"?P(pe):P(Be,!1)},!0)}r(B,A)};b(ee,B=>{c()==="Normal"?B(ne):B(he,!1)})}var ie=s(te,2),je=a(ie);{var Oe=B=>{var A=Is(),re=U(A);{var pe=Y=>{var W=Os();r(Y,W)};b(re,Y=>{t().origin.isOldVersion&&Y(pe)})}var Be=s(re,2);{var P=Y=>{var W=Rs();r(Y,W)},E=Y=>{var W=Ks(),ae=a(W),h=s(ae,2);{var O=x=>{var m=Ws(),R=a(m);_(ye=>{var M;xt(m,"href",ye),p(R,`⇒${((M=t())!=null&&M.origin.cardId?"公式カードページ":"公式で検索")??""}`)},[v],oe),r(x,m)};b(h,x=>{t()&&t().entityType==="Card"&&x(O)})}_(()=>xt(ae,"href",`https://yugioh-wiki.net/index.php?${t().origin.wikiEncodedName}`)),r(Y,W)};b(Be,Y=>{t().origin.isForTest?Y(P):Y(E,!1)})}r(B,A)};b(je,B=>{t()&&B(Oe)})}_((B,A)=>{Ee(D,`duel_card duel_card_info ${t().origin.kind??""} ${B??""} svelte-1uevs9j`),p(Z,t().nm),p(Se,A)},[()=>{var B;return(B=t().origin.monsterCategories)==null?void 0:B.join(" ")},()=>"★".repeat(t().lvl||0)],oe),r(Q,D)};b(o,Q=>{t()&&Q(q)})}r(d,y),bt()}Ra(["click","contextmenu"]);var Gs=l('<div class="duel_field_cell_info_item svelte-1xj7qf1"><!></div>'),Qs=l('<div class="duel_field_cell_info_box svelte-1xj7qf1"><div class="duel_field_cell_info_label svelte-1xj7qf1"> </div> <!></div>'),Xs=l('<div class="duel_field_cell_info svelte-1xj7qf1"><div class="duel_field_cell_info_header item_btn svelte-1xj7qf1"><div class="svelte-1xj7qf1"> </div> <div class="svelte-1xj7qf1"> </div></div> <div class="duel_field_cell_info_body svelte-1xj7qf1"></div></div>');function Js(d,i){gt(i,!1);let t=We(i,"cell",12);const c=()=>{t(t())},u=q=>t().cardEntities.filter(Q=>Q.face===q);t().field.duel.view.onDuelUpdate.append(c),ht();var v=De(),y=U(v);{var o=q=>{var Q=Xs(),D=a(Q),S=a(D),n=a(S),H=s(S,2),Z=a(H),V=s(D,2);ce(V,4,()=>["FaceUp","FaceDown"],ue,(N,F)=>{var fe=De(),we=U(fe);{var Se=k=>{var j=Qs(),te=a(j),ee=a(te),ne=s(te,2);ce(ne,1,()=>u(F).toSorted(sr),ue,(he,ie)=>{var je=Gs(),Oe=a(je);const B=oe(()=>t().owner===t().field.duel.duelists.Below);Pt(Oe,{get entity(){return e(ie)},get isVisibleForcibly(){return e(B)},isWideMode:!0,cardActionResolve:void 0}),r(he,je)}),_(()=>p(ee,F==="FaceUp"?"表向き":"裏向き")),r(k,j)};b(we,k=>{u(F).length&&k(Se)})}r(N,fe)}),_(()=>{var N;p(n,(N=t().owner)==null?void 0:N.profile.name),p(Z,t().cellType)}),r(q,Q)};b(y,q=>{t().field.duel.view.infoBoardState==="CellInfo"&&q(o)})}r(d,v),bt()}var Zs=l('<div class="duel_config_item svelte-y4u26k"><label class="toggle svelte-y4u26k"><input type="checkbox" class="svelte-y4u26k"></label> <span class="svelte-y4u26k"> </span></div>'),ei=l('<div class="duel_config svelte-y4u26k"><div class="duel_config_title svelte-y4u26k">デュエル設定</div> <div class="duel_config_group svelte-y4u26k"><div class="duel_config_group_title svelte-y4u26k">チェーン設定</div> <!></div></div>');function ti(d,i){gt(i,!1);let t=We(i,"viewController",8),c=We(i,"userProfile",12);ht();var u=De(),v=U(u);{var y=o=>{var q=ei(),Q=s(a(q),2),D=s(a(Q),2);ce(D,1,()=>lr,ue,(S,n)=>{var H=Zs(),Z=a(H),V=a(Z),N=s(Z,2),F=a(N);_(()=>p(F,ir[e(n)])),nr(V,()=>c().chainConfig[e(n)],fe=>c(c().chainConfig[e(n)]=fe,!0)),_e("change",V,()=>c().save()),r(S,H)}),r(o,q)};b(v,o=>{t().infoBoardState==="Config"&&o(y)})}r(d,u),bt()}function ai(d,{from:i,to:t},c={}){var{delay:u=0,duration:v=j=>Math.sqrt(j)*120,easing:y=pa}=c,o=getComputedStyle(d),q=o.transform==="none"?"":o.transform,[Q,D]=o.transformOrigin.split(" ").map(parseFloat);Q/=d.clientWidth,D/=d.clientHeight;var S=ri(d),n=d.clientWidth/t.width/S,H=d.clientHeight/t.height/S,Z=i.left+i.width*Q,V=i.top+i.height*D,N=t.left+t.width*Q,F=t.top+t.height*D,fe=(Z-N)*n,we=(V-F)*H,Se=i.width/t.width,k=i.height/t.height;return{delay:u,duration:typeof v=="function"?v(Math.sqrt(fe*fe+we*we)):v,easing:y,css:(j,te)=>{var ee=te*fe,ne=te*we,he=j+te*Se,ie=j+te*k;return`transform: ${q} translate(${ee}px, ${ne}px) scale(${he}, ${ie});`}}}function ri(d){if("currentCSSZoom"in d)return d.currentCSSZoom;for(var i=d,t=1;i!==null;)t*=+getComputedStyle(i).zoom,i=i.parentElement;return t}var si=l('<div class="chain_number svelte-lqu21u"> </div>'),ii=l('<div class="duel_card_row svelte-lqu21u"> </div>'),ni=l('<div class="appendix svelte-lqu21u"> </div>'),li=l('<div class="appendix_wrapper svelte-lqu21u"></div>'),oi=l('<div><div><!> <div> </div> <div><!> <div class="duel_card_row svelte-lqu21u"><div> </div> <!></div></div></div></div>'),vi=l("<div></div>");function di(d,i){gt(i,!1);let t=We(i,"duel",8),c=We(i,"position",8,"left");const u=-100,v=()=>c()==="left"?-100:100;let y=me([]),o=Promise.resolve(),q=Promise.resolve();const Q=1e3,D=500,S=400,n=Z=>{const V={...Z};V.isKnown=Z.chainBlockInfo.action.entity.controller.duelistType==="Player"||Z.chainBlockInfo.action.entity.face==="FaceUp",V.chainBlockInfo.onStateChange.append(N=>{if(N==="done"||N==="failed"||N==="negated")return o=o.then(async()=>{const F=new Date().getTime()-V.chainBlockInfo.wasSpawnedAt.getTime();F<Q&&await It(Q-F),C(y,e(y).filter(fe=>fe.seq!==V.seq)),await It(D+S)}).then(),"RemoveMe";C(y,e(y))}),q=q.then(async()=>{C(y,[V,...e(y)].sort((N,F)=>or.isSameChain(N.clock,F.clock)&&N.chainBlockInfo.action.isWithChainBlock&&F.chainBlockInfo.action.isWithChainBlock?F.clock.totalProcSeq-N.clock.totalProcSeq:N.clock.totalProcSeq-F.clock.totalProcSeq)),await It(300)}),o=o.then(()=>It(1e3))};t().chainBlockLog.onInsert.append(n),ht();var H=vi();ce(H,13,()=>e(y),Z=>Z.seq,(Z,V)=>{var N=oi();const F=oe(()=>{const{activator:A,action:re,appendix:pe}=e(V).chainBlockInfo;return{activator:A,action:re,appendix:pe}});var fe=a(N),we=a(fe);{var Se=A=>{var re=si(),pe=a(re);_(()=>p(pe,`チェーン：${e(V).chainBlockInfo.chainNumber??""}`)),r(A,re)};b(we,A=>{e(V).chainBlockInfo.chainNumber&&A(Se)})}var k=s(we,2),j=a(k),te=s(k,2),ee=a(te);{var ne=A=>{var re=ii(),pe=a(re);_(()=>p(pe,e(V).isKnown?e(F).action.entity.nm:"？？？")),r(A,re)};b(ee,A=>{(e(F).action.entity.entityType==="Card"||e(F).action.entity.entityType==="Token")&&A(ne)})}var he=s(ee,2),ie=a(he),je=a(ie),Oe=s(ie,2);{var B=A=>{var re=li();ce(re,5,()=>e(F).appendix,ue,(pe,Be)=>{var P=ni(),E=a(P);_(()=>p(E,e(Be))),r(pe,P)}),r(A,re)};b(Oe,A=>{e(F).appendix&&A(B)})}_((A,re,pe)=>{Ee(N,`cut_in_row ${(!e(V).chainBlockInfo.chainNumber||e(V).chainBlockInfo.chainNumber===1?"cut_in_row_first":"")??""} svelte-lqu21u`),Ee(fe,`cut_in_item cut_in_item_${A??""} cut_in_item_${e(V).chainBlockInfo.state??""} svelte-lqu21u`),Ee(k,`duelist_name duelist_${A??""}_name svelte-lqu21u`),p(j,e(F).activator.profile.name),Ee(te,`duel_card duel_card_${A??""} ${re??""} ${(e(V).isKnown?e(F).action.entity.origin.kind:"")??""} ${e(F).action.entity.entityType??""}  svelte-lqu21u`),p(je,pe)},[()=>e(F).activator.seat.toLowerCase(),()=>e(V).isKnown?(e(F).action.entity.status.monsterCategories??[]).join(" "):"Token",()=>e(F).action.toString()],oe),se(3,fe,()=>Br,()=>new Date().getTime()-e(V).chainBlockInfo.wasSpawnedAt.getTime()<Q?{x:v(),duration:S}:{y:u,duration:S}),vr(N,()=>ai,()=>({duration:D})),r(Z,N)}),_(()=>Ee(H,`cut_in_container cut_in_container_${c()??""} svelte-lqu21u`)),r(d,H),bt()}const ci=Er({duration:400});var _i=l('<div class="duel_desk_left v_flex svelte-1w535im"><!> <!> <!></div>'),ui=l('<button class="duel_field_header_message svelte-1w535im"> </button> <div class="duel_field_header_buttons svelte-1w535im"><button class="svelte-1w535im">サレンダー</button></div>',1),fi=l("<tr></tr>"),pi=l('<table class="duel_field svelte-1w535im"><tbody class="svelte-1w535im"></tbody></table>'),yi=l('<button class="svelte-1w535im">OK</button>'),mi=l('<button class="svelte-1w535im">cancel</button>'),gi=l("<!> <!>",1),hi=l('<button class="svelte-1w535im"> </button>'),bi=l('<div style="text-align: left;"><!> <!> <!></div>'),ki=l('<div><!> <div class=" duel_desk_center v_flex svelte-1w535im"><div class="duel_field_header svelte-1w535im"><!></div> <div class="duel_field_body svelte-1w535im"><!></div> <div class="duel_field_footer svelte-1w535im"><!></div></div> <!></div> <div style="position:fixed;bottom:0"> </div> <!> <div><!></div>',1);function xi(d,i){gt(i,!1);let t=We(i,"duel",12),c=We(i,"userProfile",8),u=me(0),v=me(0),y=me([]),o=me([]),q=()=>{},Q=me([]),D=me(),S=me(),n=me(()=>!1),H=me(!1);const Z=f=>{q=f.resolve,C(Q,f.dummyActionInfos.filter(g=>g.action.entity.entityType==="Duelist").filter(g=>g.action.entity.controller.seat==="Below")),C(D,void 0),C(S,void 0),C(o,[]),C(y,[]),C(H,!1),f.entitiesChoices&&(C(D,f.entitiesChoices),C(n,()=>{var g;return((g=f.entitiesChoices)==null?void 0:g.validator(e(y)))??!1}),C(H,f.entitiesChoices.cancelable),e(D).selectables.every(g=>g.cell.isPlayFieldCell&&g.getIndexInCell()===0||g.cell.cellType==="Hand"&&g.controller.duelistType==="Player"||g.entityType==="Duelist")||t().view.modalController.entitySelector.show({title:t().view.message,position:"Middle",entitiesChoices:f.entitiesChoices,chainBlockInfos:f.chainBlockInfos,cancelable:f.entitiesChoices.cancelable}).then(g=>{q({selectedEntities:g})})),f.cellsChoices&&(C(S,f.cellsChoices),C(n,()=>{var g;return((g=f.cellsChoices)==null?void 0:g.validator(e(o)))??!1}),C(H,f.cellsChoices.cancelable))};t().view.onWaitStart.append(Z);const V=()=>{q=()=>{},C(S,void 0),C(D,void 0),C(o,[]),C(y,[]),C(n,()=>!1),C(H,!1)};t().view.onWaitEnd.append(V);let N=me(void 0),F=me("Normal");const fe=({card:f,mode:g})=>{C(N,f),C(F,g??(e(N)===f||e(F)==="Normal"?"Detail":"Normal"))};t().view.onShowCardEntity.append(fe);const we=()=>{t(t())};t().view.onDuelUpdate.append(we),t().log.onUpdate.append(we);const Se=()=>{e(D)&&e(D).validator(e(y))&&q({selectedEntities:e(y)}),e(S)&&e(S).validator(e(o))&&q({selectedCells:e(o)})},k=()=>{q({})},j=f=>{q({actionInfo:f})},te=()=>{q({surrender:!0})};t().main();const ee=()=>e(u)<=1400?"compact":"wide";ht();var ne=ki(),he=U(ne),ie=a(he);{var je=f=>{var g=_i(),L=a(g);Ha(L,{get duelist(){return t().duelists.Above}});var K=s(L,2);Vs(K,{get entity(){return e(N)},get mode(){return e(F)}});var $e=s(K,2);Ha($e,{get duelist(){return t().duelists.Below}}),r(f,g)};b(ie,f=>{ee()==="wide"&&f(je)})}var Oe=s(ie,2),B=a(Oe),A=a(B);{var re=f=>{var g=ui(),L=U(g),K=a(L),$e=s(L,2),Ce=a($e);_(()=>p(K,`[TURN:${t().clock.turn}][PHASE:${t().phase}] ${t().view.message}`)),_e("click",L,()=>{t(t().view.infoBoardState="Log",!0)}),_e("click",Ce,te),r(f,g)};b(A,f=>{t().isEnded||f(re)})}var pe=s(B,2),Be=a(pe);{var P=f=>{var g=pi(),L=a(g);ce(L,5,()=>t().field.cells,ue,(K,$e,Ce)=>{var be=fi();Ee(be,`${`duel_desk_row_${Ce}`??""} svelte-1w535im`),ce(be,5,()=>e($e),ue,(J,G,I)=>{Zr(J,{get view(){return t().view},row:Ce,column:I,get selectedEntities(){return e(y)},set selectedEntities(ke){C(y,ke)},get selectedCells(){return e(o)},set selectedCells(ke){C(o,ke)},$$legacy:!0})}),r(K,be)}),r(f,g)};b(Be,f=>{t().clock.turn>0&&f(P)})}var E=s(pe,2),Y=a(E);{var W=f=>{var g=gi(),L=U(g);{var K=be=>{var J=yi();_(G=>J.disabled=G,[()=>!e(n)()],oe),_e("click",J,Se),r(be,J)};b(L,be=>{((e(D)&&e(D).qty)??(e(S)&&e(S).qty)??9999)>1&&be(K)})}var $e=s(L,2);{var Ce=be=>{var J=mi();_e("click",J,k),r(be,J)};b($e,be=>{e(H)&&be(Ce)})}r(f,g)},ae=f=>{var g=De(),L=U(g);ce(L,1,()=>e(Q),ue,(K,$e)=>{var Ce=hi(),be=a(Ce);_(()=>p(be,e($e).action.title)),_e("click",Ce,()=>j(e($e))),r(K,Ce)}),r(f,g)};b(Y,f=>{e(D)&&e(D).selectables.length||e(S)&&e(S).selectables?f(W):f(ae,!1)})}var h=s(Oe,2);{var O=f=>{var g=bi(),L=a(g);ds(L,{get log(){return t().log}});var K=s(L,2);Js(K,{get cell(){return t().view.infoBoardCell}});var $e=s(K,2);ti($e,{get userProfile(){return c()},get viewController(){return t().view}}),_(Ce=>Ee(g,`duel_desk_right duel_desk_right_${Ce??""}  svelte-1w535im`),[()=>t().view.infoBoardState.toLowerCase()],oe),se(3,g,()=>ge,()=>({duration:e(u)>1400?0:200,axis:"x"})),r(f,g)};b(h,f=>{(e(u)>1400||t().view.infoBoardState!=="Default")&&f(O)})}var x=s(he,2),m=a(x),R=s(x,2);dr(R,{get modalController(){return t().view.modalController}});var ye=s(R,2),M=a(ye);const T=oe(()=>ee()==="wide"?"right":"left");di(M,{get duel(){return t()},get position(){return e(T)}}),_((f,g)=>{Ee(he,`flex duel_desk ${f??""}_mode svelte-1w535im`),p(m,g),Ee(ye,`cutin ${f??""}_mode svelte-1w535im`)},[ee,()=>t().clock.toFullString()],oe),sa("innerWidth",f=>C(u,f)),sa("innerHeight",f=>C(v,f)),r(d,ne),bt()}var wi=l('<div class="svelte-1yfuu8d"><button class="button_style_reset svelte-1yfuu8d">クリア</button></div>'),Ci=l("<div></div>"),Di=l("<!> <!> <!> <!>",1),$i=l('<span> </span> / <span style="display: inline-block;width:2rem;text-align: right;"> </span>',1),Si=l('<li class="deck_editor_item svelte-1yfuu8d"><div role="listitem"><div class="svelte-1yfuu8d"><div class="svelte-1yfuu8d"> </div> <div style="display:flex; flex-wrap: wrap;" class="svelte-1yfuu8d"><div style="text-wrap-mode: nowrap;" class="svelte-1yfuu8d"><!> <!> <!></div> <div style="flex-grow: 1; height:0px; width:0px" class="svelte-1yfuu8d"></div> <div style="text-wrap-mode: nowrap;" class="svelte-1yfuu8d"><!></div></div></div></div> <button class="button_style_reset plus_minus_button svelte-1yfuu8d">+</button> <button class="button_style_reset plus_minus_button svelte-1yfuu8d">-</button></li>'),Mi=l('<div class="deck_editor_card_kind_header svelte-1yfuu8d"><div class="svelte-1yfuu8d"> <!> 枚） <!></div> <div style="display: flex;" class="svelte-1yfuu8d"><!> <div class="triangle svelte-1yfuu8d">▲</div></div></div> <div class="deck_editor_card_kind_body svelte-1yfuu8d"><ul></ul></div>',1),Ti=l("<div><!></div>"),ji=l('<div class="deck_editor_card_list svelte-1yfuu8d"></div>');function Oa(d,i){gt(i,!1);let t=We(i,"allCardTree",8),c=We(i,"deckCardTree",12),u=We(i,"mode",8),v=We(i,"onAttention",8),y=We(i,"searchCondition",8,void 0),o=me("ExtraMonster");const q=fa.terminalTypeName==="PC"?500:fa.terminalTypeName==="Tablet Device"?300:100,Q=20;let D=me(Q);const S=(k=!1)=>{if(k||C(D,Q),C(D,e(D)+10),u()==="List"){if(e(D)>=q)return}else if(e(D)>ur(...Object.values(c()).map(j=>j.length)))return;It(100).then(()=>S(!0))},n=me(u()==="List"?t():c()),H=(...k)=>{const j=k.length?k:Ft(e(n)),te=(ee,ne)=>{var he;return Ta(ee,ne,(he=y())==null?void 0:he.sort.filter(ie=>ie.priority>0).toSorted((ie,je)=>ie.priority-je.priority))};j.forEach(ee=>e(n)[ee].sort(te))},Z=(k,j)=>{c(c()[j]=[],!0)},V=(k,j)=>{const te=ua(j),ee=c()[te].filter(he=>he.name===j.name).length;let ne=k.shiftKey?3-ee:1;console.debug(j,te,ee,ne),!k.ctrlKey&&ee>2&&(ne=0),ne&&c(c()[te]=[...c()[te],...Array(ne).fill(j)].sort(Ta),!0),v()(j)},N=(k,j)=>{const te=ua(j);let ee=0;c(c()[te]=c()[te].filter(ne=>ne.name!==j.name?!0:(ee++,!k.shiftKey&&ee>1)),!0),v()(j)};let F=me(structuredClone(e(n))),fe=me("");const we=k=>{if(!y())return!0;if(k.kind==="XyzMaterial")return!1;const j=ua(k);if(!y().deckCardKinds.includes(j)||y().name.trim().length&&[k.name,...k.nameTags??[],...k.textTags??[]].every(ee=>!ee.includes(y().name))||!k.isImplemented&&!y().others.includes("implemented")||k.isForTest&&!y().others.includes("test")||k.isOldVersion&&!y().others.includes("oldVersion"))return!1;if(k.kind==="Monster"){if(k.attributes&&!y().monsterAttributes.union(k.attributes).length||k.types&&!y().monsterTypes.union(k.types).length)return!1;const te=k.level??k.rank??k.link;return At(y().starLowerBound)&&(te??0)<y().starLowerBound||At(y().starUpperBound)&&(te??0)>y().starUpperBound||At(y().atkLowerBound)&&(k.attack??0)<y().atkLowerBound||At(y().atkUpperBound)&&(k.attack??0)>y().atkUpperBound||At(y().defLowerBound)&&(k.defense??0)<y().defLowerBound||At(y().defUpperBound)&&(k.defense??0)>y().defUpperBound||At(y().atkPlusDef)&&(!At(k.attack)||!At(k.defense)||k.attack+k.defense!==y().atkPlusDef)||!k.monsterCategories||j==="ExtraMonster"&&!k.monsterCategories.union(y().exMonsterCategories).length?!1:k.monsterCategories.union(y().monsterCategories).length}if(k.kind==="Spell")return k.spellCategory&&y().spellCategories.includes(k.spellCategory);if(k.kind==="Trap")return k.trapCategory&&y().trapCategories.includes(k.trapCategory)};Ma(()=>(aa(u()),e(n),aa(c()),e(o),e(F)),()=>{if(u()==="Deck"){if(Ft(e(n)).forEach(k=>xe(n,e(n)[k]=c()[k])),!e(n)[e(o)].length)C(o,Ft(e(n)).find(k=>e(n)[k].find(we))??"ExtraMonster");else{const k=Ft(e(n)).map(j=>({kind:j,cardInfos:e(n)[j]})).filter(({cardInfos:j})=>j.length).find(({kind:j,cardInfos:te})=>te.length!==e(F)[j].length);k&&e(o)!==k.kind&&C(o,k.kind)}C(F,structuredClone(e(n)))}}),Ma(()=>(aa(u()),aa(y()),e(fe)),()=>{var k;if(u()==="List"){const j=JSON.stringify((k=y())==null?void 0:k.sort);e(fe)!==j&&(C(fe,j),H()),S()}}),cr(),ht();var Se=ji();ce(Se,5,()=>zt,ue,(k,j,te)=>{var ee=Ti();const ne=oe(()=>e(n)[e(j)].filter(we));var he=a(ee);{var ie=je=>{var Oe=Mi(),B=U(Oe),A=a(B),re=a(A),pe=s(re);{var Be=x=>{var m=rt();_(R=>p(m,`/ ${R??""}`),[()=>e(n)[e(j)].length.toLocaleString()],oe),r(x,m)};b(pe,x=>{u()==="List"&&x(Be)})}var P=s(pe,2);{var E=x=>{var m=rt();_(R=>p(m,`※表示上限${R??""}枚`),[()=>q.toLocaleString()],oe),r(x,m)};b(P,x=>{e(ne).length>q&&x(E)})}var Y=s(A,2),W=a(Y);{var ae=x=>{var m=wi(),R=a(m);_e("click",R,ye=>Z(ye,e(j))),r(x,m)};b(W,x=>{u()==="Deck"&&e(ne).length&&x(ae)})}var h=s(B,2),O=a(h);ce(O,5,()=>e(ne),ue,(x,m,R)=>{var ye=De(),M=U(ye);{var T=f=>{var g=Si(),L=a(g),K=a(L),$e=a(K),Ce=a($e),be=s($e,2),J=a(be),G=a(J);{var I=z=>{var de=Di(),Ne=U(de);{var Ze=X=>{var le=rt();_(()=>p(le,`★${e(m).level??""}`)),r(X,le)},Re=X=>{var le=De(),Me=U(le);{var Ge=Ke=>{var Ye=rt();_(()=>p(Ye,`☆${e(m).rank??""}`)),r(Ke,Ye)},Ue=Ke=>{var Ye=De(),Ie=U(Ye);{var Xe=lt=>{var $t=rt();_(()=>p($t,`Ｌ${e(m).link??""}`)),r(lt,$t)};b(Ie,lt=>{e(m).link&&lt(Xe)},!0)}r(Ke,Ye)};b(Me,Ke=>{e(m).rank?Ke(Ge):Ke(Ue,!1)},!0)}r(X,le)};b(Ne,X=>{e(m).level?X(Ze):X(Re,!1)})}var Ve=s(Ne,2);ce(Ve,1,()=>e(m).attributes??[],ue,(X,le)=>{var Me=Ci();_(()=>Ee(Me,`monster_attr ${e(le)??""} svelte-1yfuu8d`)),r(X,Me)});var $=s(Ve,2);ce($,1,()=>e(m).types??[],ue,(X,le)=>{var Me=rt();_(()=>p(Me,la[e(le)])),r(X,Me)});var w=s($,2);ce(w,1,()=>e(m).monsterCategories??[],ue,(X,le)=>{var Me=rt();_(()=>p(Me,Jt[e(le)])),r(X,Me)}),r(z,de)};b(G,z=>{e(m).kind==="Monster"&&z(I)})}var ke=s(G,2);{var He=z=>{var de=rt();_(()=>p(de,`${oa[e(m).spellCategory]??""}魔法`)),r(z,de)};b(ke,z=>{e(m).spellCategory&&z(He)})}var qe=s(ke,2);{var Pe=z=>{var de=rt();_(()=>p(de,`${va[e(m).trapCategory]??""}罠`)),r(z,de)};b(qe,z=>{e(m).trapCategory&&z(Pe)})}var Le=s(J,4),ze=a(Le);{var nt=z=>{var de=$i(),Ne=U(de),Ze=a(Ne),Re=s(Ne,2),Ve=a(Re);_(()=>{p(Ze,e(m).attack??"?"),p(Ve,e(m).defense??"?")}),r(z,de)};b(ze,z=>{e(m).kind==="Monster"&&z(nt)})}var Te=s(L,2),ve=s(Te,2);_((z,de)=>{Ee(L,`${z??""} svelte-1yfuu8d`),p(Ce,e(m).name),Te.disabled=!e(m).isImplemented,xt(Te,"title",e(m).isImplemented?`※shiftキー同時押しで一括投入
※ctrlキー同時押しで枚数制限無視`:""),ve.disabled=de,xt(ve,"title",e(m).isImplemented?"※shiftキー同時押しで一括外し":"")},[()=>{var z,de;return`deck_editor_card duel_card ${e(m).kind} ${(de=(z=e(m))==null?void 0:z.monsterCategories)==null?void 0:de.join(" ")} ${e(m).isImplemented?"is_implemented":"is_not_implemented"}`},()=>u()!=="Deck"&&c()[e(j)].every(z=>z.name!==e(m).name)],oe),_e("click",L,()=>v()(e(m))),_e("click",Te,z=>V(z,e(m))),_e("click",ve,z=>N(z,e(m))),r(f,g)};b(M,f=>{R<e(D)&&(R<20||e(o)===e(j))&&f(T)})}r(x,ye)}),_(x=>{p(re,`${Ia[e(j)]??""}（${x??""} `),Ee(O,_r(e(j)),"svelte-1yfuu8d")},[()=>e(ne).length.toLocaleString()],oe),_e("click",B,()=>{if(e(o)!==e(j)){C(o,e(j));return}C(o,zt.map((x,m)=>m+te).map(x=>x%zt.length).map(x=>zt[x]).filter(x=>x!==e(j)).find(x=>e(n)[x].find(we))??e(j))}),r(je,Oe)};b(he,je=>{e(ne).length&&je(ie)})}_(()=>Ee(ee,`deck_editor_card_kind deckCardKind ${(e(j)===e(o)?"selected":"")??""} ${(e(ne).length?"":"empty")??""} svelte-1yfuu8d`)),r(k,ee)}),r(d,Se),bt()}var Bi=l('<div class="svelte-rccxcp"> </div>'),Ei=l('<div class="svelte-rccxcp"> </div>'),Ai=l('<div class="link_arrow_emoji svelte-rccxcp"> </div>'),Li=l('<div class="duel_card_info_row svelte-rccxcp" style="position:sticky; top:0;"><!></div>'),Ui=l('<div class="duel_card_info_row svelte-rccxcp"><div class="svelte-rccxcp"><pre class="description svelte-rccxcp"> </pre></div></div> <div class="duel_card_info_row svelte-rccxcp" style=" justify-content: space-between;"><div class="svelte-rccxcp"> </div> <div class="svelte-rccxcp"> </div></div>',1),Yi=l('<div></div> <div class="svelte-rccxcp"> </div>',1),Ni=l("<div> </div>"),qi=l('<span class="svelte-rccxcp">/</span> <div class="monster_defense svelte-rccxcp"> </div>',1),Pi=l("<div> </div>"),Fi=l('<div class="duel_card_info_row svelte-rccxcp"><!> <!> <div style="flex-grow: 1;" class="svelte-rccxcp"></div> <div class="monster_attack svelte-rccxcp"> </div> <!></div> <div class="duel_card_info_row svelte-rccxcp"></div>',1),Hi=l('<div class="duel_card_row svelte-rccxcp"><div class="svelte-rccxcp"></div> <div class="svelte-rccxcp"> </div></div>'),Oi=l('<div class="duel_card_row svelte-rccxcp"><div class="svelte-rccxcp"></div> <div class="svelte-rccxcp"> </div></div>'),Ri=l('<div class="duel_card_info_row svelte-rccxcp"><div class="svelte-rccxcp">※エラッタ前カードです</div></div>'),Wi=l('<div class="duel_card_info_row svelte-rccxcp"><div class="svelte-rccxcp">※テスト用カードです</div></div>'),Ki=l('<div class="duel_card_info_links svelte-rccxcp"><a target="_blank" rel="noopener noreferrer" title="遊戯王カードWiki" class="svelte-rccxcp">⇒遊戯王カードWiki</a> <a target="_blank" rel="noopener noreferrer" title="コナミカードデータベース" class="svelte-rccxcp"> </a></div>'),Ii=l('<div><div class="duel_card_info_header svelte-rccxcp"><div class="duel_card_info_row svelte-rccxcp"><div class="svelte-rccxcp"> </div></div> <!></div> <div class="duel_card_info_body svelte-rccxcp"><!> <!> <div class="duel_card_info_row description svelte-rccxcp"><div class="svelte-rccxcp"><pre class="description svelte-rccxcp"> </pre></div></div> <!> <!></div></div>');function zi(d,i){gt(i,!1);let t=We(i,"cardInfo",8,void 0),c=We(i,"onAttention",8);ht();var u=De(),v=U(u);{var y=o=>{var q=Ii(),Q=a(q),D=a(Q),S=a(D),n=a(S),H=s(D,2);{var Z=B=>{var A=Li(),re=a(A);{var pe=P=>{var E=Bi(),Y=a(E);_(W=>p(Y,W),[()=>"★".repeat(t().level)],oe),r(P,E)},Be=P=>{var E=De(),Y=U(E);{var W=h=>{var O=Ei(),x=a(O);_(m=>p(x,m),[()=>"★".repeat(t().rank)],oe),r(h,O)},ae=h=>{var O=De(),x=U(O);{var m=R=>{var ye=Ai(),M=a(ye);_(T=>p(M,T),[()=>t().linkArrowKeys.map(T=>Ka[T].emoji).join("")],oe),r(R,ye)};b(x,R=>{t().linkArrowKeys&&R(m)},!0)}r(h,O)};b(Y,h=>{t().rank&&t().rank>0?h(W):h(ae,!1)},!0)}r(P,E)};b(re,P=>{t().level&&t().level>0?P(pe):P(Be,!1)})}r(B,A)};b(H,B=>{t().kind==="Monster"&&B(Z)})}var V=s(Q,2),N=a(V);{var F=B=>{var A=Ui(),re=U(A),pe=a(re),Be=a(pe),P=a(Be),E=s(re,2),Y=a(E),W=a(Y),ae=s(Y,2),h=a(ae);_(()=>{p(P,t().pendulumDescription),p(W,`◀ ${t().pendulumScaleL??""}`),p(h,`${t().pendulumScaleR??""} ▶`)}),r(B,A)};b(N,B=>{var A;(A=t().monsterCategories)!=null&&A.includes("Pendulum")&&B(F)})}var fe=s(N,2);{var we=B=>{var A=Fi(),re=U(A),pe=a(re);{var Be=x=>{var m=Yi(),R=U(m),ye=s(R,2),M=a(ye);_(()=>{Ee(R,`monster_attr ${t().attributes[0]??""} svelte-rccxcp`),p(M,`${ga[t().attributes[0]]??""}属性`)}),r(x,m)};b(pe,x=>{t().attributes&&x(Be)})}var P=s(pe,2);{var E=x=>{var m=Ni(),R=a(m);_(()=>{Ee(m,`monster_cat ${t().types[0]??""} svelte-rccxcp`),p(R,`${la[t().types[0]]??""}${ha[t().types[0]]??""}族`)}),r(x,m)};b(P,x=>{t().types&&x(E)})}var Y=s(P,4),W=a(Y),ae=s(Y,2);{var h=x=>{var m=qi(),R=s(U(m),2),ye=a(R);_(()=>p(ye,t().defense??"?")),r(x,m)};b(ae,x=>{var m;(m=t().monsterCategories)!=null&&m.includes("Link")||x(h)})}var O=s(re,2);ce(O,5,()=>t().monsterCategories??[],ue,(x,m)=>{var R=Pi(),ye=a(R);_(()=>{Ee(R,`monster_cat ${e(m)??""} svelte-rccxcp`),p(ye,`${Jt[e(m)]??""}${ra[e(m)]??""}`)}),r(x,R)}),_(()=>p(W,t().attack??"?")),r(B,A)},Se=B=>{var A=De(),re=U(A);{var pe=P=>{var E=Hi(),Y=s(a(E),2),W=a(Y);_(()=>p(W,`${oa[t().spellCategory]??""}魔法`)),r(P,E)},Be=P=>{var E=De(),Y=U(E);{var W=ae=>{var h=Oi(),O=s(a(h),2),x=a(O);_(()=>p(x,`${va[t().trapCategory]??""}罠`)),r(ae,h)};b(Y,ae=>{t().kind==="Trap"&&t().trapCategory&&ae(W)},!0)}r(P,E)};b(re,P=>{t().kind==="Spell"&&t().spellCategory?P(pe):P(Be,!1)},!0)}r(B,A)};b(fe,B=>{t().kind==="Monster"?B(we):B(Se,!1)})}var k=s(fe,2),j=a(k),te=a(j),ee=a(te),ne=s(k,2);{var he=B=>{var A=Ri();r(B,A)};b(ne,B=>{t().isOldVersion&&B(he)})}var ie=s(ne,2);{var je=B=>{var A=Wi();r(B,A)},Oe=B=>{var A=Ki(),re=a(A),pe=s(re,2),Be=a(pe);_(P=>{xt(re,"href",`https://yugioh-wiki.net/index.php?${t().wikiEncodedName}`),xt(pe,"href",P),p(Be,`⇒${(t().cardId?"公式カードページ":"公式で検索")??""}`)},[()=>fr(t())],oe),r(B,A)};b(ie,B=>{t().isForTest?B(je):B(Oe,!1)})}_(B=>{Ee(q,`duel_card duel_card_info ${t().kind??""} ${B??""} svelte-rccxcp`),p(n,t().name),p(ee,t().description)},[()=>{var B;return(B=t().monsterCategories)==null?void 0:B.join(" ")}],oe),_e("click",q,()=>c()(t())),r(o,q)};b(v,o=>{t()&&o(y)})}r(d,u),bt()}const Vi={0:{aaa:"日",aaaa:"日曜日",ddd:"Sun",dddd:"Sunday"},1:{aaa:"月",aaaa:"月曜日",ddd:"Mon",dddd:"Monday"},2:{aaa:"火",aaaa:"火曜日",ddd:"Tue",dddd:"Tuesday"},3:{aaa:"水",aaaa:"水曜日",ddd:"Wed",dddd:"Wednesday"},4:{aaa:"木",aaaa:"木曜日",ddd:"Thu",dddd:"Thursday"},5:{aaa:"金",aaaa:"金曜日",ddd:"Fri",dddd:"Friday"},6:{aaa:"土",aaaa:"土曜日",ddd:"Sat",dddd:"Saturday"}};class Gi{constructor(){dt(this,"DefaultSeparator1","/");dt(this,"DefaultSeparator2"," ");dt(this,"DefaultSeparator3",":");dt(this,"createDate",i=>{if(!i)return;const t=new Date(i);if(!isNaN(t.getTime()))return t});dt(this,"createDateOr",(i,t)=>this.createDate(i)||t||new Date);dt(this,"truncateDate",i=>{const t=i||new Date;return new Date(t.getFullYear(),t.getMonth(),t.getDate())});dt(this,"addDate",(i,t)=>{const c=this.createDateOr(i);return c.setDate(c.getDate()+t),c});dt(this,"addMonth",(i,t)=>{const c=this.createDateOr(i);return c.setMonth(c.getMonth()+t),c});dt(this,"addYear",(i,t)=>{const c=this.createDateOr(i);return c.setFullYear(c.getFullYear()+t),c});dt(this,"getDayOfWeek",(i,t="dddd")=>{const c=this.createDate(i);return c?Vi[c.getDay()][t]:""});dt(this,"formatToYYYYMMDD",(i,t=this.DefaultSeparator1)=>{const c=this.createDate(i);if(!c)return"";const u=c.getFullYear().toString(),v=("0"+(c.getMonth()+1)).slice(-2),y=("0"+c.getDate()).slice(-2);return u+t+v+t+y});dt(this,"formatToYYYYMM",(i,t=this.DefaultSeparator1)=>{const c=this.createDate(i);if(!c)return"";t||(t="");const u=c.getFullYear().toString(),v=("0"+(c.getMonth()+1)).slice(-2);return u+t+v});dt(this,"formatToHHMMSS",(i,t=this.DefaultSeparator3)=>{const c=this.createDate(i);if(!c)return"";t||(t="");const u=c.getHours(),v=c.getMinutes(),y=c.getSeconds();return("0"+u).slice(-2)+t+("0"+v).slice(-2)+t+("0"+y).slice(-2)});dt(this,"formatToHHMM",(i,t=this.DefaultSeparator3)=>{const c=this.createDate(i);if(!c)return"";t||(t="");const u=("0"+c.getHours()).slice(-2),v=("0"+c.getMinutes()).slice(-2);return u+t+v});dt(this,"formatToYYYYMMDD_HHMM",(i,t=this.DefaultSeparator1,c=this.DefaultSeparator2,u=this.DefaultSeparator3)=>{const v=this.createDate(i);return v?this.formatToYYYYMMDD(v,t)+c+this.formatToHHMM(v,u):""});dt(this,"formatToYYYYMMDD_HHMMSS",(i,t=this.DefaultSeparator1,c=this.DefaultSeparator2,u=this.DefaultSeparator3)=>{const v=this.createDate(i);return v?this.formatToYYYYMMDD(v,t)+c+this.formatToHHMMSS(v,u):""})}}const wt=new Gi;Date.prototype.truncateDate=function(){return wt.truncateDate(this)};Date.prototype.getCloneOr=function(d){return wt.createDateOr(this,d)};Date.prototype.addDate=function(d){return wt.addDate(this,d)};Date.prototype.addMonth=function(d){return wt.addDate(this,d)};Date.prototype.addYear=function(d){return wt.addDate(this,d)};Date.prototype.getDayOfWeek=function(d="dddd"){return wt.getDayOfWeek(this,d)};Date.prototype.formatToYYYYMM=function(d){return wt.formatToYYYYMM(this,d)};Date.prototype.formatToYYYYMMDD=function(d){return wt.formatToYYYYMMDD(this,d)};Date.prototype.formatToYYYYMMDD_HHMM=function(d,i,t){return wt.formatToYYYYMMDD_HHMM(this,d,i,t)};Date.prototype.formatToYYYYMMDD_HHMMSS=function(d,i,t){return wt.formatToYYYYMMDD_HHMMSS(this,d,i,t)};Date.prototype.formatToHHMM=function(d){return wt.formatToHHMM(this,d)};Date.prototype.formatToHHMMSS=function(d){return wt.formatToHHMMSS(this,d)};var Qi=l('<li class="deck_info_list_item svelte-2wdgc8"><div class="svelte-2wdgc8"> </div> <div class="svelte-2wdgc8"> </div> <div class="svelte-2wdgc8"> </div></li>'),Xi=l('<ul class="deck_info_list svelte-2wdgc8"></ul>'),Ji=l('<label for="file_selector" class="upload_area svelte-2wdgc8" role="region" aria-label="ファイルアップロードエリア"><div class="upload_area_message svelte-2wdgc8">ここにファイルをドロップ</div> <div class="upload_area_footer svelte-2wdgc8"><input type="file" id="file_selector" name="file_selector" accept=".json" multiple></div></label>'),Zi=l('<div slot="body" class="modal_body svelte-2wdgc8"><!></div>'),en=l('<button class="svelte-2wdgc8">追加</button> <button class="svelte-2wdgc8">削除して追加</button> <button class="svelte-2wdgc8">戻る</button>',1),tn=l('<button class="svelte-2wdgc8">Cancel</button>'),an=l('<div slot="footer" class="modal_window_footer svelte-2wdgc8"><!></div>');function rn(d,i){gt(i,!1);let t=We(i,"eventHolder",8),c=We(i,"args",8),u=We(i,"resolve",8),v=me(Promise.resolve([])),y=me();const o=()=>{C(y,new DataTransfer().files),C(v,Promise.resolve([]))},q=async H=>{H.preventDefault(),console.log("hoge",H)},Q=async H=>{H.preventDefault(),H.dataTransfer&&S(H.dataTransfer.files)},D=()=>{S(e(y))},S=async H=>{if(!H.length)return;const Z=[],V=[];for(const N of H)try{V.push(...await Dt.createfromJson(N))}catch(F){F instanceof Error&&Z.push(F.message)}if(Z.length){console.log(...Z);return}C(v,e(v).then(()=>V))},n=o;ht(),pr(d,{get eventHolder(){return t()},get args(){return c()},$$slots:{body:(H,Z)=>{var V=Zi(),N=a(V);kt(N,()=>Xt,null,(F,fe)=>{var we=De(),Se=U(we);kt(Se,()=>e(v),null,(k,j)=>{var te=De(),ee=U(te);{var ne=ie=>{var je=Xi();ce(je,5,()=>e(j),ue,(Oe,B)=>{var A=Qi(),re=a(A),pe=a(re),Be=s(re,2),P=a(Be),E=s(Be,2),Y=a(E);_((W,ae,h)=>{p(pe,e(B).name),p(P,`${W??""}
                  /
                  ${ae??""}`),p(Y,`最終使用日時 ： ${h??""}`)},[()=>e(B).cardNames.filter(W=>{var ae,h;return!((h=(ae=e(fe).getCardInfo(W))==null?void 0:ae.monsterCategories)!=null&&h.union(Vt).length)}).length,()=>e(B).cardNames.filter(W=>{var ae,h;return(h=(ae=e(fe).getCardInfo(W))==null?void 0:ae.monsterCategories)==null?void 0:h.union(Vt).length}).length,()=>e(B).lastUsedAt.formatToYYYYMMDD_HHMM("/"," ",":")],oe),r(Oe,A)}),r(ie,je)},he=ie=>{var je=Ji(),Oe=s(a(je),2),B=a(Oe);yr(B,()=>e(y),A=>C(y,A)),_e("change",B,D),_e("cancel",B,n),_e("drop",je,Q),_e("dragover",je,q),r(ie,je)};b(ee,ie=>{e(j).length?ie(ne):ie(he,!1)})}r(k,te)}),r(F,we)}),r(H,V)},footer:(H,Z)=>{var V=an(),N=a(V);kt(N,()=>e(v),null,(F,fe)=>{var we=De(),Se=U(we);{var k=te=>{var ee=en(),ne=U(ee),he=s(ne,2),ie=s(he,2);_(()=>{ne.disabled=e(fe).length===0,he.disabled=e(fe).length===0}),_e("click",ne,()=>u()({deckInfos:e(fe),replaceAll:!1})),_e("click",he,()=>u()({deckInfos:e(fe),replaceAll:!0})),_e("click",ie,n),r(te,ee)},j=te=>{var ee=De(),ne=U(ee);{var he=ie=>{var je=tn();_e("click",je,()=>u()(void 0)),r(ie,je)};b(ne,ie=>{c().cancelable&&ie(he)},!0)}r(te,ee)};b(Se,te=>{e(fe).length?te(k):te(j,!1)})}r(F,we)}),r(H,V)}}}),bt()}const na=class na extends gr{constructor(i,t){super(i,...Object.values(t))}};dt(na,"createModalController",i=>{const t={deckUploader:new hr({title:"デッキ情報をアップロード",position:"Middle",cancelable:!1})};return Object.assign(new na(i,t),t)});let ma=na;function sn(d,i){gt(i,!1);let t=We(i,"modalController",8);ht(),mr(d,{get modalController(){return t()},children:(c,u)=>{var v=De(),y=U(v);{var o=q=>{rn(q,{get eventHolder(){return t().eventHolder},get args(){return t().deckUploader.args},get resolve(){return t().deckUploader.resolve}})};b(y,q=>{t().deckUploader.state==="Shown"&&q(o)})}r(c,v)},$$slots:{default:!0}}),bt()}var nn=l("<button> </button>"),ln=l('<label class="svelte-n46fl7"><input type="checkbox" class="search_condition svelte-n46fl7"> </label>'),on=l('<label class="svelte-n46fl7"><input type="checkbox" class="search_condition svelte-n46fl7"> </label>'),vn=l('<div class="deck_editor_search_box_row monster_ex_categories svelte-n46fl7"><div class="svelte-n46fl7"><button class="search_condition_title black_button svelte-n46fl7">エクストラ</button></div> <div class="svelte-n46fl7"></div></div>'),dn=l('<label class="svelte-n46fl7"><input type="checkbox" class="search_condition svelte-n46fl7"> </label>'),cn=l('<label class="svelte-n46fl7"><input type="checkbox" class="search_condition svelte-n46fl7"> <div style="display: inline-block;"></div> </label>'),_n=l('<label class="svelte-n46fl7"><input type="checkbox" class="search_condition svelte-n46fl7"> </label>'),un=l('<div class="deck_editor_search_box_row monster_categories svelte-n46fl7"><div class="svelte-n46fl7"><button class="search_condition_title black_button svelte-n46fl7">モンスター</button></div> <div class="svelte-n46fl7"></div></div> <div class="deck_editor_search_box_row monster_attributes svelte-n46fl7"><div class="svelte-n46fl7"><button class="search_condition_title black_button svelte-n46fl7">属性</button></div> <div class="svelte-n46fl7"></div></div> <div class="deck_editor_search_box_row svelte-n46fl7"><div class="svelte-n46fl7"><button class="search_condition_title black_button svelte-n46fl7">種族</button></div> <div class="svelte-n46fl7"></div></div> <div class="deck_editor_search_box_row svelte-n46fl7"><div class="svelte-n46fl7"><button class="search_condition_title black_button svelte-n46fl7">星攻守</button></div> <div class="svelte-n46fl7"><div class="star_range svelte-n46fl7"><span class="svelte-n46fl7">星</span> <input type="number" min="0" max="13" class="svelte-n46fl7"> <span class="svelte-n46fl7">～</span> <input type="number" min="0" max="13" class="svelte-n46fl7"></div> <div class="atk_range svelte-n46fl7"><span class="svelte-n46fl7">攻</span> <input type="number" min="0" max="5000" step="100" class="svelte-n46fl7"> <span class="svelte-n46fl7">～</span> <input type="number" min="0" max="5000" step="100" class="svelte-n46fl7"></div> <div class="def_range svelte-n46fl7"><span class="svelte-n46fl7">守</span> <input type="number" min="0" max="5000" step="100" class="svelte-n46fl7"> <span class="svelte-n46fl7">～</span> <input type="number" min="0" max="5000" step="100" class="svelte-n46fl7"></div> <div class="atk_plus_def svelte-n46fl7"><span class="svelte-n46fl7">攻+守</span> <input type="number" min="0" max="10000" step="100" class="svelte-n46fl7"></div></div></div>',1),fn=l('<label class="svelte-n46fl7"><input type="checkbox" class="search_condition svelte-n46fl7"> </label>'),pn=l('<div class="deck_editor_search_box_row svelte-n46fl7"><div class="svelte-n46fl7"><button class="search_condition_title black_button svelte-n46fl7">魔法</button></div> <div class="svelte-n46fl7"></div></div>'),yn=l('<label class="svelte-n46fl7"><input type="checkbox" class="search_condition svelte-n46fl7"> </label>'),mn=l('<div class="deck_editor_search_box_row svelte-n46fl7"><div class="svelte-n46fl7"><button class="search_condition_title black_button svelte-n46fl7">罠</button></div> <div class="svelte-n46fl7"></div></div>'),gn=l('<label class="svelte-n46fl7"><input type="checkbox" class="search_condition svelte-n46fl7"> </label>'),hn=l("<div>カード情報読込中</div>"),bn=l("<option> </option>"),kn=l('<div class="svelte-n46fl7"><a class="white_button svelte-n46fl7" download="SVS_DeckInfos.json">ダウンロード</a></div>'),xn=l('<div class="svelte-n46fl7"></div>'),wn=l('<div class="svelte-n46fl7"><a class="white_button svelte-n46fl7" download="SVS_DeckInfos.json">ダウンロード(一括)</a></div>'),Cn=l('<div class="svelte-n46fl7"></div>'),Dn=l('<div class="deck_editor_body_right_header svelte-n46fl7"><div class="deck_editor_body_right_header_row svelte-n46fl7"><div class="svelte-n46fl7">編集対象</div> <div class="svelte-n46fl7"><select style="width:100%" class="svelte-n46fl7"></select></div></div> <div class="deck_editor_body_right_header_row svelte-n46fl7"><div class="svelte-n46fl7">新規名称</div> <div class="svelte-n46fl7"><input type="text" style="width:100%" class="svelte-n46fl7"></div></div> <div class="deck_editor_body_right_header_row svelte-n46fl7"></div> <div class="deck_editor_body_right_header_row svelte-n46fl7"><div class="svelte-n46fl7">基本操作</div> <div class="svelte-n46fl7"><button class="white_button svelte-n46fl7">デッキを保存</button></div> <div class="svelte-n46fl7"><button class="white_button svelte-n46fl7">デッキを複製</button></div> <div class="svelte-n46fl7"><button class="white_button svelte-n46fl7" title="shiftキー押下で確認メッセージスキップ">デッキを削除</button></div></div> <div class="deck_editor_body_right_header_row svelte-n46fl7"><div class="svelte-n46fl7">DL/UL</div> <!> <!> <div class="svelte-n46fl7"><button class="white_button svelte-n46fl7">アップロード</button></div></div></div> <!>',1),$n=l('<div class="svelte-n46fl7">デッキ情報読込中</div>'),Sn=l('<div class="svelte-n46fl7"></div>'),Mn=l('<div><div class="deck_editor_header svelte-n46fl7"></div> <div class="deck_editor_body svelte-n46fl7"><div class="deck_editor_body_left svelte-n46fl7"><div role="contentinfo" class="deck_editor_search_box svelte-n46fl7"><div class="deck_editor_search_box_header svelte-n46fl7"><div class="svelte-n46fl7"><button class="deck_editor_search_box_title svelte-n46fl7">検索条件</button></div> <div class="deck_editor_sort_setting_container svelte-n46fl7"></div></div> <div class="deck_editor_search_box_body svelte-n46fl7"><div class="deck_editor_search_box_row svelte-n46fl7"><div class="svelte-n46fl7"><button class="search_condition_title black_button svelte-n46fl7">名称</button></div> <div class="svelte-n46fl7"><input type="text" style="width:100%" placeholder="※ルビには対応していません" class="svelte-n46fl7"></div></div> <div class="deck_editor_search_box_row card_kind svelte-n46fl7"><div class="svelte-n46fl7"><button class="search_condition_title black_button svelte-n46fl7">種類</button></div> <div class="svelte-n46fl7"></div></div> <!> <!> <!> <!> <div class="deck_editor_search_box_row svelte-n46fl7"><div class="svelte-n46fl7"><button class="search_condition_title black_button svelte-n46fl7">その他</button></div> <div class="svelte-n46fl7"></div></div></div></div> <!></div> <div class="deck_editor_body_center svelte-n46fl7"><!></div>  <div class="deck_editor_body_right svelte-n46fl7"><!></div></div> <div class="footer svelte-n46fl7"></div></div> <!>',1);function Tn(d,i){gt(i,!1);const t=[],c=[],u=[],v=[],y=[],o=[],q=[],Q=[],D=ma.createModalController({onDragStart:{append:()=>{},remove:()=>{}},onDragEnd:{append:()=>{},remove:()=>{}}}),S={name:"",deckCardKinds:[...zt],exMonsterCategories:[...Vt],monsterCategories:La.filter($=>!Vt.includes($)),monsterAttributes:[...Aa],monsterTypes:[...Ea],spellCategories:Ba.filter($=>$!=="PendulumScale"),trapCategories:[...ja],starLowerBound:0,starUpperBound:13,atkLowerBound:0,atkUpperBound:5e3,defLowerBound:0,defUpperBound:5e3,atkPlusDef:void 0,others:["test","oldVersion","implemented"],sort:[...Ua]},n=me(structuredClone(S));xe(n,e(n).others=["oldVersion"]),xe(n,e(n).monsterCategories=e(n).monsterCategories.filter($=>$!=="Normal"));let H=me("DeckEdit"),Z=me("SearchCondition");const V=()=>{if(!e(n).deckCardKinds.length){Ft(e(n)).forEach($=>{Array.isArray(e(n)[$])&&Array.isArray(S[$])?xe(n,e(n)[$]=[...S[$]]):xe(n,e(n)[$]=S[$])});return}xe(n,e(n).name=""),xe(n,e(n).deckCardKinds=[]),xe(n,e(n).exMonsterCategories=[]),xe(n,e(n).monsterCategories=[]),xe(n,e(n).monsterAttributes=[]),xe(n,e(n).monsterTypes=[]),xe(n,e(n).spellCategories=[]),xe(n,e(n).trapCategories=[]),xe(n,e(n).others=[]),xe(n,e(n).atkLowerBound=0),xe(n,e(n).atkUpperBound=5e3),xe(n,e(n).defLowerBound=0),xe(n,e(n).defUpperBound=5e3),xe(n,e(n).atkPlusDef=void 0),xe(n,e(n).sort=[...Ua])},N=$=>{$.forEach(w=>{Array.isArray(e(n)[w])&&Array.isArray(S[w])?xe(n,e(n)[w]=e(n)[w].length?[]:[...S[w]]):xe(n,e(n)[w]=S[w])})},F=($,w,X)=>{Array.isArray(e(n)[w])&&Array.isArray(S[w])&&xe(n,e(n)[w]=[X])},fe=async()=>{const w=(await e(k)).find(le=>le.id===e(Se));if(!w)return;const X=await Xt;C(ee,{...w,cardTree:kr(w.cardNames.map(le=>{const Me=X.getCardInfo(le);return Me===void 0&&console.error(le),Me}).filter(le=>le!==void 0))})},we=()=>Dt.getAllDeckInfo().then($=>(C(Se,($.find(w=>w.lastUsedAt.getTime()===Math.max(...$.map(X=>X.lastUsedAt.getTime())))??$[0]).id),$));let Se=me(-1),k=me(we()),j=me(e(k).then($=>Dt.convertToObjectURL($)));e(k).then(fe);const te=()=>{C(k,we()),C(j,e(k).then($=>Dt.convertToObjectURL($))),fe()};let ee=me({id:-Number.MAX_VALUE,name:"",description:"",lastUsedAt:new Date,cardTree:{ExtraMonster:[],Monster:[],Spell:[],Trap:[]}}),ne=me(void 0),he=0;const ie=$=>{C(Z,"CardDetail"),$.cardId!==void 0&&!$.description&&!$.pendulumDescription&&(he=$.cardId,Wa([$.cardId]).then(()=>{$.cardId===he&&C(ne,$)})),C(ne,$)},je=async()=>{const w=(await e(k)).find(X=>X.id===e(Se));if(!w)throw new Error("illegal state");return w},Oe=async()=>{const $=await je();await $.saveDeckInfo({...$,name:e(ee).name,cardNames:Object.values(e(ee).cardTree).flatMap(w=>w).map(w=>w.name),lastUsedAt:new Date}),te()},B=async()=>{(await Dt.createNewDeck(`デッキ_${new Date().formatToYYYYMMDD_HHMMSS("","","")}`,`コピー日時：${new Date().formatToYYYYMMDD_HHMMSS("-"," ",":")}`,Object.values(e(ee).cardTree).flatMap(w=>w).map(w=>w.name))).saveDeckInfo(),te()},A=async $=>{const w=await je();!$.shiftKey&&!confirm(`デッキ【${w.name}】を削除します。
よろしいですか？`)||(await w.delete(),te())},re=async()=>{const $=await D.deckUploader.show({title:"デッキ情報アップロード",position:"Middle",cancelable:!0});if(!$)return;const w=[];if($.replaceAll){if(!confirm(`既存デッキ情報を全て削除し、アップロードしたファイルに置き換えます。
よろしいですか？`))return;w.push(...(await e(k)).map(X=>X.id))}await Promise.all($.deckInfos.map(X=>Dt.createNewDeck(X.name,X.description,X.cardNames,X.lastUsedAt))),w.length&&await Promise.all(w.map(Dt.remove)),te()},pe=()=>innerWidth<=1400?"compact":"wide";ht();var Be=Mn(),P=U(Be),E=s(a(P),2),Y=a(E),W=a(Y),ae=a(W),h=a(ae),O=a(h),x=s(h,2);ce(x,5,()=>e(n).sort,ue,($,w,X)=>{var le=nn(),Me=a(le);_(()=>{Ee(le,`deck_editor_sort_setting_item ${e(w).order??""} priority_${e(w).priority??""} svelte-n46fl7`),p(Me,`${br[e(w).key]??""}
                ${(e(w).order==="asc"?"▲":"▼")??""}`)}),_e("click",le,()=>{e(n).sort.forEach(Ge=>Ge.priority++),e(w).order=e(w).order==="asc"?"desc":"asc",Yt(()=>e(n).sort),e(w).priority=1,Yt(()=>e(n).sort)}),r($,le)});var m=s(ae,2),R=a(m),ye=a(R),M=a(ye),T=s(ye,2),f=a(T),g=s(R,2),L=a(g),K=a(L),$e=s(L,2);ce($e,5,()=>zt,ue,($,w)=>{var X=ln(),le=a(X),Me,Ge=s(le);_(()=>{Me!==(Me=e(w))&&(le.value=(le.__value=e(w))==null?"":e(w)),p(Ge,` ${Ia[e(w)]??""}`)}),Ut(t,[],le,()=>(e(w),e(n).deckCardKinds),Ue=>xe(n,e(n).deckCardKinds=Ue)),r($,X)});var Ce=s(g,2);{var be=$=>{var w=vn(),X=a(w),le=a(X),Me=s(X,2);ce(Me,5,()=>Vt,ue,(Ge,Ue)=>{var Ke=on(),Ye=a(Ke),Ie,Xe=s(Ye);_(()=>{Ie!==(Ie=e(Ue))&&(Ye.value=(Ye.__value=e(Ue))==null?"":e(Ue)),p(Xe,` ${Jt[e(Ue)]??""}${ra[e(Ue)]??""}`)}),Ut(c,[],Ye,()=>(e(Ue),e(n).exMonsterCategories),lt=>xe(n,e(n).exMonsterCategories=lt)),r(Ge,Ke)}),_e("click",le,()=>N(["exMonsterCategories"])),se(3,w,()=>ge,()=>({delay:0,duration:100})),r($,w)};b(Ce,$=>{e(n).deckCardKinds.includes("ExtraMonster")&&$(be)})}var J=s(Ce,2);{var G=$=>{var w=un(),X=U(w),le=a(X),Me=a(le),Ge=s(le,2);ce(Ge,5,()=>La.filter(Ae=>!Vt.includes(Ae)),ue,(Ae,Fe)=>{var yt=dn(),ct=a(yt),Ct,vt=s(ct);_(()=>{Ct!==(Ct=e(Fe))&&(ct.value=(ct.__value=e(Fe))==null?"":e(Fe)),p(vt,` ${Jt[e(Fe)]??""}${ra[e(Fe)]??""}`)}),Ut(u,[],ct,()=>(e(Fe),e(n).monsterCategories),Qe=>xe(n,e(n).monsterCategories=Qe)),r(Ae,yt)});var Ue=s(X,2),Ke=a(Ue),Ye=a(Ke),Ie=s(Ke,2);ce(Ie,5,()=>Aa,ue,(Ae,Fe)=>{var yt=cn(),ct=a(yt),Ct,vt=s(ct,2),Qe=s(vt);_(()=>{Ct!==(Ct=e(Fe))&&(ct.value=(ct.__value=e(Fe))==null?"":e(Fe)),Ee(vt,`monster_attr ${e(Fe)??""} svelte-n46fl7`),p(Qe,` ${ga[e(Fe)]??""}`)}),Ut(v,[],ct,()=>(e(Fe),e(n).monsterAttributes),ft=>xe(n,e(n).monsterAttributes=ft)),r(Ae,yt)});var Xe=s(Ue,2),lt=a(Xe),$t=a(lt),jt=s(lt,2);ce(jt,5,()=>Ea,ue,(Ae,Fe)=>{var yt=_n(),ct=a(yt),Ct,vt=s(ct);_(()=>{Ct!==(Ct=e(Fe))&&(ct.value=(ct.__value=e(Fe))==null?"":e(Fe)),p(vt,` ${la[e(Fe)]??""}
                    ${ha[e(Fe)]??""}`)}),Ut(y,[],ct,()=>(e(Fe),e(n).monsterTypes),Qe=>xe(n,e(n).monsterTypes=Qe)),_e("dblclick",yt,Qe=>F(Qe,"monsterTypes",e(Fe))),r(Ae,yt)});var St=s(Xe,2),Ot=a(St),st=a(Ot),et=s(Ot,2),ot=a(et),it=s(a(ot),2),ut=s(it,4),pt=s(ot,2),_t=s(a(pt),2),Mt=s(_t,4),Bt=s(pt,2),Et=s(a(Bt),2),Je=s(Et,4),tt=s(Bt,2),at=s(a(tt),2);_e("click",Me,()=>N(["monsterCategories"])),se(3,X,()=>ge,()=>({delay:0,duration:100})),_e("click",Ye,()=>N(["monsterAttributes"])),se(3,Ue,()=>ge,()=>({delay:0,duration:100})),_e("click",$t,()=>N(["monsterTypes"])),se(3,Xe,()=>ge,()=>({delay:0,duration:100})),_e("click",st,()=>N(["starLowerBound","starUpperBound","atkLowerBound","atkUpperBound","defLowerBound","defUpperBound","atkPlusDef"])),Tt(it,()=>e(n).starLowerBound,Ae=>xe(n,e(n).starLowerBound=Ae)),Tt(ut,()=>e(n).starUpperBound,Ae=>xe(n,e(n).starUpperBound=Ae)),Tt(_t,()=>e(n).atkLowerBound,Ae=>xe(n,e(n).atkLowerBound=Ae)),Tt(Mt,()=>e(n).atkUpperBound,Ae=>xe(n,e(n).atkUpperBound=Ae)),Tt(Et,()=>e(n).defLowerBound,Ae=>xe(n,e(n).defLowerBound=Ae)),Tt(Je,()=>e(n).defUpperBound,Ae=>xe(n,e(n).defUpperBound=Ae)),Tt(at,()=>e(n).atkPlusDef,Ae=>xe(n,e(n).atkPlusDef=Ae)),se(3,St,()=>ge,()=>({delay:0,duration:100})),r($,w)};b(J,$=>{(e(n).deckCardKinds.includes("Monster")||e(n).deckCardKinds.includes("ExtraMonster"))&&$(G)})}var I=s(J,2);{var ke=$=>{var w=pn(),X=a(w),le=a(X),Me=s(X,2);ce(Me,5,()=>Ba.filter(Ge=>Ge!=="PendulumScale"),ue,(Ge,Ue)=>{var Ke=fn(),Ye=a(Ke),Ie,Xe=s(Ye);_(()=>{Ie!==(Ie=e(Ue))&&(Ye.value=(Ye.__value=e(Ue))==null?"":e(Ue)),p(Xe,` ${oa[e(Ue)]??""}`)}),Ut(o,[],Ye,()=>(e(Ue),e(n).spellCategories),lt=>xe(n,e(n).spellCategories=lt)),r(Ge,Ke)}),_e("click",le,()=>N(["spellCategories"])),se(3,w,()=>ge,()=>({delay:0,duration:100})),r($,w)};b(I,$=>{e(n).deckCardKinds.includes("Spell")&&$(ke)})}var He=s(I,2);{var qe=$=>{var w=mn(),X=a(w),le=a(X),Me=s(X,2);ce(Me,5,()=>ja,ue,(Ge,Ue)=>{var Ke=yn(),Ye=a(Ke),Ie,Xe=s(Ye);_(()=>{Ie!==(Ie=e(Ue))&&(Ye.value=(Ye.__value=e(Ue))==null?"":e(Ue)),p(Xe,` ${va[e(Ue)]??""}`)}),Ut(q,[],Ye,()=>(e(Ue),e(n).trapCategories),lt=>xe(n,e(n).trapCategories=lt)),r(Ge,Ke)}),_e("click",le,()=>N(["trapCategories"])),se(3,w,()=>ge,()=>({delay:0,duration:100})),r($,w)};b(He,$=>{e(n).deckCardKinds.includes("Trap")&&$(qe)})}var Pe=s(He,2),Le=a(Pe),ze=a(Le),nt=s(Le,2);ce(nt,4,()=>[{key:"test",text:"テスト用カード"},{key:"oldVersion",text:"エラッタ前カード"},{key:"implemented",text:"未実装カード"}],ue,($,w)=>{var X=gn(),le=a(X),Me,Ge=s(le);_(()=>{Me!==(Me=w.key)&&(le.value=(le.__value=w.key)==null?"":w.key),p(Ge,` ${w.text??""}`)}),Ut(Q,[],le,()=>(w.key,e(n).others),Ue=>xe(n,e(n).others=Ue)),r($,X)});var Te=s(W,2);zi(Te,{get cardInfo(){return e(ne)},onAttention:ie});var ve=s(Y,2),z=a(ve);kt(z,()=>Xt,$=>{var w=hn();r($,w)},($,w)=>{Oa($,{mode:"List",get allCardTree(){return e(w).tree},onAttention:ie,get searchCondition(){return e(n)},get deckCardTree(){return e(ee).cardTree},set deckCardTree(X){xe(ee,e(ee).cardTree=X)},$$legacy:!0})});var de=s(ve,2),Ne=a(de);{var Ze=$=>{var w=De(),X=U(w);kt(X,()=>e(k),le=>{var Me=$n();r(le,Me)},(le,Me)=>{var Ge=Dn(),Ue=U(Ge),Ke=a(Ue),Ye=s(a(Ke),2),Ie=a(Ye);_(()=>{e(Se),Yt(()=>{e(Me)})}),ce(Ie,5,()=>e(Me),ue,(Je,tt)=>{var at=bn(),Ae={},Fe=a(at);_(()=>{Ae!==(Ae=e(tt).id)&&(at.value=(at.__value=e(tt).id)==null?"":e(tt).id),p(Fe,e(tt).name)}),r(Je,at)});var Xe=s(Ke,2),lt=s(a(Xe),2),$t=a(lt),jt=s(Xe,4),St=s(a(jt),2),Ot=a(St),st=s(St,2),et=a(st),ot=s(st,2),it=a(ot),ut=s(jt,2),pt=s(a(ut),2);kt(pt,je,Je=>{var tt=xn();r(Je,tt)},(Je,tt)=>{var at=kn(),Ae=a(at);_(Fe=>xt(Ae,"href",Fe),[()=>Dt.convertToObjectURL([e(tt)])],oe),r(Je,at)});var _t=s(pt,2);kt(_t,()=>e(j),Je=>{var tt=Cn();r(Je,tt)},(Je,tt)=>{var at=wn(),Ae=a(at);_(()=>xt(Ae,"href",e(tt))),r(Je,at)});var Mt=s(_t,2),Bt=a(Mt),Et=s(Ue,2);Oa(Et,{mode:"Deck",allCardTree:{ExtraMonster:[],Monster:[],Spell:[],Trap:[]},onAttention:ie,get deckCardTree(){return e(ee).cardTree},set deckCardTree(Je){xe(ee,e(ee).cardTree=Je)},$$legacy:!0}),Kt(Ie,()=>e(Se),Je=>C(Se,Je)),_e("change",Ie,fe),Tt($t,()=>e(ee).name,Je=>xe(ee,e(ee).name=Je)),_e("click",Ot,Oe),_e("click",et,B),_e("click",it,A),_e("click",Bt,re),r(le,Ge)}),r($,w)},Re=$=>{var w=Sn();r($,w)};b(Ne,$=>{e(H)==="DeckEdit"||pe()==="wide"?$(Ze):$(Re,!1)})}var Ve=s(P,2);sn(Ve,{modalController:D}),_(($,w,X)=>Ee(P,`deck_editor screen_size_${$??""} left_pain_mode_${w??""} main_view_mode_${X??""} svelte-n46fl7`),[pe,()=>e(Z).toLowerCase(),()=>e(H).toLowerCase()],oe),_e("click",O,V),_e("click",M,()=>N(["name"])),Tt(f,()=>e(n).name,$=>xe(n,e(n).name=$)),_e("click",K,()=>N(["deckCardKinds"])),_e("click",ze,()=>N(["others"])),se(3,Pe,()=>ge,()=>({delay:0,duration:100})),_e("focusin",W,()=>{C(Z,"SearchCondition"),C(H,"SearchCondition")}),_e("click",W,()=>{C(Z,"SearchCondition"),C(H,"SearchCondition")}),_e("click",de,()=>{C(H,"DeckEdit")}),_e("focusin",de,()=>{C(H,"DeckEdit")}),r(d,Be),bt()}const jn=["TblDeckHeader","TblDeckDetail","TblDuelistProfile"],Bn=3;var En=l('<input class="game_mode_radio svelte-sy4ydn" type="radio" name="game_mode"> <label> </label>',1),An=l('<option class="svelte-sy4ydn"> </option>'),Ln=l('<option class="svelte-sy4ydn"> </option>'),Un=l('<option class="svelte-sy4ydn"> </option>'),Yn=l('<tr class="config_row svelte-sy4ydn"><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><label for="npc_deck_selector" class="config_row_label deck_selector svelte-sy4ydn">デッキ：</label></div></td><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><select id="npc_deck_selector" class="deck_selector svelte-sy4ydn"><option class="svelte-sy4ydn">デフォルト</option><!></select></div></td></tr>'),Nn=l('<option class="svelte-sy4ydn"> </option>'),qn=l('<tr class="config_row svelte-sy4ydn"><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><label for="npc_selector" class="config_row_label npc_selector svelte-sy4ydn">対戦相手：</label></div></td><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><select id="npc_selector" class="npc_selector svelte-sy4ydn"></select> <div class="svelte-sy4ydn"> </div></div></td></tr> <!> <tr class="config_row svelte-sy4ydn"><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><label for="npc_selector" class="config_row_label npc_selector svelte-sy4ydn">先攻後攻：</label></div></td><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><select id="npc_selector" class="npc_selector svelte-sy4ydn"></select></div></td></tr>',1),Pn=l('<option class="svelte-sy4ydn"> </option>'),Fn=l('<tr class="config_row svelte-sy4ydn"><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><label for="difficulty_selector" class="config_row_label difficulty_selector svelte-sy4ydn">難易度：</label></div></td><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><select id="difficulty_selector" class="difficulty_selector svelte-sy4ydn"></select></div></td></tr>'),Hn=l('<tr class="config_row svelte-sy4ydn"><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><label class="config_row_label svelte-sy4ydn" for="game_mode_radio_preset">ゲームモード：</label></div></td><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"></div></td></tr> <tr class="config_row svelte-sy4ydn"><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><label for="deck_selector" class="config_row_label deck_selector svelte-sy4ydn">デッキ：</label></div></td><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><select id="deck_selector" class="deck_selector svelte-sy4ydn"></select></div></td></tr> <!> <tr><td colspan="2" class="svelte-sy4ydn"><div><button class="btn svelte-sy4ydn">duel start!</button></div></td></tr>',1),On=l('<tr><td colspan="2" class="svelte-sy4ydn"><div>デッキ情報の読み込み、もしくは作成中...</div></td></tr>'),Rn=l('<tr><td colspan="2" class="svelte-sy4ydn"><div><button class="btn svelte-sy4ydn">deck edit</button></div></td></tr>'),Wn=l('<tr class="config_row svelte-sy4ydn"><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><label for="duelist_name" class="config_row_label duelist_name svelte-sy4ydn">名前：</label></div></td><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><input id="duelist_name" class="duelist_name svelte-sy4ydn" type="text"></div></td></tr> <!> <!>',1),Kn=l('<tr><td colspan="2" class="svelte-sy4ydn"><div>デュエリスト情報の読み込み、もしくは作成中...</div></td></tr>'),In=l('<div class="app_body svelte-sy4ydn"><table class="config_table svelte-sy4ydn"><tbody><!></tbody></table></div>'),zn=l('<span class="svelte-sy4ydn"> </span> <span class="svelte-sy4ydn"> </span>',1),Vn=l('<div class="result_title result_win svelte-sy4ydn">YOU WIN</div>'),Gn=l('<div class="result_title result_lose svelte-sy4ydn">YOU LOSE</div>'),Qn=l('<div class="result_title result_draw svelte-sy4ydn">DRAW</div>'),Xn=l('<div class="twitter_share_button_wrapper svelte-sy4ydn"><a rel="nofollow" target="_blank" class="twitter_share_button svelte-sy4ydn">X(twitter)でシェアする</a></div>'),Jn=l('<div class="result svelte-sy4ydn"><!> <div class="reason_of_end svelte-sy4ydn"> </div> <!> <div class="svelte-sy4ydn"><button class="white_button svelte-sy4ydn">TOPへ戻る</button></div></div>'),Zn=l('<main style="flex-direction: column; display :flex" class="svelte-sy4ydn"><div class="link link_left svelte-sy4ydn"><a href="https://github.com/Setta238/stk_ygo_svelte" target="_blank" rel="noopener noreferrer" title="repository" class="svelte-sy4ydn">repository</a> <a href="https://x.com/ninja_no" target="_blank" rel="noopener noreferrer" title="repository" class="svelte-sy4ydn">X(Twitter)</a> <a href="https://posfie.com/@ninja_no/p/Lx7FLj3" target="_blank" rel="noopener noreferrer" title="posfie" class="svelte-sy4ydn">posfie(toggeter)</a></div> <div class="link link_right svelte-sy4ydn"><a class="a_button svelte-sy4ydn" role="button" tabindex="0">TOPへ戻る</a> <a href="/stk_ygo_svelte/note.html" target="_blank" rel="noopener noreferrer" title="repository" class="svelte-sy4ydn">現時点とこの先のこと</a></div> <!> <div class="footer card_summary svelte-sy4ydn"><!></div> <div class="footer debug_info svelte-sy4ydn"><span class="svelte-sy4ydn"> </span> <span class="user_agent_info svelte-sy4ydn"> </span> <span class="screen_info svelte-sy4ydn"> </span></div> <!></main>');function el(d,i){gt(i,!1);const t=new xr("stk_ygo_svelte",Bn,jn);let c=me(0),u=me(0),v=me(),y=me("FtkChallenge"),o=me("None"),q=me(0),Q=me(""),D=me(void 0);const S="https://setta238.github.io/stk_ygo_svelte/",n="遊戯王deそりてあ",H="ninja_no",Z=wr.getOrCreateNew(t).then(M=>(C(y,Ya.includes(M.previousGameMode)?M.previousGameMode:"FtkChallenge"),je(M.previousNpcId),M)),V=M=>{var f;const T=M.find(g=>g.lastUsedAt.getTime()===Math.max(...M.map(L=>L.lastUsedAt.getTime())))??M[0];C(q,T.id),e(y)==="FtkChallenge"&&T.deckType!=="Preset"&&C(q,((f=qt.find(g=>g.deckType==="Preset"))==null?void 0:f.id)??e(q))};let N=me(Dt.getAllDeckInfo(t).then(M=>(Promise.all(M.filter(T=>!T.lastUsedAt).map(T=>{T.saveDeckInfo()})),V(M),M)));const F=async()=>{const M=e(q);let T=(await e(N)).find(g=>g.id===M)??(await we()).find(g=>g.id===M);T&&await T.updateTimestamp();let f=T;if(f||(f=qt.find(g=>g.id===M)),!f)throw new Error("illegal state");return f},fe=async()=>{(await Z).save({previousGameMode:e(y)})},we=()=>(C(N,Dt.getAllDeckInfo(t).then(M=>(V(M),M))),e(N)),Se=async()=>{(await e(N)).length||(await Dt.prepareSampleDeck(),we())},k=async()=>{await Promise.all([fe(),Se()]);const M=await F(),T=await Z;let f=Wt.find(K=>K.id===Number.MIN_SAFE_INTEGER)??Wt[0],g=qt.find(K=>K.id===Number.MIN_SAFE_INTEGER)??qt[0],L="PlayFirst";e(y)==="FtkChallenge"?f=Wt.filter(K=>K.npcType==="FtkChallenge").find(K=>K.difficulty===T.previousDifficulty)??f:e(y)==="Free"&&(f=Wt.find(K=>K.id===T.previousNpcId)??f,g=qt.slice(-1)[0],L=T.previousStartMode),f.npcType!=="FtkChallenge"&&T.previousNpcDeckId>-1?g=(await e(N)).find(K=>K.id===T.previousNpcDeckId)??g:g=qt.find(K=>K.id===f.id)??g,C(v,new $r(T,"Player",M,[],f,"NPC",g,[],L)),e(v).onDuelEnd.append(()=>(C(v,e(v)),"RemoveMe"))},j=async()=>{await Promise.all([fe(),Se()]),C(o,"DeckEdit")},te=async M=>{await fe(),M.key==="Enter"&&!M.repeat&&(await Z).save()},ee=()=>{C(N,we()),C(v,void 0),C(o,"None")};let ne=Date.now();const he=M=>{Date.now()-ne<200||(ne=Date.now(),C(y,M),we())},ie=M=>{je(Number(M.currentTarget.value))},je=M=>{var T;C(D,Wt.find(f=>f.id===M)),C(Q,((T=e(D))==null?void 0:T.description)??"")};Se(),ht();var Oe=Zn(),B=s(a(Oe),2),A=a(B),re=s(B,2);{var pe=M=>{var T=De(),f=U(T);kt(f,()=>Z,null,(g,L)=>{xi(g,{get duel(){return e(v)},get userProfile(){return e(L)}})}),r(M,T)},Be=M=>{var T=De(),f=U(T);{var g=K=>{Tn(K,{})},L=K=>{var $e=In(),Ce=a($e),be=a(Ce),J=a(be);kt(J,()=>Z,G=>{var I=Kn();r(G,I)},(G,I)=>{var ke=Wn(),He=U(ke),qe=a(He),Pe=a(qe),Le=s(qe),ze=a(Le),nt=a(ze),Te=s(He,2);kt(Te,()=>e(N),de=>{var Ne=On();r(de,Ne)},(de,Ne)=>{var Ze=Hn(),Re=U(Ze),Ve=a(Re),$=a(Ve),w=s(Ve),X=a(w);ce(X,5,()=>Ya,ue,(st,et)=>{var ot=En(),it=U(ot),ut=s(it,2),pt=a(ut);_(_t=>{xt(it,"id",`game_mode_radio_${_t??""}`),Cr(it,e(et)),Dr(it,e(y)===e(et)),Ee(ut,`game_mode_tab_label game_mode_tab_${_t??""} svelte-sy4ydn`),xt(ut,"for",`game_mode_radio_${_t??""}`),p(pt,e(et))},[()=>e(et).toLowerCase()],oe),_e("change",it,()=>he(e(et))),r(st,ot)});var le=s(Re,2),Me=a(le),Ge=a(Me),Ue=s(Me),Ke=a(Ue),Ye=a(Ke);_(()=>{e(q),Yt(()=>{e(y),e(Ne)})}),ce(Ye,5,()=>e(y)==="FtkChallenge"?qt.filter(st=>st.deckType==="Preset"):e(Ne),ue,(st,et)=>{var ot=An(),it={},ut=a(ot);_(()=>{it!==(it=e(et).id)&&(ot.value=(ot.__value=e(et).id)==null?"":e(et).id),p(ut,e(et).name)}),r(st,ot)});var Ie=s(le,2);{var Xe=st=>{var et=qn(),ot=U(et),it=a(ot),ut=a(it),pt=s(it),_t=a(pt),Mt=a(_t);_(()=>{e(I),Yt(()=>{})}),ce(Mt,5,()=>Wt,ue,(vt,Qe)=>{var ft=Ln(),Nt={},Rt=a(ft);_(()=>{Nt!==(Nt=e(Qe).id)&&(ft.value=(ft.__value=e(Qe).id)==null?"":e(Qe).id),p(Rt,e(Qe).name)}),r(vt,ft)});var Bt=s(Mt,2),Et=a(Bt),Je=s(ot,2);{var tt=vt=>{var Qe=Yn(),ft=a(Qe),Nt=a(ft),Rt=s(ft),xa=a(Rt),wa=a(xa);_(()=>{e(I),Yt(()=>{e(Ne)})});var da=a(wa);da.value=(da.__value=Number.MIN_SAFE_INTEGER)==null?"":Number.MIN_SAFE_INTEGER;var za=s(da);ce(za,1,()=>e(Ne),ue,(ca,ea)=>{var ta=Un(),Ca={},Va=a(ta);_(()=>{Ca!==(Ca=e(ea).id)&&(ta.value=(ta.__value=e(ea).id)==null?"":e(ea).id),p(Va,e(ea).name)}),r(ca,ta)}),se(3,Nt,()=>ge,()=>({duration:200})),se(3,ft,()=>ge,()=>({duration:200})),Kt(wa,()=>e(I).previousNpcDeckId,ca=>e(I).previousNpcDeckId=ca),se(3,xa,()=>ge,()=>({duration:200})),se(3,Rt,()=>ge,()=>({duration:200})),se(3,Qe,()=>ge,()=>({duration:200})),r(vt,Qe)};b(Je,vt=>{var Qe;((Qe=e(D))==null?void 0:Qe.npcType)!=="FtkChallenge"&&vt(tt)})}var at=s(Je,2),Ae=a(at),Fe=a(Ae),yt=s(Ae),ct=a(yt),Ct=a(ct);_(()=>{e(I),Yt(()=>{})}),ce(Ct,5,()=>Ft(Na),ue,(vt,Qe)=>{var ft=Nn(),Nt={},Rt=a(ft);_(()=>{Nt!==(Nt=e(Qe))&&(ft.value=(ft.__value=e(Qe))==null?"":e(Qe)),p(Rt,Na[e(Qe)])}),r(vt,ft)}),_(()=>p(Et,`※${e(Q)??""}`)),se(3,ut,()=>ge,()=>({duration:200})),se(3,it,()=>ge,()=>({duration:200})),_e("change",Mt,ie),Kt(Mt,()=>e(I).previousNpcId,vt=>e(I).previousNpcId=vt),se(3,_t,()=>ge,()=>({duration:200})),se(3,pt,()=>ge,()=>({duration:200})),se(3,ot,()=>ge,()=>({duration:200})),se(3,Fe,()=>ge,()=>({duration:200})),se(3,Ae,()=>ge,()=>({duration:200})),Kt(Ct,()=>e(I).previousStartMode,vt=>e(I).previousStartMode=vt),se(3,ct,()=>ge,()=>({duration:200})),se(3,yt,()=>ge,()=>({duration:200})),se(3,at,()=>ge,()=>({duration:200})),r(st,et)},lt=st=>{var et=De(),ot=U(et);{var it=ut=>{var pt=Fn(),_t=a(pt),Mt=a(_t),Bt=s(_t),Et=a(Bt),Je=a(Et);_(()=>{e(I),Yt(()=>{})}),ce(Je,5,()=>Sr,ue,(tt,at)=>{var Ae=Pn(),Fe={},yt=a(Ae);_(()=>{Fe!==(Fe=e(at))&&(Ae.value=(Ae.__value=e(at))==null?"":e(at)),p(yt,e(at))}),r(tt,Ae)}),se(3,Mt,()=>ge,()=>({duration:200})),se(3,_t,()=>ge,()=>({duration:200})),Kt(Je,()=>e(I).previousDifficulty,tt=>e(I).previousDifficulty=tt),se(3,Et,()=>ge,()=>({duration:200})),se(3,Bt,()=>ge,()=>({duration:200})),se(3,pt,()=>ge,()=>({duration:200})),r(ut,pt)};b(ot,ut=>{e(y)==="FtkChallenge"&&ut(it)},!0)}r(st,et)};b(Ie,st=>{e(y)==="Free"?st(Xe):st(lt,!1)})}var $t=s(Ie,2),jt=a($t),St=a(jt),Ot=a(St);se(3,$,()=>ge,()=>({duration:200})),se(3,Ve,()=>ge,()=>({duration:200})),se(3,X,()=>ge,()=>({duration:200})),se(3,w,()=>ge,()=>({duration:200})),se(3,Re,()=>ge,()=>({duration:200})),se(3,Ge,()=>ge,()=>({duration:200})),se(3,Me,()=>ge,()=>({duration:200})),Kt(Ye,()=>e(q),st=>C(q,st)),se(3,Ke,()=>ge,()=>({duration:200})),se(3,Ue,()=>ge,()=>({duration:200})),se(3,le,()=>ge,()=>({duration:200})),_e("click",Ot,k),se(3,St,()=>ge,()=>({duration:200})),r(de,Ze)});var ve=s(Te,2);{var z=de=>{var Ne=Rn(),Ze=a(Ne),Re=a(Ze),Ve=a(Re);_e("click",Ve,j),se(3,Re,()=>ge,()=>({duration:200})),se(3,Ze,()=>ge,()=>({duration:200})),se(3,Ne,()=>ge,()=>({duration:200})),r(de,Ne)};b(ve,de=>{e(y)==="Free"&&de(z)})}se(3,Pe,()=>ge,()=>({duration:200})),se(3,qe,()=>ge,()=>({duration:200})),Tt(nt,()=>e(I).name,de=>e(I).name=de),_e("keypress",nt,te),se(3,ze,()=>ge,()=>({duration:200})),se(3,Le,()=>ge,()=>({duration:200})),se(3,He,()=>ge,()=>({duration:200})),r(G,ke)}),r(K,$e)};b(f,K=>{e(o)==="DeckEdit"?K(g):K(L,!1)},!0)}r(M,T)};b(re,M=>{e(v)?M(pe):M(Be,!1)})}var P=s(re,2),E=a(P);kt(E,()=>Xt,M=>{var T=rt("読み込み中");r(M,T)},(M,T)=>{var f=zn(),g=U(f),L=a(g),K=s(g,2),$e=a(K);_((Ce,be,J)=>{p(L,`公式DB上のカード${Ce??""}枚`),p($e,`実装済カード（効果あり）${be??""}枚 （効果なし）${J??""}枚`)},[()=>e(T).knmCount.toLocaleString(),()=>e(T).definitionCount.toLocaleString(),()=>e(T).nonDefinitionCount.toLocaleString()],oe),r(M,f)});var Y=s(P,2),W=a(Y),ae=a(W),h=s(W,2),O=a(h),x=s(h,2),m=a(x),R=s(Y,2);{var ye=M=>{var T=Jn(),f=a(T);{var g=I=>{var ke=De(),He=U(ke);{var qe=Le=>{var ze=Vn();r(Le,ze)},Pe=Le=>{var ze=De(),nt=U(ze);{var Te=ve=>{var z=Gn();r(ve,z)};b(nt,ve=>{e(v).winner.seat==="Above"&&ve(Te)},!0)}r(Le,ze)};b(He,Le=>{e(v).winner.seat==="Below"?Le(qe):Le(Pe,!1)})}r(I,ke)},L=I=>{var ke=Qn();r(I,ke)};b(f,I=>{e(v).winner?I(g):I(L,!1)})}var K=s(f,2),$e=a(K),Ce=s(K,2);{var be=I=>{var ke=Xn(),He=a(ke);_(()=>xt(He,"href",`https://x.com/share?url=${S}&text=${e(v).twitterShareText??""}&hashtags=${n}&via=${H}`)),r(I,ke)};b(Ce,I=>{e(v).twitterShareText&&I(be)})}var J=s(Ce,2),G=a(J);_(()=>p($e,e(v).reasonOfEnd)),_e("click",G,ee),se(3,T,()=>jr,()=>({delay:200,duration:200})),r(M,T)};b(R,M=>{e(v)&&e(v).isEnded&&M(ye)})}_(()=>{p(ae,"build at: 20260112_140533"),p(O,fa.text),p(m,`w:${e(c)??""}px h:${e(u)??""}px`)}),sa("innerWidth",M=>C(c,M)),sa("innerHeight",M=>C(u,M)),_e("click",A,ee),r(d,Oe),bt()}Mr(el,{target:document.getElementById("app")});
