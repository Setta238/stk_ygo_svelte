var Qa=Object.defineProperty;var Ma=d=>{throw TypeError(d)};var Ja=(d,i,t)=>i in d?Qa(d,i,{enumerable:!0,configurable:!0,writable:!0,value:t}):d[i]=t;var rt=(d,i,t)=>Ja(d,typeof i!="symbol"?i+"":i,t),Ta=(d,i,t)=>i.has(d)||Ma("Cannot "+t);var mt=(d,i,t)=>(Ta(d,i,"read from private field"),t?t.call(d):i.get(d)),ta=(d,i,t)=>i.has(d)?Ma("Cannot add the same private member more than once"):i instanceof WeakSet?i.add(d):i.set(d,t),pa=(d,i,t,c)=>(Ta(d,i,"write to private field"),c?c.call(d,t):i.set(d,t),t);import{s as ja,r as Za,a as $,b as er,l as tr,g as e,d as Wa,p as _t,c as Ae,m as pe,i as ut,t as o,e as a,f as y,h as u,j as le,k as Te,n as dt,o as de,q as r,u as ft,v as xe,D as ar,w as be,x as N,y as s,z as ce,A as Ot,B as ne,C as fe,E as g,F as rr,G as Ze,H as Rt,I as sr,J as ir,K as Gt,L as ma,M as Ka,N as ra,O as ya,P as aa,Q as yt,R as ka,S as _a,T as Ca,U as sa,V as la,W as za,X as ua,Y as fa,Z as nr,_ as or,$ as lr,a0 as vr,a1 as dr,a2 as cr,a3 as _r,a4 as va,a5 as Va,a6 as ur,a7 as Xt,a8 as ha,a9 as fr,aa as Ea,ab as ga,ac as Yt,ad as pr,ae as gr,af as Qt,ag as mr,ah as Ct,ai as yr,aj as hr,ak as xr,al as Ba,am as Aa,an as Ya,ao as La,ap as Ua,aq as Na,ar as br,as as Ft,at as qt,au as Mt,av as wr,aw as Vt,ax as kr,ay as Cr,az as Pa,aA as zt,aB as It,aC as Dr,aD as $r,aE as qa,aF as Sr,aG as Mr,aH as Tr}from"../chunk/entity_proc_20260112_223909.js";import"../chunk/json_20260112_223909.js";(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const f of document.querySelectorAll('link[rel="modulepreload"]'))c(f);new MutationObserver(f=>{for(const v of f)if(v.type==="childList")for(const p of v.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&c(p)}).observe(document,{childList:!0,subtree:!0});function t(f){const v={};return f.integrity&&(v.integrity=f.integrity),f.referrerPolicy&&(v.referrerPolicy=f.referrerPolicy),f.crossOrigin==="use-credentials"?v.credentials="include":f.crossOrigin==="anonymous"?v.credentials="omit":v.credentials="same-origin",v}function c(f){if(f.ep)return;f.ep=!0;const v=t(f);fetch(f.href,v)}})();const jr=d=>d;function Da(d){const i=d-1;return i*i*i+1}function Fa(d){const i=typeof d=="string"&&d.match(/^\s*(-?[\d.]+)([^\s]*)\s*$/);return i?[parseFloat(i[1]),i[2]||"px"]:[d,"px"]}function Er(d,{delay:i=0,duration:t=400,easing:c=jr}={}){const f=+getComputedStyle(d).opacity;return{delay:i,duration:t,easing:c,css:v=>`opacity: ${v*f}`}}function Br(d,{delay:i=0,duration:t=400,easing:c=Da,x:f=0,y:v=0,opacity:p=0}={}){const l=getComputedStyle(d),H=+l.opacity,V=l.transform==="none"?"":l.transform,h=H*(1-p),[T,X]=Fa(f),[F,re]=Fa(v);return{delay:i,duration:t,easing:c,css:(E,n)=>`
			transform: ${V} translate(${(1-E)*T}${X}, ${(1-E)*F}${re});
			opacity: ${H-h*n}`}}function he(d,{delay:i=0,duration:t=400,easing:c=Da,axis:f="y"}={}){const v=getComputedStyle(d),p=+v.opacity,l=f==="y"?"height":"width",H=parseFloat(v[l]),V=f==="y"?["top","bottom"]:["left","right"],h=V.map(P=>`${P[0].toUpperCase()}${P.slice(1)}`),T=parseFloat(v[`padding${h[0]}`]),X=parseFloat(v[`padding${h[1]}`]),F=parseFloat(v[`margin${h[0]}`]),re=parseFloat(v[`margin${h[1]}`]),E=parseFloat(v[`border${h[0]}Width`]),n=parseFloat(v[`border${h[1]}Width`]);return{delay:i,duration:t,easing:c,css:P=>`overflow: hidden;opacity: ${Math.min(P*20,1)*p};${l}: ${P*H}px;padding-${V[0]}: ${P*T}px;padding-${V[1]}: ${P*X}px;margin-${V[0]}: ${P*F}px;margin-${V[1]}: ${P*re}px;border-${V[0]}-width: ${P*E}px;border-${V[1]}-width: ${P*n}px;min-${l}: 0`}}function Ha(d,i){for(const t in i)d[t]=i[t];return d}function Ar({fallback:d,...i}){const t=new Map,c=new Map;function f(p,l,H){const{delay:V=0,duration:h=L=>Math.sqrt(L)*30,easing:T=Da}=Ha(Ha({},i),H),X=p.getBoundingClientRect(),F=l.getBoundingClientRect(),re=X.left-F.left,E=X.top-F.top,n=X.width/F.width,P=X.height/F.height,_e=Math.sqrt(re*re+E*E),we=getComputedStyle(l),ge=we.transform==="none"?"":we.transform,ke=+we.opacity;return{delay:V,duration:typeof h=="function"?h(_e):h,easing:T,css:(L,ie)=>`
			   opacity: ${L*ke};
			   transform-origin: top left;
			   transform: ${ge} translate(${ie*re}px,${ie*E}px) scale(${L+(1-L)*n}, ${L+(1-L)*P});
		   `}}function v(p,l,H){return(V,h)=>(p.set(h.key,V),()=>{if(l.has(h.key)){const T=l.get(h.key);return l.delete(h.key),f(T,V,h)}return p.delete(h.key),d&&d(V,h,H)})}return[v(c,t,!1),v(t,c,!0)]}function Ia(d){return Object.prototype.toString.call(d)==="[object Date]"}function Yr(d){return d}function xa(d){const i=d-1;return i*i*i+1}function ba(d,i){if(d===i||d!==d)return()=>d;const t=typeof d;if(t!==typeof i||Array.isArray(d)!==Array.isArray(i))throw new Error("Cannot interpolate values of different type");if(Array.isArray(d)){const c=i.map((f,v)=>ba(d[v],f));return f=>c.map(v=>v(f))}if(t==="object"){if(!d||!i)throw new Error("Object cannot be null");if(Ia(d)&&Ia(i)){const v=d.getTime(),l=i.getTime()-v;return H=>new Date(v+H*l)}const c=Object.keys(i),f={};return c.forEach(v=>{f[v]=ba(d[v],i[v])}),v=>{const p={};return c.forEach(l=>{p[l]=f[l](v)}),p}}if(t==="number"){const c=i-d;return f=>d+f*c}return()=>i}var Lt,Jt,ia,Wt;const $a=class $a{constructor(i,t={}){ta(this,Lt,ja(void 0));ta(this,Jt,ja(void 0));ta(this,ia);ta(this,Wt,null);mt(this,Lt).v=mt(this,Jt).v=i,pa(this,ia,t)}static of(i,t){const c=new $a(i(),t);return Za(()=>{c.set(i())}),c}set(i,t){var T;$(mt(this,Jt),i);let{delay:c=0,duration:f=400,easing:v=Yr,interpolate:p=ba}={...mt(this,ia),...t};if(f===0)return(T=mt(this,Wt))==null||T.abort(),$(mt(this,Lt),i),Promise.resolve();const l=er.now()+c;let H,V=!1,h=mt(this,Wt);return pa(this,Wt,tr(X=>{if(X<l)return!0;if(!V){V=!0;const re=mt(this,Lt).v;H=p(re,i),typeof f=="function"&&(f=f(re,i)),h==null||h.abort()}const F=X-l;return F>f?($(mt(this,Lt),i),!1):($(mt(this,Lt),H(v(F/f))),!0)})),mt(this,Wt).promise}get current(){return e(mt(this,Lt))}get target(){return e(mt(this,Jt))}set target(i){this.set(i)}};Lt=new WeakMap,Jt=new WeakMap,ia=new WeakMap,Wt=new WeakMap;let da=$a;var Lr=o('<div class="phase_display svelte-1boxe40"><span class="svelte-1boxe40"> </span> </div>'),Ur=o('<div class="lifepoint_display svelte-1boxe40"><div class="svelte-1boxe40"> </div> <div class="svelte-1boxe40"> </div></div>'),Nr=(d,i,t)=>i(e(t)),Pr=o('<div class="svelte-1boxe40"><button class="phase_button svelte-1boxe40"> </button></div>'),qr=o("<div><!></div>"),Fr=o('<div class="svelte-1boxe40"><!></div>'),Hr=o("<div><!></div>"),Ir=o('<div class="config_button_wrapper svelte-1boxe40"><button id="config_button" class="svelte-1boxe40">⚙</button></div>'),Or=o("<!> <!> <!> <!>",1),Rr=o('<div style="position: absolute;" class="card_animation_receiver svelte-1boxe40"><!></div>'),Wr=o('<div style="position: absolute; top:0rem" class="svelte-1boxe40">｛効果対象｝</div>'),Kr=o('<!> <div style="position: absolute; display:flex;justify-content: center;"><!></div>',1),zr=o(" <!> 】",1),Vr=o('<div style="position: absolute; bottom:0rem" class="svelte-1boxe40"> <!></div>'),Gr=o("<!> <!>",1),Xr=o('<div class="badge svelte-1boxe40"> </div>'),Qr=o('<div class="card_animation_receiver svelte-1boxe40"><!></div>'),Jr=o("<!> <!> <!> <!>",1),Zr=o('<td><div role="listitem"><!></div></td>');function es(d,i){_t(i,!1);let t=Ae(i,"view",12),c=Ae(i,"row",8),f=Ae(i,"column",8),v=Ae(i,"selectedEntities",28,()=>[]),p=Ae(i,"selectedCells",28,()=>[]),l=pe(t().getCell(c(),f())),H=pe(new da(e(l).field.duel.duelists.Above.lp,{duration:400,easing:xa})),V=pe(new da(e(l).field.duel.duelists.Below.lp,{duration:400,easing:xa}));const h=()=>{$(l,t().getCell(c(),f())),xe(H,e(H).target=e(l).field.duel.duelists.Above.lp),xe(V,e(V).target=e(l).field.duel.duelists.Below.lp)};e(l).onUpdate.append(h),t().onDuelUpdate.append(h),t().modalController.onUpdate.append(h);let T,X=pe([]),F=()=>console.log("hoge"),re,E=pe([]),n=pe(!1),P=pe(!1),_e=!1;const we=x=>{var z,Y;$(R,[]),v().reset(),T=x.activator,F=x.resolve,$(X,x.dummyActionInfos),$(E,x.chainBlockInfos.flatMap(q=>q.selectedEntities).getDistinct()),re=x.entitiesChoices,$(n,!1),$(P,((z=x.cellsChoices)==null?void 0:z.selectables.includes(e(l)))??!1),_e=e(P)&&((Y=x.cellsChoices)==null?void 0:Y.qty)===1,h()};t().onWaitStart.append(we);const ge=()=>{T=void 0,$(X,[]),F=()=>{console.log("hoge")},re=void 0,$(E,[]),$(n,!1),$(P,!1),_e=!1};t().onWaitEnd.append(ge);let ke=pe(!1),L=[];const ie=x=>{L=x.filter(z=>z.dests.includes(e(l))),$(ke,L.length>0),h()},k=()=>{L=[],$(ke,!1),h()};t().onDragStart.append(ie),t().onDragEnd.append(k);const[B,ee]=ui;let R=pe([]);const te=x=>{if(T=void 0,e(l)===x.to||e(l).entities.includes(x.entity)){$(R,[...e(R),x]);const z=x.resolve;$(l,e(l)),setTimeout(()=>{$(R,e(R).filter(Y=>Y!==x)),x.count++,x.count>1&&z()},600)}};t().onAnimation.append(te);const Be=x=>{F({phaseChange:x})},w=()=>e(l).isStackCell&&e(l).entities.flatMap(x=>x.actions).filter(x=>e(X).map(z=>z.action.seq).some(z=>z===x.seq)).length>0,S=x=>{var z;if(((z=x.target)==null?void 0:z.id)==="config_button"){t(t().infoBoardState="Config",!0),t().requireUpdate();return}if(t(t().infoBoardState="Default",!0),_e)F({selectedCells:[e(l)]});else if(e(P))$(n,!e(n)),p(e(n)?[...p(),e(l)]:p().filter(Y=>Y!==e(l)));else if(e(l).isStackCell){t(t().infoBoardState="CellInfo",!0),t(t().infoBoardCell=e(l),!0),t().requireUpdate();const Y=e(l).entities.flatMap(O=>O.actions).map(O=>O.seq),q=e(X).filter(O=>Y.includes(O.action.seq));if(q.length){if(!T)return;t().modalController.actionSelector.show({title:"カードを選択。",position:"Bottom",activator:T,dummyActionInfos:q,cancelable:!0}).then(O=>{O&&F({actionInfo:O})});return}}t().requireUpdate(),console.info(e(l),Se(...e(l).visibleEntities))},W=x=>{x.preventDefault(),x.dataTransfer&&(x.dataTransfer.dropEffect="move")},ue=x=>{x.preventDefault(),console.info("drop",x,e(ke),L),x.dataTransfer&&(x.dataTransfer.dropEffect="move");try{if(e(ke)&&L){if(L.length===1){const z=L[0];F({actionInfo:{...z,dest:e(l)}})}else if(L.length>1){if(!T)throw new ar("想定されない状態");e(l).field.duel.view.modalController.terminateAll(),e(l).field.duel.view.modalController.actionSelector.show({title:"選択",position:"Bottom",activator:T,dummyActionInfos:L.map(z=>({...z,dest:e(l)})),cancelable:!1}).then(z=>{F({actionInfo:z})})}}}finally{t().removeDraggingActions()}},Se=(...x)=>{if(t().waitMode==="Animation")return"Disabled";if(re&&re.selectables.find(Y=>x.find(q=>Y===q)))return"Selectable";if(!e(X)||e(X).length===0||t().waitMode!=="Free"||Object.values(t().modalController.modals).some(Y=>Y.state==="Shown"))return"Disabled";const z=e(X).filter(Y=>x.includes(Y.action.entity));return z.length===0?"Disabled":e(l).isStackCell||z[0].action.entity!==x[0]?"Clickable":z.some(Y=>Y.dests.length)?"Draggable":"Clickable"};ut();var A=Zr(),j=a(A);j.__click=S;var U=a(j);{var Q=x=>{var z=be(),Y=N(z);{var q=O=>{var K=be(),b=N(K);{var C=m=>{var I=Lr(),J=a(I),Ce=a(J),me=s(J,1,!0);u((oe,se)=>{g(Ce,oe),g(me,se)},[()=>String(e(l).field.duel.clock.turn).padStart(2,"0"),()=>e(l).field.duel.phase.toUpperCase()],le),r(m,I)},_=m=>{var I=be(),J=N(I);{var Ce=oe=>{var se=Ur(),G=a(se),ae=a(G),De=s(G,2),Oe=a(De);u((He,Ie)=>{g(ae,He),g(Oe,Ie)},[()=>Math.floor(e(H).current),()=>Math.floor(e(V).current)],le),r(oe,se)},me=oe=>{var se=be(),G=N(se);{var ae=De=>{var Oe=be(),He=N(Oe);{var Ie=Le=>{var Ge=be(),nt=N(Ge);{var Ee=ye=>{var je=be(),Ue=N(je);ce(Ue,1,()=>t().duel.nextPhaseList,fe,(Re,st)=>{var ze=Pr(),et=a(ze);et.__click=[Nr,Be,st];var xt=a(et);u(ot=>g(xt,ot),[()=>e(st).toUpperCase()],le),r(Re,ze)}),r(ye,je)};y(nt,ye=>{t().duel.isEnded||ye(Ee)})}r(Le,Ge)};y(He,Le=>{t().waitMode==="Free"&&Le(Ie)})}r(De,Oe)};y(G,De=>{e(l).column===5&&De(ae)},!0)}r(oe,se)};y(J,oe=>{e(l).column===3?oe(Ce):oe(me,!1)},!0)}r(m,I)};y(b,m=>{e(l).column===1?m(C):m(_,!1)})}r(O,K)};y(Y,O=>{e(l).row===3&&O(q)})}r(x,z)},Z=x=>{var z=be(),Y=N(z);{var q=K=>{var b=Or();const C=le(()=>e(R).find(se=>se.to===e(l)));var _=N(b);{var m=se=>{var G=qr(),ae=a(G);Ot(ae,{get entity(){return e(C).entity},state:"Disabled",dummyActionInfos:[],cardActionResolve:void 0}),u(()=>Te(G,`card_animation_receiver ${e(l).cellType??""} svelte-1boxe40`)),ne(1,G,()=>ee,()=>({key:e(C).entity.seq})),r(se,G)};y(_,se=>{e(C)&&e(C).index==="Top"&&se(m)})}var I=s(_,2);ce(I,1,()=>e(l).visibleEntities,fe,(se,G)=>{var ae=be(),De=N(ae);{var Oe=He=>{var Ie=Fr(),Le=a(Ie);const Ge=le(()=>Se(e(G))),nt=le(()=>e(X).filter(Ee=>Ee.action.entity===e(G)));Ot(Le,{get entity(){return e(G)},get state(){return e(Ge)},get dummyActionInfos(){return e(nt)},cardActionResolve:void 0,get selectedList(){return v()},set selectedList(Ee){v(Ee)},$$legacy:!0}),ne(2,Ie,()=>B,()=>({key:e(G).seq})),r(He,Ie)};y(De,He=>{e(R).every(Ie=>Ie.entity.seq!==e(G).seq)&&He(Oe)})}r(se,ae)});var J=s(I,2);{var Ce=se=>{var G=Hr(),ae=a(G);Ot(ae,{get entity(){return e(C).entity},state:"Disabled",dummyActionInfos:[],cardActionResolve:void 0}),u(()=>Te(G,`card_animation_receiver ${e(l).cellType??""} svelte-1boxe40`)),ne(1,G,()=>ee,()=>({key:e(C).entity.seq})),r(se,G)};y(J,se=>{e(C)&&e(C).index!=="Top"&&se(Ce)})}var me=s(J,2);{var oe=se=>{var G=Ir();r(se,G)};y(me,se=>{e(l).owner.seat==="Below"&&se(oe)})}r(K,b)},O=K=>{var b=Jr();const C=le(()=>e(R).find(G=>G.to===e(l)));var _=N(b);{var m=G=>{var ae=Rr(),De=a(ae);Ot(De,{get entity(){return e(C).entity},state:"Disabled",dummyActionInfos:[],cardActionResolve:void 0}),ne(1,ae,()=>ee,()=>({key:e(C).entity.seq})),r(G,ae)};y(_,G=>{e(C)&&e(C).index!=="Top"&&G(m)})}var I=s(_,2);{var J=G=>{var ae=Gr(),De=N(ae);ce(De,1,()=>e(l).visibleEntities.map((Ie,Le)=>({index:Le,entity:Ie})).toReversed(),fe,(Ie,Le)=>{var Ge=be(),nt=N(Ge);{var Ee=ye=>{var je=Kr();const Ue=le(()=>!e(l).isStackCell&&e(Le).index===0?Se(...e(l).visibleEntities):void 0);var Re=N(je);{var st=ot=>{var Dt=Wr();r(ot,Dt)};y(Re,ot=>{e(E).includes(e(Le).entity)&&ot(st)})}var ze=s(Re,2),et=a(ze);const xt=le(()=>e(Le).index===0?e(X).filter(ot=>e(l).visibleEntities.includes(ot.action.entity)):void 0);Ot(et,{get entity(){return e(Le).entity},get state(){return e(Ue)},get dummyActionInfos(){return e(xt)},cardActionResolve:void 0,get selectedList(){return v()},set selectedList(ot){v(ot)},$$legacy:!0}),u(()=>Te(ze,`duel_card_wrapper ${(e(Le).entity.exist?"duel_card_wrapper_exists":"")??""} svelte-1boxe40`)),ne(2,ze,()=>B,()=>({key:e(Le).entity.seq})),r(ye,je)};y(nt,ye=>{e(R).every(je=>je.entity.seq!==e(Le).entity.seq)&&ye(Ee)})}r(Ie,Ge)});var Oe=s(De,2);{var He=Ie=>{var Le=Vr(),Ge=a(Le),nt=s(Ge);ce(nt,1,()=>Rt(e(l).visibleEntities[0].status.maxCounterQty),fe,(Ee,ye)=>{var je=zr(),Ue=N(je),Re=s(Ue);{var st=ze=>{var et=Ze();u(()=>g(et,`/${e(l).visibleEntities[0].status.maxCounterQty[e(ye)]??""}`)),r(ze,et)};y(Re,ze=>{(e(l).visibleEntities[0].status.maxCounterQty[e(ye)]??9999)<100&&ze(st)})}u((ze,et)=>g(Ue,`【
              ${ze??""}${et??""} `),[()=>rr(e(ye)),()=>e(l).visibleEntities[0].counterHolder.getQty(e(ye))],le),r(Ee,je)}),u(()=>g(Ge,`【${e(l).visibleEntities[0].battlePositionName??""}】 `)),r(Ie,Le)};y(Oe,Ie=>{e(l).visibleEntities[0].battlePosition&&Ie(He)})}r(G,ae)};y(I,G=>{e(l).visibleEntities.length>0&&G(J)})}var Ce=s(I,2);{var me=G=>{var ae=Xr(),De=a(ae);u(()=>g(De,e(l).visibleEntities.length)),r(G,ae)};y(Ce,G=>{e(l).isStackCell&&G(me)})}var oe=s(Ce,2);{var se=G=>{var ae=Qr(),De=a(ae);Ot(De,{get entity(){return e(C).entity},state:"Disabled",dummyActionInfos:[],cardActionResolve:void 0}),ne(1,ae,()=>ee,()=>({key:e(C).entity.seq})),r(G,ae)};y(oe,G=>{e(C)&&e(C).index==="Top"&&G(se)})}r(K,b)};y(Y,K=>{e(l).cellType==="Hand"?K(q):K(O,!1)},!0)}r(x,z)};y(U,x=>{e(l).isDisabledCell?x(Q):x(Z,!1)})}u(x=>{Te(A,`${`duel_field_cell duel_field_cell_${e(l).cellType} ${e(l).linkArrowSources.length===0?"":"duel_field_cell_linked"}`??""} svelte-1boxe40`),dt(A,"colspan",e(l).cellType==="Hand"?7:1),Te(j,`${x??""} svelte-1boxe40`)},[()=>`duel_field_cell_inner_box ${e(l).cellType} ${e(ke)?"can_accept_drop":""} ${w()?"can_action":""} ${e(n)?"is_selected":e(P)?"is_selectable":""} `],le),de("dragover",j,W),de("drop",j,ue),r(d,A),ft()}Wa(["click"]);const ts=(d,i,t=void 0,c="!!!circular reference!!!")=>{let f=[];return JSON.stringify(d,(v,p)=>{if(typeof p=="object"){if(f.indexOf(p)>-1)return c;f.push(p)}let l=p;if(i&&(l=i(v,p)),typeof l=="function")return l.toString();if(l!==p&&typeof l=="object"){if(f.indexOf(l)>-1)return c;f.push(l)}return l},t)};var as=o('<div class="title svelte-14z6bdh"> </div>'),rs=o('<div class="title svelte-14z6bdh"> </div>'),ss=o('<div class="duel_log_chain_number svelte-14z6bdh"> </div>'),is=o('<div><a class="white_button" download="error_info.json">エラー情報ダウンロード</a></div>'),ns=o("<div><!> <!></div>"),os=o('<div><div style="display: flex;    justify-content: space-between;"><div style=" white-space: nowrap;text-align: center;"> </div> <!></div> <!></div>'),ls=o("<div><!> <!></div>"),vs=o("<div><!> <!></div>"),ds=o('<div class="duel_log svelte-14z6bdh"><div class="duel_log_header svelte-14z6bdh"></div> <div class="duel_log_body svelte-14z6bdh"></div> <div class="duel_log_footer svelte-14z6bdh"></div></div>');function cs(d,i){_t(i,!1);let t=pe(void 0),c=Ae(i,"log",8),f,v=pe([]);const p=()=>{const h=((f==null?void 0:f.seq)??-1)+1;c().records.slice(h).forEach(T=>{if(!f){$(v,[[[[T]]]]),f=T;return}if(!e(v)[T.clock.turn]){xe(v,e(v)[T.clock.turn]=[[[T]]]),f=T;return}if(!e(v)[T.clock.turn][T.clock.phaseSeq]){xe(v,e(v)[T.clock.turn][T.clock.phaseSeq]=[[T]]),f=T;return}if(f.clock.chainSeq===T.clock.chainSeq&&f.clock.chainBlockSeq===T.clock.chainBlockSeq&&f.duelist===T.duelist){e(v)[T.clock.turn][T.clock.phaseSeq].slice(-1)[0].push(T),f=T;return}e(v)[T.clock.turn][T.clock.phaseSeq].push([T]),f=T}),$(v,e(v)),sr().then(()=>e(t)&&e(t).scroll(0,e(t).clientHeight*990))};c().onUpdate.append(p),c().duel.view.onDuelUpdate.append(p),p(),ut();var l=be(),H=N(l);{var V=h=>{var T=ds(),X=s(a(T),2);ce(X,5,()=>e(v),fe,(F,re)=>{var E=vs(),n=a(E);{var P=we=>{var ge=as(),ke=a(ge);u(()=>g(ke,`ターン：${e(re)[0][0][0].clock.turn??""}`)),r(we,ge)};y(n,we=>{e(re)[0][0][0].clock.turn>0&&we(P)})}var _e=s(n,2);ce(_e,1,()=>e(re),fe,(we,ge)=>{var ke=ls(),L=a(ke);{var ie=B=>{var ee=rs(),R=a(ee);u(()=>g(R,e(ge)[0][0].clock.period.name)),r(B,ee)};y(L,B=>{e(ge)[0][0].clock.turn>0&&B(ie)})}var k=s(L,2);ce(k,1,()=>e(ge),fe,(B,ee)=>{var R=os();const te=le(()=>{var A;return((A=e(ee).find(j=>j.chainNumber!==void 0))==null?void 0:A.chainNumber)??0});var Be=a(R),w=a(Be),S=a(w),W=s(w,2);{var ue=A=>{var j=ss(),U=a(j);u(()=>g(U,`チェーン：${e(te)??""}`)),r(A,j)};y(W,A=>{e(te)&&A(ue)})}var Se=s(Be,2);ce(Se,1,()=>e(ee),fe,(A,j)=>{var U=ns(),Q=a(U);{var Z=q=>{var O=Ze();u(()=>g(O,e(j).text)),r(q,O)},x=q=>{var O=be(),K=N(O);{var b=_=>{var m=Ze();u((I,J,Ce)=>g(m,`移動：${I??""} ${J??""} ⇒ ${Ce??""}`),[()=>{var I;return(I=e(j).mainEntity)==null?void 0:I.toString()},()=>{var I;return(I=e(j).from)==null?void 0:I.toString()},()=>{var I;return(I=e(j).to)==null?void 0:I.toString()}],le),r(_,m)},C=_=>{var m=be(),I=N(m);{var J=me=>{var oe=Ze();u((se,G)=>g(oe,`生成：${se??""} void ⇒ ${G??""}`),[()=>{var se;return(se=e(j).mainEntity)==null?void 0:se.toString()},()=>{var se;return(se=e(j).to)==null?void 0:se.toString()}],le),r(me,oe)},Ce=me=>{var oe=be(),se=N(oe);{var G=De=>{var Oe=Ze();u((He,Ie)=>g(Oe,`消滅：${He??""} ${Ie??""} ⇒ void`),[()=>{var He;return(He=e(j).mainEntity)==null?void 0:He.toString()},()=>{var He;return(He=e(j).from)==null?void 0:He.toString()}],le),r(De,Oe)},ae=De=>{var Oe=Ze();u(()=>g(Oe,e(j).text)),r(De,Oe)};y(se,De=>{e(j).type==="EntityDisappear"?De(G):De(ae,!1)},!0)}r(me,oe)};y(I,me=>{e(j).type==="EntityAppear"?me(J):me(Ce,!1)},!0)}r(_,m)};y(K,_=>{e(j).type==="EntityMove"?_(b):_(C,!1)},!0)}r(q,O)};y(Q,q=>{e(j).type==="ChainBlockHeader"?q(Z):q(x,!1)})}var z=s(Q,2);{var Y=q=>{var O=is(),K=a(O);u(b=>dt(K,"href",b),[()=>window.URL.createObjectURL(new Blob([ts(e(j).error,(b,C)=>["pool","bundles","duel"].includes(b)||typeof C=="function"?void 0:C,4)],{type:"text/plain"}))],le),r(q,O)};y(z,q=>{e(j).error&&q(Y)})}u(q=>Te(U,`duel_log_record duel_log_record_${q??""} svelte-14z6bdh`),[()=>e(j).type.toSnakeCase()],le),r(A,U)}),u(()=>{var A,j,U;Te(R,`duel_log_block_duelist duel_log_block_duelist_${((A=e(ee)[0].duelist)==null?void 0:A.seat)??"system"} svelte-14z6bdh`),Te(w,`duelist ${((j=e(ee)[0].duelist)==null?void 0:j.seat)??""} svelte-14z6bdh`),g(S,((U=e(ee)[0].duelist)==null?void 0:U.profile.name)||"SYSTEM")}),r(B,R)}),u(()=>Te(ke,`duel_log_block_phase duel_log_block_phase_${e(ge)[0][0].clock.period.key??""} svelte-14z6bdh`)),r(we,ke)}),u(()=>Te(E,`duel_log_block_turn duel_log_block_turn_${e(re)[0][0][0].clock.turn??""} svelte-14z6bdh`)),r(F,E)}),ir(X,F=>$(t,F),()=>e(t)),r(h,T)};y(H,h=>{(c().duel.view.infoBoardState==="Log"||c().duel.view.infoBoardState==="Default")&&h(V)})}r(d,l),ft()}var _s=o("<div><div> </div> <div> </div></div>");function Oa(d,i){_t(i,!1);let t=Ae(i,"duelist",12),c=pe(0),f=pe();const v=async()=>{const X=t().lp-e(c);if(!e(f)||Math.abs(X)<10){$(c,t().lp),e(f)&&(e(f)(),$(f,void 0));return}$(c,e(c)+Math.floor(Math.random()*X)),await Gt(100),v()},p=()=>{t(t()),!e(f)&&t().lp!==e(c)&&new Promise(X=>{$(f,X),Math.abs(t().lp-e(c)),v()})};t().duel.log.onUpdate.append(p),v(),ut();var l=_s(),H=a(l),V=a(H),h=s(H,2),T=a(h);u(X=>{Te(l,`duelist duelist_${X??""} svelte-1sy3trd`),Te(H,`duelist_name duelist_${X??""}_name svelte-1sy3trd`),g(V,t().profile.name),Te(h,`duelist_lp ${(e(f)?"vibration":"")??""} svelte-1sy3trd`),g(T,e(c))},[()=>t().seat.toLowerCase()],le),r(d,l),ft()}const us=(d,i,t)=>(i(i()!=="Detail"?"Detail":"Normal"),console.info(t()),!0),fs=(d,i,t)=>(i(i()!=="Debug"?"Debug":"Normal"),console.info(t()),!0);var ps=o('<div class="svelte-1uevs9j"> </div>'),gs=o('<div class="svelte-1uevs9j"> </div>'),ms=o('<div class="link_arrow_emoji svelte-1uevs9j"> </div>'),ys=o('<div class="duel_card_info_row svelte-1uevs9j" style=" justify-content: space-between;"><div class="svelte-1uevs9j"> </div> <div class="svelte-1uevs9j"> </div></div>'),hs=o('<div></div> <div class="svelte-1uevs9j"> </div>',1),xs=o("<div> </div>"),bs=o('<span class="svelte-1uevs9j">/</span> <div class="monster_defense svelte-1uevs9j"> </div>',1),ws=o("<div> </div>"),ks=o('<div class="duel_card_info_row svelte-1uevs9j"><!> <!> <div style="flex-grow: 1;" class="svelte-1uevs9j"></div> <div class="monster_attack svelte-1uevs9j"> </div> <!></div> <div class="duel_card_info_row svelte-1uevs9j"></div>',1),Cs=o('<div class="duel_card_row svelte-1uevs9j"><div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"> </div></div>'),Ds=o('<div class="duel_card_row svelte-1uevs9j"><div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"> </div></div>'),$s=o("<!> <!>",1),Ss=o('<pre class="description svelte-1uevs9j"> </pre>'),Ms=o('<div class="duel_card_info_row svelte-1uevs9j" style="border-style: solid; border-width: 1px;"><!></div>'),Ts=o('<pre class="description svelte-1uevs9j"> </pre>'),js=o('<!> <div class="duel_card_info_row svelte-1uevs9j"><!></div>',1),Es=o('<div class="effect_counter_area_item svelte-1uevs9j"><span class="svelte-1uevs9j"> </span> <span class="svelte-1uevs9j"> </span> <span class="svelte-1uevs9j">/</span> <span class="svelte-1uevs9j"> </span></div>'),Bs=o('<div class="duel_card_info_row effect_counter_area svelte-1uevs9j"><div class="effect_counter_area_title svelte-1uevs9j">効果使用状況</div> <div class="effect_counter_area_body svelte-1uevs9j"></div></div>'),As=o("[ <!> ],",1),Ys=o('<div class="svelte-1uevs9j"> <!></div>'),Ls=o('<div class="svelte-1uevs9j"> </div> <!> <div class="svelte-1uevs9j"></div>',1),Us=o('<div class="svelte-1uevs9j"> </div>'),Ns=o('<div class="svelte-1uevs9j"> </div>'),Ps=o('<div class="svelte-1uevs9j"> </div>'),qs=o('<div class="svelte-1uevs9j"> </div>'),Fs=o('<div class="svelte-1uevs9j"> </div>'),Hs=o('<div class="svelte-1uevs9j"> </div>'),Is=o('<div class="duel_card_info_row svelte-1uevs9j"><div class="svelte-1uevs9j"><!> <div class="svelte-1uevs9j"></div> <!> <div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"></div> <!> <div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"></div> <!> <div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"></div> <!> <div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"></div> <!> <div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"></div> <!> <div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"> </div> <div class="svelte-1uevs9j"> </div> <div class="svelte-1uevs9j"> </div> <div class="svelte-1uevs9j"></div></div></div>'),Os=o('<div class="svelte-1uevs9j">※エラッタ前のカードです</div>'),Rs=o('<div class="svelte-1uevs9j">※テスト用カードです</div>'),Ws=o('<a target="_blank" rel="noopener noreferrer" title="コナミカードデータベース" class="svelte-1uevs9j"> </a>'),Ks=o('<a target="_blank" rel="noopener noreferrer" title="遊戯王カードWiki" class="svelte-1uevs9j">⇒遊戯王カードWiki</a>'),zs=o('<div class="duel_card_info_links svelte-1uevs9j"><!> <!> <a target="_blank" rel="noopener noreferrer" title="google" class="svelte-1uevs9j">⇒google検索</a></div>'),Vs=o("<!> <!>",1),Gs=o('<div role="contentinfo"><div class="duel_card_info_header svelte-1uevs9j"><div class="duel_card_info_row svelte-1uevs9j"><div class="svelte-1uevs9j"> </div></div> <div class="duel_card_info_row svelte-1uevs9j" style="position:sticky; top:0;"><!> <div class="svelte-1uevs9j"> </div></div> <!></div> <div class="duel_card_info_body svelte-1uevs9j"><!></div> <div class="duel_card_info_footer svelte-1uevs9j"><!></div></div>');function Xs(d,i){_t(i,!1);let t=Ae(i,"entity",8),c=Ae(i,"mode",12,"Normal"),f=pe(new Promise(()=>{}));const v=()=>{var h,T;let V=t()&&t().entityType==="Card"?t().origin.cardId:(T=(h=t())==null?void 0:h.parent)==null?void 0:T.origin.cardId;return V??!1?`https://www.db.yugioh-card.com/yugiohdb/card_search.action?ope=2&cid=${V}`:t()?`https://www.db.yugioh-card.com/yugiohdb/card_search.action?ope=1&sess=1&rp=10&mode=&sort=1&keyword=${t().origin.name}&stype=1&ctype=&othercon=2&starfr=&starto=&pscalefr=&pscaleto=&linkmarkerfr=&linkmarkerto=&link_m=2&atkfr=&atkto=&deffr=&defto=&releaseDStart=1&releaseMStart=1&releaseYStart=1999&releaseDEnd=&releaseMEnd=&releaseYEnd=`:""};ma(()=>(aa(t()),ya),()=>{$(f,ra.then(async V=>{if(t().origin.description||t().origin.pendulumDescription||t().origin.wikiEncodedName)return t().origin;const h=V.getCardInfo(t().origin.name);if(h)return h.cardId!==void 0&&!h.description&&!h.pendulumDescription&&await ya([h.cardId]),h}))}),Ka(),ut();var p=be(),l=N(p);{var H=V=>{var h=Gs();h.__click=[us,c,t],h.__contextmenu=[fs,c,t];var T=a(h),X=a(T),F=a(X),re=a(F),E=s(X,2),n=a(E);{var P=w=>{var S=ps(),W=a(S);u(ue=>g(W,ue),[()=>"★".repeat(t().lvl)],le),r(w,S)},_e=w=>{var S=be(),W=N(S);{var ue=A=>{var j=gs(),U=a(j);u(Q=>g(U,Q),[()=>"☆".repeat(t().rank)],le),r(A,j)},Se=A=>{var j=be(),U=N(j);{var Q=Z=>{var x=ms(),z=a(x);u(Y=>g(z,Y),[()=>t().origin.linkArrowKeys.map(Y=>za[Y].emoji).join("")],le),r(Z,x)};y(U,Z=>{t().origin.linkArrowKeys&&Z(Q)},!0)}r(A,j)};y(W,A=>{t().rank&&t().rank>0?A(ue):A(Se,!1)},!0)}r(w,S)};y(n,w=>{t().lvl&&t().lvl>0?w(P):w(_e,!1)})}var we=s(n,2),ge=a(we),ke=s(E,2);{var L=w=>{var S=$s(),W=N(S);{var ue=U=>{var Q=ys(),Z=a(Q),x=a(Z),z=s(Z,2),Y=a(z);u(()=>{g(x,`◀ ${t().psL??""}`),g(Y,`${t().psR??""} ▶`)}),r(U,Q)};y(W,U=>{var Q;(Q=t().origin.monsterCategories)!=null&&Q.includes("Pendulum")&&U(ue)})}var Se=s(W,2);{var A=U=>{var Q=ks(),Z=N(Q),x=a(Z);ce(x,1,()=>t().attr,fe,(C,_)=>{var m=hs(),I=N(m),J=s(I,2),Ce=a(J);u(()=>{Te(I,`monster_attr ${e(_)??""} svelte-1uevs9j`),g(Ce,`${ka[e(_)]??""}属性`)}),r(C,m)});var z=s(x,2);ce(z,1,()=>t().types,fe,(C,_)=>{var m=xs(),I=a(m);u(()=>{Te(m,`monster_cat ${e(_)??""} svelte-1uevs9j`),g(I,`${_a[e(_)]??""}${Ca[e(_)]??""}族`)}),r(C,m)});var Y=s(z,4),q=a(Y),O=s(Y,2);{var K=C=>{var _=bs(),m=s(N(_),2),I=a(m);u(()=>g(I,t().def??"?")),r(C,_)};y(O,C=>{var _;(_=t().status.monsterCategories)!=null&&_.includes("Link")||C(K)})}var b=s(Z,2);ce(b,5,()=>t().status.monsterCategories??[],fe,(C,_)=>{var m=ws(),I=a(m);u(()=>{Te(m,`monster_cat ${e(_)??""} svelte-1uevs9j`),g(I,`${sa[e(_)]??""}${la[e(_)]??""}`)}),r(C,m)}),u(()=>g(q,t().atk??"?")),r(U,Q)},j=U=>{var Q=be(),Z=N(Q);{var x=Y=>{var q=Cs(),O=s(a(q),2),K=a(O);u(()=>g(K,`${ua[t().status.spellCategory]??""}魔法`)),r(Y,q)},z=Y=>{var q=be(),O=N(q);{var K=b=>{var C=Ds(),_=s(a(C),2),m=a(_);u(()=>g(m,`${fa[t().status.trapCategory]??""}罠`)),r(b,C)};y(O,b=>{t().kind==="Trap"&&t().status.trapCategory&&b(K)},!0)}r(Y,q)};y(Z,Y=>{t().kind==="Spell"&&t().status.spellCategory?Y(x):Y(z,!1)},!0)}r(U,Q)};y(Se,U=>{t().kind==="Monster"?U(A):U(j,!1)})}r(w,S)};y(ke,w=>{c()!=="Debug"&&w(L)})}var ie=s(T,2),k=a(ie);{var B=w=>{var S=js(),W=N(S);{var ue=j=>{var U=Ms(),Q=a(U);yt(Q,()=>e(f),Z=>{var x=Ze('"読み込み中"');r(Z,x)},(Z,x)=>{var z=Ss(),Y=a(z);u(()=>{var q;return g(Y,(q=e(x))==null?void 0:q.pendulumDescription)}),r(Z,z)}),r(j,U)};y(W,j=>{var U;(U=t().status.monsterCategories)!=null&&U.includes("Pendulum")&&j(ue)})}var Se=s(W,2),A=a(Se);yt(A,()=>e(f),j=>{var U=Ze('"読み込み中"');r(j,U)},(j,U)=>{var Q=Ts(),Z=a(Q);u(()=>{var x;return g(Z,(x=e(U))==null?void 0:x.description)}),r(j,Q)}),r(w,S)},ee=w=>{var S=be(),W=N(S);{var ue=A=>{var j=be(),U=N(j);{var Q=Z=>{var x=Bs(),z=s(a(x),2);ce(z,5,()=>t().actions,fe,(Y,q)=>{var O=be();const K=le(()=>e(q).actionCountUpperBound),b=le(()=>e(q).actionCount);var C=N(O);{var _=m=>{var I=Es(),J=a(I),Ce=a(J),me=s(J,2),oe=a(me),se=s(me,4),G=a(se);u(()=>{g(Ce,e(q).title),g(oe,e(b)),g(G,e(K))}),r(m,I)};y(C,m=>{e(K)!==void 0&&e(b)!==void 0&&m(_)})}r(Y,O)}),r(Z,x)};y(U,Z=>{t().actions.some(x=>x.actionCountUpperBoundKey)&&Z(Q)})}r(A,j)},Se=A=>{var j=Is(),U=a(j),Q=a(U);ce(Q,0,()=>["info","status"],fe,(Ee,ye)=>{var je=Ls(),Ue=N(je),Re=a(Ue),st=s(Ue,2);ce(st,1,()=>Object.entries(t()[ye]),fe,(et,xt)=>{let ot=()=>e(xt)[0],Dt=()=>e(xt)[1];var Ut=Ys(),Tt=a(Ut),Zt=s(Tt);{var Kt=D=>{var ve=As(),$e=s(N(ve));ce($e,1,Dt,fe,(We,Xe)=>{var Ye=Ze();u(tt=>g(Ye,`${tt??""},`),[()=>e(Xe).toString()],le),r(We,Ye)}),r(D,ve)},M=D=>{var ve=Ze();u($e=>g(ve,`${$e??""},`),[()=>{var $e;return($e=Dt())==null?void 0:$e.toString()}],le),r(D,ve)};y(Zt,D=>{Array.isArray(Dt())?D(Kt):D(M,!1)})}u(()=>g(Tt,`"${ot()??""}" : `)),r(et,Ut)});var ze=s(st,2);ze.textContent="},",u(()=>g(Re,`"${ye??""}" :{`)),r(Ee,je)});var Z=s(Q,2);Z.textContent='"actions" :[';var x=s(Z,2);ce(x,1,()=>t().actions,fe,(Ee,ye)=>{var je=Us(),Ue=a(je);u(()=>g(Ue,`"${e(ye).playType??""} ${e(ye).title??""}",`)),r(Ee,je)});var z=s(x,2);z.textContent="],";var Y=s(z,2);Y.textContent='"substituteEffects" :[';var q=s(Y,2);ce(q,1,()=>t().substituteEffects,fe,(Ee,ye)=>{var je=Ns(),Ue=a(je);u(()=>g(Ue,`"${e(ye).title??""}",`)),r(Ee,je)});var O=s(q,2);O.textContent="],";var K=s(O,2);K.textContent='"continuousEffects" :[';var b=s(K,2);ce(b,1,()=>t().continuousEffects,fe,(Ee,ye)=>{var je=Ps(),Ue=a(je);u(()=>g(Ue,`"${e(ye).isStarted??""}",`)),r(Ee,je)});var C=s(b,2);C.textContent="],";var _=s(C,2);_.textContent='"procFilters" :[';var m=s(_,2);ce(m,1,()=>t().procFilterBundle.operators,fe,(Ee,ye)=>{var je=qs(),Ue=a(je);u(Re=>g(Ue,`"${Re??""} ${e(ye).title??""} ${e(ye).isEffective??""} ",`),[()=>e(ye).isSpawnedBy.toString()],le),r(Ee,je)});var I=s(m,2);I.textContent="],";var J=s(I,2);J.textContent='"numericStateOperators" :[';var Ce=s(J,2);ce(Ce,1,()=>t().numericOprsBundle.operators,fe,(Ee,ye)=>{var je=Fs(),Ue=a(je);u(Re=>g(Ue,`"${Re??""} ${e(ye).title??""} ${e(ye).isEffective??""} ${e(ye).isContinuous??""} ${e(ye).targetState??""} ${e(ye).targetStateGen??""} ",`),[()=>e(ye).isSpawnedBy.toString()],le),r(Ee,je)});var me=s(Ce,2);me.textContent="],";var oe=s(me,2);oe.textContent='"stateOperators" :[';var se=s(oe,2);ce(se,1,()=>t().statusOperatorBundle.operators,fe,(Ee,ye)=>{var je=Hs(),Ue=a(je);u(Re=>g(Ue,`"${Re??""} ${e(ye).title??""} ${e(ye).isEffective??""} ",`),[()=>e(ye).isSpawnedBy.toString()],le),r(Ee,je)});var G=s(se,2);G.textContent="],";var ae=s(G,2);ae.textContent='"lastMoveLogRecord" :{';var De=s(ae,2),Oe=a(De),He=s(De,2),Ie=a(He),Le=s(He,2),Ge=a(Le),nt=s(Le,2);nt.textContent="},",u((Ee,ye)=>{g(Oe,`"movedBy":"${Ee??""}",`),g(Ie,`"movedAs":"${ye??""}",`),g(Ge,`"movedAt":"${t().moveLog.latestRecord.movedAt.totalProcSeq??""}",`)},[()=>{var Ee;return(Ee=t().moveLog.latestRecord.movedBy)==null?void 0:Ee.toString()},()=>t().moveLog.latestRecord.movedAs.join(" ")],le),r(A,j)};y(W,A=>{c()==="Detail"?A(ue):A(Se,!1)},!0)}r(w,S)};y(k,w=>{c()==="Normal"?w(B):w(ee,!1)})}var R=s(ie,2),te=a(R);{var Be=w=>{var S=Vs(),W=N(S);{var ue=U=>{var Q=Os();r(U,Q)};y(W,U=>{t().origin.isOldVersion&&U(ue)})}var Se=s(W,2);{var A=U=>{var Q=Rs();r(U,Q)},j=U=>{var Q=zs(),Z=a(Q);{var x=q=>{var O=Ws();const K=le(()=>t().entityType==="Card"?t():t().parent);var b=a(O);u(C=>{var _;dt(O,"href",C),g(b,`⇒${((_=e(K))!=null&&_.origin.cardId?"公式カードページ":"公式で検索")??""}`)},[v],le),r(q,O)};y(Z,q=>{var O;t()&&(t().entityType==="Card"||((O=t().parent)==null?void 0:O.entityType)==="Card")&&q(x)})}var z=s(Z,2);yt(z,()=>e(f),null,(q,O)=>{var K=be(),b=N(K);{var C=_=>{var m=Ks();u(()=>dt(m,"href",`https://yugioh-wiki.net/index.php?${e(O).wikiEncodedName}`)),r(_,m)};y(b,_=>{e(O)&&e(O).wikiEncodedName&&_(C)})}r(q,K)});var Y=s(z,2);u(()=>dt(Y,"href",`https://www.google.com/search?q=遊戯王 ${t().origin.name}`)),r(U,Q)};y(Se,U=>{t().origin.isForTest?U(A):U(j,!1)})}r(w,S)};y(te,w=>{t()&&w(Be)})}u((w,S)=>{Te(h,`duel_card duel_card_info ${t().origin.kind??""} ${w??""} svelte-1uevs9j`),g(re,t().nm),g(ge,S)},[()=>{var w;return(w=t().origin.monsterCategories)==null?void 0:w.join(" ")},()=>"★".repeat(t().lvl||0)],le),r(V,h)};y(l,V=>{t()&&V(H)})}r(d,p),ft()}Wa(["click","contextmenu"]);var Qs=o('<div class="duel_field_cell_info_item svelte-1xj7qf1"><!></div>'),Js=o('<div class="duel_field_cell_info_box svelte-1xj7qf1"><div class="duel_field_cell_info_label svelte-1xj7qf1"> </div> <!></div>'),Zs=o('<div class="duel_field_cell_info svelte-1xj7qf1"><div class="duel_field_cell_info_header item_btn svelte-1xj7qf1"><div class="svelte-1xj7qf1"> </div> <div class="svelte-1xj7qf1"> </div></div> <div class="duel_field_cell_info_body svelte-1xj7qf1"></div></div>');function ei(d,i){_t(i,!1);let t=Ae(i,"cell",12);const c=()=>{t(t())},f=H=>t().cardEntities.filter(V=>V.face===H);t().field.duel.view.onDuelUpdate.append(c),ut();var v=be(),p=N(v);{var l=H=>{var V=Zs(),h=a(V),T=a(h),X=a(T),F=s(T,2),re=a(F),E=s(h,2);ce(E,4,()=>["FaceUp","FaceDown"],fe,(n,P)=>{var _e=be(),we=N(_e);{var ge=ke=>{var L=Js(),ie=a(L),k=a(ie),B=s(ie,2);ce(B,1,()=>f(P).toSorted(nr),fe,(ee,R)=>{var te=Qs(),Be=a(te);const w=le(()=>t().owner===t().field.duel.duelists.Below);Ot(Be,{get entity(){return e(R)},get isVisibleForcibly(){return e(w)},isWideMode:!0,cardActionResolve:void 0}),r(ee,te)}),u(()=>g(k,P==="FaceUp"?"表向き":"裏向き")),r(ke,L)};y(we,ke=>{f(P).length&&ke(ge)})}r(n,_e)}),u(()=>{var n;g(X,(n=t().owner)==null?void 0:n.profile.name),g(re,t().cellType)}),r(H,V)};y(p,H=>{t().field.duel.view.infoBoardState==="CellInfo"&&H(l)})}r(d,v),ft()}var ti=o('<div class="duel_config_item svelte-y4u26k"><label class="toggle svelte-y4u26k"><input type="checkbox" class="svelte-y4u26k"></label> <span class="svelte-y4u26k"> </span></div>'),ai=o('<div class="duel_config svelte-y4u26k"><div class="duel_config_title svelte-y4u26k">デュエル設定</div> <div class="duel_config_group svelte-y4u26k"><div class="duel_config_group_title svelte-y4u26k">チェーン設定</div> <!></div></div>');function ri(d,i){_t(i,!1);let t=Ae(i,"viewController",8),c=Ae(i,"userProfile",12);ut();var f=be(),v=N(f);{var p=l=>{var H=ai(),V=s(a(H),2),h=s(a(V),2);ce(h,1,()=>vr,fe,(T,X)=>{var F=ti(),re=a(F),E=a(re),n=s(re,2),P=a(n);u(()=>g(P,or[e(X)])),lr(E,()=>c().chainConfig[e(X)],_e=>c(c().chainConfig[e(X)]=_e,!0)),de("change",E,()=>c().save()),r(T,F)}),r(l,H)};y(v,l=>{t().infoBoardState==="Config"&&l(p)})}r(d,f),ft()}function si(d,{from:i,to:t},c={}){var{delay:f=0,duration:v=L=>Math.sqrt(L)*120,easing:p=xa}=c,l=getComputedStyle(d),H=l.transform==="none"?"":l.transform,[V,h]=l.transformOrigin.split(" ").map(parseFloat);V/=d.clientWidth,h/=d.clientHeight;var T=ii(d),X=d.clientWidth/t.width/T,F=d.clientHeight/t.height/T,re=i.left+i.width*V,E=i.top+i.height*h,n=t.left+t.width*V,P=t.top+t.height*h,_e=(re-n)*X,we=(E-P)*F,ge=i.width/t.width,ke=i.height/t.height;return{delay:f,duration:typeof v=="function"?v(Math.sqrt(_e*_e+we*we)):v,easing:p,css:(L,ie)=>{var k=ie*_e,B=ie*we,ee=L+ie*ge,R=L+ie*ke;return`transform: ${H} translate(${k}px, ${B}px) scale(${ee}, ${R});`}}}function ii(d){if("currentCSSZoom"in d)return d.currentCSSZoom;for(var i=d,t=1;i!==null;)t*=+getComputedStyle(i).zoom,i=i.parentElement;return t}var ni=o('<div class="chain_number svelte-lqu21u"> </div>'),oi=o('<div class="duel_card_row svelte-lqu21u"> </div>'),li=o('<div class="appendix svelte-lqu21u"> </div>'),vi=o('<div class="appendix_wrapper svelte-lqu21u"></div>'),di=o('<div><div><!> <div> </div> <div><!> <div class="duel_card_row svelte-lqu21u"><div> </div> <!></div></div></div></div>'),ci=o("<div></div>");function _i(d,i){_t(i,!1);let t=Ae(i,"duel",8),c=Ae(i,"position",8,"left");const f=-100,v=()=>c()==="left"?-100:100;let p=pe([]),l=Promise.resolve(),H=Promise.resolve();const V=1e3,h=500,T=400,X=re=>{const E={...re};E.isKnown=re.chainBlockInfo.action.entity.controller.duelistType==="Player"||re.chainBlockInfo.action.entity.face==="FaceUp",E.chainBlockInfo.onStateChange.append(n=>{if(n==="done"||n==="failed"||n==="negated")return l=l.then(async()=>{const P=new Date().getTime()-E.chainBlockInfo.wasSpawnedAt.getTime();P<V&&await Gt(V-P),$(p,e(p).filter(_e=>_e.seq!==E.seq)),await Gt(h+T)}).then(),"RemoveMe";$(p,e(p))}),H=H.then(async()=>{$(p,[E,...e(p)].sort((n,P)=>dr.isSameChain(n.clock,P.clock)&&n.chainBlockInfo.action.isWithChainBlock&&P.chainBlockInfo.action.isWithChainBlock?P.clock.totalProcSeq-n.clock.totalProcSeq:n.clock.totalProcSeq-P.clock.totalProcSeq)),await Gt(300)}),l=l.then(()=>Gt(1e3))};t().chainBlockLog.onInsert.append(X),ut();var F=ci();ce(F,13,()=>e(p),re=>re.seq,(re,E)=>{var n=di();const P=le(()=>{const{activator:S,action:W,appendix:ue}=e(E).chainBlockInfo;return{activator:S,action:W,appendix:ue}});var _e=a(n),we=a(_e);{var ge=S=>{var W=ni(),ue=a(W);u(()=>g(ue,`チェーン：${e(E).chainBlockInfo.chainNumber??""}`)),r(S,W)};y(we,S=>{e(E).chainBlockInfo.chainNumber&&S(ge)})}var ke=s(we,2),L=a(ke),ie=s(ke,2),k=a(ie);{var B=S=>{var W=oi(),ue=a(W);u(()=>g(ue,e(E).isKnown?e(P).action.entity.nm:"？？？")),r(S,W)};y(k,S=>{(e(P).action.entity.entityType==="Card"||e(P).action.entity.entityType==="Token")&&S(B)})}var ee=s(k,2),R=a(ee),te=a(R),Be=s(R,2);{var w=S=>{var W=vi();ce(W,5,()=>e(P).appendix,fe,(ue,Se)=>{var A=li(),j=a(A);u(()=>g(j,e(Se))),r(ue,A)}),r(S,W)};y(Be,S=>{e(P).appendix&&S(w)})}u((S,W,ue)=>{Te(n,`cut_in_row ${(!e(E).chainBlockInfo.chainNumber||e(E).chainBlockInfo.chainNumber===1?"cut_in_row_first":"")??""} svelte-lqu21u`),Te(_e,`cut_in_item cut_in_item_${S??""} cut_in_item_${e(E).chainBlockInfo.state??""} svelte-lqu21u`),Te(ke,`duelist_name duelist_${S??""}_name svelte-lqu21u`),g(L,e(P).activator.profile.name),Te(ie,`duel_card duel_card_${S??""} ${W??""} ${(e(E).isKnown?e(P).action.entity.origin.kind:"")??""} ${e(P).action.entity.entityType??""}  svelte-lqu21u`),g(te,ue)},[()=>e(P).activator.seat.toLowerCase(),()=>e(E).isKnown?(e(P).action.entity.status.monsterCategories??[]).join(" "):"Token",()=>e(P).action.toString()],le),ne(3,_e,()=>Br,()=>new Date().getTime()-e(E).chainBlockInfo.wasSpawnedAt.getTime()<V?{x:v(),duration:T}:{y:f,duration:T}),cr(n,()=>si,()=>({duration:h})),r(re,n)}),u(()=>Te(F,`cut_in_container cut_in_container_${c()??""} svelte-lqu21u`)),r(d,F),ft()}const ui=Ar({duration:400});var fi=o('<div class="duel_desk_left v_flex svelte-1w535im"><!> <!> <!></div>'),pi=o('<button class="duel_field_header_message svelte-1w535im"> </button> <div class="duel_field_header_buttons svelte-1w535im"><button class="svelte-1w535im">サレンダー</button></div>',1),gi=o("<tr></tr>"),mi=o('<table class="duel_field svelte-1w535im"><tbody class="svelte-1w535im"></tbody></table>'),yi=o('<button class="svelte-1w535im">OK</button>'),hi=o('<button class="svelte-1w535im">cancel</button>'),xi=o("<!> <!>",1),bi=o('<button class="svelte-1w535im"> </button>'),wi=o('<div style="text-align: left;"><!> <!> <!></div>'),ki=o('<div><!> <div class=" duel_desk_center v_flex svelte-1w535im"><div class="duel_field_header svelte-1w535im"><!></div> <div class="duel_field_body svelte-1w535im"><!></div> <div class="duel_field_footer svelte-1w535im"><!></div></div> <!></div> <div style="position:fixed;bottom:0"> </div> <!> <div><!></div>',1);function Ci(d,i){_t(i,!1);let t=Ae(i,"duel",12),c=Ae(i,"userProfile",8),f=pe(0),v=pe(0),p=pe([]),l=pe([]),H=()=>{},V=pe([]),h=pe(),T=pe(),X=pe(()=>!1),F=pe(!1);const re=_=>{H=_.resolve,$(V,_.dummyActionInfos.filter(m=>m.action.entity.entityType==="Duelist").filter(m=>m.action.entity.controller.seat==="Below")),$(h,void 0),$(T,void 0),$(l,[]),$(p,[]),$(F,!1),_.entitiesChoices&&($(h,_.entitiesChoices),$(X,()=>{var m;return((m=_.entitiesChoices)==null?void 0:m.validator(e(p)))??!1}),$(F,_.entitiesChoices.cancelable),e(h).selectables.every(m=>m.cell.isPlayFieldCell&&m.getIndexInCell()===0||m.cell.cellType==="Hand"&&m.controller.duelistType==="Player"||m.entityType==="Duelist")||t().view.modalController.entitySelector.show({title:t().view.message,position:"Middle",entitiesChoices:_.entitiesChoices,chainBlockInfos:_.chainBlockInfos,cancelable:_.entitiesChoices.cancelable}).then(m=>{H({selectedEntities:m})})),_.cellsChoices&&($(T,_.cellsChoices),$(X,()=>{var m;return((m=_.cellsChoices)==null?void 0:m.validator(e(l)))??!1}),$(F,_.cellsChoices.cancelable))};t().view.onWaitStart.append(re);const E=()=>{H=()=>{},$(T,void 0),$(h,void 0),$(l,[]),$(p,[]),$(X,()=>!1),$(F,!1)};t().view.onWaitEnd.append(E);let n=pe(void 0),P=pe("Normal");const _e=({card:_,mode:m})=>{$(n,_),$(P,m??(e(n)===_||e(P)==="Normal"?"Detail":"Normal"))};t().view.onShowCardEntity.append(_e);const we=()=>{t(t())};t().view.onDuelUpdate.append(we),t().log.onUpdate.append(we);const ge=()=>{e(h)&&e(h).validator(e(p))&&H({selectedEntities:e(p)}),e(T)&&e(T).validator(e(l))&&H({selectedCells:e(l)})},ke=()=>{H({})},L=_=>{H({actionInfo:_})},ie=()=>{H({surrender:!0})};t().main();const k=()=>e(f)<=1400?"compact":"wide";ut();var B=ki(),ee=N(B),R=a(ee);{var te=_=>{var m=fi(),I=a(m);Oa(I,{get duelist(){return t().duelists.Above}});var J=s(I,2);{var Ce=oe=>{Xs(oe,{get entity(){return e(n)},get mode(){return e(P)}})};y(J,oe=>{e(n)&&oe(Ce)})}var me=s(J,2);Oa(me,{get duelist(){return t().duelists.Below}}),r(_,m)};y(R,_=>{k()==="wide"&&_(te)})}var Be=s(R,2),w=a(Be),S=a(w);{var W=_=>{var m=pi(),I=N(m),J=a(I),Ce=s(I,2),me=a(Ce);u(()=>g(J,`[TURN:${t().clock.turn}][PHASE:${t().phase}] ${t().view.message}`)),de("click",I,()=>{t(t().view.infoBoardState="Log",!0)}),de("click",me,ie),r(_,m)};y(S,_=>{t().isEnded||_(W)})}var ue=s(w,2),Se=a(ue);{var A=_=>{var m=mi(),I=a(m);ce(I,5,()=>t().field.cells,fe,(J,Ce,me)=>{var oe=gi();Te(oe,`${`duel_desk_row_${me}`??""} svelte-1w535im`),ce(oe,5,()=>e(Ce),fe,(se,G,ae)=>{es(se,{get view(){return t().view},row:me,column:ae,get selectedEntities(){return e(p)},set selectedEntities(De){$(p,De)},get selectedCells(){return e(l)},set selectedCells(De){$(l,De)},$$legacy:!0})}),r(J,oe)}),r(_,m)};y(Se,_=>{t().clock.turn>0&&_(A)})}var j=s(ue,2),U=a(j);{var Q=_=>{var m=xi(),I=N(m);{var J=oe=>{var se=yi();u(G=>se.disabled=G,[()=>!e(X)()],le),de("click",se,ge),r(oe,se)};y(I,oe=>{((e(h)&&e(h).qty)??(e(T)&&e(T).qty)??9999)>1&&oe(J)})}var Ce=s(I,2);{var me=oe=>{var se=hi();de("click",se,ke),r(oe,se)};y(Ce,oe=>{e(F)&&oe(me)})}r(_,m)},Z=_=>{var m=be(),I=N(m);ce(I,1,()=>e(V),fe,(J,Ce)=>{var me=bi(),oe=a(me);u(()=>g(oe,e(Ce).action.title)),de("click",me,()=>L(e(Ce))),r(J,me)}),r(_,m)};y(U,_=>{e(h)&&e(h).selectables.length||e(T)&&e(T).selectables?_(Q):_(Z,!1)})}var x=s(Be,2);{var z=_=>{var m=wi(),I=a(m);cs(I,{get log(){return t().log}});var J=s(I,2);ei(J,{get cell(){return t().view.infoBoardCell}});var Ce=s(J,2);ri(Ce,{get userProfile(){return c()},get viewController(){return t().view}}),u(me=>Te(m,`duel_desk_right duel_desk_right_${me??""}  svelte-1w535im`),[()=>t().view.infoBoardState.toLowerCase()],le),ne(3,m,()=>he,()=>({duration:e(f)>1400?0:200,axis:"x"})),r(_,m)};y(x,_=>{(e(f)>1400||t().view.infoBoardState!=="Default")&&_(z)})}var Y=s(ee,2),q=a(Y),O=s(Y,2);_r(O,{get modalController(){return t().view.modalController}});var K=s(O,2),b=a(K);const C=le(()=>k()==="wide"?"right":"left");_i(b,{get duel(){return t()},get position(){return e(C)}}),u((_,m)=>{Te(ee,`flex duel_desk ${_??""}_mode svelte-1w535im`),g(q,m),Te(K,`cutin ${_??""}_mode svelte-1w535im`)},[k,()=>t().clock.toFullString()],le),va("innerWidth",_=>$(f,_)),va("innerHeight",_=>$(v,_)),r(d,B),ft()}var Di=o("<div></div>"),$i=o("<!> <!> <!> <!>",1),Si=o('<span class="svelte-1heimo"> </span> / <span class="svelte-1heimo"> </span>',1),Mi=o('<div role="listitem"><div class="svelte-1heimo"><div class="svelte-1heimo"> </div> <div style="display:flex; flex-wrap: wrap;" class="svelte-1heimo"><div style="text-wrap-mode: nowrap;" class="svelte-1heimo"><!> <!> <!></div> <div class="atk_def svelte-1heimo"><!></div></div></div></div>');function Ga(d,i){_t(i,!1);let t=Ae(i,"cardInfo",8),c=Ae(i,"onAttention",8),f=Ae(i,"onCardDragStart",8),v=Ae(i,"onCardDragging",8),p=Ae(i,"onCardDragEnd",8);ut();var l=Mi(),H=a(l),V=a(H),h=a(V),T=s(V,2),X=a(T),F=a(X);{var re=L=>{var ie=$i(),k=N(ie);{var B=w=>{var S=Ze();u(()=>g(S,`★${t().level??""}`)),r(w,S)},ee=w=>{var S=be(),W=N(S);{var ue=A=>{var j=Ze();u(()=>g(j,`☆${t().rank??""}`)),r(A,j)},Se=A=>{var j=be(),U=N(j);{var Q=Z=>{var x=Ze();u(()=>g(x,`Ｌ${t().link??""}`)),r(Z,x)};y(U,Z=>{t().link&&Z(Q)},!0)}r(A,j)};y(W,A=>{t().rank?A(ue):A(Se,!1)},!0)}r(w,S)};y(k,w=>{t().level?w(B):w(ee,!1)})}var R=s(k,2);ce(R,1,()=>t().attributes??[],fe,(w,S)=>{var W=Di();u(()=>Te(W,`monster_attr ${e(S)??""} svelte-1heimo`)),r(w,W)});var te=s(R,2);ce(te,1,()=>t().types??[],fe,(w,S)=>{var W=Ze();u(()=>g(W,_a[e(S)])),r(w,W)});var Be=s(te,2);ce(Be,1,()=>t().monsterCategories??[],fe,(w,S)=>{var W=Ze();u(()=>g(W,sa[e(S)])),r(w,W)}),r(L,ie)};y(F,L=>{t().kind==="Monster"&&L(re)})}var E=s(F,2);{var n=L=>{var ie=Ze();u(()=>g(ie,`${ua[t().spellCategory]??""}魔法`)),r(L,ie)};y(E,L=>{t().spellCategory&&L(n)})}var P=s(E,2);{var _e=L=>{var ie=Ze();u(()=>g(ie,`${fa[t().trapCategory]??""}罠`)),r(L,ie)};y(P,L=>{t().trapCategory&&L(_e)})}var we=s(X,2),ge=a(we);{var ke=L=>{var ie=Si(),k=N(ie),B=a(k),ee=s(k,2),R=a(ee);u(()=>{g(B,t().attack??"?"),g(R,t().defense??"?")}),r(L,ie)};y(ge,L=>{t().kind==="Monster"&&L(ke)})}u(L=>{Te(l,`${L??""} svelte-1heimo`),g(h,t().name)},[()=>{var L,ie;return`deck_editor_card duel_card ${t().kind} ${(ie=(L=t())==null?void 0:L.monsterCategories)==null?void 0:ie.join(" ")} ${t().isImplemented?"is_implemented":"is_not_implemented"}`}],le),de("click",l,()=>c()(t())),de("touchstart",l,L=>f()(t(),{x:L.changedTouches[0].clientX,y:L.changedTouches[0].clientY})),de("touchmove",l,L=>v()(t(),{x:L.changedTouches[0].clientX,y:L.changedTouches[0].clientY})),de("touchend",l,()=>p()()),r(d,l),ft()}var Ti=o('<div class="svelte-10okixm"><button class="button_style_reset svelte-10okixm">クリア</button></div>'),ji=o('<li class="deck_editor_item svelte-10okixm"><!> <button class="button_style_reset plus_minus_button svelte-10okixm">+</button> <button class="button_style_reset plus_minus_button svelte-10okixm">-</button></li>'),Ei=o('<div class="deck_editor_card_kind_header svelte-10okixm"><div class="svelte-10okixm"> <!> 枚） <!></div> <div style="display: flex;" class="svelte-10okixm"><!> <div class="triangle svelte-10okixm">▲</div></div></div> <div class="deck_editor_card_kind_body svelte-10okixm"><ul></ul></div>',1),Bi=o("<div><!></div>"),Ai=o('<div class="deck_editor_card_list svelte-10okixm"></div>');function Ra(d,i){_t(i,!1);let t=Ae(i,"allCardTree",8),c=Ae(i,"deckCardTree",12),f=Ae(i,"mode",8),v=Ae(i,"onAttention",8),p=Ae(i,"searchCondition",8,void 0),l=Ae(i,"onCardDragStart",8),H=Ae(i,"onCardDragging",8),V=Ae(i,"onCardDragEnd",8),h=pe("ExtraMonster");const T=ha.terminalTypeName==="PC"?500:ha.terminalTypeName==="Tablet Device"?300:100,X=20;let F=pe(X);const re=(k=!1)=>{if(k||$(F,X),$(F,e(F)+10),f()==="List"){if(e(F)>=T)return}else if(e(F)>fr(...Object.values(c()).map(B=>B.length)))return;Gt(100).then(()=>re(!0))},E=pe(f()==="List"?t():c()),n=(...k)=>{const B=k.length?k:Rt(e(E)),ee=(R,te)=>{var Be;return Ea(R,te,(Be=p())==null?void 0:Be.sort.filter(w=>w.priority>0).toSorted((w,S)=>w.priority-S.priority))};B.forEach(R=>e(E)[R].sort(ee))},P=(k,B)=>{c(c()[B]=[],!0)},_e=(k,B)=>{const ee=ga(B),R=c()[ee].filter(Be=>Be.name===B.name).length;let te=k.shiftKey?3-R:1;console.debug(B,ee,R,te),!k.ctrlKey&&R>2&&(te=0),te&&c(c()[ee]=[...c()[ee],...Array(te).fill(B)].sort(Ea),!0),v()(B)},we=(k,B)=>{const ee=ga(B);let R=0;c(c()[ee]=c()[ee].filter(te=>te.name!==B.name?!0:(R++,!k.shiftKey&&R>1)),!0),v()(B)};let ge=pe(structuredClone(e(E))),ke=pe("");const L=k=>{if(!p())return!0;if(k.kind==="XyzMaterial")return!1;const B=ga(k);if(!p().deckCardKinds.includes(B)||p().name.trim().length&&[k.name,...k.nameTags??[],...k.textTags??[]].every(R=>!R.includes(p().name))||!k.isImplemented&&!p().others.includes("implemented")||k.isForTest&&!p().others.includes("test")||k.isOldVersion&&!p().others.includes("oldVersion"))return!1;if(k.kind==="Monster"){if(k.attributes&&!p().monsterAttributes.union(k.attributes).length||k.types&&!p().monsterTypes.union(k.types).length)return!1;const ee=k.level??k.rank??k.link;return Yt(p().starLowerBound)&&(ee??0)<p().starLowerBound||Yt(p().starUpperBound)&&(ee??0)>p().starUpperBound||Yt(p().atkLowerBound)&&(k.attack??0)<p().atkLowerBound||Yt(p().atkUpperBound)&&(k.attack??0)>p().atkUpperBound||Yt(p().defLowerBound)&&(k.defense??0)<p().defLowerBound||Yt(p().defUpperBound)&&(k.defense??0)>p().defUpperBound||Yt(p().atkPlusDef)&&(!Yt(k.attack)||!Yt(k.defense)||k.attack+k.defense!==p().atkPlusDef)||!k.monsterCategories||B==="ExtraMonster"&&!k.monsterCategories.union(p().exMonsterCategories).length?!1:k.monsterCategories.union(p().monsterCategories).length}if(k.kind==="Spell")return k.spellCategory&&p().spellCategories.includes(k.spellCategory);if(k.kind==="Trap")return k.trapCategory&&p().trapCategories.includes(k.trapCategory)};ma(()=>(aa(f()),e(E),aa(c()),e(h),e(ge)),()=>{if(f()==="Deck"){if(Rt(e(E)).forEach(k=>xe(E,e(E)[k]=c()[k])),!e(E)[e(h)].length)$(h,Rt(e(E)).find(k=>e(E)[k].find(L))??"ExtraMonster");else{const k=Rt(e(E)).map(B=>({kind:B,cardInfos:e(E)[B]})).filter(({cardInfos:B})=>B.length).find(({kind:B,cardInfos:ee})=>ee.length!==e(ge)[B].length);k&&e(h)!==k.kind&&$(h,k.kind)}$(ge,structuredClone(e(E)))}}),ma(()=>(aa(f()),aa(p()),e(ke)),()=>{var k;if(f()==="List"){const B=JSON.stringify((k=p())==null?void 0:k.sort);e(ke)!==B&&($(ke,B),n()),re()}}),Ka(),ut();var ie=Ai();ce(ie,5,()=>Xt,fe,(k,B,ee)=>{var R=Bi();const te=le(()=>e(E)[e(B)].filter(L));var Be=a(R);{var w=S=>{var W=Ei(),ue=N(W),Se=a(ue),A=a(Se),j=s(A);{var U=K=>{var b=Ze();u(C=>g(b,`/ ${C??""}`),[()=>e(E)[e(B)].length.toLocaleString()],le),r(K,b)};y(j,K=>{f()==="List"&&K(U)})}var Q=s(j,2);{var Z=K=>{var b=Ze();u(C=>g(b,`※表示上限${C??""}枚`),[()=>T.toLocaleString()],le),r(K,b)};y(Q,K=>{e(te).length>T&&K(Z)})}var x=s(Se,2),z=a(x);{var Y=K=>{var b=Ti(),C=a(b);de("click",C,_=>P(_,e(B))),r(K,b)};y(z,K=>{f()==="Deck"&&e(te).length&&K(Y)})}var q=s(ue,2),O=a(q);ce(O,5,()=>e(te),fe,(K,b,C)=>{var _=be(),m=N(_);{var I=J=>{var Ce=ji(),me=a(Ce);Ga(me,{get cardInfo(){return e(b)},get onAttention(){return v()},get onCardDragStart(){return l()},get onCardDragging(){return H()},get onCardDragEnd(){return V()}});var oe=s(me,2),se=s(oe,2);u(G=>{oe.disabled=!e(b).isImplemented,dt(oe,"title",e(b).isImplemented?`※shiftキー同時押しで一括投入
※ctrlキー同時押しで枚数制限無視`:""),se.disabled=G,dt(se,"title",e(b).isImplemented?"※shiftキー同時押しで一括外し":"")},[()=>f()!=="Deck"&&c()[e(B)].every(G=>G.name!==e(b).name)],le),de("click",oe,G=>_e(G,e(b))),de("click",se,G=>we(G,e(b))),r(J,Ce)};y(m,J=>{C<e(F)&&(C<20||e(h)===e(B))&&J(I)})}r(K,_)}),u(K=>{g(A,`${Va[e(B)]??""}（${K??""} `),Te(O,ur(e(B)),"svelte-10okixm")},[()=>e(te).length.toLocaleString()],le),de("click",ue,()=>{if(e(h)!==e(B)){$(h,e(B));return}$(h,Xt.map((K,b)=>b+ee).map(K=>K%Xt.length).map(K=>Xt[K]).filter(K=>K!==e(B)).find(K=>e(E)[K].find(L))??e(B))}),r(S,W)};y(Be,S=>{e(te).length&&S(w)})}u(()=>Te(R,`deck_editor_card_kind deckCardKind ${(e(B)===e(h)?"selected":"")??""} ${(e(te).length?"":"empty")??""} svelte-10okixm`)),r(k,R)}),r(d,ie),ft()}var Yi=o('<div class="svelte-rccxcp"> </div>'),Li=o('<div class="svelte-rccxcp"> </div>'),Ui=o('<div class="link_arrow_emoji svelte-rccxcp"> </div>'),Ni=o('<div class="duel_card_info_row svelte-rccxcp" style="position:sticky; top:0;"><!></div>'),Pi=o('<div class="duel_card_info_row svelte-rccxcp"><div class="svelte-rccxcp"><pre class="description svelte-rccxcp"> </pre></div></div> <div class="duel_card_info_row svelte-rccxcp" style=" justify-content: space-between;"><div class="svelte-rccxcp"> </div> <div class="svelte-rccxcp"> </div></div>',1),qi=o('<div></div> <div class="svelte-rccxcp"> </div>',1),Fi=o("<div> </div>"),Hi=o('<span class="svelte-rccxcp">/</span> <div class="monster_defense svelte-rccxcp"> </div>',1),Ii=o("<div> </div>"),Oi=o('<div class="duel_card_info_row svelte-rccxcp"><!> <!> <div style="flex-grow: 1;" class="svelte-rccxcp"></div> <div class="monster_attack svelte-rccxcp"> </div> <!></div> <div class="duel_card_info_row svelte-rccxcp"></div>',1),Ri=o('<div class="duel_card_row svelte-rccxcp"><div class="svelte-rccxcp"></div> <div class="svelte-rccxcp"> </div></div>'),Wi=o('<div class="duel_card_row svelte-rccxcp"><div class="svelte-rccxcp"></div> <div class="svelte-rccxcp"> </div></div>'),Ki=o('<div class="duel_card_info_row svelte-rccxcp"><div class="svelte-rccxcp">※エラッタ前カードです</div></div>'),zi=o('<div class="duel_card_info_row svelte-rccxcp"><div class="svelte-rccxcp">※テスト用カードです</div></div>'),Vi=o('<div class="duel_card_info_links svelte-rccxcp"><a target="_blank" rel="noopener noreferrer" title="コナミカードデータベース" class="svelte-rccxcp"> </a> <a target="_blank" rel="noopener noreferrer" title="遊戯王カードWiki" class="svelte-rccxcp">⇒遊戯王カードWiki</a> <a target="_blank" rel="noopener noreferrer" title="google" class="svelte-rccxcp">⇒google検索</a></div>'),Gi=o('<div><div class="duel_card_info_header svelte-rccxcp"><div class="duel_card_info_row svelte-rccxcp"><div class="svelte-rccxcp"> </div></div> <!></div> <div class="duel_card_info_body svelte-rccxcp"><!> <!> <div class="duel_card_info_row description svelte-rccxcp"><div class="svelte-rccxcp"><pre class="description svelte-rccxcp"> </pre></div></div> <!> <!></div></div>');function Xi(d,i){_t(i,!1);let t=Ae(i,"cardInfo",8,void 0),c=Ae(i,"onAttention",8);ut();var f=be(),v=N(f);{var p=l=>{var H=Gi(),V=a(H),h=a(V),T=a(h),X=a(T),F=s(h,2);{var re=w=>{var S=Ni(),W=a(S);{var ue=A=>{var j=Yi(),U=a(j);u(Q=>g(U,Q),[()=>"★".repeat(t().level)],le),r(A,j)},Se=A=>{var j=be(),U=N(j);{var Q=x=>{var z=Li(),Y=a(z);u(q=>g(Y,q),[()=>"★".repeat(t().rank)],le),r(x,z)},Z=x=>{var z=be(),Y=N(z);{var q=O=>{var K=Ui(),b=a(K);u(C=>g(b,C),[()=>t().linkArrowKeys.map(C=>za[C].emoji).join("")],le),r(O,K)};y(Y,O=>{t().linkArrowKeys&&O(q)},!0)}r(x,z)};y(U,x=>{t().rank&&t().rank>0?x(Q):x(Z,!1)},!0)}r(A,j)};y(W,A=>{t().level&&t().level>0?A(ue):A(Se,!1)})}r(w,S)};y(F,w=>{t().kind==="Monster"&&w(re)})}var E=s(V,2),n=a(E);{var P=w=>{var S=Pi(),W=N(S),ue=a(W),Se=a(ue),A=a(Se),j=s(W,2),U=a(j),Q=a(U),Z=s(U,2),x=a(Z);u(()=>{g(A,t().pendulumDescription),g(Q,`◀ ${t().pendulumScaleL??""}`),g(x,`${t().pendulumScaleR??""} ▶`)}),r(w,S)};y(n,w=>{var S;(S=t().monsterCategories)!=null&&S.includes("Pendulum")&&w(P)})}var _e=s(n,2);{var we=w=>{var S=Oi(),W=N(S),ue=a(W);{var Se=Y=>{var q=qi(),O=N(q),K=s(O,2),b=a(K);u(()=>{Te(O,`monster_attr ${t().attributes[0]??""} svelte-rccxcp`),g(b,`${ka[t().attributes[0]]??""}属性`)}),r(Y,q)};y(ue,Y=>{t().attributes&&Y(Se)})}var A=s(ue,2);{var j=Y=>{var q=Fi(),O=a(q);u(()=>{Te(q,`monster_cat ${t().types[0]??""} svelte-rccxcp`),g(O,`${_a[t().types[0]]??""}${Ca[t().types[0]]??""}族`)}),r(Y,q)};y(A,Y=>{t().types&&Y(j)})}var U=s(A,4),Q=a(U),Z=s(U,2);{var x=Y=>{var q=Hi(),O=s(N(q),2),K=a(O);u(()=>g(K,t().defense??"?")),r(Y,q)};y(Z,Y=>{var q;(q=t().monsterCategories)!=null&&q.includes("Link")||Y(x)})}var z=s(W,2);ce(z,5,()=>t().monsterCategories??[],fe,(Y,q)=>{var O=Ii(),K=a(O);u(()=>{Te(O,`monster_cat ${e(q)??""} svelte-rccxcp`),g(K,`${sa[e(q)]??""}${la[e(q)]??""}`)}),r(Y,O)}),u(()=>g(Q,t().attack??"?")),r(w,S)},ge=w=>{var S=be(),W=N(S);{var ue=A=>{var j=Ri(),U=s(a(j),2),Q=a(U);u(()=>g(Q,`${ua[t().spellCategory]??""}魔法`)),r(A,j)},Se=A=>{var j=be(),U=N(j);{var Q=Z=>{var x=Wi(),z=s(a(x),2),Y=a(z);u(()=>g(Y,`${fa[t().trapCategory]??""}罠`)),r(Z,x)};y(U,Z=>{t().kind==="Trap"&&t().trapCategory&&Z(Q)},!0)}r(A,j)};y(W,A=>{t().kind==="Spell"&&t().spellCategory?A(ue):A(Se,!1)},!0)}r(w,S)};y(_e,w=>{t().kind==="Monster"?w(we):w(ge,!1)})}var ke=s(_e,2),L=a(ke),ie=a(L),k=a(ie),B=s(ke,2);{var ee=w=>{var S=Ki();r(w,S)};y(B,w=>{t().isOldVersion&&w(ee)})}var R=s(B,2);{var te=w=>{var S=zi();r(w,S)},Be=w=>{var S=Vi(),W=a(S),ue=a(W),Se=s(W,2),A=s(Se,2);u(j=>{dt(W,"href",j),g(ue,`⇒${(t().cardId?"公式カードページ":"公式で検索")??""}`),dt(Se,"href",`https://yugioh-wiki.net/index.php?${t().wikiEncodedName}`),dt(A,"href",`https://www.google.com/search?q=遊戯王 ${t().name}`)},[()=>pr(t())],le),r(w,S)};y(R,w=>{t().isForTest?w(te):w(Be,!1)})}u(w=>{Te(H,`duel_card duel_card_info ${t().kind??""} ${w??""} svelte-rccxcp`),g(X,t().name),g(k,t().description)},[()=>{var w;return(w=t().monsterCategories)==null?void 0:w.join(" ")}],le),de("click",H,()=>c()(t())),r(l,H)};y(v,l=>{t()&&l(p)})}r(d,f),ft()}const Qi={0:{aaa:"日",aaaa:"日曜日",ddd:"Sun",dddd:"Sunday"},1:{aaa:"月",aaaa:"月曜日",ddd:"Mon",dddd:"Monday"},2:{aaa:"火",aaaa:"火曜日",ddd:"Tue",dddd:"Tuesday"},3:{aaa:"水",aaaa:"水曜日",ddd:"Wed",dddd:"Wednesday"},4:{aaa:"木",aaaa:"木曜日",ddd:"Thu",dddd:"Thursday"},5:{aaa:"金",aaaa:"金曜日",ddd:"Fri",dddd:"Friday"},6:{aaa:"土",aaaa:"土曜日",ddd:"Sat",dddd:"Saturday"}};class Ji{constructor(){rt(this,"DefaultSeparator1","/");rt(this,"DefaultSeparator2"," ");rt(this,"DefaultSeparator3",":");rt(this,"createDate",i=>{if(!i)return;const t=new Date(i);if(!isNaN(t.getTime()))return t});rt(this,"createDateOr",(i,t)=>this.createDate(i)||t||new Date);rt(this,"truncateDate",i=>{const t=i||new Date;return new Date(t.getFullYear(),t.getMonth(),t.getDate())});rt(this,"addDate",(i,t)=>{const c=this.createDateOr(i);return c.setDate(c.getDate()+t),c});rt(this,"addMonth",(i,t)=>{const c=this.createDateOr(i);return c.setMonth(c.getMonth()+t),c});rt(this,"addYear",(i,t)=>{const c=this.createDateOr(i);return c.setFullYear(c.getFullYear()+t),c});rt(this,"getDayOfWeek",(i,t="dddd")=>{const c=this.createDate(i);return c?Qi[c.getDay()][t]:""});rt(this,"formatToYYYYMMDD",(i,t=this.DefaultSeparator1)=>{const c=this.createDate(i);if(!c)return"";const f=c.getFullYear().toString(),v=("0"+(c.getMonth()+1)).slice(-2),p=("0"+c.getDate()).slice(-2);return f+t+v+t+p});rt(this,"formatToYYYYMM",(i,t=this.DefaultSeparator1)=>{const c=this.createDate(i);if(!c)return"";t||(t="");const f=c.getFullYear().toString(),v=("0"+(c.getMonth()+1)).slice(-2);return f+t+v});rt(this,"formatToHHMMSS",(i,t=this.DefaultSeparator3)=>{const c=this.createDate(i);if(!c)return"";t||(t="");const f=c.getHours(),v=c.getMinutes(),p=c.getSeconds();return("0"+f).slice(-2)+t+("0"+v).slice(-2)+t+("0"+p).slice(-2)});rt(this,"formatToHHMM",(i,t=this.DefaultSeparator3)=>{const c=this.createDate(i);if(!c)return"";t||(t="");const f=("0"+c.getHours()).slice(-2),v=("0"+c.getMinutes()).slice(-2);return f+t+v});rt(this,"formatToYYYYMMDD_HHMM",(i,t=this.DefaultSeparator1,c=this.DefaultSeparator2,f=this.DefaultSeparator3)=>{const v=this.createDate(i);return v?this.formatToYYYYMMDD(v,t)+c+this.formatToHHMM(v,f):""});rt(this,"formatToYYYYMMDD_HHMMSS",(i,t=this.DefaultSeparator1,c=this.DefaultSeparator2,f=this.DefaultSeparator3)=>{const v=this.createDate(i);return v?this.formatToYYYYMMDD(v,t)+c+this.formatToHHMMSS(v,f):""})}}const bt=new Ji;Date.prototype.truncateDate=function(){return bt.truncateDate(this)};Date.prototype.getCloneOr=function(d){return bt.createDateOr(this,d)};Date.prototype.addDate=function(d){return bt.addDate(this,d)};Date.prototype.addMonth=function(d){return bt.addDate(this,d)};Date.prototype.addYear=function(d){return bt.addDate(this,d)};Date.prototype.getDayOfWeek=function(d="dddd"){return bt.getDayOfWeek(this,d)};Date.prototype.formatToYYYYMM=function(d){return bt.formatToYYYYMM(this,d)};Date.prototype.formatToYYYYMMDD=function(d){return bt.formatToYYYYMMDD(this,d)};Date.prototype.formatToYYYYMMDD_HHMM=function(d,i,t){return bt.formatToYYYYMMDD_HHMM(this,d,i,t)};Date.prototype.formatToYYYYMMDD_HHMMSS=function(d,i,t){return bt.formatToYYYYMMDD_HHMMSS(this,d,i,t)};Date.prototype.formatToHHMM=function(d){return bt.formatToHHMM(this,d)};Date.prototype.formatToHHMMSS=function(d){return bt.formatToHHMMSS(this,d)};var Zi=o('<li class="deck_info_list_item svelte-2wdgc8"><div class="svelte-2wdgc8"> </div> <div class="svelte-2wdgc8"> </div> <div class="svelte-2wdgc8"> </div></li>'),en=o('<ul class="deck_info_list svelte-2wdgc8"></ul>'),tn=o('<label for="file_selector" class="upload_area svelte-2wdgc8" role="region" aria-label="ファイルアップロードエリア"><div class="upload_area_message svelte-2wdgc8">ここにファイルをドロップ</div> <div class="upload_area_footer svelte-2wdgc8"><input type="file" id="file_selector" name="file_selector" accept=".json" multiple></div></label>'),an=o('<div slot="body" class="modal_body svelte-2wdgc8"><!></div>'),rn=o('<button class="svelte-2wdgc8">追加</button> <button class="svelte-2wdgc8">削除して追加</button> <button class="svelte-2wdgc8">戻る</button>',1),sn=o('<button class="svelte-2wdgc8">Cancel</button>'),nn=o('<div slot="footer" class="modal_window_footer svelte-2wdgc8"><!></div>');function on(d,i){_t(i,!1);let t=Ae(i,"eventHolder",8),c=Ae(i,"args",8),f=Ae(i,"resolve",8),v=pe(Promise.resolve([])),p=pe();const l=()=>{$(p,new DataTransfer().files),$(v,Promise.resolve([]))},H=async F=>{F.preventDefault(),console.log("hoge",F)},V=async F=>{F.preventDefault(),F.dataTransfer&&T(F.dataTransfer.files)},h=()=>{T(e(p))},T=async F=>{if(!F.length)return;const re=[],E=[];for(const n of F)try{E.push(...await Ct.createfromJson(n))}catch(P){P instanceof Error&&re.push(P.message)}if(re.length){console.log(...re);return}$(v,e(v).then(()=>E))},X=l;ut(),gr(d,{get eventHolder(){return t()},get args(){return c()},$$slots:{body:(F,re)=>{var E=an(),n=a(E);yt(n,()=>ra,null,(P,_e)=>{var we=be(),ge=N(we);yt(ge,()=>e(v),null,(ke,L)=>{var ie=be(),k=N(ie);{var B=R=>{var te=en();ce(te,5,()=>e(L),fe,(Be,w)=>{var S=Zi(),W=a(S),ue=a(W),Se=s(W,2),A=a(Se),j=s(Se,2),U=a(j);u((Q,Z,x)=>{g(ue,e(w).name),g(A,`${Q??""}
                  /
                  ${Z??""}`),g(U,`最終使用日時 ： ${x??""}`)},[()=>e(w).cardNames.filter(Q=>{var Z,x;return!((x=(Z=e(_e).getCardInfo(Q))==null?void 0:Z.monsterCategories)!=null&&x.union(Qt).length)}).length,()=>e(w).cardNames.filter(Q=>{var Z,x;return(x=(Z=e(_e).getCardInfo(Q))==null?void 0:Z.monsterCategories)==null?void 0:x.union(Qt).length}).length,()=>e(w).lastUsedAt.formatToYYYYMMDD_HHMM("/"," ",":")],le),r(Be,S)}),r(R,te)},ee=R=>{var te=tn(),Be=s(a(te),2),w=a(Be);mr(w,()=>e(p),S=>$(p,S)),de("change",w,h),de("cancel",w,X),de("drop",te,V),de("dragover",te,H),r(R,te)};y(k,R=>{e(L).length?R(B):R(ee,!1)})}r(ke,ie)}),r(P,we)}),r(F,E)},footer:(F,re)=>{var E=nn(),n=a(E);yt(n,()=>e(v),null,(P,_e)=>{var we=be(),ge=N(we);{var ke=ie=>{var k=rn(),B=N(k),ee=s(B,2),R=s(ee,2);u(()=>{B.disabled=e(_e).length===0,ee.disabled=e(_e).length===0}),de("click",B,()=>f()({deckInfos:e(_e),replaceAll:!1})),de("click",ee,()=>f()({deckInfos:e(_e),replaceAll:!0})),de("click",R,X),r(ie,k)},L=ie=>{var k=be(),B=N(k);{var ee=R=>{var te=sn();de("click",te,()=>f()(void 0)),r(R,te)};y(B,R=>{c().cancelable&&R(ee)},!0)}r(ie,k)};y(ge,ie=>{e(_e).length?ie(ke):ie(L,!1)})}r(P,we)}),r(F,E)}}}),ft()}const ca=class ca extends hr{constructor(i,t){super(i,...Object.values(t))}};rt(ca,"createModalController",i=>{const t={deckUploader:new xr({title:"デッキ情報をアップロード",position:"Middle",cancelable:!1})};return Object.assign(new ca(i,t),t)});let wa=ca;function ln(d,i){_t(i,!1);let t=Ae(i,"modalController",8);ut(),yr(d,{get modalController(){return t()},children:(c,f)=>{var v=be(),p=N(v);{var l=H=>{on(H,{get eventHolder(){return t().eventHolder},get args(){return t().deckUploader.args},get resolve(){return t().deckUploader.resolve}})};y(p,H=>{t().deckUploader.state==="Shown"&&H(l)})}r(c,v)},$$slots:{default:!0}}),ft()}var vn=o("<button> </button>"),dn=o('<label class="svelte-18w87gx"><input type="checkbox" class="search_condition svelte-18w87gx"> </label>'),cn=o('<label class="svelte-18w87gx"><input type="checkbox" class="search_condition svelte-18w87gx"> </label>'),_n=o('<div class="deck_editor_search_box_row monster_ex_categories svelte-18w87gx"><div class="svelte-18w87gx"><button class="search_condition_title black_button svelte-18w87gx">エクストラ</button></div> <div class="svelte-18w87gx"></div></div>'),un=o('<label class="svelte-18w87gx"><input type="checkbox" class="search_condition svelte-18w87gx"> </label>'),fn=o('<label class="svelte-18w87gx"><input type="checkbox" class="search_condition svelte-18w87gx"> <div style="display: inline-block;"></div> </label>'),pn=o('<label class="svelte-18w87gx"><input type="checkbox" class="search_condition svelte-18w87gx"> </label>'),gn=o('<div class="deck_editor_search_box_row monster_categories svelte-18w87gx"><div class="svelte-18w87gx"><button class="search_condition_title black_button svelte-18w87gx">モンスター</button></div> <div class="svelte-18w87gx"></div></div> <div class="deck_editor_search_box_row monster_attributes svelte-18w87gx"><div class="svelte-18w87gx"><button class="search_condition_title black_button svelte-18w87gx">属性</button></div> <div class="svelte-18w87gx"></div></div> <div class="deck_editor_search_box_row svelte-18w87gx"><div class="svelte-18w87gx"><button class="search_condition_title black_button svelte-18w87gx">種族</button></div> <div class="svelte-18w87gx"></div></div> <div class="deck_editor_search_box_row svelte-18w87gx"><div class="svelte-18w87gx"><button class="search_condition_title black_button svelte-18w87gx">星攻守</button></div> <div class="svelte-18w87gx"><div class="star_range svelte-18w87gx"><span class="svelte-18w87gx">星</span> <input type="number" min="0" max="13" class="svelte-18w87gx"> <span class="svelte-18w87gx">～</span> <input type="number" min="0" max="13" class="svelte-18w87gx"></div> <div class="atk_range svelte-18w87gx"><span class="svelte-18w87gx">攻</span> <input type="number" min="0" max="5000" step="100" class="svelte-18w87gx"> <span class="svelte-18w87gx">～</span> <input type="number" min="0" max="5000" step="100" class="svelte-18w87gx"></div> <div class="def_range svelte-18w87gx"><span class="svelte-18w87gx">守</span> <input type="number" min="0" max="5000" step="100" class="svelte-18w87gx"> <span class="svelte-18w87gx">～</span> <input type="number" min="0" max="5000" step="100" class="svelte-18w87gx"></div> <div class="atk_plus_def svelte-18w87gx"><span class="svelte-18w87gx">攻+守</span> <input type="number" min="0" max="10000" step="100" class="svelte-18w87gx"></div></div></div>',1),mn=o('<label class="svelte-18w87gx"><input type="checkbox" class="search_condition svelte-18w87gx"> </label>'),yn=o('<div class="deck_editor_search_box_row svelte-18w87gx"><div class="svelte-18w87gx"><button class="search_condition_title black_button svelte-18w87gx">魔法</button></div> <div class="svelte-18w87gx"></div></div>'),hn=o('<label class="svelte-18w87gx"><input type="checkbox" class="search_condition svelte-18w87gx"> </label>'),xn=o('<div class="deck_editor_search_box_row svelte-18w87gx"><div class="svelte-18w87gx"><button class="search_condition_title black_button svelte-18w87gx">罠</button></div> <div class="svelte-18w87gx"></div></div>'),bn=o('<label class="svelte-18w87gx"><input type="checkbox" class="search_condition svelte-18w87gx"> </label>'),wn=o("<div>カード情報読込中</div>"),kn=o("<option> </option>"),Cn=o('<div class="svelte-18w87gx"><a class="white_button svelte-18w87gx" download="SVS_DeckInfos.json">ダウンロード</a></div>'),Dn=o('<div class="svelte-18w87gx"></div>'),$n=o('<div class="svelte-18w87gx"><a class="white_button svelte-18w87gx" download="SVS_DeckInfos.json">ダウンロード(一括)</a></div>'),Sn=o('<div class="svelte-18w87gx"></div>'),Mn=o('<div class="deck_editor_body_right_header svelte-18w87gx"><div class="deck_editor_body_right_header_row svelte-18w87gx"><div class="svelte-18w87gx">編集対象</div> <div class="svelte-18w87gx"><select style="width:100%" class="svelte-18w87gx"></select></div></div> <div class="deck_editor_body_right_header_row svelte-18w87gx"><div class="svelte-18w87gx">新規名称</div> <div class="svelte-18w87gx"><input type="text" style="width:100%" class="svelte-18w87gx"></div></div> <div class="deck_editor_body_right_header_row svelte-18w87gx"></div> <div class="deck_editor_body_right_header_row svelte-18w87gx"><div class="svelte-18w87gx">基本操作</div> <div class="svelte-18w87gx"><button class="white_button svelte-18w87gx">デッキを保存</button></div> <div class="svelte-18w87gx"><button class="white_button svelte-18w87gx">デッキを複製</button></div> <div class="svelte-18w87gx"><button class="white_button svelte-18w87gx" title="shiftキー押下で確認メッセージスキップ">デッキを削除</button></div></div> <div class="deck_editor_body_right_header_row svelte-18w87gx"><div class="svelte-18w87gx">DL/UL</div> <!> <!> <div class="svelte-18w87gx"><button class="white_button svelte-18w87gx">アップロード</button></div></div></div> <!>',1),Tn=o('<div class="svelte-18w87gx">デッキ情報読込中</div>'),jn=o('<div class="svelte-18w87gx"></div>'),En=o("<div><!></div>"),Bn=o('<div><div class="deck_editor_header svelte-18w87gx"></div> <div class="deck_editor_body svelte-18w87gx"><div class="deck_editor_body_left svelte-18w87gx"><div role="contentinfo" class="deck_editor_search_box svelte-18w87gx"><div class="deck_editor_search_box_header svelte-18w87gx"><div class="svelte-18w87gx"><button class="deck_editor_search_box_title svelte-18w87gx">検索条件</button></div> <div class="deck_editor_sort_setting_container svelte-18w87gx"></div></div> <div class="deck_editor_search_box_body svelte-18w87gx"><div class="deck_editor_search_box_row svelte-18w87gx"><div class="svelte-18w87gx"><button class="search_condition_title black_button svelte-18w87gx">名称</button></div> <div class="svelte-18w87gx"><input type="text" style="width:100%" placeholder="※ルビには対応していません" class="svelte-18w87gx"></div></div> <div class="deck_editor_search_box_row card_kind svelte-18w87gx"><div class="svelte-18w87gx"><button class="search_condition_title black_button svelte-18w87gx">種類</button></div> <div class="svelte-18w87gx"></div></div> <!> <!> <!> <!> <div class="deck_editor_search_box_row svelte-18w87gx"><div class="svelte-18w87gx"><button class="search_condition_title black_button svelte-18w87gx">その他</button></div> <div class="svelte-18w87gx"></div></div></div></div> <div class="deck_editor_card_detail svelte-18w87gx"><!></div></div> <div class="deck_editor_body_center svelte-18w87gx"><!></div>  <div class="deck_editor_body_right svelte-18w87gx"><!></div></div> <div class="footer svelte-18w87gx"></div></div> <!> <!>',1);function An(d,i){_t(i,!1);const t=[],c=[],f=[],v=[],p=[],l=[],H=[],V=[];let h=pe();const T=(M,D)=>{$(h,{cardInfo:M,pos:D,startPos:D})},X=(M,D)=>{var ve;$(h,{cardInfo:M,pos:D,startPos:((ve=e(h))==null?void 0:ve.startPos)??D})},F=()=>{$(h,void 0)},re=wa.createModalController({onDragStart:{append:()=>{},remove:()=>{}},onDragEnd:{append:()=>{},remove:()=>{}}}),E={name:"",deckCardKinds:[...Xt],exMonsterCategories:[...Qt],monsterCategories:Ua.filter(M=>!Qt.includes(M)),monsterAttributes:[...La],monsterTypes:[...Ya],spellCategories:Aa.filter(M=>M!=="PendulumScale"),trapCategories:[...Ba],starLowerBound:0,starUpperBound:13,atkLowerBound:0,atkUpperBound:5e3,defLowerBound:0,defUpperBound:5e3,atkPlusDef:void 0,others:["test","oldVersion","implemented"],sort:[...Na]},n=pe(structuredClone(E));xe(n,e(n).others=["oldVersion"]),xe(n,e(n).monsterCategories=e(n).monsterCategories.filter(M=>M!=="Normal"));let P=pe("DeckEdit"),_e=pe("SearchCondition");const we=()=>{if(!e(n).deckCardKinds.length){Rt(e(n)).forEach(M=>{Array.isArray(e(n)[M])&&Array.isArray(E[M])?xe(n,e(n)[M]=[...E[M]]):xe(n,e(n)[M]=E[M])});return}xe(n,e(n).name=""),xe(n,e(n).deckCardKinds=[]),xe(n,e(n).exMonsterCategories=[]),xe(n,e(n).monsterCategories=[]),xe(n,e(n).monsterAttributes=[]),xe(n,e(n).monsterTypes=[]),xe(n,e(n).spellCategories=[]),xe(n,e(n).trapCategories=[]),xe(n,e(n).others=[]),xe(n,e(n).atkLowerBound=0),xe(n,e(n).atkUpperBound=5e3),xe(n,e(n).defLowerBound=0),xe(n,e(n).defUpperBound=5e3),xe(n,e(n).atkPlusDef=void 0),xe(n,e(n).sort=[...Na])},ge=M=>{M.forEach(D=>{Array.isArray(e(n)[D])&&Array.isArray(E[D])?xe(n,e(n)[D]=e(n)[D].length?[]:[...E[D]]):xe(n,e(n)[D]=E[D])})},ke=(M,D,ve)=>{Array.isArray(e(n)[D])&&Array.isArray(E[D])&&xe(n,e(n)[D]=[ve])},L=async()=>{const D=(await e(B)).find($e=>$e.id===e(k));if(!D)return;const ve=await ra;$(te,{...D,cardTree:wr(D.cardNames.map($e=>{const We=ve.getCardInfo($e);return We===void 0&&console.error($e),We}).filter($e=>$e!==void 0))})},ie=()=>Ct.getAllDeckInfo().then(M=>($(k,(M.find(D=>D.lastUsedAt.getTime()===Math.max(...M.map(ve=>ve.lastUsedAt.getTime())))??M[0]).id),M));let k=pe(-1),B=pe(ie()),ee=pe(e(B).then(M=>Ct.convertToObjectURL(M)));e(B).then(L);const R=()=>{$(B,ie()),$(ee,e(B).then(M=>Ct.convertToObjectURL(M))),L()};let te=pe({id:-Number.MAX_VALUE,name:"",description:"",lastUsedAt:new Date,cardTree:{ExtraMonster:[],Monster:[],Spell:[],Trap:[]}}),Be=pe(void 0),w=0;const S=M=>{$(_e,"CardDetail"),M.cardId!==void 0&&!M.description&&!M.pendulumDescription&&(w=M.cardId,ya([M.cardId]).then(()=>{M.cardId===w&&$(Be,M)})),$(Be,M)},W=async()=>{const D=(await e(B)).find(ve=>ve.id===e(k));if(!D)throw new Error("illegal state");return D},ue=async()=>{const M=await W();await M.saveDeckInfo({...M,name:e(te).name,cardNames:Object.values(e(te).cardTree).flatMap(D=>D).map(D=>D.name),lastUsedAt:new Date}),R()},Se=async()=>{(await Ct.createNewDeck(`デッキ_${new Date().formatToYYYYMMDD_HHMMSS("","","")}`,`コピー日時：${new Date().formatToYYYYMMDD_HHMMSS("-"," ",":")}`,Object.values(e(te).cardTree).flatMap(D=>D).map(D=>D.name))).saveDeckInfo(),R()},A=async M=>{const D=await W();!M.shiftKey&&!confirm(`デッキ【${D.name}】を削除します。
よろしいですか？`)||(await D.delete(),R())},j=async()=>{const M=await re.deckUploader.show({title:"デッキ情報アップロード",position:"Middle",cancelable:!0});if(!M)return;const D=[];if(M.replaceAll){if(!confirm(`既存デッキ情報を全て削除し、アップロードしたファイルに置き換えます。
よろしいですか？`))return;D.push(...(await e(B)).map(ve=>ve.id))}await Promise.all(M.deckInfos.map(ve=>Ct.createNewDeck(ve.name,ve.description,ve.cardNames,ve.lastUsedAt))),D.length&&await Promise.all(D.map(Ct.remove)),R()},U=()=>innerWidth<=1400?"compact":"wide";ut();var Q=Bn(),Z=N(Q),x=s(a(Z),2),z=a(x),Y=a(z),q=a(Y),O=a(q),K=a(O),b=s(O,2);ce(b,5,()=>e(n).sort,fe,(M,D,ve)=>{var $e=vn(),We=a($e);u(()=>{Te($e,`deck_editor_sort_setting_item ${e(D).order??""} priority_${e(D).priority??""} svelte-18w87gx`),g(We,`${br[e(D).key]??""}
                ${(e(D).order==="asc"?"▲":"▼")??""}`)}),de("click",$e,()=>{e(n).sort.forEach(Xe=>Xe.priority++),e(D).order=e(D).order==="asc"?"desc":"asc",Ft(()=>e(n).sort),e(D).priority=1,Ft(()=>e(n).sort)}),r(M,$e)});var C=s(q,2),_=a(C),m=a(_),I=a(m),J=s(m,2),Ce=a(J),me=s(_,2),oe=a(me),se=a(oe),G=s(oe,2);ce(G,5,()=>Xt,fe,(M,D)=>{var ve=dn(),$e=a(ve),We,Xe=s($e);u(()=>{We!==(We=e(D))&&($e.value=($e.__value=e(D))==null?"":e(D)),g(Xe,` ${Va[e(D)]??""}`)}),qt(t,[],$e,()=>(e(D),e(n).deckCardKinds),Ye=>xe(n,e(n).deckCardKinds=Ye)),r(M,ve)});var ae=s(me,2);{var De=M=>{var D=_n(),ve=a(D),$e=a(ve),We=s(ve,2);ce(We,5,()=>Qt,fe,(Xe,Ye)=>{var tt=cn(),Qe=a(tt),Pe,qe=s(Qe);u(()=>{Pe!==(Pe=e(Ye))&&(Qe.value=(Qe.__value=e(Ye))==null?"":e(Ye)),g(qe,` ${sa[e(Ye)]??""}${la[e(Ye)]??""}`)}),qt(c,[],Qe,()=>(e(Ye),e(n).exMonsterCategories),Ve=>xe(n,e(n).exMonsterCategories=Ve)),r(Xe,tt)}),de("click",$e,()=>ge(["exMonsterCategories"])),ne(3,D,()=>he,()=>({delay:0,duration:100})),r(M,D)};y(ae,M=>{e(n).deckCardKinds.includes("ExtraMonster")&&M(De)})}var Oe=s(ae,2);{var He=M=>{var D=gn(),ve=N(D),$e=a(ve),We=a($e),Xe=s($e,2);ce(Xe,5,()=>Ua.filter(Me=>!Qt.includes(Me)),fe,(Me,Ne)=>{var vt=un(),it=a(vt),kt,St=s(it);u(()=>{kt!==(kt=e(Ne))&&(it.value=(it.__value=e(Ne))==null?"":e(Ne)),g(St,` ${sa[e(Ne)]??""}${la[e(Ne)]??""}`)}),qt(f,[],it,()=>(e(Ne),e(n).monsterCategories),At=>xe(n,e(n).monsterCategories=At)),r(Me,vt)});var Ye=s(ve,2),tt=a(Ye),Qe=a(tt),Pe=s(tt,2);ce(Pe,5,()=>La,fe,(Me,Ne)=>{var vt=fn(),it=a(vt),kt,St=s(it,2),At=s(St);u(()=>{kt!==(kt=e(Ne))&&(it.value=(it.__value=e(Ne))==null?"":e(Ne)),Te(St,`monster_attr ${e(Ne)??""} svelte-18w87gx`),g(At,` ${ka[e(Ne)]??""}`)}),qt(v,[],it,()=>(e(Ne),e(n).monsterAttributes),ea=>xe(n,e(n).monsterAttributes=ea)),r(Me,vt)});var qe=s(Ye,2),Ve=a(qe),at=a(Ve),lt=s(Ve,2);ce(lt,5,()=>Ya,fe,(Me,Ne)=>{var vt=pn(),it=a(vt),kt,St=s(it);u(()=>{kt!==(kt=e(Ne))&&(it.value=(it.__value=e(Ne))==null?"":e(Ne)),g(St,` ${_a[e(Ne)]??""}
                    ${Ca[e(Ne)]??""}`)}),qt(p,[],it,()=>(e(Ne),e(n).monsterTypes),At=>xe(n,e(n).monsterTypes=At)),de("dblclick",vt,At=>ke(At,"monsterTypes",e(Ne))),r(Me,vt)});var pt=s(qe,2),ct=a(pt),wt=a(ct),Nt=s(ct,2),jt=a(Nt),$t=s(a(jt),2),Et=s($t,4),ht=s(jt,2),gt=s(a(ht),2),Pt=s(gt,4),Bt=s(ht,2),Ht=s(a(Bt),2),Je=s(Ht,4),Ke=s(Bt,2),Fe=s(a(Ke),2);de("click",We,()=>ge(["monsterCategories"])),ne(3,ve,()=>he,()=>({delay:0,duration:100})),de("click",Qe,()=>ge(["monsterAttributes"])),ne(3,Ye,()=>he,()=>({delay:0,duration:100})),de("click",at,()=>ge(["monsterTypes"])),ne(3,qe,()=>he,()=>({delay:0,duration:100})),de("click",wt,()=>ge(["starLowerBound","starUpperBound","atkLowerBound","atkUpperBound","defLowerBound","defUpperBound","atkPlusDef"])),Mt($t,()=>e(n).starLowerBound,Me=>xe(n,e(n).starLowerBound=Me)),Mt(Et,()=>e(n).starUpperBound,Me=>xe(n,e(n).starUpperBound=Me)),Mt(gt,()=>e(n).atkLowerBound,Me=>xe(n,e(n).atkLowerBound=Me)),Mt(Pt,()=>e(n).atkUpperBound,Me=>xe(n,e(n).atkUpperBound=Me)),Mt(Ht,()=>e(n).defLowerBound,Me=>xe(n,e(n).defLowerBound=Me)),Mt(Je,()=>e(n).defUpperBound,Me=>xe(n,e(n).defUpperBound=Me)),Mt(Fe,()=>e(n).atkPlusDef,Me=>xe(n,e(n).atkPlusDef=Me)),ne(3,pt,()=>he,()=>({delay:0,duration:100})),r(M,D)};y(Oe,M=>{(e(n).deckCardKinds.includes("Monster")||e(n).deckCardKinds.includes("ExtraMonster"))&&M(He)})}var Ie=s(Oe,2);{var Le=M=>{var D=yn(),ve=a(D),$e=a(ve),We=s(ve,2);ce(We,5,()=>Aa.filter(Xe=>Xe!=="PendulumScale"),fe,(Xe,Ye)=>{var tt=mn(),Qe=a(tt),Pe,qe=s(Qe);u(()=>{Pe!==(Pe=e(Ye))&&(Qe.value=(Qe.__value=e(Ye))==null?"":e(Ye)),g(qe,` ${ua[e(Ye)]??""}`)}),qt(l,[],Qe,()=>(e(Ye),e(n).spellCategories),Ve=>xe(n,e(n).spellCategories=Ve)),r(Xe,tt)}),de("click",$e,()=>ge(["spellCategories"])),ne(3,D,()=>he,()=>({delay:0,duration:100})),r(M,D)};y(Ie,M=>{e(n).deckCardKinds.includes("Spell")&&M(Le)})}var Ge=s(Ie,2);{var nt=M=>{var D=xn(),ve=a(D),$e=a(ve),We=s(ve,2);ce(We,5,()=>Ba,fe,(Xe,Ye)=>{var tt=hn(),Qe=a(tt),Pe,qe=s(Qe);u(()=>{Pe!==(Pe=e(Ye))&&(Qe.value=(Qe.__value=e(Ye))==null?"":e(Ye)),g(qe,` ${fa[e(Ye)]??""}`)}),qt(H,[],Qe,()=>(e(Ye),e(n).trapCategories),Ve=>xe(n,e(n).trapCategories=Ve)),r(Xe,tt)}),de("click",$e,()=>ge(["trapCategories"])),ne(3,D,()=>he,()=>({delay:0,duration:100})),r(M,D)};y(Ge,M=>{e(n).deckCardKinds.includes("Trap")&&M(nt)})}var Ee=s(Ge,2),ye=a(Ee),je=a(ye),Ue=s(ye,2);ce(Ue,4,()=>[{key:"test",text:"テスト用カード"},{key:"oldVersion",text:"エラッタ前カード"},{key:"implemented",text:"未実装カード"}],fe,(M,D)=>{var ve=bn(),$e=a(ve),We,Xe=s($e);u(()=>{We!==(We=D.key)&&($e.value=($e.__value=D.key)==null?"":D.key),g(Xe,` ${D.text??""}`)}),qt(V,[],$e,()=>(D.key,e(n).others),Ye=>xe(n,e(n).others=Ye)),r(M,ve)});var Re=s(Y,2),st=a(Re);Xi(st,{get cardInfo(){return e(Be)},onAttention:S});var ze=s(z,2),et=a(ze);yt(et,()=>ra,M=>{var D=wn();r(M,D)},(M,D)=>{Ra(M,{mode:"List",get allCardTree(){return e(D).tree},onAttention:S,get searchCondition(){return e(n)},onCardDragStart:T,onCardDragging:X,onCardDragEnd:F,get deckCardTree(){return e(te).cardTree},set deckCardTree(ve){xe(te,e(te).cardTree=ve)},$$legacy:!0})});var xt=s(ze,2),ot=a(xt);{var Dt=M=>{var D=be(),ve=N(D);yt(ve,()=>e(B),$e=>{var We=Tn();r($e,We)},($e,We)=>{var Xe=Mn(),Ye=N(Xe),tt=a(Ye),Qe=s(a(tt),2),Pe=a(Qe);u(()=>{e(k),Ft(()=>{e(We)})}),ce(Pe,5,()=>e(We),fe,(Je,Ke)=>{var Fe=kn(),Me={},Ne=a(Fe);u(()=>{Me!==(Me=e(Ke).id)&&(Fe.value=(Fe.__value=e(Ke).id)==null?"":e(Ke).id),g(Ne,e(Ke).name)}),r(Je,Fe)});var qe=s(tt,2),Ve=s(a(qe),2),at=a(Ve),lt=s(qe,4),pt=s(a(lt),2),ct=a(pt),wt=s(pt,2),Nt=a(wt),jt=s(wt,2),$t=a(jt),Et=s(lt,2),ht=s(a(Et),2);yt(ht,W,Je=>{var Ke=Dn();r(Je,Ke)},(Je,Ke)=>{var Fe=Cn(),Me=a(Fe);u(Ne=>dt(Me,"href",Ne),[()=>Ct.convertToObjectURL([e(Ke)])],le),r(Je,Fe)});var gt=s(ht,2);yt(gt,()=>e(ee),Je=>{var Ke=Sn();r(Je,Ke)},(Je,Ke)=>{var Fe=$n(),Me=a(Fe);u(()=>dt(Me,"href",e(Ke))),r(Je,Fe)});var Pt=s(gt,2),Bt=a(Pt),Ht=s(Ye,2);Ra(Ht,{mode:"Deck",allCardTree:{ExtraMonster:[],Monster:[],Spell:[],Trap:[]},onAttention:S,onCardDragStart:T,onCardDragging:X,onCardDragEnd:F,get deckCardTree(){return e(te).cardTree},set deckCardTree(Je){xe(te,e(te).cardTree=Je)},$$legacy:!0}),Vt(Pe,()=>e(k),Je=>$(k,Je)),de("change",Pe,L),Mt(at,()=>e(te).name,Je=>xe(te,e(te).name=Je)),de("click",ct,ue),de("click",Nt,Se),de("click",$t,A),de("click",Bt,j),r($e,Xe)}),r(M,D)},Ut=M=>{var D=jn();r(M,D)};y(ot,M=>{e(P)==="DeckEdit"||U()==="wide"?M(Dt):M(Ut,!1)})}var Tt=s(Z,2);{var Zt=M=>{var D=En(),ve=a(D);Ga(ve,{get cardInfo(){return e(h).cardInfo},onAttention:S,onCardDragStart:T,onCardDragging:X,onCardDragEnd:F}),u(()=>dt(D,"style",`position: fixed;top:${e(h).pos.y??""}px;left:${e(h).pos.x??""}px;filter: opacity(0.5);	transform: translateX(-50%) translateY(-50%);`)),r(M,D)};y(Tt,M=>{e(h)&&M(Zt)})}var Kt=s(Tt,2);ln(Kt,{modalController:re}),u((M,D,ve)=>Te(Z,`deck_editor screen_size_${M??""} left_pain_mode_${D??""} main_view_mode_${ve??""} svelte-18w87gx`),[U,()=>e(_e).toLowerCase(),()=>e(P).toLowerCase()],le),de("click",K,we),de("click",I,()=>ge(["name"])),Mt(Ce,()=>e(n).name,M=>xe(n,e(n).name=M)),de("click",se,()=>ge(["deckCardKinds"])),de("click",je,()=>ge(["others"])),ne(3,Ee,()=>he,()=>({delay:0,duration:100})),de("focusin",Y,()=>{$(_e,"SearchCondition"),$(P,"SearchCondition")}),de("click",Y,()=>{$(_e,"SearchCondition"),$(P,"SearchCondition")}),de("click",xt,()=>{$(P,"DeckEdit")}),de("focusin",xt,()=>{$(P,"DeckEdit")}),r(d,Q),ft()}const Yn=["TblDeckHeader","TblDeckDetail","TblDuelistProfile"],Ln=3;var Un=o('<input class="game_mode_radio svelte-sy4ydn" type="radio" name="game_mode"> <label> </label>',1),Nn=o('<option class="svelte-sy4ydn"> </option>'),Pn=o('<option class="svelte-sy4ydn"> </option>'),qn=o('<option class="svelte-sy4ydn"> </option>'),Fn=o('<tr class="config_row svelte-sy4ydn"><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><label for="npc_deck_selector" class="config_row_label deck_selector svelte-sy4ydn">デッキ：</label></div></td><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><select id="npc_deck_selector" class="deck_selector svelte-sy4ydn"><option class="svelte-sy4ydn">デフォルト</option><!></select></div></td></tr>'),Hn=o('<option class="svelte-sy4ydn"> </option>'),In=o('<tr class="config_row svelte-sy4ydn"><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><label for="npc_selector" class="config_row_label npc_selector svelte-sy4ydn">対戦相手：</label></div></td><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><select id="npc_selector" class="npc_selector svelte-sy4ydn"></select> <div class="svelte-sy4ydn"> </div></div></td></tr> <!> <tr class="config_row svelte-sy4ydn"><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><label for="npc_selector" class="config_row_label npc_selector svelte-sy4ydn">先攻後攻：</label></div></td><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><select id="npc_selector" class="npc_selector svelte-sy4ydn"></select></div></td></tr>',1),On=o('<option class="svelte-sy4ydn"> </option>'),Rn=o('<tr class="config_row svelte-sy4ydn"><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><label for="difficulty_selector" class="config_row_label difficulty_selector svelte-sy4ydn">難易度：</label></div></td><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><select id="difficulty_selector" class="difficulty_selector svelte-sy4ydn"></select></div></td></tr>'),Wn=o('<tr class="config_row svelte-sy4ydn"><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><label class="config_row_label svelte-sy4ydn" for="game_mode_radio_preset">ゲームモード：</label></div></td><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"></div></td></tr> <tr class="config_row svelte-sy4ydn"><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><label for="deck_selector" class="config_row_label deck_selector svelte-sy4ydn">デッキ：</label></div></td><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><select id="deck_selector" class="deck_selector svelte-sy4ydn"></select></div></td></tr> <!> <tr><td colspan="2" class="svelte-sy4ydn"><div><button class="btn svelte-sy4ydn">duel start!</button></div></td></tr>',1),Kn=o('<tr><td colspan="2" class="svelte-sy4ydn"><div>デッキ情報の読み込み、もしくは作成中...</div></td></tr>'),zn=o('<tr><td colspan="2" class="svelte-sy4ydn"><div><button class="btn svelte-sy4ydn">deck edit</button></div></td></tr>'),Vn=o('<tr class="config_row svelte-sy4ydn"><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><label for="duelist_name" class="config_row_label duelist_name svelte-sy4ydn">名前：</label></div></td><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><input id="duelist_name" class="duelist_name svelte-sy4ydn" type="text"></div></td></tr> <!> <!>',1),Gn=o('<tr><td colspan="2" class="svelte-sy4ydn"><div>デュエリスト情報の読み込み、もしくは作成中...</div></td></tr>'),Xn=o('<div class="app_body svelte-sy4ydn"><table class="config_table svelte-sy4ydn"><tbody><!></tbody></table></div>'),Qn=o('<span class="svelte-sy4ydn"> </span> <span class="svelte-sy4ydn"> </span>',1),Jn=o('<div class="result_title result_win svelte-sy4ydn">YOU WIN</div>'),Zn=o('<div class="result_title result_lose svelte-sy4ydn">YOU LOSE</div>'),eo=o('<div class="result_title result_draw svelte-sy4ydn">DRAW</div>'),to=o('<div class="twitter_share_button_wrapper svelte-sy4ydn"><a rel="nofollow" target="_blank" class="twitter_share_button svelte-sy4ydn">X(twitter)でシェアする</a></div>'),ao=o('<div class="result svelte-sy4ydn"><!> <div class="reason_of_end svelte-sy4ydn"> </div> <!> <div class="svelte-sy4ydn"><button class="white_button svelte-sy4ydn">TOPへ戻る</button></div></div>'),ro=o('<main style="flex-direction: column; display :flex" class="svelte-sy4ydn"><div class="link link_left svelte-sy4ydn"><a href="https://github.com/Setta238/stk_ygo_svelte" target="_blank" rel="noopener noreferrer" title="repository" class="svelte-sy4ydn">repository</a> <a href="https://x.com/ninja_no" target="_blank" rel="noopener noreferrer" title="repository" class="svelte-sy4ydn">X(Twitter)</a> <a href="https://posfie.com/@ninja_no/p/Lx7FLj3" target="_blank" rel="noopener noreferrer" title="posfie" class="svelte-sy4ydn">posfie(toggeter)</a></div> <div class="link link_right svelte-sy4ydn"><a class="a_button svelte-sy4ydn" role="button" tabindex="0">TOPへ戻る</a> <a href="/stk_ygo_svelte/note.html" target="_blank" rel="noopener noreferrer" title="repository" class="svelte-sy4ydn">現時点とこの先のこと</a></div> <!> <div class="footer card_summary svelte-sy4ydn"><!></div> <div class="footer debug_info svelte-sy4ydn"><span class="svelte-sy4ydn"> </span> <span class="user_agent_info svelte-sy4ydn"> </span> <span class="screen_info svelte-sy4ydn"> </span></div> <!></main>');function so(d,i){_t(i,!1);const t=new kr("stk_ygo_svelte",Ln,Yn);let c=pe(0),f=pe(0),v=pe(),p=pe("FtkChallenge"),l=pe("None"),H=pe(0),V=pe(""),h=pe(void 0);const T="https://setta238.github.io/stk_ygo_svelte/",X="遊戯王deそりてあ",F="ninja_no",re=Cr.getOrCreateNew(t).then(b=>($(p,Pa.includes(b.previousGameMode)?b.previousGameMode:"FtkChallenge"),te(b.previousNpcId),b)),E=b=>{var _;const C=b.find(m=>m.lastUsedAt.getTime()===Math.max(...b.map(I=>I.lastUsedAt.getTime())))??b[0];$(H,C.id),e(p)==="FtkChallenge"&&C.deckType!=="Preset"&&$(H,((_=It.find(m=>m.deckType==="Preset"))==null?void 0:_.id)??e(H))};let n=pe(Ct.getAllDeckInfo(t).then(b=>(Promise.all(b.filter(C=>!C.lastUsedAt).map(C=>{C.saveDeckInfo()})),E(b),b)));const P=async()=>{const b=e(H);let C=(await e(n)).find(m=>m.id===b)??(await we()).find(m=>m.id===b);C&&await C.updateTimestamp();let _=C;if(_||(_=It.find(m=>m.id===b)),!_)throw new Error("illegal state");return _},_e=async()=>{(await re).save({previousGameMode:e(p)})},we=()=>($(n,Ct.getAllDeckInfo(t).then(b=>(E(b),b))),e(n)),ge=async()=>{(await e(n)).length||(await Ct.prepareSampleDeck(),we())},ke=async()=>{await Promise.all([_e(),ge()]);const b=await P(),C=await re;let _=zt.find(J=>J.id===Number.MIN_SAFE_INTEGER)??zt[0],m=It.find(J=>J.id===Number.MIN_SAFE_INTEGER)??It[0],I="PlayFirst";e(p)==="FtkChallenge"?_=zt.filter(J=>J.npcType==="FtkChallenge").find(J=>J.difficulty===C.previousDifficulty)??_:e(p)==="Free"&&(_=zt.find(J=>J.id===C.previousNpcId)??_,m=It.slice(-1)[0],I=C.previousStartMode),_.npcType!=="FtkChallenge"&&C.previousNpcDeckId>-1?m=(await e(n)).find(J=>J.id===C.previousNpcDeckId)??m:m=It.find(J=>J.id===_.id)??m,$(v,new Sr(C,"Player",b,[],_,"NPC",m,[],I)),e(v).onDuelEnd.append(()=>($(v,e(v)),"RemoveMe"))},L=async()=>{await Promise.all([_e(),ge()]),$(l,"DeckEdit")},ie=async b=>{await _e(),b.key==="Enter"&&!b.repeat&&(await re).save()},k=()=>{$(n,we()),$(v,void 0),$(l,"None")};let B=Date.now();const ee=b=>{Date.now()-B<200||(B=Date.now(),$(p,b),we())},R=b=>{te(Number(b.currentTarget.value))},te=b=>{var C;$(h,zt.find(_=>_.id===b)),$(V,((C=e(h))==null?void 0:C.description)??"")};ge(),ut();var Be=ro(),w=s(a(Be),2),S=a(w),W=s(w,2);{var ue=b=>{var C=be(),_=N(C);yt(_,()=>re,null,(m,I)=>{Ci(m,{get duel(){return e(v)},get userProfile(){return e(I)}})}),r(b,C)},Se=b=>{var C=be(),_=N(C);{var m=J=>{An(J,{})},I=J=>{var Ce=Xn(),me=a(Ce),oe=a(me),se=a(oe);yt(se,()=>re,G=>{var ae=Gn();r(G,ae)},(G,ae)=>{var De=Vn(),Oe=N(De),He=a(Oe),Ie=a(He),Le=s(He),Ge=a(Le),nt=a(Ge),Ee=s(Oe,2);yt(Ee,()=>e(n),Ue=>{var Re=Kn();r(Ue,Re)},(Ue,Re)=>{var st=Wn(),ze=N(st),et=a(ze),xt=a(et),ot=s(et),Dt=a(ot);ce(Dt,5,()=>Pa,fe,(Pe,qe)=>{var Ve=Un(),at=N(Ve),lt=s(at,2),pt=a(lt);u(ct=>{dt(at,"id",`game_mode_radio_${ct??""}`),Dr(at,e(qe)),$r(at,e(p)===e(qe)),Te(lt,`game_mode_tab_label game_mode_tab_${ct??""} svelte-sy4ydn`),dt(lt,"for",`game_mode_radio_${ct??""}`),g(pt,e(qe))},[()=>e(qe).toLowerCase()],le),de("change",at,()=>ee(e(qe))),r(Pe,Ve)});var Ut=s(ze,2),Tt=a(Ut),Zt=a(Tt),Kt=s(Tt),M=a(Kt),D=a(M);u(()=>{e(H),Ft(()=>{e(p),e(Re)})}),ce(D,5,()=>e(p)==="FtkChallenge"?It.filter(Pe=>Pe.deckType==="Preset"):e(Re),fe,(Pe,qe)=>{var Ve=Nn(),at={},lt=a(Ve);u(()=>{at!==(at=e(qe).id)&&(Ve.value=(Ve.__value=e(qe).id)==null?"":e(qe).id),g(lt,e(qe).name)}),r(Pe,Ve)});var ve=s(Ut,2);{var $e=Pe=>{var qe=In(),Ve=N(qe),at=a(Ve),lt=a(at),pt=s(at),ct=a(pt),wt=a(ct);u(()=>{e(ae),Ft(()=>{})}),ce(wt,5,()=>zt,fe,(Ke,Fe)=>{var Me=Pn(),Ne={},vt=a(Me);u(()=>{Ne!==(Ne=e(Fe).id)&&(Me.value=(Me.__value=e(Fe).id)==null?"":e(Fe).id),g(vt,e(Fe).name)}),r(Ke,Me)});var Nt=s(wt,2),jt=a(Nt),$t=s(Ve,2);{var Et=Ke=>{var Fe=Fn(),Me=a(Fe),Ne=a(Me),vt=s(Me),it=a(vt),kt=a(it);u(()=>{e(ae),Ft(()=>{e(Re)})});var St=a(kt);St.value=(St.__value=Number.MIN_SAFE_INTEGER)==null?"":Number.MIN_SAFE_INTEGER;var At=s(St);ce(At,1,()=>e(Re),fe,(ea,na)=>{var oa=qn(),Sa={},Xa=a(oa);u(()=>{Sa!==(Sa=e(na).id)&&(oa.value=(oa.__value=e(na).id)==null?"":e(na).id),g(Xa,e(na).name)}),r(ea,oa)}),ne(3,Ne,()=>he,()=>({duration:200})),ne(3,Me,()=>he,()=>({duration:200})),Vt(kt,()=>e(ae).previousNpcDeckId,ea=>e(ae).previousNpcDeckId=ea),ne(3,it,()=>he,()=>({duration:200})),ne(3,vt,()=>he,()=>({duration:200})),ne(3,Fe,()=>he,()=>({duration:200})),r(Ke,Fe)};y($t,Ke=>{var Fe;((Fe=e(h))==null?void 0:Fe.npcType)!=="FtkChallenge"&&Ke(Et)})}var ht=s($t,2),gt=a(ht),Pt=a(gt),Bt=s(gt),Ht=a(Bt),Je=a(Ht);u(()=>{e(ae),Ft(()=>{})}),ce(Je,5,()=>Rt(qa),fe,(Ke,Fe)=>{var Me=Hn(),Ne={},vt=a(Me);u(()=>{Ne!==(Ne=e(Fe))&&(Me.value=(Me.__value=e(Fe))==null?"":e(Fe)),g(vt,qa[e(Fe)])}),r(Ke,Me)}),u(()=>g(jt,`※${e(V)??""}`)),ne(3,lt,()=>he,()=>({duration:200})),ne(3,at,()=>he,()=>({duration:200})),de("change",wt,R),Vt(wt,()=>e(ae).previousNpcId,Ke=>e(ae).previousNpcId=Ke),ne(3,ct,()=>he,()=>({duration:200})),ne(3,pt,()=>he,()=>({duration:200})),ne(3,Ve,()=>he,()=>({duration:200})),ne(3,Pt,()=>he,()=>({duration:200})),ne(3,gt,()=>he,()=>({duration:200})),Vt(Je,()=>e(ae).previousStartMode,Ke=>e(ae).previousStartMode=Ke),ne(3,Ht,()=>he,()=>({duration:200})),ne(3,Bt,()=>he,()=>({duration:200})),ne(3,ht,()=>he,()=>({duration:200})),r(Pe,qe)},We=Pe=>{var qe=be(),Ve=N(qe);{var at=lt=>{var pt=Rn(),ct=a(pt),wt=a(ct),Nt=s(ct),jt=a(Nt),$t=a(jt);u(()=>{e(ae),Ft(()=>{})}),ce($t,5,()=>Mr,fe,(Et,ht)=>{var gt=On(),Pt={},Bt=a(gt);u(()=>{Pt!==(Pt=e(ht))&&(gt.value=(gt.__value=e(ht))==null?"":e(ht)),g(Bt,e(ht))}),r(Et,gt)}),ne(3,wt,()=>he,()=>({duration:200})),ne(3,ct,()=>he,()=>({duration:200})),Vt($t,()=>e(ae).previousDifficulty,Et=>e(ae).previousDifficulty=Et),ne(3,jt,()=>he,()=>({duration:200})),ne(3,Nt,()=>he,()=>({duration:200})),ne(3,pt,()=>he,()=>({duration:200})),r(lt,pt)};y(Ve,lt=>{e(p)==="FtkChallenge"&&lt(at)},!0)}r(Pe,qe)};y(ve,Pe=>{e(p)==="Free"?Pe($e):Pe(We,!1)})}var Xe=s(ve,2),Ye=a(Xe),tt=a(Ye),Qe=a(tt);ne(3,xt,()=>he,()=>({duration:200})),ne(3,et,()=>he,()=>({duration:200})),ne(3,Dt,()=>he,()=>({duration:200})),ne(3,ot,()=>he,()=>({duration:200})),ne(3,ze,()=>he,()=>({duration:200})),ne(3,Zt,()=>he,()=>({duration:200})),ne(3,Tt,()=>he,()=>({duration:200})),Vt(D,()=>e(H),Pe=>$(H,Pe)),ne(3,M,()=>he,()=>({duration:200})),ne(3,Kt,()=>he,()=>({duration:200})),ne(3,Ut,()=>he,()=>({duration:200})),de("click",Qe,ke),ne(3,tt,()=>he,()=>({duration:200})),r(Ue,st)});var ye=s(Ee,2);{var je=Ue=>{var Re=zn(),st=a(Re),ze=a(st),et=a(ze);de("click",et,L),ne(3,ze,()=>he,()=>({duration:200})),ne(3,st,()=>he,()=>({duration:200})),ne(3,Re,()=>he,()=>({duration:200})),r(Ue,Re)};y(ye,Ue=>{e(p)==="Free"&&Ue(je)})}ne(3,Ie,()=>he,()=>({duration:200})),ne(3,He,()=>he,()=>({duration:200})),Mt(nt,()=>e(ae).name,Ue=>e(ae).name=Ue),de("keypress",nt,ie),ne(3,Ge,()=>he,()=>({duration:200})),ne(3,Le,()=>he,()=>({duration:200})),ne(3,Oe,()=>he,()=>({duration:200})),r(G,De)}),r(J,Ce)};y(_,J=>{e(l)==="DeckEdit"?J(m):J(I,!1)},!0)}r(b,C)};y(W,b=>{e(v)?b(ue):b(Se,!1)})}var A=s(W,2),j=a(A);yt(j,()=>ra,b=>{var C=Ze("読み込み中");r(b,C)},(b,C)=>{var _=Qn(),m=N(_),I=a(m),J=s(m,2),Ce=a(J);u((me,oe,se)=>{g(I,`公式DB上のカード${me??""}枚`),g(Ce,`実装済カード（効果あり）${oe??""}枚 （効果なし）${se??""}枚`)},[()=>e(C).knmCount.toLocaleString(),()=>e(C).definitionCount.toLocaleString(),()=>e(C).nonDefinitionCount.toLocaleString()],le),r(b,_)});var U=s(A,2),Q=a(U),Z=a(Q),x=s(Q,2),z=a(x),Y=s(x,2),q=a(Y),O=s(U,2);{var K=b=>{var C=ao(),_=a(C);{var m=ae=>{var De=be(),Oe=N(De);{var He=Le=>{var Ge=Jn();r(Le,Ge)},Ie=Le=>{var Ge=be(),nt=N(Ge);{var Ee=ye=>{var je=Zn();r(ye,je)};y(nt,ye=>{e(v).winner.seat==="Above"&&ye(Ee)},!0)}r(Le,Ge)};y(Oe,Le=>{e(v).winner.seat==="Below"?Le(He):Le(Ie,!1)})}r(ae,De)},I=ae=>{var De=eo();r(ae,De)};y(_,ae=>{e(v).winner?ae(m):ae(I,!1)})}var J=s(_,2),Ce=a(J),me=s(J,2);{var oe=ae=>{var De=to(),Oe=a(De);u(()=>dt(Oe,"href",`https://x.com/share?url=${T}&text=${e(v).twitterShareText??""}&hashtags=${X}&via=${F}`)),r(ae,De)};y(me,ae=>{e(v).twitterShareText&&ae(oe)})}var se=s(me,2),G=a(se);u(()=>g(Ce,e(v).reasonOfEnd)),de("click",G,k),ne(3,C,()=>Er,()=>({delay:200,duration:200})),r(b,C)};y(O,b=>{e(v)&&e(v).isEnded&&b(K)})}u(()=>{g(Z,"build at: 20260112_223909"),g(z,ha.text),g(q,`w:${e(c)??""}px h:${e(f)??""}px`)}),va("innerWidth",b=>$(c,b)),va("innerHeight",b=>$(f,b)),de("click",S,k),r(d,Be),ft()}Tr(so,{target:document.getElementById("app")});
