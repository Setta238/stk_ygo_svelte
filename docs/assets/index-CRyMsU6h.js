var Ha=Object.defineProperty;var ha=o=>{throw TypeError(o)};var Pa=(o,i,t)=>i in o?Ha(o,i,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[i]=t;var Ze=(o,i,t)=>Pa(o,typeof i!="symbol"?i+"":i,t),ya=(o,i,t)=>i.has(o)||ha("Cannot "+t);var at=(o,i,t)=>(ya(o,i,"read from private field"),t?t.call(o):i.get(o)),Ut=(o,i,t)=>i.has(o)?ha("Cannot add the same private member more than once"):i instanceof WeakSet?i.add(o):i.set(o,t),aa=(o,i,t,v)=>(ya(o,i,"write to private field"),v?v.call(o,t):i.set(o,t),t);import{s as ka,r as Oa,a as $,b as La,l as Ra,g as e,d as Na,p as st,c as Oe,m as ye,i as it,t as n,e as a,f as h,h as u,j as ve,k as Ee,n as pt,o as he,q as r,u as nt,v as Pe,S as Wa,w as Se,x as O,y as s,z as ne,D as St,A as te,B as oe,C as f,E as Ka,F as rt,G as oa,H as za,I as Va,J as Ga,K as Mt,L as bt,M as va,N as Xt,O as da,P as Qt,Q as ca,R as Zt,T as Jt,U as Xa,V as Qa,W as Za,X as Ja,Y as er,Z as tr,_ as ar,$ as Kt,a0 as ht,a1 as zt,a2 as ra,a3 as Ia,a4 as rr,a5 as sr,a6 as ir,a7 as nr,a8 as lr,a9 as ft,aa as or,ab as vr,ac as dr,ad as wa,ae as xa,af as Ca,ag as Da,ah as $a,ai as Sa,aj as At,ak as Yt,al as sa,am as Ma,an as cr,ao as Dt,ap as _r,aq as ur,ar as Ta,as as qt,at as $t,au as fr,av as pr,aw as gr,ax as mr,ay as ja,az as br,aA as hr}from"../chunk/entity_proc_20251214_162154.js";import"../chunk/card_json_20251214_162154.js";import"../chunk/others_json_20251214_162154.js";(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const _ of document.querySelectorAll('link[rel="modulepreload"]'))v(_);new MutationObserver(_=>{for(const c of _)if(c.type==="childList")for(const b of c.addedNodes)b.tagName==="LINK"&&b.rel==="modulepreload"&&v(b)}).observe(document,{childList:!0,subtree:!0});function t(_){const c={};return _.integrity&&(c.integrity=_.integrity),_.referrerPolicy&&(c.referrerPolicy=_.referrerPolicy),_.crossOrigin==="use-credentials"?c.credentials="include":_.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function v(_){if(_.ep)return;_.ep=!0;const c=t(_);fetch(_.href,c)}})();const yr=o=>o;function _a(o){const i=o-1;return i*i*i+1}function Ea(o){const i=typeof o=="string"&&o.match(/^\s*(-?[\d.]+)([^\s]*)\s*$/);return i?[parseFloat(i[1]),i[2]||"px"]:[o,"px"]}function kr(o,{delay:i=0,duration:t=400,easing:v=yr}={}){const _=+getComputedStyle(o).opacity;return{delay:i,duration:t,easing:v,css:c=>`opacity: ${c*_}`}}function wr(o,{delay:i=0,duration:t=400,easing:v=_a,x:_=0,y:c=0,opacity:b=0}={}){const d=getComputedStyle(o),Y=+d.opacity,L=d.transform==="none"?"":d.transform,x=Y*(1-b),[l,W]=Ea(_),[H,K]=Ea(c);return{delay:i,duration:t,easing:v,css:(z,B)=>`
			transform: ${L} translate(${(1-z)*l}${W}, ${(1-z)*H}${K});
			opacity: ${Y-x*B}`}}function fe(o,{delay:i=0,duration:t=400,easing:v=_a,axis:_="y"}={}){const c=getComputedStyle(o),b=+c.opacity,d=_==="y"?"height":"width",Y=parseFloat(c[d]),L=_==="y"?["top","bottom"]:["left","right"],x=L.map(N=>`${N[0].toUpperCase()}${N.slice(1)}`),l=parseFloat(c[`padding${x[0]}`]),W=parseFloat(c[`padding${x[1]}`]),H=parseFloat(c[`margin${x[0]}`]),K=parseFloat(c[`margin${x[1]}`]),z=parseFloat(c[`border${x[0]}Width`]),B=parseFloat(c[`border${x[1]}Width`]);return{delay:i,duration:t,easing:v,css:N=>`overflow: hidden;opacity: ${Math.min(N*20,1)*b};${d}: ${N*Y}px;padding-${L[0]}: ${N*l}px;padding-${L[1]}: ${N*W}px;margin-${L[0]}: ${N*H}px;margin-${L[1]}: ${N*K}px;border-${L[0]}-width: ${N*z}px;border-${L[1]}-width: ${N*B}px;min-${d}: 0`}}function qa(o,i){for(const t in i)o[t]=i[t];return o}function xr({fallback:o,...i}){const t=new Map,v=new Map;function _(b,d,Y){const{delay:L=0,duration:x=w=>Math.sqrt(w)*30,easing:l=_a}=qa(qa({},i),Y),W=b.getBoundingClientRect(),H=d.getBoundingClientRect(),K=W.left-H.left,z=W.top-H.top,B=W.width/H.width,N=W.height/H.height,ae=Math.sqrt(K*K+z*z),le=getComputedStyle(d),Me=le.transform==="none"?"":le.transform,T=+le.opacity;return{delay:L,duration:typeof x=="function"?x(ae):x,easing:l,css:(w,V)=>`
			   opacity: ${w*T};
			   transform-origin: top left;
			   transform: ${Me} translate(${V*K}px,${V*z}px) scale(${w+(1-w)*B}, ${w+(1-w)*N});
		   `}}function c(b,d,Y){return(L,x)=>(b.set(x.key,L),()=>{if(d.has(x.key)){const l=d.get(x.key);return d.delete(x.key),_(l,L,x)}return b.delete(x.key),o&&o(L,x,Y)})}return[c(v,t,!1),c(t,v,!0)]}function Aa(o){return Object.prototype.toString.call(o)==="[object Date]"}function Cr(o){return o}function ia(o){const i=o-1;return i*i*i+1}function na(o,i){if(o===i||o!==o)return()=>o;const t=typeof o;if(t!==typeof i||Array.isArray(o)!==Array.isArray(i))throw new Error("Cannot interpolate values of different type");if(Array.isArray(o)){const v=i.map((_,c)=>na(o[c],_));return _=>v.map(c=>c(_))}if(t==="object"){if(!o||!i)throw new Error("Object cannot be null");if(Aa(o)&&Aa(i)){const c=o.getTime(),d=i.getTime()-c;return Y=>new Date(c+Y*d)}const v=Object.keys(i),_={};return v.forEach(c=>{_[c]=na(o[c],i[c])}),c=>{const b={};return v.forEach(d=>{b[d]=_[d](c)}),b}}if(t==="number"){const v=i-o;return _=>o+_*v}return()=>i}var mt,Bt,Ft,Tt;const ua=class ua{constructor(i,t={}){Ut(this,mt,ka(void 0));Ut(this,Bt,ka(void 0));Ut(this,Ft);Ut(this,Tt,null);at(this,mt).v=at(this,Bt).v=i,aa(this,Ft,t)}static of(i,t){const v=new ua(i(),t);return Oa(()=>{v.set(i())}),v}set(i,t){var l;$(at(this,Bt),i);let{delay:v=0,duration:_=400,easing:c=Cr,interpolate:b=na}={...at(this,Ft),...t};if(_===0)return(l=at(this,Tt))==null||l.abort(),$(at(this,mt),i),Promise.resolve();const d=La.now()+v;let Y,L=!1,x=at(this,Tt);return aa(this,Tt,Ra(W=>{if(W<d)return!0;if(!L){L=!0;const K=at(this,mt).v;Y=b(K,i),typeof _=="function"&&(_=_(K,i)),x==null||x.abort()}const H=W-d;return H>_?($(at(this,mt),i),!1):($(at(this,mt),Y(c(H/_))),!0)})),at(this,Tt).promise}get current(){return e(at(this,mt))}get target(){return e(at(this,Bt))}set target(i){this.set(i)}};mt=new WeakMap,Bt=new WeakMap,Ft=new WeakMap,Tt=new WeakMap;let Vt=ua;var Dr=n('<div class="phase_display svelte-1ycsdg6"><span class="svelte-1ycsdg6"> </span> </div>'),$r=n('<div class="lifepoint_display svelte-1ycsdg6"><div class="svelte-1ycsdg6"> </div> <div class="svelte-1ycsdg6"> </div></div>'),Sr=(o,i,t)=>i(e(t)),Mr=n('<div class="svelte-1ycsdg6"><button class="phase_button svelte-1ycsdg6"> </button></div>'),Tr=n("<div><!></div>"),jr=n('<div class="svelte-1ycsdg6"><!></div>'),Er=n("<div><!></div>"),qr=n('<div class="config_button_wrapper svelte-1ycsdg6"><button id="config_button" class="svelte-1ycsdg6">⚙</button></div>'),Ar=n("<!> <!> <!> <!>",1),Yr=n('<div style="position: absolute;" class="card_animation_receiver svelte-1ycsdg6"><!></div>'),Br=n('<div style="position: absolute; top:0rem" class="svelte-1ycsdg6">｛効果対象｝</div>'),Nr=n('<!> <div style="position: absolute; display:flex;justify-content: center;"><!></div>',1),Ir=n(" <!> 】",1),Ur=n('<div style="position: absolute; bottom:0rem" class="svelte-1ycsdg6"> <!></div>'),Fr=n("<!> <!>",1),Hr=n('<div class="badge svelte-1ycsdg6"> </div>'),Pr=n('<div class="card_animation_receiver svelte-1ycsdg6"><!></div>'),Or=n("<!> <!> <!> <!>",1),Lr=n('<td><div role="listitem"><!></div></td>');function Rr(o,i){st(i,!1);let t=Oe(i,"view",12),v=Oe(i,"row",8),_=Oe(i,"column",8),c=Oe(i,"selectedEntities",28,()=>[]),b=Oe(i,"selectedCells",28,()=>[]),d=ye(t().getCell(v(),_())),Y=ye(new Vt(e(d).field.duel.duelists.Above.lp,{duration:400,easing:ia})),L=ye(new Vt(e(d).field.duel.duelists.Below.lp,{duration:400,easing:ia}));const x=()=>{$(d,t().getCell(v(),_())),Pe(Y,e(Y).target=e(d).field.duel.duelists.Above.lp),Pe(L,e(L).target=e(d).field.duel.duelists.Below.lp)};e(d).onUpdate.append(x),t().onDuelUpdate.append(x),t().modalController.onUpdate.append(x);let l,W=ye([]),H=()=>console.log("hoge"),K,z=ye([]),B=ye(!1),N=ye(!1),ae=!1;const le=k=>{var Z,se;$(de,[]),c().reset(),l=k.activator,H=k.resolve,$(W,k.dummyActionInfos),$(z,k.chainBlockInfos.flatMap(ie=>ie.selectedEntities).getDistinct()),K=k.entitiesChoices,$(B,!1),$(N,((Z=k.cellsChoices)==null?void 0:Z.selectables.includes(e(d)))??!1),ae=e(N)&&((se=k.cellsChoices)==null?void 0:se.qty)===1,x()};t().onWaitStart.append(le);const Me=()=>{l=void 0,$(W,[]),H=()=>{console.log("hoge")},K=void 0,$(z,[]),$(B,!1),$(N,!1),ae=!1};t().onWaitEnd.append(Me);let T=ye(!1),w=[];const V=k=>{w=k.filter(Z=>Z.dests.includes(e(d))),$(T,w.length>0),x()},re=()=>{w=[],$(T,!1),x()};t().onDragStart.append(V),t().onDragEnd.append(re);const[ke,J]=Ks;let de=ye([]);const Be=k=>{if(l=void 0,e(d)===k.to||e(d).entities.includes(k.entity)){$(de,[...e(de),k]);const Z=k.resolve;$(d,e(d)),setTimeout(()=>{$(de,e(de).filter(se=>se!==k)),k.count++,k.count>1&&Z()},600)}};t().onAnimation.append(Be);const Le=k=>{H({phaseChange:k})},M=()=>e(d).isStackCell&&e(d).entities.flatMap(k=>k.actions).filter(k=>e(W).map(Z=>Z.action.seq).some(Z=>Z===k.seq)).length>0,E=k=>{var Z;if(((Z=k.target)==null?void 0:Z.id)==="config_button"){t(t().infoBoardState="Config",!0),t().requireUpdate();return}if(t(t().infoBoardState="Default",!0),ae)H({selectedCells:[e(d)]});else if(e(N))$(B,!e(B)),b(e(B)?[...b(),e(d)]:b().filter(se=>se!==e(d)));else if(e(d).isStackCell){t(t().infoBoardState="CellInfo",!0),t(t().infoBoardCell=e(d),!0),t().requireUpdate();const se=e(d).entities.flatMap(p=>p.actions).map(p=>p.seq),ie=e(W).filter(p=>se.includes(p.action.seq));if(ie.length){if(!l)return;t().modalController.actionSelector.show({title:"カードを選択。",position:"Bottom",activator:l,dummyActionInfos:ie,cancelable:!0}).then(p=>{p&&H({actionInfo:p})});return}}t().requireUpdate(),console.info(e(d),we(...e(d).visibleEntities))},ee=k=>{k.preventDefault(),k.dataTransfer&&(k.dataTransfer.dropEffect="move")},_e=k=>{k.preventDefault(),console.info("drop",k,e(T),w),k.dataTransfer&&(k.dataTransfer.dropEffect="move");try{if(e(T)&&w){if(w.length===1){const Z=w[0];H({actionInfo:{...Z,dest:e(d)}})}else if(w.length>1){if(!l)throw new Wa("想定されない状態");e(d).field.duel.view.modalController.terminateAll(),e(d).field.duel.view.modalController.actionSelector.show({title:"選択",position:"Bottom",activator:l,dummyActionInfos:w.map(Z=>({...Z,dest:e(d)})),cancelable:!1}).then(Z=>{H({actionInfo:Z})})}}}finally{t().removeDraggingActions()}},we=(...k)=>{if(t().waitMode==="Animation")return"Disabled";if(K&&K.selectables.find(se=>k.find(ie=>se===ie)))return"Selectable";if(!e(W)||e(W).length===0||t().waitMode!=="Free"||Object.values(t().modalController.modals).some(se=>se.state==="Shown"))return"Disabled";const Z=e(W).filter(se=>k.includes(se.action.entity));return Z.length===0?"Disabled":e(d).isStackCell||Z[0].action.entity!==k[0]?"Clickable":Z.some(se=>se.dests.length)?"Draggable":"Clickable"};it();var U=Lr(),A=a(U);A.__click=E;var Q=a(A);{var G=k=>{var Z=Se(),se=O(Z);{var ie=p=>{var j=Se(),C=O(j);{var P=g=>{var X=Dr(),me=a(X),$e=a(me),pe=s(me,1,!0);u((ce,S)=>{f($e,ce),f(pe,S)},[()=>String(e(d).field.duel.clock.turn).padStart(2,"0"),()=>e(d).field.duel.phase.toUpperCase()],ve),r(g,X)},y=g=>{var X=Se(),me=O(X);{var $e=ce=>{var S=$r(),F=a(S),be=a(F),De=s(F,2),Re=a(De);u((qe,Ae)=>{f(be,qe),f(Re,Ae)},[()=>Math.floor(e(Y).current),()=>Math.floor(e(L).current)],ve),r(ce,S)},pe=ce=>{var S=Se(),F=O(S);{var be=De=>{var Re=Se(),qe=O(Re);{var Ae=Ne=>{var ze=Se(),q=O(ze);{var D=m=>{var I=Se(),ge=O(I);ne(ge,1,()=>t().duel.nextPhaseList,oe,(Te,R)=>{var xe=Mr(),Ye=a(xe);Ye.__click=[Sr,Le,R];var We=a(Ye);u(Ie=>f(We,Ie),[()=>e(R).toUpperCase()],ve),r(Te,xe)}),r(m,I)};h(q,m=>{t().duel.isEnded||m(D)})}r(Ne,ze)};h(qe,Ne=>{t().waitMode==="Free"&&Ne(Ae)})}r(De,Re)};h(F,De=>{e(d).column===5&&De(be)},!0)}r(ce,S)};h(me,ce=>{e(d).column===3?ce($e):ce(pe,!1)},!0)}r(g,X)};h(C,g=>{e(d).column===1?g(P):g(y,!1)})}r(p,j)};h(se,p=>{e(d).row===3&&p(ie)})}r(k,Z)},ue=k=>{var Z=Se(),se=O(Z);{var ie=j=>{var C=Ar();const P=ve(()=>e(de).find(S=>S.to===e(d)));var y=O(C);{var g=S=>{var F=Tr(),be=a(F);St(be,{get entity(){return e(P).entity},state:"Disabled",dummyActionInfos:[],cardActionResolve:void 0}),u(()=>Ee(F,`card_animation_receiver ${e(d).cellType??""} svelte-1ycsdg6`)),te(1,F,()=>J,()=>({key:e(P).entity.seq})),r(S,F)};h(y,S=>{e(P)&&e(P).index==="Top"&&S(g)})}var X=s(y,2);ne(X,1,()=>e(d).visibleEntities,oe,(S,F)=>{var be=Se(),De=O(be);{var Re=qe=>{var Ae=jr(),Ne=a(Ae);const ze=ve(()=>we(e(F))),q=ve(()=>e(W).filter(D=>D.action.entity===e(F)));St(Ne,{get entity(){return e(F)},get state(){return e(ze)},get dummyActionInfos(){return e(q)},cardActionResolve:void 0,get selectedList(){return c()},set selectedList(D){c(D)},$$legacy:!0}),te(2,Ae,()=>ke,()=>({key:e(F).seq})),r(qe,Ae)};h(De,qe=>{e(de).every(Ae=>Ae.entity.seq!==e(F).seq)&&qe(Re)})}r(S,be)});var me=s(X,2);{var $e=S=>{var F=Er(),be=a(F);St(be,{get entity(){return e(P).entity},state:"Disabled",dummyActionInfos:[],cardActionResolve:void 0}),u(()=>Ee(F,`card_animation_receiver ${e(d).cellType??""} svelte-1ycsdg6`)),te(1,F,()=>J,()=>({key:e(P).entity.seq})),r(S,F)};h(me,S=>{e(P)&&e(P).index!=="Top"&&S($e)})}var pe=s(me,2);{var ce=S=>{var F=qr();r(S,F)};h(pe,S=>{e(d).owner.seat==="Below"&&S(ce)})}r(j,C)},p=j=>{var C=Or();const P=ve(()=>e(de).find(F=>F.to===e(d)));var y=O(C);{var g=F=>{var be=Yr(),De=a(be);St(De,{get entity(){return e(P).entity},state:"Disabled",dummyActionInfos:[],cardActionResolve:void 0}),te(1,be,()=>J,()=>({key:e(P).entity.seq})),r(F,be)};h(y,F=>{e(P)&&e(P).index!=="Top"&&F(g)})}var X=s(y,2);{var me=F=>{var be=Fr(),De=O(be);ne(De,1,()=>e(d).visibleEntities.map((Ae,Ne)=>({index:Ne,entity:Ae})).toReversed(),oe,(Ae,Ne)=>{var ze=Se(),q=O(ze);{var D=m=>{var I=Nr();const ge=ve(()=>!e(d).isStackCell&&e(Ne).index===0?we(...e(d).visibleEntities):void 0);var Te=O(I);{var R=Ie=>{var Ke=Br();r(Ie,Ke)};h(Te,Ie=>{e(z).includes(e(Ne).entity)&&Ie(R)})}var xe=s(Te,2),Ye=a(xe);const We=ve(()=>e(Ne).index===0?e(W).filter(Ie=>e(d).visibleEntities.includes(Ie.action.entity)):void 0);St(Ye,{get entity(){return e(Ne).entity},get state(){return e(ge)},get dummyActionInfos(){return e(We)},cardActionResolve:void 0,get selectedList(){return c()},set selectedList(Ie){c(Ie)},$$legacy:!0}),u(()=>Ee(xe,`duel_card_wrapper ${(e(Ne).entity.exist?"duel_card_wrapper_exists":"")??""} svelte-1ycsdg6`)),te(2,xe,()=>ke,()=>({key:e(Ne).entity.seq})),r(m,I)};h(q,m=>{e(de).every(I=>I.entity.seq!==e(Ne).entity.seq)&&m(D)})}r(Ae,ze)});var Re=s(De,2);{var qe=Ae=>{var Ne=Ur(),ze=a(Ne),q=s(ze);ne(q,1,()=>oa(e(d).visibleEntities[0].status.maxCounterQty),oe,(D,m)=>{var I=Ir(),ge=O(I),Te=s(ge);{var R=xe=>{var Ye=rt();u(()=>f(Ye,`/${e(d).visibleEntities[0].status.maxCounterQty[e(m)]??""}`)),r(xe,Ye)};h(Te,xe=>{(e(d).visibleEntities[0].status.maxCounterQty[e(m)]??9999)<100&&xe(R)})}u((xe,Ye)=>f(ge,`【
              ${xe??""}${Ye??""} `),[()=>Ka(e(m)),()=>e(d).visibleEntities[0].counterHolder.getQty(e(m))],ve),r(D,I)}),u(()=>f(ze,`【${e(d).visibleEntities[0].battlePositionName??""}】 `)),r(Ae,Ne)};h(Re,Ae=>{e(d).visibleEntities[0].battlePosition&&Ae(qe)})}r(F,be)};h(X,F=>{e(d).visibleEntities.length>0&&F(me)})}var $e=s(X,2);{var pe=F=>{var be=Hr(),De=a(be);u(()=>f(De,e(d).visibleEntities.length)),r(F,be)};h($e,F=>{e(d).isStackCell&&F(pe)})}var ce=s($e,2);{var S=F=>{var be=Pr(),De=a(be);St(De,{get entity(){return e(P).entity},state:"Disabled",dummyActionInfos:[],cardActionResolve:void 0}),te(1,be,()=>J,()=>({key:e(P).entity.seq})),r(F,be)};h(ce,F=>{e(P)&&e(P).index==="Top"&&F(S)})}r(j,C)};h(se,j=>{e(d).cellType==="Hand"?j(ie):j(p,!1)},!0)}r(k,Z)};h(Q,k=>{e(d).isDisabledCell?k(G):k(ue,!1)})}u(k=>{Ee(U,`${`duel_field_cell duel_field_cell_${e(d).cellType} ${e(d).linkArrowSources.length===0?"":"duel_field_cell_linked"}`??""} svelte-1ycsdg6`),pt(U,"colspan",e(d).cellType==="Hand"?7:1),Ee(A,`${k??""} svelte-1ycsdg6`)},[()=>`duel_field_cell_inner_box ${e(d).cellType} ${e(T)?"can_accept_drop":""} ${M()?"can_action":""} ${e(B)?"is_selected":e(N)?"is_selectable":""} `],ve),he("dragover",A,ee),he("drop",A,_e),r(o,U),nt()}Na(["click"]);var Wr=n('<div class="title svelte-14z6bdh"> </div>'),Kr=n('<div class="title svelte-14z6bdh"> </div>'),zr=n('<div class="duel_log_chain_number svelte-14z6bdh"> </div>'),Vr=n('<div><a class="white_button" download="error_info.json">エラー情報ダウンロード</a></div>'),Gr=n("<div><!> <!></div>"),Xr=n('<div><div style="display: flex;    justify-content: space-between;"><div style=" white-space: nowrap;text-align: center;"> </div> <!></div> <!></div>'),Qr=n("<div><!> <!></div>"),Zr=n("<div><!> <!></div>"),Jr=n('<div class="duel_log svelte-14z6bdh"><div class="duel_log_header svelte-14z6bdh"></div> <div class="duel_log_body svelte-14z6bdh"></div> <div class="duel_log_footer svelte-14z6bdh"></div></div>');function es(o,i){st(i,!1);let t=ye(void 0),v=Oe(i,"log",8),_,c=ye([]);const b=()=>{const x=((_==null?void 0:_.seq)??-1)+1;v().records.slice(x).forEach(l=>{if(!_){$(c,[[[[l]]]]),_=l;return}if(!e(c)[l.clock.turn]){Pe(c,e(c)[l.clock.turn]=[[[l]]]),_=l;return}if(!e(c)[l.clock.turn][l.clock.phaseSeq]){Pe(c,e(c)[l.clock.turn][l.clock.phaseSeq]=[[l]]),_=l;return}if(_.clock.chainSeq===l.clock.chainSeq&&_.clock.chainBlockSeq===l.clock.chainBlockSeq&&_.duelist===l.duelist){e(c)[l.clock.turn][l.clock.phaseSeq].slice(-1)[0].push(l),_=l;return}e(c)[l.clock.turn][l.clock.phaseSeq].push([l]),_=l}),$(c,e(c)),za().then(()=>e(t)&&e(t).scroll(0,e(t).clientHeight*990))};v().onUpdate.append(b),v().duel.view.onDuelUpdate.append(b),b(),it();var d=Se(),Y=O(d);{var L=x=>{var l=Jr(),W=s(a(l),2);ne(W,5,()=>e(c),oe,(H,K)=>{var z=Zr(),B=a(z);{var N=le=>{var Me=Wr(),T=a(Me);u(()=>f(T,`ターン：${e(K)[0][0][0].clock.turn??""}`)),r(le,Me)};h(B,le=>{e(K)[0][0][0].clock.turn>0&&le(N)})}var ae=s(B,2);ne(ae,1,()=>e(K),oe,(le,Me)=>{var T=Qr(),w=a(T);{var V=ke=>{var J=Kr(),de=a(J);u(()=>f(de,e(Me)[0][0].clock.period.name)),r(ke,J)};h(w,ke=>{e(Me)[0][0].clock.turn>0&&ke(V)})}var re=s(w,2);ne(re,1,()=>e(Me),oe,(ke,J)=>{var de=Xr();const Be=ve(()=>{var U;return((U=e(J).find(A=>A.chainNumber!==void 0))==null?void 0:U.chainNumber)??0});var Le=a(de),M=a(Le),E=a(M),ee=s(M,2);{var _e=U=>{var A=zr(),Q=a(A);u(()=>f(Q,`チェーン：${e(Be)??""}`)),r(U,A)};h(ee,U=>{e(Be)&&U(_e)})}var we=s(Le,2);ne(we,1,()=>e(J),oe,(U,A)=>{var Q=Gr(),G=a(Q);{var ue=ie=>{var p=rt();u(()=>f(p,e(A).text)),r(ie,p)},k=ie=>{var p=Se(),j=O(p);{var C=y=>{var g=rt();u((X,me,$e)=>f(g,`移動：${X??""} ${me??""} ⇒ ${$e??""}`),[()=>{var X;return(X=e(A).mainEntity)==null?void 0:X.toString()},()=>{var X;return(X=e(A).from)==null?void 0:X.toString()},()=>{var X;return(X=e(A).to)==null?void 0:X.toString()}],ve),r(y,g)},P=y=>{var g=Se(),X=O(g);{var me=pe=>{var ce=rt();u((S,F)=>f(ce,`生成：${S??""} void ⇒ ${F??""}`),[()=>{var S;return(S=e(A).mainEntity)==null?void 0:S.toString()},()=>{var S;return(S=e(A).to)==null?void 0:S.toString()}],ve),r(pe,ce)},$e=pe=>{var ce=Se(),S=O(ce);{var F=De=>{var Re=rt();u((qe,Ae)=>f(Re,`消滅：${qe??""} ${Ae??""} ⇒ void`),[()=>{var qe;return(qe=e(A).mainEntity)==null?void 0:qe.toString()},()=>{var qe;return(qe=e(A).from)==null?void 0:qe.toString()}],ve),r(De,Re)},be=De=>{var Re=rt();u(()=>f(Re,e(A).text)),r(De,Re)};h(S,De=>{e(A).type==="EntityDisappear"?De(F):De(be,!1)},!0)}r(pe,ce)};h(X,pe=>{e(A).type==="EntityAppear"?pe(me):pe($e,!1)},!0)}r(y,g)};h(j,y=>{e(A).type==="EntityMove"?y(C):y(P,!1)},!0)}r(ie,p)};h(G,ie=>{e(A).type==="ChainBlockHeader"?ie(ue):ie(k,!1)})}var Z=s(G,2);{var se=ie=>{var p=Vr(),j=a(p);u(C=>pt(j,"href",C),[()=>window.URL.createObjectURL(new Blob([Ga(e(A).error,(C,P)=>["pool","bundles","duel"].includes(C)||typeof P=="function"?void 0:P,4)],{type:"text/plain"}))],ve),r(ie,p)};h(Z,ie=>{e(A).error&&ie(se)})}u(ie=>Ee(Q,`duel_log_record duel_log_record_${ie??""} svelte-14z6bdh`),[()=>e(A).type.toSnakeCase()],ve),r(U,Q)}),u(()=>{var U,A,Q;Ee(de,`duel_log_block_duelist duel_log_block_duelist_${((U=e(J)[0].duelist)==null?void 0:U.seat)??"system"} svelte-14z6bdh`),Ee(M,`duelist ${((A=e(J)[0].duelist)==null?void 0:A.seat)??""} svelte-14z6bdh`),f(E,((Q=e(J)[0].duelist)==null?void 0:Q.profile.name)||"SYSTEM")}),r(ke,de)}),u(()=>Ee(T,`duel_log_block_phase duel_log_block_phase_${e(Me)[0][0].clock.period.key??""} svelte-14z6bdh`)),r(le,T)}),u(()=>Ee(z,`duel_log_block_turn duel_log_block_turn_${e(K)[0][0][0].clock.turn??""} svelte-14z6bdh`)),r(H,z)}),Va(W,H=>$(t,H),()=>e(t)),r(x,l)};h(Y,x=>{(v().duel.view.infoBoardState==="Log"||v().duel.view.infoBoardState==="Default")&&x(L)})}r(o,d),nt()}var ts=n("<div><div> </div> <div> </div></div>");function Ya(o,i){st(i,!1);let t=Oe(i,"duelist",12),v=ye(0),_=ye();const c=async()=>{const W=t().lp-e(v);if(!e(_)||Math.abs(W)<10){$(v,t().lp),e(_)&&(e(_)(),$(_,void 0));return}$(v,e(v)+Math.floor(Math.random()*W)),await Mt(100),c()},b=()=>{t(t()),!e(_)&&t().lp!==e(v)&&new Promise(W=>{$(_,W),Math.abs(t().lp-e(v)),c()})};t().duel.log.onUpdate.append(b),c(),it();var d=ts(),Y=a(d),L=a(Y),x=s(Y,2),l=a(x);u(W=>{Ee(d,`duelist duelist_${W??""} svelte-1sy3trd`),Ee(Y,`duelist_name duelist_${W??""}_name svelte-1sy3trd`),f(L,t().profile.name),Ee(x,`duelist_lp ${(e(_)?"vibration":"")??""} svelte-1sy3trd`),f(l,e(v))},[()=>t().seat.toLowerCase()],ve),r(o,d),nt()}const as=(o,i,t)=>(i(i()!=="Detail"?"Detail":"Normal"),console.info(t()),!0),rs=(o,i,t)=>(i(i()!=="Debug"?"Debug":"Normal"),console.info(t()),!0);var ss=n('<div class="duel_card_info_row svelte-1uevs9j" style=" justify-content: space-between;"><div class="svelte-1uevs9j"> </div> <div class="svelte-1uevs9j"> </div></div>'),is=n('<div></div> <div class="svelte-1uevs9j"> </div>',1),ns=n("<div> </div>"),ls=n("<div> </div>"),os=n('<div class="duel_card_info_row svelte-1uevs9j"><!> <!></div> <div class="duel_card_info_row svelte-1uevs9j"></div>',1),vs=n('<div class="duel_card_row svelte-1uevs9j"><div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"> </div></div>'),ds=n('<div class="duel_card_row svelte-1uevs9j"><div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"> </div></div>'),cs=n("<!> <!>",1),_s=n('<div class="duel_card_info_row svelte-1uevs9j" style="border-style: solid; border-width: 1px;"><pre class="description svelte-1uevs9j"> </pre></div>'),us=n('<!> <div class="duel_card_info_row svelte-1uevs9j"><pre class="description svelte-1uevs9j"> </pre></div>',1),fs=n('<div class="effect_counter_area_item svelte-1uevs9j"><span class="svelte-1uevs9j"> </span> <span class="svelte-1uevs9j"> </span> <span class="svelte-1uevs9j">/</span> <span class="svelte-1uevs9j"> </span></div>'),ps=n('<div class="duel_card_info_row effect_counter_area svelte-1uevs9j"><div class="effect_counter_area_title svelte-1uevs9j">効果使用状況</div> <div class="effect_counter_area_body svelte-1uevs9j"></div></div>'),gs=n("[ <!> ],",1),ms=n('<div class="svelte-1uevs9j"> <!></div>'),bs=n('<div class="svelte-1uevs9j"> </div> <!> <div class="svelte-1uevs9j"></div>',1),hs=n('<div class="svelte-1uevs9j"> </div>'),ys=n('<div class="svelte-1uevs9j"> </div>'),ks=n('<div class="svelte-1uevs9j"> </div>'),ws=n('<div class="svelte-1uevs9j"> </div>'),xs=n('<div class="svelte-1uevs9j"> </div>'),Cs=n('<div class="svelte-1uevs9j"> </div>'),Ds=n('<div class="duel_card_info_row svelte-1uevs9j"><div class="svelte-1uevs9j"><!> <div class="svelte-1uevs9j"></div> <!> <div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"></div> <!> <div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"></div> <!> <div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"></div> <!> <div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"></div> <!> <div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"></div> <!> <div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"> </div> <div class="svelte-1uevs9j"> </div> <div class="svelte-1uevs9j"> </div> <div class="svelte-1uevs9j"></div></div></div>'),$s=n('<div class="svelte-1uevs9j">※テスト用カードです</div>'),Ss=n('<div class="duel_card_info_links svelte-1uevs9j"><a target="_blank" rel="noopener noreferrer" title="遊戯王カードWiki" class="svelte-1uevs9j">⇒遊戯王カードWiki</a> <a target="_blank" rel="noopener noreferrer" title="コナミカードデータベース" class="svelte-1uevs9j"> </a></div>'),Ms=n('<div role="contentinfo"><div class="duel_card_info_header svelte-1uevs9j"><div class="duel_card_info_row svelte-1uevs9j"><div class="svelte-1uevs9j"> </div></div> <div class="duel_card_info_row svelte-1uevs9j" style="position:sticky; top:0;"><div class="svelte-1uevs9j"> </div> <div class="svelte-1uevs9j"> </div></div> <!></div> <div class="duel_card_info_body svelte-1uevs9j"><!></div> <div class="duel_card_info_footer svelte-1uevs9j"><!></div></div>');function Ts(o,i){st(i,!1);let t=Oe(i,"entity",8,void 0),v=Oe(i,"mode",12,"Normal");const _=()=>t()?bt[t().origin.name]:void 0,c=()=>{var L;return t()&&(t().origin.cardId??!1)?`https://www.db.yugioh-card.com/yugiohdb/card_search.action?ope=2&cid=${t().origin.cardId}`:`https://www.db.yugioh-card.com/yugiohdb/card_search.action?ope=1&sess=1&rp=10&mode=&sort=1&keyword=${(L=_())==null?void 0:L.name}&stype=1&ctype=&othercon=2&starfr=&starto=&pscalefr=&pscaleto=&linkmarkerfr=&linkmarkerto=&link_m=2&atkfr=&atkto=&deffr=&defto=&releaseDStart=1&releaseMStart=1&releaseYStart=1999&releaseDEnd=&releaseMEnd=&releaseYEnd=`};it();var b=Se(),d=O(b);{var Y=L=>{var x=Ms();x.__click=[as,v,t],x.__contextmenu=[rs,v,t];var l=a(x),W=a(l),H=a(W),K=a(H),z=s(W,2),B=a(z),N=a(B),ae=s(B,2),le=a(ae),Me=s(z,2);{var T=M=>{var E=cs(),ee=O(E);{var _e=Q=>{var G=ss(),ue=a(G),k=a(ue),Z=s(ue,2),se=a(Z);u(()=>{f(k,`◀ ${t().psL??""}`),f(se,`${t().psR??""} ▶`)}),r(Q,G)};h(ee,Q=>{var G;(G=t().origin.monsterCategories)!=null&&G.includes("Pendulum")&&Q(_e)})}var we=s(ee,2);{var U=Q=>{var G=os(),ue=O(G),k=a(ue);ne(k,1,()=>t().attr,oe,(ie,p)=>{var j=is(),C=O(j),P=s(C,2),y=a(P);u(()=>{Ee(C,`monster_attr ${e(p)??""} svelte-1uevs9j`),f(y,`${va[e(p)]??""}属性`)}),r(ie,j)});var Z=s(k,2);ne(Z,1,()=>t().types,oe,(ie,p)=>{var j=ns(),C=a(j);u(()=>{Ee(j,`monster_cat ${e(p)??""} svelte-1uevs9j`),f(C,`${Xt[e(p)]??""}${da[e(p)]??""}族`)}),r(ie,j)});var se=s(ue,2);ne(se,5,()=>t().status.monsterCategories??[],oe,(ie,p)=>{var j=ls(),C=a(j);u(()=>{Ee(j,`monster_cat ${e(p)??""} svelte-1uevs9j`),f(C,`${Qt[e(p)]??""}${ca[e(p)]??""}`)}),r(ie,j)}),r(Q,G)},A=Q=>{var G=Se(),ue=O(G);{var k=se=>{var ie=vs(),p=s(a(ie),2),j=a(p);u(()=>f(j,`${Zt[t().status.spellCategory]??""}魔法`)),r(se,ie)},Z=se=>{var ie=Se(),p=O(ie);{var j=C=>{var P=ds(),y=s(a(P),2),g=a(y);u(()=>f(g,`${Jt[t().status.trapCategory]??""}罠`)),r(C,P)};h(p,C=>{t().kind==="Trap"&&t().status.trapCategory&&C(j)},!0)}r(se,ie)};h(ue,se=>{t().kind==="Spell"&&t().status.spellCategory?se(k):se(Z,!1)},!0)}r(Q,G)};h(we,Q=>{t().kind==="Monster"?Q(U):Q(A,!1)})}r(M,E)};h(Me,M=>{v()!=="Debug"&&M(T)})}var w=s(l,2),V=a(w);{var re=M=>{var E=us(),ee=O(E);{var _e=Q=>{var G=_s(),ue=a(G),k=a(ue);u(()=>f(k,bt[t().origin.name].pendulumDescription)),r(Q,G)};h(ee,Q=>{var G;(G=t().status.monsterCategories)!=null&&G.includes("Pendulum")&&Q(_e)})}var we=s(ee,2),U=a(we),A=a(U);u(Q=>f(A,Q),[()=>{var Q;return(Q=_())==null?void 0:Q.description}],ve),r(M,E)},ke=M=>{var E=Se(),ee=O(E);{var _e=U=>{var A=Se(),Q=O(A);{var G=ue=>{var k=ps(),Z=s(a(k),2);ne(Z,5,()=>t().actions,oe,(se,ie)=>{var p=Se();const j=ve(()=>e(ie).actionCountUpperBound),C=ve(()=>e(ie).actionCount);var P=O(p);{var y=g=>{var X=fs(),me=a(X),$e=a(me),pe=s(me,2),ce=a(pe),S=s(pe,4),F=a(S);u(()=>{f($e,e(ie).title),f(ce,e(C)),f(F,e(j))}),r(g,X)};h(P,g=>{e(j)!==void 0&&e(C)!==void 0&&g(y)})}r(se,p)}),r(ue,k)};h(Q,ue=>{t().actions.some(k=>k.actionCountUpperBoundKey)&&ue(G)})}r(U,A)},we=U=>{var A=Ds(),Q=a(A),G=a(Q);ne(G,0,()=>["info","status"],oe,(D,m)=>{var I=bs(),ge=O(I),Te=a(ge),R=s(ge,2);ne(R,1,()=>Object.entries(t()[m]),oe,(Ye,We)=>{let Ie=()=>e(We)[0],Ke=()=>e(We)[1];var vt=ms(),dt=a(vt),tt=s(dt);{var Ce=je=>{var Xe=gs(),Je=s(O(Xe));ne(Je,1,Ke,oe,(lt,yt)=>{var Ve=rt();u(Ue=>f(Ve,`${Ue??""},`),[()=>e(yt).toString()],ve),r(lt,Ve)}),r(je,Xe)},Fe=je=>{var Xe=rt();u(Je=>f(Xe,`${Je??""},`),[()=>{var Je;return(Je=Ke())==null?void 0:Je.toString()}],ve),r(je,Xe)};h(tt,je=>{Array.isArray(Ke())?je(Ce):je(Fe,!1)})}u(()=>f(dt,`"${Ie()??""}" : `)),r(Ye,vt)});var xe=s(R,2);xe.textContent="},",u(()=>f(Te,`"${m??""}" :{`)),r(D,I)});var ue=s(G,2);ue.textContent='"actions" :[';var k=s(ue,2);ne(k,1,()=>t().actions,oe,(D,m)=>{var I=hs(),ge=a(I);u(()=>f(ge,`"${e(m).playType??""} ${e(m).title??""}",`)),r(D,I)});var Z=s(k,2);Z.textContent="],";var se=s(Z,2);se.textContent='"substituteEffects" :[';var ie=s(se,2);ne(ie,1,()=>t().substituteEffects,oe,(D,m)=>{var I=ys(),ge=a(I);u(()=>f(ge,`"${e(m).title??""}",`)),r(D,I)});var p=s(ie,2);p.textContent="],";var j=s(p,2);j.textContent='"continuousEffects" :[';var C=s(j,2);ne(C,1,()=>t().continuousEffects,oe,(D,m)=>{var I=ks(),ge=a(I);u(()=>f(ge,`"${e(m).isStarted??""}",`)),r(D,I)});var P=s(C,2);P.textContent="],";var y=s(P,2);y.textContent='"procFilters" :[';var g=s(y,2);ne(g,1,()=>t().procFilterBundle.operators,oe,(D,m)=>{var I=ws(),ge=a(I);u(Te=>f(ge,`"${Te??""} ${e(m).title??""} ${e(m).isEffective??""} ",`),[()=>e(m).isSpawnedBy.toString()],ve),r(D,I)});var X=s(g,2);X.textContent="],";var me=s(X,2);me.textContent='"numericStateOperators" :[';var $e=s(me,2);ne($e,1,()=>t().numericOprsBundle.operators,oe,(D,m)=>{var I=xs(),ge=a(I);u(Te=>f(ge,`"${Te??""} ${e(m).title??""} ${e(m).isEffective??""} ${e(m).isContinuous??""} ${e(m).targetState??""} ${e(m).targetStateGen??""} ",`),[()=>e(m).isSpawnedBy.toString()],ve),r(D,I)});var pe=s($e,2);pe.textContent="],";var ce=s(pe,2);ce.textContent='"stateOperators" :[';var S=s(ce,2);ne(S,1,()=>t().statusOperatorBundle.operators,oe,(D,m)=>{var I=Cs(),ge=a(I);u(Te=>f(ge,`"${Te??""} ${e(m).title??""} ${e(m).isEffective??""} ",`),[()=>e(m).isSpawnedBy.toString()],ve),r(D,I)});var F=s(S,2);F.textContent="],";var be=s(F,2);be.textContent='"lastMoveLogRecord" :{';var De=s(be,2),Re=a(De),qe=s(De,2),Ae=a(qe),Ne=s(qe,2),ze=a(Ne),q=s(Ne,2);q.textContent="},",u((D,m)=>{f(Re,`"movedBy":"${D??""}",`),f(Ae,`"movedAs":"${m??""}",`),f(ze,`"movedAt":"${t().moveLog.latestRecord.movedAt.totalProcSeq??""}",`)},[()=>{var D;return(D=t().moveLog.latestRecord.movedBy)==null?void 0:D.toString()},()=>t().moveLog.latestRecord.movedAs.join(" ")],ve),r(U,A)};h(ee,U=>{v()==="Detail"?U(_e):U(we,!1)},!0)}r(M,E)};h(V,M=>{v()==="Normal"?M(re):M(ke,!1)})}var J=s(w,2),de=a(J);{var Be=M=>{var E=$s();r(M,E)},Le=M=>{var E=Ss(),ee=a(E),_e=s(ee,2),we=a(_e);u(U=>{var A;pt(ee,"href",`https://yugioh-wiki.net/index.php?${t().origin.wikiEncodedName}`),pt(_e,"href",U),f(we,`⇒${((A=t())!=null&&A.origin.cardId?"公式カードページ":"公式で検索")??""}`)},[c],ve),r(M,E)};h(de,M=>{var E;(E=t())!=null&&E.origin.isForTest?M(Be):M(Le,!1)})}u((M,E,ee)=>{Ee(x,`duel_card duel_card_info ${t().origin.kind??""} ${M??""} svelte-1uevs9j`),f(K,t().nm),f(N,E),f(le,ee)},[()=>{var M;return(M=t().origin.monsterCategories)==null?void 0:M.join(" ")},()=>"★".repeat(t().lvl||0),()=>"☆".repeat(t().rank||0)],ve),r(L,x)};h(d,L=>{t()&&L(Y)})}r(o,b),nt()}Na(["click","contextmenu"]);var js=n('<div class="duel_field_cell_info_item svelte-1xj7qf1"><!></div>'),Es=n('<div class="duel_field_cell_info_box svelte-1xj7qf1"><div class="duel_field_cell_info_label svelte-1xj7qf1"> </div> <!></div>'),qs=n('<div class="duel_field_cell_info svelte-1xj7qf1"><div class="duel_field_cell_info_header item_btn svelte-1xj7qf1"><div class="svelte-1xj7qf1"> </div> <div class="svelte-1xj7qf1"> </div></div> <div class="duel_field_cell_info_body svelte-1xj7qf1"></div></div>');function As(o,i){st(i,!1);let t=Oe(i,"cell",12);const v=()=>{t(t())},_=Y=>t().cardEntities.filter(L=>L.face===Y);t().field.duel.view.onDuelUpdate.append(v),it();var c=Se(),b=O(c);{var d=Y=>{var L=qs(),x=a(L),l=a(x),W=a(l),H=s(l,2),K=a(H),z=s(x,2);ne(z,4,()=>["FaceUp","FaceDown"],oe,(B,N)=>{var ae=Se(),le=O(ae);{var Me=T=>{var w=Es(),V=a(w),re=a(V),ke=s(V,2);ne(ke,1,()=>_(N).toSorted(Xa),oe,(J,de)=>{var Be=js(),Le=a(Be);const M=ve(()=>t().owner===t().field.duel.duelists.Below);St(Le,{get entity(){return e(de)},get isVisibleForcibly(){return e(M)},isWideMode:!0,cardActionResolve:void 0}),r(J,Be)}),u(()=>f(re,N==="FaceUp"?"表向き":"裏向き")),r(T,w)};h(le,T=>{_(N).length&&T(Me)})}r(B,ae)}),u(()=>{var B;f(W,(B=t().owner)==null?void 0:B.profile.name),f(K,t().cellType)}),r(Y,L)};h(b,Y=>{t().field.duel.view.infoBoardState==="CellInfo"&&Y(d)})}r(o,c),nt()}var Ys=n('<div class="duel_config_item svelte-y4u26k"><label class="toggle svelte-y4u26k"><input type="checkbox" class="svelte-y4u26k"></label> <span class="svelte-y4u26k"> </span></div>'),Bs=n('<div class="duel_config svelte-y4u26k"><div class="duel_config_title svelte-y4u26k">デュエル設定</div> <div class="duel_config_group svelte-y4u26k"><div class="duel_config_group_title svelte-y4u26k">チェーン設定</div> <!></div></div>');function Ns(o,i){st(i,!1);let t=Oe(i,"viewController",8),v=Oe(i,"userProfile",12);it();var _=Se(),c=O(_);{var b=d=>{var Y=Bs(),L=s(a(Y),2),x=s(a(L),2);ne(x,1,()=>Ja,oe,(l,W)=>{var H=Ys(),K=a(H),z=a(K),B=s(K,2),N=a(B);u(()=>f(N,Qa[e(W)])),Za(z,()=>v().chainConfig[e(W)],ae=>v(v().chainConfig[e(W)]=ae,!0)),he("change",z,()=>v().save()),r(l,H)}),r(d,Y)};h(c,d=>{t().infoBoardState==="Config"&&d(b)})}r(o,_),nt()}function Is(o,{from:i,to:t},v={}){var{delay:_=0,duration:c=w=>Math.sqrt(w)*120,easing:b=ia}=v,d=getComputedStyle(o),Y=d.transform==="none"?"":d.transform,[L,x]=d.transformOrigin.split(" ").map(parseFloat);L/=o.clientWidth,x/=o.clientHeight;var l=Us(o),W=o.clientWidth/t.width/l,H=o.clientHeight/t.height/l,K=i.left+i.width*L,z=i.top+i.height*x,B=t.left+t.width*L,N=t.top+t.height*x,ae=(K-B)*W,le=(z-N)*H,Me=i.width/t.width,T=i.height/t.height;return{delay:_,duration:typeof c=="function"?c(Math.sqrt(ae*ae+le*le)):c,easing:b,css:(w,V)=>{var re=V*ae,ke=V*le,J=w+V*Me,de=w+V*T;return`transform: ${Y} translate(${re}px, ${ke}px) scale(${J}, ${de});`}}}function Us(o){if("currentCSSZoom"in o)return o.currentCSSZoom;for(var i=o,t=1;i!==null;)t*=+getComputedStyle(i).zoom,i=i.parentElement;return t}var Fs=n('<div class="chain_number svelte-d2f52m"> </div>'),Hs=n('<div class="duel_card_row svelte-d2f52m"> </div>'),Ps=n('<div class="appendix svelte-d2f52m"> </div>'),Os=n('<div class="appendix_wrapper svelte-d2f52m"></div>'),Ls=n('<div><div><!> <div> </div> <div><!> <div class="duel_card_row svelte-d2f52m"><div> </div> <!></div></div></div></div>'),Rs=n("<div></div>");function Ws(o,i){st(i,!1);let t=Oe(i,"duel",8),v=Oe(i,"position",8,"left");const _=-100,c=()=>v()==="left"?-100:100;let b=ye([]),d=Promise.resolve(),Y=Promise.resolve();const L=1e3,x=500,l=400,W=K=>{const z={...K};z.isKnown=K.chainBlockInfo.action.entity.controller.duelistType==="Player"||K.chainBlockInfo.action.entity.face==="FaceUp",z.chainBlockInfo.onStateChange.append(B=>{if(B==="done"||B==="failed"||B==="nagated")return d=d.then(async()=>{const N=new Date().getTime()-z.chainBlockInfo.wasSpawnedAt.getTime();N<L&&await Mt(L-N),$(b,e(b).filter(ae=>ae.seq!==z.seq)),await Mt(x+l)}).then(),"RemoveMe";$(b,e(b))}),Y=Y.then(async()=>{$(b,[z,...e(b)].sort((B,N)=>er.isSameChain(B.clock,N.clock)&&B.chainBlockInfo.action.isWithChainBlock&&N.chainBlockInfo.action.isWithChainBlock?N.clock.totalProcSeq-B.clock.totalProcSeq:B.clock.totalProcSeq-N.clock.totalProcSeq)),await Mt(300)}),d=d.then(()=>Mt(1e3))};t().chainBlockLog.onInsert.append(W),it();var H=Rs();ne(H,13,()=>e(b),K=>K.seq,(K,z)=>{var B=Ls();const N=ve(()=>{const{activator:E,action:ee,appendix:_e}=e(z).chainBlockInfo;return{activator:E,action:ee,appendix:_e}});var ae=a(B),le=a(ae);{var Me=E=>{var ee=Fs(),_e=a(ee);u(()=>f(_e,`チェーン：${e(z).chainBlockInfo.chainNumber??""}`)),r(E,ee)};h(le,E=>{e(z).chainBlockInfo.chainNumber&&E(Me)})}var T=s(le,2),w=a(T),V=s(T,2),re=a(V);{var ke=E=>{var ee=Hs(),_e=a(ee);u(()=>f(_e,e(z).isKnown?e(N).action.entity.nm:"？？？")),r(E,ee)};h(re,E=>{(e(N).action.entity.entityType==="Card"||e(N).action.entity.entityType==="Token")&&E(ke)})}var J=s(re,2),de=a(J),Be=a(de),Le=s(de,2);{var M=E=>{var ee=Os();ne(ee,5,()=>e(N).appendix,oe,(_e,we)=>{var U=Ps(),A=a(U);u(()=>f(A,e(we))),r(_e,U)}),r(E,ee)};h(Le,E=>{e(N).appendix&&E(M)})}u((E,ee,_e)=>{Ee(B,`cut_in_row ${(!e(z).chainBlockInfo.chainNumber||e(z).chainBlockInfo.chainNumber===1?"cut_in_row_first":"")??""} svelte-d2f52m`),Ee(ae,`cut_in_item cut_in_item_${E??""} cut_in_item_${e(z).chainBlockInfo.state??""} svelte-d2f52m`),Ee(T,`duelist_name duelist_${E??""}_name svelte-d2f52m`),f(w,e(N).activator.profile.name),Ee(V,`duel_card duel_card_${E??""} ${ee??""} ${(e(z).isKnown?e(N).action.entity.origin.kind:"")??""} ${e(N).action.entity.entityType??""}  svelte-d2f52m`),f(Be,_e)},[()=>e(N).activator.seat.toLowerCase(),()=>e(z).isKnown?(e(N).action.entity.status.monsterCategories??[]).join(" "):"Token",()=>e(N).action.toString()],ve),te(3,ae,()=>wr,()=>new Date().getTime()-e(z).chainBlockInfo.wasSpawnedAt.getTime()<L?{x:c(),duration:l}:{y:_,duration:l}),tr(B,()=>Is,()=>({duration:x})),r(K,B)}),u(()=>Ee(H,`cut_in_container cut_in_container_${v()??""} svelte-d2f52m`)),r(o,H),nt()}const Ks=xr({duration:400});var zs=n('<div class="duel_desk_left v_flex svelte-1i63tk9"><!> <!> <!></div>'),Vs=n('<button class="duel_field_header_message svelte-1i63tk9"> </button> <div class="duel_field_header_buttons svelte-1i63tk9"><button class="svelte-1i63tk9">サレンダー</button></div>',1),Gs=n("<tr></tr>"),Xs=n('<table class="duel_field svelte-1i63tk9"><tbody class="svelte-1i63tk9"></tbody></table>'),Qs=n('<button class="svelte-1i63tk9">OK</button>'),Zs=n('<button class="svelte-1i63tk9">cancel</button>'),Js=n("<!> <!>",1),ei=n('<button class="svelte-1i63tk9"> </button>'),ti=n('<div style="text-align: left;"><!> <!> <!></div>'),ai=n('<div><!> <div class=" duel_desk_center v_flex svelte-1i63tk9"><div class="duel_field_header svelte-1i63tk9"><!></div> <div class="duel_field_body svelte-1i63tk9"><!></div> <div class="duel_field_footer svelte-1i63tk9"><!></div></div> <!></div> <div style="position:fixed;left:0;bottom:0"> </div> <!> <div><!></div>',1);function ri(o,i){st(i,!1);let t=Oe(i,"duel",12),v=Oe(i,"userProfile",8),_=ye(0),c=ye(0),b=ye([]),d=ye([]),Y=()=>{},L=ye([]),x=ye(),l=ye(),W=ye(()=>!1),H=ye(!1);const K=y=>{Y=y.resolve,$(L,y.dummyActionInfos.filter(g=>g.action.entity.entityType==="Duelist").filter(g=>g.action.entity.controller.seat==="Below")),$(x,void 0),$(l,void 0),$(d,[]),$(b,[]),$(H,!1),y.entitiesChoices&&($(x,y.entitiesChoices),$(W,()=>{var g;return((g=y.entitiesChoices)==null?void 0:g.validator(e(b)))??!1}),$(H,y.entitiesChoices.cancelable),e(x).selectables.every(g=>g.cell.isPlayFieldCell&&g.getIndexInCell()===0||g.cell.cellType==="Hand"&&g.controller.duelistType==="Player"||g.entityType==="Duelist")||t().view.modalController.entitySelector.show({title:t().view.message,position:"Middle",entitiesChoices:y.entitiesChoices,chainBlockInfos:y.chainBlockInfos,cancelable:y.entitiesChoices.cancelable}).then(g=>{Y({selectedEntities:g})})),y.cellsChoices&&($(l,y.cellsChoices),$(W,()=>{var g;return((g=y.cellsChoices)==null?void 0:g.validator(e(d)))??!1}),$(H,y.cellsChoices.cancelable))};t().view.onWaitStart.append(K);const z=()=>{Y=()=>{},$(l,void 0),$(x,void 0),$(d,[]),$(b,[]),$(W,()=>!1),$(H,!1)};t().view.onWaitEnd.append(z);let B=ye(void 0),N=ye("Normal");const ae=({card:y,mode:g})=>{$(B,y),$(N,g??(e(B)===y||e(N)==="Normal"?"Detail":"Normal"))};t().view.onShowCardEntity.append(ae);const le=()=>{t(t())};t().view.onDuelUpdate.append(le),t().log.onUpdate.append(le);const Me=()=>{e(x)&&e(x).validator(e(b))&&Y({selectedEntities:e(b)}),e(l)&&e(l).validator(e(d))&&Y({selectedCells:e(d)})},T=()=>{Y({})},w=y=>{Y({actionInfo:y})},V=()=>{Y({surrender:!0})};t().main();const re=()=>e(_)<=1400?"compact":"wide";it();var ke=ai(),J=O(ke),de=a(J);{var Be=y=>{var g=zs(),X=a(g);Ya(X,{get duelist(){return t().duelists.Above}});var me=s(X,2);Ts(me,{get entity(){return e(B)},get mode(){return e(N)}});var $e=s(me,2);Ya($e,{get duelist(){return t().duelists.Below}}),r(y,g)};h(de,y=>{re()==="wide"&&y(Be)})}var Le=s(de,2),M=a(Le),E=a(M);{var ee=y=>{var g=Vs(),X=O(g),me=a(X),$e=s(X,2),pe=a($e);u(()=>f(me,`[TURN:${t().clock.turn}][PHASE:${t().phase}] ${t().view.message}`)),he("click",X,()=>{t(t().view.infoBoardState="Log",!0)}),he("click",pe,V),r(y,g)};h(E,y=>{t().isEnded||y(ee)})}var _e=s(M,2),we=a(_e);{var U=y=>{var g=Xs(),X=a(g);ne(X,5,()=>t().field.cells,oe,(me,$e,pe)=>{var ce=Gs();Ee(ce,`${`duel_desk_row_${pe}`??""} svelte-1i63tk9`),ne(ce,5,()=>e($e),oe,(S,F,be)=>{Rr(S,{get view(){return t().view},row:pe,column:be,get selectedEntities(){return e(b)},set selectedEntities(De){$(b,De)},get selectedCells(){return e(d)},set selectedCells(De){$(d,De)},$$legacy:!0})}),r(me,ce)}),r(y,g)};h(we,y=>{t().clock.turn>0&&y(U)})}var A=s(_e,2),Q=a(A);{var G=y=>{var g=Js(),X=O(g);{var me=ce=>{var S=Qs();u(F=>S.disabled=F,[()=>!e(W)()],ve),he("click",S,Me),r(ce,S)};h(X,ce=>{((e(x)&&e(x).qty)??(e(l)&&e(l).qty)??9999)>1&&ce(me)})}var $e=s(X,2);{var pe=ce=>{var S=Zs();he("click",S,T),r(ce,S)};h($e,ce=>{e(H)&&ce(pe)})}r(y,g)},ue=y=>{var g=Se(),X=O(g);ne(X,1,()=>e(L),oe,(me,$e)=>{var pe=ei(),ce=a(pe);u(()=>f(ce,e($e).action.title)),he("click",pe,()=>w(e($e))),r(me,pe)}),r(y,g)};h(Q,y=>{e(x)&&e(x).selectables.length||e(l)&&e(l).selectables?y(G):y(ue,!1)})}var k=s(Le,2);{var Z=y=>{var g=ti(),X=a(g);es(X,{get log(){return t().log}});var me=s(X,2);As(me,{get cell(){return t().view.infoBoardCell}});var $e=s(me,2);Ns($e,{get userProfile(){return v()},get viewController(){return t().view}}),u(pe=>Ee(g,`duel_desk_right duel_desk_right_${pe??""}  svelte-1i63tk9`),[()=>t().view.infoBoardState.toLowerCase()],ve),te(3,g,()=>fe,()=>({duration:e(_)>1400?0:200,axis:"x"})),r(y,g)};h(k,y=>{(e(_)>1400||t().view.infoBoardState!=="Default")&&y(Z)})}var se=s(J,2),ie=a(se),p=s(se,2);ar(p,{get modalController(){return t().view.modalController}});var j=s(p,2),C=a(j);const P=ve(()=>re()==="wide"?"right":"left");Ws(C,{get duel(){return t()},get position(){return e(P)}}),u((y,g)=>{Ee(J,`flex duel_desk ${y??""}_mode svelte-1i63tk9`),f(ie,g),Ee(j,`cutin ${y??""}_mode svelte-1i63tk9`)},[re,()=>t().clock.toFullString()],ve),Kt("innerWidth",y=>$(_,y)),Kt("innerHeight",y=>$(c,y)),r(o,ke),nt()}var si=n('<div class="svelte-swqq02"><button class="button_style_reset svelte-swqq02" title="※shiftキー同時押しで一括外し">クリア</button></div>'),ii=n('<div class="svelte-swqq02"><button class="button_style_reset svelte-swqq02" title="※shiftキー同時押しで一括外し">クリア</button></div>'),ni=n("<div></div>"),li=n("<!> <!> <!> <!> <!>",1),oi=n('<span> </span> / <span style="display: inline-block;width:2rem;text-align: right;"> </span>',1),vi=n('<li class="deck_editor_item svelte-swqq02"><div role="listitem"><div class="svelte-swqq02"><div class="svelte-swqq02"> </div> <div style="display:flex" class="svelte-swqq02"><div class="svelte-swqq02"><!> <!> <!></div> <div style="flex-grow: 1; width:0.1rem" class="svelte-swqq02"></div> <div class="svelte-swqq02"><!></div></div></div></div> <button class="button_style_reset svelte-swqq02" title="※shiftキー同時押しで一括投入">+</button> <button class="button_style_reset svelte-swqq02" title="※shiftキー同時押しで一括外し">-</button></li>'),di=n('<div class="deck_editor_card_kind svelte-swqq02"><div class="deck_editor_card_kind_header svelte-swqq02"><div class="svelte-swqq02"> </div> <!></div> <ul class="svelte-swqq02"></ul></div>'),ci=n('<div class="deck_editor_deck_type svelte-swqq02"><div class="deck_editor_deck_type_header svelte-swqq02"><div class="svelte-swqq02"> </div> <!></div> <!></div>'),_i=n('<div class="svelte-swqq02">読み込み中...</div>'),ui=n('<div class="deck_editor_card_list svelte-swqq02"><!></div>');function Ba(o,i){st(i,!1);let t=Oe(i,"allCardInfos",8),v=Oe(i,"deckCardInfos",12),_=Oe(i,"mode",8),c=Oe(i,"onAttention",8),b=Oe(i,"searchCondition",8,void 0);const d={Deck:["Monster","Spell","Trap"],ExtraDeck:["Monster"]},Y={Deck:{Monster:[],Spell:[],Trap:[]},ExtraDeck:{Monster:[],Spell:[],Trap:[]}},L=T=>{var w;return(w=T.monsterCategories)!=null&&w.union(zt).length?"ExtraDeck":"Deck"},x=T=>{Object.values(Y).forEach(w=>Object.values(w).forEach(V=>V.reset())),T.filter(w=>w.isImplemented).filter(w=>w.kind!=="XyzMaterial").forEach(w=>{var re;if(w.kind==="XyzMaterial")return;const V=(re=w.monsterCategories)!=null&&re.union(zt).length?"ExtraDeck":"Deck";Y[V][w.kind].push(w)}),Object.values(Y).forEach(w=>Object.values(w).forEach(V=>V.sort(ra)))},l=_()==="List"?new Promise(T=>{x(t()),T()}):Promise.resolve(),W=()=>(_()==="Deck"&&(x(v()),$(B,v().length)),Y),H=(T,w,V)=>{v(v().filter(re=>L(re)!==w||re.kind!==V&&V))},K=(T,w)=>{try{if(T.ctrlKey){v().push(w);return}const V=v().filter(ke=>ke.name===w.name).length;if(V>2)return;const re=T.shiftKey?3-V:1;if(re<1)return;v().push(...Array(re).fill(w))}finally{v().sort(ra),v(v())}},z=(T,w)=>{let V=0;v(v().filter(re=>re.name!==w.name?!0:(V++,!T.shiftKey&&V>1))),v().sort(ra)};let B=ye(100);const N=()=>{e(B)>t().length+v().length||($(B,e(B)+10),Mt(100).then(N))};Mt(100).then(N);const ae=(T,w)=>{if(!b())return!0;if(!b().cardKinds.includes(T.kind)||b().name.trim().length&&[T.name,...T.nameTags??[],...T.textTags??[]].every(re=>!re.includes(b().name))||T.isForTest&&!b().others.includes("test")||T.isOldVersion&&!b().others.includes("oldVersion"))return!1;if(T.kind==="Monster")return T.attributes&&!b().monsterAttributes.union(T.attributes).length||T.types&&!b().monsterTypes.union(T.types).length||!T.monsterCategories?!1:T.monsterCategories.union(b().monsterCategories).length;if(T.kind==="Spell")return T.spellCategory&&b().spellCategories.includes(T.spellCategory);if(T.kind==="Trap")return T.trapCategory&&b().trapCategories.includes(T.trapCategory)};it();var le=ui(),Me=a(le);ht(Me,()=>l,T=>{var w=_i();r(T,w)},T=>{var w=Se();const V=ve(W);var re=O(w);ne(re,1,()=>sr,oe,(ke,J)=>{var de=ci();const Be=ve(()=>Object.values(e(V)[e(J)]).flatMap(U=>U));var Le=a(de),M=a(Le),E=a(M),ee=s(M,2);{var _e=U=>{var A=si(),Q=a(A);he("click",Q,G=>H(G,e(J),void 0)),r(U,A)};h(ee,U=>{_()==="Deck"&&e(Be).some(ae)&&U(_e)})}var we=s(Le,2);ne(we,1,()=>oa(e(V)[e(J)]).filter(U=>d[e(J)].includes(U)),oe,(U,A)=>{var Q=di();const G=ve(()=>e(V)[e(J)][e(A)].filter(ae));var ue=a(Q),k=a(ue),Z=a(k),se=s(k,2);{var ie=j=>{var C=ii(),P=a(C);he("click",P,y=>H(y,e(J),e(A))),r(j,C)};h(se,j=>{_()==="Deck"&&e(G).length&&j(ie)})}var p=s(ue,2);ne(p,5,()=>e(G),oe,(j,C,P)=>{var y=Se(),g=O(y);{var X=me=>{var $e=vi(),pe=a($e),ce=a(pe),S=a(ce),F=a(S),be=s(S,2),De=a(be),Re=a(De);{var qe=R=>{var xe=li(),Ye=O(xe);{var We=Ce=>{var Fe=rt();u(()=>f(Fe,`★${e(C).level??""}`)),r(Ce,Fe)};h(Ye,Ce=>{e(C).level&&Ce(We)})}var Ie=s(Ye,2);{var Ke=Ce=>{var Fe=rt();u(()=>f(Fe,`☆${e(C).rank??""}`)),r(Ce,Fe)};h(Ie,Ce=>{e(C).rank&&Ce(Ke)})}var vt=s(Ie,2);ne(vt,1,()=>e(C).attributes??[],oe,(Ce,Fe)=>{var je=ni();u(()=>Ee(je,`monster_attr ${e(Fe)??""} svelte-swqq02`)),r(Ce,je)});var dt=s(vt,2);ne(dt,1,()=>e(C).types??[],oe,(Ce,Fe)=>{var je=rt();u(()=>f(je,Xt[e(Fe)])),r(Ce,je)});var tt=s(dt,2);ne(tt,1,()=>e(C).monsterCategories??[],oe,(Ce,Fe)=>{var je=rt();u(()=>f(je,Qt[e(Fe)])),r(Ce,je)}),r(R,xe)};h(Re,R=>{e(C).kind==="Monster"&&R(qe)})}var Ae=s(Re,2);{var Ne=R=>{var xe=rt();u(()=>f(xe,`${Zt[e(C).spellCategory]??""}魔法`)),r(R,xe)};h(Ae,R=>{e(C).spellCategory!==void 0&&R(Ne)})}var ze=s(Ae,2);{var q=R=>{var xe=rt();u(()=>f(xe,`${Jt[e(C).trapCategory]??""}罠`)),r(R,xe)};h(ze,R=>{e(C).trapCategory!==void 0&&R(q)})}var D=s(De,4),m=a(D);{var I=R=>{var xe=oi(),Ye=O(xe),We=a(Ye),Ie=s(Ye,2),Ke=a(Ie);u(()=>{f(We,e(C).attack??"?"),f(Ke,e(C).defense??"?")}),r(R,xe)};h(m,R=>{e(C).kind==="Monster"&&R(I)})}var ge=s(pe,2),Te=s(ge,2);u(R=>{Ee(pe,`${R??""} svelte-swqq02`),f(F,e(C).name)},[()=>{var R,xe;return`deck_editor_card duel_card ${e(C).kind} ${(xe=(R=e(C))==null?void 0:R.monsterCategories)==null?void 0:xe.join(" ")} ${e(C).isImplemented?"is_implemented":"is_not_implemented"}`}],ve),he("mouseenter",pe,()=>c()(e(C))),he("click",ge,R=>K(R,e(C))),he("click",Te,R=>z(R,e(C))),r(me,$e)};h(g,me=>{P<e(B)&&me(X)})}r(j,y)}),u(()=>f(Z,`${Ia[e(A)]??""}（${e(G).length??""} / ${e(V)[e(J)][e(A)].length??""}枚）`)),r(U,Q)}),u(U=>f(E,`${rr[e(J)]??""}（${U??""} / ${e(Be).length??""}枚）`),[()=>e(Be).filter(ae).length],ve),r(ke,de)}),r(T,w)}),r(o,le),nt()}var fi=n('<div class="duel_card_info_row svelte-rccxcp" style="position:sticky; top:0;"><div class="svelte-rccxcp"> </div> <div class="svelte-rccxcp"> </div></div>'),pi=n('<div class="duel_card_info_row svelte-rccxcp"><div class="svelte-rccxcp"><pre class="description svelte-rccxcp"> </pre></div></div> <div class="duel_card_info_row svelte-rccxcp" style=" justify-content: space-between;"><div class="svelte-rccxcp"> </div> <div class="svelte-rccxcp"> </div></div>',1),gi=n('<div></div> <div class="svelte-rccxcp"> </div>',1),mi=n("<div> </div>"),bi=n("<div> </div>"),hi=n('<div class="duel_card_info_row svelte-rccxcp"><!> <!></div> <div class="duel_card_info_row svelte-rccxcp"></div>',1),yi=n('<div class="duel_card_row svelte-rccxcp"><div class="svelte-rccxcp"></div> <div class="svelte-rccxcp"> </div></div>'),ki=n('<div class="duel_card_row svelte-rccxcp"><div class="svelte-rccxcp"></div> <div class="svelte-rccxcp"> </div></div>'),wi=n('<div class="duel_card_info_row svelte-rccxcp"><div class="svelte-rccxcp">※エラッタ前カードです</div></div>'),xi=n('<div class="duel_card_info_row svelte-rccxcp"><div class="svelte-rccxcp">※テスト用カードです</div></div>'),Ci=n('<div class="duel_card_info_links svelte-rccxcp"><a target="_blank" rel="noopener noreferrer" title="遊戯王カードWiki" class="svelte-rccxcp">⇒遊戯王カードWiki</a> <a target="_blank" rel="noopener noreferrer" title="コナミカードデータベース" class="svelte-rccxcp"> </a></div>'),Di=n('<div><div class="duel_card_info_header svelte-rccxcp"><div class="duel_card_info_row svelte-rccxcp"><div class="svelte-rccxcp"> </div></div> <!></div> <div class="duel_card_info_body svelte-rccxcp"><!> <!> <div class="duel_card_info_row description svelte-rccxcp"><div class="svelte-rccxcp"><pre class="description svelte-rccxcp"> </pre></div></div> <!> <!></div></div>');function $i(o,i){st(i,!1);let t=Oe(i,"cardInfo",8,void 0);const v=()=>t()?bt[t().name]:void 0;it();var _=Se(),c=O(_);{var b=d=>{var Y=Di(),L=a(Y),x=a(L),l=a(x),W=a(l),H=s(x,2);{var K=M=>{var E=fi(),ee=a(E),_e=a(ee),we=s(ee,2),U=a(we);u((A,Q)=>{f(_e,A),f(U,Q)},[()=>"★".repeat(t().level||0),()=>"☆".repeat(t().rank||0)],ve),r(M,E)};h(H,M=>{t().kind==="Monster"&&M(K)})}var z=s(L,2),B=a(z);{var N=M=>{var E=pi(),ee=O(E),_e=a(ee),we=a(_e),U=a(we),A=s(ee,2),Q=a(A),G=a(Q),ue=s(Q,2),k=a(ue);u(()=>{f(U,bt[t().name].pendulumDescription),f(G,`◀ ${t().pendulumScaleL??""}`),f(k,`${t().pendulumScaleR??""} ▶`)}),r(M,E)};h(B,M=>{var E;(E=t().monsterCategories)!=null&&E.includes("Pendulum")&&M(N)})}var ae=s(B,2);{var le=M=>{var E=hi(),ee=O(E),_e=a(ee);{var we=G=>{var ue=gi(),k=O(ue),Z=s(k,2),se=a(Z);u(()=>{Ee(k,`monster_attr ${t().attributes[0]??""} svelte-rccxcp`),f(se,`${va[t().attributes[0]]??""}属性`)}),r(G,ue)};h(_e,G=>{t().attributes&&G(we)})}var U=s(_e,2);{var A=G=>{var ue=mi(),k=a(ue);u(()=>{Ee(ue,`monster_cat ${t().types[0]??""} svelte-rccxcp`),f(k,`${Xt[t().types[0]]??""}${da[t().types[0]]??""}族`)}),r(G,ue)};h(U,G=>{t().types&&G(A)})}var Q=s(ee,2);ne(Q,5,()=>t().monsterCategories??[],oe,(G,ue)=>{var k=bi(),Z=a(k);u(()=>{Ee(k,`monster_cat ${e(ue)??""} svelte-rccxcp`),f(Z,`${Qt[e(ue)]??""}${ca[e(ue)]??""}`)}),r(G,k)}),r(M,E)},Me=M=>{var E=Se(),ee=O(E);{var _e=U=>{var A=yi(),Q=s(a(A),2),G=a(Q);u(()=>f(G,`${Zt[t().spellCategory]??""}魔法`)),r(U,A)},we=U=>{var A=Se(),Q=O(A);{var G=ue=>{var k=ki(),Z=s(a(k),2),se=a(Z);u(()=>f(se,`${Jt[t().trapCategory]??""}罠`)),r(ue,k)};h(Q,ue=>{t().kind==="Trap"&&t().trapCategory&&ue(G)},!0)}r(U,A)};h(ee,U=>{t().kind==="Spell"&&t().spellCategory?U(_e):U(we,!1)},!0)}r(M,E)};h(ae,M=>{t().kind==="Monster"?M(le):M(Me,!1)})}var T=s(ae,2),w=a(T),V=a(w),re=a(V),ke=s(T,2);{var J=M=>{var E=wi();r(M,E)};h(ke,M=>{t().isOldVersion&&M(J)})}var de=s(ke,2);{var Be=M=>{var E=xi();r(M,E)},Le=M=>{var E=Ci(),ee=a(E),_e=s(ee,2),we=a(_e);u(U=>{pt(ee,"href",`https://yugioh-wiki.net/index.php?${t().wikiEncodedName}`),pt(_e,"href",U),f(we,`⇒${(t().cardId?"公式カードページ":"公式で検索")??""}`)},[()=>ir(t())],ve),r(M,E)};h(de,M=>{t().isForTest?M(Be):M(Le,!1)})}u((M,E)=>{Ee(Y,`duel_card duel_card_info ${t().kind??""} ${M??""} svelte-rccxcp`),f(W,t().name),f(re,E)},[()=>{var M;return(M=t().monsterCategories)==null?void 0:M.join(" ")},()=>{var M;return(M=v())==null?void 0:M.description}],ve),r(d,Y)};h(c,d=>{t()&&d(b)})}r(o,_),nt()}const Si={0:{aaa:"日",aaaa:"日曜日",ddd:"Sun",dddd:"Sunday"},1:{aaa:"月",aaaa:"月曜日",ddd:"Mon",dddd:"Monday"},2:{aaa:"火",aaaa:"火曜日",ddd:"Tue",dddd:"Tuesday"},3:{aaa:"水",aaaa:"水曜日",ddd:"Wed",dddd:"Wednesday"},4:{aaa:"木",aaaa:"木曜日",ddd:"Thu",dddd:"Thursday"},5:{aaa:"金",aaaa:"金曜日",ddd:"Fri",dddd:"Friday"},6:{aaa:"土",aaaa:"土曜日",ddd:"Sat",dddd:"Saturday"}};class Mi{constructor(){Ze(this,"DefaultSeparator1","/");Ze(this,"DefaultSeparator2"," ");Ze(this,"DefaultSeparator3",":");Ze(this,"createDate",i=>{if(!i)return;const t=new Date(i);if(!isNaN(t.getTime()))return t});Ze(this,"createDateOr",(i,t)=>this.createDate(i)||t||new Date);Ze(this,"truncateDate",i=>{const t=i||new Date;return new Date(t.getFullYear(),t.getMonth(),t.getDate())});Ze(this,"addDate",(i,t)=>{const v=this.createDateOr(i);return v.setDate(v.getDate()+t),v});Ze(this,"addMonth",(i,t)=>{const v=this.createDateOr(i);return v.setMonth(v.getMonth()+t),v});Ze(this,"addYear",(i,t)=>{const v=this.createDateOr(i);return v.setFullYear(v.getFullYear()+t),v});Ze(this,"getDayOfWeek",(i,t="dddd")=>{const v=this.createDate(i);return v?Si[v.getDay()][t]:""});Ze(this,"formatToYYYYMMDD",(i,t=this.DefaultSeparator1)=>{const v=this.createDate(i);if(!v)return"";const _=v.getFullYear().toString(),c=("0"+(v.getMonth()+1)).slice(-2),b=("0"+v.getDate()).slice(-2);return _+t+c+t+b});Ze(this,"formatToYYYYMM",(i,t=this.DefaultSeparator1)=>{const v=this.createDate(i);if(!v)return"";t||(t="");const _=v.getFullYear().toString(),c=("0"+(v.getMonth()+1)).slice(-2);return _+t+c});Ze(this,"formatToHHMMSS",(i,t=this.DefaultSeparator3)=>{const v=this.createDate(i);if(!v)return"";t||(t="");const _=v.getHours(),c=v.getMinutes(),b=v.getSeconds();return("0"+_).slice(-2)+t+("0"+c).slice(-2)+t+("0"+b).slice(-2)});Ze(this,"formatToHHMM",(i,t=this.DefaultSeparator3)=>{const v=this.createDate(i);if(!v)return"";t||(t="");const _=("0"+v.getHours()).slice(-2),c=("0"+v.getMinutes()).slice(-2);return _+t+c});Ze(this,"formatToYYYYMMDD_HHMM",(i,t=this.DefaultSeparator1,v=this.DefaultSeparator2,_=this.DefaultSeparator3)=>{const c=this.createDate(i);return c?this.formatToYYYYMMDD(c,t)+v+this.formatToHHMM(c,_):""});Ze(this,"formatToYYYYMMDD_HHMMSS",(i,t=this.DefaultSeparator1,v=this.DefaultSeparator2,_=this.DefaultSeparator3)=>{const c=this.createDate(i);return c?this.formatToYYYYMMDD(c,t)+v+this.formatToHHMMSS(c,_):""})}}const ct=new Mi;Date.prototype.truncateDate=function(){return ct.truncateDate(this)};Date.prototype.getCloneOr=function(o){return ct.createDateOr(this,o)};Date.prototype.addDate=function(o){return ct.addDate(this,o)};Date.prototype.addMonth=function(o){return ct.addDate(this,o)};Date.prototype.addYear=function(o){return ct.addDate(this,o)};Date.prototype.getDayOfWeek=function(o="dddd"){return ct.getDayOfWeek(this,o)};Date.prototype.formatToYYYYMM=function(o){return ct.formatToYYYYMM(this,o)};Date.prototype.formatToYYYYMMDD=function(o){return ct.formatToYYYYMMDD(this,o)};Date.prototype.formatToYYYYMMDD_HHMM=function(o,i,t){return ct.formatToYYYYMMDD_HHMM(this,o,i,t)};Date.prototype.formatToYYYYMMDD_HHMMSS=function(o,i,t){return ct.formatToYYYYMMDD_HHMMSS(this,o,i,t)};Date.prototype.formatToHHMM=function(o){return ct.formatToHHMM(this,o)};Date.prototype.formatToHHMMSS=function(o){return ct.formatToHHMMSS(this,o)};var Ti=n('<li class="deck_info_list_item svelte-2wdgc8"><div class="svelte-2wdgc8"> </div> <div class="svelte-2wdgc8"> </div> <div class="svelte-2wdgc8"> </div></li>'),ji=n('<ul class="deck_info_list svelte-2wdgc8"></ul>'),Ei=n('<label for="file_selector" class="upload_area svelte-2wdgc8" role="region" aria-label="ファイルアップロードエリア"><div class="upload_area_message svelte-2wdgc8">ここにファイルをドロップ</div> <div class="upload_area_footer svelte-2wdgc8"><input type="file" id="file_selector" name="file_selector" accept=".json" multiple></div></label>'),qi=n('<div slot="body" class="modal_body svelte-2wdgc8"><!></div>'),Ai=n('<button class="svelte-2wdgc8">追加</button> <button class="svelte-2wdgc8">削除して追加</button> <button class="svelte-2wdgc8">戻る</button>',1),Yi=n('<button class="svelte-2wdgc8">Cancel</button>'),Bi=n('<div slot="footer" class="modal_window_footer svelte-2wdgc8"><!></div>');function Ni(o,i){st(i,!1);let t=Oe(i,"eventHolder",8),v=Oe(i,"args",8),_=Oe(i,"resolve",8),c=ye(Promise.resolve([])),b=ye();const d=()=>{$(b,new DataTransfer().files),$(c,Promise.resolve([]))},Y=async H=>{H.preventDefault(),console.log("hoge",H)},L=async H=>{H.preventDefault(),H.dataTransfer&&l(H.dataTransfer.files)},x=()=>{l(e(b))},l=async H=>{if(!H.length)return;const K=[],z=[];for(const B of H)try{z.push(...await ft.createfromJson(B))}catch(N){N instanceof Error&&K.push(N.message)}if(K.length){console.log(...K);return}$(c,e(c).then(()=>z))},W=d;it(),nr(o,{get eventHolder(){return t()},get args(){return v()},$$slots:{body:(H,K)=>{var z=qi(),B=a(z);ht(B,()=>e(c),null,(N,ae)=>{var le=Se(),Me=O(le);{var T=V=>{var re=ji();ne(re,5,()=>e(ae),oe,(ke,J)=>{var de=Ti(),Be=a(de),Le=a(Be),M=s(Be,2),E=a(M),ee=s(M,2),_e=a(ee);u((we,U,A)=>{f(Le,e(J).name),f(E,`${we??""}
                /
                ${U??""}`),f(_e,`最終使用日時 ： ${A??""}`)},[()=>e(J).cardNames.filter(we=>v().mainCardNames.includes(we)).length,()=>e(J).cardNames.filter(we=>v().exCardNames.includes(we)).length,()=>e(J).lastUsedAt.formatToYYYYMMDD_HHMM("/"," ",":")],ve),r(ke,de)}),r(V,re)},w=V=>{var re=Ei(),ke=s(a(re),2),J=a(ke);lr(J,()=>e(b),de=>$(b,de)),he("change",J,x),he("cancel",J,W),he("drop",re,L),he("dragover",re,Y),r(V,re)};h(Me,V=>{e(ae).length?V(T):V(w,!1)})}r(N,le)}),r(H,z)},footer:(H,K)=>{var z=Bi(),B=a(z);ht(B,()=>e(c),null,(N,ae)=>{var le=Se(),Me=O(le);{var T=V=>{var re=Ai(),ke=O(re),J=s(ke,2),de=s(J,2);u(()=>{ke.disabled=e(ae).length===0,J.disabled=e(ae).length===0}),he("click",ke,()=>_()({deckInfos:e(ae),replaceAll:!1})),he("click",J,()=>_()({deckInfos:e(ae),replaceAll:!0})),he("click",de,W),r(V,re)},w=V=>{var re=Se(),ke=O(re);{var J=de=>{var Be=Yi();he("click",Be,()=>_()(void 0)),r(de,Be)};h(ke,de=>{v().cancelable&&de(J)},!0)}r(V,re)};h(Me,V=>{e(ae).length?V(T):V(w,!1)})}r(N,le)}),r(H,z)}}}),nt()}const Gt=class Gt extends vr{constructor(i,t){super(i,...Object.values(t))}};Ze(Gt,"createModalController",i=>{const t={deckUploader:new dr({title:"デッキ情報をアップロード",position:"Middle",cancelable:!1,mainCardNames:[],exCardNames:[]})};return Object.assign(new Gt(i,t),t)});let la=Gt;function Ii(o,i){st(i,!1);let t=Oe(i,"modalController",8);it(),or(o,{get modalController(){return t()},children:(v,_)=>{var c=Se(),b=O(c);{var d=Y=>{Ni(Y,{get eventHolder(){return t().eventHolder},get args(){return t().deckUploader.args},get resolve(){return t().deckUploader.resolve}})};h(b,Y=>{t().deckUploader.state==="Shown"&&Y(d)})}r(v,c)},$$slots:{default:!0}}),nt()}var Ui=n('<label><input type="checkbox"> </label>'),Fi=n('<label><input type="checkbox"> </label>'),Hi=n('<label><input type="checkbox"> <div style="display: inline-block;"></div> </label>'),Pi=n('<label><input type="checkbox"> </label>'),Oi=n('<div class="deck_editor_search_box_row svelte-1s1plv5"><div class="svelte-1s1plv5"><button class="search_condition_title black_button svelte-1s1plv5">モンスター</button></div> <div class="svelte-1s1plv5"></div></div> <div class="deck_editor_search_box_row svelte-1s1plv5"><div class="svelte-1s1plv5"><button class="search_condition_title black_button svelte-1s1plv5">属性</button></div> <div class="svelte-1s1plv5"></div></div> <div class="deck_editor_search_box_row svelte-1s1plv5"><div class="svelte-1s1plv5"><button class="search_condition_title black_button svelte-1s1plv5">種族</button></div> <div class="svelte-1s1plv5"></div></div>',1),Li=n('<label><input type="checkbox"> </label>'),Ri=n('<div class="deck_editor_search_box_row svelte-1s1plv5"><div class="svelte-1s1plv5"><button class="search_condition_title black_button svelte-1s1plv5">魔法</button></div> <div class="svelte-1s1plv5"></div></div>'),Wi=n('<label><input type="checkbox"> </label>'),Ki=n('<div class="deck_editor_search_box_row svelte-1s1plv5"><div class="svelte-1s1plv5"><button class="search_condition_title black_button svelte-1s1plv5">罠</button></div> <div class="svelte-1s1plv5"></div></div>'),zi=n('<label><input type="checkbox"> </label>'),Vi=n("<option> </option>"),Gi=n('<div class="svelte-1s1plv5"><a class="white_button svelte-1s1plv5" download="SVS_DeckInfos.json">ダウンロード</a></div>'),Xi=n('<div class="svelte-1s1plv5"></div>'),Qi=n('<div class="svelte-1s1plv5"><a class="white_button svelte-1s1plv5" download="SVS_DeckInfos.json">ダウンロード(一括)</a></div>'),Zi=n('<div class="svelte-1s1plv5"></div>'),Ji=n('<div class="deck_editor_body_right_header svelte-1s1plv5"><div class="deck_editor_body_right_header_row svelte-1s1plv5"><div class="svelte-1s1plv5">編集対象 <select></select></div> <div class="svelte-1s1plv5"></div> <div class="svelte-1s1plv5">新規名称 <input type="text"></div></div> <div class="deck_editor_body_right_header_row svelte-1s1plv5"></div> <div class="deck_editor_body_right_header_row svelte-1s1plv5"><div class="svelte-1s1plv5">基本操作</div> <div class="svelte-1s1plv5"><button class="white_button svelte-1s1plv5">デッキを保存</button></div> <div class="svelte-1s1plv5"></div> <div class="svelte-1s1plv5"><button class="white_button svelte-1s1plv5">デッキを複製</button></div> <div class="svelte-1s1plv5"><button class="white_button svelte-1s1plv5" title="shiftキー押下で確認メッセージスキップ">デッキを削除</button></div></div> <div class="deck_editor_body_right_header_row svelte-1s1plv5"><div class="svelte-1s1plv5">DL/UL</div> <!> <!> <div class="svelte-1s1plv5"><button class="white_button svelte-1s1plv5">アップロード</button></div></div></div> <!>',1),en=n("<div>デッキ情報読込中</div>"),tn=n('<div class="deck_editor svelte-1s1plv5"><div class="deck_editor_header"></div> <div class="deck_editor_body svelte-1s1plv5"><div class="deck_editor_body_left svelte-1s1plv5"><div role="contentinfo"><div class="deck_editor_search_box_header svelte-1s1plv5"><div>検索条件</div> <div><button class="white_button svelte-1s1plv5">条件クリア</button></div></div> <div class="deck_editor_search_box_row svelte-1s1plv5"><div class="svelte-1s1plv5">名称</div> <div class="svelte-1s1plv5"><input type="text" style="width:70%"> <button class="white_button svelte-1s1plv5">クリア</button> <span>※ルビには対応していません</span></div></div> <div class="deck_editor_search_box_row svelte-1s1plv5"><div class="svelte-1s1plv5"><button class="search_condition_title black_button svelte-1s1plv5">種類</button></div> <div class="svelte-1s1plv5"></div></div> <!> <!> <!> <div class="deck_editor_search_box_row svelte-1s1plv5"><div class="svelte-1s1plv5"><button class="search_condition_title black_button svelte-1s1plv5">その他</button></div> <div class="svelte-1s1plv5"></div></div></div> <!></div> <div class="deck_editor_body_center svelte-1s1plv5"><!></div> <div class="deck_editor_body_right svelte-1s1plv5"><!></div></div> <div class="footer svelte-1s1plv5"></div></div> <!>',1);function an(o,i){st(i,!1);const t=[],v=[],_=[],c=[],b=[],d=[],Y=[],L=la.createModalController({onDragStart:{append:()=>{},remove:()=>{}},onDragEnd:{append:()=>{},remove:()=>{}}}),x={name:"",cardKinds:wa.filter(q=>q!=="XyzMaterial"),monsterCategories:[...Sa],monsterAttributes:[...$a],monsterTypes:[...Da],spellCategories:[...Ca],trapCategories:[...xa],others:["test","oldVersion"]},l=ye(structuredClone(x));Pe(l,e(l).others=["oldVersion"]);let W=ye("SearchCondition");const H=async()=>{Pe(l,e(l).name=""),Pe(l,e(l).cardKinds=[]),Pe(l,e(l).monsterCategories=[]),Pe(l,e(l).monsterAttributes=[]),Pe(l,e(l).monsterTypes=[]),Pe(l,e(l).spellCategories=[]),Pe(l,e(l).trapCategories=[]),Pe(l,e(l).others=[])},K=async q=>{Array.isArray(e(l)[q])&&Array.isArray(x[q])&&Pe(l,e(l)[q]=e(l)[q].length?[]:[...x[q]])},z=(q,D,m)=>{Array.isArray(e(l)[D])&&Array.isArray(x[D])&&Pe(l,e(l)[D]=[m])},B=async()=>{const D=(await e(le)).find(m=>m.id===e(ae));D&&$(w,{...D,cardInfos:D.cardNames.map(m=>bt[m])})},N=()=>ft.getAllDeckInfo().then(q=>($(ae,(q.find(D=>D.lastUsedAt.getTime()===Math.max(...q.map(m=>m.lastUsedAt.getTime())))??q[0]).id),q));let ae=ye(-1),le=ye(N()),Me=ye(e(le).then(q=>ft.convertToObjectURL(q)));e(le).then(B);const T=()=>{$(le,N()),$(Me,e(le).then(q=>ft.convertToObjectURL(q))),B()};let w=ye({id:-Number.MAX_VALUE,name:"",description:"",lastUsedAt:new Date,cardInfos:[]}),V=ye(bt.ゾンビーノ);const re=q=>{$(W,"CardDetail"),$(V,q)},ke=async()=>{const D=(await e(le)).find(m=>m.id===e(ae));if(!D)throw new Error("illegal state");return D},J=async()=>{const q=await ke();await q.saveDeckInfo({...q,name:e(w).name,cardNames:e(w).cardInfos.map(D=>D.name),lastUsedAt:new Date}),T()},de=async()=>{(await ft.createNewDeck(`デッキ_${new Date().formatToYYYYMMDD_HHMMSS("","","")}`,`コピー日時：${new Date().formatToYYYYMMDD_HHMMSS("-"," ",":")}`,e(w).cardInfos.map(D=>D.name))).saveDeckInfo(),T()},Be=async q=>{const D=await ke();!q.shiftKey&&!confirm(`デッキ【${D.name}】を削除します。
よろしいですか？`)||(await D.delete(),T())},Le=async()=>{const q=await L.deckUploader.show({title:"デッキ情報アップロード",position:"Middle",cancelable:!0,mainCardNames:Object.values(bt).filter(m=>{var I;return!((I=m.monsterCategories)!=null&&I.union(zt).length)}).map(m=>m.name),exCardNames:Object.values(bt).filter(m=>{var I;return(I=m.monsterCategories)==null?void 0:I.union(zt).length}).map(m=>m.name)});if(!q)return;const D=[];if(q.replaceAll){if(!confirm(`既存デッキ情報を全て削除し、アップロードしたファイルに置き換えます。
よろしいですか？`))return;D.push(...(await e(le)).map(m=>m.id))}await Promise.all(q.deckInfos.map(m=>ft.createNewDeck(m.name,m.description,m.cardNames,m.lastUsedAt))),D.length&&await Promise.all(D.map(ft.remove)),T()};it();var M=tn(),E=O(M),ee=s(a(E),2),_e=a(ee),we=a(_e),U=a(we),A=s(a(U),2),Q=a(A),G=s(U,2),ue=s(a(G),2),k=a(ue),Z=s(k,2),se=s(G,2),ie=a(se),p=a(ie),j=s(ie,2);ne(j,5,()=>wa.filter(q=>q!=="XyzMaterial"),oe,(q,D)=>{var m=Ui(),I=a(m),ge,Te=s(I);u(()=>{ge!==(ge=e(D))&&(I.value=(I.__value=e(D))==null?"":e(D)),f(Te,` ${Ia[e(D)]??""}`)}),Dt(t,[],I,()=>(e(D),e(l).cardKinds),R=>Pe(l,e(l).cardKinds=R)),r(q,m)});var C=s(se,2);{var P=q=>{var D=Oi(),m=O(D),I=a(m),ge=a(I),Te=s(I,2);ne(Te,5,()=>Sa,oe,(tt,Ce)=>{var Fe=Fi(),je=a(Fe),Xe,Je=s(je);u(()=>{Xe!==(Xe=e(Ce))&&(je.value=(je.__value=e(Ce))==null?"":e(Ce)),f(Je,` ${Qt[e(Ce)]??""}${ca[e(Ce)]??""}`)}),Dt(v,[],je,()=>(e(Ce),e(l).monsterCategories),lt=>Pe(l,e(l).monsterCategories=lt)),r(tt,Fe)});var R=s(m,2),xe=a(R),Ye=a(xe),We=s(xe,2);ne(We,5,()=>$a,oe,(tt,Ce)=>{var Fe=Hi(),je=a(Fe),Xe,Je=s(je,2),lt=s(Je);u(()=>{Xe!==(Xe=e(Ce))&&(je.value=(je.__value=e(Ce))==null?"":e(Ce)),Ee(Je,`monster_attr ${e(Ce)??""} svelte-1s1plv5`),f(lt,` ${va[e(Ce)]??""}`)}),Dt(_,[],je,()=>(e(Ce),e(l).monsterAttributes),yt=>Pe(l,e(l).monsterAttributes=yt)),r(tt,Fe)});var Ie=s(R,2),Ke=a(Ie),vt=a(Ke),dt=s(Ke,2);ne(dt,5,()=>Da,oe,(tt,Ce)=>{var Fe=Pi(),je=a(Fe),Xe,Je=s(je);u(()=>{Xe!==(Xe=e(Ce))&&(je.value=(je.__value=e(Ce))==null?"":e(Ce)),f(Je,` ${Xt[e(Ce)]??""}
                  ${da[e(Ce)]??""}`)}),Dt(c,[],je,()=>(e(Ce),e(l).monsterTypes),lt=>Pe(l,e(l).monsterTypes=lt)),he("dblclick",Fe,lt=>z(lt,"monsterTypes",e(Ce))),r(tt,Fe)}),he("click",ge,()=>K("monsterCategories")),te(3,m,()=>fe,()=>({delay:0,duration:100})),he("click",Ye,()=>K("monsterAttributes")),te(3,R,()=>fe,()=>({delay:0,duration:100})),he("click",vt,()=>K("monsterTypes")),te(3,Ie,()=>fe,()=>({delay:0,duration:100})),r(q,D)};h(C,q=>{e(l).cardKinds.includes("Monster")&&q(P)})}var y=s(C,2);{var g=q=>{var D=Ri(),m=a(D),I=a(m),ge=s(m,2);ne(ge,5,()=>Ca,oe,(Te,R)=>{var xe=Li(),Ye=a(xe),We,Ie=s(Ye);u(()=>{We!==(We=e(R))&&(Ye.value=(Ye.__value=e(R))==null?"":e(R)),f(Ie,` ${Zt[e(R)]??""}`)}),Dt(b,[],Ye,()=>(e(R),e(l).spellCategories),Ke=>Pe(l,e(l).spellCategories=Ke)),r(Te,xe)}),he("click",I,()=>K("spellCategories")),te(3,D,()=>fe,()=>({delay:0,duration:100})),r(q,D)};h(y,q=>{e(l).cardKinds.includes("Spell")&&q(g)})}var X=s(y,2);{var me=q=>{var D=Ki(),m=a(D),I=a(m),ge=s(m,2);ne(ge,5,()=>xa,oe,(Te,R)=>{var xe=Wi(),Ye=a(xe),We,Ie=s(Ye);u(()=>{We!==(We=e(R))&&(Ye.value=(Ye.__value=e(R))==null?"":e(R)),f(Ie,` ${Jt[e(R)]??""}`)}),Dt(d,[],Ye,()=>(e(R),e(l).trapCategories),Ke=>Pe(l,e(l).trapCategories=Ke)),r(Te,xe)}),he("click",I,()=>K("trapCategories")),te(3,D,()=>fe,()=>({delay:0,duration:100})),r(q,D)};h(X,q=>{e(l).cardKinds.includes("Trap")&&q(me)})}var $e=s(X,2),pe=a($e),ce=a(pe),S=s(pe,2);ne(S,4,()=>[{key:"test",text:"テスト用カードを表示する"},{key:"oldVersion",text:"エラッタ前カードを表示する"}],oe,(q,D)=>{var m=zi(),I=a(m),ge,Te=s(I);u(()=>{ge!==(ge=D.key)&&(I.value=(I.__value=D.key)==null?"":D.key),f(Te,` ${D.text??""}`)}),Dt(Y,[],I,()=>(D.key,e(l).others),R=>Pe(l,e(l).others=R)),r(q,m)});var F=s(we,2);$i(F,{get cardInfo(){return e(V)}});var be=s(_e,2),De=a(be);const Re=ve(()=>Object.values(bt));Ba(De,{mode:"List",get allCardInfos(){return e(Re)},onAttention:re,get searchCondition(){return e(l)},get deckCardInfos(){return e(w).cardInfos},set deckCardInfos(q){Pe(w,e(w).cardInfos=q)},$$legacy:!0});var qe=s(be,2),Ae=a(qe);ht(Ae,()=>e(le),q=>{var D=en();r(q,D)},(q,D)=>{var m=Ji(),I=O(m),ge=a(I),Te=a(ge),R=s(a(Te));u(()=>{e(ae),At(()=>{e(D)})}),ne(R,5,()=>e(D),oe,(Ve,Ue)=>{var He=Vi(),Ge={},Qe=a(He);u(()=>{Ge!==(Ge=e(Ue).id)&&(He.value=(He.__value=e(Ue).id)==null?"":e(Ue).id),f(Qe,e(Ue).name)}),r(Ve,He)});var xe=s(Te,4),Ye=s(a(xe)),We=s(ge,4),Ie=s(a(We),2),Ke=a(Ie),vt=s(Ie,4),dt=a(vt),tt=s(vt,2),Ce=a(tt),Fe=s(We,2),je=s(a(Fe),2);ht(je,ke,Ve=>{var Ue=Xi();r(Ve,Ue)},(Ve,Ue)=>{var He=Gi(),Ge=a(He);u(Qe=>pt(Ge,"href",Qe),[()=>ft.convertToObjectURL([e(Ue)])],ve),r(Ve,He)});var Xe=s(je,2);ht(Xe,()=>e(Me),Ve=>{var Ue=Zi();r(Ve,Ue)},(Ve,Ue)=>{var He=Qi(),Ge=a(He);u(()=>pt(Ge,"href",e(Ue))),r(Ve,He)});var Je=s(Xe,2),lt=a(Je),yt=s(I,2);Ba(yt,{mode:"Deck",allCardInfos:[],onAttention:re,get deckCardInfos(){return e(w).cardInfos},set deckCardInfos(Ve){Pe(w,e(w).cardInfos=Ve)},$$legacy:!0}),Yt(R,()=>e(ae),Ve=>$(ae,Ve)),he("change",R,B),sa(Ye,()=>e(w).name,Ve=>Pe(w,e(w).name=Ve)),he("click",Ke,J),he("click",dt,de),he("click",Ce,Be),he("click",lt,Le),r(q,m)});var Ne=s(ee,2);Ne.textContent=`実装済カード${cr+Ma}枚（内、効果のないモンスター${Ma??""}枚）`;var ze=s(E,2);Ii(ze,{modalController:L}),u(()=>Ee(we,`deck_editor_search_box ${(e(W)==="SearchCondition"?"":"minimum")??""} svelte-1s1plv5`)),he("click",Q,H),sa(k,()=>e(l).name,q=>Pe(l,e(l).name=q)),he("click",Z,()=>Pe(l,e(l).name="")),he("click",p,()=>K("cardKinds")),he("click",ce,()=>K("others")),te(3,$e,()=>fe,()=>({delay:0,duration:100})),he("mouseenter",we,()=>$(W,"SearchCondition")),r(o,M),nt()}String.prototype.format=(o,...i)=>{for(const[t,v]of i.entries()){const _=new RegExp(`\\{${t}\\}`,"g");o=o.replace(_,v)}return o};String.prototype.toSnakeCase=function(){return this.split(/(?=[A-Z])/).join("_").toLowerCase()};const rn=["TblDeckHeader","TblDeckDetail","TblDuelistProfile"],sn=3;var nn=n('<input class="game_mode_radio svelte-abgng1" type="radio" name="game_mode"> <label> </label>',1),ln=n('<option class="svelte-abgng1"> </option>'),on=n('<option class="svelte-abgng1"> </option>'),vn=n('<option class="svelte-abgng1"> </option>'),dn=n('<tr class="config_row svelte-abgng1"><td class="svelte-abgng1"><div class="svelte-abgng1"><label for="npc_deck_selector" class="config_row_label deck_selector svelte-abgng1">デッキ：</label></div></td><td class="svelte-abgng1"><div class="svelte-abgng1"><select id="npc_deck_selector" class="deck_selector svelte-abgng1"><option class="svelte-abgng1">デフォルト</option><!></select></div></td></tr>'),cn=n('<option class="svelte-abgng1"> </option>'),_n=n('<tr class="config_row svelte-abgng1"><td class="svelte-abgng1"><div class="svelte-abgng1"><label for="npc_selector" class="config_row_label npc_selector svelte-abgng1">対戦相手：</label></div></td><td class="svelte-abgng1"><div class="svelte-abgng1"><select id="npc_selector" class="npc_selector svelte-abgng1"></select> <div class="svelte-abgng1"> </div></div></td></tr> <!> <tr class="config_row svelte-abgng1"><td class="svelte-abgng1"><div class="svelte-abgng1"><label for="npc_selector" class="config_row_label npc_selector svelte-abgng1">先攻後攻：</label></div></td><td class="svelte-abgng1"><div class="svelte-abgng1"><select id="npc_selector" class="npc_selector svelte-abgng1"></select></div></td></tr>',1),un=n('<option class="svelte-abgng1"> </option>'),fn=n('<tr class="config_row svelte-abgng1"><td class="svelte-abgng1"><div class="svelte-abgng1"><label for="difficulty_selector" class="config_row_label difficulty_selector svelte-abgng1">難易度：</label></div></td><td class="svelte-abgng1"><div class="svelte-abgng1"><select id="difficulty_selector" class="difficulty_selector svelte-abgng1"></select></div></td></tr>'),pn=n('<tr class="config_row svelte-abgng1"><td class="svelte-abgng1"><div class="svelte-abgng1"><label class="config_row_label svelte-abgng1" for="game_mode_radio_preset">ゲームモード：</label></div></td><td class="svelte-abgng1"><div class="svelte-abgng1"></div></td></tr> <tr class="config_row svelte-abgng1"><td class="svelte-abgng1"><div class="svelte-abgng1"><label for="deck_selector" class="config_row_label deck_selector svelte-abgng1">デッキ：</label></div></td><td class="svelte-abgng1"><div class="svelte-abgng1"><select id="deck_selector" class="deck_selector svelte-abgng1"></select></div></td></tr> <!> <tr><td colspan="2" class="svelte-abgng1"><div><button class="btn svelte-abgng1">duel start!</button></div></td></tr>',1),gn=n('<tr><td colspan="2" class="svelte-abgng1"><div>デッキ情報の読み込み、もしくは作成中...</div></td></tr>'),mn=n('<tr><td colspan="2" class="svelte-abgng1"><div><button class="btn svelte-abgng1">deck edit</button></div></td></tr>'),bn=n('<tr class="config_row svelte-abgng1"><td class="svelte-abgng1"><div class="svelte-abgng1"><label for="duelist_name" class="config_row_label duelist_name svelte-abgng1">名前：</label></div></td><td class="svelte-abgng1"><div class="svelte-abgng1"><input id="duelist_name" class="duelist_name svelte-abgng1" type="text"></div></td></tr> <!> <!>',1),hn=n('<tr><td colspan="2" class="svelte-abgng1"><div>デュエリスト情報の読み込み、もしくは作成中...</div></td></tr>'),yn=n('<div class="app_body svelte-abgng1"><table class="config_table svelte-abgng1"><tbody><!></tbody></table></div>'),kn=n('<div class="result_title result_win svelte-abgng1">YOU WIN</div>'),wn=n('<div class="result_title result_lose svelte-abgng1">YOU LOSE</div>'),xn=n('<div class="result_title result_draw svelte-abgng1">DRAW</div>'),Cn=n('<div class="twitter_share_button_wrapper svelte-abgng1"><a rel="nofollow" target="_blank" class="twitter_share_button svelte-abgng1">X(twitter)でシェアする</a></div>'),Dn=n('<div class="result svelte-abgng1"><!> <div class="reason_of_end svelte-abgng1"> </div> <!> <div class="svelte-abgng1"><button class="white_button svelte-abgng1">TOPへ戻る</button></div></div>'),$n=n('<main style="flex-direction: column; display :flex" class="svelte-abgng1"><div class="link link_left svelte-abgng1"><a href="https://github.com/Setta238/stk_ygo_svelte" target="_blank" rel="noopener noreferrer" title="repository" class="svelte-abgng1">repository</a> <a href="https://x.com/ninja_no" target="_blank" rel="noopener noreferrer" title="repository" class="svelte-abgng1">X(Twitter)</a> <a href="https://posfie.com/@ninja_no/p/Lx7FLj3" target="_blank" rel="noopener noreferrer" title="posfie" class="svelte-abgng1">posfie(toggeter)</a></div> <div class="link link_right svelte-abgng1"><a class="a_button svelte-abgng1" role="button" tabindex="0">TOPへ戻る</a> <a href="/stk_ygo_svelte/note.html" target="_blank" rel="noopener noreferrer" title="repository" class="svelte-abgng1">現時点とこの先のこと</a></div> <!> <div class="debug_info svelte-abgng1"><span class="svelte-abgng1"> </span> <span class="user_agent_info svelte-abgng1"> </span> <span class="screen_info svelte-abgng1"> </span></div> <!></main>');function Sn(o,i){st(i,!1);const t=new _r("stk_ygo_svelte",sn,rn);let v=ye(0),_=ye(0),c=ye(),b=ye("FtkChallenge"),d=ye("None"),Y=ye(0),L=ye(""),x=ye(void 0);const l="https://setta238.github.io/stk_ygo_svelte/",W="遊戯王deそりてあ",H="ninja_no",K=ur.getOrCreateNew(t).then(p=>($(b,Ta.includes(p.previousGameMode)?p.previousGameMode:"FtkChallenge"),Be(p.previousNpcId),p)),z=p=>{var C;const j=p.find(P=>P.lastUsedAt.getTime()===Math.max(...p.map(y=>y.lastUsedAt.getTime())))??p[0];$(Y,j.id),e(b)==="FtkChallenge"&&j.deckType!=="Preset"&&$(Y,((C=$t.find(P=>P.deckType==="Preset"))==null?void 0:C.id)??e(Y))};let B=ye(ft.getAllDeckInfo(t).then(p=>(Promise.all(p.filter(j=>!j.lastUsedAt).map(j=>{j.saveDeckInfo()})),z(p),p)));const N=async()=>{const p=e(Y);let j=(await e(B)).find(P=>P.id===p)??(await le()).find(P=>P.id===p);j&&await j.updateTimestamp();let C=j;if(C||(C=$t.find(P=>P.id===p)),!C)throw new Error("illegal state");return C},ae=async()=>{(await K).save({previousGameMode:e(b)})},le=()=>($(B,ft.getAllDeckInfo(t).then(p=>(z(p),p))),e(B)),Me=async()=>{(await e(B)).length||(await ft.prepareSampleDeck(),le())},T=async()=>{await Promise.all([ae(),Me()]);const p=await N(),j=await K;let C=qt.find(g=>g.id===Number.MIN_SAFE_INTEGER)??qt[0],P=$t.find(g=>g.id===Number.MIN_SAFE_INTEGER)??$t[0],y="PlayFirst";e(b)==="FtkChallenge"?C=qt.filter(g=>g.npcType==="FtkChallenge").find(g=>g.difficulty===j.previousDifficulty)??C:e(b)==="Free"&&(C=qt.find(g=>g.id===j.previousNpcId)??C,P=$t.slice(-1)[0],y=j.previousStartMode),C.npcType!=="FtkChallenge"&&j.previousNpcDeckId>-1?P=(await e(B)).find(g=>g.id===j.previousNpcDeckId)??P:P=$t.find(g=>g.id===C.id)??P,$(c,new pr(j,"Player",p,[],C,"NPC",P,[],y)),e(c).onDuelEnd.append(()=>($(c,e(c)),"RemoveMe"))},w=async()=>{await Promise.all([ae(),Me()]),$(d,"DeckEdit")},V=async p=>{await ae(),p.key==="Enter"&&!p.repeat&&(await K).save()},re=()=>{$(B,le()),$(c,void 0),$(d,"None")};let ke=Date.now();const J=p=>{Date.now()-ke<200||(ke=Date.now(),$(b,p),le())},de=p=>{Be(Number(p.currentTarget.value))},Be=p=>{var j;$(x,qt.find(C=>C.id===p)),$(L,((j=e(x))==null?void 0:j.description)??"")};Me(),it();var Le=$n(),M=s(a(Le),2),E=a(M),ee=s(M,2);{var _e=p=>{var j=Se(),C=O(j);ht(C,()=>K,null,(P,y)=>{ri(P,{get duel(){return e(c)},get userProfile(){return e(y)}})}),r(p,j)},we=p=>{var j=Se(),C=O(j);{var P=g=>{an(g,{})},y=g=>{var X=yn(),me=a(X),$e=a(me),pe=a($e);ht(pe,()=>K,ce=>{var S=hn();r(ce,S)},(ce,S)=>{var F=bn(),be=O(F),De=a(be),Re=a(De),qe=s(De),Ae=a(qe),Ne=a(Ae),ze=s(be,2);ht(ze,()=>e(B),m=>{var I=gn();r(m,I)},(m,I)=>{var ge=pn(),Te=O(ge),R=a(Te),xe=a(R),Ye=s(R),We=a(Ye);ne(We,5,()=>Ta,oe,(Ue,He)=>{var Ge=nn(),Qe=O(Ge),_t=s(Qe,2),kt=a(_t);u(gt=>{pt(Qe,"id",`game_mode_radio_${gt??""}`),gr(Qe,e(He)),mr(Qe,e(b)===e(He)),Ee(_t,`game_mode_tab_label game_mode_tab_${gt??""} svelte-abgng1`),pt(_t,"for",`game_mode_radio_${gt??""}`),f(kt,e(He))},[()=>e(He).toLowerCase()],ve),he("change",Qe,()=>J(e(He))),r(Ue,Ge)});var Ie=s(Te,2),Ke=a(Ie),vt=a(Ke),dt=s(Ke),tt=a(dt),Ce=a(tt);u(()=>{e(Y),At(()=>{e(b),e(I)})}),ne(Ce,5,()=>e(b)==="FtkChallenge"?$t.filter(Ue=>Ue.deckType==="Preset"):e(I),oe,(Ue,He)=>{var Ge=ln(),Qe={},_t=a(Ge);u(()=>{Qe!==(Qe=e(He).id)&&(Ge.value=(Ge.__value=e(He).id)==null?"":e(He).id),f(_t,e(He).name)}),r(Ue,Ge)});var Fe=s(Ie,2);{var je=Ue=>{var He=_n(),Ge=O(He),Qe=a(Ge),_t=a(Qe),kt=s(Qe),gt=a(kt),jt=a(gt);u(()=>{e(S),At(()=>{})}),ne(jt,5,()=>qt,oe,(ut,et)=>{var ot=on(),Ct={},Et=a(ot);u(()=>{Ct!==(Ct=e(et).id)&&(ot.value=(ot.__value=e(et).id)==null?"":e(et).id),f(Et,e(et).name)}),r(ut,ot)});var Ht=s(jt,2),Pt=a(Ht),Nt=s(Ge,2);{var It=ut=>{var et=dn(),ot=a(et),Ct=a(ot),Et=s(ot),ga=a(Et),ma=a(ga);u(()=>{e(S),At(()=>{e(I)})});var ea=a(ma);ea.value=(ea.__value=Number.MIN_SAFE_INTEGER)==null?"":Number.MIN_SAFE_INTEGER;var Ua=s(ea);ne(Ua,1,()=>e(I),oe,(ta,Rt)=>{var Wt=vn(),ba={},Fa=a(Wt);u(()=>{ba!==(ba=e(Rt).id)&&(Wt.value=(Wt.__value=e(Rt).id)==null?"":e(Rt).id),f(Fa,e(Rt).name)}),r(ta,Wt)}),te(3,Ct,()=>fe,()=>({duration:200})),te(3,ot,()=>fe,()=>({duration:200})),Yt(ma,()=>e(S).previousNpcDeckId,ta=>e(S).previousNpcDeckId=ta),te(3,ga,()=>fe,()=>({duration:200})),te(3,Et,()=>fe,()=>({duration:200})),te(3,et,()=>fe,()=>({duration:200})),r(ut,et)};h(Nt,ut=>{var et;((et=e(x))==null?void 0:et.npcType)!=="FtkChallenge"&&ut(It)})}var xt=s(Nt,2),wt=a(xt),Ot=a(wt),Lt=s(wt),fa=a(Lt),pa=a(fa);u(()=>{e(S),At(()=>{})}),ne(pa,5,()=>oa(ja),oe,(ut,et)=>{var ot=cn(),Ct={},Et=a(ot);u(()=>{Ct!==(Ct=e(et))&&(ot.value=(ot.__value=e(et))==null?"":e(et)),f(Et,ja[e(et)])}),r(ut,ot)}),u(()=>f(Pt,`※${e(L)??""}`)),te(3,_t,()=>fe,()=>({duration:200})),te(3,Qe,()=>fe,()=>({duration:200})),he("change",jt,de),Yt(jt,()=>e(S).previousNpcId,ut=>e(S).previousNpcId=ut),te(3,gt,()=>fe,()=>({duration:200})),te(3,kt,()=>fe,()=>({duration:200})),te(3,Ge,()=>fe,()=>({duration:200})),te(3,Ot,()=>fe,()=>({duration:200})),te(3,wt,()=>fe,()=>({duration:200})),Yt(pa,()=>e(S).previousStartMode,ut=>e(S).previousStartMode=ut),te(3,fa,()=>fe,()=>({duration:200})),te(3,Lt,()=>fe,()=>({duration:200})),te(3,xt,()=>fe,()=>({duration:200})),r(Ue,He)},Xe=Ue=>{var He=Se(),Ge=O(He);{var Qe=_t=>{var kt=fn(),gt=a(kt),jt=a(gt),Ht=s(gt),Pt=a(Ht),Nt=a(Pt);u(()=>{e(S),At(()=>{})}),ne(Nt,5,()=>br,oe,(It,xt)=>{var wt=un(),Ot={},Lt=a(wt);u(()=>{Ot!==(Ot=e(xt))&&(wt.value=(wt.__value=e(xt))==null?"":e(xt)),f(Lt,e(xt))}),r(It,wt)}),te(3,jt,()=>fe,()=>({duration:200})),te(3,gt,()=>fe,()=>({duration:200})),Yt(Nt,()=>e(S).previousDifficulty,It=>e(S).previousDifficulty=It),te(3,Pt,()=>fe,()=>({duration:200})),te(3,Ht,()=>fe,()=>({duration:200})),te(3,kt,()=>fe,()=>({duration:200})),r(_t,kt)};h(Ge,_t=>{e(b)==="FtkChallenge"&&_t(Qe)},!0)}r(Ue,He)};h(Fe,Ue=>{e(b)==="Free"?Ue(je):Ue(Xe,!1)})}var Je=s(Fe,2),lt=a(Je),yt=a(lt),Ve=a(yt);te(3,xe,()=>fe,()=>({duration:200})),te(3,R,()=>fe,()=>({duration:200})),te(3,We,()=>fe,()=>({duration:200})),te(3,Ye,()=>fe,()=>({duration:200})),te(3,Te,()=>fe,()=>({duration:200})),te(3,vt,()=>fe,()=>({duration:200})),te(3,Ke,()=>fe,()=>({duration:200})),Yt(Ce,()=>e(Y),Ue=>$(Y,Ue)),te(3,tt,()=>fe,()=>({duration:200})),te(3,dt,()=>fe,()=>({duration:200})),te(3,Ie,()=>fe,()=>({duration:200})),he("click",Ve,T),te(3,yt,()=>fe,()=>({duration:200})),r(m,ge)});var q=s(ze,2);{var D=m=>{var I=mn(),ge=a(I),Te=a(ge),R=a(Te);he("click",R,w),te(3,Te,()=>fe,()=>({duration:200})),te(3,ge,()=>fe,()=>({duration:200})),te(3,I,()=>fe,()=>({duration:200})),r(m,I)};h(q,m=>{e(b)==="Free"&&m(D)})}te(3,Re,()=>fe,()=>({duration:200})),te(3,De,()=>fe,()=>({duration:200})),sa(Ne,()=>e(S).name,m=>e(S).name=m),he("keypress",Ne,V),te(3,Ae,()=>fe,()=>({duration:200})),te(3,qe,()=>fe,()=>({duration:200})),te(3,be,()=>fe,()=>({duration:200})),r(ce,F)}),r(g,X)};h(C,g=>{e(d)==="DeckEdit"?g(P):g(y,!1)},!0)}r(p,j)};h(ee,p=>{e(c)?p(_e):p(we,!1)})}var U=s(ee,2),A=a(U),Q=a(A),G=s(A,2),ue=a(G),k=s(G,2),Z=a(k),se=s(U,2);{var ie=p=>{var j=Dn(),C=a(j);{var P=S=>{var F=Se(),be=O(F);{var De=qe=>{var Ae=kn();r(qe,Ae)},Re=qe=>{var Ae=Se(),Ne=O(Ae);{var ze=q=>{var D=wn();r(q,D)};h(Ne,q=>{e(c).winner.seat==="Above"&&q(ze)},!0)}r(qe,Ae)};h(be,qe=>{e(c).winner.seat==="Below"?qe(De):qe(Re,!1)})}r(S,F)},y=S=>{var F=xn();r(S,F)};h(C,S=>{e(c).winner?S(P):S(y,!1)})}var g=s(C,2),X=a(g),me=s(g,2);{var $e=S=>{var F=Cn(),be=a(F);u(()=>pt(be,"href",`https://x.com/share?url=${l}&text=${e(c).twitterShareText??""}&hashtags=${W}&via=${H}`)),r(S,F)};h(me,S=>{e(c).twitterShareText&&S($e)})}var pe=s(me,2),ce=a(pe);u(()=>f(X,e(c).reasonOfEnd)),he("click",ce,re),te(3,j,()=>kr,()=>({delay:200,duration:200})),r(p,j)};h(se,p=>{e(c)&&e(c).isEnded&&p(ie)})}u(()=>{f(Q,"build at: 20251214_162154"),f(ue,fr.text),f(Z,`w:${e(v)??""}px h:${e(_)??""}px`)}),Kt("innerWidth",p=>$(v,p)),Kt("innerHeight",p=>$(_,p)),he("click",E,re),r(o,Le),nt()}hr(Sn,{target:document.getElementById("app")});
