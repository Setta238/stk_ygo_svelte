var Za=Object.defineProperty;var Ma=_=>{throw TypeError(_)};var er=(_,i,t)=>i in _?Za(_,i,{enumerable:!0,configurable:!0,writable:!0,value:t}):_[i]=t;var st=(_,i,t)=>er(_,typeof i!="symbol"?i+"":i,t),Ea=(_,i,t)=>i.has(_)||Ma("Cannot "+t);var ft=(_,i,t)=>(Ea(_,i,"read from private field"),t?t.call(_):i.get(_)),oa=(_,i,t)=>i.has(_)?Ma("Cannot add the same private member more than once"):i instanceof WeakSet?i.add(_):i.set(_,t),ha=(_,i,t,v)=>(Ea(_,i,"write to private field"),v?v.call(_,t):i.set(_,t),t);import{s as Ba,r as tr,a as C,b as ar,l as rr,g as e,d as Ka,p as ct,c as Pe,m as _e,i as _t,t as n,e as a,f as w,h as p,j as ve,k as Me,n as it,o as Z,q as r,u as ut,v as xe,D as sr,w as je,x as H,y as s,z as ce,A as Wt,B as ne,C as me,E as g,F as ir,G as Qe,H as Kt,I as or,J as nr,K as zt,L as ba,M as za,N as la,O as ka,P as na,Q as pt,R as ja,S as ma,T as $a,U as va,V as ca,W as Va,X as ga,Y as ya,Z as lr,_ as vr,$ as dr,a0 as cr,a1 as _r,a2 as ur,a3 as fr,a4 as _a,a5 as Xa,a6 as pr,a7 as ea,a8 as xa,a9 as mr,aa as Ga,ab as ua,ac as At,ad as gr,ae as yr,af as ta,ag as hr,ah as Dt,ai as br,aj as kr,ak as xr,al as Aa,am as La,an as Ya,ao as Ua,ap as Na,aq as Pa,ar as wr,as as Ft,at as Ht,au as Mt,av as Cr,aw as Zt,ax as Dr,ay as jr,az as qa,aA as Jt,aB as Rt,aC as $r,aD as Sr,aE as Ha,aF as Tr,aG as Mr,aH as Er}from"../chunk/entity_proc_20260118_170636.js";import"../chunk/json_20260118_170636.js";(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const m of document.querySelectorAll('link[rel="modulepreload"]'))v(m);new MutationObserver(m=>{for(const c of m)if(c.type==="childList")for(const u of c.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&v(u)}).observe(document,{childList:!0,subtree:!0});function t(m){const c={};return m.integrity&&(c.integrity=m.integrity),m.referrerPolicy&&(c.referrerPolicy=m.referrerPolicy),m.crossOrigin==="use-credentials"?c.credentials="include":m.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function v(m){if(m.ep)return;m.ep=!0;const c=t(m);fetch(m.href,c)}})();const Br=_=>_;function Sa(_){const i=_-1;return i*i*i+1}function Fa(_){const i=typeof _=="string"&&_.match(/^\s*(-?[\d.]+)([^\s]*)\s*$/);return i?[parseFloat(i[1]),i[2]||"px"]:[_,"px"]}function Ar(_,{delay:i=0,duration:t=400,easing:v=Br}={}){const m=+getComputedStyle(_).opacity;return{delay:i,duration:t,easing:v,css:c=>`opacity: ${c*m}`}}function Lr(_,{delay:i=0,duration:t=400,easing:v=Sa,x:m=0,y:c=0,opacity:u=0}={}){const d=getComputedStyle(_),U=+d.opacity,W=d.transform==="none"?"":d.transform,$=U*(1-u),[D,o]=Fa(m),[L,Q]=Fa(c);return{delay:i,duration:t,easing:v,css:(G,P)=>`
			transform: ${W} translate(${(1-G)*D}${o}, ${(1-G)*L}${Q});
			opacity: ${U-$*P}`}}function we(_,{delay:i=0,duration:t=400,easing:v=Sa,axis:m="y"}={}){const c=getComputedStyle(_),u=+c.opacity,d=m==="y"?"height":"width",U=parseFloat(c[d]),W=m==="y"?["top","bottom"]:["left","right"],$=W.map(E=>`${E[0].toUpperCase()}${E.slice(1)}`),D=parseFloat(c[`padding${$[0]}`]),o=parseFloat(c[`padding${$[1]}`]),L=parseFloat(c[`margin${$[0]}`]),Q=parseFloat(c[`margin${$[1]}`]),G=parseFloat(c[`border${$[0]}Width`]),P=parseFloat(c[`border${$[1]}Width`]);return{delay:i,duration:t,easing:v,css:E=>`overflow: hidden;opacity: ${Math.min(E*20,1)*u};${d}: ${E*U}px;padding-${W[0]}: ${E*D}px;padding-${W[1]}: ${E*o}px;margin-${W[0]}: ${E*L}px;margin-${W[1]}: ${E*Q}px;border-${W[0]}-width: ${E*G}px;border-${W[1]}-width: ${E*P}px;min-${d}: 0`}}function Ia(_,i){for(const t in i)_[t]=i[t];return _}function Yr({fallback:_,...i}){const t=new Map,v=new Map;function m(u,d,U){const{delay:W=0,duration:$=N=>Math.sqrt(N)*30,easing:D=Sa}=Ia(Ia({},i),U),o=u.getBoundingClientRect(),L=d.getBoundingClientRect(),Q=o.left-L.left,G=o.top-L.top,P=o.width/L.width,E=o.height/L.height,ee=Math.sqrt(Q*Q+G*G),ue=getComputedStyle(d),B=ue.transform==="none"?"":ue.transform,b=+ue.opacity;return{delay:W,duration:typeof $=="function"?$(ee):$,easing:D,css:(N,oe)=>`
			   opacity: ${N*b};
			   transform-origin: top left;
			   transform: ${B} translate(${oe*Q}px,${oe*G}px) scale(${N+(1-N)*P}, ${N+(1-N)*E});
		   `}}function c(u,d,U){return(W,$)=>(u.set($.key,W),()=>{if(d.has($.key)){const D=d.get($.key);return d.delete($.key),m(D,W,$)}return u.delete($.key),_&&_(W,$,U)})}return[c(v,t,!1),c(t,v,!0)]}function Oa(_){return Object.prototype.toString.call(_)==="[object Date]"}function Ur(_){return _}function wa(_){const i=_-1;return i*i*i+1}function Ca(_,i){if(_===i||_!==_)return()=>_;const t=typeof _;if(t!==typeof i||Array.isArray(_)!==Array.isArray(i))throw new Error("Cannot interpolate values of different type");if(Array.isArray(_)){const v=i.map((m,c)=>Ca(_[c],m));return m=>v.map(c=>c(m))}if(t==="object"){if(!_||!i)throw new Error("Object cannot be null");if(Oa(_)&&Oa(i)){const c=_.getTime(),d=i.getTime()-c;return U=>new Date(c+U*d)}const v=Object.keys(i),m={};return v.forEach(c=>{m[c]=Ca(_[c],i[c])}),c=>{const u={};return v.forEach(d=>{u[d]=m[d](c)}),u}}if(t==="number"){const v=i-_;return m=>_+m*v}return()=>i}var Lt,aa,da,Vt;const Ta=class Ta{constructor(i,t={}){oa(this,Lt,Ba(void 0));oa(this,aa,Ba(void 0));oa(this,da);oa(this,Vt,null);ft(this,Lt).v=ft(this,aa).v=i,ha(this,da,t)}static of(i,t){const v=new Ta(i(),t);return tr(()=>{v.set(i())}),v}set(i,t){var D;C(ft(this,aa),i);let{delay:v=0,duration:m=400,easing:c=Ur,interpolate:u=Ca}={...ft(this,da),...t};if(m===0)return(D=ft(this,Vt))==null||D.abort(),C(ft(this,Lt),i),Promise.resolve();const d=ar.now()+v;let U,W=!1,$=ft(this,Vt);return ha(this,Vt,rr(o=>{if(o<d)return!0;if(!W){W=!0;const Q=ft(this,Lt).v;U=u(Q,i),typeof m=="function"&&(m=m(Q,i)),$==null||$.abort()}const L=o-d;return L>m?(C(ft(this,Lt),i),!1):(C(ft(this,Lt),U(c(L/m))),!0)})),ft(this,Vt).promise}get current(){return e(ft(this,Lt))}get target(){return e(ft(this,aa))}set target(i){this.set(i)}};Lt=new WeakMap,aa=new WeakMap,da=new WeakMap,Vt=new WeakMap;let fa=Ta;var Nr=n('<div class="phase_display svelte-1boxe40"><span class="svelte-1boxe40"> </span> </div>'),Pr=n('<div class="lifepoint_display svelte-1boxe40"><div class="svelte-1boxe40"> </div> <div class="svelte-1boxe40"> </div></div>'),qr=(_,i,t)=>i(e(t)),Hr=n('<div class="svelte-1boxe40"><button class="phase_button svelte-1boxe40"> </button></div>'),Fr=n("<div><!></div>"),Ir=n('<div class="svelte-1boxe40"><!></div>'),Or=n("<div><!></div>"),Rr=n('<div class="config_button_wrapper svelte-1boxe40"><button id="config_button" class="svelte-1boxe40">⚙</button></div>'),Wr=n("<!> <!> <!> <!>",1),Kr=n('<div style="position: absolute;" class="card_animation_receiver svelte-1boxe40"><!></div>'),zr=n('<div style="position: absolute; top:0rem" class="svelte-1boxe40">｛効果対象｝</div>'),Vr=n('<!> <div style="position: absolute; display:flex;justify-content: center;"><!></div>',1),Xr=n(" <!> 】",1),Gr=n('<div style="position: absolute; bottom:0rem" class="svelte-1boxe40"> <!></div>'),Qr=n("<!> <!>",1),Jr=n('<div class="badge svelte-1boxe40"> </div>'),Zr=n('<div class="card_animation_receiver svelte-1boxe40"><!></div>'),es=n("<!> <!> <!> <!>",1),ts=n('<td><div role="listitem"><!></div></td>');function as(_,i){ct(i,!1);let t=Pe(i,"view",12),v=Pe(i,"row",8),m=Pe(i,"column",8),c=Pe(i,"selectedEntities",28,()=>[]),u=Pe(i,"selectedCells",28,()=>[]),d=_e(t().getCell(v(),m())),U=_e(new fa(e(d).field.duel.duelists.Above.lp,{duration:400,easing:wa})),W=_e(new fa(e(d).field.duel.duelists.Below.lp,{duration:400,easing:wa}));const $=()=>{C(d,t().getCell(v(),m())),xe(U,e(U).target=e(d).field.duel.duelists.Above.lp),xe(W,e(W).target=e(d).field.duel.duelists.Below.lp)};e(d).onUpdate.append($),t().onDuelUpdate.append($),t().modalController.onUpdate.append($);let D,o=_e([]),L=()=>console.log("hoge"),Q,G=_e([]),P=_e(!1),E=_e(!1),ee=!1;const ue=k=>{var j,A;C(ie,[]),c().reset(),D=k.activator,L=k.resolve,C(o,k.dummyActionInfos),C(G,k.chainBlockInfos.flatMap(I=>I.selectedEntities).getDistinct()),Q=k.entitiesChoices,C(P,!1),C(E,((j=k.cellsChoices)==null?void 0:j.selectables.includes(e(d)))??!1),ee=e(E)&&((A=k.cellsChoices)==null?void 0:A.qty)===1,$()};t().onWaitStart.append(ue);const B=()=>{D=void 0,C(o,[]),L=()=>{console.log("hoge")},Q=void 0,C(G,[]),C(P,!1),C(E,!1),ee=!1};t().onWaitEnd.append(B);let b=_e(!1),N=[];const oe=k=>{N=k.filter(j=>j.dests.includes(e(d))),C(b,N.length>0),$()},Ce=()=>{N=[],C(b,!1),$()};t().onDragStart.append(oe),t().onDragEnd.append(Ce);const[he,fe]=pi;let ie=_e([]);const Ee=k=>{if(D=void 0,e(d)===k.to||e(d).entities.includes(k.entity)){C(ie,[...e(ie),k]);const j=k.resolve;C(d,e(d)),setTimeout(()=>{C(ie,e(ie).filter(A=>A!==k)),k.count++,k.count>1&&j()},600)}};t().onAnimation.append(Ee);const De=k=>{L({phaseChange:k})},F=()=>e(d).isStackCell&&e(d).entities.flatMap(k=>k.actions).filter(k=>e(o).map(j=>j.action.seq).some(j=>j===k.seq)).length>0,K=k=>{var j;if(((j=k.target)==null?void 0:j.id)==="config_button"){t(t().infoBoardState="Config",!0),t().requireUpdate();return}if(t(t().infoBoardState="Default",!0),ee)L({selectedCells:[e(d)]});else if(e(E))C(P,!e(P)),u(e(P)?[...u(),e(d)]:u().filter(A=>A!==e(d)));else if(e(d).isStackCell){t(t().infoBoardState="CellInfo",!0),t(t().infoBoardCell=e(d),!0),t().requireUpdate();const A=e(d).entities.flatMap(O=>O.actions).map(O=>O.seq),I=e(o).filter(O=>A.includes(O.action.seq));if(I.length){if(!D)return;t().modalController.actionSelector.show({title:"カードを選択。",position:"Bottom",activator:D,dummyActionInfos:I,cancelable:!0}).then(O=>{O&&L({actionInfo:O})});return}}t().requireUpdate(),console.info(e(d),Te(...e(d).visibleEntities))},pe=k=>{k.preventDefault(),k.dataTransfer&&(k.dataTransfer.dropEffect="move")},se=k=>{k.preventDefault(),console.info("drop",k,e(b),N),k.dataTransfer&&(k.dataTransfer.dropEffect="move");try{if(e(b)&&N){if(N.length===1){const j=N[0];L({actionInfo:{...j,dest:e(d)}})}else if(N.length>1){if(!D)throw new sr("想定されない状態");e(d).field.duel.view.modalController.terminateAll(),e(d).field.duel.view.modalController.actionSelector.show({title:"選択",position:"Bottom",activator:D,dummyActionInfos:N.map(j=>({...j,dest:e(d)})),cancelable:!1}).then(j=>{L({actionInfo:j})})}}}finally{t().removeDraggingActions()}},Te=(...k)=>{if(t().waitMode==="Animation")return"Disabled";if(Q&&Q.selectables.find(A=>k.find(I=>A===I)))return"Selectable";if(!e(o)||e(o).length===0||t().waitMode!=="Free"||Object.values(t().modalController.modals).some(A=>A.state==="Shown"))return"Disabled";const j=e(o).filter(A=>k.includes(A.action.entity));return j.length===0?"Disabled":e(d).isStackCell||j[0].action.entity!==k[0]?"Clickable":j.some(A=>A.dests.length)?"Draggable":"Clickable"};_t();var M=ts(),S=a(M);S.__click=K;var q=a(S);{var X=k=>{var j=je(),A=H(j);{var I=O=>{var de=je(),T=H(de);{var x=f=>{var Y=Nr(),z=a(Y),ye=a(z),be=s(z,1,!0);p((le,ae)=>{g(ye,le),g(be,ae)},[()=>String(e(d).field.duel.clock.turn).padStart(2,"0"),()=>e(d).field.duel.phase.toUpperCase()],ve),r(f,Y)},l=f=>{var Y=je(),z=H(Y);{var ye=le=>{var ae=Pr(),V=a(ae),re=a(V),$e=s(V,2),Fe=a($e);p((He,Ie)=>{g(re,He),g(Fe,Ie)},[()=>Math.floor(e(U).current),()=>Math.floor(e(W).current)],ve),r(le,ae)},be=le=>{var ae=je(),V=H(ae);{var re=$e=>{var Fe=je(),He=H(Fe);{var Ie=Le=>{var Ve=je(),ot=H(Ve);{var Ae=ke=>{var Be=je(),Ye=H(Be);ce(Ye,1,()=>t().duel.nextPhaseList,me,(Oe,tt)=>{var ze=Hr(),Je=a(ze);Je.__click=[qr,De,tt];var jt=a(Je);p(vt=>g(jt,vt),[()=>e(tt).toUpperCase()],ve),r(Oe,ze)}),r(ke,Be)};w(ot,ke=>{t().duel.isEnded||ke(Ae)})}r(Le,Ve)};w(He,Le=>{t().waitMode==="Free"&&Le(Ie)})}r($e,Fe)};w(V,$e=>{e(d).column===5&&$e(re)},!0)}r(le,ae)};w(z,le=>{e(d).column===3?le(ye):le(be,!1)},!0)}r(f,Y)};w(T,f=>{e(d).column===1?f(x):f(l,!1)})}r(O,de)};w(A,O=>{e(d).row===3&&O(I)})}r(k,j)},te=k=>{var j=je(),A=H(j);{var I=de=>{var T=Wr();const x=ve(()=>e(ie).find(ae=>ae.to===e(d)));var l=H(T);{var f=ae=>{var V=Fr(),re=a(V);Wt(re,{get entity(){return e(x).entity},state:"Disabled",dummyActionInfos:[],cardActionResolve:void 0}),p(()=>Me(V,`card_animation_receiver ${e(d).cellType??""} svelte-1boxe40`)),ne(1,V,()=>fe,()=>({key:e(x).entity.seq})),r(ae,V)};w(l,ae=>{e(x)&&e(x).index==="Top"&&ae(f)})}var Y=s(l,2);ce(Y,1,()=>e(d).visibleEntities,me,(ae,V)=>{var re=je(),$e=H(re);{var Fe=He=>{var Ie=Ir(),Le=a(Ie);const Ve=ve(()=>Te(e(V))),ot=ve(()=>e(o).filter(Ae=>Ae.action.entity===e(V)));Wt(Le,{get entity(){return e(V)},get state(){return e(Ve)},get dummyActionInfos(){return e(ot)},cardActionResolve:void 0,get selectedList(){return c()},set selectedList(Ae){c(Ae)},$$legacy:!0}),ne(2,Ie,()=>he,()=>({key:e(V).seq})),r(He,Ie)};w($e,He=>{e(ie).every(Ie=>Ie.entity.seq!==e(V).seq)&&He(Fe)})}r(ae,re)});var z=s(Y,2);{var ye=ae=>{var V=Or(),re=a(V);Wt(re,{get entity(){return e(x).entity},state:"Disabled",dummyActionInfos:[],cardActionResolve:void 0}),p(()=>Me(V,`card_animation_receiver ${e(d).cellType??""} svelte-1boxe40`)),ne(1,V,()=>fe,()=>({key:e(x).entity.seq})),r(ae,V)};w(z,ae=>{e(x)&&e(x).index!=="Top"&&ae(ye)})}var be=s(z,2);{var le=ae=>{var V=Rr();r(ae,V)};w(be,ae=>{e(d).owner.seat==="Below"&&ae(le)})}r(de,T)},O=de=>{var T=es();const x=ve(()=>e(ie).find(V=>V.to===e(d)));var l=H(T);{var f=V=>{var re=Kr(),$e=a(re);Wt($e,{get entity(){return e(x).entity},state:"Disabled",dummyActionInfos:[],cardActionResolve:void 0}),ne(1,re,()=>fe,()=>({key:e(x).entity.seq})),r(V,re)};w(l,V=>{e(x)&&e(x).index!=="Top"&&V(f)})}var Y=s(l,2);{var z=V=>{var re=Qr(),$e=H(re);ce($e,1,()=>e(d).visibleEntities.map((Ie,Le)=>({index:Le,entity:Ie})).toReversed(),me,(Ie,Le)=>{var Ve=je(),ot=H(Ve);{var Ae=ke=>{var Be=Vr();const Ye=ve(()=>!e(d).isStackCell&&e(Le).index===0?Te(...e(d).visibleEntities):void 0);var Oe=H(Be);{var tt=vt=>{var $t=zr();r(vt,$t)};w(Oe,vt=>{e(G).includes(e(Le).entity)&&vt(tt)})}var ze=s(Oe,2),Je=a(ze);const jt=ve(()=>e(Le).index===0?e(o).filter(vt=>e(d).visibleEntities.includes(vt.action.entity)):void 0);Wt(Je,{get entity(){return e(Le).entity},get state(){return e(Ye)},get dummyActionInfos(){return e(jt)},cardActionResolve:void 0,get selectedList(){return c()},set selectedList(vt){c(vt)},$$legacy:!0}),p(()=>Me(ze,`duel_card_wrapper ${(e(Le).entity.exist?"duel_card_wrapper_exists":"")??""} svelte-1boxe40`)),ne(2,ze,()=>he,()=>({key:e(Le).entity.seq})),r(ke,Be)};w(ot,ke=>{e(ie).every(Be=>Be.entity.seq!==e(Le).entity.seq)&&ke(Ae)})}r(Ie,Ve)});var Fe=s($e,2);{var He=Ie=>{var Le=Gr(),Ve=a(Le),ot=s(Ve);ce(ot,1,()=>Kt(e(d).visibleEntities[0].status.maxCounterQty),me,(Ae,ke)=>{var Be=Xr(),Ye=H(Be),Oe=s(Ye);{var tt=ze=>{var Je=Qe();p(()=>g(Je,`/${e(d).visibleEntities[0].status.maxCounterQty[e(ke)]??""}`)),r(ze,Je)};w(Oe,ze=>{(e(d).visibleEntities[0].status.maxCounterQty[e(ke)]??9999)<100&&ze(tt)})}p((ze,Je)=>g(Ye,`【
              ${ze??""}${Je??""} `),[()=>ir(e(ke)),()=>e(d).visibleEntities[0].counterHolder.getQty(e(ke))],ve),r(Ae,Be)}),p(()=>g(Ve,`【${e(d).visibleEntities[0].battlePositionName??""}】 `)),r(Ie,Le)};w(Fe,Ie=>{e(d).visibleEntities[0].battlePosition&&Ie(He)})}r(V,re)};w(Y,V=>{e(d).visibleEntities.length>0&&V(z)})}var ye=s(Y,2);{var be=V=>{var re=Jr(),$e=a(re);p(()=>g($e,e(d).visibleEntities.length)),r(V,re)};w(ye,V=>{e(d).isStackCell&&V(be)})}var le=s(ye,2);{var ae=V=>{var re=Zr(),$e=a(re);Wt($e,{get entity(){return e(x).entity},state:"Disabled",dummyActionInfos:[],cardActionResolve:void 0}),ne(1,re,()=>fe,()=>({key:e(x).entity.seq})),r(V,re)};w(le,V=>{e(x)&&e(x).index==="Top"&&V(ae)})}r(de,T)};w(A,de=>{e(d).cellType==="Hand"?de(I):de(O,!1)},!0)}r(k,j)};w(q,k=>{e(d).isDisabledCell?k(X):k(te,!1)})}p(k=>{Me(M,`${`duel_field_cell duel_field_cell_${e(d).cellType} ${e(d).linkArrowSources.length===0?"":"duel_field_cell_linked"}`??""} svelte-1boxe40`),it(M,"colspan",e(d).cellType==="Hand"?7:1),Me(S,`${k??""} svelte-1boxe40`)},[()=>`duel_field_cell_inner_box ${e(d).cellType} ${e(b)?"can_accept_drop":""} ${F()?"can_action":""} ${e(P)?"is_selected":e(E)?"is_selectable":""} `],ve),Z("dragover",S,pe),Z("drop",S,se),r(_,M),ut()}Ka(["click"]);const rs=(_,i,t=void 0,v="!!!circular reference!!!")=>{let m=[];return JSON.stringify(_,(c,u)=>{if(typeof u=="object"){if(m.indexOf(u)>-1)return v;m.push(u)}let d=u;if(i&&(d=i(c,u)),typeof d=="function")return d.toString();if(d!==u&&typeof d=="object"){if(m.indexOf(d)>-1)return v;m.push(d)}return d},t)};var ss=n('<div class="title svelte-14z6bdh"> </div>'),is=n('<div class="title svelte-14z6bdh"> </div>'),os=n('<div class="duel_log_chain_number svelte-14z6bdh"> </div>'),ns=n('<div><a class="white_button" download="error_info.json">エラー情報ダウンロード</a></div>'),ls=n("<div><!> <!></div>"),vs=n('<div><div style="display: flex;    justify-content: space-between;"><div style=" white-space: nowrap;text-align: center;"> </div> <!></div> <!></div>'),ds=n("<div><!> <!></div>"),cs=n("<div><!> <!></div>"),_s=n('<div class="duel_log svelte-14z6bdh"><div class="duel_log_header svelte-14z6bdh"></div> <div class="duel_log_body svelte-14z6bdh"></div> <div class="duel_log_footer svelte-14z6bdh"></div></div>');function us(_,i){ct(i,!1);let t=_e(void 0),v=Pe(i,"log",8),m,c=_e([]);const u=()=>{const $=((m==null?void 0:m.seq)??-1)+1;v().records.slice($).forEach(D=>{if(!m){C(c,[[[[D]]]]),m=D;return}if(!e(c)[D.clock.turn]){xe(c,e(c)[D.clock.turn]=[[[D]]]),m=D;return}if(!e(c)[D.clock.turn][D.clock.phaseSeq]){xe(c,e(c)[D.clock.turn][D.clock.phaseSeq]=[[D]]),m=D;return}if(m.clock.chainSeq===D.clock.chainSeq&&m.clock.chainBlockSeq===D.clock.chainBlockSeq&&m.duelist===D.duelist){e(c)[D.clock.turn][D.clock.phaseSeq].slice(-1)[0].push(D),m=D;return}e(c)[D.clock.turn][D.clock.phaseSeq].push([D]),m=D}),C(c,e(c)),or().then(()=>e(t)&&e(t).scroll(0,e(t).clientHeight*990))};v().onUpdate.append(u),v().duel.view.onDuelUpdate.append(u),u(),_t();var d=je(),U=H(d);{var W=$=>{var D=_s(),o=s(a(D),2);ce(o,5,()=>e(c),me,(L,Q)=>{var G=cs(),P=a(G);{var E=ue=>{var B=ss(),b=a(B);p(()=>g(b,`ターン：${e(Q)[0][0][0].clock.turn??""}`)),r(ue,B)};w(P,ue=>{e(Q)[0][0][0].clock.turn>0&&ue(E)})}var ee=s(P,2);ce(ee,1,()=>e(Q),me,(ue,B)=>{var b=ds(),N=a(b);{var oe=he=>{var fe=is(),ie=a(fe);p(()=>g(ie,e(B)[0][0].clock.period.name)),r(he,fe)};w(N,he=>{e(B)[0][0].clock.turn>0&&he(oe)})}var Ce=s(N,2);ce(Ce,1,()=>e(B),me,(he,fe)=>{var ie=vs();const Ee=ve(()=>{var M;return((M=e(fe).find(S=>S.chainNumber!==void 0))==null?void 0:M.chainNumber)??0});var De=a(ie),F=a(De),K=a(F),pe=s(F,2);{var se=M=>{var S=os(),q=a(S);p(()=>g(q,`チェーン：${e(Ee)??""}`)),r(M,S)};w(pe,M=>{e(Ee)&&M(se)})}var Te=s(De,2);ce(Te,1,()=>e(fe),me,(M,S)=>{var q=ls(),X=a(q);{var te=I=>{var O=Qe();p(()=>g(O,e(S).text)),r(I,O)},k=I=>{var O=je(),de=H(O);{var T=l=>{var f=Qe();p((Y,z,ye)=>g(f,`移動：${Y??""} ${z??""} ⇒ ${ye??""}`),[()=>{var Y;return(Y=e(S).mainEntity)==null?void 0:Y.toString()},()=>{var Y;return(Y=e(S).from)==null?void 0:Y.toString()},()=>{var Y;return(Y=e(S).to)==null?void 0:Y.toString()}],ve),r(l,f)},x=l=>{var f=je(),Y=H(f);{var z=be=>{var le=Qe();p((ae,V)=>g(le,`生成：${ae??""} void ⇒ ${V??""}`),[()=>{var ae;return(ae=e(S).mainEntity)==null?void 0:ae.toString()},()=>{var ae;return(ae=e(S).to)==null?void 0:ae.toString()}],ve),r(be,le)},ye=be=>{var le=je(),ae=H(le);{var V=$e=>{var Fe=Qe();p((He,Ie)=>g(Fe,`消滅：${He??""} ${Ie??""} ⇒ void`),[()=>{var He;return(He=e(S).mainEntity)==null?void 0:He.toString()},()=>{var He;return(He=e(S).from)==null?void 0:He.toString()}],ve),r($e,Fe)},re=$e=>{var Fe=Qe();p(()=>g(Fe,e(S).text)),r($e,Fe)};w(ae,$e=>{e(S).type==="EntityDisappear"?$e(V):$e(re,!1)},!0)}r(be,le)};w(Y,be=>{e(S).type==="EntityAppear"?be(z):be(ye,!1)},!0)}r(l,f)};w(de,l=>{e(S).type==="EntityMove"?l(T):l(x,!1)},!0)}r(I,O)};w(X,I=>{e(S).type==="ChainBlockHeader"?I(te):I(k,!1)})}var j=s(X,2);{var A=I=>{var O=ns(),de=a(O);p(T=>it(de,"href",T),[()=>window.URL.createObjectURL(new Blob([rs(e(S).error,(T,x)=>["pool","bundles","duel"].includes(T)||typeof x=="function"?void 0:x,4)],{type:"text/plain"}))],ve),r(I,O)};w(j,I=>{e(S).error&&I(A)})}p(I=>Me(q,`duel_log_record duel_log_record_${I??""} svelte-14z6bdh`),[()=>e(S).type.toSnakeCase()],ve),r(M,q)}),p(()=>{var M,S,q;Me(ie,`duel_log_block_duelist duel_log_block_duelist_${((M=e(fe)[0].duelist)==null?void 0:M.seat)??"system"} svelte-14z6bdh`),Me(F,`duelist ${((S=e(fe)[0].duelist)==null?void 0:S.seat)??""} svelte-14z6bdh`),g(K,((q=e(fe)[0].duelist)==null?void 0:q.profile.name)||"SYSTEM")}),r(he,ie)}),p(()=>Me(b,`duel_log_block_phase duel_log_block_phase_${e(B)[0][0].clock.period.key??""} svelte-14z6bdh`)),r(ue,b)}),p(()=>Me(G,`duel_log_block_turn duel_log_block_turn_${e(Q)[0][0][0].clock.turn??""} svelte-14z6bdh`)),r(L,G)}),nr(o,L=>C(t,L),()=>e(t)),r($,D)};w(U,$=>{(v().duel.view.infoBoardState==="Log"||v().duel.view.infoBoardState==="Default")&&$(W)})}r(_,d),ut()}var fs=n("<div><div> </div> <div> </div></div>");function Ra(_,i){ct(i,!1);let t=Pe(i,"duelist",12),v=_e(0),m=_e();const c=async()=>{const o=t().lp-e(v);if(!e(m)||Math.abs(o)<10){C(v,t().lp),e(m)&&(e(m)(),C(m,void 0));return}C(v,e(v)+Math.floor(Math.random()*o)),await zt(100),c()},u=()=>{t(t()),!e(m)&&t().lp!==e(v)&&new Promise(o=>{C(m,o),Math.abs(t().lp-e(v)),c()})};t().duel.log.onUpdate.append(u),c(),_t();var d=fs(),U=a(d),W=a(U),$=s(U,2),D=a($);p(o=>{Me(d,`duelist duelist_${o??""} svelte-1sy3trd`),Me(U,`duelist_name duelist_${o??""}_name svelte-1sy3trd`),g(W,t().profile.name),Me($,`duelist_lp ${(e(m)?"vibration":"")??""} svelte-1sy3trd`),g(D,e(v))},[()=>t().seat.toLowerCase()],ve),r(_,d),ut()}const ps=(_,i,t)=>(i(i()!=="Detail"?"Detail":"Normal"),console.info(t()),!0),ms=(_,i,t)=>(i(i()!=="Debug"?"Debug":"Normal"),console.info(t()),!0);var gs=n('<div class="svelte-1uevs9j"> </div>'),ys=n('<div class="svelte-1uevs9j"> </div>'),hs=n('<div class="link_arrow_emoji svelte-1uevs9j"> </div>'),bs=n('<div class="duel_card_info_row svelte-1uevs9j" style=" justify-content: space-between;"><div class="svelte-1uevs9j"> </div> <div class="svelte-1uevs9j"> </div></div>'),ks=n('<div></div> <div class="svelte-1uevs9j"> </div>',1),xs=n("<div> </div>"),ws=n('<span class="svelte-1uevs9j">/</span> <div class="monster_defense svelte-1uevs9j"> </div>',1),Cs=n("<div> </div>"),Ds=n('<div class="duel_card_info_row svelte-1uevs9j"><!> <!> <div style="flex-grow: 1;" class="svelte-1uevs9j"></div> <div class="monster_attack svelte-1uevs9j"> </div> <!></div> <div class="duel_card_info_row svelte-1uevs9j"></div>',1),js=n('<div class="duel_card_row svelte-1uevs9j"><div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"> </div></div>'),$s=n('<div class="duel_card_row svelte-1uevs9j"><div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"> </div></div>'),Ss=n("<!> <!>",1),Ts=n('<pre class="description svelte-1uevs9j"> </pre>'),Ms=n('<div class="duel_card_info_row svelte-1uevs9j" style="border-style: solid; border-width: 1px;"><!></div>'),Es=n('<pre class="description svelte-1uevs9j"> </pre>'),Bs=n('<!> <div class="duel_card_info_row svelte-1uevs9j"><!></div>',1),As=n('<div class="effect_counter_area_item svelte-1uevs9j"><span class="svelte-1uevs9j"> </span> <span class="svelte-1uevs9j"> </span> <span class="svelte-1uevs9j">/</span> <span class="svelte-1uevs9j"> </span></div>'),Ls=n('<div class="duel_card_info_row effect_counter_area svelte-1uevs9j"><div class="effect_counter_area_title svelte-1uevs9j">効果使用状況</div> <div class="effect_counter_area_body svelte-1uevs9j"></div></div>'),Ys=n("[ <!> ],",1),Us=n('<div class="svelte-1uevs9j"> <!></div>'),Ns=n('<div class="svelte-1uevs9j"> </div> <!> <div class="svelte-1uevs9j"></div>',1),Ps=n('<div class="svelte-1uevs9j"> </div>'),qs=n('<div class="svelte-1uevs9j"> </div>'),Hs=n('<div class="svelte-1uevs9j"> </div>'),Fs=n('<div class="svelte-1uevs9j"> </div>'),Is=n('<div class="svelte-1uevs9j"> </div>'),Os=n('<div class="svelte-1uevs9j"> </div>'),Rs=n('<div class="duel_card_info_row svelte-1uevs9j"><div class="svelte-1uevs9j"><!> <div class="svelte-1uevs9j"></div> <!> <div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"></div> <!> <div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"></div> <!> <div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"></div> <!> <div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"></div> <!> <div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"></div> <!> <div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"> </div> <div class="svelte-1uevs9j"> </div> <div class="svelte-1uevs9j"> </div> <div class="svelte-1uevs9j"></div></div></div>'),Ws=n('<div class="svelte-1uevs9j">※エラッタ前のカードです</div>'),Ks=n('<div class="svelte-1uevs9j">※テスト用カードです</div>'),zs=n('<a target="_blank" rel="noopener noreferrer" title="コナミカードデータベース" class="svelte-1uevs9j"> </a>'),Vs=n('<a target="_blank" rel="noopener noreferrer" title="遊戯王カードWiki" class="svelte-1uevs9j">⇒遊戯王カードWiki</a>'),Xs=n('<div class="duel_card_info_links svelte-1uevs9j"><!> <!> <a target="_blank" rel="noopener noreferrer" title="google" class="svelte-1uevs9j">⇒google検索</a></div>'),Gs=n("<!> <!>",1),Qs=n('<div role="contentinfo"><div class="duel_card_info_header svelte-1uevs9j"><div class="duel_card_info_row svelte-1uevs9j"><div class="svelte-1uevs9j"> </div></div> <div class="duel_card_info_row svelte-1uevs9j" style="position:sticky; top:0;"><!> <div class="svelte-1uevs9j"> </div></div> <!></div> <div class="duel_card_info_body svelte-1uevs9j"><!></div> <div class="duel_card_info_footer svelte-1uevs9j"><!></div></div>');function Js(_,i){ct(i,!1);let t=Pe(i,"entity",8),v=Pe(i,"mode",12,"Normal"),m=_e(new Promise(()=>{}));const c=()=>{var $,D;let W=t()&&t().entityType==="Card"?t().origin.cardId:(D=($=t())==null?void 0:$.parent)==null?void 0:D.origin.cardId;return W??!1?`https://www.db.yugioh-card.com/yugiohdb/card_search.action?ope=2&cid=${W}`:t()?`https://www.db.yugioh-card.com/yugiohdb/card_search.action?ope=1&sess=1&rp=10&mode=&sort=1&keyword=${t().origin.name}&stype=1&ctype=&othercon=2&starfr=&starto=&pscalefr=&pscaleto=&linkmarkerfr=&linkmarkerto=&link_m=2&atkfr=&atkto=&deffr=&defto=&releaseDStart=1&releaseMStart=1&releaseYStart=1999&releaseDEnd=&releaseMEnd=&releaseYEnd=`:""};ba(()=>(na(t()),ka),()=>{C(m,la.then(async W=>{if(t().origin.description||t().origin.pendulumDescription||t().origin.wikiEncodedName)return t().origin;const $=W.getCardInfo(t().origin.name);if($)return $.cardId!==void 0&&!$.description&&!$.pendulumDescription&&await ka([$.cardId]),$}))}),za(),_t();var u=je(),d=H(u);{var U=W=>{var $=Qs();$.__click=[ps,v,t],$.__contextmenu=[ms,v,t];var D=a($),o=a(D),L=a(o),Q=a(L),G=s(o,2),P=a(G);{var E=F=>{var K=gs(),pe=a(K);p(se=>g(pe,se),[()=>"★".repeat(t().lvl)],ve),r(F,K)},ee=F=>{var K=je(),pe=H(K);{var se=M=>{var S=ys(),q=a(S);p(X=>g(q,X),[()=>"☆".repeat(t().rank)],ve),r(M,S)},Te=M=>{var S=je(),q=H(S);{var X=te=>{var k=hs(),j=a(k);p(A=>g(j,A),[()=>t().origin.linkArrowKeys.map(A=>Va[A].emoji).join("")],ve),r(te,k)};w(q,te=>{t().origin.linkArrowKeys&&te(X)},!0)}r(M,S)};w(pe,M=>{t().rank&&t().rank>0?M(se):M(Te,!1)},!0)}r(F,K)};w(P,F=>{t().lvl&&t().lvl>0?F(E):F(ee,!1)})}var ue=s(P,2),B=a(ue),b=s(G,2);{var N=F=>{var K=Ss(),pe=H(K);{var se=q=>{var X=bs(),te=a(X),k=a(te),j=s(te,2),A=a(j);p(()=>{g(k,`◀ ${t().psL??""}`),g(A,`${t().psR??""} ▶`)}),r(q,X)};w(pe,q=>{var X;(X=t().origin.monsterCategories)!=null&&X.includes("Pendulum")&&q(se)})}var Te=s(pe,2);{var M=q=>{var X=Ds(),te=H(X),k=a(te);ce(k,1,()=>t().attr,me,(x,l)=>{var f=ks(),Y=H(f),z=s(Y,2),ye=a(z);p(()=>{Me(Y,`monster_attr ${e(l)??""} svelte-1uevs9j`),g(ye,`${ja[e(l)]??""}属性`)}),r(x,f)});var j=s(k,2);ce(j,1,()=>t().types,me,(x,l)=>{var f=xs(),Y=a(f);p(()=>{Me(f,`monster_cat ${e(l)??""} svelte-1uevs9j`),g(Y,`${ma[e(l)]??""}${$a[e(l)]??""}族`)}),r(x,f)});var A=s(j,4),I=a(A),O=s(A,2);{var de=x=>{var l=ws(),f=s(H(l),2),Y=a(f);p(()=>g(Y,t().def??"?")),r(x,l)};w(O,x=>{var l;(l=t().status.monsterCategories)!=null&&l.includes("Link")||x(de)})}var T=s(te,2);ce(T,5,()=>t().status.monsterCategories??[],me,(x,l)=>{var f=Cs(),Y=a(f);p(()=>{Me(f,`monster_cat ${e(l)??""} svelte-1uevs9j`),g(Y,`${va[e(l)]??""}${ca[e(l)]??""}`)}),r(x,f)}),p(()=>g(I,t().atk??"?")),r(q,X)},S=q=>{var X=je(),te=H(X);{var k=A=>{var I=js(),O=s(a(I),2),de=a(O);p(()=>g(de,`${ga[t().status.spellCategory]??""}魔法`)),r(A,I)},j=A=>{var I=je(),O=H(I);{var de=T=>{var x=$s(),l=s(a(x),2),f=a(l);p(()=>g(f,`${ya[t().status.trapCategory]??""}罠`)),r(T,x)};w(O,T=>{t().kind==="Trap"&&t().status.trapCategory&&T(de)},!0)}r(A,I)};w(te,A=>{t().kind==="Spell"&&t().status.spellCategory?A(k):A(j,!1)},!0)}r(q,X)};w(Te,q=>{t().kind==="Monster"?q(M):q(S,!1)})}r(F,K)};w(b,F=>{v()!=="Debug"&&F(N)})}var oe=s(D,2),Ce=a(oe);{var he=F=>{var K=Bs(),pe=H(K);{var se=S=>{var q=Ms(),X=a(q);pt(X,()=>e(m),te=>{var k=Qe('"読み込み中"');r(te,k)},(te,k)=>{var j=Ts(),A=a(j);p(()=>{var I;return g(A,(I=e(k))==null?void 0:I.pendulumDescription)}),r(te,j)}),r(S,q)};w(pe,S=>{var q;(q=t().status.monsterCategories)!=null&&q.includes("Pendulum")&&S(se)})}var Te=s(pe,2),M=a(Te);pt(M,()=>e(m),S=>{var q=Qe('"読み込み中"');r(S,q)},(S,q)=>{var X=Es(),te=a(X);p(()=>{var k;return g(te,(k=e(q))==null?void 0:k.description)}),r(S,X)}),r(F,K)},fe=F=>{var K=je(),pe=H(K);{var se=M=>{var S=je(),q=H(S);{var X=te=>{var k=Ls(),j=s(a(k),2);ce(j,5,()=>t().actions,me,(A,I)=>{var O=je();const de=ve(()=>e(I).actionCountUpperBound),T=ve(()=>e(I).actionCount);var x=H(O);{var l=f=>{var Y=As(),z=a(Y),ye=a(z),be=s(z,2),le=a(be),ae=s(be,4),V=a(ae);p(()=>{g(ye,e(I).title),g(le,e(T)),g(V,e(de))}),r(f,Y)};w(x,f=>{e(de)!==void 0&&e(T)!==void 0&&f(l)})}r(A,O)}),r(te,k)};w(q,te=>{t().actions.some(k=>k.actionCountUpperBoundKey)&&te(X)})}r(M,S)},Te=M=>{var S=Rs(),q=a(S),X=a(q);ce(X,0,()=>["info","status"],me,(Ae,ke)=>{var Be=Ns(),Ye=H(Be),Oe=a(Ye),tt=s(Ye,2);ce(tt,1,()=>Object.entries(t()[ke]),me,(Je,jt)=>{let vt=()=>e(jt)[0],$t=()=>e(jt)[1];var Et=Us(),Yt=a(Et),ra=s(Yt);{var Ut=kt=>{var St=Ys(),xt=s(H(St));ce(xt,1,$t,me,(sa,ia)=>{var h=Qe();p(y=>g(h,`${y??""},`),[()=>e(ia).toString()],ve),r(sa,h)}),r(kt,St)},Xt=kt=>{var St=Qe();p(xt=>g(St,`${xt??""},`),[()=>{var xt;return(xt=$t())==null?void 0:xt.toString()}],ve),r(kt,St)};w(ra,kt=>{Array.isArray($t())?kt(Ut):kt(Xt,!1)})}p(()=>g(Yt,`"${vt()??""}" : `)),r(Je,Et)});var ze=s(tt,2);ze.textContent="},",p(()=>g(Oe,`"${ke??""}" :{`)),r(Ae,Be)});var te=s(X,2);te.textContent='"actions" :[';var k=s(te,2);ce(k,1,()=>t().actions,me,(Ae,ke)=>{var Be=Ps(),Ye=a(Be);p(()=>g(Ye,`"${e(ke).playType??""} ${e(ke).title??""}",`)),r(Ae,Be)});var j=s(k,2);j.textContent="],";var A=s(j,2);A.textContent='"substituteEffects" :[';var I=s(A,2);ce(I,1,()=>t().substituteEffects,me,(Ae,ke)=>{var Be=qs(),Ye=a(Be);p(()=>g(Ye,`"${e(ke).title??""}",`)),r(Ae,Be)});var O=s(I,2);O.textContent="],";var de=s(O,2);de.textContent='"continuousEffects" :[';var T=s(de,2);ce(T,1,()=>t().continuousEffects,me,(Ae,ke)=>{var Be=Hs(),Ye=a(Be);p(()=>g(Ye,`"${e(ke).isStarted??""}",`)),r(Ae,Be)});var x=s(T,2);x.textContent="],";var l=s(x,2);l.textContent='"procFilters" :[';var f=s(l,2);ce(f,1,()=>t().procFilterBundle.operators,me,(Ae,ke)=>{var Be=Fs(),Ye=a(Be);p(Oe=>g(Ye,`"${Oe??""} ${e(ke).title??""} ${e(ke).isEffective??""} ",`),[()=>e(ke).isSpawnedBy.toString()],ve),r(Ae,Be)});var Y=s(f,2);Y.textContent="],";var z=s(Y,2);z.textContent='"numericStateOperators" :[';var ye=s(z,2);ce(ye,1,()=>t().numericOprsBundle.operators,me,(Ae,ke)=>{var Be=Is(),Ye=a(Be);p(Oe=>g(Ye,`"${Oe??""} ${e(ke).title??""} ${e(ke).isEffective??""} ${e(ke).isContinuous??""} ${e(ke).targetState??""} ${e(ke).targetStateGen??""} ",`),[()=>e(ke).isSpawnedBy.toString()],ve),r(Ae,Be)});var be=s(ye,2);be.textContent="],";var le=s(be,2);le.textContent='"stateOperators" :[';var ae=s(le,2);ce(ae,1,()=>t().statusOperatorBundle.operators,me,(Ae,ke)=>{var Be=Os(),Ye=a(Be);p(Oe=>g(Ye,`"${Oe??""} ${e(ke).title??""} ${e(ke).isEffective??""} ",`),[()=>e(ke).isSpawnedBy.toString()],ve),r(Ae,Be)});var V=s(ae,2);V.textContent="],";var re=s(V,2);re.textContent='"lastMoveLogRecord" :{';var $e=s(re,2),Fe=a($e),He=s($e,2),Ie=a(He),Le=s(He,2),Ve=a(Le),ot=s(Le,2);ot.textContent="},",p((Ae,ke)=>{g(Fe,`"movedBy":"${Ae??""}",`),g(Ie,`"movedAs":"${ke??""}",`),g(Ve,`"movedAt":"${t().moveLog.latestRecord.movedAt.totalProcSeq??""}",`)},[()=>{var Ae;return(Ae=t().moveLog.latestRecord.movedBy)==null?void 0:Ae.toString()},()=>t().moveLog.latestRecord.movedAs.join(" ")],ve),r(M,S)};w(pe,M=>{v()==="Detail"?M(se):M(Te,!1)},!0)}r(F,K)};w(Ce,F=>{v()==="Normal"?F(he):F(fe,!1)})}var ie=s(oe,2),Ee=a(ie);{var De=F=>{var K=Gs(),pe=H(K);{var se=q=>{var X=Ws();r(q,X)};w(pe,q=>{t().origin.isOldVersion&&q(se)})}var Te=s(pe,2);{var M=q=>{var X=Ks();r(q,X)},S=q=>{var X=Xs(),te=a(X);{var k=I=>{var O=zs();const de=ve(()=>t().entityType==="Card"?t():t().parent);var T=a(O);p(x=>{var l;it(O,"href",x),g(T,`⇒${((l=e(de))!=null&&l.origin.cardId?"公式カードページ":"公式で検索")??""}`)},[c],ve),r(I,O)};w(te,I=>{var O;t()&&(t().entityType==="Card"||((O=t().parent)==null?void 0:O.entityType)==="Card")&&I(k)})}var j=s(te,2);pt(j,()=>e(m),null,(I,O)=>{var de=je(),T=H(de);{var x=l=>{var f=Vs();p(()=>it(f,"href",`https://yugioh-wiki.net/index.php?${e(O).wikiEncodedName}`)),r(l,f)};w(T,l=>{e(O)&&e(O).wikiEncodedName&&l(x)})}r(I,de)});var A=s(j,2);p(()=>it(A,"href",`https://www.google.com/search?q=遊戯王 ${t().origin.name}`)),r(q,X)};w(Te,q=>{t().origin.isForTest?q(M):q(S,!1)})}r(F,K)};w(Ee,F=>{t()&&F(De)})}p((F,K)=>{Me($,`duel_card duel_card_info ${t().origin.kind??""} ${F??""} svelte-1uevs9j`),g(Q,t().nm),g(B,K)},[()=>{var F;return(F=t().origin.monsterCategories)==null?void 0:F.join(" ")},()=>"★".repeat(t().lvl||0)],ve),r(W,$)};w(d,W=>{t()&&W(U)})}r(_,u),ut()}Ka(["click","contextmenu"]);var Zs=n('<div class="duel_field_cell_info_item svelte-1xj7qf1"><!></div>'),ei=n('<div class="duel_field_cell_info_box svelte-1xj7qf1"><div class="duel_field_cell_info_label svelte-1xj7qf1"> </div> <!></div>'),ti=n('<div class="duel_field_cell_info svelte-1xj7qf1"><div class="duel_field_cell_info_header item_btn svelte-1xj7qf1"><div class="svelte-1xj7qf1"> </div> <div class="svelte-1xj7qf1"> </div></div> <div class="duel_field_cell_info_body svelte-1xj7qf1"></div></div>');function ai(_,i){ct(i,!1);let t=Pe(i,"cell",12);const v=()=>{t(t())},m=U=>t().cardEntities.filter(W=>W.face===U);t().field.duel.view.onDuelUpdate.append(v),_t();var c=je(),u=H(c);{var d=U=>{var W=ti(),$=a(W),D=a($),o=a(D),L=s(D,2),Q=a(L),G=s($,2);ce(G,4,()=>["FaceUp","FaceDown"],me,(P,E)=>{var ee=je(),ue=H(ee);{var B=b=>{var N=ei(),oe=a(N),Ce=a(oe),he=s(oe,2);ce(he,1,()=>m(E).toSorted(lr),me,(fe,ie)=>{var Ee=Zs(),De=a(Ee);const F=ve(()=>t().owner===t().field.duel.duelists.Below);Wt(De,{get entity(){return e(ie)},get isVisibleForcibly(){return e(F)},isWideMode:!0,cardActionResolve:void 0}),r(fe,Ee)}),p(()=>g(Ce,E==="FaceUp"?"表向き":"裏向き")),r(b,N)};w(ue,b=>{m(E).length&&b(B)})}r(P,ee)}),p(()=>{var P;g(o,(P=t().owner)==null?void 0:P.profile.name),g(Q,t().cellType)}),r(U,W)};w(u,U=>{t().field.duel.view.infoBoardState==="CellInfo"&&U(d)})}r(_,c),ut()}var ri=n('<div class="duel_config_item svelte-y4u26k"><label class="toggle svelte-y4u26k"><input type="checkbox" class="svelte-y4u26k"></label> <span class="svelte-y4u26k"> </span></div>'),si=n('<div class="duel_config svelte-y4u26k"><div class="duel_config_title svelte-y4u26k">デュエル設定</div> <div class="duel_config_group svelte-y4u26k"><div class="duel_config_group_title svelte-y4u26k">チェーン設定</div> <!></div></div>');function ii(_,i){ct(i,!1);let t=Pe(i,"viewController",8),v=Pe(i,"userProfile",12);_t();var m=je(),c=H(m);{var u=d=>{var U=si(),W=s(a(U),2),$=s(a(W),2);ce($,1,()=>cr,me,(D,o)=>{var L=ri(),Q=a(L),G=a(Q),P=s(Q,2),E=a(P);p(()=>g(E,vr[e(o)])),dr(G,()=>v().chainConfig[e(o)],ee=>v(v().chainConfig[e(o)]=ee,!0)),Z("change",G,()=>v().save()),r(D,L)}),r(d,U)};w(c,d=>{t().infoBoardState==="Config"&&d(u)})}r(_,m),ut()}function oi(_,{from:i,to:t},v={}){var{delay:m=0,duration:c=N=>Math.sqrt(N)*120,easing:u=wa}=v,d=getComputedStyle(_),U=d.transform==="none"?"":d.transform,[W,$]=d.transformOrigin.split(" ").map(parseFloat);W/=_.clientWidth,$/=_.clientHeight;var D=ni(_),o=_.clientWidth/t.width/D,L=_.clientHeight/t.height/D,Q=i.left+i.width*W,G=i.top+i.height*$,P=t.left+t.width*W,E=t.top+t.height*$,ee=(Q-P)*o,ue=(G-E)*L,B=i.width/t.width,b=i.height/t.height;return{delay:m,duration:typeof c=="function"?c(Math.sqrt(ee*ee+ue*ue)):c,easing:u,css:(N,oe)=>{var Ce=oe*ee,he=oe*ue,fe=N+oe*B,ie=N+oe*b;return`transform: ${U} translate(${Ce}px, ${he}px) scale(${fe}, ${ie});`}}}function ni(_){if("currentCSSZoom"in _)return _.currentCSSZoom;for(var i=_,t=1;i!==null;)t*=+getComputedStyle(i).zoom,i=i.parentElement;return t}var li=n('<div class="chain_number svelte-lqu21u"> </div>'),vi=n('<div class="duel_card_row svelte-lqu21u"> </div>'),di=n('<div class="appendix svelte-lqu21u"> </div>'),ci=n('<div class="appendix_wrapper svelte-lqu21u"></div>'),_i=n('<div><div><!> <div> </div> <div><!> <div class="duel_card_row svelte-lqu21u"><div> </div> <!></div></div></div></div>'),ui=n("<div></div>");function fi(_,i){ct(i,!1);let t=Pe(i,"duel",8),v=Pe(i,"position",8,"left");const m=-100,c=()=>v()==="left"?-100:100;let u=_e([]),d=Promise.resolve(),U=Promise.resolve();const W=1e3,$=500,D=400,o=Q=>{const G={...Q};G.isKnown=Q.chainBlockInfo.action.entity.controller.duelistType==="Player"||Q.chainBlockInfo.action.entity.face==="FaceUp",G.chainBlockInfo.onStateChange.append(P=>{if(P==="done"||P==="failed"||P==="negated")return d=d.then(async()=>{const E=new Date().getTime()-G.chainBlockInfo.wasSpawnedAt.getTime();E<W&&await zt(W-E),C(u,e(u).filter(ee=>ee.seq!==G.seq)),await zt($+D)}).then(),"RemoveMe";C(u,e(u))}),U=U.then(async()=>{C(u,[G,...e(u)].sort((P,E)=>_r.isSameChain(P.clock,E.clock)&&P.chainBlockInfo.action.isWithChainBlock&&E.chainBlockInfo.action.isWithChainBlock?E.clock.totalProcSeq-P.clock.totalProcSeq:P.clock.totalProcSeq-E.clock.totalProcSeq)),await zt(300)}),d=d.then(()=>zt(1e3))};t().chainBlockLog.onInsert.append(o),_t();var L=ui();ce(L,13,()=>e(u),Q=>Q.seq,(Q,G)=>{var P=_i();const E=ve(()=>{const{activator:K,action:pe,appendix:se}=e(G).chainBlockInfo;return{activator:K,action:pe,appendix:se}});var ee=a(P),ue=a(ee);{var B=K=>{var pe=li(),se=a(pe);p(()=>g(se,`チェーン：${e(G).chainBlockInfo.chainNumber??""}`)),r(K,pe)};w(ue,K=>{e(G).chainBlockInfo.chainNumber&&K(B)})}var b=s(ue,2),N=a(b),oe=s(b,2),Ce=a(oe);{var he=K=>{var pe=vi(),se=a(pe);p(()=>g(se,e(G).isKnown?e(E).action.entity.nm:"？？？")),r(K,pe)};w(Ce,K=>{(e(E).action.entity.entityType==="Card"||e(E).action.entity.entityType==="Token")&&K(he)})}var fe=s(Ce,2),ie=a(fe),Ee=a(ie),De=s(ie,2);{var F=K=>{var pe=ci();ce(pe,5,()=>e(E).appendix,me,(se,Te)=>{var M=di(),S=a(M);p(()=>g(S,e(Te))),r(se,M)}),r(K,pe)};w(De,K=>{e(E).appendix&&K(F)})}p((K,pe,se)=>{Me(P,`cut_in_row ${(!e(G).chainBlockInfo.chainNumber||e(G).chainBlockInfo.chainNumber===1?"cut_in_row_first":"")??""} svelte-lqu21u`),Me(ee,`cut_in_item cut_in_item_${K??""} cut_in_item_${e(G).chainBlockInfo.state??""} svelte-lqu21u`),Me(b,`duelist_name duelist_${K??""}_name svelte-lqu21u`),g(N,e(E).activator.profile.name),Me(oe,`duel_card duel_card_${K??""} ${pe??""} ${(e(G).isKnown?e(E).action.entity.origin.kind:"")??""} ${e(E).action.entity.entityType??""}  svelte-lqu21u`),g(Ee,se)},[()=>e(E).activator.seat.toLowerCase(),()=>e(G).isKnown?(e(E).action.entity.status.monsterCategories??[]).join(" "):"Token",()=>e(E).action.toString()],ve),ne(3,ee,()=>Lr,()=>new Date().getTime()-e(G).chainBlockInfo.wasSpawnedAt.getTime()<W?{x:c(),duration:D}:{y:m,duration:D}),ur(P,()=>oi,()=>({duration:$})),r(Q,P)}),p(()=>Me(L,`cut_in_container cut_in_container_${v()??""} svelte-lqu21u`)),r(_,L),ut()}const pi=Yr({duration:400});var mi=n('<div class="duel_desk_left v_flex svelte-1w535im"><!> <!> <!></div>'),gi=n('<button class="duel_field_header_message svelte-1w535im"> </button> <div class="duel_field_header_buttons svelte-1w535im"><button class="svelte-1w535im">サレンダー</button></div>',1),yi=n("<tr></tr>"),hi=n('<table class="duel_field svelte-1w535im"><tbody class="svelte-1w535im"></tbody></table>'),bi=n('<button class="svelte-1w535im">OK</button>'),ki=n('<button class="svelte-1w535im">cancel</button>'),xi=n("<!> <!>",1),wi=n('<button class="svelte-1w535im"> </button>'),Ci=n('<div style="text-align: left;"><!> <!> <!></div>'),Di=n('<div><!> <div class=" duel_desk_center v_flex svelte-1w535im"><div class="duel_field_header svelte-1w535im"><!></div> <div class="duel_field_body svelte-1w535im"><!></div> <div class="duel_field_footer svelte-1w535im"><!></div></div> <!></div> <div style="position:fixed;bottom:0"> </div> <!> <div><!></div>',1);function ji(_,i){ct(i,!1);let t=Pe(i,"duel",12),v=Pe(i,"userProfile",8),m=_e(0),c=_e(0),u=_e([]),d=_e([]),U=()=>{},W=_e([]),$=_e(),D=_e(),o=_e(()=>!1),L=_e(!1);const Q=l=>{U=l.resolve,C(W,l.dummyActionInfos.filter(f=>f.action.entity.entityType==="Duelist").filter(f=>f.action.entity.controller.seat==="Below")),C($,void 0),C(D,void 0),C(d,[]),C(u,[]),C(L,!1),l.entitiesChoices&&(C($,l.entitiesChoices),C(o,()=>{var f;return((f=l.entitiesChoices)==null?void 0:f.validator(e(u)))??!1}),C(L,l.entitiesChoices.cancelable),e($).selectables.every(f=>f.cell.isPlayFieldCell&&f.getIndexInCell()===0||f.cell.cellType==="Hand"&&f.controller.duelistType==="Player"||f.entityType==="Duelist")||t().view.modalController.entitySelector.show({title:t().view.message,position:"Middle",entitiesChoices:l.entitiesChoices,chainBlockInfos:l.chainBlockInfos,cancelable:l.entitiesChoices.cancelable}).then(f=>{U({selectedEntities:f})})),l.cellsChoices&&(C(D,l.cellsChoices),C(o,()=>{var f;return((f=l.cellsChoices)==null?void 0:f.validator(e(d)))??!1}),C(L,l.cellsChoices.cancelable))};t().view.onWaitStart.append(Q);const G=()=>{U=()=>{},C(D,void 0),C($,void 0),C(d,[]),C(u,[]),C(o,()=>!1),C(L,!1)};t().view.onWaitEnd.append(G);let P=_e(void 0),E=_e("Normal");const ee=({card:l,mode:f})=>{C(P,l),C(E,f??(e(P)===l||e(E)==="Normal"?"Detail":"Normal"))};t().view.onShowCardEntity.append(ee);const ue=()=>{t(t())};t().view.onDuelUpdate.append(ue),t().log.onUpdate.append(ue);const B=()=>{e($)&&e($).validator(e(u))&&U({selectedEntities:e(u)}),e(D)&&e(D).validator(e(d))&&U({selectedCells:e(d)})},b=()=>{U({})},N=l=>{U({actionInfo:l})},oe=()=>{U({surrender:!0})};t().main();const Ce=()=>e(m)<=1400?"compact":"wide";_t();var he=Di(),fe=H(he),ie=a(fe);{var Ee=l=>{var f=mi(),Y=a(f);Ra(Y,{get duelist(){return t().duelists.Above}});var z=s(Y,2);{var ye=le=>{Js(le,{get entity(){return e(P)},get mode(){return e(E)}})};w(z,le=>{e(P)&&le(ye)})}var be=s(z,2);Ra(be,{get duelist(){return t().duelists.Below}}),r(l,f)};w(ie,l=>{Ce()==="wide"&&l(Ee)})}var De=s(ie,2),F=a(De),K=a(F);{var pe=l=>{var f=gi(),Y=H(f),z=a(Y),ye=s(Y,2),be=a(ye);p(()=>g(z,`[TURN:${t().clock.turn}][PHASE:${t().phase}] ${t().view.message}`)),Z("click",Y,()=>{t(t().view.infoBoardState="Log",!0)}),Z("click",be,oe),r(l,f)};w(K,l=>{t().isEnded||l(pe)})}var se=s(F,2),Te=a(se);{var M=l=>{var f=hi(),Y=a(f);ce(Y,5,()=>t().field.cells,me,(z,ye,be)=>{var le=yi();Me(le,`${`duel_desk_row_${be}`??""} svelte-1w535im`),ce(le,5,()=>e(ye),me,(ae,V,re)=>{as(ae,{get view(){return t().view},row:be,column:re,get selectedEntities(){return e(u)},set selectedEntities($e){C(u,$e)},get selectedCells(){return e(d)},set selectedCells($e){C(d,$e)},$$legacy:!0})}),r(z,le)}),r(l,f)};w(Te,l=>{t().clock.turn>0&&l(M)})}var S=s(se,2),q=a(S);{var X=l=>{var f=xi(),Y=H(f);{var z=le=>{var ae=bi();p(V=>ae.disabled=V,[()=>!e(o)()],ve),Z("click",ae,B),r(le,ae)};w(Y,le=>{((e($)&&e($).qty)??(e(D)&&e(D).qty)??9999)>1&&le(z)})}var ye=s(Y,2);{var be=le=>{var ae=ki();Z("click",ae,b),r(le,ae)};w(ye,le=>{e(L)&&le(be)})}r(l,f)},te=l=>{var f=je(),Y=H(f);ce(Y,1,()=>e(W),me,(z,ye)=>{var be=wi(),le=a(be);p(()=>g(le,e(ye).action.title)),Z("click",be,()=>N(e(ye))),r(z,be)}),r(l,f)};w(q,l=>{e($)&&e($).selectables.length||e(D)&&e(D).selectables?l(X):l(te,!1)})}var k=s(De,2);{var j=l=>{var f=Ci(),Y=a(f);us(Y,{get log(){return t().log}});var z=s(Y,2);ai(z,{get cell(){return t().view.infoBoardCell}});var ye=s(z,2);ii(ye,{get userProfile(){return v()},get viewController(){return t().view}}),p(be=>Me(f,`duel_desk_right duel_desk_right_${be??""}  svelte-1w535im`),[()=>t().view.infoBoardState.toLowerCase()],ve),ne(3,f,()=>we,()=>({duration:e(m)>1400?0:200,axis:"x"})),r(l,f)};w(k,l=>{(e(m)>1400||t().view.infoBoardState!=="Default")&&l(j)})}var A=s(fe,2),I=a(A),O=s(A,2);fr(O,{get modalController(){return t().view.modalController}});var de=s(O,2),T=a(de);const x=ve(()=>Ce()==="wide"?"right":"left");fi(T,{get duel(){return t()},get position(){return e(x)}}),p((l,f)=>{Me(fe,`flex duel_desk ${l??""}_mode svelte-1w535im`),g(I,f),Me(de,`cutin ${l??""}_mode svelte-1w535im`)},[Ce,()=>t().clock.toFullString()],ve),_a("innerWidth",l=>C(m,l)),_a("innerHeight",l=>C(c,l)),r(_,he),ut()}var $i=n("<div></div>"),Si=n("<!> <!> <!> <!>",1),Ti=n('<span class="svelte-310mbe"> </span> / <span class="svelte-310mbe"> </span>',1),Mi=n('<div role="listitem"><div class="svelte-310mbe"><div class="duel_card_row card_name svelte-310mbe"> </div> <div style="display:flex; flex-wrap: wrap;" class="svelte-310mbe"><div style="" class="svelte-310mbe"><!> <!> <!></div> <div class="atk_def svelte-310mbe"><!></div></div></div></div>');function Qa(_,i){ct(i,!1);let t=Pe(i,"mode",8),v=Pe(i,"cardInfo",8),m=Pe(i,"onAttention",8),c=Pe(i,"cardControlEventHandlers",8);_t();var u=Mi(),d=a(u),U=a(d),W=a(U),$=s(U,2),D=a($),o=a(D);{var L=b=>{var N=Si(),oe=H(N);{var Ce=De=>{var F=Qe();p(()=>g(F,`★${v().level??""}`)),r(De,F)},he=De=>{var F=je(),K=H(F);{var pe=Te=>{var M=Qe();p(()=>g(M,`☆${v().rank??""}`)),r(Te,M)},se=Te=>{var M=je(),S=H(M);{var q=X=>{var te=Qe();p(()=>g(te,`Ｌ${v().link??""}`)),r(X,te)};w(S,X=>{v().link&&X(q)},!0)}r(Te,M)};w(K,Te=>{v().rank?Te(pe):Te(se,!1)},!0)}r(De,F)};w(oe,De=>{v().level?De(Ce):De(he,!1)})}var fe=s(oe,2);ce(fe,1,()=>v().attributes??[],me,(De,F)=>{var K=$i();p(()=>Me(K,`monster_attr ${e(F)??""} svelte-310mbe`)),r(De,K)});var ie=s(fe,2);ce(ie,1,()=>v().types??[],me,(De,F)=>{var K=Qe();p(()=>g(K,ma[e(F)])),r(De,K)});var Ee=s(ie,2);ce(Ee,1,()=>v().monsterCategories??[],me,(De,F)=>{var K=Qe();p(()=>g(K,va[e(F)])),r(De,K)}),r(b,N)};w(o,b=>{v().kind==="Monster"&&b(L)})}var Q=s(o,2);{var G=b=>{var N=Qe();p(()=>g(N,`${ga[v().spellCategory]??""}魔法`)),r(b,N)};w(Q,b=>{v().spellCategory&&b(G)})}var P=s(Q,2);{var E=b=>{var N=Qe();p(()=>g(N,`${ya[v().trapCategory]??""}罠`)),r(b,N)};w(P,b=>{v().trapCategory&&b(E)})}var ee=s(D,2),ue=a(ee);{var B=b=>{var N=Ti(),oe=H(N),Ce=a(oe),he=s(oe,2),fe=a(he);p(()=>{g(Ce,v().attack??"?"),g(fe,v().defense??"?")}),r(b,N)};w(ue,b=>{v().kind==="Monster"&&b(B)})}p(b=>{Me(u,`${b??""} svelte-310mbe`),g(W,v().name)},[()=>{var b,N;return`deck_editor_card duel_card ${v().kind} ${(N=(b=v())==null?void 0:b.monsterCategories)==null?void 0:N.join(" ")} ${v().isImplemented?"is_implemented":"is_not_implemented"}`}],ve),Z("click",u,()=>m()(v())),Z("touchstart",u,b=>c().onCardDragStart(b,t(),v())),Z("touchmove",u,b=>c().onCardDragging(b,t())),Z("touchend",u,function(...b){var N;(N=c().onCardDragEnd)==null||N.apply(this,b)}),Z("touchcancel",u,function(...b){var N;(N=c().onCardDragCancel)==null||N.apply(this,b)}),Z("mousedown",u,b=>c().onCardDragStart(b,t(),v())),Z("mousemove",u,b=>c().onCardDragging(b,t())),Z("mouseup",u,function(...b){var N;(N=c().onCardDragEnd)==null||N.apply(this,b)}),r(_,u),ut()}var Ei=n('<div class="svelte-dp98uv"><button class="button_style_reset svelte-dp98uv">クリア</button></div>'),Bi=n('<button class="button_style_reset plus_minus_button svelte-dp98uv">+</button> <button class="button_style_reset plus_minus_button svelte-dp98uv">-</button>',1),Ai=n('<li class="deck_editor_item svelte-dp98uv"><!> <!></li>'),Li=n('<div class="deck_editor_card_kind_header svelte-dp98uv"><div class="svelte-dp98uv"> <!> 枚） <!></div> <div style="display: flex;" class="svelte-dp98uv"><!> <div class="triangle svelte-dp98uv">▲</div></div></div> <div class="deck_editor_card_kind_body svelte-dp98uv"><ul></ul></div>',1),Yi=n("<div><!></div>"),Ui=n('<div class="deck_editor_card_list svelte-dp98uv"></div>');function Wa(_,i){ct(i,!1);let t=Pe(i,"allCardTree",8),v=Pe(i,"deckCardTree",12),m=Pe(i,"mode",8),c=Pe(i,"onAttention",8),u=Pe(i,"searchCondition",8,void 0),d=Pe(i,"cardControlEventHandlers",8),U=_e("ExtraMonster");const W=xa.terminalTypeName==="PC"?500:xa.terminalTypeName==="Tablet Device"?300:100,$=20;let D=_e($);const o=(B=!1)=>{if(B||C(D,$),C(D,e(D)+10),m()==="List"){if(e(D)>=W)return}else if(e(D)>mr(...Object.values(v()).map(b=>b.length)))return;zt(100).then(()=>o(!0))},L=_e(m()==="List"?t():v()),Q=(...B)=>{const b=B.length?B:Kt(e(L)),N=(oe,Ce)=>{var he;return Ga(oe,Ce,(he=u())==null?void 0:he.sort.filter(fe=>fe.priority>0).toSorted((fe,ie)=>fe.priority-ie.priority))};b.forEach(oe=>e(L)[oe].sort(N))},G=(B,b)=>{v(v()[b]=[],!0)};let P=_e(structuredClone(e(L))),E=_e("");const ee=B=>{if(!u())return!0;if(B.kind==="XyzMaterial")return!1;const b=ua(B);if(!u().deckCardKinds.includes(b)||u().name.trim().length&&[B.name,...B.nameTags??[],...B.textTags??[]].every(oe=>!oe.includes(u().name))||!B.isImplemented&&!u().others.includes("implemented")||B.isForTest&&!u().others.includes("test")||B.isOldVersion&&!u().others.includes("oldVersion"))return!1;if(B.kind==="Monster"){if(B.attributes&&!u().monsterAttributes.union(B.attributes).length||B.types&&!u().monsterTypes.union(B.types).length)return!1;const N=B.level??B.rank??B.link;return At(u().starLowerBound)&&(N??0)<u().starLowerBound||At(u().starUpperBound)&&(N??0)>u().starUpperBound||At(u().atkLowerBound)&&(B.attack??0)<u().atkLowerBound||At(u().atkUpperBound)&&(B.attack??0)>u().atkUpperBound||At(u().defLowerBound)&&(B.defense??0)<u().defLowerBound||At(u().defUpperBound)&&(B.defense??0)>u().defUpperBound||At(u().atkPlusDef)&&(!At(B.attack)||!At(B.defense)||B.attack+B.defense!==u().atkPlusDef)||!B.monsterCategories||b==="ExtraMonster"&&!B.monsterCategories.union(u().exMonsterCategories).length?!1:B.monsterCategories.union(u().monsterCategories).length}if(B.kind==="Spell")return B.spellCategory&&u().spellCategories.includes(B.spellCategory);if(B.kind==="Trap")return B.trapCategory&&u().trapCategories.includes(B.trapCategory)};ba(()=>(na(m()),e(L),na(v()),e(U),e(P)),()=>{if(m()==="Deck"){if(Kt(e(L)).forEach(B=>xe(L,e(L)[B]=v()[B])),!e(L)[e(U)].length)C(U,Kt(e(L)).find(B=>e(L)[B].find(ee))??"ExtraMonster");else{const B=Kt(e(L)).map(b=>({kind:b,cardInfos:e(L)[b]})).filter(({cardInfos:b})=>b.length).find(({kind:b,cardInfos:N})=>N.length!==e(P)[b].length);B&&e(U)!==B.kind&&C(U,B.kind)}C(P,structuredClone(e(L)))}}),ba(()=>(na(m()),na(u()),e(E)),()=>{var B;if(m()==="List"){const b=JSON.stringify((B=u())==null?void 0:B.sort);e(E)!==b&&(C(E,b),Q()),o()}}),za(),_t();var ue=Ui();ce(ue,5,()=>ea,me,(B,b,N)=>{var oe=Yi();const Ce=ve(()=>e(L)[e(b)].filter(ee));var he=a(oe);{var fe=ie=>{var Ee=Li(),De=H(Ee),F=a(De),K=a(F),pe=s(K);{var se=j=>{var A=Qe();p(I=>g(A,`/ ${I??""}`),[()=>e(L)[e(b)].length.toLocaleString()],ve),r(j,A)};w(pe,j=>{m()==="List"&&j(se)})}var Te=s(pe,2);{var M=j=>{var A=Qe();p(I=>g(A,`※表示上限${I??""}枚`),[()=>W.toLocaleString()],ve),r(j,A)};w(Te,j=>{e(Ce).length>W&&j(M)})}var S=s(F,2),q=a(S);{var X=j=>{var A=Ei(),I=a(A);Z("click",I,O=>G(O,e(b))),r(j,A)};w(q,j=>{m()==="Deck"&&e(Ce).length&&j(X)})}var te=s(De,2),k=a(te);ce(k,5,()=>e(Ce),me,(j,A,I)=>{var O=je(),de=H(O);{var T=x=>{var l=Ai(),f=a(l);Qa(f,{get mode(){return m()},get cardInfo(){return e(A)},get onAttention(){return c()},get cardControlEventHandlers(){return d()}});var Y=s(f,2);{var z=ye=>{var be=Bi(),le=H(be),ae=s(le,2);p(V=>{le.disabled=!e(A).isImplemented,it(le,"title",e(A).isImplemented?`※shiftキー同時押しで一括投入
※ctrlキー同時押しで枚数制限無視`:""),ae.disabled=V,it(ae,"title",e(A).isImplemented?"※shiftキー同時押しで一括外し":"")},[()=>m()!=="Deck"&&v()[e(b)].every(V=>V.name!==e(A).name)],ve),Z("click",le,V=>d().onCardAppend(V,e(A))),Z("click",ae,V=>d().onCardRemove(V,e(A))),r(ye,be)};w(Y,ye=>{m()==="Deck"&&ye(z)})}r(x,l)};w(de,x=>{I<e(D)&&(I<20||e(U)===e(b))&&x(T)})}r(j,O)}),p(j=>{g(K,`${Xa[e(b)]??""}（${j??""} `),Me(k,pr(e(b)),"svelte-dp98uv")},[()=>e(Ce).length.toLocaleString()],ve),Z("click",De,()=>{if(e(U)!==e(b)){C(U,e(b));return}C(U,ea.map((j,A)=>A+N).map(j=>j%ea.length).map(j=>ea[j]).filter(j=>j!==e(b)).find(j=>e(L)[j].find(ee))??e(b))}),r(ie,Ee)};w(he,ie=>{e(Ce).length&&ie(fe)})}p(()=>Me(oe,`deck_editor_card_kind deckCardKind ${(e(b)===e(U)?"selected":"")??""} ${(e(Ce).length?"":"empty")??""} svelte-dp98uv`)),r(B,oe)}),r(_,ue),ut()}var Ni=n('<div class="svelte-7xhk0x"> </div>'),Pi=n('<div class="svelte-7xhk0x"> </div>'),qi=n('<div class="link_arrow_emoji svelte-7xhk0x"> </div>'),Hi=n('<div class="duel_card_info_row svelte-7xhk0x" style="position:sticky; top:0;"><!></div>'),Fi=n('<div class="duel_card_info_row svelte-7xhk0x"><div class="svelte-7xhk0x"><pre class="description svelte-7xhk0x"> </pre></div></div> <div class="duel_card_info_row svelte-7xhk0x" style=" justify-content: space-between;"><div class="svelte-7xhk0x"> </div> <div class="svelte-7xhk0x"> </div></div>',1),Ii=n('<div></div> <div class="svelte-7xhk0x"> </div>',1),Oi=n("<div> </div>"),Ri=n('<span class="svelte-7xhk0x">/</span> <div class="monster_defense svelte-7xhk0x"> </div>',1),Wi=n("<div> </div>"),Ki=n('<div class="duel_card_info_row svelte-7xhk0x"><!> <!> <div style="flex-grow: 1;" class="svelte-7xhk0x"></div> <div class="monster_attack svelte-7xhk0x"> </div> <!></div> <div class="duel_card_info_row svelte-7xhk0x"></div>',1),zi=n('<div class="duel_card_row svelte-7xhk0x"><div class="svelte-7xhk0x"></div> <div class="svelte-7xhk0x"> </div></div>'),Vi=n('<div class="duel_card_row svelte-7xhk0x"><div class="svelte-7xhk0x"></div> <div class="svelte-7xhk0x"> </div></div>'),Xi=n('<div class="duel_card_info_row svelte-7xhk0x"><div class="svelte-7xhk0x">※エラッタ前カードです</div></div>'),Gi=n('<div class="duel_card_info_row svelte-7xhk0x"><div class="svelte-7xhk0x">※テスト用カードです</div></div>'),Qi=n('<div class="duel_card_info_links svelte-7xhk0x"><a target="_blank" rel="noopener noreferrer" title="コナミカードデータベース" class="svelte-7xhk0x"> </a> <a target="_blank" rel="noopener noreferrer" title="遊戯王カードWiki" class="svelte-7xhk0x">⇒遊戯王カードWiki</a> <a target="_blank" rel="noopener noreferrer" title="google" class="svelte-7xhk0x">⇒google検索</a></div>'),Ji=n('<div><div class="duel_card_info_header svelte-7xhk0x"><div class="duel_card_info_row svelte-7xhk0x"><div class="svelte-7xhk0x"> </div></div> <!> <div class="plus_minus_button_area svelte-7xhk0x"><button class="button_style_reset plus_minus_button svelte-7xhk0x">+</button> <button class="button_style_reset plus_minus_button svelte-7xhk0x">-</button></div></div> <div class="duel_card_info_body svelte-7xhk0x"><!> <!> <div class="duel_card_info_row description svelte-7xhk0x"><div class="svelte-7xhk0x"><pre class="description svelte-7xhk0x"> </pre></div></div> <!> <!></div></div>');function Zi(_,i){ct(i,!1);let t=Pe(i,"cardInfo",8,void 0),v=Pe(i,"onAttention",8),m=Pe(i,"cardControlEventHandlers",8),c=Pe(i,"deckCardTree",8);_t();var u=je(),d=H(u);{var U=W=>{var $=Ji(),D=a($),o=a(D),L=a(o),Q=a(L),G=s(o,2);{var P=M=>{var S=Hi(),q=a(S);{var X=k=>{var j=Ni(),A=a(j);p(I=>g(A,I),[()=>"★".repeat(t().level)],ve),r(k,j)},te=k=>{var j=je(),A=H(j);{var I=de=>{var T=Pi(),x=a(T);p(l=>g(x,l),[()=>"★".repeat(t().rank)],ve),r(de,T)},O=de=>{var T=je(),x=H(T);{var l=f=>{var Y=qi(),z=a(Y);p(ye=>g(z,ye),[()=>t().linkArrowKeys.map(ye=>Va[ye].emoji).join("")],ve),r(f,Y)};w(x,f=>{t().linkArrowKeys&&f(l)},!0)}r(de,T)};w(A,de=>{t().rank&&t().rank>0?de(I):de(O,!1)},!0)}r(k,j)};w(q,k=>{t().level&&t().level>0?k(X):k(te,!1)})}r(M,S)};w(G,M=>{t().kind==="Monster"&&M(P)})}var E=s(G,2),ee=a(E),ue=s(ee,2),B=s(D,2),b=a(B);{var N=M=>{var S=Fi(),q=H(S),X=a(q),te=a(X),k=a(te),j=s(q,2),A=a(j),I=a(A),O=s(A,2),de=a(O);p(()=>{g(k,t().pendulumDescription),g(I,`◀ ${t().pendulumScaleL??""}`),g(de,`${t().pendulumScaleR??""} ▶`)}),r(M,S)};w(b,M=>{var S;(S=t().monsterCategories)!=null&&S.includes("Pendulum")&&M(N)})}var oe=s(b,2);{var Ce=M=>{var S=Ki(),q=H(S),X=a(q);{var te=x=>{var l=Ii(),f=H(l),Y=s(f,2),z=a(Y);p(()=>{Me(f,`monster_attr ${t().attributes[0]??""} svelte-7xhk0x`),g(z,`${ja[t().attributes[0]]??""}属性`)}),r(x,l)};w(X,x=>{t().attributes&&x(te)})}var k=s(X,2);{var j=x=>{var l=Oi(),f=a(l);p(()=>{Me(l,`monster_cat ${t().types[0]??""} svelte-7xhk0x`),g(f,`${ma[t().types[0]]??""}${$a[t().types[0]]??""}族`)}),r(x,l)};w(k,x=>{t().types&&x(j)})}var A=s(k,4),I=a(A),O=s(A,2);{var de=x=>{var l=Ri(),f=s(H(l),2),Y=a(f);p(()=>g(Y,t().defense??"?")),r(x,l)};w(O,x=>{var l;(l=t().monsterCategories)!=null&&l.includes("Link")||x(de)})}var T=s(q,2);ce(T,5,()=>t().monsterCategories??[],me,(x,l)=>{var f=Wi(),Y=a(f);p(()=>{Me(f,`monster_cat ${e(l)??""} svelte-7xhk0x`),g(Y,`${va[e(l)]??""}${ca[e(l)]??""}`)}),r(x,f)}),p(()=>g(I,t().attack??"?")),r(M,S)},he=M=>{var S=je(),q=H(S);{var X=k=>{var j=zi(),A=s(a(j),2),I=a(A);p(()=>g(I,`${ga[t().spellCategory]??""}魔法`)),r(k,j)},te=k=>{var j=je(),A=H(j);{var I=O=>{var de=Vi(),T=s(a(de),2),x=a(T);p(()=>g(x,`${ya[t().trapCategory]??""}罠`)),r(O,de)};w(A,O=>{t().kind==="Trap"&&t().trapCategory&&O(I)},!0)}r(k,j)};w(q,k=>{t().kind==="Spell"&&t().spellCategory?k(X):k(te,!1)},!0)}r(M,S)};w(oe,M=>{t().kind==="Monster"?M(Ce):M(he,!1)})}var fe=s(oe,2),ie=a(fe),Ee=a(ie),De=a(Ee),F=s(fe,2);{var K=M=>{var S=Xi();r(M,S)};w(F,M=>{t().isOldVersion&&M(K)})}var pe=s(F,2);{var se=M=>{var S=Gi();r(M,S)},Te=M=>{var S=Qi(),q=a(S),X=a(q),te=s(q,2),k=s(te,2);p(j=>{it(q,"href",j),g(X,`⇒${(t().cardId?"公式カードページ":"公式で検索")??""}`),it(te,"href",`https://yugioh-wiki.net/index.php?${t().wikiEncodedName}`),it(k,"href",`https://www.google.com/search?q=遊戯王 ${t().name}`)},[()=>gr(t())],ve),r(M,S)};w(pe,M=>{t().isForTest?M(se):M(Te,!1)})}p((M,S)=>{Me($,`duel_card duel_card_info ${t().kind??""} ${M??""} svelte-7xhk0x`),g(Q,t().name),ee.disabled=!t().isImplemented,it(ee,"title",t().isImplemented?`※shiftキー同時押しで一括投入
※ctrlキー同時押しで枚数制限無視`:""),ue.disabled=S,it(ue,"title",t().isImplemented?"※shiftキー同時押しで一括外し":""),g(De,t().description)},[()=>{var M;return(M=t().monsterCategories)==null?void 0:M.join(" ")},()=>c()[ua(t())].every(M=>M.name!==t().name)],ve),Z("click",ee,M=>m().onCardAppend(M,t())),Z("click",ue,M=>m().onCardRemove(M,t())),Z("click",$,()=>v()(t())),r(W,$)};w(d,W=>{t()&&W(U)})}r(_,u),ut()}const eo={0:{aaa:"日",aaaa:"日曜日",ddd:"Sun",dddd:"Sunday"},1:{aaa:"月",aaaa:"月曜日",ddd:"Mon",dddd:"Monday"},2:{aaa:"火",aaaa:"火曜日",ddd:"Tue",dddd:"Tuesday"},3:{aaa:"水",aaaa:"水曜日",ddd:"Wed",dddd:"Wednesday"},4:{aaa:"木",aaaa:"木曜日",ddd:"Thu",dddd:"Thursday"},5:{aaa:"金",aaaa:"金曜日",ddd:"Fri",dddd:"Friday"},6:{aaa:"土",aaaa:"土曜日",ddd:"Sat",dddd:"Saturday"}};class to{constructor(){st(this,"DefaultSeparator1","/");st(this,"DefaultSeparator2"," ");st(this,"DefaultSeparator3",":");st(this,"createDate",i=>{if(!i)return;const t=new Date(i);if(!isNaN(t.getTime()))return t});st(this,"createDateOr",(i,t)=>this.createDate(i)||t||new Date);st(this,"truncateDate",i=>{const t=i||new Date;return new Date(t.getFullYear(),t.getMonth(),t.getDate())});st(this,"addDate",(i,t)=>{const v=this.createDateOr(i);return v.setDate(v.getDate()+t),v});st(this,"addMonth",(i,t)=>{const v=this.createDateOr(i);return v.setMonth(v.getMonth()+t),v});st(this,"addYear",(i,t)=>{const v=this.createDateOr(i);return v.setFullYear(v.getFullYear()+t),v});st(this,"getDayOfWeek",(i,t="dddd")=>{const v=this.createDate(i);return v?eo[v.getDay()][t]:""});st(this,"formatToYYYYMMDD",(i,t=this.DefaultSeparator1)=>{const v=this.createDate(i);if(!v)return"";const m=v.getFullYear().toString(),c=("0"+(v.getMonth()+1)).slice(-2),u=("0"+v.getDate()).slice(-2);return m+t+c+t+u});st(this,"formatToYYYYMM",(i,t=this.DefaultSeparator1)=>{const v=this.createDate(i);if(!v)return"";t||(t="");const m=v.getFullYear().toString(),c=("0"+(v.getMonth()+1)).slice(-2);return m+t+c});st(this,"formatToHHMMSS",(i,t=this.DefaultSeparator3)=>{const v=this.createDate(i);if(!v)return"";t||(t="");const m=v.getHours(),c=v.getMinutes(),u=v.getSeconds();return("0"+m).slice(-2)+t+("0"+c).slice(-2)+t+("0"+u).slice(-2)});st(this,"formatToHHMM",(i,t=this.DefaultSeparator3)=>{const v=this.createDate(i);if(!v)return"";t||(t="");const m=("0"+v.getHours()).slice(-2),c=("0"+v.getMinutes()).slice(-2);return m+t+c});st(this,"formatToYYYYMMDD_HHMM",(i,t=this.DefaultSeparator1,v=this.DefaultSeparator2,m=this.DefaultSeparator3)=>{const c=this.createDate(i);return c?this.formatToYYYYMMDD(c,t)+v+this.formatToHHMM(c,m):""});st(this,"formatToYYYYMMDD_HHMMSS",(i,t=this.DefaultSeparator1,v=this.DefaultSeparator2,m=this.DefaultSeparator3)=>{const c=this.createDate(i);return c?this.formatToYYYYMMDD(c,t)+v+this.formatToHHMMSS(c,m):""})}}const bt=new to;Date.prototype.truncateDate=function(){return bt.truncateDate(this)};Date.prototype.getCloneOr=function(_){return bt.createDateOr(this,_)};Date.prototype.addDate=function(_){return bt.addDate(this,_)};Date.prototype.addMonth=function(_){return bt.addDate(this,_)};Date.prototype.addYear=function(_){return bt.addDate(this,_)};Date.prototype.getDayOfWeek=function(_="dddd"){return bt.getDayOfWeek(this,_)};Date.prototype.formatToYYYYMM=function(_){return bt.formatToYYYYMM(this,_)};Date.prototype.formatToYYYYMMDD=function(_){return bt.formatToYYYYMMDD(this,_)};Date.prototype.formatToYYYYMMDD_HHMM=function(_,i,t){return bt.formatToYYYYMMDD_HHMM(this,_,i,t)};Date.prototype.formatToYYYYMMDD_HHMMSS=function(_,i,t){return bt.formatToYYYYMMDD_HHMMSS(this,_,i,t)};Date.prototype.formatToHHMM=function(_){return bt.formatToHHMM(this,_)};Date.prototype.formatToHHMMSS=function(_){return bt.formatToHHMMSS(this,_)};var ao=n('<li class="deck_info_list_item svelte-2wdgc8"><div class="svelte-2wdgc8"> </div> <div class="svelte-2wdgc8"> </div> <div class="svelte-2wdgc8"> </div></li>'),ro=n('<ul class="deck_info_list svelte-2wdgc8"></ul>'),so=n('<label for="file_selector" class="upload_area svelte-2wdgc8" role="region" aria-label="ファイルアップロードエリア"><div class="upload_area_message svelte-2wdgc8">ここにファイルをドロップ</div> <div class="upload_area_footer svelte-2wdgc8"><input type="file" id="file_selector" name="file_selector" accept=".json" multiple></div></label>'),io=n('<div slot="body" class="modal_body svelte-2wdgc8"><!></div>'),oo=n('<button class="svelte-2wdgc8">追加</button> <button class="svelte-2wdgc8">削除して追加</button> <button class="svelte-2wdgc8">戻る</button>',1),no=n('<button class="svelte-2wdgc8">Cancel</button>'),lo=n('<div slot="footer" class="modal_window_footer svelte-2wdgc8"><!></div>');function vo(_,i){ct(i,!1);let t=Pe(i,"eventHolder",8),v=Pe(i,"args",8),m=Pe(i,"resolve",8),c=_e(Promise.resolve([])),u=_e();const d=()=>{C(u,new DataTransfer().files),C(c,Promise.resolve([]))},U=async L=>{L.preventDefault(),console.log("hoge",L)},W=async L=>{L.preventDefault(),L.dataTransfer&&D(L.dataTransfer.files)},$=()=>{D(e(u))},D=async L=>{if(!L.length)return;const Q=[],G=[];for(const P of L)try{G.push(...await Dt.createfromJson(P))}catch(E){E instanceof Error&&Q.push(E.message)}if(Q.length){console.log(...Q);return}C(c,e(c).then(()=>G))},o=d;_t(),yr(_,{get eventHolder(){return t()},get args(){return v()},$$slots:{body:(L,Q)=>{var G=io(),P=a(G);pt(P,()=>la,null,(E,ee)=>{var ue=je(),B=H(ue);pt(B,()=>e(c),null,(b,N)=>{var oe=je(),Ce=H(oe);{var he=ie=>{var Ee=ro();ce(Ee,5,()=>e(N),me,(De,F)=>{var K=ao(),pe=a(K),se=a(pe),Te=s(pe,2),M=a(Te),S=s(Te,2),q=a(S);p((X,te,k)=>{g(se,e(F).name),g(M,`${X??""}
                  /
                  ${te??""}`),g(q,`最終使用日時 ： ${k??""}`)},[()=>e(F).cardNames.filter(X=>{var te,k;return!((k=(te=e(ee).getCardInfo(X))==null?void 0:te.monsterCategories)!=null&&k.union(ta).length)}).length,()=>e(F).cardNames.filter(X=>{var te,k;return(k=(te=e(ee).getCardInfo(X))==null?void 0:te.monsterCategories)==null?void 0:k.union(ta).length}).length,()=>e(F).lastUsedAt.formatToYYYYMMDD_HHMM("/"," ",":")],ve),r(De,K)}),r(ie,Ee)},fe=ie=>{var Ee=so(),De=s(a(Ee),2),F=a(De);hr(F,()=>e(u),K=>C(u,K)),Z("change",F,$),Z("cancel",F,o),Z("drop",Ee,W),Z("dragover",Ee,U),r(ie,Ee)};w(Ce,ie=>{e(N).length?ie(he):ie(fe,!1)})}r(b,oe)}),r(E,ue)}),r(L,G)},footer:(L,Q)=>{var G=lo(),P=a(G);pt(P,()=>e(c),null,(E,ee)=>{var ue=je(),B=H(ue);{var b=oe=>{var Ce=oo(),he=H(Ce),fe=s(he,2),ie=s(fe,2);p(()=>{he.disabled=e(ee).length===0,fe.disabled=e(ee).length===0}),Z("click",he,()=>m()({deckInfos:e(ee),replaceAll:!1})),Z("click",fe,()=>m()({deckInfos:e(ee),replaceAll:!0})),Z("click",ie,o),r(oe,Ce)},N=oe=>{var Ce=je(),he=H(Ce);{var fe=ie=>{var Ee=no();Z("click",Ee,()=>m()(void 0)),r(ie,Ee)};w(he,ie=>{v().cancelable&&ie(fe)},!0)}r(oe,Ce)};w(B,oe=>{e(ee).length?oe(b):oe(N,!1)})}r(E,ue)}),r(L,G)}}}),ut()}const pa=class pa extends kr{constructor(i,t){super(i,...Object.values(t))}};st(pa,"createModalController",i=>{const t={deckUploader:new xr({title:"デッキ情報をアップロード",position:"Middle",cancelable:!1})};return Object.assign(new pa(i,t),t)});let Da=pa;function co(_,i){ct(i,!1);let t=Pe(i,"modalController",8);_t(),br(_,{get modalController(){return t()},children:(v,m)=>{var c=je(),u=H(c);{var d=U=>{vo(U,{get eventHolder(){return t().eventHolder},get args(){return t().deckUploader.args},get resolve(){return t().deckUploader.resolve}})};w(u,U=>{t().deckUploader.state==="Shown"&&U(d)})}r(v,c)},$$slots:{default:!0}}),ut()}var _o=n("<button> </button>"),uo=n('<label class="svelte-o6gmje"><input type="checkbox" class="search_condition svelte-o6gmje"> </label>'),fo=n('<label class="svelte-o6gmje"><input type="checkbox" class="search_condition svelte-o6gmje"> </label>'),po=n('<div class="deck_editor_search_box_row monster_ex_categories svelte-o6gmje"><div class="svelte-o6gmje"><button class="search_condition_title black_button svelte-o6gmje">エクストラ</button></div> <div class="svelte-o6gmje"></div></div>'),mo=n('<label class="svelte-o6gmje"><input type="checkbox" class="search_condition svelte-o6gmje"> </label>'),go=n('<label class="svelte-o6gmje"><input type="checkbox" class="search_condition svelte-o6gmje"> <div style="display: inline-block;"></div> </label>'),yo=n('<label class="svelte-o6gmje"><input type="checkbox" class="search_condition svelte-o6gmje"> </label>'),ho=n('<div class="deck_editor_search_box_row monster_categories svelte-o6gmje"><div class="svelte-o6gmje"><button class="search_condition_title black_button svelte-o6gmje">モンスター</button></div> <div class="svelte-o6gmje"></div></div> <div class="deck_editor_search_box_row monster_attributes svelte-o6gmje"><div class="svelte-o6gmje"><button class="search_condition_title black_button svelte-o6gmje">属性</button></div> <div class="svelte-o6gmje"></div></div> <div class="deck_editor_search_box_row svelte-o6gmje"><div class="svelte-o6gmje"><button class="search_condition_title black_button svelte-o6gmje">種族</button></div> <div class="svelte-o6gmje"></div></div> <div class="deck_editor_search_box_row svelte-o6gmje"><div class="svelte-o6gmje"><button class="search_condition_title black_button svelte-o6gmje">星攻守</button></div> <div class="svelte-o6gmje"><div class="star_range svelte-o6gmje"><span class="svelte-o6gmje">星</span> <input type="number" min="0" max="13" class="svelte-o6gmje"> <span class="svelte-o6gmje">～</span> <input type="number" min="0" max="13" class="svelte-o6gmje"></div> <div class="atk_range svelte-o6gmje"><span class="svelte-o6gmje">攻</span> <input type="number" min="0" max="5000" step="100" class="svelte-o6gmje"> <span class="svelte-o6gmje">～</span> <input type="number" min="0" max="5000" step="100" class="svelte-o6gmje"></div> <div class="def_range svelte-o6gmje"><span class="svelte-o6gmje">守</span> <input type="number" min="0" max="5000" step="100" class="svelte-o6gmje"> <span class="svelte-o6gmje">～</span> <input type="number" min="0" max="5000" step="100" class="svelte-o6gmje"></div> <div class="atk_plus_def svelte-o6gmje"><span class="svelte-o6gmje">攻+守</span> <input type="number" min="0" max="10000" step="100" class="svelte-o6gmje"></div></div></div>',1),bo=n('<label class="svelte-o6gmje"><input type="checkbox" class="search_condition svelte-o6gmje"> </label>'),ko=n('<div class="deck_editor_search_box_row svelte-o6gmje"><div class="svelte-o6gmje"><button class="search_condition_title black_button svelte-o6gmje">魔法</button></div> <div class="svelte-o6gmje"></div></div>'),xo=n('<label class="svelte-o6gmje"><input type="checkbox" class="search_condition svelte-o6gmje"> </label>'),wo=n('<div class="deck_editor_search_box_row svelte-o6gmje"><div class="svelte-o6gmje"><button class="search_condition_title black_button svelte-o6gmje">罠</button></div> <div class="svelte-o6gmje"></div></div>'),Co=n('<label class="svelte-o6gmje"><input type="checkbox" class="search_condition svelte-o6gmje"> </label>'),Do=n('<div class="deck_editor_card_detail svelte-o6gmje"><!></div>'),jo=n("<div>カード情報読込中</div>"),$o=n("<option> </option>"),So=n('<div class="svelte-o6gmje"><a class="white_button svelte-o6gmje" download="SVS_DeckInfos.json">ダウンロード</a></div>'),To=n('<div class="svelte-o6gmje"></div>'),Mo=n('<div class="svelte-o6gmje"><a class="white_button svelte-o6gmje" download="SVS_DeckInfos.json">ダウンロード(一括)</a></div>'),Eo=n('<div class="svelte-o6gmje"></div>'),Bo=n('<div class="deck_editor_body_right_header svelte-o6gmje"><div class="deck_editor_body_right_header_row svelte-o6gmje"><div class="svelte-o6gmje">編集対象</div> <div class="svelte-o6gmje"><select style="width:100%" class="svelte-o6gmje"></select></div></div> <div class="deck_editor_body_right_header_row svelte-o6gmje"><div class="svelte-o6gmje">新規名称</div> <div class="svelte-o6gmje"><input type="text" style="width:100%" class="svelte-o6gmje"></div></div> <div class="deck_editor_body_right_header_row svelte-o6gmje"></div> <div class="deck_editor_body_right_header_row svelte-o6gmje"><div class="svelte-o6gmje">基本操作</div> <div class="svelte-o6gmje"><button class="white_button svelte-o6gmje">デッキを保存</button></div> <div class="svelte-o6gmje"><button class="white_button svelte-o6gmje">デッキを複製</button></div> <div class="svelte-o6gmje"><button class="white_button svelte-o6gmje" title="shiftキー押下で確認メッセージスキップ">デッキを削除</button></div></div> <div class="deck_editor_body_right_header_row svelte-o6gmje"><div class="svelte-o6gmje">DL/UL</div> <!> <!> <div class="svelte-o6gmje"><button class="white_button svelte-o6gmje">アップロード</button></div></div></div> <div><!></div>',1),Ao=n("<div>デッキ情報読込中</div>"),Lo=n('<div class="deck_editor_body_right_dummy svelte-o6gmje"></div>'),Yo=n("<div><!></div>"),Uo=n('<div><div class="deck_editor_header svelte-o6gmje"></div> <div class="deck_editor_body svelte-o6gmje"><div class="deck_editor_body_left svelte-o6gmje"><div role="contentinfo" class="deck_editor_search_box svelte-o6gmje"><div class="deck_editor_search_box_header svelte-o6gmje"><div class="svelte-o6gmje"><button class="deck_editor_search_box_title svelte-o6gmje">検索条件</button></div> <div class="deck_editor_sort_setting_container svelte-o6gmje"></div></div> <div class="deck_editor_search_box_body svelte-o6gmje"><div class="deck_editor_search_box_row svelte-o6gmje"><div class="svelte-o6gmje"><button class="search_condition_title black_button svelte-o6gmje">名称</button></div> <div class="svelte-o6gmje"><input type="text" style="width:100%" placeholder="※ルビには対応していません" class="svelte-o6gmje"></div></div> <div class="deck_editor_search_box_row card_kind svelte-o6gmje"><div class="svelte-o6gmje"><button class="search_condition_title black_button svelte-o6gmje">種類</button></div> <div class="svelte-o6gmje"></div></div> <!> <!> <!> <!> <div class="deck_editor_search_box_row svelte-o6gmje"><div class="svelte-o6gmje"><button class="search_condition_title black_button svelte-o6gmje">その他</button></div> <div class="svelte-o6gmje"></div></div></div></div> <!></div> <div class="deck_editor_body_center svelte-o6gmje"><div class="deck_editor_body_center_body svelte-o6gmje"><!></div></div>  <div class="deck_editor_body_right svelte-o6gmje"><!></div></div> <div class="footer svelte-o6gmje"></div></div> <!> <!>',1);function No(_,i){ct(i,!1);const t=[],v=[],m=[],c=[],u=[],d=[],U=[],W=[],$=Da.createModalController({onDragStart:{append:()=>{},remove:()=>{}},onDragEnd:{append:()=>{},remove:()=>{}}}),D={name:"",deckCardKinds:[...ea],exMonsterCategories:[...ta],monsterCategories:Na.filter(h=>!ta.includes(h)),monsterAttributes:[...Ua],monsterTypes:[...Ya],spellCategories:La.filter(h=>h!=="PendulumScale"),trapCategories:[...Aa],starLowerBound:0,starUpperBound:13,atkLowerBound:0,atkUpperBound:5e3,defLowerBound:0,defUpperBound:5e3,atkPlusDef:void 0,others:["test","oldVersion","implemented"],sort:[...Pa]},o=_e(structuredClone(D));xe(o,e(o).others=["oldVersion"]),xe(o,e(o).monsterCategories=["Effect","Tuner","Pendulum"]);let L=_e("DeckEdit"),Q=_e("SearchCondition");const G=()=>{if(!e(o).deckCardKinds.length){Kt(e(o)).forEach(h=>{Array.isArray(e(o)[h])&&Array.isArray(D[h])?xe(o,e(o)[h]=[...D[h]]):xe(o,e(o)[h]=D[h])});return}xe(o,e(o).name=""),xe(o,e(o).deckCardKinds=[]),xe(o,e(o).exMonsterCategories=[]),xe(o,e(o).monsterCategories=[]),xe(o,e(o).monsterAttributes=[]),xe(o,e(o).monsterTypes=[]),xe(o,e(o).spellCategories=[]),xe(o,e(o).trapCategories=[]),xe(o,e(o).others=[]),xe(o,e(o).atkLowerBound=0),xe(o,e(o).atkUpperBound=5e3),xe(o,e(o).defLowerBound=0),xe(o,e(o).defUpperBound=5e3),xe(o,e(o).atkPlusDef=void 0),xe(o,e(o).sort=[...Pa])},P=h=>{h.forEach(y=>{Array.isArray(e(o)[y])&&Array.isArray(D[y])?xe(o,e(o)[y]=e(o)[y].length?[]:[...D[y]]):xe(o,e(o)[y]=D[y])})};let E=_e(),ee,ue=_e(!1);const B=200,b=()=>{C(ue,!1),C(E,void 0),ee=void 0},N=(h,y)=>{const R=ua(y),J=e(se).cardTree[R].filter(Ue=>Ue.name===y.name).length;let ge=h.shiftKey?3-J:1;console.debug(y,R,J,ge),!h.ctrlKey&&J>2&&(ge=0),ge&&xe(se,e(se).cardTree[R]=[...e(se).cardTree[R],...Array(ge).fill(y)].sort(Ga)),b(),S(y)},oe=(h,y)=>{const R=ua(y);let J=0;xe(se,e(se).cardTree[R]=e(se).cardTree[R].filter(ge=>ge.name!==y.name?!0:(J++,!h.shiftKey&&J>1))),b(),S(y)},Ce=h=>{if(h.changedTouches&&h.changedTouches.length!==1)return;const{clientX:y,clientY:R}=h.changedTouches?h.changedTouches[0]:h;return{clientX:y,clientY:R}},he={onCardAppend:N,onCardRemove:oe,onCardDragCancel:b,onCardDragStart:(h,y,R)=>{if(S(R),y!=="List"&&y!=="Deck"){b();return}if(y==="List"&&!R.isImplemented){b();return}const J=Ce(h);if(!J){b();return}ee={from:y,cardInfo:R,pos:J,startPos:J},zt(B).then(()=>{(ee==null?void 0:ee.cardInfo)===R&&C(E,ee)}),C(ue,!1)},onCardDragging:(h,y)=>{if(!ee){b();return}const R=Ce(h);if(!R){b();return}const J=e(E)||ee;C(ue,!!(J.from==="List"&&J.cardInfo.isImplemented&&document.elementsFromPoint(R.clientX,R.clientY).some(ge=>ge.classList.contains("deck_editor_body_right_body")||ge.classList.contains("deck_editor_body_right_dummy")))),e(ue)&&C(L,"DeckEdit"),e(E)?C(E,{...e(E),pos:R}):ee.pos={...R}},onCardDragEnd:h=>{if(!ee||!e(E)){b();return}const y=Ce(h);if(!y){b();return}e(E).from==="List"&&e(E).cardInfo.isImplemented&&document.elementsFromPoint(y.clientX,y.clientY).some(R=>R.classList.contains("deck_editor_body_right_body"))&&N(h,e(E).cardInfo),e(E).from==="Deck"&&!document.elementsFromPoint(y.clientX,y.clientY).some(R=>R.classList.contains("deck_editor_body_right_body"))&&oe(h,e(E).cardInfo),b()}},fe=(h,y,R)=>{Array.isArray(e(o)[y])&&Array.isArray(D[y])&&xe(o,e(o)[y]=[R])},ie=async()=>{const y=(await e(F)).find(J=>J.id===e(De));if(!y)return;const R=await la;C(se,{...y,cardTree:Cr(y.cardNames.map(J=>{const ge=R.getCardInfo(J);return ge===void 0&&console.error(J),ge}).filter(J=>J!==void 0))})},Ee=()=>Dt.getAllDeckInfo().then(h=>(C(De,(h.find(y=>y.lastUsedAt.getTime()===Math.max(...h.map(R=>R.lastUsedAt.getTime())))??h[0]).id),h));let De=_e(-1),F=_e(Ee()),K=_e(e(F).then(h=>Dt.convertToObjectURL(h)));e(F).then(ie);const pe=()=>{C(F,Ee()),C(K,e(F).then(h=>Dt.convertToObjectURL(h))),ie()};let se=_e({id:-Number.MAX_VALUE,name:"",description:"",lastUsedAt:new Date,cardTree:{ExtraMonster:[],Monster:[],Spell:[],Trap:[]}}),Te=_e(void 0),M=0;const S=h=>{C(Q,"CardDetail"),h.cardId!==void 0&&!h.description&&!h.pendulumDescription&&(M=h.cardId,ka([h.cardId]).then(()=>{h.cardId===M&&C(Te,h)})),C(Te,h)},q=async()=>{const y=(await e(F)).find(R=>R.id===e(De));if(!y)throw new Error("illegal state");return y},X=async()=>{const h=await q();await h.saveDeckInfo({...h,name:e(se).name,cardNames:Object.values(e(se).cardTree).flatMap(y=>y).map(y=>y.name),lastUsedAt:new Date}),pe()},te=async()=>{(await Dt.createNewDeck(`デッキ_${new Date().formatToYYYYMMDD_HHMMSS("","","")}`,`コピー日時：${new Date().formatToYYYYMMDD_HHMMSS("-"," ",":")}`,Object.values(e(se).cardTree).flatMap(y=>y).map(y=>y.name))).saveDeckInfo(),pe()},k=async h=>{const y=await q();!h.shiftKey&&!confirm(`デッキ【${y.name}】を削除します。
よろしいですか？`)||(await y.delete(),pe())},j=async()=>{const h=await $.deckUploader.show({title:"デッキ情報アップロード",position:"Middle",cancelable:!0});if(!h)return;const y=[];if(h.replaceAll){if(!confirm(`既存デッキ情報を全て削除し、アップロードしたファイルに置き換えます。
よろしいですか？`))return;y.push(...(await e(F)).map(R=>R.id))}await Promise.all(h.deckInfos.map(R=>Dt.createNewDeck(R.name,R.description,R.cardNames,R.lastUsedAt))),y.length&&await Promise.all(y.map(Dt.remove)),pe()},A=()=>innerWidth<=1400?"compact":"wide";_t();var I=Uo(),O=H(I),de=s(a(O),2),T=a(de),x=a(T),l=a(x),f=a(l),Y=a(f),z=s(f,2);ce(z,5,()=>e(o).sort,me,(h,y,R)=>{var J=_o(),ge=a(J);p(()=>{Me(J,`deck_editor_sort_setting_item ${e(y).order??""} priority_${e(y).priority??""} svelte-o6gmje`),g(ge,`${wr[e(y).key]??""}
                ${(e(y).order==="asc"?"▲":"▼")??""}`)}),Z("click",J,()=>{e(o).sort.forEach(Ue=>Ue.priority++),e(y).order=e(y).order==="asc"?"desc":"asc",Ft(()=>e(o).sort),e(y).priority=1,Ft(()=>e(o).sort)}),r(h,J)});var ye=s(l,2),be=a(ye),le=a(be),ae=a(le),V=s(le,2),re=a(V),$e=s(be,2),Fe=a($e),He=a(Fe),Ie=s(Fe,2);ce(Ie,5,()=>ea,me,(h,y)=>{var R=uo(),J=a(R),ge,Ue=s(J);p(()=>{ge!==(ge=e(y))&&(J.value=(J.__value=e(y))==null?"":e(y)),g(Ue,` ${Xa[e(y)]??""}`)}),Ht(t,[],J,()=>(e(y),e(o).deckCardKinds),Se=>xe(o,e(o).deckCardKinds=Se)),r(h,R)});var Le=s($e,2);{var Ve=h=>{var y=po(),R=a(y),J=a(R),ge=s(R,2);ce(ge,5,()=>ta,me,(Ue,Se)=>{var We=fo(),Re=a(We),Ke,Ze=s(Re);p(()=>{Ke!==(Ke=e(Se))&&(Re.value=(Re.__value=e(Se))==null?"":e(Se)),g(Ze,` ${va[e(Se)]??""}${ca[e(Se)]??""}`)}),Ht(v,[],Re,()=>(e(Se),e(o).exMonsterCategories),dt=>xe(o,e(o).exMonsterCategories=dt)),r(Ue,We)}),Z("click",J,()=>P(["exMonsterCategories"])),ne(3,y,()=>we,()=>({delay:0,duration:100})),r(h,y)};w(Le,h=>{e(o).deckCardKinds.includes("ExtraMonster")&&h(Ve)})}var ot=s(Le,2);{var Ae=h=>{var y=ho(),R=H(y),J=a(R),ge=a(J),Ue=s(J,2);ce(Ue,5,()=>Na.filter(Ne=>!ta.includes(Ne)),me,(Ne,qe)=>{var rt=mo(),et=a(rt),Ct,qt=s(et);p(()=>{Ct!==(Ct=e(qe))&&(et.value=(et.__value=e(qe))==null?"":e(qe)),g(qt,` ${va[e(qe)]??""}${ca[e(qe)]??""}`)}),Ht(m,[],et,()=>(e(qe),e(o).monsterCategories),Ot=>xe(o,e(o).monsterCategories=Ot)),r(Ne,rt)});var Se=s(R,2),We=a(Se),Re=a(We),Ke=s(We,2);ce(Ke,5,()=>Ua,me,(Ne,qe)=>{var rt=go(),et=a(rt),Ct,qt=s(et,2),Ot=s(qt);p(()=>{Ct!==(Ct=e(qe))&&(et.value=(et.__value=e(qe))==null?"":e(qe)),Me(qt,`monster_attr ${e(qe)??""} svelte-o6gmje`),g(Ot,` ${ja[e(qe)]??""}`)}),Ht(c,[],et,()=>(e(qe),e(o).monsterAttributes),Ja=>xe(o,e(o).monsterAttributes=Ja)),r(Ne,rt)});var Ze=s(Se,2),dt=a(Ze),Nt=a(dt),Tt=s(dt,2);ce(Tt,5,()=>Ya,me,(Ne,qe)=>{var rt=yo(),et=a(rt),Ct,qt=s(et);p(()=>{Ct!==(Ct=e(qe))&&(et.value=(et.__value=e(qe))==null?"":e(qe)),g(qt,` ${ma[e(qe)]??""}
                    ${$a[e(qe)]??""}`)}),Ht(u,[],et,()=>(e(qe),e(o).monsterTypes),Ot=>xe(o,e(o).monsterTypes=Ot)),Z("dblclick",rt,Ot=>fe(Ot,"monsterTypes",e(qe))),r(Ne,rt)});var wt=s(Ze,2),gt=a(wt),mt=a(gt),Pt=s(gt,2),Bt=a(Pt),It=s(a(Bt),2),Gt=s(It,4),nt=s(Bt,2),Xe=s(a(nt),2),lt=s(Xe,4),yt=s(nt,2),ht=s(a(yt),2),Qt=s(ht,4),Ge=s(yt,2),at=s(a(Ge),2);Z("click",ge,()=>P(["monsterCategories"])),ne(3,R,()=>we,()=>({delay:0,duration:100})),Z("click",Re,()=>P(["monsterAttributes"])),ne(3,Se,()=>we,()=>({delay:0,duration:100})),Z("click",Nt,()=>P(["monsterTypes"])),ne(3,Ze,()=>we,()=>({delay:0,duration:100})),Z("click",mt,()=>P(["starLowerBound","starUpperBound","atkLowerBound","atkUpperBound","defLowerBound","defUpperBound","atkPlusDef"])),Mt(It,()=>e(o).starLowerBound,Ne=>xe(o,e(o).starLowerBound=Ne)),Mt(Gt,()=>e(o).starUpperBound,Ne=>xe(o,e(o).starUpperBound=Ne)),Mt(Xe,()=>e(o).atkLowerBound,Ne=>xe(o,e(o).atkLowerBound=Ne)),Mt(lt,()=>e(o).atkUpperBound,Ne=>xe(o,e(o).atkUpperBound=Ne)),Mt(ht,()=>e(o).defLowerBound,Ne=>xe(o,e(o).defLowerBound=Ne)),Mt(Qt,()=>e(o).defUpperBound,Ne=>xe(o,e(o).defUpperBound=Ne)),Mt(at,()=>e(o).atkPlusDef,Ne=>xe(o,e(o).atkPlusDef=Ne)),ne(3,wt,()=>we,()=>({delay:0,duration:100})),r(h,y)};w(ot,h=>{(e(o).deckCardKinds.includes("Monster")||e(o).deckCardKinds.includes("ExtraMonster"))&&h(Ae)})}var ke=s(ot,2);{var Be=h=>{var y=ko(),R=a(y),J=a(R),ge=s(R,2);ce(ge,5,()=>La.filter(Ue=>Ue!=="PendulumScale"),me,(Ue,Se)=>{var We=bo(),Re=a(We),Ke,Ze=s(Re);p(()=>{Ke!==(Ke=e(Se))&&(Re.value=(Re.__value=e(Se))==null?"":e(Se)),g(Ze,` ${ga[e(Se)]??""}`)}),Ht(d,[],Re,()=>(e(Se),e(o).spellCategories),dt=>xe(o,e(o).spellCategories=dt)),r(Ue,We)}),Z("click",J,()=>P(["spellCategories"])),ne(3,y,()=>we,()=>({delay:0,duration:100})),r(h,y)};w(ke,h=>{e(o).deckCardKinds.includes("Spell")&&h(Be)})}var Ye=s(ke,2);{var Oe=h=>{var y=wo(),R=a(y),J=a(R),ge=s(R,2);ce(ge,5,()=>Aa,me,(Ue,Se)=>{var We=xo(),Re=a(We),Ke,Ze=s(Re);p(()=>{Ke!==(Ke=e(Se))&&(Re.value=(Re.__value=e(Se))==null?"":e(Se)),g(Ze,` ${ya[e(Se)]??""}`)}),Ht(U,[],Re,()=>(e(Se),e(o).trapCategories),dt=>xe(o,e(o).trapCategories=dt)),r(Ue,We)}),Z("click",J,()=>P(["trapCategories"])),ne(3,y,()=>we,()=>({delay:0,duration:100})),r(h,y)};w(Ye,h=>{e(o).deckCardKinds.includes("Trap")&&h(Oe)})}var tt=s(Ye,2),ze=a(tt),Je=a(ze),jt=s(ze,2);ce(jt,4,()=>[{key:"test",text:"テスト用カード"},{key:"oldVersion",text:"エラッタ前カード"},{key:"implemented",text:"未実装カード"}],me,(h,y)=>{var R=Co(),J=a(R),ge,Ue=s(J);p(()=>{ge!==(ge=y.key)&&(J.value=(J.__value=y.key)==null?"":y.key),g(Ue,` ${y.text??""}`)}),Ht(W,[],J,()=>(y.key,e(o).others),Se=>xe(o,e(o).others=Se)),r(h,R)});var vt=s(x,2);{var $t=h=>{var y=Do(),R=a(y);Zi(R,{get cardInfo(){return e(Te)},onAttention:S,cardControlEventHandlers:he,get deckCardTree(){return e(se).cardTree}}),r(h,y)};w(vt,h=>{e(Q)==="CardDetail"&&e(Te)&&h($t)})}var Et=s(T,2),Yt=a(Et),ra=a(Yt);pt(ra,()=>la,h=>{var y=jo();r(h,y)},(h,y)=>{Wa(h,{mode:"List",get allCardTree(){return e(y).tree},onAttention:S,get searchCondition(){return e(o)},cardControlEventHandlers:he,get deckCardTree(){return e(se).cardTree},set deckCardTree(R){xe(se,e(se).cardTree=R)},$$legacy:!0})});var Ut=s(Et,2),Xt=a(Ut);{var kt=h=>{var y=je(),R=H(y);pt(R,()=>e(F),J=>{var ge=Ao();r(J,ge)},(J,ge)=>{var Ue=Bo(),Se=H(Ue),We=a(Se),Re=s(a(We),2),Ke=a(Re);p(()=>{e(De),Ft(()=>{e(ge)})}),ce(Ke,5,()=>e(ge),me,(Ge,at)=>{var Ne=$o(),qe={},rt=a(Ne);p(()=>{qe!==(qe=e(at).id)&&(Ne.value=(Ne.__value=e(at).id)==null?"":e(at).id),g(rt,e(at).name)}),r(Ge,Ne)});var Ze=s(We,2),dt=s(a(Ze),2),Nt=a(dt),Tt=s(Ze,4),wt=s(a(Tt),2),gt=a(wt),mt=s(wt,2),Pt=a(mt),Bt=s(mt,2),It=a(Bt),Gt=s(Tt,2),nt=s(a(Gt),2);pt(nt,q,Ge=>{var at=To();r(Ge,at)},(Ge,at)=>{var Ne=So(),qe=a(Ne);p(rt=>it(qe,"href",rt),[()=>Dt.convertToObjectURL([e(at)])],ve),r(Ge,Ne)});var Xe=s(nt,2);pt(Xe,()=>e(K),Ge=>{var at=Eo();r(Ge,at)},(Ge,at)=>{var Ne=Mo(),qe=a(Ne);p(()=>it(qe,"href",e(at))),r(Ge,Ne)});var lt=s(Xe,2),yt=a(lt),ht=s(Se,2),Qt=a(ht);Wa(Qt,{mode:"Deck",allCardTree:{ExtraMonster:[],Monster:[],Spell:[],Trap:[]},onAttention:S,cardControlEventHandlers:he,get deckCardTree(){return e(se).cardTree},set deckCardTree(Ge){xe(se,e(se).cardTree=Ge)},$$legacy:!0}),p(()=>Me(ht,`deck_editor_body_right_body ${(e(ue)?"can_drop":"")??""} svelte-o6gmje`)),Zt(Ke,()=>e(De),Ge=>C(De,Ge)),Z("change",Ke,ie),Mt(Nt,()=>e(se).name,Ge=>xe(se,e(se).name=Ge)),Z("click",gt,X),Z("click",Pt,te),Z("click",It,k),Z("click",yt,j),r(J,Ue)}),r(h,y)},St=h=>{var y=Lo();r(h,y)};w(Xt,h=>{e(L)==="DeckEdit"||A()==="wide"?h(kt):h(St,!1)})}var xt=s(O,2);{var sa=h=>{var y=Yo(),R=a(y);Qa(R,{mode:"Dragging",get cardInfo(){return e(E).cardInfo},onAttention:S,cardControlEventHandlers:he}),p(()=>it(y,"style",`position: fixed;
          top:${e(E).pos.clientY??""}px;
          left:${e(E).pos.clientX??""}px;
          z-index:3; 
          filter: opacity(0.8);
        	transform: translateX(-50%) translateY(-50%);`)),r(h,y)};w(xt,h=>{e(E)&&h(sa)})}var ia=s(xt,2);co(ia,{modalController:$}),p((h,y,R)=>Me(O,`deck_editor
         screen_size_${h??""}
         left_pain_mode_${y??""}
         main_view_mode_${R??""}
         ${(e(E)?"dragging_card":"")??""}
          svelte-o6gmje`),[A,()=>e(Q).toLowerCase(),()=>e(L).toLowerCase()],ve),Z("click",Y,G),Z("click",ae,()=>P(["name"])),Mt(re,()=>e(o).name,h=>xe(o,e(o).name=h)),Z("click",He,()=>P(["deckCardKinds"])),Z("click",Je,()=>P(["others"])),ne(3,tt,()=>we,()=>({delay:0,duration:100})),Z("focusin",x,()=>{C(Q,"SearchCondition"),C(L,"SearchCondition")}),Z("click",x,()=>{C(Q,"SearchCondition"),C(L,"SearchCondition")}),Z("click",Ut,()=>{C(L,"DeckEdit")}),Z("focusin",Ut,()=>{C(L,"DeckEdit")}),Z("touchmove",O,h=>e(E)&&he.onCardDragging(h,"Overlay")),Z("mousemove",O,h=>e(E)&&he.onCardDragging(h,"Overlay")),r(_,I),ut()}const Po=["TblDeckHeader","TblDeckDetail","TblDuelistProfile"],qo=3;var Ho=n('<input class="game_mode_radio svelte-sy4ydn" type="radio" name="game_mode"> <label> </label>',1),Fo=n('<option class="svelte-sy4ydn"> </option>'),Io=n('<option class="svelte-sy4ydn"> </option>'),Oo=n('<option class="svelte-sy4ydn"> </option>'),Ro=n('<tr class="config_row svelte-sy4ydn"><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><label for="npc_deck_selector" class="config_row_label deck_selector svelte-sy4ydn">デッキ：</label></div></td><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><select id="npc_deck_selector" class="deck_selector svelte-sy4ydn"><option class="svelte-sy4ydn">デフォルト</option><!></select></div></td></tr>'),Wo=n('<option class="svelte-sy4ydn"> </option>'),Ko=n('<tr class="config_row svelte-sy4ydn"><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><label for="npc_selector" class="config_row_label npc_selector svelte-sy4ydn">対戦相手：</label></div></td><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><select id="npc_selector" class="npc_selector svelte-sy4ydn"></select> <div class="svelte-sy4ydn"> </div></div></td></tr> <!> <tr class="config_row svelte-sy4ydn"><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><label for="npc_selector" class="config_row_label npc_selector svelte-sy4ydn">先攻後攻：</label></div></td><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><select id="npc_selector" class="npc_selector svelte-sy4ydn"></select></div></td></tr>',1),zo=n('<option class="svelte-sy4ydn"> </option>'),Vo=n('<tr class="config_row svelte-sy4ydn"><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><label for="difficulty_selector" class="config_row_label difficulty_selector svelte-sy4ydn">難易度：</label></div></td><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><select id="difficulty_selector" class="difficulty_selector svelte-sy4ydn"></select></div></td></tr>'),Xo=n('<tr class="config_row svelte-sy4ydn"><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><label class="config_row_label svelte-sy4ydn" for="game_mode_radio_preset">ゲームモード：</label></div></td><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"></div></td></tr> <tr class="config_row svelte-sy4ydn"><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><label for="deck_selector" class="config_row_label deck_selector svelte-sy4ydn">デッキ：</label></div></td><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><select id="deck_selector" class="deck_selector svelte-sy4ydn"></select></div></td></tr> <!> <tr><td colspan="2" class="svelte-sy4ydn"><div><button class="btn svelte-sy4ydn">duel start!</button></div></td></tr>',1),Go=n('<tr><td colspan="2" class="svelte-sy4ydn"><div>デッキ情報の読み込み、もしくは作成中...</div></td></tr>'),Qo=n('<tr><td colspan="2" class="svelte-sy4ydn"><div><button class="btn svelte-sy4ydn">deck edit</button></div></td></tr>'),Jo=n('<tr class="config_row svelte-sy4ydn"><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><label for="duelist_name" class="config_row_label duelist_name svelte-sy4ydn">名前：</label></div></td><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><input id="duelist_name" class="duelist_name svelte-sy4ydn" type="text"></div></td></tr> <!> <!>',1),Zo=n('<tr><td colspan="2" class="svelte-sy4ydn"><div>デュエリスト情報の読み込み、もしくは作成中...</div></td></tr>'),en=n('<div class="app_body svelte-sy4ydn"><table class="config_table svelte-sy4ydn"><tbody><!></tbody></table></div>'),tn=n('<span class="svelte-sy4ydn"> </span> <span class="svelte-sy4ydn"> </span>',1),an=n('<div class="result_title result_win svelte-sy4ydn">YOU WIN</div>'),rn=n('<div class="result_title result_lose svelte-sy4ydn">YOU LOSE</div>'),sn=n('<div class="result_title result_draw svelte-sy4ydn">DRAW</div>'),on=n('<div class="twitter_share_button_wrapper svelte-sy4ydn"><a rel="nofollow" target="_blank" class="twitter_share_button svelte-sy4ydn">X(twitter)でシェアする</a></div>'),nn=n('<div class="result svelte-sy4ydn"><!> <div class="reason_of_end svelte-sy4ydn"> </div> <!> <div class="svelte-sy4ydn"><button class="white_button svelte-sy4ydn">TOPへ戻る</button></div></div>'),ln=n('<main style="flex-direction: column; display :flex" class="svelte-sy4ydn"><div class="link link_left svelte-sy4ydn"><a href="https://github.com/Setta238/stk_ygo_svelte" target="_blank" rel="noopener noreferrer" title="repository" class="svelte-sy4ydn">repository</a> <a href="https://x.com/ninja_no" target="_blank" rel="noopener noreferrer" title="repository" class="svelte-sy4ydn">X(Twitter)</a> <a href="https://posfie.com/@ninja_no/p/Lx7FLj3" target="_blank" rel="noopener noreferrer" title="posfie" class="svelte-sy4ydn">posfie(toggeter)</a></div> <div class="link link_right svelte-sy4ydn"><a class="a_button svelte-sy4ydn" role="button" tabindex="0">TOPへ戻る</a> <a href="/stk_ygo_svelte/note.html" target="_blank" rel="noopener noreferrer" title="repository" class="svelte-sy4ydn">現時点とこの先のこと</a></div> <!> <div class="footer card_summary svelte-sy4ydn"><!></div> <div class="footer debug_info svelte-sy4ydn"><span class="svelte-sy4ydn"> </span> <span class="user_agent_info svelte-sy4ydn"> </span> <span class="screen_info svelte-sy4ydn"> </span></div> <!></main>');function vn(_,i){ct(i,!1);const t=new Dr("stk_ygo_svelte",qo,Po);let v=_e(0),m=_e(0),c=_e(),u=_e("FtkChallenge"),d=_e("None"),U=_e(0),W=_e(""),$=_e(void 0);const D="https://setta238.github.io/stk_ygo_svelte/",o="遊戯王deそりてあ",L="ninja_no",Q=jr.getOrCreateNew(t).then(T=>(C(u,qa.includes(T.previousGameMode)?T.previousGameMode:"FtkChallenge"),Ee(T.previousNpcId),T)),G=T=>{var l;const x=T.find(f=>f.lastUsedAt.getTime()===Math.max(...T.map(Y=>Y.lastUsedAt.getTime())))??T[0];C(U,x.id),e(u)==="FtkChallenge"&&x.deckType!=="Preset"&&C(U,((l=Rt.find(f=>f.deckType==="Preset"))==null?void 0:l.id)??e(U))};let P=_e(Dt.getAllDeckInfo(t).then(T=>(Promise.all(T.filter(x=>!x.lastUsedAt).map(x=>{x.saveDeckInfo()})),G(T),T)));const E=async()=>{const T=e(U);let x=(await e(P)).find(f=>f.id===T)??(await ue()).find(f=>f.id===T);x&&await x.updateTimestamp();let l=x;if(l||(l=Rt.find(f=>f.id===T)),!l)throw new Error("illegal state");return l},ee=async()=>{(await Q).save({previousGameMode:e(u)})},ue=()=>(C(P,Dt.getAllDeckInfo(t).then(T=>(G(T),T))),e(P)),B=async()=>{(await e(P)).length||(await Dt.prepareSampleDeck(),ue())},b=async()=>{await Promise.all([ee(),B()]);const T=await E(),x=await Q;let l=Jt.find(z=>z.id===Number.MIN_SAFE_INTEGER)??Jt[0],f=Rt.find(z=>z.id===Number.MIN_SAFE_INTEGER)??Rt[0],Y="PlayFirst";e(u)==="FtkChallenge"?l=Jt.filter(z=>z.npcType==="FtkChallenge").find(z=>z.difficulty===x.previousDifficulty)??l:e(u)==="Free"&&(l=Jt.find(z=>z.id===x.previousNpcId)??l,f=Rt.slice(-1)[0],Y=x.previousStartMode),l.npcType!=="FtkChallenge"&&x.previousNpcDeckId>-1?f=(await e(P)).find(z=>z.id===x.previousNpcDeckId)??f:f=Rt.find(z=>z.id===l.id)??f,C(c,new Tr(x,"Player",T,[],l,"NPC",f,[],Y)),e(c).onDuelEnd.append(()=>(C(c,e(c)),"RemoveMe"))},N=async()=>{await Promise.all([ee(),B()]),C(d,"DeckEdit")},oe=async T=>{await ee(),T.key==="Enter"&&!T.repeat&&(await Q).save()},Ce=()=>{C(P,ue()),C(c,void 0),C(d,"None")};let he=Date.now();const fe=T=>{Date.now()-he<200||(he=Date.now(),C(u,T),ue())},ie=T=>{Ee(Number(T.currentTarget.value))},Ee=T=>{var x;C($,Jt.find(l=>l.id===T)),C(W,((x=e($))==null?void 0:x.description)??"")};B(),_t();var De=ln(),F=s(a(De),2),K=a(F),pe=s(F,2);{var se=T=>{var x=je(),l=H(x);pt(l,()=>Q,null,(f,Y)=>{ji(f,{get duel(){return e(c)},get userProfile(){return e(Y)}})}),r(T,x)},Te=T=>{var x=je(),l=H(x);{var f=z=>{No(z,{})},Y=z=>{var ye=en(),be=a(ye),le=a(be),ae=a(le);pt(ae,()=>Q,V=>{var re=Zo();r(V,re)},(V,re)=>{var $e=Jo(),Fe=H($e),He=a(Fe),Ie=a(He),Le=s(He),Ve=a(Le),ot=a(Ve),Ae=s(Fe,2);pt(Ae,()=>e(P),Ye=>{var Oe=Go();r(Ye,Oe)},(Ye,Oe)=>{var tt=Xo(),ze=H(tt),Je=a(ze),jt=a(Je),vt=s(Je),$t=a(vt);ce($t,5,()=>qa,me,(J,ge)=>{var Ue=Ho(),Se=H(Ue),We=s(Se,2),Re=a(We);p(Ke=>{it(Se,"id",`game_mode_radio_${Ke??""}`),$r(Se,e(ge)),Sr(Se,e(u)===e(ge)),Me(We,`game_mode_tab_label game_mode_tab_${Ke??""} svelte-sy4ydn`),it(We,"for",`game_mode_radio_${Ke??""}`),g(Re,e(ge))},[()=>e(ge).toLowerCase()],ve),Z("change",Se,()=>fe(e(ge))),r(J,Ue)});var Et=s(ze,2),Yt=a(Et),ra=a(Yt),Ut=s(Yt),Xt=a(Ut),kt=a(Xt);p(()=>{e(U),Ft(()=>{e(u),e(Oe)})}),ce(kt,5,()=>e(u)==="FtkChallenge"?Rt.filter(J=>J.deckType==="Preset"):e(Oe),me,(J,ge)=>{var Ue=Fo(),Se={},We=a(Ue);p(()=>{Se!==(Se=e(ge).id)&&(Ue.value=(Ue.__value=e(ge).id)==null?"":e(ge).id),g(We,e(ge).name)}),r(J,Ue)});var St=s(Et,2);{var xt=J=>{var ge=Ko(),Ue=H(ge),Se=a(Ue),We=a(Se),Re=s(Se),Ke=a(Re),Ze=a(Ke);p(()=>{e(re),Ft(()=>{})}),ce(Ze,5,()=>Jt,me,(nt,Xe)=>{var lt=Io(),yt={},ht=a(lt);p(()=>{yt!==(yt=e(Xe).id)&&(lt.value=(lt.__value=e(Xe).id)==null?"":e(Xe).id),g(ht,e(Xe).name)}),r(nt,lt)});var dt=s(Ze,2),Nt=a(dt),Tt=s(Ue,2);{var wt=nt=>{var Xe=Ro(),lt=a(Xe),yt=a(lt),ht=s(lt),Qt=a(ht),Ge=a(Qt);p(()=>{e(re),Ft(()=>{e(Oe)})});var at=a(Ge);at.value=(at.__value=Number.MIN_SAFE_INTEGER)==null?"":Number.MIN_SAFE_INTEGER;var Ne=s(at);ce(Ne,1,()=>e(Oe),me,(qe,rt)=>{var et=Oo(),Ct={},qt=a(et);p(()=>{Ct!==(Ct=e(rt).id)&&(et.value=(et.__value=e(rt).id)==null?"":e(rt).id),g(qt,e(rt).name)}),r(qe,et)}),ne(3,yt,()=>we,()=>({duration:200})),ne(3,lt,()=>we,()=>({duration:200})),Zt(Ge,()=>e(re).previousNpcDeckId,qe=>e(re).previousNpcDeckId=qe),ne(3,Qt,()=>we,()=>({duration:200})),ne(3,ht,()=>we,()=>({duration:200})),ne(3,Xe,()=>we,()=>({duration:200})),r(nt,Xe)};w(Tt,nt=>{var Xe;((Xe=e($))==null?void 0:Xe.npcType)!=="FtkChallenge"&&nt(wt)})}var gt=s(Tt,2),mt=a(gt),Pt=a(mt),Bt=s(mt),It=a(Bt),Gt=a(It);p(()=>{e(re),Ft(()=>{})}),ce(Gt,5,()=>Kt(Ha),me,(nt,Xe)=>{var lt=Wo(),yt={},ht=a(lt);p(()=>{yt!==(yt=e(Xe))&&(lt.value=(lt.__value=e(Xe))==null?"":e(Xe)),g(ht,Ha[e(Xe)])}),r(nt,lt)}),p(()=>g(Nt,`※${e(W)??""}`)),ne(3,We,()=>we,()=>({duration:200})),ne(3,Se,()=>we,()=>({duration:200})),Z("change",Ze,ie),Zt(Ze,()=>e(re).previousNpcId,nt=>e(re).previousNpcId=nt),ne(3,Ke,()=>we,()=>({duration:200})),ne(3,Re,()=>we,()=>({duration:200})),ne(3,Ue,()=>we,()=>({duration:200})),ne(3,Pt,()=>we,()=>({duration:200})),ne(3,mt,()=>we,()=>({duration:200})),Zt(Gt,()=>e(re).previousStartMode,nt=>e(re).previousStartMode=nt),ne(3,It,()=>we,()=>({duration:200})),ne(3,Bt,()=>we,()=>({duration:200})),ne(3,gt,()=>we,()=>({duration:200})),r(J,ge)},sa=J=>{var ge=je(),Ue=H(ge);{var Se=We=>{var Re=Vo(),Ke=a(Re),Ze=a(Ke),dt=s(Ke),Nt=a(dt),Tt=a(Nt);p(()=>{e(re),Ft(()=>{})}),ce(Tt,5,()=>Mr,me,(wt,gt)=>{var mt=zo(),Pt={},Bt=a(mt);p(()=>{Pt!==(Pt=e(gt))&&(mt.value=(mt.__value=e(gt))==null?"":e(gt)),g(Bt,e(gt))}),r(wt,mt)}),ne(3,Ze,()=>we,()=>({duration:200})),ne(3,Ke,()=>we,()=>({duration:200})),Zt(Tt,()=>e(re).previousDifficulty,wt=>e(re).previousDifficulty=wt),ne(3,Nt,()=>we,()=>({duration:200})),ne(3,dt,()=>we,()=>({duration:200})),ne(3,Re,()=>we,()=>({duration:200})),r(We,Re)};w(Ue,We=>{e(u)==="FtkChallenge"&&We(Se)},!0)}r(J,ge)};w(St,J=>{e(u)==="Free"?J(xt):J(sa,!1)})}var ia=s(St,2),h=a(ia),y=a(h),R=a(y);ne(3,jt,()=>we,()=>({duration:200})),ne(3,Je,()=>we,()=>({duration:200})),ne(3,$t,()=>we,()=>({duration:200})),ne(3,vt,()=>we,()=>({duration:200})),ne(3,ze,()=>we,()=>({duration:200})),ne(3,ra,()=>we,()=>({duration:200})),ne(3,Yt,()=>we,()=>({duration:200})),Zt(kt,()=>e(U),J=>C(U,J)),ne(3,Xt,()=>we,()=>({duration:200})),ne(3,Ut,()=>we,()=>({duration:200})),ne(3,Et,()=>we,()=>({duration:200})),Z("click",R,b),ne(3,y,()=>we,()=>({duration:200})),r(Ye,tt)});var ke=s(Ae,2);{var Be=Ye=>{var Oe=Qo(),tt=a(Oe),ze=a(tt),Je=a(ze);Z("click",Je,N),ne(3,ze,()=>we,()=>({duration:200})),ne(3,tt,()=>we,()=>({duration:200})),ne(3,Oe,()=>we,()=>({duration:200})),r(Ye,Oe)};w(ke,Ye=>{e(u)==="Free"&&Ye(Be)})}ne(3,Ie,()=>we,()=>({duration:200})),ne(3,He,()=>we,()=>({duration:200})),Mt(ot,()=>e(re).name,Ye=>e(re).name=Ye),Z("keypress",ot,oe),ne(3,Ve,()=>we,()=>({duration:200})),ne(3,Le,()=>we,()=>({duration:200})),ne(3,Fe,()=>we,()=>({duration:200})),r(V,$e)}),r(z,ye)};w(l,z=>{e(d)==="DeckEdit"?z(f):z(Y,!1)},!0)}r(T,x)};w(pe,T=>{e(c)?T(se):T(Te,!1)})}var M=s(pe,2),S=a(M);pt(S,()=>la,T=>{var x=Qe("読み込み中");r(T,x)},(T,x)=>{var l=tn(),f=H(l),Y=a(f),z=s(f,2),ye=a(z);p((be,le,ae)=>{g(Y,`公式DB上のカード${be??""}枚`),g(ye,`実装済カード（効果あり）${le??""}枚 （効果なし）${ae??""}枚`)},[()=>e(x).knmCount.toLocaleString(),()=>e(x).definitionCount.toLocaleString(),()=>e(x).nonDefinitionCount.toLocaleString()],ve),r(T,l)});var q=s(M,2),X=a(q),te=a(X),k=s(X,2),j=a(k),A=s(k,2),I=a(A),O=s(q,2);{var de=T=>{var x=nn(),l=a(x);{var f=re=>{var $e=je(),Fe=H($e);{var He=Le=>{var Ve=an();r(Le,Ve)},Ie=Le=>{var Ve=je(),ot=H(Ve);{var Ae=ke=>{var Be=rn();r(ke,Be)};w(ot,ke=>{e(c).winner.seat==="Above"&&ke(Ae)},!0)}r(Le,Ve)};w(Fe,Le=>{e(c).winner.seat==="Below"?Le(He):Le(Ie,!1)})}r(re,$e)},Y=re=>{var $e=sn();r(re,$e)};w(l,re=>{e(c).winner?re(f):re(Y,!1)})}var z=s(l,2),ye=a(z),be=s(z,2);{var le=re=>{var $e=on(),Fe=a($e);p(()=>it(Fe,"href",`https://x.com/share?url=${D}&text=${e(c).twitterShareText??""}&hashtags=${o}&via=${L}`)),r(re,$e)};w(be,re=>{e(c).twitterShareText&&re(le)})}var ae=s(be,2),V=a(ae);p(()=>g(ye,e(c).reasonOfEnd)),Z("click",V,Ce),ne(3,x,()=>Ar,()=>({delay:200,duration:200})),r(T,x)};w(O,T=>{e(c)&&e(c).isEnded&&T(de)})}p(()=>{g(te,"build at: 20260118_170636"),g(j,xa.text),g(I,`w:${e(v)??""}px h:${e(m)??""}px`)}),_a("innerWidth",T=>C(v,T)),_a("innerHeight",T=>C(m,T)),Z("click",K,Ce),r(_,De),ut()}Er(vn,{target:document.getElementById("app")});
