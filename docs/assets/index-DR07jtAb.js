var Za=Object.defineProperty;var Ea=f=>{throw TypeError(f)};var er=(f,i,t)=>i in f?Za(f,i,{enumerable:!0,configurable:!0,writable:!0,value:t}):f[i]=t;var it=(f,i,t)=>er(f,typeof i!="symbol"?i+"":i,t),ja=(f,i,t)=>i.has(f)||Ea("Cannot "+t);var ft=(f,i,t)=>(ja(f,i,"read from private field"),t?t.call(f):i.get(f)),la=(f,i,t)=>i.has(f)?Ea("Cannot add the same private member more than once"):i instanceof WeakSet?i.add(f):i.set(f,t),ba=(f,i,t,o)=>(ja(f,i,"write to private field"),o?o.call(f,t):i.set(f,t),t);import{s as Aa,r as tr,a as $,b as ar,l as rr,g as e,d as Wa,p as dt,c as je,m as ne,i as ct,t as l,e as a,f as C,h as m,j as oe,k as Ae,n as at,o as J,q as r,u as _t,v as he,D as sr,w as xe,x as P,y as s,z as de,A as Vt,B as le,C as ce,E as b,F as ir,G as tt,H as Xt,I as nr,J as za,K as ea,L as ca,M as Da,N as oa,O as ka,P as Rt,Q as mt,R as $a,S as ga,T as Sa,U as va,V as _a,W as Va,X as ya,Y as ha,Z as lr,_ as or,$ as vr,a0 as dr,a1 as cr,a2 as _r,a3 as ur,a4 as ua,a5 as Xa,a6 as ta,a7 as Ga,a8 as fa,a9 as Bt,aa as fr,ab as mr,ac as aa,ad as pr,ae as Dt,af as gr,ag as yr,ah as hr,ai as Ba,aj as La,ak as qa,al as Ya,am as Ua,an as Ha,ao as br,ap as Et,aq as Ft,ar as It,as as kr,at as Ot,au as xr,av as wr,aw as Pa,ax as Zt,ay as zt,az as Cr,aA as Dr,aB as $r,aC as Na,aD as Sr,aE as Mr,aF as Tr}from"../chunk/entity_proc_20260122_200818.js";import"../chunk/json_20260122_200818.js";(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const g of document.querySelectorAll('link[rel="modulepreload"]'))o(g);new MutationObserver(g=>{for(const c of g)if(c.type==="childList")for(const u of c.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&o(u)}).observe(document,{childList:!0,subtree:!0});function t(g){const c={};return g.integrity&&(c.integrity=g.integrity),g.referrerPolicy&&(c.referrerPolicy=g.referrerPolicy),g.crossOrigin==="use-credentials"?c.credentials="include":g.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function o(g){if(g.ep)return;g.ep=!0;const c=t(g);fetch(g.href,c)}})();const Er=f=>f;function Ma(f){const i=f-1;return i*i*i+1}function Fa(f){const i=typeof f=="string"&&f.match(/^\s*(-?[\d.]+)([^\s]*)\s*$/);return i?[parseFloat(i[1]),i[2]||"px"]:[f,"px"]}function jr(f,{delay:i=0,duration:t=400,easing:o=Er}={}){const g=+getComputedStyle(f).opacity;return{delay:i,duration:t,easing:o,css:c=>`opacity: ${c*g}`}}function Ar(f,{delay:i=0,duration:t=400,easing:o=Ma,x:g=0,y:c=0,opacity:u=0}={}){const v=getComputedStyle(f),B=+v.opacity,A=v.transform==="none"?"":v.transform,S=B*(1-u),[M,n]=Fa(g),[q,R]=Fa(c);return{delay:i,duration:t,easing:o,css:(I,_)=>`
			transform: ${A} translate(${(1-I)*M}${n}, ${(1-I)*q}${R});
			opacity: ${B-S*_}`}}function ke(f,{delay:i=0,duration:t=400,easing:o=Ma,axis:g="y"}={}){const c=getComputedStyle(f),u=+c.opacity,v=g==="y"?"height":"width",B=parseFloat(c[v]),A=g==="y"?["top","bottom"]:["left","right"],S=A.map(p=>`${p[0].toUpperCase()}${p.slice(1)}`),M=parseFloat(c[`padding${S[0]}`]),n=parseFloat(c[`padding${S[1]}`]),q=parseFloat(c[`margin${S[0]}`]),R=parseFloat(c[`margin${S[1]}`]),I=parseFloat(c[`border${S[0]}Width`]),_=parseFloat(c[`border${S[1]}Width`]);return{delay:i,duration:t,easing:o,css:p=>`overflow: hidden;opacity: ${Math.min(p*20,1)*u};${v}: ${p*B}px;padding-${A[0]}: ${p*M}px;padding-${A[1]}: ${p*n}px;margin-${A[0]}: ${p*q}px;margin-${A[1]}: ${p*R}px;border-${A[0]}-width: ${p*I}px;border-${A[1]}-width: ${p*_}px;min-${v}: 0`}}function Ia(f,i){for(const t in i)f[t]=i[t];return f}function Br({fallback:f,...i}){const t=new Map,o=new Map;function g(u,v,B){const{delay:A=0,duration:S=U=>Math.sqrt(U)*30,easing:M=Ma}=Ia(Ia({},i),B),n=u.getBoundingClientRect(),q=v.getBoundingClientRect(),R=n.left-q.left,I=n.top-q.top,_=n.width/q.width,p=n.height/q.height,K=Math.sqrt(R*R+I*I),Z=getComputedStyle(v),we=Z.transform==="none"?"":Z.transform,j=+Z.opacity;return{delay:A,duration:typeof S=="function"?S(K):S,easing:M,css:(U,ve)=>`
			   opacity: ${U*j};
			   transform-origin: top left;
			   transform: ${we} translate(${ve*R}px,${ve*I}px) scale(${U+(1-U)*_}, ${U+(1-U)*p});
		   `}}function c(u,v,B){return(A,S)=>(u.set(S.key,A),()=>{if(v.has(S.key)){const M=v.get(S.key);return v.delete(S.key),g(M,A,S)}return u.delete(S.key),f&&f(A,S,B)})}return[c(o,t,!1),c(t,o,!0)]}function Oa(f){return Object.prototype.toString.call(f)==="[object Date]"}function Lr(f){return f}function xa(f){const i=f-1;return i*i*i+1}function wa(f,i){if(f===i||f!==f)return()=>f;const t=typeof f;if(t!==typeof i||Array.isArray(f)!==Array.isArray(i))throw new Error("Cannot interpolate values of different type");if(Array.isArray(f)){const o=i.map((g,c)=>wa(f[c],g));return g=>o.map(c=>c(g))}if(t==="object"){if(!f||!i)throw new Error("Object cannot be null");if(Oa(f)&&Oa(i)){const c=f.getTime(),v=i.getTime()-c;return B=>new Date(c+B*v)}const o=Object.keys(i),g={};return o.forEach(c=>{g[c]=wa(f[c],i[c])}),c=>{const u={};return o.forEach(v=>{u[v]=g[v](c)}),u}}if(t==="number"){const o=i-f;return g=>f+g*o}return()=>i}var Lt,ra,da,Gt;const Ta=class Ta{constructor(i,t={}){la(this,Lt,Aa(void 0));la(this,ra,Aa(void 0));la(this,da);la(this,Gt,null);ft(this,Lt).v=ft(this,ra).v=i,ba(this,da,t)}static of(i,t){const o=new Ta(i(),t);return tr(()=>{o.set(i())}),o}set(i,t){var M;$(ft(this,ra),i);let{delay:o=0,duration:g=400,easing:c=Lr,interpolate:u=wa}={...ft(this,da),...t};if(g===0)return(M=ft(this,Gt))==null||M.abort(),$(ft(this,Lt),i),Promise.resolve();const v=ar.now()+o;let B,A=!1,S=ft(this,Gt);return ba(this,Gt,rr(n=>{if(n<v)return!0;if(!A){A=!0;const R=ft(this,Lt).v;B=u(R,i),typeof g=="function"&&(g=g(R,i)),S==null||S.abort()}const q=n-v;return q>g?($(ft(this,Lt),i),!1):($(ft(this,Lt),B(c(q/g))),!0)})),ft(this,Gt).promise}get current(){return e(ft(this,Lt))}get target(){return e(ft(this,ra))}set target(i){this.set(i)}};Lt=new WeakMap,ra=new WeakMap,da=new WeakMap,Gt=new WeakMap;let ma=Ta;var qr=l('<div class="phase_display svelte-1boxe40"><span class="svelte-1boxe40"> </span> </div>'),Yr=l('<div class="lifepoint_display svelte-1boxe40"><div class="svelte-1boxe40"> </div> <div class="svelte-1boxe40"> </div></div>'),Ur=(f,i,t)=>i(e(t)),Hr=l('<div class="svelte-1boxe40"><button class="phase_button svelte-1boxe40"> </button></div>'),Pr=l("<div><!></div>"),Nr=l('<div class="svelte-1boxe40"><!></div>'),Fr=l("<div><!></div>"),Ir=l('<div class="config_button_wrapper svelte-1boxe40"><button id="config_button" class="svelte-1boxe40">⚙</button></div>'),Or=l("<!> <!> <!> <!>",1),Rr=l('<div style="position: absolute;" class="card_animation_receiver svelte-1boxe40"><!></div>'),Kr=l('<div style="position: absolute; top:0rem" class="svelte-1boxe40">｛効果対象｝</div>'),Wr=l('<!> <div style="position: absolute; display:flex;justify-content: center;"><!></div>',1),zr=l(" <!> 】",1),Vr=l('<div style="position: absolute; bottom:0rem" class="svelte-1boxe40"> <!></div>'),Xr=l("<!> <!>",1),Gr=l('<div class="badge svelte-1boxe40"> </div>'),Qr=l('<div class="card_animation_receiver svelte-1boxe40"><!></div>'),Jr=l("<!> <!> <!> <!>",1),Zr=l('<td><div role="listitem"><!></div></td>');function es(f,i){dt(i,!1);let t=je(i,"view",12),o=je(i,"row",8),g=je(i,"column",8),c=je(i,"selectedEntities",28,()=>[]),u=je(i,"selectedCells",28,()=>[]),v=ne(t().getCell(o(),g())),B=ne(new ma(e(v).field.duel.duelists.Above.lp,{duration:400,easing:xa})),A=ne(new ma(e(v).field.duel.duelists.Below.lp,{duration:400,easing:xa}));const S=()=>{$(v,t().getCell(o(),g())),he(B,e(B).target=e(v).field.duel.duelists.Above.lp),he(A,e(A).target=e(v).field.duel.duelists.Below.lp)};e(v).onUpdate.append(S),t().onDuelUpdate.append(S),t().modalController.onUpdate.append(S);let M,n=ne([]),q=()=>console.log("hoge"),R,I=ne([]),_=ne(!1),p=ne(!1),K=!1;const Z=w=>{var F,z;$(se,[]),c().reset(),M=w.activator,q=w.resolve,$(n,w.dummyActionInfos),$(I,w.chainBlockInfos.flatMap(G=>G.selectedEntities).getDistinct()),R=w.entitiesChoices,$(_,!1),$(p,((F=w.cellsChoices)==null?void 0:F.selectables.includes(e(v)))??!1),K=e(p)&&((z=w.cellsChoices)==null?void 0:z.qty)===1,S()};t().onWaitStart.append(Z);const we=()=>{M=void 0,$(n,[]),q=()=>{console.log("hoge")},R=void 0,$(I,[]),$(_,!1),$(p,!1),K=!1};t().onWaitEnd.append(we);let j=ne(!1),U=[];const ve=w=>{U=w.filter(F=>F.dests.includes(e(v))),$(j,U.length>0),S()},Me=()=>{U=[],$(j,!1),S()};t().onDragStart.append(ve),t().onDragEnd.append(Me);const[ge,ue]=ui;let se=ne([]);const Ee=w=>{if(M=void 0,e(v)===w.to||e(v).entities.includes(w.entity)){$(se,[...e(se),w]);const F=w.resolve;$(v,e(v)),setTimeout(()=>{$(se,e(se).filter(z=>z!==w)),w.count++,w.count>1&&F()},600)}};t().onAnimation.append(Ee);const ye=w=>{q({phaseChange:w})},Y=()=>e(v).isStackCell&&e(v).entities.flatMap(w=>w.actions).filter(w=>e(n).map(F=>F.action.seq).some(F=>F===w.seq)).length>0,N=w=>{var F;if(((F=w.target)==null?void 0:F.id)==="config_button"){t(t().infoBoardState="Config",!0),t().requireUpdate();return}if(t(t().infoBoardState="Default",!0),K)q({selectedCells:[e(v)]});else if(e(p))$(_,!e(_)),u(e(_)?[...u(),e(v)]:u().filter(z=>z!==e(v)));else if(e(v).isStackCell){t(t().infoBoardState="CellInfo",!0),t(t().infoBoardCell=e(v),!0),t().requireUpdate();const z=e(v).entities.flatMap(V=>V.actions).map(V=>V.seq),G=e(n).filter(V=>z.includes(V.action.seq));if(G.length){if(!M)return;t().modalController.actionSelector.show({title:"カードを選択。",position:"Bottom",activator:M,dummyActionInfos:G,cancelable:!0}).then(V=>{V&&q({actionInfo:V})});return}}t().requireUpdate(),console.info(e(v),Te(...e(v).visibleEntities))},fe=w=>{w.preventDefault(),w.dataTransfer&&(w.dataTransfer.dropEffect="move")},ae=w=>{w.preventDefault(),console.info("drop",w,e(j),U),w.dataTransfer&&(w.dataTransfer.dropEffect="move");try{if(e(j)&&U){if(U.length===1){const F=U[0];q({actionInfo:{...F,dest:e(v)}})}else if(U.length>1){if(!M)throw new sr("想定されない状態");e(v).field.duel.view.modalController.terminateAll(),e(v).field.duel.view.modalController.actionSelector.show({title:"選択",position:"Bottom",activator:M,dummyActionInfos:U.map(F=>({...F,dest:e(v)})),cancelable:!1}).then(F=>{q({actionInfo:F})})}}}finally{t().removeDraggingActions()}},Te=(...w)=>{if(t().waitMode==="Animation")return"Disabled";if(R&&R.selectables.find(z=>w.find(G=>z===G)))return"Selectable";if(!e(n)||e(n).length===0||t().waitMode!=="Free"||Object.values(t().modalController.modals).some(z=>z.state==="Shown"))return"Disabled";const F=e(n).filter(z=>w.includes(z.action.entity));return F.length===0?"Disabled":e(v).isStackCell||F[0].action.entity!==w[0]?"Clickable":F.some(z=>z.dests.length)?"Draggable":"Clickable"};ct();var E=Zr(),x=a(E);x.__click=N;var L=a(x);{var W=w=>{var F=xe(),z=P(F);{var G=V=>{var _e=xe(),T=P(_e);{var D=y=>{var H=qr(),X=a(H),Ce=a(X),De=s(X,1,!0);m((me,ie)=>{b(Ce,me),b(De,ie)},[()=>String(e(v).field.duel.clock.turn).padStart(2,"0"),()=>e(v).field.duel.phase.toUpperCase()],oe),r(y,H)},d=y=>{var H=xe(),X=P(H);{var Ce=me=>{var ie=Yr(),re=a(ie),te=a(re),$e=s(re,2),Ie=a($e);m((Fe,Oe)=>{b(te,Fe),b(Ie,Oe)},[()=>Math.floor(e(B).current),()=>Math.floor(e(A).current)],oe),r(me,ie)},De=me=>{var ie=xe(),re=P(ie);{var te=$e=>{var Ie=xe(),Fe=P(Ie);{var Oe=Ye=>{var Ge=xe(),nt=P(Ge);{var qe=be=>{var Le=xe(),Ue=P(Le);de(Ue,1,()=>t().duel.nextPhaseList,ce,(Re,rt)=>{var Xe=Hr(),Ze=a(Xe);Ze.__click=[Ur,ye,rt];var $t=a(Ze);m(vt=>b($t,vt),[()=>e(rt).toUpperCase()],oe),r(Re,Xe)}),r(be,Le)};C(nt,be=>{t().duel.isEnded||be(qe)})}r(Ye,Ge)};C(Fe,Ye=>{t().waitMode==="Free"&&Ye(Oe)})}r($e,Ie)};C(re,$e=>{e(v).column===5&&$e(te)},!0)}r(me,ie)};C(X,me=>{e(v).column===3?me(Ce):me(De,!1)},!0)}r(y,H)};C(T,y=>{e(v).column===1?y(D):y(d,!1)})}r(V,_e)};C(z,V=>{e(v).row===3&&V(G)})}r(w,F)},ee=w=>{var F=xe(),z=P(F);{var G=_e=>{var T=Or();const D=oe(()=>e(se).find(ie=>ie.to===e(v)));var d=P(T);{var y=ie=>{var re=Pr(),te=a(re);Vt(te,{get entity(){return e(D).entity},state:"Disabled",dummyActionInfos:[],cardActionResolve:void 0}),m(()=>Ae(re,`card_animation_receiver ${e(v).cellType??""} svelte-1boxe40`)),le(1,re,()=>ue,()=>({key:e(D).entity.seq})),r(ie,re)};C(d,ie=>{e(D)&&e(D).index==="Top"&&ie(y)})}var H=s(d,2);de(H,1,()=>e(v).visibleEntities,ce,(ie,re)=>{var te=xe(),$e=P(te);{var Ie=Fe=>{var Oe=Nr(),Ye=a(Oe);const Ge=oe(()=>Te(e(re))),nt=oe(()=>e(n).filter(qe=>qe.action.entity===e(re)));Vt(Ye,{get entity(){return e(re)},get state(){return e(Ge)},get dummyActionInfos(){return e(nt)},cardActionResolve:void 0,get selectedList(){return c()},set selectedList(qe){c(qe)},$$legacy:!0}),le(2,Oe,()=>ge,()=>({key:e(re).seq})),r(Fe,Oe)};C($e,Fe=>{e(se).every(Oe=>Oe.entity.seq!==e(re).seq)&&Fe(Ie)})}r(ie,te)});var X=s(H,2);{var Ce=ie=>{var re=Fr(),te=a(re);Vt(te,{get entity(){return e(D).entity},state:"Disabled",dummyActionInfos:[],cardActionResolve:void 0}),m(()=>Ae(re,`card_animation_receiver ${e(v).cellType??""} svelte-1boxe40`)),le(1,re,()=>ue,()=>({key:e(D).entity.seq})),r(ie,re)};C(X,ie=>{e(D)&&e(D).index!=="Top"&&ie(Ce)})}var De=s(X,2);{var me=ie=>{var re=Ir();r(ie,re)};C(De,ie=>{e(v).owner.seat==="Below"&&ie(me)})}r(_e,T)},V=_e=>{var T=Jr();const D=oe(()=>e(se).find(re=>re.to===e(v)));var d=P(T);{var y=re=>{var te=Rr(),$e=a(te);Vt($e,{get entity(){return e(D).entity},state:"Disabled",dummyActionInfos:[],cardActionResolve:void 0}),le(1,te,()=>ue,()=>({key:e(D).entity.seq})),r(re,te)};C(d,re=>{e(D)&&e(D).index!=="Top"&&re(y)})}var H=s(d,2);{var X=re=>{var te=Xr(),$e=P(te);de($e,1,()=>e(v).visibleEntities.map((Oe,Ye)=>({index:Ye,entity:Oe})).toReversed(),ce,(Oe,Ye)=>{var Ge=xe(),nt=P(Ge);{var qe=be=>{var Le=Wr();const Ue=oe(()=>!e(v).isStackCell&&e(Ye).index===0?Te(...e(v).visibleEntities):void 0);var Re=P(Le);{var rt=vt=>{var St=Kr();r(vt,St)};C(Re,vt=>{e(I).includes(e(Ye).entity)&&vt(rt)})}var Xe=s(Re,2),Ze=a(Xe);const $t=oe(()=>e(Ye).index===0?e(n).filter(vt=>e(v).visibleEntities.includes(vt.action.entity)):void 0);Vt(Ze,{get entity(){return e(Ye).entity},get state(){return e(Ue)},get dummyActionInfos(){return e($t)},cardActionResolve:void 0,get selectedList(){return c()},set selectedList(vt){c(vt)},$$legacy:!0}),m(()=>Ae(Xe,`duel_card_wrapper ${(e(Ye).entity.exist?"duel_card_wrapper_exists":"")??""} svelte-1boxe40`)),le(2,Xe,()=>ge,()=>({key:e(Ye).entity.seq})),r(be,Le)};C(nt,be=>{e(se).every(Le=>Le.entity.seq!==e(Ye).entity.seq)&&be(qe)})}r(Oe,Ge)});var Ie=s($e,2);{var Fe=Oe=>{var Ye=Vr(),Ge=a(Ye),nt=s(Ge);de(nt,1,()=>Xt(e(v).visibleEntities[0].status.maxCounterQty),ce,(qe,be)=>{var Le=zr(),Ue=P(Le),Re=s(Ue);{var rt=Xe=>{var Ze=tt();m(()=>b(Ze,`/${e(v).visibleEntities[0].status.maxCounterQty[e(be)]??""}`)),r(Xe,Ze)};C(Re,Xe=>{(e(v).visibleEntities[0].status.maxCounterQty[e(be)]??9999)<100&&Xe(rt)})}m((Xe,Ze)=>b(Ue,`【
              ${Xe??""}${Ze??""} `),[()=>ir(e(be)),()=>e(v).visibleEntities[0].counterHolder.getQty(e(be))],oe),r(qe,Le)}),m(()=>b(Ge,`【${e(v).visibleEntities[0].battlePositionName??""}】 `)),r(Oe,Ye)};C(Ie,Oe=>{e(v).visibleEntities[0].battlePosition&&Oe(Fe)})}r(re,te)};C(H,re=>{e(v).visibleEntities.length>0&&re(X)})}var Ce=s(H,2);{var De=re=>{var te=Gr(),$e=a(te);m(()=>b($e,e(v).visibleEntities.length)),r(re,te)};C(Ce,re=>{e(v).isStackCell&&re(De)})}var me=s(Ce,2);{var ie=re=>{var te=Qr(),$e=a(te);Vt($e,{get entity(){return e(D).entity},state:"Disabled",dummyActionInfos:[],cardActionResolve:void 0}),le(1,te,()=>ue,()=>({key:e(D).entity.seq})),r(re,te)};C(me,re=>{e(D)&&e(D).index==="Top"&&re(ie)})}r(_e,T)};C(z,_e=>{e(v).cellType==="Hand"?_e(G):_e(V,!1)},!0)}r(w,F)};C(L,w=>{e(v).isDisabledCell?w(W):w(ee,!1)})}m(w=>{Ae(E,`${`duel_field_cell duel_field_cell_${e(v).cellType} ${e(v).linkArrowSources.length===0?"":"duel_field_cell_linked"}`??""} svelte-1boxe40`),at(E,"colspan",e(v).cellType==="Hand"?7:1),Ae(x,`${w??""} svelte-1boxe40`)},[()=>`duel_field_cell_inner_box ${e(v).cellType} ${e(j)?"can_accept_drop":""} ${Y()?"can_action":""} ${e(_)?"is_selected":e(p)?"is_selectable":""} `],oe),J("dragover",x,fe),J("drop",x,ae),r(f,E),_t()}Wa(["click"]);const ts=(f,i,t=void 0,o="!!!circular reference!!!")=>{let g=[];return JSON.stringify(f,(c,u)=>{if(typeof u=="object"){if(g.indexOf(u)>-1)return o;g.push(u)}let v=u;if(i&&(v=i(c,u)),typeof v=="function")return v.toString();if(v!==u&&typeof v=="object"){if(g.indexOf(v)>-1)return o;g.push(v)}return v},t)};var as=l('<div class="title svelte-14z6bdh"> </div>'),rs=l('<div class="title svelte-14z6bdh"> </div>'),ss=l('<div class="duel_log_chain_number svelte-14z6bdh"> </div>'),is=l('<div><a class="white_button" download="error_info.json">エラー情報ダウンロード</a></div>'),ns=l("<div><!> <!></div>"),ls=l('<div><div style="display: flex;    justify-content: space-between;"><div style=" white-space: nowrap;text-align: center;"> </div> <!></div> <!></div>'),os=l("<div><!> <!></div>"),vs=l("<div><!> <!></div>"),ds=l('<div class="duel_log svelte-14z6bdh"><div class="duel_log_header svelte-14z6bdh"></div> <div class="duel_log_body svelte-14z6bdh"></div> <div class="duel_log_footer svelte-14z6bdh"></div></div>');function cs(f,i){dt(i,!1);let t=ne(void 0),o=je(i,"log",8),g,c=ne([]);const u=()=>{const S=((g==null?void 0:g.seq)??-1)+1;o().records.slice(S).forEach(M=>{if(!g){$(c,[[[[M]]]]),g=M;return}if(!e(c)[M.clock.turn]){he(c,e(c)[M.clock.turn]=[[[M]]]),g=M;return}if(!e(c)[M.clock.turn][M.clock.phaseSeq]){he(c,e(c)[M.clock.turn][M.clock.phaseSeq]=[[M]]),g=M;return}if(g.clock.chainSeq===M.clock.chainSeq&&g.clock.chainBlockSeq===M.clock.chainBlockSeq&&g.duelist===M.duelist){e(c)[M.clock.turn][M.clock.phaseSeq].slice(-1)[0].push(M),g=M;return}e(c)[M.clock.turn][M.clock.phaseSeq].push([M]),g=M}),$(c,e(c)),nr().then(()=>e(t)&&e(t).scroll(0,e(t).clientHeight*990))};o().onUpdate.append(u),o().duel.view.onDuelUpdate.append(u),u(),ct();var v=xe(),B=P(v);{var A=S=>{var M=ds(),n=s(a(M),2);de(n,5,()=>e(c),ce,(q,R)=>{var I=vs(),_=a(I);{var p=Z=>{var we=as(),j=a(we);m(()=>b(j,`ターン：${e(R)[0][0][0].clock.turn??""}`)),r(Z,we)};C(_,Z=>{e(R)[0][0][0].clock.turn>0&&Z(p)})}var K=s(_,2);de(K,1,()=>e(R),ce,(Z,we)=>{var j=os(),U=a(j);{var ve=ge=>{var ue=rs(),se=a(ue);m(()=>b(se,e(we)[0][0].clock.period.name)),r(ge,ue)};C(U,ge=>{e(we)[0][0].clock.turn>0&&ge(ve)})}var Me=s(U,2);de(Me,1,()=>e(we),ce,(ge,ue)=>{var se=ls();const Ee=oe(()=>{var E;return((E=e(ue).find(x=>x.chainNumber!==void 0))==null?void 0:E.chainNumber)??0});var ye=a(se),Y=a(ye),N=a(Y),fe=s(Y,2);{var ae=E=>{var x=ss(),L=a(x);m(()=>b(L,`チェーン：${e(Ee)??""}`)),r(E,x)};C(fe,E=>{e(Ee)&&E(ae)})}var Te=s(ye,2);de(Te,1,()=>e(ue),ce,(E,x)=>{var L=ns(),W=a(L);{var ee=G=>{var V=tt();m(()=>b(V,e(x).text)),r(G,V)},w=G=>{var V=xe(),_e=P(V);{var T=d=>{var y=tt();m((H,X,Ce)=>b(y,`移動：${H??""} ${X??""} ⇒ ${Ce??""}`),[()=>{var H;return(H=e(x).mainEntity)==null?void 0:H.toString()},()=>{var H;return(H=e(x).from)==null?void 0:H.toString()},()=>{var H;return(H=e(x).to)==null?void 0:H.toString()}],oe),r(d,y)},D=d=>{var y=xe(),H=P(y);{var X=De=>{var me=tt();m((ie,re)=>b(me,`生成：${ie??""} void ⇒ ${re??""}`),[()=>{var ie;return(ie=e(x).mainEntity)==null?void 0:ie.toString()},()=>{var ie;return(ie=e(x).to)==null?void 0:ie.toString()}],oe),r(De,me)},Ce=De=>{var me=xe(),ie=P(me);{var re=$e=>{var Ie=tt();m((Fe,Oe)=>b(Ie,`消滅：${Fe??""} ${Oe??""} ⇒ void`),[()=>{var Fe;return(Fe=e(x).mainEntity)==null?void 0:Fe.toString()},()=>{var Fe;return(Fe=e(x).from)==null?void 0:Fe.toString()}],oe),r($e,Ie)},te=$e=>{var Ie=tt();m(()=>b(Ie,e(x).text)),r($e,Ie)};C(ie,$e=>{e(x).type==="EntityDisappear"?$e(re):$e(te,!1)},!0)}r(De,me)};C(H,De=>{e(x).type==="EntityAppear"?De(X):De(Ce,!1)},!0)}r(d,y)};C(_e,d=>{e(x).type==="EntityMove"?d(T):d(D,!1)},!0)}r(G,V)};C(W,G=>{e(x).type==="ChainBlockHeader"?G(ee):G(w,!1)})}var F=s(W,2);{var z=G=>{var V=is(),_e=a(V);m(T=>at(_e,"href",T),[()=>window.URL.createObjectURL(new Blob([ts(e(x).error,(T,D)=>["pool","bundles","duel"].includes(T)||typeof D=="function"?void 0:D,4)],{type:"text/plain"}))],oe),r(G,V)};C(F,G=>{e(x).error&&G(z)})}m(G=>Ae(L,`duel_log_record duel_log_record_${G??""} svelte-14z6bdh`),[()=>e(x).type.toSnakeCase()],oe),r(E,L)}),m(()=>{var E,x,L;Ae(se,`duel_log_block_duelist duel_log_block_duelist_${((E=e(ue)[0].duelist)==null?void 0:E.seat)??"system"} svelte-14z6bdh`),Ae(Y,`duelist ${((x=e(ue)[0].duelist)==null?void 0:x.seat)??""} svelte-14z6bdh`),b(N,((L=e(ue)[0].duelist)==null?void 0:L.profile.name)||"SYSTEM")}),r(ge,se)}),m(()=>Ae(j,`duel_log_block_phase duel_log_block_phase_${e(we)[0][0].clock.period.key??""} svelte-14z6bdh`)),r(Z,j)}),m(()=>Ae(I,`duel_log_block_turn duel_log_block_turn_${e(R)[0][0][0].clock.turn??""} svelte-14z6bdh`)),r(q,I)}),za(n,q=>$(t,q),()=>e(t)),r(S,M)};C(B,S=>{(o().duel.view.infoBoardState==="Log"||o().duel.view.infoBoardState==="Default")&&S(A)})}r(f,v),_t()}var _s=l("<div><div> </div> <div> </div></div>");function Ra(f,i){dt(i,!1);let t=je(i,"duelist",12),o=ne(0),g=ne();const c=async()=>{const n=t().lp-e(o);if(!e(g)||Math.abs(n)<10){$(o,t().lp),e(g)&&(e(g)(),$(g,void 0));return}$(o,e(o)+Math.floor(Math.random()*n)),await ea(100),c()},u=()=>{t(t()),!e(g)&&t().lp!==e(o)&&new Promise(n=>{$(g,n),Math.abs(t().lp-e(o)),c()})};t().duel.log.onUpdate.append(u),c(),ct();var v=_s(),B=a(v),A=a(B),S=s(B,2),M=a(S);m(n=>{Ae(v,`duelist duelist_${n??""} svelte-1sy3trd`),Ae(B,`duelist_name duelist_${n??""}_name svelte-1sy3trd`),b(A,t().profile.name),Ae(S,`duelist_lp ${(e(g)?"vibration":"")??""} svelte-1sy3trd`),b(M,e(o))},[()=>t().seat.toLowerCase()],oe),r(f,v),_t()}const us=(f,i,t)=>(i(i()!=="Detail"?"Detail":"Normal"),console.info(t()),!0),fs=(f,i,t)=>(i(i()!=="Debug"?"Debug":"Normal"),console.info(t()),!0);var ms=l('<div class="svelte-1uevs9j"> </div>'),ps=l('<div class="svelte-1uevs9j"> </div>'),gs=l('<div class="link_arrow_emoji svelte-1uevs9j"> </div>'),ys=l('<div class="duel_card_info_row svelte-1uevs9j" style=" justify-content: space-between;"><div class="svelte-1uevs9j"> </div> <div class="svelte-1uevs9j"> </div></div>'),hs=l('<div></div> <div class="svelte-1uevs9j"> </div>',1),bs=l("<div> </div>"),ks=l('<span class="svelte-1uevs9j">/</span> <div class="monster_defense svelte-1uevs9j"> </div>',1),xs=l("<div> </div>"),ws=l('<div class="duel_card_info_row svelte-1uevs9j"><!> <!> <div style="flex-grow: 1;" class="svelte-1uevs9j"></div> <div class="monster_attack svelte-1uevs9j"> </div> <!></div> <div class="duel_card_info_row svelte-1uevs9j"></div>',1),Cs=l('<div class="duel_card_row svelte-1uevs9j"><div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"> </div></div>'),Ds=l('<div class="duel_card_row svelte-1uevs9j"><div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"> </div></div>'),$s=l("<!> <!>",1),Ss=l('<pre class="description svelte-1uevs9j"> </pre>'),Ms=l('<div class="duel_card_info_row svelte-1uevs9j" style="border-style: solid; border-width: 1px;"><!></div>'),Ts=l('<pre class="description svelte-1uevs9j"> </pre>'),Es=l('<!> <div class="duel_card_info_row svelte-1uevs9j"><!></div>',1),js=l('<div class="effect_counter_area_item svelte-1uevs9j"><span class="svelte-1uevs9j"> </span> <span class="svelte-1uevs9j"> </span> <span class="svelte-1uevs9j">/</span> <span class="svelte-1uevs9j"> </span></div>'),As=l('<div class="duel_card_info_row effect_counter_area svelte-1uevs9j"><div class="effect_counter_area_title svelte-1uevs9j">効果使用状況</div> <div class="effect_counter_area_body svelte-1uevs9j"></div></div>'),Bs=l("[ <!> ],",1),Ls=l('<div class="svelte-1uevs9j"> <!></div>'),qs=l('<div class="svelte-1uevs9j"> </div> <!> <div class="svelte-1uevs9j"></div>',1),Ys=l('<div class="svelte-1uevs9j"> </div>'),Us=l('<div class="svelte-1uevs9j"> </div>'),Hs=l('<div class="svelte-1uevs9j"> </div>'),Ps=l('<div class="svelte-1uevs9j"> </div>'),Ns=l('<div class="svelte-1uevs9j"> </div>'),Fs=l('<div class="svelte-1uevs9j"> </div>'),Is=l('<div class="duel_card_info_row svelte-1uevs9j"><div class="svelte-1uevs9j"><!> <div class="svelte-1uevs9j"></div> <!> <div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"></div> <!> <div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"></div> <!> <div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"></div> <!> <div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"></div> <!> <div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"></div> <!> <div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"> </div> <div class="svelte-1uevs9j"> </div> <div class="svelte-1uevs9j"> </div> <div class="svelte-1uevs9j"></div></div></div>'),Os=l('<div class="svelte-1uevs9j">※エラッタ前のカードです</div>'),Rs=l('<div class="svelte-1uevs9j">※テスト用カードです</div>'),Ks=l('<a target="_blank" rel="noopener noreferrer" title="コナミカードデータベース" class="svelte-1uevs9j"> </a>'),Ws=l('<a target="_blank" rel="noopener noreferrer" title="遊戯王カードWiki" class="svelte-1uevs9j">⇒遊戯王カードWiki</a>'),zs=l('<div class="duel_card_info_links svelte-1uevs9j"><!> <!> <a target="_blank" rel="noopener noreferrer" title="google" class="svelte-1uevs9j">⇒google検索</a></div>'),Vs=l("<!> <!>",1),Xs=l('<div role="contentinfo"><div class="duel_card_info_header svelte-1uevs9j"><div class="duel_card_info_row svelte-1uevs9j"><div class="svelte-1uevs9j"> </div></div> <div class="duel_card_info_row svelte-1uevs9j" style="position:sticky; top:0;"><!> <div class="svelte-1uevs9j"> </div></div> <!></div> <div class="duel_card_info_body svelte-1uevs9j"><!></div> <div class="duel_card_info_footer svelte-1uevs9j"><!></div></div>');function Gs(f,i){dt(i,!1);let t=je(i,"entity",8),o=je(i,"mode",12,"Normal"),g=ne(new Promise(()=>{}));const c=()=>{var S,M;let A=t()&&t().entityType==="Card"?t().origin.cardId:(M=(S=t())==null?void 0:S.parent)==null?void 0:M.origin.cardId;return A??!1?`https://www.db.yugioh-card.com/yugiohdb/card_search.action?ope=2&cid=${A}`:t()?`https://www.db.yugioh-card.com/yugiohdb/card_search.action?ope=1&sess=1&rp=10&mode=&sort=1&keyword=${t().origin.name}&stype=1&ctype=&othercon=2&starfr=&starto=&pscalefr=&pscaleto=&linkmarkerfr=&linkmarkerto=&link_m=2&atkfr=&atkto=&deffr=&defto=&releaseDStart=1&releaseMStart=1&releaseYStart=1999&releaseDEnd=&releaseMEnd=&releaseYEnd=`:""};ca(()=>(Rt(t()),ka),()=>{$(g,oa.then(async A=>{if(t().origin.description||t().origin.pendulumDescription||t().origin.wikiEncodedName)return t().origin;const S=A.getCardInfo(t().origin.name);if(S)return S.cardId!==void 0&&!S.description&&!S.pendulumDescription&&await ka([S.cardId]),S}))}),Da(),ct();var u=xe(),v=P(u);{var B=A=>{var S=Xs();S.__click=[us,o,t],S.__contextmenu=[fs,o,t];var M=a(S),n=a(M),q=a(n),R=a(q),I=s(n,2),_=a(I);{var p=Y=>{var N=ms(),fe=a(N);m(ae=>b(fe,ae),[()=>"★".repeat(t().lvl)],oe),r(Y,N)},K=Y=>{var N=xe(),fe=P(N);{var ae=E=>{var x=ps(),L=a(x);m(W=>b(L,W),[()=>"☆".repeat(t().rank)],oe),r(E,x)},Te=E=>{var x=xe(),L=P(x);{var W=ee=>{var w=gs(),F=a(w);m(z=>b(F,z),[()=>t().origin.linkArrowKeys.map(z=>Va[z].emoji).join("")],oe),r(ee,w)};C(L,ee=>{t().origin.linkArrowKeys&&ee(W)},!0)}r(E,x)};C(fe,E=>{t().rank&&t().rank>0?E(ae):E(Te,!1)},!0)}r(Y,N)};C(_,Y=>{t().lvl&&t().lvl>0?Y(p):Y(K,!1)})}var Z=s(_,2),we=a(Z),j=s(I,2);{var U=Y=>{var N=$s(),fe=P(N);{var ae=L=>{var W=ys(),ee=a(W),w=a(ee),F=s(ee,2),z=a(F);m(()=>{b(w,`◀ ${t().psL??""}`),b(z,`${t().psR??""} ▶`)}),r(L,W)};C(fe,L=>{var W;(W=t().origin.monsterCategories)!=null&&W.includes("Pendulum")&&L(ae)})}var Te=s(fe,2);{var E=L=>{var W=ws(),ee=P(W),w=a(ee);de(w,1,()=>t().attr,ce,(D,d)=>{var y=hs(),H=P(y),X=s(H,2),Ce=a(X);m(()=>{Ae(H,`monster_attr ${e(d)??""} svelte-1uevs9j`),b(Ce,`${$a[e(d)]??""}属性`)}),r(D,y)});var F=s(w,2);de(F,1,()=>t().types,ce,(D,d)=>{var y=bs(),H=a(y);m(()=>{Ae(y,`monster_cat ${e(d)??""} svelte-1uevs9j`),b(H,`${ga[e(d)]??""}${Sa[e(d)]??""}族`)}),r(D,y)});var z=s(F,4),G=a(z),V=s(z,2);{var _e=D=>{var d=ks(),y=s(P(d),2),H=a(y);m(()=>b(H,t().def??"?")),r(D,d)};C(V,D=>{var d;(d=t().status.monsterCategories)!=null&&d.includes("Link")||D(_e)})}var T=s(ee,2);de(T,5,()=>t().status.monsterCategories??[],ce,(D,d)=>{var y=xs(),H=a(y);m(()=>{Ae(y,`monster_cat ${e(d)??""} svelte-1uevs9j`),b(H,`${va[e(d)]??""}${_a[e(d)]??""}`)}),r(D,y)}),m(()=>b(G,t().atk??"?")),r(L,W)},x=L=>{var W=xe(),ee=P(W);{var w=z=>{var G=Cs(),V=s(a(G),2),_e=a(V);m(()=>b(_e,`${ya[t().status.spellCategory]??""}魔法`)),r(z,G)},F=z=>{var G=xe(),V=P(G);{var _e=T=>{var D=Ds(),d=s(a(D),2),y=a(d);m(()=>b(y,`${ha[t().status.trapCategory]??""}罠`)),r(T,D)};C(V,T=>{t().kind==="Trap"&&t().status.trapCategory&&T(_e)},!0)}r(z,G)};C(ee,z=>{t().kind==="Spell"&&t().status.spellCategory?z(w):z(F,!1)},!0)}r(L,W)};C(Te,L=>{t().kind==="Monster"?L(E):L(x,!1)})}r(Y,N)};C(j,Y=>{o()!=="Debug"&&Y(U)})}var ve=s(M,2),Me=a(ve);{var ge=Y=>{var N=Es(),fe=P(N);{var ae=x=>{var L=Ms(),W=a(L);mt(W,()=>e(g),ee=>{var w=tt('"読み込み中"');r(ee,w)},(ee,w)=>{var F=Ss(),z=a(F);m(()=>{var G;return b(z,(G=e(w))==null?void 0:G.pendulumDescription)}),r(ee,F)}),r(x,L)};C(fe,x=>{var L;(L=t().status.monsterCategories)!=null&&L.includes("Pendulum")&&x(ae)})}var Te=s(fe,2),E=a(Te);mt(E,()=>e(g),x=>{var L=tt('"読み込み中"');r(x,L)},(x,L)=>{var W=Ts(),ee=a(W);m(()=>{var w;return b(ee,(w=e(L))==null?void 0:w.description)}),r(x,W)}),r(Y,N)},ue=Y=>{var N=xe(),fe=P(N);{var ae=E=>{var x=xe(),L=P(x);{var W=ee=>{var w=As(),F=s(a(w),2);de(F,5,()=>t().actions,ce,(z,G)=>{var V=xe();const _e=oe(()=>e(G).actionCountUpperBound),T=oe(()=>e(G).actionCount);var D=P(V);{var d=y=>{var H=js(),X=a(H),Ce=a(X),De=s(X,2),me=a(De),ie=s(De,4),re=a(ie);m(()=>{b(Ce,e(G).title),b(me,e(T)),b(re,e(_e))}),r(y,H)};C(D,y=>{e(_e)!==void 0&&e(T)!==void 0&&y(d)})}r(z,V)}),r(ee,w)};C(L,ee=>{t().actions.some(w=>w.actionCountUpperBoundKey)&&ee(W)})}r(E,x)},Te=E=>{var x=Is(),L=a(x),W=a(L);de(W,0,()=>["info","status"],ce,(qe,be)=>{var Le=qs(),Ue=P(Le),Re=a(Ue),rt=s(Ue,2);de(rt,1,()=>Object.entries(t()[be]),ce,(Ze,$t)=>{let vt=()=>e($t)[0],St=()=>e($t)[1];var jt=Ls(),qt=a(jt),sa=s(qt);{var Yt=kt=>{var Mt=Bs(),xt=s(P(Mt));de(xt,1,St,ce,(ia,na)=>{var h=tt();m(k=>b(h,`${k??""},`),[()=>e(na).toString()],oe),r(ia,h)}),r(kt,Mt)},Qt=kt=>{var Mt=tt();m(xt=>b(Mt,`${xt??""},`),[()=>{var xt;return(xt=St())==null?void 0:xt.toString()}],oe),r(kt,Mt)};C(sa,kt=>{Array.isArray(St())?kt(Yt):kt(Qt,!1)})}m(()=>b(qt,`"${vt()??""}" : `)),r(Ze,jt)});var Xe=s(rt,2);Xe.textContent="},",m(()=>b(Re,`"${be??""}" :{`)),r(qe,Le)});var ee=s(W,2);ee.textContent='"actions" :[';var w=s(ee,2);de(w,1,()=>t().actions,ce,(qe,be)=>{var Le=Ys(),Ue=a(Le);m(()=>b(Ue,`"${e(be).playType??""} ${e(be).title??""}",`)),r(qe,Le)});var F=s(w,2);F.textContent="],";var z=s(F,2);z.textContent='"substituteEffects" :[';var G=s(z,2);de(G,1,()=>t().substituteEffects,ce,(qe,be)=>{var Le=Us(),Ue=a(Le);m(()=>b(Ue,`"${e(be).title??""}",`)),r(qe,Le)});var V=s(G,2);V.textContent="],";var _e=s(V,2);_e.textContent='"continuousEffects" :[';var T=s(_e,2);de(T,1,()=>t().continuousEffects,ce,(qe,be)=>{var Le=Hs(),Ue=a(Le);m(()=>b(Ue,`"${e(be).isStarted??""}",`)),r(qe,Le)});var D=s(T,2);D.textContent="],";var d=s(D,2);d.textContent='"procFilters" :[';var y=s(d,2);de(y,1,()=>t().procFilterBundle.operators,ce,(qe,be)=>{var Le=Ps(),Ue=a(Le);m(Re=>b(Ue,`"${Re??""} ${e(be).title??""} ${e(be).isEffective??""} ",`),[()=>e(be).isSpawnedBy.toString()],oe),r(qe,Le)});var H=s(y,2);H.textContent="],";var X=s(H,2);X.textContent='"numericStateOperators" :[';var Ce=s(X,2);de(Ce,1,()=>t().numericOprsBundle.operators,ce,(qe,be)=>{var Le=Ns(),Ue=a(Le);m(Re=>b(Ue,`"${Re??""} ${e(be).title??""} ${e(be).isEffective??""} ${e(be).isContinuous??""} ${e(be).targetState??""} ${e(be).targetStateGen??""} ",`),[()=>e(be).isSpawnedBy.toString()],oe),r(qe,Le)});var De=s(Ce,2);De.textContent="],";var me=s(De,2);me.textContent='"stateOperators" :[';var ie=s(me,2);de(ie,1,()=>t().statusOperatorBundle.operators,ce,(qe,be)=>{var Le=Fs(),Ue=a(Le);m(Re=>b(Ue,`"${Re??""} ${e(be).title??""} ${e(be).isEffective??""} ",`),[()=>e(be).isSpawnedBy.toString()],oe),r(qe,Le)});var re=s(ie,2);re.textContent="],";var te=s(re,2);te.textContent='"lastMoveLogRecord" :{';var $e=s(te,2),Ie=a($e),Fe=s($e,2),Oe=a(Fe),Ye=s(Fe,2),Ge=a(Ye),nt=s(Ye,2);nt.textContent="},",m((qe,be)=>{b(Ie,`"movedBy":"${qe??""}",`),b(Oe,`"movedAs":"${be??""}",`),b(Ge,`"movedAt":"${t().moveLog.latestRecord.movedAt.totalProcSeq??""}",`)},[()=>{var qe;return(qe=t().moveLog.latestRecord.movedBy)==null?void 0:qe.toString()},()=>t().moveLog.latestRecord.movedAs.join(" ")],oe),r(E,x)};C(fe,E=>{o()==="Detail"?E(ae):E(Te,!1)},!0)}r(Y,N)};C(Me,Y=>{o()==="Normal"?Y(ge):Y(ue,!1)})}var se=s(ve,2),Ee=a(se);{var ye=Y=>{var N=Vs(),fe=P(N);{var ae=L=>{var W=Os();r(L,W)};C(fe,L=>{t().origin.isOldVersion&&L(ae)})}var Te=s(fe,2);{var E=L=>{var W=Rs();r(L,W)},x=L=>{var W=zs(),ee=a(W);{var w=G=>{var V=Ks();const _e=oe(()=>t().entityType==="Card"?t():t().parent);var T=a(V);m(D=>{var d;at(V,"href",D),b(T,`⇒${((d=e(_e))!=null&&d.origin.cardId?"公式カードページ":"公式で検索")??""}`)},[c],oe),r(G,V)};C(ee,G=>{var V;t()&&(t().entityType==="Card"||((V=t().parent)==null?void 0:V.entityType)==="Card")&&G(w)})}var F=s(ee,2);mt(F,()=>e(g),null,(G,V)=>{var _e=xe(),T=P(_e);{var D=d=>{var y=Ws();m(()=>at(y,"href",`https://yugioh-wiki.net/index.php?${e(V).wikiEncodedName}`)),r(d,y)};C(T,d=>{e(V)&&e(V).wikiEncodedName&&d(D)})}r(G,_e)});var z=s(F,2);m(()=>at(z,"href",`https://www.google.com/search?q=遊戯王 ${t().origin.name}`)),r(L,W)};C(Te,L=>{t().origin.isForTest?L(E):L(x,!1)})}r(Y,N)};C(Ee,Y=>{t()&&Y(ye)})}m((Y,N)=>{Ae(S,`duel_card duel_card_info ${t().origin.kind??""} ${Y??""} svelte-1uevs9j`),b(R,t().nm),b(we,N)},[()=>{var Y;return(Y=t().origin.monsterCategories)==null?void 0:Y.join(" ")},()=>"★".repeat(t().lvl||0)],oe),r(A,S)};C(v,A=>{t()&&A(B)})}r(f,u),_t()}Wa(["click","contextmenu"]);var Qs=l('<div class="duel_field_cell_info_item svelte-1xj7qf1"><!></div>'),Js=l('<div class="duel_field_cell_info_box svelte-1xj7qf1"><div class="duel_field_cell_info_label svelte-1xj7qf1"> </div> <!></div>'),Zs=l('<div class="duel_field_cell_info svelte-1xj7qf1"><div class="duel_field_cell_info_header item_btn svelte-1xj7qf1"><div class="svelte-1xj7qf1"> </div> <div class="svelte-1xj7qf1"> </div></div> <div class="duel_field_cell_info_body svelte-1xj7qf1"></div></div>');function ei(f,i){dt(i,!1);let t=je(i,"cell",12);const o=()=>{t(t())},g=B=>t().cardEntities.filter(A=>A.face===B);t().field.duel.view.onDuelUpdate.append(o),ct();var c=xe(),u=P(c);{var v=B=>{var A=Zs(),S=a(A),M=a(S),n=a(M),q=s(M,2),R=a(q),I=s(S,2);de(I,4,()=>["FaceUp","FaceDown"],ce,(_,p)=>{var K=xe(),Z=P(K);{var we=j=>{var U=Js(),ve=a(U),Me=a(ve),ge=s(ve,2);de(ge,1,()=>g(p).toSorted(lr),ce,(ue,se)=>{var Ee=Qs(),ye=a(Ee);const Y=oe(()=>t().owner===t().field.duel.duelists.Below);Vt(ye,{get entity(){return e(se)},get isVisibleForcibly(){return e(Y)},isWideMode:!0,cardActionResolve:void 0}),r(ue,Ee)}),m(()=>b(Me,p==="FaceUp"?"表向き":"裏向き")),r(j,U)};C(Z,j=>{g(p).length&&j(we)})}r(_,K)}),m(()=>{var _;b(n,(_=t().owner)==null?void 0:_.profile.name),b(R,t().cellType)}),r(B,A)};C(u,B=>{t().field.duel.view.infoBoardState==="CellInfo"&&B(v)})}r(f,c),_t()}var ti=l('<div class="duel_config_item svelte-y4u26k"><label class="toggle svelte-y4u26k"><input type="checkbox" class="svelte-y4u26k"></label> <span class="svelte-y4u26k"> </span></div>'),ai=l('<div class="duel_config svelte-y4u26k"><div class="duel_config_title svelte-y4u26k">デュエル設定</div> <div class="duel_config_group svelte-y4u26k"><div class="duel_config_group_title svelte-y4u26k">チェーン設定</div> <!></div></div>');function ri(f,i){dt(i,!1);let t=je(i,"viewController",8),o=je(i,"userProfile",12);ct();var g=xe(),c=P(g);{var u=v=>{var B=ai(),A=s(a(B),2),S=s(a(A),2);de(S,1,()=>dr,ce,(M,n)=>{var q=ti(),R=a(q),I=a(R),_=s(R,2),p=a(_);m(()=>b(p,or[e(n)])),vr(I,()=>o().chainConfig[e(n)],K=>o(o().chainConfig[e(n)]=K,!0)),J("change",I,()=>o().save()),r(M,q)}),r(v,B)};C(c,v=>{t().infoBoardState==="Config"&&v(u)})}r(f,g),_t()}function si(f,{from:i,to:t},o={}){var{delay:g=0,duration:c=U=>Math.sqrt(U)*120,easing:u=xa}=o,v=getComputedStyle(f),B=v.transform==="none"?"":v.transform,[A,S]=v.transformOrigin.split(" ").map(parseFloat);A/=f.clientWidth,S/=f.clientHeight;var M=ii(f),n=f.clientWidth/t.width/M,q=f.clientHeight/t.height/M,R=i.left+i.width*A,I=i.top+i.height*S,_=t.left+t.width*A,p=t.top+t.height*S,K=(R-_)*n,Z=(I-p)*q,we=i.width/t.width,j=i.height/t.height;return{delay:g,duration:typeof c=="function"?c(Math.sqrt(K*K+Z*Z)):c,easing:u,css:(U,ve)=>{var Me=ve*K,ge=ve*Z,ue=U+ve*we,se=U+ve*j;return`transform: ${B} translate(${Me}px, ${ge}px) scale(${ue}, ${se});`}}}function ii(f){if("currentCSSZoom"in f)return f.currentCSSZoom;for(var i=f,t=1;i!==null;)t*=+getComputedStyle(i).zoom,i=i.parentElement;return t}var ni=l('<div class="chain_number svelte-lqu21u"> </div>'),li=l('<div class="duel_card_row svelte-lqu21u"> </div>'),oi=l('<div class="appendix svelte-lqu21u"> </div>'),vi=l('<div class="appendix_wrapper svelte-lqu21u"></div>'),di=l('<div><div><!> <div> </div> <div><!> <div class="duel_card_row svelte-lqu21u"><div> </div> <!></div></div></div></div>'),ci=l("<div></div>");function _i(f,i){dt(i,!1);let t=je(i,"duel",8),o=je(i,"position",8,"left");const g=-100,c=()=>o()==="left"?-100:100;let u=ne([]),v=Promise.resolve(),B=Promise.resolve();const A=1e3,S=500,M=400,n=R=>{const I={...R};I.isKnown=R.chainBlockInfo.action.entity.controller.duelistType==="Player"||R.chainBlockInfo.action.entity.face==="FaceUp",I.chainBlockInfo.onStateChange.append(_=>{if(_==="done"||_==="failed"||_==="negated")return v=v.then(async()=>{const p=new Date().getTime()-I.chainBlockInfo.wasSpawnedAt.getTime();p<A&&await ea(A-p),$(u,e(u).filter(K=>K.seq!==I.seq)),await ea(S+M)}).then(),"RemoveMe";$(u,e(u))}),B=B.then(async()=>{$(u,[I,...e(u)].sort((_,p)=>cr.isSameChain(_.clock,p.clock)&&_.chainBlockInfo.action.isWithChainBlock&&p.chainBlockInfo.action.isWithChainBlock?p.clock.totalProcSeq-_.clock.totalProcSeq:_.clock.totalProcSeq-p.clock.totalProcSeq)),await ea(300)}),v=v.then(()=>ea(1e3))};t().chainBlockLog.onInsert.append(n),ct();var q=ci();de(q,13,()=>e(u),R=>R.seq,(R,I)=>{var _=di();const p=oe(()=>{const{activator:N,action:fe,appendix:ae}=e(I).chainBlockInfo;return{activator:N,action:fe,appendix:ae}});var K=a(_),Z=a(K);{var we=N=>{var fe=ni(),ae=a(fe);m(()=>b(ae,`チェーン：${e(I).chainBlockInfo.chainNumber??""}`)),r(N,fe)};C(Z,N=>{e(I).chainBlockInfo.chainNumber&&N(we)})}var j=s(Z,2),U=a(j),ve=s(j,2),Me=a(ve);{var ge=N=>{var fe=li(),ae=a(fe);m(()=>b(ae,e(I).isKnown?e(p).action.entity.nm:"？？？")),r(N,fe)};C(Me,N=>{(e(p).action.entity.entityType==="Card"||e(p).action.entity.entityType==="Token")&&N(ge)})}var ue=s(Me,2),se=a(ue),Ee=a(se),ye=s(se,2);{var Y=N=>{var fe=vi();de(fe,5,()=>e(p).appendix,ce,(ae,Te)=>{var E=oi(),x=a(E);m(()=>b(x,e(Te))),r(ae,E)}),r(N,fe)};C(ye,N=>{e(p).appendix&&N(Y)})}m((N,fe,ae)=>{Ae(_,`cut_in_row ${(!e(I).chainBlockInfo.chainNumber||e(I).chainBlockInfo.chainNumber===1?"cut_in_row_first":"")??""} svelte-lqu21u`),Ae(K,`cut_in_item cut_in_item_${N??""} cut_in_item_${e(I).chainBlockInfo.state??""} svelte-lqu21u`),Ae(j,`duelist_name duelist_${N??""}_name svelte-lqu21u`),b(U,e(p).activator.profile.name),Ae(ve,`duel_card duel_card_${N??""} ${fe??""} ${(e(I).isKnown?e(p).action.entity.origin.kind:"")??""} ${e(p).action.entity.entityType??""}  svelte-lqu21u`),b(Ee,ae)},[()=>e(p).activator.seat.toLowerCase(),()=>e(I).isKnown?(e(p).action.entity.status.monsterCategories??[]).join(" "):"Token",()=>e(p).action.toString()],oe),le(3,K,()=>Ar,()=>new Date().getTime()-e(I).chainBlockInfo.wasSpawnedAt.getTime()<A?{x:c(),duration:M}:{y:g,duration:M}),_r(_,()=>si,()=>({duration:S})),r(R,_)}),m(()=>Ae(q,`cut_in_container cut_in_container_${o()??""} svelte-lqu21u`)),r(f,q),_t()}const ui=Br({duration:400});var fi=l('<div class="duel_desk_left v_flex svelte-1w535im"><!> <!> <!></div>'),mi=l('<button class="duel_field_header_message svelte-1w535im"> </button> <div class="duel_field_header_buttons svelte-1w535im"><button class="svelte-1w535im">サレンダー</button></div>',1),pi=l("<tr></tr>"),gi=l('<table class="duel_field svelte-1w535im"><tbody class="svelte-1w535im"></tbody></table>'),yi=l('<button class="svelte-1w535im">OK</button>'),hi=l('<button class="svelte-1w535im">cancel</button>'),bi=l("<!> <!>",1),ki=l('<button class="svelte-1w535im"> </button>'),xi=l('<div style="text-align: left;"><!> <!> <!></div>'),wi=l('<div><!> <div class=" duel_desk_center v_flex svelte-1w535im"><div class="duel_field_header svelte-1w535im"><!></div> <div class="duel_field_body svelte-1w535im"><!></div> <div class="duel_field_footer svelte-1w535im"><!></div></div> <!></div> <div style="position:fixed;bottom:0"> </div> <!> <div><!></div>',1);function Ci(f,i){dt(i,!1);let t=je(i,"duel",12),o=je(i,"userProfile",8),g=ne(0),c=ne(0),u=ne([]),v=ne([]),B=()=>{},A=ne([]),S=ne(),M=ne(),n=ne(()=>!1),q=ne(!1);const R=d=>{B=d.resolve,$(A,d.dummyActionInfos.filter(y=>y.action.entity.entityType==="Duelist").filter(y=>y.action.entity.controller.seat==="Below")),$(S,void 0),$(M,void 0),$(v,[]),$(u,[]),$(q,!1),d.entitiesChoices&&($(S,d.entitiesChoices),$(n,()=>{var y;return((y=d.entitiesChoices)==null?void 0:y.validator(e(u)))??!1}),$(q,d.entitiesChoices.cancelable),e(S).selectables.every(y=>y.cell.isPlayFieldCell&&y.getIndexInCell()===0||y.cell.cellType==="Hand"&&y.controller.duelistType==="Player"||y.entityType==="Duelist")||t().view.modalController.entitySelector.show({title:t().view.message,position:"Middle",entitiesChoices:d.entitiesChoices,chainBlockInfos:d.chainBlockInfos,cancelable:d.entitiesChoices.cancelable}).then(y=>{B({selectedEntities:y})})),d.cellsChoices&&($(M,d.cellsChoices),$(n,()=>{var y;return((y=d.cellsChoices)==null?void 0:y.validator(e(v)))??!1}),$(q,d.cellsChoices.cancelable))};t().view.onWaitStart.append(R);const I=()=>{B=()=>{},$(M,void 0),$(S,void 0),$(v,[]),$(u,[]),$(n,()=>!1),$(q,!1)};t().view.onWaitEnd.append(I);let _=ne(void 0),p=ne("Normal");const K=({card:d,mode:y})=>{$(_,d),$(p,y??(e(_)===d||e(p)==="Normal"?"Detail":"Normal"))};t().view.onShowCardEntity.append(K);const Z=()=>{t(t())};t().view.onDuelUpdate.append(Z),t().log.onUpdate.append(Z);const we=()=>{e(S)&&e(S).validator(e(u))&&B({selectedEntities:e(u)}),e(M)&&e(M).validator(e(v))&&B({selectedCells:e(v)})},j=()=>{B({})},U=d=>{B({actionInfo:d})},ve=()=>{B({surrender:!0})};t().main();const Me=()=>e(g)<=1400?"compact":"wide";ct();var ge=wi(),ue=P(ge),se=a(ue);{var Ee=d=>{var y=fi(),H=a(y);Ra(H,{get duelist(){return t().duelists.Above}});var X=s(H,2);{var Ce=me=>{Gs(me,{get entity(){return e(_)},get mode(){return e(p)}})};C(X,me=>{e(_)&&me(Ce)})}var De=s(X,2);Ra(De,{get duelist(){return t().duelists.Below}}),r(d,y)};C(se,d=>{Me()==="wide"&&d(Ee)})}var ye=s(se,2),Y=a(ye),N=a(Y);{var fe=d=>{var y=mi(),H=P(y),X=a(H),Ce=s(H,2),De=a(Ce);m(()=>b(X,`[TURN:${t().clock.turn}][PHASE:${t().phase}] ${t().view.message}`)),J("click",H,()=>{t(t().view.infoBoardState="Log",!0)}),J("click",De,ve),r(d,y)};C(N,d=>{t().isEnded||d(fe)})}var ae=s(Y,2),Te=a(ae);{var E=d=>{var y=gi(),H=a(y);de(H,5,()=>t().field.cells,ce,(X,Ce,De)=>{var me=pi();Ae(me,`${`duel_desk_row_${De}`??""} svelte-1w535im`),de(me,5,()=>e(Ce),ce,(ie,re,te)=>{es(ie,{get view(){return t().view},row:De,column:te,get selectedEntities(){return e(u)},set selectedEntities($e){$(u,$e)},get selectedCells(){return e(v)},set selectedCells($e){$(v,$e)},$$legacy:!0})}),r(X,me)}),r(d,y)};C(Te,d=>{t().clock.turn>0&&d(E)})}var x=s(ae,2),L=a(x);{var W=d=>{var y=bi(),H=P(y);{var X=me=>{var ie=yi();m(re=>ie.disabled=re,[()=>!e(n)()],oe),J("click",ie,we),r(me,ie)};C(H,me=>{((e(S)&&e(S).qty)??(e(M)&&e(M).qty)??9999)>1&&me(X)})}var Ce=s(H,2);{var De=me=>{var ie=hi();J("click",ie,j),r(me,ie)};C(Ce,me=>{e(q)&&me(De)})}r(d,y)},ee=d=>{var y=xe(),H=P(y);de(H,1,()=>e(A),ce,(X,Ce)=>{var De=ki(),me=a(De);m(()=>b(me,e(Ce).action.title)),J("click",De,()=>U(e(Ce))),r(X,De)}),r(d,y)};C(L,d=>{e(S)&&e(S).selectables.length||e(M)&&e(M).selectables?d(W):d(ee,!1)})}var w=s(ye,2);{var F=d=>{var y=xi(),H=a(y);cs(H,{get log(){return t().log}});var X=s(H,2);ei(X,{get cell(){return t().view.infoBoardCell}});var Ce=s(X,2);ri(Ce,{get userProfile(){return o()},get viewController(){return t().view}}),m(De=>Ae(y,`duel_desk_right duel_desk_right_${De??""}  svelte-1w535im`),[()=>t().view.infoBoardState.toLowerCase()],oe),le(3,y,()=>ke,()=>({duration:e(g)>1400?0:200,axis:"x"})),r(d,y)};C(w,d=>{(e(g)>1400||t().view.infoBoardState!=="Default")&&d(F)})}var z=s(ue,2),G=a(z),V=s(z,2);ur(V,{get modalController(){return t().view.modalController}});var _e=s(V,2),T=a(_e);const D=oe(()=>Me()==="wide"?"right":"left");_i(T,{get duel(){return t()},get position(){return e(D)}}),m((d,y)=>{Ae(ue,`flex duel_desk ${d??""}_mode svelte-1w535im`),b(G,y),Ae(_e,`cutin ${d??""}_mode svelte-1w535im`)},[Me,()=>t().clock.toFullString()],oe),ua("innerWidth",d=>$(g,d)),ua("innerHeight",d=>$(c,d)),r(f,ge),_t()}var Di=l("<div></div>"),$i=l("<!> <!> <!> <!>",1),Si=l('<span class="atk svelte-1y1qbq4"> </span> <span class="slash svelte-1y1qbq4">/</span> <span class="def svelte-1y1qbq4"> </span>',1),Mi=l('<div role="listitem"><div class="svelte-1y1qbq4"><div class="duel_card_row card_name svelte-1y1qbq4"> </div> <div style="display:flex; flex-wrap: wrap;" class="svelte-1y1qbq4"><div style="" class="svelte-1y1qbq4"><!> <!> <!></div> <div class="atk_def svelte-1y1qbq4"><!></div></div></div></div>');function Qa(f,i){dt(i,!1);let t=je(i,"mode",8),o=je(i,"cardInfo",8),g=je(i,"onAttention",8),c=je(i,"cardControlEventHandlers",8);ct();var u=Mi(),v=a(u),B=a(v),A=a(B),S=s(B,2),M=a(S),n=a(M);{var q=j=>{var U=$i(),ve=P(U);{var Me=ye=>{var Y=tt();m(()=>b(Y,`★${o().level??""}`)),r(ye,Y)},ge=ye=>{var Y=xe(),N=P(Y);{var fe=Te=>{var E=tt();m(()=>b(E,`☆${o().rank??""}`)),r(Te,E)},ae=Te=>{var E=xe(),x=P(E);{var L=W=>{var ee=tt();m(()=>b(ee,`Ｌ${o().link??""}`)),r(W,ee)};C(x,W=>{o().link&&W(L)},!0)}r(Te,E)};C(N,Te=>{o().rank?Te(fe):Te(ae,!1)},!0)}r(ye,Y)};C(ve,ye=>{o().level?ye(Me):ye(ge,!1)})}var ue=s(ve,2);de(ue,1,()=>o().attributes??[],ce,(ye,Y)=>{var N=Di();m(()=>Ae(N,`monster_attr ${e(Y)??""} svelte-1y1qbq4`)),r(ye,N)});var se=s(ue,2);de(se,1,()=>o().types??[],ce,(ye,Y)=>{var N=tt();m(()=>b(N,ga[e(Y)])),r(ye,N)});var Ee=s(se,2);de(Ee,1,()=>o().monsterCategories??[],ce,(ye,Y)=>{var N=tt();m(()=>b(N,va[e(Y)])),r(ye,N)}),r(j,U)};C(n,j=>{o().kind==="Monster"&&j(q)})}var R=s(n,2);{var I=j=>{var U=tt();m(()=>b(U,`${ya[o().spellCategory]??""}魔法`)),r(j,U)};C(R,j=>{o().spellCategory&&j(I)})}var _=s(R,2);{var p=j=>{var U=tt();m(()=>b(U,`${ha[o().trapCategory]??""}罠`)),r(j,U)};C(_,j=>{o().trapCategory&&j(p)})}var K=s(M,2),Z=a(K);{var we=j=>{var U=Si(),ve=P(U),Me=a(ve),ge=s(ve,4),ue=a(ge);m(()=>{b(Me,o().attack??"?"),b(ue,o().defense??"?")}),r(j,U)};C(Z,j=>{o().kind==="Monster"&&j(we)})}m(j=>{Ae(u,`${j??""} svelte-1y1qbq4`),b(A,o().name)},[()=>{var j,U;return`deck_editor_card duel_card ${o().kind} ${(U=(j=o())==null?void 0:j.monsterCategories)==null?void 0:U.join(" ")} ${o().isImplemented?"is_implemented":"is_not_implemented"}`}],oe),J("click",u,()=>g()(o())),J("touchstart",u,j=>c().onCardDragStart(j,t(),o())),J("touchmove",u,j=>c().onCardDragging(j,t())),J("touchend",u,function(...j){var U;(U=c().onCardDragEnd)==null||U.apply(this,j)}),J("touchcancel",u,function(...j){var U;(U=c().onCardDragCancel)==null||U.apply(this,j)}),J("mousedown",u,j=>c().onCardDragStart(j,t(),o())),J("mousemove",u,j=>c().onCardDragging(j,t())),J("mouseup",u,function(...j){var U;(U=c().onCardDragEnd)==null||U.apply(this,j)}),r(f,u),_t()}var Ti=l('<button class="button_style_reset plus_minus_button svelte-1ty6ui7">+</button> <button class="button_style_reset plus_minus_button svelte-1ty6ui7">-</button>',1),Ei=l('<li class="deck_editor_item svelte-1ty6ui7"><!> <!></li>'),ji=l('<div class="deck_editor_card_list_wrapper svelte-1ty6ui7"><ul></ul></div>');function Ai(f,i){dt(i,!1);let t=je(i,"cardList",8),o=je(i,"mode",8),g=je(i,"state",8),c=je(i,"onAttention",8),u=je(i,"cardControlEventHandlers",8);const v=20;let B=ne(0),A=ne(v),S=ne(0),M=ne(0),n=ne(0),q=ne();ca(()=>(e(q),Rt(o()),Rt(t()),e(n),e(M),Rt(g())),()=>{if(e(q))if(he(q,e(q).scrollTop=0),o()==="List"){const _=t().length>v?v:t().length;e(n)||($(M,e(q).scrollHeight/_),$(n,Math.ceil(e(M)))),console.log(g(),t().length),t().length>v?$(S,e(n)*(t().length-v*2)+Math.ceil(e(M)*(v*2-1))):$(S,e(n)*t().length)}else $(A,t().length)}),Da(),ct();var R=ji(),I=a(R);de(I,5,t,ce,(_,p,K)=>{var Z=xe(),we=P(Z);{var j=U=>{var ve=Ei(),Me=a(ve);Qa(Me,{get mode(){return o()},get cardInfo(){return e(p)},get onAttention(){return c()},get cardControlEventHandlers(){return u()}});var ge=s(Me,2);{var ue=se=>{var Ee=Ti(),ye=P(Ee),Y=s(ye,2);m(N=>{ye.disabled=!e(p).isImplemented,at(ye,"title",e(p).isImplemented?`※shiftキー同時押しで一括投入
※ctrlキー同時押しで枚数制限無視`:""),Y.disabled=N,at(Y,"title",e(p).isImplemented?"※shiftキー同時押しで一括外し":"")},[()=>t().every(N=>N.name!==e(p).name)],oe),J("click",ye,N=>u().onCardAppend(N,e(p))),J("click",Y,N=>u().onCardRemove(N,e(p))),r(se,Ee)};C(ge,se=>{o()==="Deck"&&se(ue)})}r(U,ve)};C(we,U=>{K>=e(B)&&K<=e(A)&&U(j)})}r(_,Z)}),za(I,_=>$(q,_),()=>e(q)),m(_=>{Ae(I,`deck_editor_card_list ${_??""}  indexLowerBound_${e(B)??""} indexUpperBound=${e(A)??""} svelte-1ty6ui7`),at(I,"style",`height: ${(e(S)?e(S)+"px":"fit-content")??""};padding-top: ${e(B)*e(n)}px`)},[()=>g().toLowerCase()],oe),J("scroll",R,_=>{if(!e(n))return;const p=Math.ceil(_.currentTarget.scrollTop/e(n));$(B,p<v?0:p-v),$(A,p+v)}),r(f,R),_t()}var Bi=l('<div class="svelte-m6gfl0"><button class="button_style_reset svelte-m6gfl0">クリア</button></div>'),Li=l('<div class="deck_editor_card_kind_header svelte-m6gfl0"><div class="svelte-m6gfl0"> <!> 枚）</div> <div style="display: flex;" class="svelte-m6gfl0"><!> <div class="triangle svelte-m6gfl0">▲</div></div></div> <div class="deck_editor_card_kind_body svelte-m6gfl0"><!></div>',1),qi=l("<div><!></div>"),Yi=l('<div class="deck_editor_card_list svelte-m6gfl0"></div>');function Ka(f,i){dt(i,!1);let t=je(i,"allCardTree",8),o=je(i,"deckCardTree",12),g=je(i,"mode",8),c=je(i,"onAttention",8),u=je(i,"searchCondition",8,void 0),v=je(i,"cardControlEventHandlers",8),B=ne("ExtraMonster");const A=ne(g()==="List"?t():o()),S=(..._)=>{const p=_.length?_:Xt(e(A)),K=(Z,we)=>{var j;return Ga(Z,we,(j=u())==null?void 0:j.sort.filter(U=>U.priority>0).toSorted((U,ve)=>U.priority-ve.priority))};p.forEach(Z=>e(A)[Z].sort(K))},M=(_,p)=>{o(o()[p]=[],!0)};let n=ne(structuredClone(e(A))),q=ne("");const R=_=>{if(!u())return!0;if(_.kind==="XyzMaterial")return!1;const p=fa(_);if(!u().deckCardKinds.includes(p)||u().name.trim().length&&[_.name,..._.nameTags??[],..._.textTags??[]].every(Z=>!Z.includes(u().name))||!_.isImplemented&&!u().others.includes("implemented")||_.isForTest&&!u().others.includes("test")||_.isOldVersion&&!u().others.includes("oldVersion"))return!1;if(_.kind==="Monster"){if(_.attributes&&!u().monsterAttributes.union(_.attributes).length||_.types&&!u().monsterTypes.union(_.types).length)return!1;const K=_.level??_.rank??_.link;return Bt(u().starLowerBound)&&(K??0)<u().starLowerBound||Bt(u().starUpperBound)&&(K??0)>u().starUpperBound||Bt(u().atkLowerBound)&&(_.attack??0)<u().atkLowerBound||Bt(u().atkUpperBound)&&(_.attack??0)>u().atkUpperBound||Bt(u().defLowerBound)&&(_.defense??0)<u().defLowerBound||Bt(u().defUpperBound)&&(_.defense??0)>u().defUpperBound||Bt(u().atkPlusDef)&&(!Bt(_.attack)||!Bt(_.defense)||_.attack+_.defense!==u().atkPlusDef)||!_.monsterCategories||p==="ExtraMonster"&&!_.monsterCategories.union(u().exMonsterCategories).length?!1:_.monsterCategories.union(u().monsterCategories).length}if(_.kind==="Spell")return _.spellCategory&&u().spellCategories.includes(_.spellCategory);if(_.kind==="Trap")return _.trapCategory&&u().trapCategories.includes(_.trapCategory)};ca(()=>(Rt(g()),e(A),Rt(o()),e(B),e(n)),()=>{if(g()==="Deck"){if(Xt(e(A)).forEach(_=>he(A,e(A)[_]=o()[_])),!e(A)[e(B)].length)$(B,Xt(e(A)).find(_=>e(A)[_].find(R))??"ExtraMonster");else{const _=Xt(e(A)).map(p=>({kind:p,cardInfos:e(A)[p]})).filter(({cardInfos:p})=>p.length).find(({kind:p,cardInfos:K})=>K.length!==e(n)[p].length);_&&e(B)!==_.kind&&$(B,_.kind)}$(n,structuredClone(e(A)))}}),ca(()=>(Rt(g()),Rt(u()),e(q)),()=>{var _;if(g()==="List"){const p=JSON.stringify((_=u())==null?void 0:_.sort);e(q)!==p&&($(q,p),S())}}),Da(),ct();var I=Yi();de(I,5,()=>ta,ce,(_,p,K)=>{var Z=qi();const we=oe(()=>e(A)[e(p)].filter(R));var j=a(Z);{var U=ve=>{var Me=Li(),ge=P(Me),ue=a(ge),se=a(ue),Ee=s(se);{var ye=x=>{var L=tt();m(W=>b(L,`/ ${W??""}`),[()=>e(A)[e(p)].length.toLocaleString()],oe),r(x,L)};C(Ee,x=>{g()==="List"&&x(ye)})}var Y=s(ue,2),N=a(Y);{var fe=x=>{var L=Bi(),W=a(L);J("click",W,ee=>M(ee,e(p))),r(x,L)};C(N,x=>{g()==="Deck"&&e(we).length&&x(fe)})}var ae=s(ge,2),Te=a(ae);const E=oe(()=>e(B)===e(p)?"Open":"Close");Ai(Te,{get mode(){return g()},get cardList(){return e(we)},get onAttention(){return c()},get cardControlEventHandlers(){return v()},get state(){return e(E)}}),m(x=>b(se,`${Xa[e(p)]??""}（${x??""} `),[()=>e(we).length.toLocaleString()],oe),J("click",ge,()=>{if(e(B)!==e(p)){$(B,e(p));return}$(B,ta.map((x,L)=>L+K).map(x=>x%ta.length).map(x=>ta[x]).filter(x=>x!==e(p)).find(x=>e(A)[x].find(R))??e(p))}),r(ve,Me)};C(j,ve=>{e(we).length&&ve(U)})}m(()=>Ae(Z,`deck_editor_card_kind deckCardKind ${(e(p)===e(B)?"selected":"")??""} ${(e(we).length?"":"empty")??""} svelte-m6gfl0`)),r(_,Z)}),r(f,I),_t()}var Ui=l('<div class="svelte-7xhk0x"> </div>'),Hi=l('<div class="svelte-7xhk0x"> </div>'),Pi=l('<div class="link_arrow_emoji svelte-7xhk0x"> </div>'),Ni=l('<div class="duel_card_info_row svelte-7xhk0x" style="position:sticky; top:0;"><!></div>'),Fi=l('<div class="duel_card_info_row svelte-7xhk0x"><div class="svelte-7xhk0x"><pre class="description svelte-7xhk0x"> </pre></div></div> <div class="duel_card_info_row svelte-7xhk0x" style=" justify-content: space-between;"><div class="svelte-7xhk0x"> </div> <div class="svelte-7xhk0x"> </div></div>',1),Ii=l('<div></div> <div class="svelte-7xhk0x"> </div>',1),Oi=l("<div> </div>"),Ri=l('<span class="svelte-7xhk0x">/</span> <div class="monster_defense svelte-7xhk0x"> </div>',1),Ki=l("<div> </div>"),Wi=l('<div class="duel_card_info_row svelte-7xhk0x"><!> <!> <div style="flex-grow: 1;" class="svelte-7xhk0x"></div> <div class="monster_attack svelte-7xhk0x"> </div> <!></div> <div class="duel_card_info_row svelte-7xhk0x"></div>',1),zi=l('<div class="duel_card_row svelte-7xhk0x"><div class="svelte-7xhk0x"></div> <div class="svelte-7xhk0x"> </div></div>'),Vi=l('<div class="duel_card_row svelte-7xhk0x"><div class="svelte-7xhk0x"></div> <div class="svelte-7xhk0x"> </div></div>'),Xi=l('<div class="duel_card_info_row svelte-7xhk0x"><div class="svelte-7xhk0x">※エラッタ前カードです</div></div>'),Gi=l('<div class="duel_card_info_row svelte-7xhk0x"><div class="svelte-7xhk0x">※テスト用カードです</div></div>'),Qi=l('<div class="duel_card_info_links svelte-7xhk0x"><a target="_blank" rel="noopener noreferrer" title="コナミカードデータベース" class="svelte-7xhk0x"> </a> <a target="_blank" rel="noopener noreferrer" title="遊戯王カードWiki" class="svelte-7xhk0x">⇒遊戯王カードWiki</a> <a target="_blank" rel="noopener noreferrer" title="google" class="svelte-7xhk0x">⇒google検索</a></div>'),Ji=l('<div><div class="duel_card_info_header svelte-7xhk0x"><div class="duel_card_info_row svelte-7xhk0x"><div class="svelte-7xhk0x"> </div></div> <!> <div class="plus_minus_button_area svelte-7xhk0x"><button class="button_style_reset plus_minus_button svelte-7xhk0x">+</button> <button class="button_style_reset plus_minus_button svelte-7xhk0x">-</button></div></div> <div class="duel_card_info_body svelte-7xhk0x"><!> <!> <div class="duel_card_info_row description svelte-7xhk0x"><div class="svelte-7xhk0x"><pre class="description svelte-7xhk0x"> </pre></div></div> <!> <!></div></div>');function Zi(f,i){dt(i,!1);let t=je(i,"cardInfo",8,void 0),o=je(i,"onAttention",8),g=je(i,"cardControlEventHandlers",8),c=je(i,"deckCardTree",8);ct();var u=xe(),v=P(u);{var B=A=>{var S=Ji(),M=a(S),n=a(M),q=a(n),R=a(q),I=s(n,2);{var _=E=>{var x=Ni(),L=a(x);{var W=w=>{var F=Ui(),z=a(F);m(G=>b(z,G),[()=>"★".repeat(t().level)],oe),r(w,F)},ee=w=>{var F=xe(),z=P(F);{var G=_e=>{var T=Hi(),D=a(T);m(d=>b(D,d),[()=>"★".repeat(t().rank)],oe),r(_e,T)},V=_e=>{var T=xe(),D=P(T);{var d=y=>{var H=Pi(),X=a(H);m(Ce=>b(X,Ce),[()=>t().linkArrowKeys.map(Ce=>Va[Ce].emoji).join("")],oe),r(y,H)};C(D,y=>{t().linkArrowKeys&&y(d)},!0)}r(_e,T)};C(z,_e=>{t().rank&&t().rank>0?_e(G):_e(V,!1)},!0)}r(w,F)};C(L,w=>{t().level&&t().level>0?w(W):w(ee,!1)})}r(E,x)};C(I,E=>{t().kind==="Monster"&&E(_)})}var p=s(I,2),K=a(p),Z=s(K,2),we=s(M,2),j=a(we);{var U=E=>{var x=Fi(),L=P(x),W=a(L),ee=a(W),w=a(ee),F=s(L,2),z=a(F),G=a(z),V=s(z,2),_e=a(V);m(()=>{b(w,t().pendulumDescription),b(G,`◀ ${t().pendulumScaleL??""}`),b(_e,`${t().pendulumScaleR??""} ▶`)}),r(E,x)};C(j,E=>{var x;(x=t().monsterCategories)!=null&&x.includes("Pendulum")&&E(U)})}var ve=s(j,2);{var Me=E=>{var x=Wi(),L=P(x),W=a(L);{var ee=D=>{var d=Ii(),y=P(d),H=s(y,2),X=a(H);m(()=>{Ae(y,`monster_attr ${t().attributes[0]??""} svelte-7xhk0x`),b(X,`${$a[t().attributes[0]]??""}属性`)}),r(D,d)};C(W,D=>{t().attributes&&D(ee)})}var w=s(W,2);{var F=D=>{var d=Oi(),y=a(d);m(()=>{Ae(d,`monster_cat ${t().types[0]??""} svelte-7xhk0x`),b(y,`${ga[t().types[0]]??""}${Sa[t().types[0]]??""}族`)}),r(D,d)};C(w,D=>{t().types&&D(F)})}var z=s(w,4),G=a(z),V=s(z,2);{var _e=D=>{var d=Ri(),y=s(P(d),2),H=a(y);m(()=>b(H,t().defense??"?")),r(D,d)};C(V,D=>{var d;(d=t().monsterCategories)!=null&&d.includes("Link")||D(_e)})}var T=s(L,2);de(T,5,()=>t().monsterCategories??[],ce,(D,d)=>{var y=Ki(),H=a(y);m(()=>{Ae(y,`monster_cat ${e(d)??""} svelte-7xhk0x`),b(H,`${va[e(d)]??""}${_a[e(d)]??""}`)}),r(D,y)}),m(()=>b(G,t().attack??"?")),r(E,x)},ge=E=>{var x=xe(),L=P(x);{var W=w=>{var F=zi(),z=s(a(F),2),G=a(z);m(()=>b(G,`${ya[t().spellCategory]??""}魔法`)),r(w,F)},ee=w=>{var F=xe(),z=P(F);{var G=V=>{var _e=Vi(),T=s(a(_e),2),D=a(T);m(()=>b(D,`${ha[t().trapCategory]??""}罠`)),r(V,_e)};C(z,V=>{t().kind==="Trap"&&t().trapCategory&&V(G)},!0)}r(w,F)};C(L,w=>{t().kind==="Spell"&&t().spellCategory?w(W):w(ee,!1)},!0)}r(E,x)};C(ve,E=>{t().kind==="Monster"?E(Me):E(ge,!1)})}var ue=s(ve,2),se=a(ue),Ee=a(se),ye=a(Ee),Y=s(ue,2);{var N=E=>{var x=Xi();r(E,x)};C(Y,E=>{t().isOldVersion&&E(N)})}var fe=s(Y,2);{var ae=E=>{var x=Gi();r(E,x)},Te=E=>{var x=Qi(),L=a(x),W=a(L),ee=s(L,2),w=s(ee,2);m(F=>{at(L,"href",F),b(W,`⇒${(t().cardId?"公式カードページ":"公式で検索")??""}`),at(ee,"href",`https://yugioh-wiki.net/index.php?${t().wikiEncodedName}`),at(w,"href",`https://www.google.com/search?q=遊戯王 ${t().name}`)},[()=>fr(t())],oe),r(E,x)};C(fe,E=>{t().isForTest?E(ae):E(Te,!1)})}m((E,x)=>{Ae(S,`duel_card duel_card_info ${t().kind??""} ${E??""} svelte-7xhk0x`),b(R,t().name),K.disabled=!t().isImplemented,at(K,"title",t().isImplemented?`※shiftキー同時押しで一括投入
※ctrlキー同時押しで枚数制限無視`:""),Z.disabled=x,at(Z,"title",t().isImplemented?"※shiftキー同時押しで一括外し":""),b(ye,t().description)},[()=>{var E;return(E=t().monsterCategories)==null?void 0:E.join(" ")},()=>c()[fa(t())].every(E=>E.name!==t().name)],oe),J("click",K,E=>g().onCardAppend(E,t())),J("click",Z,E=>g().onCardRemove(E,t())),J("click",S,()=>o()(t())),r(A,S)};C(v,A=>{t()&&A(B)})}r(f,u),_t()}const en={0:{aaa:"日",aaaa:"日曜日",ddd:"Sun",dddd:"Sunday"},1:{aaa:"月",aaaa:"月曜日",ddd:"Mon",dddd:"Monday"},2:{aaa:"火",aaaa:"火曜日",ddd:"Tue",dddd:"Tuesday"},3:{aaa:"水",aaaa:"水曜日",ddd:"Wed",dddd:"Wednesday"},4:{aaa:"木",aaaa:"木曜日",ddd:"Thu",dddd:"Thursday"},5:{aaa:"金",aaaa:"金曜日",ddd:"Fri",dddd:"Friday"},6:{aaa:"土",aaaa:"土曜日",ddd:"Sat",dddd:"Saturday"}};class tn{constructor(){it(this,"DefaultSeparator1","/");it(this,"DefaultSeparator2"," ");it(this,"DefaultSeparator3",":");it(this,"createDate",i=>{if(!i)return;const t=new Date(i);if(!isNaN(t.getTime()))return t});it(this,"createDateOr",(i,t)=>this.createDate(i)||t||new Date);it(this,"truncateDate",i=>{const t=i||new Date;return new Date(t.getFullYear(),t.getMonth(),t.getDate())});it(this,"addDate",(i,t)=>{const o=this.createDateOr(i);return o.setDate(o.getDate()+t),o});it(this,"addMonth",(i,t)=>{const o=this.createDateOr(i);return o.setMonth(o.getMonth()+t),o});it(this,"addYear",(i,t)=>{const o=this.createDateOr(i);return o.setFullYear(o.getFullYear()+t),o});it(this,"getDayOfWeek",(i,t="dddd")=>{const o=this.createDate(i);return o?en[o.getDay()][t]:""});it(this,"formatToYYYYMMDD",(i,t=this.DefaultSeparator1)=>{const o=this.createDate(i);if(!o)return"";const g=o.getFullYear().toString(),c=("0"+(o.getMonth()+1)).slice(-2),u=("0"+o.getDate()).slice(-2);return g+t+c+t+u});it(this,"formatToYYYYMM",(i,t=this.DefaultSeparator1)=>{const o=this.createDate(i);if(!o)return"";t||(t="");const g=o.getFullYear().toString(),c=("0"+(o.getMonth()+1)).slice(-2);return g+t+c});it(this,"formatToHHMMSS",(i,t=this.DefaultSeparator3)=>{const o=this.createDate(i);if(!o)return"";t||(t="");const g=o.getHours(),c=o.getMinutes(),u=o.getSeconds();return("0"+g).slice(-2)+t+("0"+c).slice(-2)+t+("0"+u).slice(-2)});it(this,"formatToHHMM",(i,t=this.DefaultSeparator3)=>{const o=this.createDate(i);if(!o)return"";t||(t="");const g=("0"+o.getHours()).slice(-2),c=("0"+o.getMinutes()).slice(-2);return g+t+c});it(this,"formatToYYYYMMDD_HHMM",(i,t=this.DefaultSeparator1,o=this.DefaultSeparator2,g=this.DefaultSeparator3)=>{const c=this.createDate(i);return c?this.formatToYYYYMMDD(c,t)+o+this.formatToHHMM(c,g):""});it(this,"formatToYYYYMMDD_HHMMSS",(i,t=this.DefaultSeparator1,o=this.DefaultSeparator2,g=this.DefaultSeparator3)=>{const c=this.createDate(i);return c?this.formatToYYYYMMDD(c,t)+o+this.formatToHHMMSS(c,g):""})}}const bt=new tn;Date.prototype.truncateDate=function(){return bt.truncateDate(this)};Date.prototype.getCloneOr=function(f){return bt.createDateOr(this,f)};Date.prototype.addDate=function(f){return bt.addDate(this,f)};Date.prototype.addMonth=function(f){return bt.addDate(this,f)};Date.prototype.addYear=function(f){return bt.addDate(this,f)};Date.prototype.getDayOfWeek=function(f="dddd"){return bt.getDayOfWeek(this,f)};Date.prototype.formatToYYYYMM=function(f){return bt.formatToYYYYMM(this,f)};Date.prototype.formatToYYYYMMDD=function(f){return bt.formatToYYYYMMDD(this,f)};Date.prototype.formatToYYYYMMDD_HHMM=function(f,i,t){return bt.formatToYYYYMMDD_HHMM(this,f,i,t)};Date.prototype.formatToYYYYMMDD_HHMMSS=function(f,i,t){return bt.formatToYYYYMMDD_HHMMSS(this,f,i,t)};Date.prototype.formatToHHMM=function(f){return bt.formatToHHMM(this,f)};Date.prototype.formatToHHMMSS=function(f){return bt.formatToHHMMSS(this,f)};var an=l('<li class="deck_info_list_item svelte-2wdgc8"><div class="svelte-2wdgc8"> </div> <div class="svelte-2wdgc8"> </div> <div class="svelte-2wdgc8"> </div></li>'),rn=l('<ul class="deck_info_list svelte-2wdgc8"></ul>'),sn=l('<label for="file_selector" class="upload_area svelte-2wdgc8" role="region" aria-label="ファイルアップロードエリア"><div class="upload_area_message svelte-2wdgc8">ここにファイルをドロップ</div> <div class="upload_area_footer svelte-2wdgc8"><input type="file" id="file_selector" name="file_selector" accept=".json" multiple></div></label>'),nn=l('<div slot="body" class="modal_body svelte-2wdgc8"><!></div>'),ln=l('<button class="svelte-2wdgc8">追加</button> <button class="svelte-2wdgc8">削除して追加</button> <button class="svelte-2wdgc8">戻る</button>',1),on=l('<button class="svelte-2wdgc8">Cancel</button>'),vn=l('<div slot="footer" class="modal_window_footer svelte-2wdgc8"><!></div>');function dn(f,i){dt(i,!1);let t=je(i,"eventHolder",8),o=je(i,"args",8),g=je(i,"resolve",8),c=ne(Promise.resolve([])),u=ne();const v=()=>{$(u,new DataTransfer().files),$(c,Promise.resolve([]))},B=async q=>{q.preventDefault(),console.log("hoge",q)},A=async q=>{q.preventDefault(),q.dataTransfer&&M(q.dataTransfer.files)},S=()=>{M(e(u))},M=async q=>{if(!q.length)return;const R=[],I=[];for(const _ of q)try{I.push(...await Dt.createfromJson(_))}catch(p){p instanceof Error&&R.push(p.message)}if(R.length){console.log(...R);return}$(c,e(c).then(()=>I))},n=v;ct(),mr(f,{get eventHolder(){return t()},get args(){return o()},$$slots:{body:(q,R)=>{var I=nn(),_=a(I);mt(_,()=>oa,null,(p,K)=>{var Z=xe(),we=P(Z);mt(we,()=>e(c),null,(j,U)=>{var ve=xe(),Me=P(ve);{var ge=se=>{var Ee=rn();de(Ee,5,()=>e(U),ce,(ye,Y)=>{var N=an(),fe=a(N),ae=a(fe),Te=s(fe,2),E=a(Te),x=s(Te,2),L=a(x);m((W,ee,w)=>{b(ae,e(Y).name),b(E,`${W??""}
                  /
                  ${ee??""}`),b(L,`最終使用日時 ： ${w??""}`)},[()=>e(Y).cardNames.filter(W=>{var ee,w;return!((w=(ee=e(K).getCardInfo(W))==null?void 0:ee.monsterCategories)!=null&&w.union(aa).length)}).length,()=>e(Y).cardNames.filter(W=>{var ee,w;return(w=(ee=e(K).getCardInfo(W))==null?void 0:ee.monsterCategories)==null?void 0:w.union(aa).length}).length,()=>e(Y).lastUsedAt.formatToYYYYMMDD_HHMM("/"," ",":")],oe),r(ye,N)}),r(se,Ee)},ue=se=>{var Ee=sn(),ye=s(a(Ee),2),Y=a(ye);pr(Y,()=>e(u),N=>$(u,N)),J("change",Y,S),J("cancel",Y,n),J("drop",Ee,A),J("dragover",Ee,B),r(se,Ee)};C(Me,se=>{e(U).length?se(ge):se(ue,!1)})}r(j,ve)}),r(p,Z)}),r(q,I)},footer:(q,R)=>{var I=vn(),_=a(I);mt(_,()=>e(c),null,(p,K)=>{var Z=xe(),we=P(Z);{var j=ve=>{var Me=ln(),ge=P(Me),ue=s(ge,2),se=s(ue,2);m(()=>{ge.disabled=e(K).length===0,ue.disabled=e(K).length===0}),J("click",ge,()=>g()({deckInfos:e(K),replaceAll:!1})),J("click",ue,()=>g()({deckInfos:e(K),replaceAll:!0})),J("click",se,n),r(ve,Me)},U=ve=>{var Me=xe(),ge=P(Me);{var ue=se=>{var Ee=on();J("click",Ee,()=>g()(void 0)),r(se,Ee)};C(ge,se=>{o().cancelable&&se(ue)},!0)}r(ve,Me)};C(we,ve=>{e(K).length?ve(j):ve(U,!1)})}r(p,Z)}),r(q,I)}}}),_t()}const pa=class pa extends yr{constructor(i,t){super(i,...Object.values(t))}};it(pa,"createModalController",i=>{const t={deckUploader:new hr({title:"デッキ情報をアップロード",position:"Middle",cancelable:!1})};return Object.assign(new pa(i,t),t)});let Ca=pa;function cn(f,i){dt(i,!1);let t=je(i,"modalController",8);ct(),gr(f,{get modalController(){return t()},children:(o,g)=>{var c=xe(),u=P(c);{var v=B=>{dn(B,{get eventHolder(){return t().eventHolder},get args(){return t().deckUploader.args},get resolve(){return t().deckUploader.resolve}})};C(u,B=>{t().deckUploader.state==="Shown"&&B(v)})}r(o,c)},$$slots:{default:!0}}),_t()}var _n=l("<button> </button>"),un=l('<label class="svelte-1m129ml"><input type="checkbox" class="search_condition svelte-1m129ml"> </label>'),fn=l('<label class="svelte-1m129ml"><input type="checkbox" class="search_condition svelte-1m129ml"> </label>'),mn=l('<div class="deck_editor_search_box_row monster_ex_categories svelte-1m129ml"><div class="svelte-1m129ml"><button class="search_condition_title black_button svelte-1m129ml">エクストラ</button></div> <div class="svelte-1m129ml"></div></div>'),pn=l('<label class="svelte-1m129ml"><input type="checkbox" class="search_condition svelte-1m129ml"> </label>'),gn=l('<label class="svelte-1m129ml"><input type="checkbox" class="search_condition svelte-1m129ml"> <div style="display: inline-block;"></div> </label>'),yn=l('<label class="svelte-1m129ml"><input type="checkbox" class="search_condition svelte-1m129ml"> </label>'),hn=l('<option class="svelte-1m129ml"></option>'),bn=l('<option class="svelte-1m129ml"></option>'),kn=l('<div class="deck_editor_search_box_row monster_categories svelte-1m129ml"><div class="svelte-1m129ml"><button class="search_condition_title black_button svelte-1m129ml">モンスター</button></div> <div class="svelte-1m129ml"></div></div> <div class="deck_editor_search_box_row monster_attributes svelte-1m129ml"><div class="svelte-1m129ml"><button class="search_condition_title black_button svelte-1m129ml">属性</button></div> <div class="svelte-1m129ml"></div></div> <div class="deck_editor_search_box_row svelte-1m129ml"><div class="svelte-1m129ml"><button class="search_condition_title black_button svelte-1m129ml">種族</button></div> <div class="svelte-1m129ml"></div></div> <div class="deck_editor_search_box_row svelte-1m129ml"><div class="svelte-1m129ml"><button class="search_condition_title black_button svelte-1m129ml">星攻守</button></div> <div class="svelte-1m129ml"><div class="star_range svelte-1m129ml"><span class="svelte-1m129ml">星</span> <select class="svelte-1m129ml"></select> <span class="svelte-1m129ml">～</span> <select class="svelte-1m129ml"></select></div> <div class="atk_range svelte-1m129ml"><span class="svelte-1m129ml">攻</span> <input type="number" min="0" max="5000" step="100" class="svelte-1m129ml"> <span class="svelte-1m129ml">～</span> <input type="number" min="0" max="5000" step="100" class="svelte-1m129ml"></div> <div class="def_range svelte-1m129ml"><span class="svelte-1m129ml">守</span> <input type="number" min="0" max="5000" step="100" class="svelte-1m129ml"> <span class="svelte-1m129ml">～</span> <input type="number" min="0" max="5000" step="100" class="svelte-1m129ml"></div> <div class="atk_plus_def svelte-1m129ml"><span class="svelte-1m129ml">攻+守</span> <input type="number" min="0" max="10000" step="100" class="svelte-1m129ml"></div></div></div>',1),xn=l('<label class="svelte-1m129ml"><input type="checkbox" class="search_condition svelte-1m129ml"> </label>'),wn=l('<div class="deck_editor_search_box_row svelte-1m129ml"><div class="svelte-1m129ml"><button class="search_condition_title black_button svelte-1m129ml">魔法</button></div> <div class="svelte-1m129ml"></div></div>'),Cn=l('<label class="svelte-1m129ml"><input type="checkbox" class="search_condition svelte-1m129ml"> </label>'),Dn=l('<div class="deck_editor_search_box_row svelte-1m129ml"><div class="svelte-1m129ml"><button class="search_condition_title black_button svelte-1m129ml">罠</button></div> <div class="svelte-1m129ml"></div></div>'),$n=l('<label class="svelte-1m129ml"><input type="checkbox" class="search_condition svelte-1m129ml"> </label>'),Sn=l('<div class="deck_editor_card_detail svelte-1m129ml"><!></div>'),Mn=l("<div>カード情報読込中</div>"),Tn=l("<option> </option>"),En=l('<div class="svelte-1m129ml"><a class="white_button svelte-1m129ml" download="SVS_DeckInfos.json">ダウンロード</a></div>'),jn=l('<div class="svelte-1m129ml"></div>'),An=l('<div class="svelte-1m129ml"><a class="white_button svelte-1m129ml" download="SVS_DeckInfos.json">ダウンロード(一括)</a></div>'),Bn=l('<div class="svelte-1m129ml"></div>'),Ln=l('<div class="deck_editor_body_right_header svelte-1m129ml"><div class="deck_editor_body_right_header_row svelte-1m129ml"><div class="svelte-1m129ml">編集対象</div> <div class="svelte-1m129ml"><select style="width:100%" class="svelte-1m129ml"></select></div></div> <div class="deck_editor_body_right_header_row svelte-1m129ml"><div class="svelte-1m129ml">新規名称</div> <div class="svelte-1m129ml"><input type="text" style="width:100%" class="svelte-1m129ml"></div></div> <div class="deck_editor_body_right_header_row svelte-1m129ml"></div> <div class="deck_editor_body_right_header_row svelte-1m129ml"><div class="svelte-1m129ml">基本操作</div> <div class="svelte-1m129ml"><button class="white_button svelte-1m129ml">デッキを保存</button></div> <div class="svelte-1m129ml"><button class="white_button svelte-1m129ml">デッキを複製</button></div> <div class="svelte-1m129ml"><button class="white_button svelte-1m129ml" title="shiftキー押下で確認メッセージスキップ">デッキを削除</button></div></div> <div class="deck_editor_body_right_header_row svelte-1m129ml"><div class="svelte-1m129ml">DL/UL</div> <!> <!> <div class="svelte-1m129ml"><button class="white_button svelte-1m129ml">アップロード</button></div></div></div> <div><!></div>',1),qn=l("<div>デッキ情報読込中</div>"),Yn=l('<div class="deck_editor_body_right_dummy svelte-1m129ml"></div>'),Un=l("<div><!></div>"),Hn=l('<div><div class="deck_editor_header svelte-1m129ml"></div> <div class="deck_editor_body svelte-1m129ml"><div class="deck_editor_body_left svelte-1m129ml"><div role="contentinfo" class="deck_editor_search_box svelte-1m129ml"><div class="deck_editor_search_box_header svelte-1m129ml"><div class="svelte-1m129ml"><button class="deck_editor_search_box_title svelte-1m129ml">検索条件</button></div> <div class="deck_editor_sort_setting_container svelte-1m129ml"></div></div> <div class="deck_editor_search_box_body svelte-1m129ml"><div class="deck_editor_search_box_row svelte-1m129ml"><div class="svelte-1m129ml"><button class="search_condition_title black_button svelte-1m129ml">名称</button></div> <div class="svelte-1m129ml"><input type="text" style="width:100%" placeholder="※ルビには対応していません" class="svelte-1m129ml"></div></div> <div class="deck_editor_search_box_row card_kind svelte-1m129ml"><div class="svelte-1m129ml"><button class="search_condition_title black_button svelte-1m129ml">種類</button></div> <div class="svelte-1m129ml"></div></div> <!> <!> <!> <!> <div class="deck_editor_search_box_row svelte-1m129ml"><div class="svelte-1m129ml"><button class="search_condition_title black_button svelte-1m129ml">その他</button></div> <div class="svelte-1m129ml"></div></div></div></div> <!></div> <div class="deck_editor_body_center svelte-1m129ml"><div class="deck_editor_body_center_body svelte-1m129ml"><!></div></div>  <div class="deck_editor_body_right svelte-1m129ml"><!></div></div> <div class="footer svelte-1m129ml"></div></div> <!> <!>',1);function Pn(f,i){dt(i,!1);const t=[],o=[],g=[],c=[],u=[],v=[],B=[],A=[],S=Ca.createModalController({onDragStart:{append:()=>{},remove:()=>{}},onDragEnd:{append:()=>{},remove:()=>{}}}),M={name:"",deckCardKinds:[...ta],exMonsterCategories:[...aa],monsterCategories:Ua.filter(h=>!aa.includes(h)),monsterAttributes:[...Ya],monsterTypes:[...qa],spellCategories:La.filter(h=>h!=="PendulumScale"),trapCategories:[...Ba],starLowerBound:0,starUpperBound:13,atkLowerBound:0,atkUpperBound:5e3,defLowerBound:0,defUpperBound:5e3,atkPlusDef:void 0,others:["test","oldVersion","implemented"],sort:[...Ha]},n=ne(structuredClone(M));he(n,e(n).others=["oldVersion"]),he(n,e(n).monsterCategories=["Effect","Tuner","Pendulum"]);let q=ne("DeckEdit"),R=ne("SearchCondition");const I=()=>{if(!e(n).deckCardKinds.length){Xt(e(n)).forEach(h=>{Array.isArray(e(n)[h])&&Array.isArray(M[h])?he(n,e(n)[h]=[...M[h]]):he(n,e(n)[h]=M[h])});return}he(n,e(n).name=""),he(n,e(n).deckCardKinds=[]),he(n,e(n).exMonsterCategories=[]),he(n,e(n).monsterCategories=[]),he(n,e(n).monsterAttributes=[]),he(n,e(n).monsterTypes=[]),he(n,e(n).spellCategories=[]),he(n,e(n).trapCategories=[]),he(n,e(n).others=[]),he(n,e(n).atkLowerBound=0),he(n,e(n).atkUpperBound=5e3),he(n,e(n).defLowerBound=0),he(n,e(n).defUpperBound=5e3),he(n,e(n).atkPlusDef=void 0),he(n,e(n).sort=[...Ha])},_=h=>{h.forEach(k=>{Array.isArray(e(n)[k])&&Array.isArray(M[k])?he(n,e(n)[k]=e(n)[k].length?[]:[...M[k]]):he(n,e(n)[k]=M[k])})};let p=ne(),K,Z=ne(!1);const we=200,j=()=>{$(Z,!1),$(p,void 0),K=void 0},U=(h,k)=>{const O=fa(k),Q=e(ae).cardTree[O].filter(He=>He.name===k.name).length;let pe=h.shiftKey?3-Q:1;console.debug(k,O,Q,pe),!h.ctrlKey&&Q>2&&(pe=0),pe&&he(ae,e(ae).cardTree[O]=[...e(ae).cardTree[O],...Array(pe).fill(k)].sort(Ga)),j(),x(k)},ve=(h,k)=>{const O=fa(k);let Q=0;he(ae,e(ae).cardTree[O]=e(ae).cardTree[O].filter(pe=>pe.name!==k.name?!0:(Q++,!h.shiftKey&&Q>1))),j(),x(k)},Me=h=>{if(h.changedTouches&&h.changedTouches.length!==1)return;const{clientX:k,clientY:O}=h.changedTouches?h.changedTouches[0]:h;return{clientX:k,clientY:O}},ge={onCardAppend:U,onCardRemove:ve,onCardDragCancel:j,onCardDragStart:(h,k,O)=>{if(x(O),k!=="List"&&k!=="Deck"){j();return}if(k==="List"&&!O.isImplemented){j();return}const Q=Me(h);if(!Q){j();return}K={from:k,cardInfo:O,pos:Q,startPos:Q},ea(we).then(()=>{(K==null?void 0:K.cardInfo)===O&&$(p,K)}),$(Z,!1)},onCardDragging:(h,k)=>{if(e(p)&&h.preventDefault&&h.preventDefault(),e(p)&&h.stopPropagation&&h.stopPropagation(),!K){j();return}const O=Me(h);if(!O){j();return}const Q=e(p)||K;$(Z,!!(Q.from==="List"&&Q.cardInfo.isImplemented&&document.elementsFromPoint(O.clientX,O.clientY).some(pe=>pe.classList.contains("deck_editor_body_right_body")||pe.classList.contains("deck_editor_body_right_dummy")))),e(Z)&&$(q,"DeckEdit"),e(p)?$(p,{...e(p),pos:O}):K.pos={...O}},onCardDragEnd:h=>{if(!K||!e(p)){j();return}const k=Me(h);if(!k){j();return}e(p).from==="List"&&e(p).cardInfo.isImplemented&&document.elementsFromPoint(k.clientX,k.clientY).some(O=>O.classList.contains("deck_editor_body_right_body"))&&U(h,e(p).cardInfo),e(p).from==="Deck"&&!document.elementsFromPoint(k.clientX,k.clientY).some(O=>O.classList.contains("deck_editor_body_right_body"))&&ve(h,e(p).cardInfo),j()}},ue=(h,k,O)=>{Array.isArray(e(n)[k])&&Array.isArray(M[k])&&he(n,e(n)[k]=[O])},se=async()=>{const k=(await e(Y)).find(Q=>Q.id===e(ye));if(!k)return;const O=await oa;$(ae,{...k,cardTree:kr(k.cardNames.map(Q=>{const pe=O.getCardInfo(Q);return pe===void 0&&console.error(Q),pe}).filter(Q=>Q!==void 0))})},Ee=()=>Dt.getAllDeckInfo().then(h=>($(ye,(h.find(k=>k.lastUsedAt.getTime()===Math.max(...h.map(O=>O.lastUsedAt.getTime())))??h[0]).id),h));let ye=ne(-1),Y=ne(Ee()),N=ne(e(Y).then(h=>Dt.convertToObjectURL(h)));e(Y).then(se);const fe=()=>{$(Y,Ee()),$(N,e(Y).then(h=>Dt.convertToObjectURL(h))),se()};let ae=ne({id:-Number.MAX_VALUE,name:"",description:"",lastUsedAt:new Date,cardTree:{ExtraMonster:[],Monster:[],Spell:[],Trap:[]}}),Te=ne(void 0),E=0;const x=h=>{$(R,"CardDetail"),h.cardId!==void 0&&!h.description&&!h.pendulumDescription&&(E=h.cardId,ka([h.cardId]).then(()=>{h.cardId===E&&$(Te,h)})),$(Te,h)},L=async()=>{const k=(await e(Y)).find(O=>O.id===e(ye));if(!k)throw new Error("illegal state");return k},W=async()=>{const h=await L();await h.saveDeckInfo({...h,name:e(ae).name,cardNames:Object.values(e(ae).cardTree).flatMap(k=>k).map(k=>k.name),lastUsedAt:new Date}),fe()},ee=async()=>{(await Dt.createNewDeck(`デッキ_${new Date().formatToYYYYMMDD_HHMMSS("","","")}`,`コピー日時：${new Date().formatToYYYYMMDD_HHMMSS("-"," ",":")}`,Object.values(e(ae).cardTree).flatMap(k=>k).map(k=>k.name))).saveDeckInfo(),fe()},w=async h=>{const k=await L();!h.shiftKey&&!confirm(`デッキ【${k.name}】を削除します。
よろしいですか？`)||(await k.delete(),fe())},F=async()=>{const h=await S.deckUploader.show({title:"デッキ情報アップロード",position:"Middle",cancelable:!0});if(!h)return;const k=[];if(h.replaceAll){if(!confirm(`既存デッキ情報を全て削除し、アップロードしたファイルに置き換えます。
よろしいですか？`))return;k.push(...(await e(Y)).map(O=>O.id))}await Promise.all(h.deckInfos.map(O=>Dt.createNewDeck(O.name,O.description,O.cardNames,O.lastUsedAt))),k.length&&await Promise.all(k.map(Dt.remove)),fe()},z=()=>innerWidth<=1400?"compact":"wide";ct();var G=Hn(),V=P(G),_e=s(a(V),2),T=a(_e),D=a(T),d=a(D),y=a(d),H=a(y),X=s(y,2);de(X,5,()=>e(n).sort,ce,(h,k,O)=>{var Q=_n(),pe=a(Q);m(()=>{Ae(Q,`deck_editor_sort_setting_item ${e(k).order??""} priority_${e(k).priority??""} svelte-1m129ml`),b(pe,`${br[e(k).key]??""}
                ${(e(k).order==="asc"?"▲":"▼")??""}`)}),J("click",Q,()=>{e(n).sort.forEach(He=>He.priority++),e(k).order=e(k).order==="asc"?"desc":"asc",Et(()=>e(n).sort),e(k).priority=1,Et(()=>e(n).sort)}),r(h,Q)});var Ce=s(d,2),De=a(Ce),me=a(De),ie=a(me),re=s(me,2),te=a(re),$e=s(De,2),Ie=a($e),Fe=a(Ie),Oe=s(Ie,2);de(Oe,5,()=>ta,ce,(h,k)=>{var O=un(),Q=a(O),pe,He=s(Q);m(()=>{pe!==(pe=e(k))&&(Q.value=(Q.__value=e(k))==null?"":e(k)),b(He,` ${Xa[e(k)]??""}`)}),Ft(t,[],Q,()=>(e(k),e(n).deckCardKinds),Se=>he(n,e(n).deckCardKinds=Se)),r(h,O)});var Ye=s($e,2);{var Ge=h=>{var k=mn(),O=a(k),Q=a(O),pe=s(O,2);de(pe,5,()=>aa,ce,(He,Se)=>{var We=fn(),Ke=a(We),Ve,et=s(Ke);m(()=>{Ve!==(Ve=e(Se))&&(Ke.value=(Ke.__value=e(Se))==null?"":e(Se)),b(et,` ${va[e(Se)]??""}${_a[e(Se)]??""}`)}),Ft(o,[],Ke,()=>(e(Se),e(n).exMonsterCategories),ut=>he(n,e(n).exMonsterCategories=ut)),r(He,We)}),J("click",Q,()=>_(["exMonsterCategories"])),le(3,k,()=>ke,()=>({delay:0,duration:100})),r(h,k)};C(Ye,h=>{e(n).deckCardKinds.includes("ExtraMonster")&&h(Ge)})}var nt=s(Ye,2);{var qe=h=>{var k=kn(),O=P(k),Q=a(O),pe=a(Q),He=s(Q,2);de(He,5,()=>Ua.filter(Be=>!aa.includes(Be)),ce,(Be,Pe)=>{var ze=pn(),Ne=a(ze),Ct,Nt=s(Ne);m(()=>{Ct!==(Ct=e(Pe))&&(Ne.value=(Ne.__value=e(Pe))==null?"":e(Pe)),b(Nt,` ${va[e(Pe)]??""}${_a[e(Pe)]??""}`)}),Ft(g,[],Ne,()=>(e(Pe),e(n).monsterCategories),Wt=>he(n,e(n).monsterCategories=Wt)),r(Be,ze)});var Se=s(O,2),We=a(Se),Ke=a(We),Ve=s(We,2);de(Ve,5,()=>Ya,ce,(Be,Pe)=>{var ze=gn(),Ne=a(ze),Ct,Nt=s(Ne,2),Wt=s(Nt);m(()=>{Ct!==(Ct=e(Pe))&&(Ne.value=(Ne.__value=e(Pe))==null?"":e(Pe)),Ae(Nt,`monster_attr ${e(Pe)??""} svelte-1m129ml`),b(Wt,` ${$a[e(Pe)]??""}`)}),Ft(c,[],Ne,()=>(e(Pe),e(n).monsterAttributes),Ja=>he(n,e(n).monsterAttributes=Ja)),r(Be,ze)});var et=s(Se,2),ut=a(et),Ut=a(ut),Tt=s(ut,2);de(Tt,5,()=>qa,ce,(Be,Pe)=>{var ze=yn(),Ne=a(ze),Ct,Nt=s(Ne);m(()=>{Ct!==(Ct=e(Pe))&&(Ne.value=(Ne.__value=e(Pe))==null?"":e(Pe)),b(Nt,` ${ga[e(Pe)]??""}
                    ${Sa[e(Pe)]??""}`)}),Ft(u,[],Ne,()=>(e(Pe),e(n).monsterTypes),Wt=>he(n,e(n).monsterTypes=Wt)),J("dblclick",ze,Wt=>ue(Wt,"monsterTypes",e(Pe))),r(Be,ze)});var wt=s(et,2),gt=a(wt),pt=a(gt),Ht=s(gt,2),At=a(Ht),Pt=s(a(At),2);m(()=>{e(n),Et(()=>{})}),de(Pt,4,()=>Array(14),ce,(Be,Pe,ze)=>{var Ne=hn();Ne.value=(Ne.__value=ze)==null?"":ze,Ne.textContent=ze,r(Be,Ne)});var Kt=s(Pt,4);m(()=>{e(n),Et(()=>{})}),de(Kt,4,()=>Array(14),ce,(Be,Pe,ze)=>{var Ne=bn();Ne.value=(Ne.__value=ze)==null?"":ze,Ne.textContent=ze,r(Be,Ne)});var lt=s(At,2),Qe=s(a(lt),2),ot=s(Qe,4),yt=s(lt,2),ht=s(a(yt),2),Jt=s(ht,4),Je=s(yt,2),st=s(a(Je),2);J("click",pe,()=>_(["monsterCategories"])),le(3,O,()=>ke,()=>({delay:0,duration:100})),J("click",Ke,()=>_(["monsterAttributes"])),le(3,Se,()=>ke,()=>({delay:0,duration:100})),J("click",Ut,()=>_(["monsterTypes"])),le(3,et,()=>ke,()=>({delay:0,duration:100})),J("click",pt,()=>_(["starLowerBound","starUpperBound","atkLowerBound","atkUpperBound","defLowerBound","defUpperBound","atkPlusDef"])),Ot(Pt,()=>e(n).starLowerBound,Be=>he(n,e(n).starLowerBound=Be)),Ot(Kt,()=>e(n).starUpperBound,Be=>he(n,e(n).starUpperBound=Be)),It(Qe,()=>e(n).atkLowerBound,Be=>he(n,e(n).atkLowerBound=Be)),It(ot,()=>e(n).atkUpperBound,Be=>he(n,e(n).atkUpperBound=Be)),It(ht,()=>e(n).defLowerBound,Be=>he(n,e(n).defLowerBound=Be)),It(Jt,()=>e(n).defUpperBound,Be=>he(n,e(n).defUpperBound=Be)),It(st,()=>e(n).atkPlusDef,Be=>he(n,e(n).atkPlusDef=Be)),le(3,wt,()=>ke,()=>({delay:0,duration:100})),r(h,k)};C(nt,h=>{(e(n).deckCardKinds.includes("Monster")||e(n).deckCardKinds.includes("ExtraMonster"))&&h(qe)})}var be=s(nt,2);{var Le=h=>{var k=wn(),O=a(k),Q=a(O),pe=s(O,2);de(pe,5,()=>La.filter(He=>He!=="PendulumScale"),ce,(He,Se)=>{var We=xn(),Ke=a(We),Ve,et=s(Ke);m(()=>{Ve!==(Ve=e(Se))&&(Ke.value=(Ke.__value=e(Se))==null?"":e(Se)),b(et,` ${ya[e(Se)]??""}`)}),Ft(v,[],Ke,()=>(e(Se),e(n).spellCategories),ut=>he(n,e(n).spellCategories=ut)),r(He,We)}),J("click",Q,()=>_(["spellCategories"])),le(3,k,()=>ke,()=>({delay:0,duration:100})),r(h,k)};C(be,h=>{e(n).deckCardKinds.includes("Spell")&&h(Le)})}var Ue=s(be,2);{var Re=h=>{var k=Dn(),O=a(k),Q=a(O),pe=s(O,2);de(pe,5,()=>Ba,ce,(He,Se)=>{var We=Cn(),Ke=a(We),Ve,et=s(Ke);m(()=>{Ve!==(Ve=e(Se))&&(Ke.value=(Ke.__value=e(Se))==null?"":e(Se)),b(et,` ${ha[e(Se)]??""}`)}),Ft(B,[],Ke,()=>(e(Se),e(n).trapCategories),ut=>he(n,e(n).trapCategories=ut)),r(He,We)}),J("click",Q,()=>_(["trapCategories"])),le(3,k,()=>ke,()=>({delay:0,duration:100})),r(h,k)};C(Ue,h=>{e(n).deckCardKinds.includes("Trap")&&h(Re)})}var rt=s(Ue,2),Xe=a(rt),Ze=a(Xe),$t=s(Xe,2);de($t,4,()=>[{key:"test",text:"テスト用カード"},{key:"oldVersion",text:"エラッタ前カード"},{key:"implemented",text:"未実装カード"}],ce,(h,k)=>{var O=$n(),Q=a(O),pe,He=s(Q);m(()=>{pe!==(pe=k.key)&&(Q.value=(Q.__value=k.key)==null?"":k.key),b(He,` ${k.text??""}`)}),Ft(A,[],Q,()=>(k.key,e(n).others),Se=>he(n,e(n).others=Se)),r(h,O)});var vt=s(D,2);{var St=h=>{var k=Sn(),O=a(k);Zi(O,{get cardInfo(){return e(Te)},onAttention:x,cardControlEventHandlers:ge,get deckCardTree(){return e(ae).cardTree}}),r(h,k)};C(vt,h=>{e(R)==="CardDetail"&&e(Te)&&h(St)})}var jt=s(T,2),qt=a(jt),sa=a(qt);mt(sa,()=>oa,h=>{var k=Mn();r(h,k)},(h,k)=>{Ka(h,{mode:"List",get allCardTree(){return e(k).tree},onAttention:x,get searchCondition(){return e(n)},cardControlEventHandlers:ge,get deckCardTree(){return e(ae).cardTree},set deckCardTree(O){he(ae,e(ae).cardTree=O)},$$legacy:!0})});var Yt=s(jt,2),Qt=a(Yt);{var kt=h=>{var k=xe(),O=P(k);mt(O,()=>e(Y),Q=>{var pe=qn();r(Q,pe)},(Q,pe)=>{var He=Ln(),Se=P(He),We=a(Se),Ke=s(a(We),2),Ve=a(Ke);m(()=>{e(ye),Et(()=>{e(pe)})}),de(Ve,5,()=>e(pe),ce,(Je,st)=>{var Be=Tn(),Pe={},ze=a(Be);m(()=>{Pe!==(Pe=e(st).id)&&(Be.value=(Be.__value=e(st).id)==null?"":e(st).id),b(ze,e(st).name)}),r(Je,Be)});var et=s(We,2),ut=s(a(et),2),Ut=a(ut),Tt=s(et,4),wt=s(a(Tt),2),gt=a(wt),pt=s(wt,2),Ht=a(pt),At=s(pt,2),Pt=a(At),Kt=s(Tt,2),lt=s(a(Kt),2);mt(lt,L,Je=>{var st=jn();r(Je,st)},(Je,st)=>{var Be=En(),Pe=a(Be);m(ze=>at(Pe,"href",ze),[()=>Dt.convertToObjectURL([e(st)])],oe),r(Je,Be)});var Qe=s(lt,2);mt(Qe,()=>e(N),Je=>{var st=Bn();r(Je,st)},(Je,st)=>{var Be=An(),Pe=a(Be);m(()=>at(Pe,"href",e(st))),r(Je,Be)});var ot=s(Qe,2),yt=a(ot),ht=s(Se,2),Jt=a(ht);Ka(Jt,{mode:"Deck",allCardTree:{ExtraMonster:[],Monster:[],Spell:[],Trap:[]},onAttention:x,cardControlEventHandlers:ge,get deckCardTree(){return e(ae).cardTree},set deckCardTree(Je){he(ae,e(ae).cardTree=Je)},$$legacy:!0}),m(()=>Ae(ht,`deck_editor_body_right_body ${(e(Z)?"can_drop":"")??""} svelte-1m129ml`)),Ot(Ve,()=>e(ye),Je=>$(ye,Je)),J("change",Ve,se),It(Ut,()=>e(ae).name,Je=>he(ae,e(ae).name=Je)),J("click",gt,W),J("click",Ht,ee),J("click",Pt,w),J("click",yt,F),r(Q,He)}),r(h,k)},Mt=h=>{var k=Yn();r(h,k)};C(Qt,h=>{e(q)==="DeckEdit"||z()==="wide"?h(kt):h(Mt,!1)})}var xt=s(V,2);{var ia=h=>{var k=Un(),O=a(k);Qa(O,{mode:"Dragging",get cardInfo(){return e(p).cardInfo},onAttention:x,cardControlEventHandlers:ge}),m(()=>at(k,"style",`position: fixed;
          top:${e(p).pos.clientY??""}px;
          left:${e(p).pos.clientX??""}px;
          z-index:3; 
          filter: opacity(0.8);
        	transform: translateX(-50%) translateY(-50%);`)),r(h,k)};C(xt,h=>{e(p)&&h(ia)})}var na=s(xt,2);cn(na,{modalController:S}),m((h,k,O)=>Ae(V,`deck_editor
         screen_size_${h??""}
         left_pain_mode_${k??""}
         main_view_mode_${O??""}
         ${(e(p)?"dragging_card":"")??""}
          svelte-1m129ml`),[z,()=>e(R).toLowerCase(),()=>e(q).toLowerCase()],oe),J("click",H,I),J("click",ie,()=>_(["name"])),It(te,()=>e(n).name,h=>he(n,e(n).name=h)),J("click",Fe,()=>_(["deckCardKinds"])),J("click",Ze,()=>_(["others"])),le(3,rt,()=>ke,()=>({delay:0,duration:100})),J("focusin",D,()=>{$(R,"SearchCondition"),$(q,"SearchCondition")}),J("click",D,()=>{$(R,"SearchCondition"),$(q,"SearchCondition")}),J("click",Yt,()=>{$(q,"DeckEdit")}),J("focusin",Yt,()=>{$(q,"DeckEdit")}),J("touchmove",V,h=>e(p)&&ge.onCardDragging(h,"Overlay")),J("mousemove",V,h=>e(p)&&ge.onCardDragging(h,"Overlay")),r(f,G),_t()}const Nn=["TblDeckHeader","TblDeckDetail","TblDuelistProfile"],Fn=3;var In=l('<input class="game_mode_radio svelte-sy4ydn" type="radio" name="game_mode"> <label> </label>',1),On=l('<option class="svelte-sy4ydn"> </option>'),Rn=l('<option class="svelte-sy4ydn"> </option>'),Kn=l('<option class="svelte-sy4ydn"> </option>'),Wn=l('<tr class="config_row svelte-sy4ydn"><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><label for="npc_deck_selector" class="config_row_label deck_selector svelte-sy4ydn">デッキ：</label></div></td><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><select id="npc_deck_selector" class="deck_selector svelte-sy4ydn"><option class="svelte-sy4ydn">デフォルト</option><!></select></div></td></tr>'),zn=l('<option class="svelte-sy4ydn"> </option>'),Vn=l('<tr class="config_row svelte-sy4ydn"><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><label for="npc_selector" class="config_row_label npc_selector svelte-sy4ydn">対戦相手：</label></div></td><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><select id="npc_selector" class="npc_selector svelte-sy4ydn"></select> <div class="svelte-sy4ydn"> </div></div></td></tr> <!> <tr class="config_row svelte-sy4ydn"><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><label for="npc_selector" class="config_row_label npc_selector svelte-sy4ydn">先攻後攻：</label></div></td><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><select id="npc_selector" class="npc_selector svelte-sy4ydn"></select></div></td></tr>',1),Xn=l('<option class="svelte-sy4ydn"> </option>'),Gn=l('<tr class="config_row svelte-sy4ydn"><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><label for="difficulty_selector" class="config_row_label difficulty_selector svelte-sy4ydn">難易度：</label></div></td><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><select id="difficulty_selector" class="difficulty_selector svelte-sy4ydn"></select></div></td></tr>'),Qn=l('<tr class="config_row svelte-sy4ydn"><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><label class="config_row_label svelte-sy4ydn" for="game_mode_radio_preset">ゲームモード：</label></div></td><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"></div></td></tr> <tr class="config_row svelte-sy4ydn"><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><label for="deck_selector" class="config_row_label deck_selector svelte-sy4ydn">デッキ：</label></div></td><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><select id="deck_selector" class="deck_selector svelte-sy4ydn"></select></div></td></tr> <!> <tr><td colspan="2" class="svelte-sy4ydn"><div><button class="btn svelte-sy4ydn">duel start!</button></div></td></tr>',1),Jn=l('<tr><td colspan="2" class="svelte-sy4ydn"><div>デッキ情報の読み込み、もしくは作成中...</div></td></tr>'),Zn=l('<tr><td colspan="2" class="svelte-sy4ydn"><div><button class="btn svelte-sy4ydn">deck edit</button></div></td></tr>'),el=l('<tr class="config_row svelte-sy4ydn"><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><label for="duelist_name" class="config_row_label duelist_name svelte-sy4ydn">名前：</label></div></td><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><input id="duelist_name" class="duelist_name svelte-sy4ydn" type="text"></div></td></tr> <!> <!>',1),tl=l('<tr><td colspan="2" class="svelte-sy4ydn"><div>デュエリスト情報の読み込み、もしくは作成中...</div></td></tr>'),al=l('<div class="app_body svelte-sy4ydn"><table class="config_table svelte-sy4ydn"><tbody><!></tbody></table></div>'),rl=l('<span class="svelte-sy4ydn"> </span> <span class="svelte-sy4ydn"> </span>',1),sl=l('<div class="result_title result_win svelte-sy4ydn">YOU WIN</div>'),il=l('<div class="result_title result_lose svelte-sy4ydn">YOU LOSE</div>'),nl=l('<div class="result_title result_draw svelte-sy4ydn">DRAW</div>'),ll=l('<div class="twitter_share_button_wrapper svelte-sy4ydn"><a rel="nofollow" target="_blank" class="twitter_share_button svelte-sy4ydn">X(twitter)でシェアする</a></div>'),ol=l('<div class="result svelte-sy4ydn"><!> <div class="reason_of_end svelte-sy4ydn"> </div> <!> <div class="svelte-sy4ydn"><button class="white_button svelte-sy4ydn">TOPへ戻る</button></div></div>'),vl=l('<main style="flex-direction: column; display :flex" class="svelte-sy4ydn"><div class="link link_left svelte-sy4ydn"><a href="https://github.com/Setta238/stk_ygo_svelte" target="_blank" rel="noopener noreferrer" title="repository" class="svelte-sy4ydn">repository</a> <a href="https://x.com/ninja_no" target="_blank" rel="noopener noreferrer" title="repository" class="svelte-sy4ydn">X(Twitter)</a> <a href="https://posfie.com/@ninja_no/p/Lx7FLj3" target="_blank" rel="noopener noreferrer" title="posfie" class="svelte-sy4ydn">posfie(toggeter)</a></div> <div class="link link_right svelte-sy4ydn"><a class="a_button svelte-sy4ydn" role="button" tabindex="0">TOPへ戻る</a> <a href="/stk_ygo_svelte/note.html" target="_blank" rel="noopener noreferrer" title="repository" class="svelte-sy4ydn">現時点とこの先のこと</a></div> <!> <div class="footer card_summary svelte-sy4ydn"><!></div> <div class="footer debug_info svelte-sy4ydn"><span class="svelte-sy4ydn"> </span> <span class="user_agent_info svelte-sy4ydn"> </span> <span class="screen_info svelte-sy4ydn"> </span></div> <!></main>');function dl(f,i){dt(i,!1);const t=new xr("stk_ygo_svelte",Fn,Nn);let o=ne(0),g=ne(0),c=ne(),u=ne("FtkChallenge"),v=ne("None"),B=ne(0),A=ne(""),S=ne(void 0);const M="https://setta238.github.io/stk_ygo_svelte/",n="遊戯王deそりてあ",q="ninja_no",R=wr.getOrCreateNew(t).then(T=>($(u,Pa.includes(T.previousGameMode)?T.previousGameMode:"FtkChallenge"),Ee(T.previousNpcId),T)),I=T=>{var d;const D=T.find(y=>y.lastUsedAt.getTime()===Math.max(...T.map(H=>H.lastUsedAt.getTime())))??T[0];$(B,D.id),e(u)==="FtkChallenge"&&D.deckType!=="Preset"&&$(B,((d=zt.find(y=>y.deckType==="Preset"))==null?void 0:d.id)??e(B))};let _=ne(Dt.getAllDeckInfo(t).then(T=>(Promise.all(T.filter(D=>!D.lastUsedAt).map(D=>{D.saveDeckInfo()})),I(T),T)));const p=async()=>{const T=e(B);let D=(await e(_)).find(y=>y.id===T)??(await Z()).find(y=>y.id===T);D&&await D.updateTimestamp();let d=D;if(d||(d=zt.find(y=>y.id===T)),!d)throw new Error("illegal state");return d},K=async()=>{(await R).save({previousGameMode:e(u)})},Z=()=>($(_,Dt.getAllDeckInfo(t).then(T=>(I(T),T))),e(_)),we=async()=>{(await e(_)).length||(await Dt.prepareSampleDeck(),Z())},j=async()=>{await Promise.all([K(),we()]);const T=await p(),D=await R;let d=Zt.find(X=>X.id===Number.MIN_SAFE_INTEGER)??Zt[0],y=zt.find(X=>X.id===Number.MIN_SAFE_INTEGER)??zt[0],H="PlayFirst";e(u)==="FtkChallenge"?d=Zt.filter(X=>X.npcType==="FtkChallenge").find(X=>X.difficulty===D.previousDifficulty)??d:e(u)==="Free"&&(d=Zt.find(X=>X.id===D.previousNpcId)??d,y=zt.slice(-1)[0],H=D.previousStartMode),d.npcType!=="FtkChallenge"&&D.previousNpcDeckId>-1?y=(await e(_)).find(X=>X.id===D.previousNpcDeckId)??y:y=zt.find(X=>X.id===d.id)??y,$(c,new Sr(D,"Player",T,[],d,"NPC",y,[],H)),e(c).onDuelEnd.append(()=>($(c,e(c)),"RemoveMe"))},U=async()=>{await Promise.all([K(),we()]),$(v,"DeckEdit")},ve=async T=>{await K(),T.key==="Enter"&&!T.repeat&&(await R).save()},Me=()=>{$(_,Z()),$(c,void 0),$(v,"None")};let ge=Date.now();const ue=T=>{Date.now()-ge<200||(ge=Date.now(),$(u,T),Z())},se=T=>{Ee(Number(T.currentTarget.value))},Ee=T=>{var D;$(S,Zt.find(d=>d.id===T)),$(A,((D=e(S))==null?void 0:D.description)??"")};we(),ct();var ye=vl(),Y=s(a(ye),2),N=a(Y),fe=s(Y,2);{var ae=T=>{var D=xe(),d=P(D);mt(d,()=>R,null,(y,H)=>{Ci(y,{get duel(){return e(c)},get userProfile(){return e(H)}})}),r(T,D)},Te=T=>{var D=xe(),d=P(D);{var y=X=>{Pn(X,{})},H=X=>{var Ce=al(),De=a(Ce),me=a(De),ie=a(me);mt(ie,()=>R,re=>{var te=tl();r(re,te)},(re,te)=>{var $e=el(),Ie=P($e),Fe=a(Ie),Oe=a(Fe),Ye=s(Fe),Ge=a(Ye),nt=a(Ge),qe=s(Ie,2);mt(qe,()=>e(_),Ue=>{var Re=Jn();r(Ue,Re)},(Ue,Re)=>{var rt=Qn(),Xe=P(rt),Ze=a(Xe),$t=a(Ze),vt=s(Ze),St=a(vt);de(St,5,()=>Pa,ce,(Q,pe)=>{var He=In(),Se=P(He),We=s(Se,2),Ke=a(We);m(Ve=>{at(Se,"id",`game_mode_radio_${Ve??""}`),Dr(Se,e(pe)),$r(Se,e(u)===e(pe)),Ae(We,`game_mode_tab_label game_mode_tab_${Ve??""} svelte-sy4ydn`),at(We,"for",`game_mode_radio_${Ve??""}`),b(Ke,e(pe))},[()=>e(pe).toLowerCase()],oe),J("change",Se,()=>ue(e(pe))),r(Q,He)});var jt=s(Xe,2),qt=a(jt),sa=a(qt),Yt=s(qt),Qt=a(Yt),kt=a(Qt);m(()=>{e(B),Et(()=>{e(u),e(Re)})}),de(kt,5,()=>e(u)==="FtkChallenge"?zt.filter(Q=>Q.deckType==="Preset"):e(Re),ce,(Q,pe)=>{var He=On(),Se={},We=a(He);m(()=>{Se!==(Se=e(pe).id)&&(He.value=(He.__value=e(pe).id)==null?"":e(pe).id),b(We,e(pe).name)}),r(Q,He)});var Mt=s(jt,2);{var xt=Q=>{var pe=Vn(),He=P(pe),Se=a(He),We=a(Se),Ke=s(Se),Ve=a(Ke),et=a(Ve);m(()=>{e(te),Et(()=>{})}),de(et,5,()=>Zt,ce,(lt,Qe)=>{var ot=Rn(),yt={},ht=a(ot);m(()=>{yt!==(yt=e(Qe).id)&&(ot.value=(ot.__value=e(Qe).id)==null?"":e(Qe).id),b(ht,e(Qe).name)}),r(lt,ot)});var ut=s(et,2),Ut=a(ut),Tt=s(He,2);{var wt=lt=>{var Qe=Wn(),ot=a(Qe),yt=a(ot),ht=s(ot),Jt=a(ht),Je=a(Jt);m(()=>{e(te),Et(()=>{e(Re)})});var st=a(Je);st.value=(st.__value=Number.MIN_SAFE_INTEGER)==null?"":Number.MIN_SAFE_INTEGER;var Be=s(st);de(Be,1,()=>e(Re),ce,(Pe,ze)=>{var Ne=Kn(),Ct={},Nt=a(Ne);m(()=>{Ct!==(Ct=e(ze).id)&&(Ne.value=(Ne.__value=e(ze).id)==null?"":e(ze).id),b(Nt,e(ze).name)}),r(Pe,Ne)}),le(3,yt,()=>ke,()=>({duration:200})),le(3,ot,()=>ke,()=>({duration:200})),Ot(Je,()=>e(te).previousNpcDeckId,Pe=>e(te).previousNpcDeckId=Pe),le(3,Jt,()=>ke,()=>({duration:200})),le(3,ht,()=>ke,()=>({duration:200})),le(3,Qe,()=>ke,()=>({duration:200})),r(lt,Qe)};C(Tt,lt=>{var Qe;((Qe=e(S))==null?void 0:Qe.npcType)!=="FtkChallenge"&&lt(wt)})}var gt=s(Tt,2),pt=a(gt),Ht=a(pt),At=s(pt),Pt=a(At),Kt=a(Pt);m(()=>{e(te),Et(()=>{})}),de(Kt,5,()=>Xt(Na),ce,(lt,Qe)=>{var ot=zn(),yt={},ht=a(ot);m(()=>{yt!==(yt=e(Qe))&&(ot.value=(ot.__value=e(Qe))==null?"":e(Qe)),b(ht,Na[e(Qe)])}),r(lt,ot)}),m(()=>b(Ut,`※${e(A)??""}`)),le(3,We,()=>ke,()=>({duration:200})),le(3,Se,()=>ke,()=>({duration:200})),J("change",et,se),Ot(et,()=>e(te).previousNpcId,lt=>e(te).previousNpcId=lt),le(3,Ve,()=>ke,()=>({duration:200})),le(3,Ke,()=>ke,()=>({duration:200})),le(3,He,()=>ke,()=>({duration:200})),le(3,Ht,()=>ke,()=>({duration:200})),le(3,pt,()=>ke,()=>({duration:200})),Ot(Kt,()=>e(te).previousStartMode,lt=>e(te).previousStartMode=lt),le(3,Pt,()=>ke,()=>({duration:200})),le(3,At,()=>ke,()=>({duration:200})),le(3,gt,()=>ke,()=>({duration:200})),r(Q,pe)},ia=Q=>{var pe=xe(),He=P(pe);{var Se=We=>{var Ke=Gn(),Ve=a(Ke),et=a(Ve),ut=s(Ve),Ut=a(ut),Tt=a(Ut);m(()=>{e(te),Et(()=>{})}),de(Tt,5,()=>Mr,ce,(wt,gt)=>{var pt=Xn(),Ht={},At=a(pt);m(()=>{Ht!==(Ht=e(gt))&&(pt.value=(pt.__value=e(gt))==null?"":e(gt)),b(At,e(gt))}),r(wt,pt)}),le(3,et,()=>ke,()=>({duration:200})),le(3,Ve,()=>ke,()=>({duration:200})),Ot(Tt,()=>e(te).previousDifficulty,wt=>e(te).previousDifficulty=wt),le(3,Ut,()=>ke,()=>({duration:200})),le(3,ut,()=>ke,()=>({duration:200})),le(3,Ke,()=>ke,()=>({duration:200})),r(We,Ke)};C(He,We=>{e(u)==="FtkChallenge"&&We(Se)},!0)}r(Q,pe)};C(Mt,Q=>{e(u)==="Free"?Q(xt):Q(ia,!1)})}var na=s(Mt,2),h=a(na),k=a(h),O=a(k);le(3,$t,()=>ke,()=>({duration:200})),le(3,Ze,()=>ke,()=>({duration:200})),le(3,St,()=>ke,()=>({duration:200})),le(3,vt,()=>ke,()=>({duration:200})),le(3,Xe,()=>ke,()=>({duration:200})),le(3,sa,()=>ke,()=>({duration:200})),le(3,qt,()=>ke,()=>({duration:200})),Ot(kt,()=>e(B),Q=>$(B,Q)),le(3,Qt,()=>ke,()=>({duration:200})),le(3,Yt,()=>ke,()=>({duration:200})),le(3,jt,()=>ke,()=>({duration:200})),J("click",O,j),le(3,k,()=>ke,()=>({duration:200})),r(Ue,rt)});var be=s(qe,2);{var Le=Ue=>{var Re=Zn(),rt=a(Re),Xe=a(rt),Ze=a(Xe);J("click",Ze,U),le(3,Xe,()=>ke,()=>({duration:200})),le(3,rt,()=>ke,()=>({duration:200})),le(3,Re,()=>ke,()=>({duration:200})),r(Ue,Re)};C(be,Ue=>{e(u)==="Free"&&Ue(Le)})}le(3,Oe,()=>ke,()=>({duration:200})),le(3,Fe,()=>ke,()=>({duration:200})),It(nt,()=>e(te).name,Ue=>e(te).name=Ue),J("keypress",nt,ve),le(3,Ge,()=>ke,()=>({duration:200})),le(3,Ye,()=>ke,()=>({duration:200})),le(3,Ie,()=>ke,()=>({duration:200})),r(re,$e)}),r(X,Ce)};C(d,X=>{e(v)==="DeckEdit"?X(y):X(H,!1)},!0)}r(T,D)};C(fe,T=>{e(c)?T(ae):T(Te,!1)})}var E=s(fe,2),x=a(E);mt(x,()=>oa,T=>{var D=tt("読み込み中");r(T,D)},(T,D)=>{var d=rl(),y=P(d),H=a(y),X=s(y,2),Ce=a(X);m((De,me,ie)=>{b(H,`公式DB上のカード${De??""}枚`),b(Ce,`実装済カード（効果あり）${me??""}枚 （効果なし）${ie??""}枚`)},[()=>e(D).knmCount.toLocaleString(),()=>e(D).definitionCount.toLocaleString(),()=>e(D).nonDefinitionCount.toLocaleString()],oe),r(T,d)});var L=s(E,2),W=a(L),ee=a(W),w=s(W,2),F=a(w),z=s(w,2),G=a(z),V=s(L,2);{var _e=T=>{var D=ol(),d=a(D);{var y=te=>{var $e=xe(),Ie=P($e);{var Fe=Ye=>{var Ge=sl();r(Ye,Ge)},Oe=Ye=>{var Ge=xe(),nt=P(Ge);{var qe=be=>{var Le=il();r(be,Le)};C(nt,be=>{e(c).winner.seat==="Above"&&be(qe)},!0)}r(Ye,Ge)};C(Ie,Ye=>{e(c).winner.seat==="Below"?Ye(Fe):Ye(Oe,!1)})}r(te,$e)},H=te=>{var $e=nl();r(te,$e)};C(d,te=>{e(c).winner?te(y):te(H,!1)})}var X=s(d,2),Ce=a(X),De=s(X,2);{var me=te=>{var $e=ll(),Ie=a($e);m(()=>at(Ie,"href",`https://x.com/share?url=${M}&text=${e(c).twitterShareText??""}&hashtags=${n}&via=${q}`)),r(te,$e)};C(De,te=>{e(c).twitterShareText&&te(me)})}var ie=s(De,2),re=a(ie);m(()=>b(Ce,e(c).reasonOfEnd)),J("click",re,Me),le(3,D,()=>jr,()=>({delay:200,duration:200})),r(T,D)};C(V,T=>{e(c)&&e(c).isEnded&&T(_e)})}m(()=>{b(ee,"build at: 20260122_200818"),b(F,Cr.text),b(G,`w:${e(o)??""}px h:${e(g)??""}px`)}),ua("innerWidth",T=>$(o,T)),ua("innerHeight",T=>$(g,T)),J("click",N,Me),r(f,ye),_t()}Tr(dl,{target:document.getElementById("app")});
