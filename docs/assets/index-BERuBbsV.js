var Ra=Object.defineProperty;var wa=d=>{throw TypeError(d)};var Ka=(d,i,t)=>i in d?Ra(d,i,{enumerable:!0,configurable:!0,writable:!0,value:t}):d[i]=t;var vt=(d,i,t)=>Ka(d,typeof i!="symbol"?i+"":i,t),Ca=(d,i,t)=>i.has(d)||wa("Cannot "+t);var mt=(d,i,t)=>(Ca(d,i,"read from private field"),t?t.call(d):i.get(d)),Vt=(d,i,t)=>i.has(d)?wa("Cannot add the same private member more than once"):i instanceof WeakSet?i.add(d):i.set(d,t),da=(d,i,t,v)=>(Ca(d,i,"write to private field"),v?v.call(d,t):i.set(d,t),t);import{s as Da,r as Wa,a as $,b as za,l as Va,g as e,d as Fa,p as ht,c as Ve,m as me,i as kt,t as l,e as a,f as h,h as p,j as le,k as Ae,n as wt,o as oe,q as s,u as xt,v as De,D as Ga,w as je,x as Y,y as r,z as ie,A as Ht,B as ae,C as ne,E as m,F as Xa,G as dt,H as sa,I as Qa,J as Ja,K as Pt,L as bt,M as Gt,N as Ha,O as ya,P as ia,Q as ga,R as Xt,S as ea,T as na,U as la,V as Za,W as er,X as tr,Y as ar,Z as rr,_ as sr,$ as ir,a0 as ta,a1 as nr,a2 as lr,a3 as or,a4 as vr,a5 as dr,a6 as At,a7 as ca,a8 as Bt,a9 as _a,aa as cr,ab as _r,ac as ur,ad as $t,ae as fr,af as pr,ag as yr,ah as $a,ai as Sa,aj as Ma,ak as ja,al as Ta,am as Ba,an as Ea,ao as gr,ap as Nt,aq as mr,ar as Ut,as as Mt,at as Wt,au as br,av as hr,aw as Aa,ax as Kt,ay as Ft,az as kr,aA as xr,aB as wr,aC as La,aD as Cr,aE as Dr,aF as $r}from"../chunk/entity_proc_20260110_162955.js";import"../chunk/json_20260110_162955.js";(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const f of document.querySelectorAll('link[rel="modulepreload"]'))v(f);new MutationObserver(f=>{for(const c of f)if(c.type==="childList")for(const _ of c.addedNodes)_.tagName==="LINK"&&_.rel==="modulepreload"&&v(_)}).observe(document,{childList:!0,subtree:!0});function t(f){const c={};return f.integrity&&(c.integrity=f.integrity),f.referrerPolicy&&(c.referrerPolicy=f.referrerPolicy),f.crossOrigin==="use-credentials"?c.credentials="include":f.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function v(f){if(f.ep)return;f.ep=!0;const c=t(f);fetch(f.href,c)}})();const Sr=d=>d;function ma(d){const i=d-1;return i*i*i+1}function Ya(d){const i=typeof d=="string"&&d.match(/^\s*(-?[\d.]+)([^\s]*)\s*$/);return i?[parseFloat(i[1]),i[2]||"px"]:[d,"px"]}function Mr(d,{delay:i=0,duration:t=400,easing:v=Sr}={}){const f=+getComputedStyle(d).opacity;return{delay:i,duration:t,easing:v,css:c=>`opacity: ${c*f}`}}function jr(d,{delay:i=0,duration:t=400,easing:v=ma,x:f=0,y:c=0,opacity:_=0}={}){const o=getComputedStyle(d),U=+o.opacity,I=o.transform==="none"?"":o.transform,M=U*(1-_),[w,n]=Ya(f),[N,Q]=Ya(c);return{delay:i,duration:t,easing:v,css:(R,A)=>`
			transform: ${I} translate(${(1-R)*w}${n}, ${(1-R)*N}${Q});
			opacity: ${U-M*A}`}}function fe(d,{delay:i=0,duration:t=400,easing:v=ma,axis:f="y"}={}){const c=getComputedStyle(d),_=+c.opacity,o=f==="y"?"height":"width",U=parseFloat(c[o]),I=f==="y"?["top","bottom"]:["left","right"],M=I.map(E=>`${E[0].toUpperCase()}${E.slice(1)}`),w=parseFloat(c[`padding${M[0]}`]),n=parseFloat(c[`padding${M[1]}`]),N=parseFloat(c[`margin${M[0]}`]),Q=parseFloat(c[`margin${M[1]}`]),R=parseFloat(c[`border${M[0]}Width`]),A=parseFloat(c[`border${M[1]}Width`]);return{delay:i,duration:t,easing:v,css:E=>`overflow: hidden;opacity: ${Math.min(E*20,1)*_};${o}: ${E*U}px;padding-${I[0]}: ${E*w}px;padding-${I[1]}: ${E*n}px;margin-${I[0]}: ${E*N}px;margin-${I[1]}: ${E*Q}px;border-${I[0]}-width: ${E*R}px;border-${I[1]}-width: ${E*A}px;min-${o}: 0`}}function Ua(d,i){for(const t in i)d[t]=i[t];return d}function Tr({fallback:d,...i}){const t=new Map,v=new Map;function f(_,o,U){const{delay:I=0,duration:M=ve=>Math.sqrt(ve)*30,easing:w=ma}=Ua(Ua({},i),U),n=_.getBoundingClientRect(),N=o.getBoundingClientRect(),Q=n.left-N.left,R=n.top-N.top,A=n.width/N.width,E=n.height/N.height,_e=Math.sqrt(Q*Q+R*R),be=getComputedStyle(o),$e=be.transform==="none"?"":be.transform,pe=+be.opacity;return{delay:I,duration:typeof M=="function"?M(_e):M,easing:w,css:(ve,k)=>`
			   opacity: ${ve*pe};
			   transform-origin: top left;
			   transform: ${$e} translate(${k*Q}px,${k*R}px) scale(${ve+(1-ve)*A}, ${ve+(1-ve)*E});
		   `}}function c(_,o,U){return(I,M)=>(_.set(M.key,I),()=>{if(o.has(M.key)){const w=o.get(M.key);return o.delete(M.key),f(w,I,M)}return _.delete(M.key),d&&d(I,M,U)})}return[c(v,t,!1),c(t,v,!0)]}function Na(d){return Object.prototype.toString.call(d)==="[object Date]"}function Br(d){return d}function ua(d){const i=d-1;return i*i*i+1}function fa(d,i){if(d===i||d!==d)return()=>d;const t=typeof d;if(t!==typeof i||Array.isArray(d)!==Array.isArray(i))throw new Error("Cannot interpolate values of different type");if(Array.isArray(d)){const v=i.map((f,c)=>fa(d[c],f));return f=>v.map(c=>c(f))}if(t==="object"){if(!d||!i)throw new Error("Object cannot be null");if(Na(d)&&Na(i)){const c=d.getTime(),o=i.getTime()-c;return U=>new Date(c+U*o)}const v=Object.keys(i),f={};return v.forEach(c=>{f[c]=fa(d[c],i[c])}),c=>{const _={};return v.forEach(o=>{_[o]=f[o](c)}),_}}if(t==="number"){const v=i-d;return f=>d+f*v}return()=>i}var Et,zt,Qt,Ot;const ba=class ba{constructor(i,t={}){Vt(this,Et,Da(void 0));Vt(this,zt,Da(void 0));Vt(this,Qt);Vt(this,Ot,null);mt(this,Et).v=mt(this,zt).v=i,da(this,Qt,t)}static of(i,t){const v=new ba(i(),t);return Wa(()=>{v.set(i())}),v}set(i,t){var w;$(mt(this,zt),i);let{delay:v=0,duration:f=400,easing:c=Br,interpolate:_=fa}={...mt(this,Qt),...t};if(f===0)return(w=mt(this,Ot))==null||w.abort(),$(mt(this,Et),i),Promise.resolve();const o=za.now()+v;let U,I=!1,M=mt(this,Ot);return da(this,Ot,Va(n=>{if(n<o)return!0;if(!I){I=!0;const Q=mt(this,Et).v;U=_(Q,i),typeof f=="function"&&(f=f(Q,i)),M==null||M.abort()}const N=n-o;return N>f?($(mt(this,Et),i),!1):($(mt(this,Et),U(c(N/f))),!0)})),mt(this,Ot).promise}get current(){return e(mt(this,Et))}get target(){return e(mt(this,zt))}set target(i){this.set(i)}};Et=new WeakMap,zt=new WeakMap,Qt=new WeakMap,Ot=new WeakMap;let aa=ba;var Er=l('<div class="phase_display svelte-1boxe40"><span class="svelte-1boxe40"> </span> </div>'),Ar=l('<div class="lifepoint_display svelte-1boxe40"><div class="svelte-1boxe40"> </div> <div class="svelte-1boxe40"> </div></div>'),Lr=(d,i,t)=>i(e(t)),Yr=l('<div class="svelte-1boxe40"><button class="phase_button svelte-1boxe40"> </button></div>'),Ur=l("<div><!></div>"),Nr=l('<div class="svelte-1boxe40"><!></div>'),Pr=l("<div><!></div>"),qr=l('<div class="config_button_wrapper svelte-1boxe40"><button id="config_button" class="svelte-1boxe40">⚙</button></div>'),Fr=l("<!> <!> <!> <!>",1),Hr=l('<div style="position: absolute;" class="card_animation_receiver svelte-1boxe40"><!></div>'),Or=l('<div style="position: absolute; top:0rem" class="svelte-1boxe40">｛効果対象｝</div>'),Ir=l('<!> <div style="position: absolute; display:flex;justify-content: center;"><!></div>',1),Rr=l(" <!> 】",1),Kr=l('<div style="position: absolute; bottom:0rem" class="svelte-1boxe40"> <!></div>'),Wr=l("<!> <!>",1),zr=l('<div class="badge svelte-1boxe40"> </div>'),Vr=l('<div class="card_animation_receiver svelte-1boxe40"><!></div>'),Gr=l("<!> <!> <!> <!>",1),Xr=l('<td><div role="listitem"><!></div></td>');function Qr(d,i){ht(i,!1);let t=Ve(i,"view",12),v=Ve(i,"row",8),f=Ve(i,"column",8),c=Ve(i,"selectedEntities",28,()=>[]),_=Ve(i,"selectedCells",28,()=>[]),o=me(t().getCell(v(),f())),U=me(new aa(e(o).field.duel.duelists.Above.lp,{duration:400,easing:ua})),I=me(new aa(e(o).field.duel.duelists.Below.lp,{duration:400,easing:ua}));const M=()=>{$(o,t().getCell(v(),f())),De(U,e(U).target=e(o).field.duel.duelists.Above.lp),De(I,e(I).target=e(o).field.duel.duelists.Below.lp)};e(o).onUpdate.append(M),t().onDuelUpdate.append(M),t().modalController.onUpdate.append(M);let w,n=me([]),N=()=>console.log("hoge"),Q,R=me([]),A=me(!1),E=me(!1),_e=!1;const be=x=>{var T,L;$(Z,[]),c().reset(),w=x.activator,N=x.resolve,$(n,x.dummyActionInfos),$(R,x.chainBlockInfos.flatMap(te=>te.selectedEntities).getDistinct()),Q=x.entitiesChoices,$(A,!1),$(E,((T=x.cellsChoices)==null?void 0:T.selectables.includes(e(o)))??!1),_e=e(E)&&((L=x.cellsChoices)==null?void 0:L.qty)===1,M()};t().onWaitStart.append(be);const $e=()=>{w=void 0,$(n,[]),N=()=>{console.log("hoge")},Q=void 0,$(R,[]),$(A,!1),$(E,!1),_e=!1};t().onWaitEnd.append($e);let pe=me(!1),ve=[];const k=x=>{ve=x.filter(T=>T.dests.includes(e(o))),$(pe,ve.length>0),M()},O=()=>{ve=[],$(pe,!1),M()};t().onDragStart.append(k),t().onDragEnd.append(O);const[K,ee]=ni;let Z=me([]);const he=x=>{if(w=void 0,e(o)===x.to||e(o).entities.includes(x.entity)){$(Z,[...e(Z),x]);const T=x.resolve;$(o,e(o)),setTimeout(()=>{$(Z,e(Z).filter(L=>L!==x)),x.count++,x.count>1&&T()},600)}};t().onAnimation.append(he);const B=x=>{N({phaseChange:x})},q=()=>e(o).isStackCell&&e(o).entities.flatMap(x=>x.actions).filter(x=>e(n).map(T=>T.action.seq).some(T=>T===x.seq)).length>0,V=x=>{var T;if(((T=x.target)==null?void 0:T.id)==="config_button"){t(t().infoBoardState="Config",!0),t().requireUpdate();return}if(t(t().infoBoardState="Default",!0),_e)N({selectedCells:[e(o)]});else if(e(E))$(A,!e(A)),_(e(A)?[..._(),e(o)]:_().filter(L=>L!==e(o)));else if(e(o).isStackCell){t(t().infoBoardState="CellInfo",!0),t(t().infoBoardCell=e(o),!0),t().requireUpdate();const L=e(o).entities.flatMap(se=>se.actions).map(se=>se.seq),te=e(n).filter(se=>L.includes(se.action.seq));if(te.length){if(!w)return;t().modalController.actionSelector.show({title:"カードを選択。",position:"Bottom",activator:w,dummyActionInfos:te,cancelable:!0}).then(se=>{se&&N({actionInfo:se})});return}}t().requireUpdate(),console.info(e(o),ue(...e(o).visibleEntities))},de=x=>{x.preventDefault(),x.dataTransfer&&(x.dataTransfer.dropEffect="move")},Se=x=>{x.preventDefault(),console.info("drop",x,e(pe),ve),x.dataTransfer&&(x.dataTransfer.dropEffect="move");try{if(e(pe)&&ve){if(ve.length===1){const T=ve[0];N({actionInfo:{...T,dest:e(o)}})}else if(ve.length>1){if(!w)throw new Ga("想定されない状態");e(o).field.duel.view.modalController.terminateAll(),e(o).field.duel.view.modalController.actionSelector.show({title:"選択",position:"Bottom",activator:w,dummyActionInfos:ve.map(T=>({...T,dest:e(o)})),cancelable:!1}).then(T=>{N({actionInfo:T})})}}}finally{t().removeDraggingActions()}},ue=(...x)=>{if(t().waitMode==="Animation")return"Disabled";if(Q&&Q.selectables.find(L=>x.find(te=>L===te)))return"Selectable";if(!e(n)||e(n).length===0||t().waitMode!=="Free"||Object.values(t().modalController.modals).some(L=>L.state==="Shown"))return"Disabled";const T=e(n).filter(L=>x.includes(L.action.entity));return T.length===0?"Disabled":e(o).isStackCell||T[0].action.entity!==x[0]?"Clickable":T.some(L=>L.dests.length)?"Draggable":"Clickable"};kt();var G=Xr(),S=a(G);S.__click=V;var P=a(S);{var W=x=>{var T=je(),L=Y(T);{var te=se=>{var Me=je(),j=Y(Me);{var C=g=>{var b=Er(),F=a(b),ke=a(F),xe=r(F,1,!0);p((ye,X)=>{m(ke,ye),m(xe,X)},[()=>String(e(o).field.duel.clock.turn).padStart(2,"0"),()=>e(o).field.duel.phase.toUpperCase()],le),s(g,b)},y=g=>{var b=je(),F=Y(b);{var ke=ye=>{var X=Ar(),J=a(X),H=a(J),we=r(J,2),Ne=a(we);p((Ie,Pe)=>{m(H,Ie),m(Ne,Pe)},[()=>Math.floor(e(U).current),()=>Math.floor(e(I).current)],le),s(ye,X)},xe=ye=>{var X=je(),J=Y(X);{var H=we=>{var Ne=je(),Ie=Y(Ne);{var Pe=Ee=>{var Ge=je(),Le=Y(Ge);{var ge=Ce=>{var Ye=je(),qe=Y(Ye);ie(qe,1,()=>t().duel.nextPhaseList,ne,(Je,nt)=>{var Xe=Yr(),Qe=a(Xe);Qe.__click=[Lr,B,nt];var D=a(Qe);p(u=>m(D,u),[()=>e(nt).toUpperCase()],le),s(Je,Xe)}),s(Ce,Ye)};h(Le,Ce=>{t().duel.isEnded||Ce(ge)})}s(Ee,Ge)};h(Ie,Ee=>{t().waitMode==="Free"&&Ee(Pe)})}s(we,Ne)};h(J,we=>{e(o).column===5&&we(H)},!0)}s(ye,X)};h(F,ye=>{e(o).column===3?ye(ke):ye(xe,!1)},!0)}s(g,b)};h(j,g=>{e(o).column===1?g(C):g(y,!1)})}s(se,Me)};h(L,se=>{e(o).row===3&&se(te)})}s(x,T)},re=x=>{var T=je(),L=Y(T);{var te=Me=>{var j=Fr();const C=le(()=>e(Z).find(X=>X.to===e(o)));var y=Y(j);{var g=X=>{var J=Ur(),H=a(J);Ht(H,{get entity(){return e(C).entity},state:"Disabled",dummyActionInfos:[],cardActionResolve:void 0}),p(()=>Ae(J,`card_animation_receiver ${e(o).cellType??""} svelte-1boxe40`)),ae(1,J,()=>ee,()=>({key:e(C).entity.seq})),s(X,J)};h(y,X=>{e(C)&&e(C).index==="Top"&&X(g)})}var b=r(y,2);ie(b,1,()=>e(o).visibleEntities,ne,(X,J)=>{var H=je(),we=Y(H);{var Ne=Ie=>{var Pe=Nr(),Ee=a(Pe);const Ge=le(()=>ue(e(J))),Le=le(()=>e(n).filter(ge=>ge.action.entity===e(J)));Ht(Ee,{get entity(){return e(J)},get state(){return e(Ge)},get dummyActionInfos(){return e(Le)},cardActionResolve:void 0,get selectedList(){return c()},set selectedList(ge){c(ge)},$$legacy:!0}),ae(2,Pe,()=>K,()=>({key:e(J).seq})),s(Ie,Pe)};h(we,Ie=>{e(Z).every(Pe=>Pe.entity.seq!==e(J).seq)&&Ie(Ne)})}s(X,H)});var F=r(b,2);{var ke=X=>{var J=Pr(),H=a(J);Ht(H,{get entity(){return e(C).entity},state:"Disabled",dummyActionInfos:[],cardActionResolve:void 0}),p(()=>Ae(J,`card_animation_receiver ${e(o).cellType??""} svelte-1boxe40`)),ae(1,J,()=>ee,()=>({key:e(C).entity.seq})),s(X,J)};h(F,X=>{e(C)&&e(C).index!=="Top"&&X(ke)})}var xe=r(F,2);{var ye=X=>{var J=qr();s(X,J)};h(xe,X=>{e(o).owner.seat==="Below"&&X(ye)})}s(Me,j)},se=Me=>{var j=Gr();const C=le(()=>e(Z).find(J=>J.to===e(o)));var y=Y(j);{var g=J=>{var H=Hr(),we=a(H);Ht(we,{get entity(){return e(C).entity},state:"Disabled",dummyActionInfos:[],cardActionResolve:void 0}),ae(1,H,()=>ee,()=>({key:e(C).entity.seq})),s(J,H)};h(y,J=>{e(C)&&e(C).index!=="Top"&&J(g)})}var b=r(y,2);{var F=J=>{var H=Wr(),we=Y(H);ie(we,1,()=>e(o).visibleEntities.map((Pe,Ee)=>({index:Ee,entity:Pe})).toReversed(),ne,(Pe,Ee)=>{var Ge=je(),Le=Y(Ge);{var ge=Ce=>{var Ye=Ir();const qe=le(()=>!e(o).isStackCell&&e(Ee).index===0?ue(...e(o).visibleEntities):void 0);var Je=Y(Ye);{var nt=u=>{var z=Or();s(u,z)};h(Je,u=>{e(R).includes(e(Ee).entity)&&u(nt)})}var Xe=r(Je,2),Qe=a(Xe);const D=le(()=>e(Ee).index===0?e(n).filter(u=>e(o).visibleEntities.includes(u.action.entity)):void 0);Ht(Qe,{get entity(){return e(Ee).entity},get state(){return e(qe)},get dummyActionInfos(){return e(D)},cardActionResolve:void 0,get selectedList(){return c()},set selectedList(u){c(u)},$$legacy:!0}),p(()=>Ae(Xe,`duel_card_wrapper ${(e(Ee).entity.exist?"duel_card_wrapper_exists":"")??""} svelte-1boxe40`)),ae(2,Xe,()=>K,()=>({key:e(Ee).entity.seq})),s(Ce,Ye)};h(Le,Ce=>{e(Z).every(Ye=>Ye.entity.seq!==e(Ee).entity.seq)&&Ce(ge)})}s(Pe,Ge)});var Ne=r(we,2);{var Ie=Pe=>{var Ee=Kr(),Ge=a(Ee),Le=r(Ge);ie(Le,1,()=>sa(e(o).visibleEntities[0].status.maxCounterQty),ne,(ge,Ce)=>{var Ye=Rr(),qe=Y(Ye),Je=r(qe);{var nt=Xe=>{var Qe=dt();p(()=>m(Qe,`/${e(o).visibleEntities[0].status.maxCounterQty[e(Ce)]??""}`)),s(Xe,Qe)};h(Je,Xe=>{(e(o).visibleEntities[0].status.maxCounterQty[e(Ce)]??9999)<100&&Xe(nt)})}p((Xe,Qe)=>m(qe,`【
              ${Xe??""}${Qe??""} `),[()=>Xa(e(Ce)),()=>e(o).visibleEntities[0].counterHolder.getQty(e(Ce))],le),s(ge,Ye)}),p(()=>m(Ge,`【${e(o).visibleEntities[0].battlePositionName??""}】 `)),s(Pe,Ee)};h(Ne,Pe=>{e(o).visibleEntities[0].battlePosition&&Pe(Ie)})}s(J,H)};h(b,J=>{e(o).visibleEntities.length>0&&J(F)})}var ke=r(b,2);{var xe=J=>{var H=zr(),we=a(H);p(()=>m(we,e(o).visibleEntities.length)),s(J,H)};h(ke,J=>{e(o).isStackCell&&J(xe)})}var ye=r(ke,2);{var X=J=>{var H=Vr(),we=a(H);Ht(we,{get entity(){return e(C).entity},state:"Disabled",dummyActionInfos:[],cardActionResolve:void 0}),ae(1,H,()=>ee,()=>({key:e(C).entity.seq})),s(J,H)};h(ye,J=>{e(C)&&e(C).index==="Top"&&J(X)})}s(Me,j)};h(L,Me=>{e(o).cellType==="Hand"?Me(te):Me(se,!1)},!0)}s(x,T)};h(P,x=>{e(o).isDisabledCell?x(W):x(re,!1)})}p(x=>{Ae(G,`${`duel_field_cell duel_field_cell_${e(o).cellType} ${e(o).linkArrowSources.length===0?"":"duel_field_cell_linked"}`??""} svelte-1boxe40`),wt(G,"colspan",e(o).cellType==="Hand"?7:1),Ae(S,`${x??""} svelte-1boxe40`)},[()=>`duel_field_cell_inner_box ${e(o).cellType} ${e(pe)?"can_accept_drop":""} ${q()?"can_action":""} ${e(A)?"is_selected":e(E)?"is_selectable":""} `],le),oe("dragover",S,de),oe("drop",S,Se),s(d,G),xt()}Fa(["click"]);const Jr=(d,i,t=void 0,v="!!!circular reference!!!")=>{let f=[];return JSON.stringify(d,(c,_)=>{if(typeof _=="object"){if(f.indexOf(_)>-1)return v;f.push(_)}let o=_;if(i&&(o=i(c,_)),typeof o=="function")return o.toString();if(o!==_&&typeof o=="object"){if(f.indexOf(o)>-1)return v;f.push(o)}return o},t)};var Zr=l('<div class="title svelte-14z6bdh"> </div>'),es=l('<div class="title svelte-14z6bdh"> </div>'),ts=l('<div class="duel_log_chain_number svelte-14z6bdh"> </div>'),as=l('<div><a class="white_button" download="error_info.json">エラー情報ダウンロード</a></div>'),rs=l("<div><!> <!></div>"),ss=l('<div><div style="display: flex;    justify-content: space-between;"><div style=" white-space: nowrap;text-align: center;"> </div> <!></div> <!></div>'),is=l("<div><!> <!></div>"),ns=l("<div><!> <!></div>"),ls=l('<div class="duel_log svelte-14z6bdh"><div class="duel_log_header svelte-14z6bdh"></div> <div class="duel_log_body svelte-14z6bdh"></div> <div class="duel_log_footer svelte-14z6bdh"></div></div>');function os(d,i){ht(i,!1);let t=me(void 0),v=Ve(i,"log",8),f,c=me([]);const _=()=>{const M=((f==null?void 0:f.seq)??-1)+1;v().records.slice(M).forEach(w=>{if(!f){$(c,[[[[w]]]]),f=w;return}if(!e(c)[w.clock.turn]){De(c,e(c)[w.clock.turn]=[[[w]]]),f=w;return}if(!e(c)[w.clock.turn][w.clock.phaseSeq]){De(c,e(c)[w.clock.turn][w.clock.phaseSeq]=[[w]]),f=w;return}if(f.clock.chainSeq===w.clock.chainSeq&&f.clock.chainBlockSeq===w.clock.chainBlockSeq&&f.duelist===w.duelist){e(c)[w.clock.turn][w.clock.phaseSeq].slice(-1)[0].push(w),f=w;return}e(c)[w.clock.turn][w.clock.phaseSeq].push([w]),f=w}),$(c,e(c)),Qa().then(()=>e(t)&&e(t).scroll(0,e(t).clientHeight*990))};v().onUpdate.append(_),v().duel.view.onDuelUpdate.append(_),_(),kt();var o=je(),U=Y(o);{var I=M=>{var w=ls(),n=r(a(w),2);ie(n,5,()=>e(c),ne,(N,Q)=>{var R=ns(),A=a(R);{var E=be=>{var $e=Zr(),pe=a($e);p(()=>m(pe,`ターン：${e(Q)[0][0][0].clock.turn??""}`)),s(be,$e)};h(A,be=>{e(Q)[0][0][0].clock.turn>0&&be(E)})}var _e=r(A,2);ie(_e,1,()=>e(Q),ne,(be,$e)=>{var pe=is(),ve=a(pe);{var k=K=>{var ee=es(),Z=a(ee);p(()=>m(Z,e($e)[0][0].clock.period.name)),s(K,ee)};h(ve,K=>{e($e)[0][0].clock.turn>0&&K(k)})}var O=r(ve,2);ie(O,1,()=>e($e),ne,(K,ee)=>{var Z=ss();const he=le(()=>{var G;return((G=e(ee).find(S=>S.chainNumber!==void 0))==null?void 0:G.chainNumber)??0});var B=a(Z),q=a(B),V=a(q),de=r(q,2);{var Se=G=>{var S=ts(),P=a(S);p(()=>m(P,`チェーン：${e(he)??""}`)),s(G,S)};h(de,G=>{e(he)&&G(Se)})}var ue=r(B,2);ie(ue,1,()=>e(ee),ne,(G,S)=>{var P=rs(),W=a(P);{var re=te=>{var se=dt();p(()=>m(se,e(S).text)),s(te,se)},x=te=>{var se=je(),Me=Y(se);{var j=y=>{var g=dt();p((b,F,ke)=>m(g,`移動：${b??""} ${F??""} ⇒ ${ke??""}`),[()=>{var b;return(b=e(S).mainEntity)==null?void 0:b.toString()},()=>{var b;return(b=e(S).from)==null?void 0:b.toString()},()=>{var b;return(b=e(S).to)==null?void 0:b.toString()}],le),s(y,g)},C=y=>{var g=je(),b=Y(g);{var F=xe=>{var ye=dt();p((X,J)=>m(ye,`生成：${X??""} void ⇒ ${J??""}`),[()=>{var X;return(X=e(S).mainEntity)==null?void 0:X.toString()},()=>{var X;return(X=e(S).to)==null?void 0:X.toString()}],le),s(xe,ye)},ke=xe=>{var ye=je(),X=Y(ye);{var J=we=>{var Ne=dt();p((Ie,Pe)=>m(Ne,`消滅：${Ie??""} ${Pe??""} ⇒ void`),[()=>{var Ie;return(Ie=e(S).mainEntity)==null?void 0:Ie.toString()},()=>{var Ie;return(Ie=e(S).from)==null?void 0:Ie.toString()}],le),s(we,Ne)},H=we=>{var Ne=dt();p(()=>m(Ne,e(S).text)),s(we,Ne)};h(X,we=>{e(S).type==="EntityDisappear"?we(J):we(H,!1)},!0)}s(xe,ye)};h(b,xe=>{e(S).type==="EntityAppear"?xe(F):xe(ke,!1)},!0)}s(y,g)};h(Me,y=>{e(S).type==="EntityMove"?y(j):y(C,!1)},!0)}s(te,se)};h(W,te=>{e(S).type==="ChainBlockHeader"?te(re):te(x,!1)})}var T=r(W,2);{var L=te=>{var se=as(),Me=a(se);p(j=>wt(Me,"href",j),[()=>window.URL.createObjectURL(new Blob([Jr(e(S).error,(j,C)=>["pool","bundles","duel"].includes(j)||typeof C=="function"?void 0:C,4)],{type:"text/plain"}))],le),s(te,se)};h(T,te=>{e(S).error&&te(L)})}p(te=>Ae(P,`duel_log_record duel_log_record_${te??""} svelte-14z6bdh`),[()=>e(S).type.toSnakeCase()],le),s(G,P)}),p(()=>{var G,S,P;Ae(Z,`duel_log_block_duelist duel_log_block_duelist_${((G=e(ee)[0].duelist)==null?void 0:G.seat)??"system"} svelte-14z6bdh`),Ae(q,`duelist ${((S=e(ee)[0].duelist)==null?void 0:S.seat)??""} svelte-14z6bdh`),m(V,((P=e(ee)[0].duelist)==null?void 0:P.profile.name)||"SYSTEM")}),s(K,Z)}),p(()=>Ae(pe,`duel_log_block_phase duel_log_block_phase_${e($e)[0][0].clock.period.key??""} svelte-14z6bdh`)),s(be,pe)}),p(()=>Ae(R,`duel_log_block_turn duel_log_block_turn_${e(Q)[0][0][0].clock.turn??""} svelte-14z6bdh`)),s(N,R)}),Ja(n,N=>$(t,N),()=>e(t)),s(M,w)};h(U,M=>{(v().duel.view.infoBoardState==="Log"||v().duel.view.infoBoardState==="Default")&&M(I)})}s(d,o),xt()}var vs=l("<div><div> </div> <div> </div></div>");function Pa(d,i){ht(i,!1);let t=Ve(i,"duelist",12),v=me(0),f=me();const c=async()=>{const n=t().lp-e(v);if(!e(f)||Math.abs(n)<10){$(v,t().lp),e(f)&&(e(f)(),$(f,void 0));return}$(v,e(v)+Math.floor(Math.random()*n)),await Pt(100),c()},_=()=>{t(t()),!e(f)&&t().lp!==e(v)&&new Promise(n=>{$(f,n),Math.abs(t().lp-e(v)),c()})};t().duel.log.onUpdate.append(_),c(),kt();var o=vs(),U=a(o),I=a(U),M=r(U,2),w=a(M);p(n=>{Ae(o,`duelist duelist_${n??""} svelte-1sy3trd`),Ae(U,`duelist_name duelist_${n??""}_name svelte-1sy3trd`),m(I,t().profile.name),Ae(M,`duelist_lp ${(e(f)?"vibration":"")??""} svelte-1sy3trd`),m(w,e(v))},[()=>t().seat.toLowerCase()],le),s(d,o),xt()}const ds=(d,i,t)=>(i(i()!=="Detail"?"Detail":"Normal"),console.info(t()),!0),cs=(d,i,t)=>(i(i()!=="Debug"?"Debug":"Normal"),console.info(t()),!0);var _s=l('<div class="duel_card_info_row svelte-1uevs9j" style=" justify-content: space-between;"><div class="svelte-1uevs9j"> </div> <div class="svelte-1uevs9j"> </div></div>'),us=l('<div></div> <div class="svelte-1uevs9j"> </div>',1),fs=l("<div> </div>"),ps=l('<span class="svelte-1uevs9j">/</span> <div class="monster_defense svelte-1uevs9j"> </div>',1),ys=l("<div> </div>"),gs=l('<div class="duel_card_info_row svelte-1uevs9j"><!> <!> <div style="flex-grow: 1;" class="svelte-1uevs9j"></div> <div class="monster_attack svelte-1uevs9j"> </div> <!></div> <div class="duel_card_info_row svelte-1uevs9j"></div>',1),ms=l('<div class="duel_card_row svelte-1uevs9j"><div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"> </div></div>'),bs=l('<div class="duel_card_row svelte-1uevs9j"><div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"> </div></div>'),hs=l("<!> <!>",1),ks=l('<pre class="description svelte-1uevs9j"> </pre>'),xs=l('<div class="duel_card_info_row svelte-1uevs9j" style="border-style: solid; border-width: 1px;"><!></div>'),ws=l('<pre class="description svelte-1uevs9j"> </pre>'),Cs=l('<!> <div class="duel_card_info_row svelte-1uevs9j"><!></div>',1),Ds=l('<div class="effect_counter_area_item svelte-1uevs9j"><span class="svelte-1uevs9j"> </span> <span class="svelte-1uevs9j"> </span> <span class="svelte-1uevs9j">/</span> <span class="svelte-1uevs9j"> </span></div>'),$s=l('<div class="duel_card_info_row effect_counter_area svelte-1uevs9j"><div class="effect_counter_area_title svelte-1uevs9j">効果使用状況</div> <div class="effect_counter_area_body svelte-1uevs9j"></div></div>'),Ss=l("[ <!> ],",1),Ms=l('<div class="svelte-1uevs9j"> <!></div>'),js=l('<div class="svelte-1uevs9j"> </div> <!> <div class="svelte-1uevs9j"></div>',1),Ts=l('<div class="svelte-1uevs9j"> </div>'),Bs=l('<div class="svelte-1uevs9j"> </div>'),Es=l('<div class="svelte-1uevs9j"> </div>'),As=l('<div class="svelte-1uevs9j"> </div>'),Ls=l('<div class="svelte-1uevs9j"> </div>'),Ys=l('<div class="svelte-1uevs9j"> </div>'),Us=l('<div class="duel_card_info_row svelte-1uevs9j"><div class="svelte-1uevs9j"><!> <div class="svelte-1uevs9j"></div> <!> <div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"></div> <!> <div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"></div> <!> <div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"></div> <!> <div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"></div> <!> <div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"></div> <!> <div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"> </div> <div class="svelte-1uevs9j"> </div> <div class="svelte-1uevs9j"> </div> <div class="svelte-1uevs9j"></div></div></div>'),Ns=l('<div class="svelte-1uevs9j">※エラッタ前のカードです</div>'),Ps=l('<div class="svelte-1uevs9j">※テスト用カードです</div>'),qs=l('<a target="_blank" rel="noopener noreferrer" title="コナミカードデータベース" class="svelte-1uevs9j"> </a>'),Fs=l('<div class="duel_card_info_links svelte-1uevs9j"><a target="_blank" rel="noopener noreferrer" title="遊戯王カードWiki" class="svelte-1uevs9j">⇒遊戯王カードWiki</a> <!></div>'),Hs=l("<!> <!>",1),Os=l('<div role="contentinfo"><div class="duel_card_info_header svelte-1uevs9j"><div class="duel_card_info_row svelte-1uevs9j"><div class="svelte-1uevs9j"> </div></div> <div class="duel_card_info_row svelte-1uevs9j" style="position:sticky; top:0;"><div class="svelte-1uevs9j"> </div> <div class="svelte-1uevs9j"> </div></div> <!></div> <div class="duel_card_info_body svelte-1uevs9j"><!></div> <div class="duel_card_info_footer svelte-1uevs9j"><!></div></div>');function Is(d,i){ht(i,!1);let t=Ve(i,"entity",8,void 0),v=Ve(i,"mode",12,"Normal");const f=async()=>{if(!t())return;const M=(await Gt).getCardInfo(t().origin.name);if(M)return M.cardId!==void 0&&!M.description&&!M.pendulumDescription&&await Ha([M.cardId]),M},c=()=>t()&&t().entityType==="Card"&&(t().origin.cardId??!1)?`https://www.db.yugioh-card.com/yugiohdb/card_search.action?ope=2&cid=${t().origin.cardId}`:t()?`https://www.db.yugioh-card.com/yugiohdb/card_search.action?ope=1&sess=1&rp=10&mode=&sort=1&keyword=${t().origin.name}&stype=1&ctype=&othercon=2&starfr=&starto=&pscalefr=&pscaleto=&linkmarkerfr=&linkmarkerto=&link_m=2&atkfr=&atkto=&deffr=&defto=&releaseDStart=1&releaseMStart=1&releaseYStart=1999&releaseDEnd=&releaseMEnd=&releaseYEnd=`:"";kt();var _=je(),o=Y(_);{var U=I=>{var M=Os();M.__click=[ds,v,t],M.__contextmenu=[cs,v,t];var w=a(M),n=a(w),N=a(n),Q=a(N),R=r(n,2),A=a(R),E=a(A),_e=r(A,2),be=a(_e),$e=r(R,2);{var pe=B=>{var q=hs(),V=Y(q);{var de=S=>{var P=_s(),W=a(P),re=a(W),x=r(W,2),T=a(x);p(()=>{m(re,`◀ ${t().psL??""}`),m(T,`${t().psR??""} ▶`)}),s(S,P)};h(V,S=>{var P;(P=t().origin.monsterCategories)!=null&&P.includes("Pendulum")&&S(de)})}var Se=r(V,2);{var ue=S=>{var P=gs(),W=Y(P),re=a(W);ie(re,1,()=>t().attr,ne,(j,C)=>{var y=us(),g=Y(y),b=r(g,2),F=a(b);p(()=>{Ae(g,`monster_attr ${e(C)??""} svelte-1uevs9j`),m(F,`${ya[e(C)]??""}属性`)}),s(j,y)});var x=r(re,2);ie(x,1,()=>t().types,ne,(j,C)=>{var y=fs(),g=a(y);p(()=>{Ae(y,`monster_cat ${e(C)??""} svelte-1uevs9j`),m(g,`${ia[e(C)]??""}${ga[e(C)]??""}族`)}),s(j,y)});var T=r(x,4),L=a(T),te=r(T,2);{var se=j=>{var C=ps(),y=r(Y(C),2),g=a(y);p(()=>m(g,t().def??"?")),s(j,C)};h(te,j=>{var C;(C=t().status.monsterCategories)!=null&&C.includes("Link")||j(se)})}var Me=r(W,2);ie(Me,5,()=>t().status.monsterCategories??[],ne,(j,C)=>{var y=ys(),g=a(y);p(()=>{Ae(y,`monster_cat ${e(C)??""} svelte-1uevs9j`),m(g,`${Xt[e(C)]??""}${ea[e(C)]??""}`)}),s(j,y)}),p(()=>m(L,t().atk??"?")),s(S,P)},G=S=>{var P=je(),W=Y(P);{var re=T=>{var L=ms(),te=r(a(L),2),se=a(te);p(()=>m(se,`${na[t().status.spellCategory]??""}魔法`)),s(T,L)},x=T=>{var L=je(),te=Y(L);{var se=Me=>{var j=bs(),C=r(a(j),2),y=a(C);p(()=>m(y,`${la[t().status.trapCategory]??""}罠`)),s(Me,j)};h(te,Me=>{t().kind==="Trap"&&t().status.trapCategory&&Me(se)},!0)}s(T,L)};h(W,T=>{t().kind==="Spell"&&t().status.spellCategory?T(re):T(x,!1)},!0)}s(S,P)};h(Se,S=>{t().kind==="Monster"?S(ue):S(G,!1)})}s(B,q)};h($e,B=>{v()!=="Debug"&&B(pe)})}var ve=r(w,2),k=a(ve);{var O=B=>{var q=Cs(),V=Y(q);{var de=G=>{var S=xs(),P=a(S);bt(P,f,W=>{var re=dt('"読み込み中"');s(W,re)},(W,re)=>{var x=ks(),T=a(x);p(()=>{var L;return m(T,(L=e(re))==null?void 0:L.pendulumDescription)}),s(W,x)}),s(G,S)};h(V,G=>{var S;(S=t().status.monsterCategories)!=null&&S.includes("Pendulum")&&G(de)})}var Se=r(V,2),ue=a(Se);bt(ue,f,G=>{var S=dt('"読み込み中"');s(G,S)},(G,S)=>{var P=ws(),W=a(P);p(()=>{var re;return m(W,(re=e(S))==null?void 0:re.description)}),s(G,P)}),s(B,q)},K=B=>{var q=je(),V=Y(q);{var de=ue=>{var G=je(),S=Y(G);{var P=W=>{var re=$s(),x=r(a(re),2);ie(x,5,()=>t().actions,ne,(T,L)=>{var te=je();const se=le(()=>e(L).actionCountUpperBound),Me=le(()=>e(L).actionCount);var j=Y(te);{var C=y=>{var g=Ds(),b=a(g),F=a(b),ke=r(b,2),xe=a(ke),ye=r(ke,4),X=a(ye);p(()=>{m(F,e(L).title),m(xe,e(Me)),m(X,e(se))}),s(y,g)};h(j,y=>{e(se)!==void 0&&e(Me)!==void 0&&y(C)})}s(T,te)}),s(W,re)};h(S,W=>{t().actions.some(re=>re.actionCountUpperBoundKey)&&W(P)})}s(ue,G)},Se=ue=>{var G=Us(),S=a(G),P=a(S);ie(P,0,()=>["info","status"],ne,(Le,ge)=>{var Ce=js(),Ye=Y(Ce),qe=a(Ye),Je=r(Ye,2);ie(Je,1,()=>Object.entries(t()[ge]),ne,(Xe,Qe)=>{let D=()=>e(Qe)[0],u=()=>e(Qe)[1];var z=Ms(),ce=a(z),Ue=r(ce);{var Re=Ke=>{var Fe=Ss(),We=r(Y(Fe));ie(We,1,u,ne,(He,ze)=>{var ct=dt();p(Lt=>m(ct,`${Lt??""},`),[()=>e(ze).toString()],le),s(He,ct)}),s(Ke,Fe)},Te=Ke=>{var Fe=dt();p(We=>m(Fe,`${We??""},`),[()=>{var We;return(We=u())==null?void 0:We.toString()}],le),s(Ke,Fe)};h(Ue,Ke=>{Array.isArray(u())?Ke(Re):Ke(Te,!1)})}p(()=>m(ce,`"${D()??""}" : `)),s(Xe,z)});var nt=r(Je,2);nt.textContent="},",p(()=>m(qe,`"${ge??""}" :{`)),s(Le,Ce)});var W=r(P,2);W.textContent='"actions" :[';var re=r(W,2);ie(re,1,()=>t().actions,ne,(Le,ge)=>{var Ce=Ts(),Ye=a(Ce);p(()=>m(Ye,`"${e(ge).playType??""} ${e(ge).title??""}",`)),s(Le,Ce)});var x=r(re,2);x.textContent="],";var T=r(x,2);T.textContent='"substituteEffects" :[';var L=r(T,2);ie(L,1,()=>t().substituteEffects,ne,(Le,ge)=>{var Ce=Bs(),Ye=a(Ce);p(()=>m(Ye,`"${e(ge).title??""}",`)),s(Le,Ce)});var te=r(L,2);te.textContent="],";var se=r(te,2);se.textContent='"continuousEffects" :[';var Me=r(se,2);ie(Me,1,()=>t().continuousEffects,ne,(Le,ge)=>{var Ce=Es(),Ye=a(Ce);p(()=>m(Ye,`"${e(ge).isStarted??""}",`)),s(Le,Ce)});var j=r(Me,2);j.textContent="],";var C=r(j,2);C.textContent='"procFilters" :[';var y=r(C,2);ie(y,1,()=>t().procFilterBundle.operators,ne,(Le,ge)=>{var Ce=As(),Ye=a(Ce);p(qe=>m(Ye,`"${qe??""} ${e(ge).title??""} ${e(ge).isEffective??""} ",`),[()=>e(ge).isSpawnedBy.toString()],le),s(Le,Ce)});var g=r(y,2);g.textContent="],";var b=r(g,2);b.textContent='"numericStateOperators" :[';var F=r(b,2);ie(F,1,()=>t().numericOprsBundle.operators,ne,(Le,ge)=>{var Ce=Ls(),Ye=a(Ce);p(qe=>m(Ye,`"${qe??""} ${e(ge).title??""} ${e(ge).isEffective??""} ${e(ge).isContinuous??""} ${e(ge).targetState??""} ${e(ge).targetStateGen??""} ",`),[()=>e(ge).isSpawnedBy.toString()],le),s(Le,Ce)});var ke=r(F,2);ke.textContent="],";var xe=r(ke,2);xe.textContent='"stateOperators" :[';var ye=r(xe,2);ie(ye,1,()=>t().statusOperatorBundle.operators,ne,(Le,ge)=>{var Ce=Ys(),Ye=a(Ce);p(qe=>m(Ye,`"${qe??""} ${e(ge).title??""} ${e(ge).isEffective??""} ",`),[()=>e(ge).isSpawnedBy.toString()],le),s(Le,Ce)});var X=r(ye,2);X.textContent="],";var J=r(X,2);J.textContent='"lastMoveLogRecord" :{';var H=r(J,2),we=a(H),Ne=r(H,2),Ie=a(Ne),Pe=r(Ne,2),Ee=a(Pe),Ge=r(Pe,2);Ge.textContent="},",p((Le,ge)=>{m(we,`"movedBy":"${Le??""}",`),m(Ie,`"movedAs":"${ge??""}",`),m(Ee,`"movedAt":"${t().moveLog.latestRecord.movedAt.totalProcSeq??""}",`)},[()=>{var Le;return(Le=t().moveLog.latestRecord.movedBy)==null?void 0:Le.toString()},()=>t().moveLog.latestRecord.movedAs.join(" ")],le),s(ue,G)};h(V,ue=>{v()==="Detail"?ue(de):ue(Se,!1)},!0)}s(B,q)};h(k,B=>{v()==="Normal"?B(O):B(K,!1)})}var ee=r(ve,2),Z=a(ee);{var he=B=>{var q=Hs(),V=Y(q);{var de=S=>{var P=Ns();s(S,P)};h(V,S=>{t().origin.isOldVersion&&S(de)})}var Se=r(V,2);{var ue=S=>{var P=Ps();s(S,P)},G=S=>{var P=Fs(),W=a(P),re=r(W,2);{var x=T=>{var L=qs(),te=a(L);p(se=>{var Me;wt(L,"href",se),m(te,`⇒${((Me=t())!=null&&Me.origin.cardId?"公式カードページ":"公式で検索")??""}`)},[c],le),s(T,L)};h(re,T=>{t()&&t().entityType==="Card"&&T(x)})}p(()=>wt(W,"href",`https://yugioh-wiki.net/index.php?${t().origin.wikiEncodedName}`)),s(S,P)};h(Se,S=>{t().origin.isForTest?S(ue):S(G,!1)})}s(B,q)};h(Z,B=>{t()&&B(he)})}p((B,q,V)=>{Ae(M,`duel_card duel_card_info ${t().origin.kind??""} ${B??""} svelte-1uevs9j`),m(Q,t().nm),m(E,q),m(be,V)},[()=>{var B;return(B=t().origin.monsterCategories)==null?void 0:B.join(" ")},()=>"★".repeat(t().lvl||0),()=>"☆".repeat(t().rank||0)],le),s(I,M)};h(o,I=>{t()&&I(U)})}s(d,_),xt()}Fa(["click","contextmenu"]);var Rs=l('<div class="duel_field_cell_info_item svelte-1xj7qf1"><!></div>'),Ks=l('<div class="duel_field_cell_info_box svelte-1xj7qf1"><div class="duel_field_cell_info_label svelte-1xj7qf1"> </div> <!></div>'),Ws=l('<div class="duel_field_cell_info svelte-1xj7qf1"><div class="duel_field_cell_info_header item_btn svelte-1xj7qf1"><div class="svelte-1xj7qf1"> </div> <div class="svelte-1xj7qf1"> </div></div> <div class="duel_field_cell_info_body svelte-1xj7qf1"></div></div>');function zs(d,i){ht(i,!1);let t=Ve(i,"cell",12);const v=()=>{t(t())},f=U=>t().cardEntities.filter(I=>I.face===U);t().field.duel.view.onDuelUpdate.append(v),kt();var c=je(),_=Y(c);{var o=U=>{var I=Ws(),M=a(I),w=a(M),n=a(w),N=r(w,2),Q=a(N),R=r(M,2);ie(R,4,()=>["FaceUp","FaceDown"],ne,(A,E)=>{var _e=je(),be=Y(_e);{var $e=pe=>{var ve=Ks(),k=a(ve),O=a(k),K=r(k,2);ie(K,1,()=>f(E).toSorted(Za),ne,(ee,Z)=>{var he=Rs(),B=a(he);const q=le(()=>t().owner===t().field.duel.duelists.Below);Ht(B,{get entity(){return e(Z)},get isVisibleForcibly(){return e(q)},isWideMode:!0,cardActionResolve:void 0}),s(ee,he)}),p(()=>m(O,E==="FaceUp"?"表向き":"裏向き")),s(pe,ve)};h(be,pe=>{f(E).length&&pe($e)})}s(A,_e)}),p(()=>{var A;m(n,(A=t().owner)==null?void 0:A.profile.name),m(Q,t().cellType)}),s(U,I)};h(_,U=>{t().field.duel.view.infoBoardState==="CellInfo"&&U(o)})}s(d,c),xt()}var Vs=l('<div class="duel_config_item svelte-y4u26k"><label class="toggle svelte-y4u26k"><input type="checkbox" class="svelte-y4u26k"></label> <span class="svelte-y4u26k"> </span></div>'),Gs=l('<div class="duel_config svelte-y4u26k"><div class="duel_config_title svelte-y4u26k">デュエル設定</div> <div class="duel_config_group svelte-y4u26k"><div class="duel_config_group_title svelte-y4u26k">チェーン設定</div> <!></div></div>');function Xs(d,i){ht(i,!1);let t=Ve(i,"viewController",8),v=Ve(i,"userProfile",12);kt();var f=je(),c=Y(f);{var _=o=>{var U=Gs(),I=r(a(U),2),M=r(a(I),2);ie(M,1,()=>ar,ne,(w,n)=>{var N=Vs(),Q=a(N),R=a(Q),A=r(Q,2),E=a(A);p(()=>m(E,er[e(n)])),tr(R,()=>v().chainConfig[e(n)],_e=>v(v().chainConfig[e(n)]=_e,!0)),oe("change",R,()=>v().save()),s(w,N)}),s(o,U)};h(c,o=>{t().infoBoardState==="Config"&&o(_)})}s(d,f),xt()}function Qs(d,{from:i,to:t},v={}){var{delay:f=0,duration:c=ve=>Math.sqrt(ve)*120,easing:_=ua}=v,o=getComputedStyle(d),U=o.transform==="none"?"":o.transform,[I,M]=o.transformOrigin.split(" ").map(parseFloat);I/=d.clientWidth,M/=d.clientHeight;var w=Js(d),n=d.clientWidth/t.width/w,N=d.clientHeight/t.height/w,Q=i.left+i.width*I,R=i.top+i.height*M,A=t.left+t.width*I,E=t.top+t.height*M,_e=(Q-A)*n,be=(R-E)*N,$e=i.width/t.width,pe=i.height/t.height;return{delay:f,duration:typeof c=="function"?c(Math.sqrt(_e*_e+be*be)):c,easing:_,css:(ve,k)=>{var O=k*_e,K=k*be,ee=ve+k*$e,Z=ve+k*pe;return`transform: ${U} translate(${O}px, ${K}px) scale(${ee}, ${Z});`}}}function Js(d){if("currentCSSZoom"in d)return d.currentCSSZoom;for(var i=d,t=1;i!==null;)t*=+getComputedStyle(i).zoom,i=i.parentElement;return t}var Zs=l('<div class="chain_number svelte-lqu21u"> </div>'),ei=l('<div class="duel_card_row svelte-lqu21u"> </div>'),ti=l('<div class="appendix svelte-lqu21u"> </div>'),ai=l('<div class="appendix_wrapper svelte-lqu21u"></div>'),ri=l('<div><div><!> <div> </div> <div><!> <div class="duel_card_row svelte-lqu21u"><div> </div> <!></div></div></div></div>'),si=l("<div></div>");function ii(d,i){ht(i,!1);let t=Ve(i,"duel",8),v=Ve(i,"position",8,"left");const f=-100,c=()=>v()==="left"?-100:100;let _=me([]),o=Promise.resolve(),U=Promise.resolve();const I=1e3,M=500,w=400,n=Q=>{const R={...Q};R.isKnown=Q.chainBlockInfo.action.entity.controller.duelistType==="Player"||Q.chainBlockInfo.action.entity.face==="FaceUp",R.chainBlockInfo.onStateChange.append(A=>{if(A==="done"||A==="failed"||A==="negated")return o=o.then(async()=>{const E=new Date().getTime()-R.chainBlockInfo.wasSpawnedAt.getTime();E<I&&await Pt(I-E),$(_,e(_).filter(_e=>_e.seq!==R.seq)),await Pt(M+w)}).then(),"RemoveMe";$(_,e(_))}),U=U.then(async()=>{$(_,[R,...e(_)].sort((A,E)=>rr.isSameChain(A.clock,E.clock)&&A.chainBlockInfo.action.isWithChainBlock&&E.chainBlockInfo.action.isWithChainBlock?E.clock.totalProcSeq-A.clock.totalProcSeq:A.clock.totalProcSeq-E.clock.totalProcSeq)),await Pt(300)}),o=o.then(()=>Pt(1e3))};t().chainBlockLog.onInsert.append(n),kt();var N=si();ie(N,13,()=>e(_),Q=>Q.seq,(Q,R)=>{var A=ri();const E=le(()=>{const{activator:V,action:de,appendix:Se}=e(R).chainBlockInfo;return{activator:V,action:de,appendix:Se}});var _e=a(A),be=a(_e);{var $e=V=>{var de=Zs(),Se=a(de);p(()=>m(Se,`チェーン：${e(R).chainBlockInfo.chainNumber??""}`)),s(V,de)};h(be,V=>{e(R).chainBlockInfo.chainNumber&&V($e)})}var pe=r(be,2),ve=a(pe),k=r(pe,2),O=a(k);{var K=V=>{var de=ei(),Se=a(de);p(()=>m(Se,e(R).isKnown?e(E).action.entity.nm:"？？？")),s(V,de)};h(O,V=>{(e(E).action.entity.entityType==="Card"||e(E).action.entity.entityType==="Token")&&V(K)})}var ee=r(O,2),Z=a(ee),he=a(Z),B=r(Z,2);{var q=V=>{var de=ai();ie(de,5,()=>e(E).appendix,ne,(Se,ue)=>{var G=ti(),S=a(G);p(()=>m(S,e(ue))),s(Se,G)}),s(V,de)};h(B,V=>{e(E).appendix&&V(q)})}p((V,de,Se)=>{Ae(A,`cut_in_row ${(!e(R).chainBlockInfo.chainNumber||e(R).chainBlockInfo.chainNumber===1?"cut_in_row_first":"")??""} svelte-lqu21u`),Ae(_e,`cut_in_item cut_in_item_${V??""} cut_in_item_${e(R).chainBlockInfo.state??""} svelte-lqu21u`),Ae(pe,`duelist_name duelist_${V??""}_name svelte-lqu21u`),m(ve,e(E).activator.profile.name),Ae(k,`duel_card duel_card_${V??""} ${de??""} ${(e(R).isKnown?e(E).action.entity.origin.kind:"")??""} ${e(E).action.entity.entityType??""}  svelte-lqu21u`),m(he,Se)},[()=>e(E).activator.seat.toLowerCase(),()=>e(R).isKnown?(e(E).action.entity.status.monsterCategories??[]).join(" "):"Token",()=>e(E).action.toString()],le),ae(3,_e,()=>jr,()=>new Date().getTime()-e(R).chainBlockInfo.wasSpawnedAt.getTime()<I?{x:c(),duration:w}:{y:f,duration:w}),sr(A,()=>Qs,()=>({duration:M})),s(Q,A)}),p(()=>Ae(N,`cut_in_container cut_in_container_${v()??""} svelte-lqu21u`)),s(d,N),xt()}const ni=Tr({duration:400});var li=l('<div class="duel_desk_left v_flex svelte-1w535im"><!> <!> <!></div>'),oi=l('<button class="duel_field_header_message svelte-1w535im"> </button> <div class="duel_field_header_buttons svelte-1w535im"><button class="svelte-1w535im">サレンダー</button></div>',1),vi=l("<tr></tr>"),di=l('<table class="duel_field svelte-1w535im"><tbody class="svelte-1w535im"></tbody></table>'),ci=l('<button class="svelte-1w535im">OK</button>'),_i=l('<button class="svelte-1w535im">cancel</button>'),ui=l("<!> <!>",1),fi=l('<button class="svelte-1w535im"> </button>'),pi=l('<div style="text-align: left;"><!> <!> <!></div>'),yi=l('<div><!> <div class=" duel_desk_center v_flex svelte-1w535im"><div class="duel_field_header svelte-1w535im"><!></div> <div class="duel_field_body svelte-1w535im"><!></div> <div class="duel_field_footer svelte-1w535im"><!></div></div> <!></div> <div style="position:fixed;bottom:0"> </div> <!> <div><!></div>',1);function gi(d,i){ht(i,!1);let t=Ve(i,"duel",12),v=Ve(i,"userProfile",8),f=me(0),c=me(0),_=me([]),o=me([]),U=()=>{},I=me([]),M=me(),w=me(),n=me(()=>!1),N=me(!1);const Q=y=>{U=y.resolve,$(I,y.dummyActionInfos.filter(g=>g.action.entity.entityType==="Duelist").filter(g=>g.action.entity.controller.seat==="Below")),$(M,void 0),$(w,void 0),$(o,[]),$(_,[]),$(N,!1),y.entitiesChoices&&($(M,y.entitiesChoices),$(n,()=>{var g;return((g=y.entitiesChoices)==null?void 0:g.validator(e(_)))??!1}),$(N,y.entitiesChoices.cancelable),e(M).selectables.every(g=>g.cell.isPlayFieldCell&&g.getIndexInCell()===0||g.cell.cellType==="Hand"&&g.controller.duelistType==="Player"||g.entityType==="Duelist")||t().view.modalController.entitySelector.show({title:t().view.message,position:"Middle",entitiesChoices:y.entitiesChoices,chainBlockInfos:y.chainBlockInfos,cancelable:y.entitiesChoices.cancelable}).then(g=>{U({selectedEntities:g})})),y.cellsChoices&&($(w,y.cellsChoices),$(n,()=>{var g;return((g=y.cellsChoices)==null?void 0:g.validator(e(o)))??!1}),$(N,y.cellsChoices.cancelable))};t().view.onWaitStart.append(Q);const R=()=>{U=()=>{},$(w,void 0),$(M,void 0),$(o,[]),$(_,[]),$(n,()=>!1),$(N,!1)};t().view.onWaitEnd.append(R);let A=me(void 0),E=me("Normal");const _e=({card:y,mode:g})=>{$(A,y),$(E,g??(e(A)===y||e(E)==="Normal"?"Detail":"Normal"))};t().view.onShowCardEntity.append(_e);const be=()=>{t(t())};t().view.onDuelUpdate.append(be),t().log.onUpdate.append(be);const $e=()=>{e(M)&&e(M).validator(e(_))&&U({selectedEntities:e(_)}),e(w)&&e(w).validator(e(o))&&U({selectedCells:e(o)})},pe=()=>{U({})},ve=y=>{U({actionInfo:y})},k=()=>{U({surrender:!0})};t().main();const O=()=>e(f)<=1400?"compact":"wide";kt();var K=yi(),ee=Y(K),Z=a(ee);{var he=y=>{var g=li(),b=a(g);Pa(b,{get duelist(){return t().duelists.Above}});var F=r(b,2);Is(F,{get entity(){return e(A)},get mode(){return e(E)}});var ke=r(F,2);Pa(ke,{get duelist(){return t().duelists.Below}}),s(y,g)};h(Z,y=>{O()==="wide"&&y(he)})}var B=r(Z,2),q=a(B),V=a(q);{var de=y=>{var g=oi(),b=Y(g),F=a(b),ke=r(b,2),xe=a(ke);p(()=>m(F,`[TURN:${t().clock.turn}][PHASE:${t().phase}] ${t().view.message}`)),oe("click",b,()=>{t(t().view.infoBoardState="Log",!0)}),oe("click",xe,k),s(y,g)};h(V,y=>{t().isEnded||y(de)})}var Se=r(q,2),ue=a(Se);{var G=y=>{var g=di(),b=a(g);ie(b,5,()=>t().field.cells,ne,(F,ke,xe)=>{var ye=vi();Ae(ye,`${`duel_desk_row_${xe}`??""} svelte-1w535im`),ie(ye,5,()=>e(ke),ne,(X,J,H)=>{Qr(X,{get view(){return t().view},row:xe,column:H,get selectedEntities(){return e(_)},set selectedEntities(we){$(_,we)},get selectedCells(){return e(o)},set selectedCells(we){$(o,we)},$$legacy:!0})}),s(F,ye)}),s(y,g)};h(ue,y=>{t().clock.turn>0&&y(G)})}var S=r(Se,2),P=a(S);{var W=y=>{var g=ui(),b=Y(g);{var F=ye=>{var X=ci();p(J=>X.disabled=J,[()=>!e(n)()],le),oe("click",X,$e),s(ye,X)};h(b,ye=>{((e(M)&&e(M).qty)??(e(w)&&e(w).qty)??9999)>1&&ye(F)})}var ke=r(b,2);{var xe=ye=>{var X=_i();oe("click",X,pe),s(ye,X)};h(ke,ye=>{e(N)&&ye(xe)})}s(y,g)},re=y=>{var g=je(),b=Y(g);ie(b,1,()=>e(I),ne,(F,ke)=>{var xe=fi(),ye=a(xe);p(()=>m(ye,e(ke).action.title)),oe("click",xe,()=>ve(e(ke))),s(F,xe)}),s(y,g)};h(P,y=>{e(M)&&e(M).selectables.length||e(w)&&e(w).selectables?y(W):y(re,!1)})}var x=r(B,2);{var T=y=>{var g=pi(),b=a(g);os(b,{get log(){return t().log}});var F=r(b,2);zs(F,{get cell(){return t().view.infoBoardCell}});var ke=r(F,2);Xs(ke,{get userProfile(){return v()},get viewController(){return t().view}}),p(xe=>Ae(g,`duel_desk_right duel_desk_right_${xe??""}  svelte-1w535im`),[()=>t().view.infoBoardState.toLowerCase()],le),ae(3,g,()=>fe,()=>({duration:e(f)>1400?0:200,axis:"x"})),s(y,g)};h(x,y=>{(e(f)>1400||t().view.infoBoardState!=="Default")&&y(T)})}var L=r(ee,2),te=a(L),se=r(L,2);ir(se,{get modalController(){return t().view.modalController}});var Me=r(se,2),j=a(Me);const C=le(()=>O()==="wide"?"right":"left");ii(j,{get duel(){return t()},get position(){return e(C)}}),p((y,g)=>{Ae(ee,`flex duel_desk ${y??""}_mode svelte-1w535im`),m(te,g),Ae(Me,`cutin ${y??""}_mode svelte-1w535im`)},[O,()=>t().clock.toFullString()],le),ta("innerWidth",y=>$(f,y)),ta("innerHeight",y=>$(c,y)),s(d,K),xt()}var mi=l('<div class="svelte-niobyr"><button class="button_style_reset svelte-niobyr" title="※shiftキー同時押しで一括外し">クリア</button></div>'),bi=l('<div class="svelte-niobyr"><button class="button_style_reset svelte-niobyr">クリア</button></div>'),hi=l("<div></div>"),ki=l("<!> <!> <!> <!> <!>",1),xi=l('<span> </span> / <span style="display: inline-block;width:2rem;text-align: right;"> </span>',1),wi=l('<li class="deck_editor_item svelte-niobyr"><div role="listitem"><div class="svelte-niobyr"><div class="svelte-niobyr"> </div> <div style="display:flex; flex-wrap: wrap;" class="svelte-niobyr"><div style="text-wrap-mode: nowrap;" class="svelte-niobyr"><!> <!> <!></div> <div style="flex-grow: 1; height:0px; width:0px" class="svelte-niobyr"></div> <div style="text-wrap-mode: nowrap;" class="svelte-niobyr"><!></div></div></div></div> <button class="button_style_reset svelte-niobyr">+</button> <button class="button_style_reset svelte-niobyr">-</button></li>'),Ci=l('<div class="deck_editor_card_kind svelte-niobyr"><div class="deck_editor_card_kind_header svelte-niobyr"><div class="svelte-niobyr"> <!></div> <!></div> <ul class="svelte-niobyr"></ul></div>'),Di=l('<div class="deck_editor_deck_type svelte-niobyr"><div class="deck_editor_deck_type_header svelte-niobyr"><div class="svelte-niobyr"> </div> <!></div> <!></div>'),$i=l('<div class="svelte-niobyr">読み込み中...</div>'),Si=l('<div class="deck_editor_card_list svelte-niobyr"><!></div>');function qa(d,i){ht(i,!1);let t=Ve(i,"allCardInfos",8),v=Ve(i,"deckCardInfos",12),f=Ve(i,"mode",8),c=Ve(i,"onAttention",8),_=Ve(i,"searchCondition",8,void 0);const o=500,U={Deck:["Monster","Spell","Trap"],ExtraDeck:["Monster"]},I={ExtraDeck:{Monster:[],Spell:[],Trap:[]},Deck:{Monster:[],Spell:[],Trap:[]}},M=k=>{var O;return(O=k.monsterCategories)!=null&&O.union(At).length?"ExtraDeck":"Deck"},w=k=>{Object.values(I).forEach(K=>Object.values(K).forEach(ee=>ee.reset())),k.filter(K=>K.kind!=="XyzMaterial").forEach(K=>{var Z;if(K.kind==="XyzMaterial")return;const ee=(Z=K.monsterCategories)!=null&&Z.union(At).length?"ExtraDeck":"Deck";I[ee][K.kind].push(K)});const O=(K,ee)=>{var Z;return ca(K,ee,(Z=_())==null?void 0:Z.sort)};Object.values(I).forEach(K=>Object.values(K).forEach(ee=>ee.sort(O)))},n=f()==="List"?new Promise(k=>{w(t()),k()}):Promise.resolve(),N=()=>(f()==="Deck"&&(w(v()),$(E,v().length)),I),Q=(k,O,K)=>{v(v().filter(ee=>M(ee)!==O||ee.kind!==K&&K))},R=(k,O)=>{try{if(k.ctrlKey){v().push(O);return}const K=v().filter(Z=>Z.name===O.name).length;if(K>2)return;const ee=k.shiftKey?3-K:1;if(ee<1)return;v().push(...Array(ee).fill(O))}finally{v().sort(ca),v(v())}},A=(k,O)=>{let K=0;v(v().filter(ee=>ee.name!==O.name?!0:(K++,!k.shiftKey&&K>1))),v().sort(ca)};let E=me(100);const _e=()=>{$(E,e(E)+10),!(e(E)>=o)&&(e(E)>t().length+v().length||Pt(100).then(_e))};let be=me("");const $e=(k,O,K,ee)=>{var he;if(!_())return!0;if(k.kind==="XyzMaterial")return!1;const Z=k.kind!=="Monster"?k.kind:(he=k.monsterCategories)!=null&&he.union(At).length?"ExtraMonster":"Monster";if(!_().deckCardKinds.includes(Z)||_().name.trim().length&&[k.name,...k.nameTags??[],...k.textTags??[]].every(q=>!q.includes(_().name))||!k.isImplemented&&!_().others.includes("implemented")||k.isForTest&&!_().others.includes("test")||k.isOldVersion&&!_().others.includes("oldVersion"))return!1;if(k.kind==="Monster"){if(k.attributes&&!_().monsterAttributes.union(k.attributes).length||k.types&&!_().monsterTypes.union(k.types).length)return!1;const B=k.level??k.rank??k.link;return Bt(_().starLowerBound)&&(B??0)<_().starLowerBound||Bt(_().starUpperBound)&&(B??0)>_().starUpperBound||Bt(_().atkLowerBound)&&(k.attack??0)<_().atkLowerBound||Bt(_().atkUpperBound)&&(k.attack??0)>_().atkUpperBound||Bt(_().defLowerBound)&&(k.defense??0)<_().defLowerBound||Bt(_().defUpperBound)&&(k.defense??0)>_().defUpperBound||Bt(_().atkPlusDef)&&(!Bt(k.attack)||!Bt(k.defense)||k.attack+k.defense!==_().atkPlusDef)||!k.monsterCategories||Z==="ExtraMonster"&&!k.monsterCategories.union(_().exMonsterCategories).length?!1:k.monsterCategories.union(_().monsterCategories).length}if(k.kind==="Spell")return k.spellCategory&&_().spellCategories.includes(k.spellCategory);if(k.kind==="Trap")return k.trapCategory&&_().trapCategories.includes(k.trapCategory)};nr(()=>(_a(f()),_a(_()),e(be),_a(t()),Pt),()=>{var k;if(f()==="List"){const O=JSON.stringify((k=_())==null?void 0:k.sort);e(be)!==O&&($(be,O),console.log("hoge"),w(t())),$(E,100),Pt(100).then(_e)}}),lr(),kt();var pe=Si(),ve=a(pe);bt(ve,()=>n,k=>{var O=$i();s(k,O)},k=>{var O=je();const K=le(N);var ee=Y(O);ie(ee,1,()=>dr.toReversed(),ne,(Z,he)=>{var B=Di();const q=le(()=>Object.values(e(K)[e(he)]).flatMap(P=>P));var V=a(B),de=a(V),Se=a(de),ue=r(de,2);{var G=P=>{var W=mi(),re=a(W);oe("click",re,x=>Q(x,e(he),void 0)),s(P,W)};h(ue,P=>{f()==="Deck"&&e(q).some($e)&&P(G)})}var S=r(V,2);ie(S,1,()=>sa(e(K)[e(he)]).filter(P=>U[e(he)].includes(P)),ne,(P,W)=>{var re=Ci();const x=le(()=>e(K)[e(he)][e(W)].filter((...g)=>$e(...g,e(W))));var T=a(re),L=a(T),te=a(L),se=r(te);{var Me=g=>{var b=dt();p(F=>m(b,`※表示上限${F??""}枚`),[()=>o.toLocaleString()],le),s(g,b)};h(se,g=>{e(x).length>o&&g(Me)})}var j=r(L,2);{var C=g=>{var b=bi(),F=a(b);oe("click",F,ke=>Q(ke,e(he),e(W))),s(g,b)};h(j,g=>{f()==="Deck"&&e(x).length&&g(C)})}var y=r(T,2);ie(y,5,()=>e(x),ne,(g,b,F)=>{var ke=je(),xe=Y(ke);{var ye=X=>{var J=wi(),H=a(J),we=a(H),Ne=a(we),Ie=a(Ne),Pe=r(Ne,2),Ee=a(Pe),Ge=a(Ee);{var Le=u=>{var z=ki(),ce=Y(z);{var Ue=He=>{var ze=dt();p(()=>m(ze,`★${e(b).level??""}`)),s(He,ze)};h(ce,He=>{e(b).level&&He(Ue)})}var Re=r(ce,2);{var Te=He=>{var ze=dt();p(()=>m(ze,`☆${e(b).rank??""}`)),s(He,ze)};h(Re,He=>{e(b).rank&&He(Te)})}var Ke=r(Re,2);ie(Ke,1,()=>e(b).attributes??[],ne,(He,ze)=>{var ct=hi();p(()=>Ae(ct,`monster_attr ${e(ze)??""} svelte-niobyr`)),s(He,ct)});var Fe=r(Ke,2);ie(Fe,1,()=>e(b).types??[],ne,(He,ze)=>{var ct=dt();p(()=>m(ct,ia[e(ze)])),s(He,ct)});var We=r(Fe,2);ie(We,1,()=>e(b).monsterCategories??[],ne,(He,ze)=>{var ct=dt();p(()=>m(ct,Xt[e(ze)])),s(He,ct)}),s(u,z)};h(Ge,u=>{e(b).kind==="Monster"&&u(Le)})}var ge=r(Ge,2);{var Ce=u=>{var z=dt();p(()=>m(z,`${na[e(b).spellCategory]??""}魔法`)),s(u,z)};h(ge,u=>{e(b).spellCategory&&u(Ce)})}var Ye=r(ge,2);{var qe=u=>{var z=dt();p(()=>m(z,`${la[e(b).trapCategory]??""}罠`)),s(u,z)};h(Ye,u=>{e(b).trapCategory&&u(qe)})}var Je=r(Ee,4),nt=a(Je);{var Xe=u=>{var z=xi(),ce=Y(z),Ue=a(ce),Re=r(ce,2),Te=a(Re);p(()=>{m(Ue,e(b).attack??"?"),m(Te,e(b).defense??"?")}),s(u,z)};h(nt,u=>{e(b).kind==="Monster"&&u(Xe)})}var Qe=r(H,2),D=r(Qe,2);p(u=>{Ae(H,`${u??""} svelte-niobyr`),m(Ie,e(b).name),Qe.disabled=!e(b).isImplemented,wt(Qe,"title",e(b).isImplemented?"※shiftキー同時押しで一括投入":""),D.disabled=!e(b).isImplemented,wt(D,"title",e(b).isImplemented?"※shiftキー同時押しで一括外し":"")},[()=>{var u,z;return`deck_editor_card duel_card ${e(b).kind} ${(z=(u=e(b))==null?void 0:u.monsterCategories)==null?void 0:z.join(" ")} ${e(b).isImplemented?"is_implemented":"is_not_implemented"}`}],le),oe("click",H,()=>c()(e(b))),oe("click",Qe,u=>R(u,e(b))),oe("click",D,u=>A(u,e(b))),s(X,J)};h(xe,X=>{F<e(E)&&X(ye)})}s(g,ke)}),p((g,b)=>m(te,`${or[e(W)]??""}（${g??""} / ${b??""}枚） `),[()=>e(x).length.toLocaleString(),()=>e(K)[e(he)][e(W)].length.toLocaleString()],le),s(P,re)}),p((P,W)=>m(Se,`${vr[e(he)]??""}（${P??""} / ${W??""}枚）`),[()=>e(q).filter($e).length.toLocaleString(),()=>e(q).length.toLocaleString()],le),s(Z,B)}),s(k,O)}),s(d,pe),xt()}var Mi=l('<div class="duel_card_info_row svelte-rccxcp" style="position:sticky; top:0;"><div class="svelte-rccxcp"> </div> <div class="svelte-rccxcp"> </div></div>'),ji=l('<div class="duel_card_info_row svelte-rccxcp"><div class="svelte-rccxcp"><pre class="description svelte-rccxcp"> </pre></div></div> <div class="duel_card_info_row svelte-rccxcp" style=" justify-content: space-between;"><div class="svelte-rccxcp"> </div> <div class="svelte-rccxcp"> </div></div>',1),Ti=l('<div></div> <div class="svelte-rccxcp"> </div>',1),Bi=l("<div> </div>"),Ei=l('<span class="svelte-rccxcp">/</span> <div class="monster_defense svelte-rccxcp"> </div>',1),Ai=l("<div> </div>"),Li=l('<div class="duel_card_info_row svelte-rccxcp"><!> <!> <div style="flex-grow: 1;" class="svelte-rccxcp"></div> <div class="monster_attack svelte-rccxcp"> </div> <!></div> <div class="duel_card_info_row svelte-rccxcp"></div>',1),Yi=l('<div class="duel_card_row svelte-rccxcp"><div class="svelte-rccxcp"></div> <div class="svelte-rccxcp"> </div></div>'),Ui=l('<div class="duel_card_row svelte-rccxcp"><div class="svelte-rccxcp"></div> <div class="svelte-rccxcp"> </div></div>'),Ni=l('<div class="duel_card_info_row svelte-rccxcp"><div class="svelte-rccxcp">※エラッタ前カードです</div></div>'),Pi=l('<div class="duel_card_info_row svelte-rccxcp"><div class="svelte-rccxcp">※テスト用カードです</div></div>'),qi=l('<div class="duel_card_info_links svelte-rccxcp"><a target="_blank" rel="noopener noreferrer" title="遊戯王カードWiki" class="svelte-rccxcp">⇒遊戯王カードWiki</a> <a target="_blank" rel="noopener noreferrer" title="コナミカードデータベース" class="svelte-rccxcp"> </a></div>'),Fi=l('<div><div class="duel_card_info_header svelte-rccxcp"><div class="duel_card_info_row svelte-rccxcp"><div class="svelte-rccxcp"> </div></div> <!></div> <div class="duel_card_info_body svelte-rccxcp"><!> <!> <div class="duel_card_info_row description svelte-rccxcp"><div class="svelte-rccxcp"><pre class="description svelte-rccxcp"> </pre></div></div> <!> <!></div></div>');function Hi(d,i){ht(i,!1);let t=Ve(i,"cardInfo",8,void 0);kt();var v=je(),f=Y(v);{var c=_=>{var o=Fi(),U=a(o),I=a(U),M=a(I),w=a(M),n=r(I,2);{var N=B=>{var q=Mi(),V=a(q),de=a(V),Se=r(V,2),ue=a(Se);p((G,S)=>{m(de,G),m(ue,S)},[()=>"★".repeat(t().level||0),()=>"☆".repeat(t().rank||0)],le),s(B,q)};h(n,B=>{t().kind==="Monster"&&B(N)})}var Q=r(U,2),R=a(Q);{var A=B=>{var q=ji(),V=Y(q),de=a(V),Se=a(de),ue=a(Se),G=r(V,2),S=a(G),P=a(S),W=r(S,2),re=a(W);p(()=>{m(ue,t().pendulumDescription),m(P,`◀ ${t().pendulumScaleL??""}`),m(re,`${t().pendulumScaleR??""} ▶`)}),s(B,q)};h(R,B=>{var q;(q=t().monsterCategories)!=null&&q.includes("Pendulum")&&B(A)})}var E=r(R,2);{var _e=B=>{var q=Li(),V=Y(q),de=a(V);{var Se=T=>{var L=Ti(),te=Y(L),se=r(te,2),Me=a(se);p(()=>{Ae(te,`monster_attr ${t().attributes[0]??""} svelte-rccxcp`),m(Me,`${ya[t().attributes[0]]??""}属性`)}),s(T,L)};h(de,T=>{t().attributes&&T(Se)})}var ue=r(de,2);{var G=T=>{var L=Bi(),te=a(L);p(()=>{Ae(L,`monster_cat ${t().types[0]??""} svelte-rccxcp`),m(te,`${ia[t().types[0]]??""}${ga[t().types[0]]??""}族`)}),s(T,L)};h(ue,T=>{t().types&&T(G)})}var S=r(ue,4),P=a(S),W=r(S,2);{var re=T=>{var L=Ei(),te=r(Y(L),2),se=a(te);p(()=>m(se,t().defense??"?")),s(T,L)};h(W,T=>{var L;(L=t().monsterCategories)!=null&&L.includes("Link")||T(re)})}var x=r(V,2);ie(x,5,()=>t().monsterCategories??[],ne,(T,L)=>{var te=Ai(),se=a(te);p(()=>{Ae(te,`monster_cat ${e(L)??""} svelte-rccxcp`),m(se,`${Xt[e(L)]??""}${ea[e(L)]??""}`)}),s(T,te)}),p(()=>m(P,t().attack??"?")),s(B,q)},be=B=>{var q=je(),V=Y(q);{var de=ue=>{var G=Yi(),S=r(a(G),2),P=a(S);p(()=>m(P,`${na[t().spellCategory]??""}魔法`)),s(ue,G)},Se=ue=>{var G=je(),S=Y(G);{var P=W=>{var re=Ui(),x=r(a(re),2),T=a(x);p(()=>m(T,`${la[t().trapCategory]??""}罠`)),s(W,re)};h(S,W=>{t().kind==="Trap"&&t().trapCategory&&W(P)},!0)}s(ue,G)};h(V,ue=>{t().kind==="Spell"&&t().spellCategory?ue(de):ue(Se,!1)},!0)}s(B,q)};h(E,B=>{t().kind==="Monster"?B(_e):B(be,!1)})}var $e=r(E,2),pe=a($e),ve=a(pe),k=a(ve),O=r($e,2);{var K=B=>{var q=Ni();s(B,q)};h(O,B=>{t().isOldVersion&&B(K)})}var ee=r(O,2);{var Z=B=>{var q=Pi();s(B,q)},he=B=>{var q=qi(),V=a(q),de=r(V,2),Se=a(de);p(ue=>{wt(V,"href",`https://yugioh-wiki.net/index.php?${t().wikiEncodedName}`),wt(de,"href",ue),m(Se,`⇒${(t().cardId?"公式カードページ":"公式で検索")??""}`)},[()=>cr(t())],le),s(B,q)};h(ee,B=>{t().isForTest?B(Z):B(he,!1)})}p(B=>{Ae(o,`duel_card duel_card_info ${t().kind??""} ${B??""} svelte-rccxcp`),m(w,t().name),m(k,t().description)},[()=>{var B;return(B=t().monsterCategories)==null?void 0:B.join(" ")}],le),s(_,o)};h(f,_=>{t()&&_(c)})}s(d,v),xt()}const Oi={0:{aaa:"日",aaaa:"日曜日",ddd:"Sun",dddd:"Sunday"},1:{aaa:"月",aaaa:"月曜日",ddd:"Mon",dddd:"Monday"},2:{aaa:"火",aaaa:"火曜日",ddd:"Tue",dddd:"Tuesday"},3:{aaa:"水",aaaa:"水曜日",ddd:"Wed",dddd:"Wednesday"},4:{aaa:"木",aaaa:"木曜日",ddd:"Thu",dddd:"Thursday"},5:{aaa:"金",aaaa:"金曜日",ddd:"Fri",dddd:"Friday"},6:{aaa:"土",aaaa:"土曜日",ddd:"Sat",dddd:"Saturday"}};class Ii{constructor(){vt(this,"DefaultSeparator1","/");vt(this,"DefaultSeparator2"," ");vt(this,"DefaultSeparator3",":");vt(this,"createDate",i=>{if(!i)return;const t=new Date(i);if(!isNaN(t.getTime()))return t});vt(this,"createDateOr",(i,t)=>this.createDate(i)||t||new Date);vt(this,"truncateDate",i=>{const t=i||new Date;return new Date(t.getFullYear(),t.getMonth(),t.getDate())});vt(this,"addDate",(i,t)=>{const v=this.createDateOr(i);return v.setDate(v.getDate()+t),v});vt(this,"addMonth",(i,t)=>{const v=this.createDateOr(i);return v.setMonth(v.getMonth()+t),v});vt(this,"addYear",(i,t)=>{const v=this.createDateOr(i);return v.setFullYear(v.getFullYear()+t),v});vt(this,"getDayOfWeek",(i,t="dddd")=>{const v=this.createDate(i);return v?Oi[v.getDay()][t]:""});vt(this,"formatToYYYYMMDD",(i,t=this.DefaultSeparator1)=>{const v=this.createDate(i);if(!v)return"";const f=v.getFullYear().toString(),c=("0"+(v.getMonth()+1)).slice(-2),_=("0"+v.getDate()).slice(-2);return f+t+c+t+_});vt(this,"formatToYYYYMM",(i,t=this.DefaultSeparator1)=>{const v=this.createDate(i);if(!v)return"";t||(t="");const f=v.getFullYear().toString(),c=("0"+(v.getMonth()+1)).slice(-2);return f+t+c});vt(this,"formatToHHMMSS",(i,t=this.DefaultSeparator3)=>{const v=this.createDate(i);if(!v)return"";t||(t="");const f=v.getHours(),c=v.getMinutes(),_=v.getSeconds();return("0"+f).slice(-2)+t+("0"+c).slice(-2)+t+("0"+_).slice(-2)});vt(this,"formatToHHMM",(i,t=this.DefaultSeparator3)=>{const v=this.createDate(i);if(!v)return"";t||(t="");const f=("0"+v.getHours()).slice(-2),c=("0"+v.getMinutes()).slice(-2);return f+t+c});vt(this,"formatToYYYYMMDD_HHMM",(i,t=this.DefaultSeparator1,v=this.DefaultSeparator2,f=this.DefaultSeparator3)=>{const c=this.createDate(i);return c?this.formatToYYYYMMDD(c,t)+v+this.formatToHHMM(c,f):""});vt(this,"formatToYYYYMMDD_HHMMSS",(i,t=this.DefaultSeparator1,v=this.DefaultSeparator2,f=this.DefaultSeparator3)=>{const c=this.createDate(i);return c?this.formatToYYYYMMDD(c,t)+v+this.formatToHHMMSS(c,f):""})}}const Ct=new Ii;Date.prototype.truncateDate=function(){return Ct.truncateDate(this)};Date.prototype.getCloneOr=function(d){return Ct.createDateOr(this,d)};Date.prototype.addDate=function(d){return Ct.addDate(this,d)};Date.prototype.addMonth=function(d){return Ct.addDate(this,d)};Date.prototype.addYear=function(d){return Ct.addDate(this,d)};Date.prototype.getDayOfWeek=function(d="dddd"){return Ct.getDayOfWeek(this,d)};Date.prototype.formatToYYYYMM=function(d){return Ct.formatToYYYYMM(this,d)};Date.prototype.formatToYYYYMMDD=function(d){return Ct.formatToYYYYMMDD(this,d)};Date.prototype.formatToYYYYMMDD_HHMM=function(d,i,t){return Ct.formatToYYYYMMDD_HHMM(this,d,i,t)};Date.prototype.formatToYYYYMMDD_HHMMSS=function(d,i,t){return Ct.formatToYYYYMMDD_HHMMSS(this,d,i,t)};Date.prototype.formatToHHMM=function(d){return Ct.formatToHHMM(this,d)};Date.prototype.formatToHHMMSS=function(d){return Ct.formatToHHMMSS(this,d)};var Ri=l('<li class="deck_info_list_item svelte-2wdgc8"><div class="svelte-2wdgc8"> </div> <div class="svelte-2wdgc8"> </div> <div class="svelte-2wdgc8"> </div></li>'),Ki=l('<ul class="deck_info_list svelte-2wdgc8"></ul>'),Wi=l('<label for="file_selector" class="upload_area svelte-2wdgc8" role="region" aria-label="ファイルアップロードエリア"><div class="upload_area_message svelte-2wdgc8">ここにファイルをドロップ</div> <div class="upload_area_footer svelte-2wdgc8"><input type="file" id="file_selector" name="file_selector" accept=".json" multiple></div></label>'),zi=l('<div slot="body" class="modal_body svelte-2wdgc8"><!></div>'),Vi=l('<button class="svelte-2wdgc8">追加</button> <button class="svelte-2wdgc8">削除して追加</button> <button class="svelte-2wdgc8">戻る</button>',1),Gi=l('<button class="svelte-2wdgc8">Cancel</button>'),Xi=l('<div slot="footer" class="modal_window_footer svelte-2wdgc8"><!></div>');function Qi(d,i){ht(i,!1);let t=Ve(i,"eventHolder",8),v=Ve(i,"args",8),f=Ve(i,"resolve",8),c=me(Promise.resolve([])),_=me();const o=()=>{$(_,new DataTransfer().files),$(c,Promise.resolve([]))},U=async N=>{N.preventDefault(),console.log("hoge",N)},I=async N=>{N.preventDefault(),N.dataTransfer&&w(N.dataTransfer.files)},M=()=>{w(e(_))},w=async N=>{if(!N.length)return;const Q=[],R=[];for(const A of N)try{R.push(...await $t.createfromJson(A))}catch(E){E instanceof Error&&Q.push(E.message)}if(Q.length){console.log(...Q);return}$(c,e(c).then(()=>R))},n=o;kt(),_r(d,{get eventHolder(){return t()},get args(){return v()},$$slots:{body:(N,Q)=>{var R=zi(),A=a(R);bt(A,()=>Gt,null,(E,_e)=>{var be=je(),$e=Y(be);bt($e,()=>e(c),null,(pe,ve)=>{var k=je(),O=Y(k);{var K=Z=>{var he=Ki();ie(he,5,()=>e(ve),ne,(B,q)=>{var V=Ri(),de=a(V),Se=a(de),ue=r(de,2),G=a(ue),S=r(ue,2),P=a(S);p((W,re,x)=>{m(Se,e(q).name),m(G,`${W??""}
                  /
                  ${re??""}`),m(P,`最終使用日時 ： ${x??""}`)},[()=>e(q).cardNames.filter(W=>{var re,x;return!((x=(re=e(_e).getCardInfo(W))==null?void 0:re.monsterCategories)!=null&&x.union(At).length)}).length,()=>e(q).cardNames.filter(W=>{var re,x;return(x=(re=e(_e).getCardInfo(W))==null?void 0:re.monsterCategories)==null?void 0:x.union(At).length}).length,()=>e(q).lastUsedAt.formatToYYYYMMDD_HHMM("/"," ",":")],le),s(B,V)}),s(Z,he)},ee=Z=>{var he=Wi(),B=r(a(he),2),q=a(B);ur(q,()=>e(_),V=>$(_,V)),oe("change",q,M),oe("cancel",q,n),oe("drop",he,I),oe("dragover",he,U),s(Z,he)};h(O,Z=>{e(ve).length?Z(K):Z(ee,!1)})}s(pe,k)}),s(E,be)}),s(N,R)},footer:(N,Q)=>{var R=Xi(),A=a(R);bt(A,()=>e(c),null,(E,_e)=>{var be=je(),$e=Y(be);{var pe=k=>{var O=Vi(),K=Y(O),ee=r(K,2),Z=r(ee,2);p(()=>{K.disabled=e(_e).length===0,ee.disabled=e(_e).length===0}),oe("click",K,()=>f()({deckInfos:e(_e),replaceAll:!1})),oe("click",ee,()=>f()({deckInfos:e(_e),replaceAll:!0})),oe("click",Z,n),s(k,O)},ve=k=>{var O=je(),K=Y(O);{var ee=Z=>{var he=Gi();oe("click",he,()=>f()(void 0)),s(Z,he)};h(K,Z=>{v().cancelable&&Z(ee)},!0)}s(k,O)};h($e,k=>{e(_e).length?k(pe):k(ve,!1)})}s(E,be)}),s(N,R)}}}),xt()}const ra=class ra extends pr{constructor(i,t){super(i,...Object.values(t))}};vt(ra,"createModalController",i=>{const t={deckUploader:new yr({title:"デッキ情報をアップロード",position:"Middle",cancelable:!1})};return Object.assign(new ra(i,t),t)});let pa=ra;function Ji(d,i){ht(i,!1);let t=Ve(i,"modalController",8);kt(),fr(d,{get modalController(){return t()},children:(v,f)=>{var c=je(),_=Y(c);{var o=U=>{Qi(U,{get eventHolder(){return t().eventHolder},get args(){return t().deckUploader.args},get resolve(){return t().deckUploader.resolve}})};h(_,U=>{t().deckUploader.state==="Shown"&&U(o)})}s(v,c)},$$slots:{default:!0}}),xt()}var Zi=l("<button> </button>"),en=l('<label class="svelte-n46fl7"><input type="checkbox" class="search_condition svelte-n46fl7"> </label>'),tn=l('<label class="svelte-n46fl7"><input type="checkbox" class="search_condition svelte-n46fl7"> </label>'),an=l('<div class="deck_editor_search_box_row monster_ex_categories svelte-n46fl7"><div class="svelte-n46fl7"><button class="search_condition_title black_button svelte-n46fl7">エクストラ</button></div> <div class="svelte-n46fl7"></div></div>'),rn=l('<label class="svelte-n46fl7"><input type="checkbox" class="search_condition svelte-n46fl7"> </label>'),sn=l('<label class="svelte-n46fl7"><input type="checkbox" class="search_condition svelte-n46fl7"> <div style="display: inline-block;"></div> </label>'),nn=l('<label class="svelte-n46fl7"><input type="checkbox" class="search_condition svelte-n46fl7"> </label>'),ln=l('<div class="deck_editor_search_box_row monster_categories svelte-n46fl7"><div class="svelte-n46fl7"><button class="search_condition_title black_button svelte-n46fl7">モンスター</button></div> <div class="svelte-n46fl7"></div></div> <div class="deck_editor_search_box_row monster_attributes svelte-n46fl7"><div class="svelte-n46fl7"><button class="search_condition_title black_button svelte-n46fl7">属性</button></div> <div class="svelte-n46fl7"></div></div> <div class="deck_editor_search_box_row svelte-n46fl7"><div class="svelte-n46fl7"><button class="search_condition_title black_button svelte-n46fl7">種族</button></div> <div class="svelte-n46fl7"></div></div> <div class="deck_editor_search_box_row svelte-n46fl7"><div class="svelte-n46fl7"><button class="search_condition_title black_button svelte-n46fl7">星攻守</button></div> <div class="svelte-n46fl7"><div class="star_range svelte-n46fl7"><span class="svelte-n46fl7">星</span> <input type="number" min="0" max="13" class="svelte-n46fl7"> <span class="svelte-n46fl7">～</span> <input type="number" min="0" max="13" class="svelte-n46fl7"></div> <div class="atk_range svelte-n46fl7"><span class="svelte-n46fl7">攻</span> <input type="number" min="0" max="5000" step="100" class="svelte-n46fl7"> <span class="svelte-n46fl7">～</span> <input type="number" min="0" max="5000" step="100" class="svelte-n46fl7"></div> <div class="def_range svelte-n46fl7"><span class="svelte-n46fl7">守</span> <input type="number" min="0" max="5000" step="100" class="svelte-n46fl7"> <span class="svelte-n46fl7">～</span> <input type="number" min="0" max="5000" step="100" class="svelte-n46fl7"></div> <div class="atk_plus_def svelte-n46fl7"><span class="svelte-n46fl7">攻+守</span> <input type="number" min="0" max="10000" step="100" class="svelte-n46fl7"></div></div></div>',1),on=l('<label class="svelte-n46fl7"><input type="checkbox" class="search_condition svelte-n46fl7"> </label>'),vn=l('<div class="deck_editor_search_box_row svelte-n46fl7"><div class="svelte-n46fl7"><button class="search_condition_title black_button svelte-n46fl7">魔法</button></div> <div class="svelte-n46fl7"></div></div>'),dn=l('<label class="svelte-n46fl7"><input type="checkbox" class="search_condition svelte-n46fl7"> </label>'),cn=l('<div class="deck_editor_search_box_row svelte-n46fl7"><div class="svelte-n46fl7"><button class="search_condition_title black_button svelte-n46fl7">罠</button></div> <div class="svelte-n46fl7"></div></div>'),_n=l('<label class="svelte-n46fl7"><input type="checkbox" class="search_condition svelte-n46fl7"> </label>'),un=l("<div>カード情報読込中</div>"),fn=l("<option> </option>"),pn=l('<div class="svelte-n46fl7"><a class="white_button svelte-n46fl7" download="SVS_DeckInfos.json">ダウンロード</a></div>'),yn=l('<div class="svelte-n46fl7"></div>'),gn=l('<div class="svelte-n46fl7"><a class="white_button svelte-n46fl7" download="SVS_DeckInfos.json">ダウンロード(一括)</a></div>'),mn=l('<div class="svelte-n46fl7"></div>'),bn=l('<div class="deck_editor_body_right_header svelte-n46fl7"><div class="deck_editor_body_right_header_row svelte-n46fl7"><div class="svelte-n46fl7">編集対象</div> <div class="svelte-n46fl7"><select style="width:100%" class="svelte-n46fl7"></select></div></div> <div class="deck_editor_body_right_header_row svelte-n46fl7"><div class="svelte-n46fl7">新規名称</div> <div class="svelte-n46fl7"><input type="text" style="width:100%" class="svelte-n46fl7"></div></div> <div class="deck_editor_body_right_header_row svelte-n46fl7"></div> <div class="deck_editor_body_right_header_row svelte-n46fl7"><div class="svelte-n46fl7">基本操作</div> <div class="svelte-n46fl7"><button class="white_button svelte-n46fl7">デッキを保存</button></div> <div class="svelte-n46fl7"><button class="white_button svelte-n46fl7">デッキを複製</button></div> <div class="svelte-n46fl7"><button class="white_button svelte-n46fl7" title="shiftキー押下で確認メッセージスキップ">デッキを削除</button></div></div> <div class="deck_editor_body_right_header_row svelte-n46fl7"><div class="svelte-n46fl7">DL/UL</div> <!> <!> <div class="svelte-n46fl7"><button class="white_button svelte-n46fl7">アップロード</button></div></div></div> <!>',1),hn=l('<div class="svelte-n46fl7">デッキ情報読込中</div>'),kn=l('<div class="svelte-n46fl7"></div>'),xn=l('<div><div class="deck_editor_header svelte-n46fl7"></div> <div class="deck_editor_body svelte-n46fl7"><div class="deck_editor_body_left svelte-n46fl7"><div role="contentinfo" class="deck_editor_search_box svelte-n46fl7"><div class="deck_editor_search_box_header svelte-n46fl7"><div class="svelte-n46fl7"><button class="deck_editor_search_box_title svelte-n46fl7">検索条件</button></div> <div class="deck_editor_sort_setting_container svelte-n46fl7"></div></div> <div class="deck_editor_search_box_body svelte-n46fl7"><div class="deck_editor_search_box_row svelte-n46fl7"><div class="svelte-n46fl7"><button class="search_condition_title black_button svelte-n46fl7">名称</button></div> <div class="svelte-n46fl7"><input type="text" style="width:100%" placeholder="※ルビには対応していません" class="svelte-n46fl7"></div></div> <div class="deck_editor_search_box_row card_kind svelte-n46fl7"><div class="svelte-n46fl7"><button class="search_condition_title black_button svelte-n46fl7">種類</button></div> <div class="svelte-n46fl7"></div></div> <!> <!> <!> <!> <div class="deck_editor_search_box_row svelte-n46fl7"><div class="svelte-n46fl7"><button class="search_condition_title black_button svelte-n46fl7">その他</button></div> <div class="svelte-n46fl7"></div></div></div></div> <!></div> <div class="deck_editor_body_center svelte-n46fl7"><!></div>  <div class="deck_editor_body_right svelte-n46fl7"><!></div></div> <div class="footer svelte-n46fl7"></div></div> <!>',1);function wn(d,i){ht(i,!1);const t=[],v=[],f=[],c=[],_=[],o=[],U=[],I=[],M=pa.createModalController({onDragStart:{append:()=>{},remove:()=>{}},onDragEnd:{append:()=>{},remove:()=>{}}}),w={name:"",deckCardKinds:[...Ea],exMonsterCategories:[...At],monsterCategories:Ta.filter(D=>!At.includes(D)),monsterAttributes:[...ja],monsterTypes:[...Ma],spellCategories:Sa.filter(D=>D!=="PendulumScale"),trapCategories:[...$a],starLowerBound:0,starUpperBound:13,atkLowerBound:0,atkUpperBound:5e3,defLowerBound:0,defUpperBound:5e3,atkPlusDef:void 0,others:["test","oldVersion","implemented"],sort:[...Ba]},n=me(structuredClone(w));De(n,e(n).others=["oldVersion"]);let N=me("DeckEdit"),Q=me("SearchCondition");const R=()=>{if(!e(n).deckCardKinds.length){sa(e(n)).forEach(D=>{Array.isArray(e(n)[D])&&Array.isArray(w[D])?De(n,e(n)[D]=[...w[D]]):De(n,e(n)[D]=w[D])});return}De(n,e(n).name=""),De(n,e(n).deckCardKinds=[]),De(n,e(n).exMonsterCategories=[]),De(n,e(n).monsterCategories=[]),De(n,e(n).monsterAttributes=[]),De(n,e(n).monsterTypes=[]),De(n,e(n).spellCategories=[]),De(n,e(n).trapCategories=[]),De(n,e(n).others=[]),De(n,e(n).atkLowerBound=0),De(n,e(n).atkUpperBound=5e3),De(n,e(n).defLowerBound=0),De(n,e(n).defUpperBound=5e3),De(n,e(n).atkPlusDef=void 0),De(n,e(n).sort=[...Ba])},A=D=>{D.forEach(u=>{Array.isArray(e(n)[u])&&Array.isArray(w[u])?De(n,e(n)[u]=e(n)[u].length?[]:[...w[u]]):De(n,e(n)[u]=w[u])})},E=(D,u,z)=>{Array.isArray(e(n)[u])&&Array.isArray(w[u])&&De(n,e(n)[u]=[z])},_e=async()=>{const u=(await e(pe)).find(ce=>ce.id===e($e));if(!u)return;const z=await Gt;$(O,{...u,cardInfos:u.cardNames.map(ce=>{const Ue=z.getCardInfo(ce);return Ue===void 0&&console.error(ce),Ue}).filter(ce=>ce!==void 0)})},be=()=>$t.getAllDeckInfo().then(D=>($($e,(D.find(u=>u.lastUsedAt.getTime()===Math.max(...D.map(z=>z.lastUsedAt.getTime())))??D[0]).id),D));let $e=me(-1),pe=me(be()),ve=me(e(pe).then(D=>$t.convertToObjectURL(D)));e(pe).then(_e);const k=()=>{$(pe,be()),$(ve,e(pe).then(D=>$t.convertToObjectURL(D))),_e()};let O=me({id:-Number.MAX_VALUE,name:"",description:"",lastUsedAt:new Date,cardInfos:[]}),K=me(void 0),ee=0;const Z=D=>{$(Q,"CardDetail"),D.cardId!==void 0&&!D.description&&!D.pendulumDescription&&(ee=D.cardId,Ha([D.cardId]).then(()=>{D.cardId===ee&&$(K,D)})),$(K,D)},he=async()=>{const u=(await e(pe)).find(z=>z.id===e($e));if(!u)throw new Error("illegal state");return u},B=async()=>{const D=await he();await D.saveDeckInfo({...D,name:e(O).name,cardNames:e(O).cardInfos.map(u=>u.name),lastUsedAt:new Date}),k()},q=async()=>{(await $t.createNewDeck(`デッキ_${new Date().formatToYYYYMMDD_HHMMSS("","","")}`,`コピー日時：${new Date().formatToYYYYMMDD_HHMMSS("-"," ",":")}`,e(O).cardInfos.map(u=>u.name))).saveDeckInfo(),k()},V=async D=>{const u=await he();!D.shiftKey&&!confirm(`デッキ【${u.name}】を削除します。
よろしいですか？`)||(await u.delete(),k())},de=async()=>{const D=await M.deckUploader.show({title:"デッキ情報アップロード",position:"Middle",cancelable:!0});if(!D)return;const u=[];if(D.replaceAll){if(!confirm(`既存デッキ情報を全て削除し、アップロードしたファイルに置き換えます。
よろしいですか？`))return;u.push(...(await e(pe)).map(z=>z.id))}await Promise.all(D.deckInfos.map(z=>$t.createNewDeck(z.name,z.description,z.cardNames,z.lastUsedAt))),u.length&&await Promise.all(u.map($t.remove)),k()},Se=()=>innerWidth<=1400?"compact":"wide";kt();var ue=xn(),G=Y(ue),S=r(a(G),2),P=a(S),W=a(P),re=a(W),x=a(re),T=a(x),L=r(x,2);ie(L,5,()=>e(n).sort,ne,(D,u,z)=>{var ce=Zi(),Ue=a(ce);p(()=>{Ae(ce,`deck_editor_sort_setting_item ${e(u).order??""} priority_${e(u).priority??""} svelte-n46fl7`),m(Ue,`${gr[e(u).key]??""}
                ${(e(u).order==="asc"?"▲":"▼")??""}`)}),oe("click",ce,()=>{e(n).sort.forEach(Re=>Re.priority++),e(u).order=e(u).order==="asc"?"desc":"asc",Nt(()=>e(n).sort),e(u).priority=1,Nt(()=>e(n).sort)}),s(D,ce)});var te=r(re,2),se=a(te),Me=a(se),j=a(Me),C=r(Me,2),y=a(C),g=r(se,2),b=a(g),F=a(b),ke=r(b,2);ie(ke,5,()=>Ea,ne,(D,u)=>{var z=en(),ce=a(z),Ue,Re=r(ce);p(()=>{Ue!==(Ue=e(u))&&(ce.value=(ce.__value=e(u))==null?"":e(u)),m(Re,` ${mr[e(u)]??""}`)}),Ut(t,[],ce,()=>(e(u),e(n).deckCardKinds),Te=>De(n,e(n).deckCardKinds=Te)),s(D,z)});var xe=r(g,2);{var ye=D=>{var u=an(),z=a(u),ce=a(z),Ue=r(z,2);ie(Ue,5,()=>At,ne,(Re,Te)=>{var Ke=tn(),Fe=a(Ke),We,He=r(Fe);p(()=>{We!==(We=e(Te))&&(Fe.value=(Fe.__value=e(Te))==null?"":e(Te)),m(He,` ${Xt[e(Te)]??""}${ea[e(Te)]??""}`)}),Ut(v,[],Fe,()=>(e(Te),e(n).exMonsterCategories),ze=>De(n,e(n).exMonsterCategories=ze)),s(Re,Ke)}),oe("click",ce,()=>A(["exMonsterCategories"])),ae(3,u,()=>fe,()=>({delay:0,duration:100})),s(D,u)};h(xe,D=>{e(n).deckCardKinds.includes("ExtraMonster")&&D(ye)})}var X=r(xe,2);{var J=D=>{var u=ln(),z=Y(u),ce=a(z),Ue=a(ce),Re=r(ce,2);ie(Re,5,()=>Ta.filter(Be=>!At.includes(Be)),ne,(Be,Oe)=>{var gt=rn(),_t=a(gt),Dt,ot=r(_t);p(()=>{Dt!==(Dt=e(Oe))&&(_t.value=(_t.__value=e(Oe))==null?"":e(Oe)),m(ot,` ${Xt[e(Oe)]??""}${ea[e(Oe)]??""}`)}),Ut(f,[],_t,()=>(e(Oe),e(n).monsterCategories),Ze=>De(n,e(n).monsterCategories=Ze)),s(Be,gt)});var Te=r(z,2),Ke=a(Te),Fe=a(Ke),We=r(Ke,2);ie(We,5,()=>ja,ne,(Be,Oe)=>{var gt=sn(),_t=a(gt),Dt,ot=r(_t,2),Ze=r(ot);p(()=>{Dt!==(Dt=e(Oe))&&(_t.value=(_t.__value=e(Oe))==null?"":e(Oe)),Ae(ot,`monster_attr ${e(Oe)??""} svelte-n46fl7`),m(Ze,` ${ya[e(Oe)]??""}`)}),Ut(c,[],_t,()=>(e(Oe),e(n).monsterAttributes),pt=>De(n,e(n).monsterAttributes=pt)),s(Be,gt)});var He=r(Te,2),ze=a(He),ct=a(ze),Lt=r(ze,2);ie(Lt,5,()=>Ma,ne,(Be,Oe)=>{var gt=nn(),_t=a(gt),Dt,ot=r(_t);p(()=>{Dt!==(Dt=e(Oe))&&(_t.value=(_t.__value=e(Oe))==null?"":e(Oe)),m(ot,` ${ia[e(Oe)]??""}
                    ${ga[e(Oe)]??""}`)}),Ut(_,[],_t,()=>(e(Oe),e(n).monsterTypes),Ze=>De(n,e(n).monsterTypes=Ze)),oe("dblclick",gt,Ze=>E(Ze,"monsterTypes",e(Oe))),s(Be,gt)});var Yt=r(He,2),It=a(Yt),st=a(It),tt=r(It,2),lt=a(tt),it=r(a(lt),2),ft=r(it,4),yt=r(lt,2),ut=r(a(yt),2),St=r(ut,4),jt=r(yt,2),Tt=r(a(jt),2),et=r(Tt,4),at=r(jt,2),rt=r(a(at),2);oe("click",Ue,()=>A(["monsterCategories"])),ae(3,z,()=>fe,()=>({delay:0,duration:100})),oe("click",Fe,()=>A(["monsterAttributes"])),ae(3,Te,()=>fe,()=>({delay:0,duration:100})),oe("click",ct,()=>A(["monsterTypes"])),ae(3,He,()=>fe,()=>({delay:0,duration:100})),oe("click",st,()=>A(["starLowerBound","starUpperBound","atkLowerBound","atkUpperBound","defLowerBound","defUpperBound","atkPlusDef"])),Mt(it,()=>e(n).starLowerBound,Be=>De(n,e(n).starLowerBound=Be)),Mt(ft,()=>e(n).starUpperBound,Be=>De(n,e(n).starUpperBound=Be)),Mt(ut,()=>e(n).atkLowerBound,Be=>De(n,e(n).atkLowerBound=Be)),Mt(St,()=>e(n).atkUpperBound,Be=>De(n,e(n).atkUpperBound=Be)),Mt(Tt,()=>e(n).defLowerBound,Be=>De(n,e(n).defLowerBound=Be)),Mt(et,()=>e(n).defUpperBound,Be=>De(n,e(n).defUpperBound=Be)),Mt(rt,()=>e(n).atkPlusDef,Be=>De(n,e(n).atkPlusDef=Be)),ae(3,Yt,()=>fe,()=>({delay:0,duration:100})),s(D,u)};h(X,D=>{(e(n).deckCardKinds.includes("Monster")||e(n).deckCardKinds.includes("ExtraMonster"))&&D(J)})}var H=r(X,2);{var we=D=>{var u=vn(),z=a(u),ce=a(z),Ue=r(z,2);ie(Ue,5,()=>Sa.filter(Re=>Re!=="PendulumScale"),ne,(Re,Te)=>{var Ke=on(),Fe=a(Ke),We,He=r(Fe);p(()=>{We!==(We=e(Te))&&(Fe.value=(Fe.__value=e(Te))==null?"":e(Te)),m(He,` ${na[e(Te)]??""}`)}),Ut(o,[],Fe,()=>(e(Te),e(n).spellCategories),ze=>De(n,e(n).spellCategories=ze)),s(Re,Ke)}),oe("click",ce,()=>A(["spellCategories"])),ae(3,u,()=>fe,()=>({delay:0,duration:100})),s(D,u)};h(H,D=>{e(n).deckCardKinds.includes("Spell")&&D(we)})}var Ne=r(H,2);{var Ie=D=>{var u=cn(),z=a(u),ce=a(z),Ue=r(z,2);ie(Ue,5,()=>$a,ne,(Re,Te)=>{var Ke=dn(),Fe=a(Ke),We,He=r(Fe);p(()=>{We!==(We=e(Te))&&(Fe.value=(Fe.__value=e(Te))==null?"":e(Te)),m(He,` ${la[e(Te)]??""}`)}),Ut(U,[],Fe,()=>(e(Te),e(n).trapCategories),ze=>De(n,e(n).trapCategories=ze)),s(Re,Ke)}),oe("click",ce,()=>A(["trapCategories"])),ae(3,u,()=>fe,()=>({delay:0,duration:100})),s(D,u)};h(Ne,D=>{e(n).deckCardKinds.includes("Trap")&&D(Ie)})}var Pe=r(Ne,2),Ee=a(Pe),Ge=a(Ee),Le=r(Ee,2);ie(Le,4,()=>[{key:"test",text:"テスト用カード"},{key:"oldVersion",text:"エラッタ前カード"},{key:"implemented",text:"未実装カード"}],ne,(D,u)=>{var z=_n(),ce=a(z),Ue,Re=r(ce);p(()=>{Ue!==(Ue=u.key)&&(ce.value=(ce.__value=u.key)==null?"":u.key),m(Re,` ${u.text??""}`)}),Ut(I,[],ce,()=>(u.key,e(n).others),Te=>De(n,e(n).others=Te)),s(D,z)});var ge=r(W,2);Hi(ge,{get cardInfo(){return e(K)}});var Ce=r(P,2),Ye=a(Ce);bt(Ye,()=>Gt,D=>{var u=un();s(D,u)},(D,u)=>{const z=le(()=>Object.values(e(u).dic));qa(D,{mode:"List",get allCardInfos(){return e(z)},onAttention:Z,get searchCondition(){return e(n)},get deckCardInfos(){return e(O).cardInfos},set deckCardInfos(ce){De(O,e(O).cardInfos=ce)},$$legacy:!0})});var qe=r(Ce,2),Je=a(qe);{var nt=D=>{var u=je(),z=Y(u);bt(z,()=>e(pe),ce=>{var Ue=hn();s(ce,Ue)},(ce,Ue)=>{var Re=bn(),Te=Y(Re),Ke=a(Te),Fe=r(a(Ke),2),We=a(Fe);p(()=>{e($e),Nt(()=>{e(Ue)})}),ie(We,5,()=>e(Ue),ne,(et,at)=>{var rt=fn(),Be={},Oe=a(rt);p(()=>{Be!==(Be=e(at).id)&&(rt.value=(rt.__value=e(at).id)==null?"":e(at).id),m(Oe,e(at).name)}),s(et,rt)});var He=r(Ke,2),ze=r(a(He),2),ct=a(ze),Lt=r(He,4),Yt=r(a(Lt),2),It=a(Yt),st=r(Yt,2),tt=a(st),lt=r(st,2),it=a(lt),ft=r(Lt,2),yt=r(a(ft),2);bt(yt,he,et=>{var at=yn();s(et,at)},(et,at)=>{var rt=pn(),Be=a(rt);p(Oe=>wt(Be,"href",Oe),[()=>$t.convertToObjectURL([e(at)])],le),s(et,rt)});var ut=r(yt,2);bt(ut,()=>e(ve),et=>{var at=mn();s(et,at)},(et,at)=>{var rt=gn(),Be=a(rt);p(()=>wt(Be,"href",e(at))),s(et,rt)});var St=r(ut,2),jt=a(St),Tt=r(Te,2);qa(Tt,{mode:"Deck",allCardInfos:[],onAttention:Z,get deckCardInfos(){return e(O).cardInfos},set deckCardInfos(et){De(O,e(O).cardInfos=et)},$$legacy:!0}),Wt(We,()=>e($e),et=>$($e,et)),oe("change",We,_e),Mt(ct,()=>e(O).name,et=>De(O,e(O).name=et)),oe("click",It,B),oe("click",tt,q),oe("click",it,V),oe("click",jt,de),s(ce,Re)}),s(D,u)},Xe=D=>{var u=kn();s(D,u)};h(Je,D=>{e(N)==="DeckEdit"||Se()==="wide"?D(nt):D(Xe,!1)})}var Qe=r(G,2);Ji(Qe,{modalController:M}),p((D,u,z)=>Ae(G,`deck_editor screen_size_${D??""} left_pain_mode_${u??""} main_view_mode_${z??""} svelte-n46fl7`),[Se,()=>e(Q).toLowerCase(),()=>e(N).toLowerCase()],le),oe("click",T,R),oe("click",j,()=>A(["name"])),Mt(y,()=>e(n).name,D=>De(n,e(n).name=D)),oe("click",F,()=>A(["deckCardKinds"])),oe("click",Ge,()=>A(["others"])),ae(3,Pe,()=>fe,()=>({delay:0,duration:100})),oe("focusin",W,()=>{$(Q,"SearchCondition"),$(N,"SearchCondition")}),oe("click",W,()=>{$(Q,"SearchCondition"),$(N,"SearchCondition")}),oe("click",qe,()=>{$(N,"DeckEdit")}),oe("focusin",qe,()=>{$(N,"DeckEdit")}),s(d,ue),xt()}const Cn=["TblDeckHeader","TblDeckDetail","TblDuelistProfile"],Dn=3;var $n=l('<input class="game_mode_radio svelte-sy4ydn" type="radio" name="game_mode"> <label> </label>',1),Sn=l('<option class="svelte-sy4ydn"> </option>'),Mn=l('<option class="svelte-sy4ydn"> </option>'),jn=l('<option class="svelte-sy4ydn"> </option>'),Tn=l('<tr class="config_row svelte-sy4ydn"><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><label for="npc_deck_selector" class="config_row_label deck_selector svelte-sy4ydn">デッキ：</label></div></td><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><select id="npc_deck_selector" class="deck_selector svelte-sy4ydn"><option class="svelte-sy4ydn">デフォルト</option><!></select></div></td></tr>'),Bn=l('<option class="svelte-sy4ydn"> </option>'),En=l('<tr class="config_row svelte-sy4ydn"><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><label for="npc_selector" class="config_row_label npc_selector svelte-sy4ydn">対戦相手：</label></div></td><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><select id="npc_selector" class="npc_selector svelte-sy4ydn"></select> <div class="svelte-sy4ydn"> </div></div></td></tr> <!> <tr class="config_row svelte-sy4ydn"><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><label for="npc_selector" class="config_row_label npc_selector svelte-sy4ydn">先攻後攻：</label></div></td><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><select id="npc_selector" class="npc_selector svelte-sy4ydn"></select></div></td></tr>',1),An=l('<option class="svelte-sy4ydn"> </option>'),Ln=l('<tr class="config_row svelte-sy4ydn"><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><label for="difficulty_selector" class="config_row_label difficulty_selector svelte-sy4ydn">難易度：</label></div></td><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><select id="difficulty_selector" class="difficulty_selector svelte-sy4ydn"></select></div></td></tr>'),Yn=l('<tr class="config_row svelte-sy4ydn"><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><label class="config_row_label svelte-sy4ydn" for="game_mode_radio_preset">ゲームモード：</label></div></td><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"></div></td></tr> <tr class="config_row svelte-sy4ydn"><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><label for="deck_selector" class="config_row_label deck_selector svelte-sy4ydn">デッキ：</label></div></td><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><select id="deck_selector" class="deck_selector svelte-sy4ydn"></select></div></td></tr> <!> <tr><td colspan="2" class="svelte-sy4ydn"><div><button class="btn svelte-sy4ydn">duel start!</button></div></td></tr>',1),Un=l('<tr><td colspan="2" class="svelte-sy4ydn"><div>デッキ情報の読み込み、もしくは作成中...</div></td></tr>'),Nn=l('<tr><td colspan="2" class="svelte-sy4ydn"><div><button class="btn svelte-sy4ydn">deck edit</button></div></td></tr>'),Pn=l('<tr class="config_row svelte-sy4ydn"><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><label for="duelist_name" class="config_row_label duelist_name svelte-sy4ydn">名前：</label></div></td><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><input id="duelist_name" class="duelist_name svelte-sy4ydn" type="text"></div></td></tr> <!> <!>',1),qn=l('<tr><td colspan="2" class="svelte-sy4ydn"><div>デュエリスト情報の読み込み、もしくは作成中...</div></td></tr>'),Fn=l('<div class="app_body svelte-sy4ydn"><table class="config_table svelte-sy4ydn"><tbody><!></tbody></table></div>'),Hn=l('<span class="svelte-sy4ydn"> </span> <span class="svelte-sy4ydn"> </span>',1),On=l('<div class="result_title result_win svelte-sy4ydn">YOU WIN</div>'),In=l('<div class="result_title result_lose svelte-sy4ydn">YOU LOSE</div>'),Rn=l('<div class="result_title result_draw svelte-sy4ydn">DRAW</div>'),Kn=l('<div class="twitter_share_button_wrapper svelte-sy4ydn"><a rel="nofollow" target="_blank" class="twitter_share_button svelte-sy4ydn">X(twitter)でシェアする</a></div>'),Wn=l('<div class="result svelte-sy4ydn"><!> <div class="reason_of_end svelte-sy4ydn"> </div> <!> <div class="svelte-sy4ydn"><button class="white_button svelte-sy4ydn">TOPへ戻る</button></div></div>'),zn=l('<main style="flex-direction: column; display :flex" class="svelte-sy4ydn"><div class="link link_left svelte-sy4ydn"><a href="https://github.com/Setta238/stk_ygo_svelte" target="_blank" rel="noopener noreferrer" title="repository" class="svelte-sy4ydn">repository</a> <a href="https://x.com/ninja_no" target="_blank" rel="noopener noreferrer" title="repository" class="svelte-sy4ydn">X(Twitter)</a> <a href="https://posfie.com/@ninja_no/p/Lx7FLj3" target="_blank" rel="noopener noreferrer" title="posfie" class="svelte-sy4ydn">posfie(toggeter)</a></div> <div class="link link_right svelte-sy4ydn"><a class="a_button svelte-sy4ydn" role="button" tabindex="0">TOPへ戻る</a> <a href="/stk_ygo_svelte/note.html" target="_blank" rel="noopener noreferrer" title="repository" class="svelte-sy4ydn">現時点とこの先のこと</a></div> <!> <div class="footer card_summary svelte-sy4ydn"><!></div> <div class="footer debug_info svelte-sy4ydn"><span class="svelte-sy4ydn"> </span> <span class="user_agent_info svelte-sy4ydn"> </span> <span class="screen_info svelte-sy4ydn"> </span></div> <!></main>');function Vn(d,i){ht(i,!1);const t=new br("stk_ygo_svelte",Dn,Cn);let v=me(0),f=me(0),c=me(),_=me("FtkChallenge"),o=me("None"),U=me(0),I=me(""),M=me(void 0);const w="https://setta238.github.io/stk_ygo_svelte/",n="遊戯王deそりてあ",N="ninja_no",Q=hr.getOrCreateNew(t).then(j=>($(_,Aa.includes(j.previousGameMode)?j.previousGameMode:"FtkChallenge"),he(j.previousNpcId),j)),R=j=>{var y;const C=j.find(g=>g.lastUsedAt.getTime()===Math.max(...j.map(b=>b.lastUsedAt.getTime())))??j[0];$(U,C.id),e(_)==="FtkChallenge"&&C.deckType!=="Preset"&&$(U,((y=Ft.find(g=>g.deckType==="Preset"))==null?void 0:y.id)??e(U))};let A=me($t.getAllDeckInfo(t).then(j=>(Promise.all(j.filter(C=>!C.lastUsedAt).map(C=>{C.saveDeckInfo()})),R(j),j)));const E=async()=>{const j=e(U);let C=(await e(A)).find(g=>g.id===j)??(await be()).find(g=>g.id===j);C&&await C.updateTimestamp();let y=C;if(y||(y=Ft.find(g=>g.id===j)),!y)throw new Error("illegal state");return y},_e=async()=>{(await Q).save({previousGameMode:e(_)})},be=()=>($(A,$t.getAllDeckInfo(t).then(j=>(R(j),j))),e(A)),$e=async()=>{(await e(A)).length||(await $t.prepareSampleDeck(),be())},pe=async()=>{await Promise.all([_e(),$e()]);const j=await E(),C=await Q;let y=Kt.find(F=>F.id===Number.MIN_SAFE_INTEGER)??Kt[0],g=Ft.find(F=>F.id===Number.MIN_SAFE_INTEGER)??Ft[0],b="PlayFirst";e(_)==="FtkChallenge"?y=Kt.filter(F=>F.npcType==="FtkChallenge").find(F=>F.difficulty===C.previousDifficulty)??y:e(_)==="Free"&&(y=Kt.find(F=>F.id===C.previousNpcId)??y,g=Ft.slice(-1)[0],b=C.previousStartMode),y.npcType!=="FtkChallenge"&&C.previousNpcDeckId>-1?g=(await e(A)).find(F=>F.id===C.previousNpcDeckId)??g:g=Ft.find(F=>F.id===y.id)??g,$(c,new Cr(C,"Player",j,[],y,"NPC",g,[],b)),e(c).onDuelEnd.append(()=>($(c,e(c)),"RemoveMe"))},ve=async()=>{await Promise.all([_e(),$e()]),$(o,"DeckEdit")},k=async j=>{await _e(),j.key==="Enter"&&!j.repeat&&(await Q).save()},O=()=>{$(A,be()),$(c,void 0),$(o,"None")};let K=Date.now();const ee=j=>{Date.now()-K<200||(K=Date.now(),$(_,j),be())},Z=j=>{he(Number(j.currentTarget.value))},he=j=>{var C;$(M,Kt.find(y=>y.id===j)),$(I,((C=e(M))==null?void 0:C.description)??"")};$e(),kt();var B=zn(),q=r(a(B),2),V=a(q),de=r(q,2);{var Se=j=>{var C=je(),y=Y(C);bt(y,()=>Q,null,(g,b)=>{gi(g,{get duel(){return e(c)},get userProfile(){return e(b)}})}),s(j,C)},ue=j=>{var C=je(),y=Y(C);{var g=F=>{wn(F,{})},b=F=>{var ke=Fn(),xe=a(ke),ye=a(xe),X=a(ye);bt(X,()=>Q,J=>{var H=qn();s(J,H)},(J,H)=>{var we=Pn(),Ne=Y(we),Ie=a(Ne),Pe=a(Ie),Ee=r(Ie),Ge=a(Ee),Le=a(Ge),ge=r(Ne,2);bt(ge,()=>e(A),qe=>{var Je=Un();s(qe,Je)},(qe,Je)=>{var nt=Yn(),Xe=Y(nt),Qe=a(Xe),D=a(Qe),u=r(Qe),z=a(u);ie(z,5,()=>Aa,ne,(st,tt)=>{var lt=$n(),it=Y(lt),ft=r(it,2),yt=a(ft);p(ut=>{wt(it,"id",`game_mode_radio_${ut??""}`),xr(it,e(tt)),wr(it,e(_)===e(tt)),Ae(ft,`game_mode_tab_label game_mode_tab_${ut??""} svelte-sy4ydn`),wt(ft,"for",`game_mode_radio_${ut??""}`),m(yt,e(tt))},[()=>e(tt).toLowerCase()],le),oe("change",it,()=>ee(e(tt))),s(st,lt)});var ce=r(Xe,2),Ue=a(ce),Re=a(Ue),Te=r(Ue),Ke=a(Te),Fe=a(Ke);p(()=>{e(U),Nt(()=>{e(_),e(Je)})}),ie(Fe,5,()=>e(_)==="FtkChallenge"?Ft.filter(st=>st.deckType==="Preset"):e(Je),ne,(st,tt)=>{var lt=Sn(),it={},ft=a(lt);p(()=>{it!==(it=e(tt).id)&&(lt.value=(lt.__value=e(tt).id)==null?"":e(tt).id),m(ft,e(tt).name)}),s(st,lt)});var We=r(ce,2);{var He=st=>{var tt=En(),lt=Y(tt),it=a(lt),ft=a(it),yt=r(it),ut=a(yt),St=a(ut);p(()=>{e(H),Nt(()=>{})}),ie(St,5,()=>Kt,ne,(ot,Ze)=>{var pt=Mn(),qt={},Rt=a(pt);p(()=>{qt!==(qt=e(Ze).id)&&(pt.value=(pt.__value=e(Ze).id)==null?"":e(Ze).id),m(Rt,e(Ze).name)}),s(ot,pt)});var jt=r(St,2),Tt=a(jt),et=r(lt,2);{var at=ot=>{var Ze=Tn(),pt=a(Ze),qt=a(pt),Rt=r(pt),ha=a(Rt),ka=a(ha);p(()=>{e(H),Nt(()=>{e(Je)})});var oa=a(ka);oa.value=(oa.__value=Number.MIN_SAFE_INTEGER)==null?"":Number.MIN_SAFE_INTEGER;var Oa=r(oa);ie(Oa,1,()=>e(Je),ne,(va,Jt)=>{var Zt=jn(),xa={},Ia=a(Zt);p(()=>{xa!==(xa=e(Jt).id)&&(Zt.value=(Zt.__value=e(Jt).id)==null?"":e(Jt).id),m(Ia,e(Jt).name)}),s(va,Zt)}),ae(3,qt,()=>fe,()=>({duration:200})),ae(3,pt,()=>fe,()=>({duration:200})),Wt(ka,()=>e(H).previousNpcDeckId,va=>e(H).previousNpcDeckId=va),ae(3,ha,()=>fe,()=>({duration:200})),ae(3,Rt,()=>fe,()=>({duration:200})),ae(3,Ze,()=>fe,()=>({duration:200})),s(ot,Ze)};h(et,ot=>{var Ze;((Ze=e(M))==null?void 0:Ze.npcType)!=="FtkChallenge"&&ot(at)})}var rt=r(et,2),Be=a(rt),Oe=a(Be),gt=r(Be),_t=a(gt),Dt=a(_t);p(()=>{e(H),Nt(()=>{})}),ie(Dt,5,()=>sa(La),ne,(ot,Ze)=>{var pt=Bn(),qt={},Rt=a(pt);p(()=>{qt!==(qt=e(Ze))&&(pt.value=(pt.__value=e(Ze))==null?"":e(Ze)),m(Rt,La[e(Ze)])}),s(ot,pt)}),p(()=>m(Tt,`※${e(I)??""}`)),ae(3,ft,()=>fe,()=>({duration:200})),ae(3,it,()=>fe,()=>({duration:200})),oe("change",St,Z),Wt(St,()=>e(H).previousNpcId,ot=>e(H).previousNpcId=ot),ae(3,ut,()=>fe,()=>({duration:200})),ae(3,yt,()=>fe,()=>({duration:200})),ae(3,lt,()=>fe,()=>({duration:200})),ae(3,Oe,()=>fe,()=>({duration:200})),ae(3,Be,()=>fe,()=>({duration:200})),Wt(Dt,()=>e(H).previousStartMode,ot=>e(H).previousStartMode=ot),ae(3,_t,()=>fe,()=>({duration:200})),ae(3,gt,()=>fe,()=>({duration:200})),ae(3,rt,()=>fe,()=>({duration:200})),s(st,tt)},ze=st=>{var tt=je(),lt=Y(tt);{var it=ft=>{var yt=Ln(),ut=a(yt),St=a(ut),jt=r(ut),Tt=a(jt),et=a(Tt);p(()=>{e(H),Nt(()=>{})}),ie(et,5,()=>Dr,ne,(at,rt)=>{var Be=An(),Oe={},gt=a(Be);p(()=>{Oe!==(Oe=e(rt))&&(Be.value=(Be.__value=e(rt))==null?"":e(rt)),m(gt,e(rt))}),s(at,Be)}),ae(3,St,()=>fe,()=>({duration:200})),ae(3,ut,()=>fe,()=>({duration:200})),Wt(et,()=>e(H).previousDifficulty,at=>e(H).previousDifficulty=at),ae(3,Tt,()=>fe,()=>({duration:200})),ae(3,jt,()=>fe,()=>({duration:200})),ae(3,yt,()=>fe,()=>({duration:200})),s(ft,yt)};h(lt,ft=>{e(_)==="FtkChallenge"&&ft(it)},!0)}s(st,tt)};h(We,st=>{e(_)==="Free"?st(He):st(ze,!1)})}var ct=r(We,2),Lt=a(ct),Yt=a(Lt),It=a(Yt);ae(3,D,()=>fe,()=>({duration:200})),ae(3,Qe,()=>fe,()=>({duration:200})),ae(3,z,()=>fe,()=>({duration:200})),ae(3,u,()=>fe,()=>({duration:200})),ae(3,Xe,()=>fe,()=>({duration:200})),ae(3,Re,()=>fe,()=>({duration:200})),ae(3,Ue,()=>fe,()=>({duration:200})),Wt(Fe,()=>e(U),st=>$(U,st)),ae(3,Ke,()=>fe,()=>({duration:200})),ae(3,Te,()=>fe,()=>({duration:200})),ae(3,ce,()=>fe,()=>({duration:200})),oe("click",It,pe),ae(3,Yt,()=>fe,()=>({duration:200})),s(qe,nt)});var Ce=r(ge,2);{var Ye=qe=>{var Je=Nn(),nt=a(Je),Xe=a(nt),Qe=a(Xe);oe("click",Qe,ve),ae(3,Xe,()=>fe,()=>({duration:200})),ae(3,nt,()=>fe,()=>({duration:200})),ae(3,Je,()=>fe,()=>({duration:200})),s(qe,Je)};h(Ce,qe=>{e(_)==="Free"&&qe(Ye)})}ae(3,Pe,()=>fe,()=>({duration:200})),ae(3,Ie,()=>fe,()=>({duration:200})),Mt(Le,()=>e(H).name,qe=>e(H).name=qe),oe("keypress",Le,k),ae(3,Ge,()=>fe,()=>({duration:200})),ae(3,Ee,()=>fe,()=>({duration:200})),ae(3,Ne,()=>fe,()=>({duration:200})),s(J,we)}),s(F,ke)};h(y,F=>{e(o)==="DeckEdit"?F(g):F(b,!1)},!0)}s(j,C)};h(de,j=>{e(c)?j(Se):j(ue,!1)})}var G=r(de,2),S=a(G);bt(S,()=>Gt,j=>{var C=dt("読み込み中");s(j,C)},(j,C)=>{var y=Hn(),g=Y(y),b=a(g),F=r(g,2),ke=a(F);p((xe,ye,X)=>{m(b,`公式DB上のカード${xe??""}枚`),m(ke,`実装済カード（効果あり）${ye??""}枚 （効果なし）${X??""}枚`)},[()=>e(C).knmCount.toLocaleString(),()=>e(C).definitionCount.toLocaleString(),()=>e(C).nonDefinitionCount.toLocaleString()],le),s(j,y)});var P=r(G,2),W=a(P),re=a(W),x=r(W,2),T=a(x),L=r(x,2),te=a(L),se=r(P,2);{var Me=j=>{var C=Wn(),y=a(C);{var g=H=>{var we=je(),Ne=Y(we);{var Ie=Ee=>{var Ge=On();s(Ee,Ge)},Pe=Ee=>{var Ge=je(),Le=Y(Ge);{var ge=Ce=>{var Ye=In();s(Ce,Ye)};h(Le,Ce=>{e(c).winner.seat==="Above"&&Ce(ge)},!0)}s(Ee,Ge)};h(Ne,Ee=>{e(c).winner.seat==="Below"?Ee(Ie):Ee(Pe,!1)})}s(H,we)},b=H=>{var we=Rn();s(H,we)};h(y,H=>{e(c).winner?H(g):H(b,!1)})}var F=r(y,2),ke=a(F),xe=r(F,2);{var ye=H=>{var we=Kn(),Ne=a(we);p(()=>wt(Ne,"href",`https://x.com/share?url=${w}&text=${e(c).twitterShareText??""}&hashtags=${n}&via=${N}`)),s(H,we)};h(xe,H=>{e(c).twitterShareText&&H(ye)})}var X=r(xe,2),J=a(X);p(()=>m(ke,e(c).reasonOfEnd)),oe("click",J,O),ae(3,C,()=>Mr,()=>({delay:200,duration:200})),s(j,C)};h(se,j=>{e(c)&&e(c).isEnded&&j(Me)})}p(()=>{m(re,"build at: 20260110_162955"),m(T,kr.text),m(te,`w:${e(v)??""}px h:${e(f)??""}px`)}),ta("innerWidth",j=>$(v,j)),ta("innerHeight",j=>$(f,j)),oe("click",V,O),s(d,B),xt()}$r(Vn,{target:document.getElementById("app")});
