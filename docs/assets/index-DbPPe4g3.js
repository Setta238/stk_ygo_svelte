var Ha=Object.defineProperty;var ha=n=>{throw TypeError(n)};var Pa=(n,i,t)=>i in n?Ha(n,i,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[i]=t;var Qe=(n,i,t)=>Pa(n,typeof i!="symbol"?i+"":i,t),ba=(n,i,t)=>i.has(n)||ha("Cannot "+t);var rt=(n,i,t)=>(ba(n,i,"read from private field"),t?t.call(n):i.get(n)),It=(n,i,t)=>i.has(n)?ha("Cannot add the same private member more than once"):i instanceof WeakSet?i.add(n):i.set(n,t),ta=(n,i,t,c)=>(ba(n,i,"write to private field"),c?c.call(n,t):i.set(n,t),t);import{s as ya,r as Ua,a as y,b as Oa,l as La,g as e,d as Ba,p as it,c as We,m as xe,i as lt,t as l,e as a,f as g,h as f,j as ye,k as Ae,n as pt,o as ke,q as r,u as ot,v as Re,S as Ra,w as Te,x as L,y as s,z as ne,D as Dt,A as te,B as de,C as p,E as Wa,F as st,G as oa,H as Ka,I as za,J as $t,K as gt,L as na,M as Xt,N as va,O as Vt,P as da,Q as Qt,R as Zt,T as Ga,U as Xa,V as Va,W as Qa,X as Za,Y as Ja,Z as er,_ as Wt,$ as ht,a0 as Kt,a1 as aa,a2 as Na,a3 as tr,a4 as ar,a5 as rr,a6 as sr,a7 as ir,a8 as _t,a9 as lr,aa as or,ab as nr,ac as wa,ad as ka,ae as xa,af as Ca,ag as Da,ah as $a,ai as Et,aj as qt,ak as ra,al as Sa,am as vr,an as xt,ao as dr,ap as cr,aq as Ma,ar as Tt,as as Ct,at as _r,au as ur,av as fr,aw as pr,ax as ja,ay as mr,az as gr}from"../chunk/entity_proc_20250609_123630.js";import"../chunk/json_20250609_123630.js";(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const _ of document.querySelectorAll('link[rel="modulepreload"]'))c(_);new MutationObserver(_=>{for(const v of _)if(v.type==="childList")for(const m of v.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&c(m)}).observe(document,{childList:!0,subtree:!0});function t(_){const v={};return _.integrity&&(v.integrity=_.integrity),_.referrerPolicy&&(v.referrerPolicy=_.referrerPolicy),_.crossOrigin==="use-credentials"?v.credentials="include":_.crossOrigin==="anonymous"?v.credentials="omit":v.credentials="same-origin",v}function c(_){if(_.ep)return;_.ep=!0;const v=t(_);fetch(_.href,v)}})();const hr=n=>n;function ca(n){const i=n-1;return i*i*i+1}function Ta(n){const i=typeof n=="string"&&n.match(/^\s*(-?[\d.]+)([^\s]*)\s*$/);return i?[parseFloat(i[1]),i[2]||"px"]:[n,"px"]}function br(n,{delay:i=0,duration:t=400,easing:c=hr}={}){const _=+getComputedStyle(n).opacity;return{delay:i,duration:t,easing:c,css:v=>`opacity: ${v*_}`}}function yr(n,{delay:i=0,duration:t=400,easing:c=ca,x:_=0,y:v=0,opacity:m=0}={}){const d=getComputedStyle(n),S=+d.opacity,I=d.transform==="none"?"":d.transform,b=S*(1-m),[o,O]=Ta(_),[A,z]=Ta(v);return{delay:i,duration:t,easing:c,css:(Y,B)=>`
			transform: ${I} translate(${(1-Y)*o}${O}, ${(1-Y)*A}${z});
			opacity: ${S-b*B}`}}function ge(n,{delay:i=0,duration:t=400,easing:c=ca,axis:_="y"}={}){const v=getComputedStyle(n),m=+v.opacity,d=_==="y"?"height":"width",S=parseFloat(v[d]),I=_==="y"?["top","bottom"]:["left","right"],b=I.map(M=>`${M[0].toUpperCase()}${M.slice(1)}`),o=parseFloat(v[`padding${b[0]}`]),O=parseFloat(v[`padding${b[1]}`]),A=parseFloat(v[`margin${b[0]}`]),z=parseFloat(v[`margin${b[1]}`]),Y=parseFloat(v[`border${b[0]}Width`]),B=parseFloat(v[`border${b[1]}Width`]);return{delay:i,duration:t,easing:c,css:M=>`overflow: hidden;opacity: ${Math.min(M*20,1)*m};${d}: ${M*S}px;padding-${I[0]}: ${M*o}px;padding-${I[1]}: ${M*O}px;margin-${I[0]}: ${M*A}px;margin-${I[1]}: ${M*z}px;border-${I[0]}-width: ${M*Y}px;border-${I[1]}-width: ${M*B}px;min-${d}: 0`}}function Ea(n,i){for(const t in i)n[t]=i[t];return n}function wr({fallback:n,...i}){const t=new Map,c=new Map;function _(m,d,S){const{delay:I=0,duration:b=h=>Math.sqrt(h)*30,easing:o=ca}=Ea(Ea({},i),S),O=m.getBoundingClientRect(),A=d.getBoundingClientRect(),z=O.left-A.left,Y=O.top-A.top,B=O.width/A.width,M=O.height/A.height,J=Math.sqrt(z*z+Y*Y),ve=getComputedStyle(d),Ye=ve.transform==="none"?"":ve.transform,C=+ve.opacity;return{delay:I,duration:typeof b=="function"?b(J):b,easing:o,css:(h,F)=>`
			   opacity: ${h*C};
			   transform-origin: top left;
			   transform: ${Ye} translate(${F*z}px,${F*Y}px) scale(${h+(1-h)*B}, ${h+(1-h)*M});
		   `}}function v(m,d,S){return(I,b)=>(m.set(b.key,I),()=>{if(d.has(b.key)){const o=d.get(b.key);return d.delete(b.key),_(o,I,b)}return m.delete(b.key),n&&n(I,b,S)})}return[v(c,t,!1),v(t,c,!0)]}function qa(n){return Object.prototype.toString.call(n)==="[object Date]"}function kr(n){return n}function sa(n){const i=n-1;return i*i*i+1}function ia(n,i){if(n===i||n!==n)return()=>n;const t=typeof n;if(t!==typeof i||Array.isArray(n)!==Array.isArray(i))throw new Error("Cannot interpolate values of different type");if(Array.isArray(n)){const c=i.map((_,v)=>ia(n[v],_));return _=>c.map(v=>v(_))}if(t==="object"){if(!n||!i)throw new Error("Object cannot be null");if(qa(n)&&qa(i)){const v=n.getTime(),d=i.getTime()-v;return S=>new Date(v+S*d)}const c=Object.keys(i),_={};return c.forEach(v=>{_[v]=ia(n[v],i[v])}),v=>{const m={};return c.forEach(d=>{m[d]=_[d](v)}),m}}if(t==="number"){const c=i-n;return _=>n+_*c}return()=>i}var mt,At,Ft,St;const _a=class _a{constructor(i,t={}){It(this,mt,ya(void 0));It(this,At,ya(void 0));It(this,Ft);It(this,St,null);rt(this,mt).v=rt(this,At).v=i,ta(this,Ft,t)}static of(i,t){const c=new _a(i(),t);return Ua(()=>{c.set(i())}),c}set(i,t){var o;y(rt(this,At),i);let{delay:c=0,duration:_=400,easing:v=kr,interpolate:m=ia}={...rt(this,Ft),...t};if(_===0)return(o=rt(this,St))==null||o.abort(),y(rt(this,mt),i),Promise.resolve();const d=Oa.now()+c;let S,I=!1,b=rt(this,St);return ta(this,St,La(O=>{if(O<d)return!0;if(!I){I=!0;const z=rt(this,mt).v;S=m(z,i),typeof _=="function"&&(_=_(z,i)),b==null||b.abort()}const A=O-d;return A>_?(y(rt(this,mt),i),!1):(y(rt(this,mt),S(v(A/_))),!0)})),rt(this,St).promise}get current(){return e(rt(this,mt))}get target(){return e(rt(this,At))}set target(i){this.set(i)}};mt=new WeakMap,At=new WeakMap,Ft=new WeakMap,St=new WeakMap;let zt=_a;var xr=l('<div class="phase_display svelte-1ycsdg6"><span class="svelte-1ycsdg6"> </span> </div>'),Cr=l('<div class="lifepoint_display svelte-1ycsdg6"><div class="svelte-1ycsdg6"> </div> <div class="svelte-1ycsdg6"> </div></div>'),Dr=(n,i,t)=>i(e(t)),$r=l('<div class="svelte-1ycsdg6"><button class="phase_button svelte-1ycsdg6"> </button></div>'),Sr=l("<div><!></div>"),Mr=l('<div class="svelte-1ycsdg6"><!></div>'),jr=l("<div><!></div>"),Tr=l('<div class="config_button_wrapper svelte-1ycsdg6"><button id="config_button" class="svelte-1ycsdg6">⚙</button></div>'),Er=l("<!> <!> <!> <!>",1),qr=l('<div style="position: absolute;" class="card_animation_receiver svelte-1ycsdg6"><!></div>'),Ar=l('<div style="position: absolute; top:0rem" class="svelte-1ycsdg6">｛効果対象｝</div>'),Yr=l('<!> <div style="position: absolute; display:flex;justify-content: center;"><!></div>',1),Br=l(" <!> 】",1),Nr=l('<div style="position: absolute; bottom:0rem" class="svelte-1ycsdg6"> <!></div>'),Ir=l("<!> <!>",1),Fr=l('<div class="badge svelte-1ycsdg6"> </div>'),Hr=l('<div class="card_animation_receiver svelte-1ycsdg6"><!></div>'),Pr=l("<!> <!> <!> <!>",1),Ur=l('<td><div role="listitem"><!></div></td>');function Or(n,i){it(i,!1);let t=We(i,"view",12),c=We(i,"row",8),_=We(i,"column",8),v=We(i,"selectedEntities",28,()=>[]),m=We(i,"selectedCells",28,()=>[]),d=xe(t().getCell(c(),_())),S=xe(new zt(e(d).field.duel.duelists.Above.lp,{duration:400,easing:sa})),I=xe(new zt(e(d).field.duel.duelists.Below.lp,{duration:400,easing:sa}));const b=()=>{y(d,t().getCell(c(),_())),Re(S,e(S).target=e(d).field.duel.duelists.Above.lp),Re(I,e(I).target=e(d).field.duel.duelists.Below.lp)};e(d).onUpdate.append(b),t().onDuelUpdate.append(b),t().modalController.onUpdate.append(b);let o,O=xe([]),A=()=>console.log("hoge"),z,Y=xe([]),B=xe(!1),M=xe(!1),J=!1;const ve=$=>{var Z,oe;y(ce,[]),v().reset(),o=$.activator,A=$.resolve,y(O,$.dummyActionInfos),y(Y,$.chainBlockInfos.flatMap(w=>w.selectedEntities).getDistinct()),z=$.entitiesChoices,y(B,!1),y(M,((Z=$.cellsChoices)==null?void 0:Z.selectables.includes(e(d)))??!1),J=e(M)&&((oe=$.cellsChoices)==null?void 0:oe.qty)===1,b()};t().onWaitStart.append(ve);const Ye=()=>{o=void 0,y(O,[]),A=()=>{console.log("hoge")},z=void 0,y(Y,[]),y(B,!1),y(M,!1),J=!1};t().onWaitEnd.append(Ye);let C=xe(!1),h=[];const F=$=>{h=$.filter(Z=>Z.dests.includes(e(d))),y(C,h.length>0),b()},ae=()=>{h=[],y(C,!1),b()};t().onDragStart.append(F),t().onDragEnd.append(ae);const[Me,Q]=Ps;let ce=xe([]);const X=$=>{if(o=void 0,e(d)===$.to||e(d).entities.includes($.entity)){y(ce,[...e(ce),$]);const Z=$.resolve;y(d,e(d)),setTimeout(()=>{y(ce,e(ce).filter(oe=>oe!==$)),$.count++,$.count>1&&Z()},600)}};t().onAnimation.append(X);const he=$=>{A({phaseChange:$})},G=()=>e(d).isStackCell&&e(d).entities.flatMap($=>$.actions).filter($=>e(O).map(Z=>Z.action.seq).some(Z=>Z===$.seq)).length>0,H=$=>{var Z;if(((Z=$.target)==null?void 0:Z.id)==="config_button"){t(t().infoBoardState="Config",!0),t().requireUpdate();return}if(t(t().infoBoardState="Default",!0),J)A({selectedCells:[e(d)]});else if(e(M))y(B,!e(B)),m(e(B)?[...m(),e(d)]:m().filter(oe=>oe!==e(d)));else if(e(d).isStackCell){t(t().infoBoardState="CellInfo",!0),t(t().infoBoardCell=e(d),!0),t().requireUpdate();const oe=e(d).entities.flatMap(j=>j.actions).map(j=>j.seq),w=e(O).filter(j=>oe.includes(j.action.seq));if(w.length){if(!o)return;t().modalController.actionSelector.show({title:"カードを選択。",position:"Bottom",activator:o,dummyActionInfos:w,cancelable:!0}).then(j=>{j&&A({actionInfo:j})});return}}t().requireUpdate(),console.info(e(d),pe(...e(d).visibleEntities))},ie=$=>{$.preventDefault(),$.dataTransfer&&($.dataTransfer.dropEffect="move")},le=$=>{$.preventDefault(),console.info("drop",$,e(C),h),$.dataTransfer&&($.dataTransfer.dropEffect="move");try{if(e(C)&&h){if(h.length===1){const Z=h[0];A({actionInfo:{...Z,dest:e(d)}})}else if(h.length>1){if(!o)throw new Ra("想定されない状態");e(d).field.duel.view.modalController.terminateAll(),e(d).field.duel.view.modalController.actionSelector.show({title:"選択",position:"Bottom",activator:o,dummyActionInfos:h.map(Z=>({...Z,dest:e(d)})),cancelable:!1}).then(Z=>{A({actionInfo:Z})})}}}finally{t().removeDraggingActions()}},pe=(...$)=>{if(t().waitMode==="Animation")return"Disabled";if(z&&z.selectables.find(oe=>$.find(w=>oe===w)))return"Selectable";if(!e(O)||e(O).length===0||t().waitMode!=="Free"||Object.values(t().modalController.modals).some(oe=>oe.state==="Shown"))return"Disabled";const Z=e(O).filter(oe=>$.includes(oe.action.entity));return Z.length===0?"Disabled":e(d).isStackCell||Z[0].action.entity!==$[0]?"Clickable":Z.some(oe=>oe.dests.length)?"Draggable":"Clickable"};lt();var W=Ur(),T=a(W);T.__click=H;var R=a(T);{var se=$=>{var Z=Te(),oe=L(Z);{var w=j=>{var N=Te(),k=L(N);{var re=q=>{var be=xr(),Ce=a(be),je=a(Ce),fe=s(Ce,1,!0);f((P,V)=>{p(je,P),p(fe,V)},[()=>String(e(d).field.duel.clock.turn).padStart(2,"0"),()=>e(d).field.duel.phase.toUpperCase()],ye),r(q,be)},u=q=>{var be=Te(),Ce=L(be);{var je=P=>{var V=Cr(),U=a(V),_e=a(U),De=s(U,2),Ne=a(De);f(($e,ee)=>{p(_e,$e),p(Ne,ee)},[()=>Math.floor(e(S).current),()=>Math.floor(e(I).current)],ye),r(P,V)},fe=P=>{var V=Te(),U=L(V);{var _e=De=>{var Ne=Te(),$e=L(Ne);{var ee=ue=>{var Ee=Te(),x=L(Ee);{var D=E=>{var me=Te(),Be=L(me);ne(Be,1,()=>t().duel.nextPhaseList,de,(Ue,K)=>{var we=$r(),qe=a(we);qe.__click=[Dr,he,K];var Ke=a(qe);f(He=>p(Ke,He),[()=>e(K).toUpperCase()],ye),r(Ue,we)}),r(E,me)};g(x,E=>{t().duel.isEnded||E(D)})}r(ue,Ee)};g($e,ue=>{t().waitMode==="Free"&&ue(ee)})}r(De,Ne)};g(U,De=>{e(d).column===5&&De(_e)},!0)}r(P,V)};g(Ce,P=>{e(d).column===3?P(je):P(fe,!1)},!0)}r(q,be)};g(k,q=>{e(d).column===1?q(re):q(u,!1)})}r(j,N)};g(oe,j=>{e(d).row===3&&j(w)})}r($,Z)},Ie=$=>{var Z=Te(),oe=L(Z);{var w=N=>{var k=Er();const re=ye(()=>e(ce).find(V=>V.to===e(d)));var u=L(k);{var q=V=>{var U=Sr(),_e=a(U);Dt(_e,{get entity(){return e(re).entity},state:"Disabled",dummyActionInfos:[],cardActionResolve:void 0}),f(()=>Ae(U,`card_animation_receiver ${e(d).cellType??""} svelte-1ycsdg6`)),te(1,U,()=>Q,()=>({key:e(re).entity.seq})),r(V,U)};g(u,V=>{e(re)&&e(re).index==="Top"&&V(q)})}var be=s(u,2);ne(be,1,()=>e(d).visibleEntities,de,(V,U)=>{var _e=Te(),De=L(_e);{var Ne=$e=>{var ee=Mr(),ue=a(ee);const Ee=ye(()=>pe(e(U))),x=ye(()=>e(O).filter(D=>D.action.entity===e(U)));Dt(ue,{get entity(){return e(U)},get state(){return e(Ee)},get dummyActionInfos(){return e(x)},cardActionResolve:void 0,get selectedList(){return v()},set selectedList(D){v(D)},$$legacy:!0}),te(2,ee,()=>Me,()=>({key:e(U).seq})),r($e,ee)};g(De,$e=>{e(ce).every(ee=>ee.entity.seq!==e(U).seq)&&$e(Ne)})}r(V,_e)});var Ce=s(be,2);{var je=V=>{var U=jr(),_e=a(U);Dt(_e,{get entity(){return e(re).entity},state:"Disabled",dummyActionInfos:[],cardActionResolve:void 0}),f(()=>Ae(U,`card_animation_receiver ${e(d).cellType??""} svelte-1ycsdg6`)),te(1,U,()=>Q,()=>({key:e(re).entity.seq})),r(V,U)};g(Ce,V=>{e(re)&&e(re).index!=="Top"&&V(je)})}var fe=s(Ce,2);{var P=V=>{var U=Tr();r(V,U)};g(fe,V=>{e(d).owner.seat==="Below"&&V(P)})}r(N,k)},j=N=>{var k=Pr();const re=ye(()=>e(ce).find(U=>U.to===e(d)));var u=L(k);{var q=U=>{var _e=qr(),De=a(_e);Dt(De,{get entity(){return e(re).entity},state:"Disabled",dummyActionInfos:[],cardActionResolve:void 0}),te(1,_e,()=>Q,()=>({key:e(re).entity.seq})),r(U,_e)};g(u,U=>{e(re)&&e(re).index!=="Top"&&U(q)})}var be=s(u,2);{var Ce=U=>{var _e=Ir(),De=L(_e);ne(De,1,()=>e(d).visibleEntities.map((ee,ue)=>({index:ue,entity:ee})).toReversed(),de,(ee,ue)=>{var Ee=Te(),x=L(Ee);{var D=E=>{var me=Yr();const Be=ye(()=>!e(d).isStackCell&&e(ue).index===0?pe(...e(d).visibleEntities):void 0);var Ue=L(me);{var K=He=>{var Ve=Ar();r(He,Ve)};g(Ue,He=>{e(Y).includes(e(ue).entity)&&He(K)})}var we=s(Ue,2),qe=a(we);const Ke=ye(()=>e(ue).index===0?e(O).filter(He=>e(d).visibleEntities.includes(He.action.entity)):void 0);Dt(qe,{get entity(){return e(ue).entity},get state(){return e(Be)},get dummyActionInfos(){return e(Ke)},cardActionResolve:void 0,get selectedList(){return v()},set selectedList(He){v(He)},$$legacy:!0}),f(()=>Ae(we,`duel_card_wrapper ${(e(ue).entity.exist?"duel_card_wrapper_exists":"")??""} svelte-1ycsdg6`)),te(2,we,()=>Me,()=>({key:e(ue).entity.seq})),r(E,me)};g(x,E=>{e(ce).every(me=>me.entity.seq!==e(ue).entity.seq)&&E(D)})}r(ee,Ee)});var Ne=s(De,2);{var $e=ee=>{var ue=Nr(),Ee=a(ue),x=s(Ee);ne(x,1,()=>oa(e(d).visibleEntities[0].status.maxCounterQty),de,(D,E)=>{var me=Br(),Be=L(me),Ue=s(Be);{var K=we=>{var qe=st();f(()=>p(qe,`/${e(d).visibleEntities[0].status.maxCounterQty[e(E)]??""}`)),r(we,qe)};g(Ue,we=>{(e(d).visibleEntities[0].status.maxCounterQty[e(E)]??9999)<100&&we(K)})}f((we,qe)=>p(Be,`【
              ${we??""}${qe??""} `),[()=>Wa(e(E)),()=>e(d).visibleEntities[0].counterHolder.getQty(e(E))],ye),r(D,me)}),f(()=>p(Ee,`【${e(d).visibleEntities[0].battlePositionName??""}】 `)),r(ee,ue)};g(Ne,ee=>{e(d).visibleEntities[0].battlePosition&&ee($e)})}r(U,_e)};g(be,U=>{e(d).visibleEntities.length>0&&U(Ce)})}var je=s(be,2);{var fe=U=>{var _e=Fr(),De=a(_e);f(()=>p(De,e(d).visibleEntities.length)),r(U,_e)};g(je,U=>{e(d).isStackCell&&U(fe)})}var P=s(je,2);{var V=U=>{var _e=Hr(),De=a(_e);Dt(De,{get entity(){return e(re).entity},state:"Disabled",dummyActionInfos:[],cardActionResolve:void 0}),te(1,_e,()=>Q,()=>({key:e(re).entity.seq})),r(U,_e)};g(P,U=>{e(re)&&e(re).index==="Top"&&U(V)})}r(N,k)};g(oe,N=>{e(d).cellType==="Hand"?N(w):N(j,!1)},!0)}r($,Z)};g(R,$=>{e(d).isDisabledCell?$(se):$(Ie,!1)})}f($=>{Ae(W,`${`duel_field_cell duel_field_cell_${e(d).cellType} ${e(d).linkArrowSources.length===0?"":"duel_field_cell_linked"}`??""} svelte-1ycsdg6`),pt(W,"colspan",e(d).cellType==="Hand"?7:1),Ae(T,`${$??""} svelte-1ycsdg6`)},[()=>`duel_field_cell_inner_box ${e(d).cellType} ${e(C)?"can_accept_drop":""} ${G()?"can_action":""} ${e(B)?"is_selected":e(M)?"is_selectable":""} `],ye),ke("dragover",T,ie),ke("drop",T,le),r(n,W),ot()}Ba(["click"]);var Lr=l('<div class="title svelte-14z6bdh"> </div>'),Rr=l('<div class="title svelte-14z6bdh"> </div>'),Wr=l('<div class="duel_log_chain_number svelte-14z6bdh"> </div>'),Kr=l("<div><!></div>"),zr=l('<div><div style="display: flex;    justify-content: space-between;"><div style=" white-space: nowrap;text-align: center;"> </div> <!></div> <!></div>'),Gr=l("<div><!> <!></div>"),Xr=l("<div><!> <!></div>"),Vr=l('<div class="duel_log svelte-14z6bdh"><div class="duel_log_header svelte-14z6bdh"></div> <div class="duel_log_body svelte-14z6bdh"></div> <div class="duel_log_footer svelte-14z6bdh"></div></div>');function Qr(n,i){it(i,!1);let t=xe(void 0),c=We(i,"log",8),_,v=xe([]);const m=()=>{const b=((_==null?void 0:_.seq)??-1)+1;c().records.slice(b).forEach(o=>{if(!_){y(v,[[[[o]]]]),_=o;return}if(!e(v)[o.clock.turn]){Re(v,e(v)[o.clock.turn]=[[[o]]]),_=o;return}if(!e(v)[o.clock.turn][o.clock.phaseSeq]){Re(v,e(v)[o.clock.turn][o.clock.phaseSeq]=[[o]]),_=o;return}if(_.clock.chainSeq===o.clock.chainSeq&&_.clock.chainBlockSeq===o.clock.chainBlockSeq&&_.duelist===o.duelist){e(v)[o.clock.turn][o.clock.phaseSeq].slice(-1)[0].push(o),_=o;return}e(v)[o.clock.turn][o.clock.phaseSeq].push([o]),_=o}),y(v,e(v)),Ka().then(()=>e(t)&&e(t).scroll(0,e(t).clientHeight*990))};c().onUpdate.append(m),c().duel.view.onDuelUpdate.append(m),m(),lt();var d=Te(),S=L(d);{var I=b=>{var o=Vr(),O=s(a(o),2);ne(O,5,()=>e(v),de,(A,z)=>{var Y=Xr(),B=a(Y);{var M=ve=>{var Ye=Lr(),C=a(Ye);f(()=>p(C,`ターン：${e(z)[0][0][0].clock.turn??""}`)),r(ve,Ye)};g(B,ve=>{e(z)[0][0][0].clock.turn>0&&ve(M)})}var J=s(B,2);ne(J,1,()=>e(z),de,(ve,Ye)=>{var C=Gr(),h=a(C);{var F=Me=>{var Q=Rr(),ce=a(Q);f(()=>p(ce,e(Ye)[0][0].clock.period.name)),r(Me,Q)};g(h,Me=>{e(Ye)[0][0].clock.turn>0&&Me(F)})}var ae=s(h,2);ne(ae,1,()=>e(Ye),de,(Me,Q)=>{var ce=zr();const X=ye(()=>{var W;return((W=e(Q).find(T=>T.chainNumber!==void 0))==null?void 0:W.chainNumber)??0});var he=a(ce),G=a(he),H=a(G),ie=s(G,2);{var le=W=>{var T=Wr(),R=a(T);f(()=>p(R,`チェーン：${e(X)??""}`)),r(W,T)};g(ie,W=>{e(X)&&W(le)})}var pe=s(he,2);ne(pe,1,()=>e(Q),de,(W,T)=>{var R=Kr(),se=a(R);{var Ie=Z=>{var oe=st();f(()=>p(oe,e(T).text)),r(Z,oe)},$=Z=>{var oe=Te(),w=L(oe);{var j=k=>{var re=st();f((u,q,be)=>p(re,`移動：${u??""} ${q??""} ⇒ ${be??""}`),[()=>{var u;return(u=e(T).mainEntity)==null?void 0:u.toString()},()=>{var u;return(u=e(T).from)==null?void 0:u.toString()},()=>{var u;return(u=e(T).to)==null?void 0:u.toString()}],ye),r(k,re)},N=k=>{var re=Te(),u=L(re);{var q=Ce=>{var je=st();f((fe,P)=>p(je,`生成：${fe??""} void ⇒ ${P??""}`),[()=>{var fe;return(fe=e(T).mainEntity)==null?void 0:fe.toString()},()=>{var fe;return(fe=e(T).to)==null?void 0:fe.toString()}],ye),r(Ce,je)},be=Ce=>{var je=Te(),fe=L(je);{var P=U=>{var _e=st();f((De,Ne)=>p(_e,`消滅：${De??""} ${Ne??""} ⇒ void`),[()=>{var De;return(De=e(T).mainEntity)==null?void 0:De.toString()},()=>{var De;return(De=e(T).from)==null?void 0:De.toString()}],ye),r(U,_e)},V=U=>{var _e=st();f(()=>p(_e,e(T).text)),r(U,_e)};g(fe,U=>{e(T).type==="EntityDisappear"?U(P):U(V,!1)},!0)}r(Ce,je)};g(u,Ce=>{e(T).type==="EntityAppear"?Ce(q):Ce(be,!1)},!0)}r(k,re)};g(w,k=>{e(T).type==="EntityMove"?k(j):k(N,!1)},!0)}r(Z,oe)};g(se,Z=>{e(T).type==="ChainBlockHeader"?Z(Ie):Z($,!1)})}f(Z=>Ae(R,`duel_log_record duel_log_record_${Z??""} svelte-14z6bdh`),[()=>e(T).type.toSnakeCase()],ye),r(W,R)}),f(()=>{var W,T,R;Ae(ce,`duel_log_block_duelist duel_log_block_duelist_${((W=e(Q)[0].duelist)==null?void 0:W.seat)??"system"} svelte-14z6bdh`),Ae(G,`duelist ${((T=e(Q)[0].duelist)==null?void 0:T.seat)??""} svelte-14z6bdh`),p(H,((R=e(Q)[0].duelist)==null?void 0:R.profile.name)||"SYSTEM")}),r(Me,ce)}),f(()=>Ae(C,`duel_log_block_phase duel_log_block_phase_${e(Ye)[0][0].clock.period.key??""} svelte-14z6bdh`)),r(ve,C)}),f(()=>Ae(Y,`duel_log_block_turn duel_log_block_turn_${e(z)[0][0][0].clock.turn??""} svelte-14z6bdh`)),r(A,Y)}),za(O,A=>y(t,A),()=>e(t)),r(b,o)};g(S,b=>{(c().duel.view.infoBoardState==="Log"||c().duel.view.infoBoardState==="Default")&&b(I)})}r(n,d),ot()}var Zr=l("<div><div> </div> <div> </div></div>");function Aa(n,i){it(i,!1);let t=We(i,"duelist",12),c=xe(0),_=xe();const v=async()=>{const O=t().lp-e(c);if(!e(_)||Math.abs(O)<10){y(c,t().lp),e(_)&&(e(_)(),y(_,void 0));return}y(c,e(c)+Math.floor(Math.random()*O)),await $t(100),v()},m=()=>{t(t()),!e(_)&&t().lp!==e(c)&&new Promise(O=>{y(_,O),Math.abs(t().lp-e(c)),v()})};t().duel.log.onUpdate.append(m),v(),lt();var d=Zr(),S=a(d),I=a(S),b=s(S,2),o=a(b);f(O=>{Ae(d,`duelist duelist_${O??""} svelte-1sy3trd`),Ae(S,`duelist_name duelist_${O??""}_name svelte-1sy3trd`),p(I,t().profile.name),Ae(b,`duelist_lp ${(e(_)?"vibration":"")??""} svelte-1sy3trd`),p(o,e(c))},[()=>t().seat.toLowerCase()],ye),r(n,d),ot()}const Jr=(n,i,t)=>(i(i()==="Normal"?"Debug":"Normal"),console.info(t()),!0);var es=l('<div class="duel_card_info_row svelte-19vwcsh" style=" justify-content: space-between;"><div class="svelte-19vwcsh"> </div> <div class="svelte-19vwcsh"> </div></div>'),ts=l('<div></div> <div class="svelte-19vwcsh"> </div>',1),as=l("<div> </div>"),rs=l("<div> </div>"),ss=l('<div class="duel_card_info_row svelte-19vwcsh"><!> <!></div> <div class="duel_card_info_row svelte-19vwcsh"></div>',1),is=l('<div class="duel_card_row svelte-19vwcsh"><div class="svelte-19vwcsh"></div> <div class="svelte-19vwcsh"> </div></div>'),ls=l('<div class="duel_card_row svelte-19vwcsh"><div class="svelte-19vwcsh"></div> <div class="svelte-19vwcsh"> </div></div>'),os=l("<!> <!>",1),ns=l('<div class="duel_card_info_row svelte-19vwcsh" style="border-style: solid; border-width: 1px;"><pre class="description svelte-19vwcsh"> </pre></div>'),vs=l('<!> <div class="duel_card_info_row svelte-19vwcsh"><pre class="description svelte-19vwcsh"> </pre></div>',1),ds=l("[ <!> ],",1),cs=l('<div class="svelte-19vwcsh"> <!></div>'),_s=l('<div class="svelte-19vwcsh"> </div> <!> <div class="svelte-19vwcsh"></div>',1),us=l('<div class="svelte-19vwcsh"> </div>'),fs=l('<div class="svelte-19vwcsh"> </div>'),ps=l('<div class="svelte-19vwcsh"> </div>'),ms=l('<div class="svelte-19vwcsh"> </div>'),gs=l('<div class="svelte-19vwcsh"> </div>'),hs=l('<div class="svelte-19vwcsh"> </div>'),bs=l('<div class="duel_card_info_row svelte-19vwcsh"><div class="svelte-19vwcsh"><!> <div class="svelte-19vwcsh"></div> <!> <div class="svelte-19vwcsh"></div> <div class="svelte-19vwcsh"></div> <!> <div class="svelte-19vwcsh"></div> <div class="svelte-19vwcsh"></div> <!> <div class="svelte-19vwcsh"></div> <div class="svelte-19vwcsh"></div> <!> <div class="svelte-19vwcsh"></div> <div class="svelte-19vwcsh"></div> <!> <div class="svelte-19vwcsh"></div> <div class="svelte-19vwcsh"></div> <!> <div class="svelte-19vwcsh"></div> <div class="svelte-19vwcsh"></div> <div class="svelte-19vwcsh"> </div> <div class="svelte-19vwcsh"> </div> <div class="svelte-19vwcsh"> </div> <div class="svelte-19vwcsh"></div></div></div>'),ys=l('<div class="svelte-19vwcsh">※テスト用カードです</div>'),ws=l('<div class="duel_card_info_links svelte-19vwcsh"><a target="_blank" rel="noopener noreferrer" title="遊戯王カードWiki" class="svelte-19vwcsh">⇒遊戯王カードWiki</a> <a target="_blank" rel="noopener noreferrer" title="コナミカードデータベース" class="svelte-19vwcsh"> </a></div>'),ks=l('<div role="contentinfo"><div class="duel_card_info_header svelte-19vwcsh"><div class="duel_card_info_row svelte-19vwcsh"><div class="svelte-19vwcsh"> </div></div> <div class="duel_card_info_row svelte-19vwcsh" style="position:sticky; top:0;"><div class="svelte-19vwcsh"> </div> <div class="svelte-19vwcsh"> </div></div> <!></div> <div class="duel_card_info_body svelte-19vwcsh"><!></div> <div class="duel_card_info_footer svelte-19vwcsh"><!></div></div>');function xs(n,i){it(i,!1);let t=We(i,"entity",8,void 0);const c=()=>t()?gt[t().origin.name]:void 0,_=()=>{var I;return t()&&(t().origin.cardId??!1)?`https://www.db.yugioh-card.com/yugiohdb/card_search.action?ope=2&cid=${t().origin.cardId}`:`https://www.db.yugioh-card.com/yugiohdb/card_search.action?ope=1&sess=1&rp=10&mode=&sort=1&keyword=${(I=c())==null?void 0:I.name}&stype=1&ctype=&othercon=2&starfr=&starto=&pscalefr=&pscaleto=&linkmarkerfr=&linkmarkerto=&link_m=2&atkfr=&atkto=&deffr=&defto=&releaseDStart=1&releaseMStart=1&releaseYStart=1999&releaseDEnd=&releaseMEnd=&releaseYEnd=`};let v=We(i,"mode",12,"Normal");lt();var m=Te(),d=L(m);{var S=I=>{var b=ks();b.__contextmenu=[Jr,v,t];var o=a(b),O=a(o),A=a(O),z=a(A),Y=s(O,2),B=a(Y),M=a(B),J=s(B,2),ve=a(J),Ye=s(Y,2);{var C=G=>{var H=os(),ie=L(H);{var le=R=>{var se=es(),Ie=a(se),$=a(Ie),Z=s(Ie,2),oe=a(Z);f(()=>{p($,`◀ ${t().psL??""}`),p(oe,`${t().psR??""} ▶`)}),r(R,se)};g(ie,R=>{var se;(se=t().status.monsterCategories)!=null&&se.includes("Pendulum")&&R(le)})}var pe=s(ie,2);{var W=R=>{var se=ss(),Ie=L(se),$=a(Ie);ne($,1,()=>t().attr,de,(w,j)=>{var N=ts(),k=L(N),re=s(k,2),u=a(re);f(()=>{Ae(k,`monster_attr ${e(j)??""} svelte-19vwcsh`),p(u,`${na[e(j)]??""}属性`)}),r(w,N)});var Z=s($,2);ne(Z,1,()=>t().types,de,(w,j)=>{var N=as(),k=a(N);f(()=>{Ae(N,`monster_cat ${e(j)??""} svelte-19vwcsh`),p(k,`${Xt[e(j)]??""}${va[e(j)]??""}族`)}),r(w,N)});var oe=s(Ie,2);ne(oe,5,()=>t().status.monsterCategories??[],de,(w,j)=>{var N=rs(),k=a(N);f(()=>{Ae(N,`monster_cat ${e(j)??""} svelte-19vwcsh`),p(k,`${Vt[e(j)]??""}${da[e(j)]??""}`)}),r(w,N)}),r(R,se)},T=R=>{var se=Te(),Ie=L(se);{var $=oe=>{var w=is(),j=s(a(w),2),N=a(j);f(()=>p(N,`${Qt[t().status.spellCategory]??""}魔法`)),r(oe,w)},Z=oe=>{var w=Te(),j=L(w);{var N=k=>{var re=ls(),u=s(a(re),2),q=a(u);f(()=>p(q,`${Zt[t().status.trapCategory]??""}罠`)),r(k,re)};g(j,k=>{t().kind==="Trap"&&t().status.trapCategory&&k(N)},!0)}r(oe,w)};g(Ie,oe=>{t().kind==="Spell"&&t().status.spellCategory?oe($):oe(Z,!1)},!0)}r(R,se)};g(pe,R=>{t().kind==="Monster"?R(W):R(T,!1)})}r(G,H)};g(Ye,G=>{v()==="Normal"&&G(C)})}var h=s(o,2),F=a(h);{var ae=G=>{var H=vs(),ie=L(H);{var le=R=>{var se=ns(),Ie=a(se),$=a(Ie);f(()=>p($,gt[t().origin.name].pendulumDescription)),r(R,se)};g(ie,R=>{var se;(se=t().status.monsterCategories)!=null&&se.includes("Pendulum")&&R(le)})}var pe=s(ie,2),W=a(pe),T=a(W);f(R=>p(T,R),[()=>{var R;return(R=c())==null?void 0:R.description}],ye),r(G,H)},Me=G=>{var H=bs(),ie=a(H),le=a(ie);ne(le,0,()=>["info","status"],de,($e,ee)=>{var ue=_s(),Ee=L(ue),x=a(Ee),D=s(Ee,2);ne(D,1,()=>Object.entries(t()[ee]),de,(me,Be)=>{let Ue=()=>e(Be)[0],K=()=>e(Be)[1];var we=cs(),qe=a(we),Ke=s(qe);{var He=Ze=>{var et=ds(),Xe=s(L(et));ne(Xe,1,K,de,(Se,Le)=>{var Fe=st();f(tt=>p(Fe,`${tt??""},`),[()=>e(Le).toString()],ye),r(Se,Fe)}),r(Ze,et)},Ve=Ze=>{var et=st();f(Xe=>p(et,`${Xe??""},`),[()=>{var Xe;return(Xe=K())==null?void 0:Xe.toString()}],ye),r(Ze,et)};g(Ke,Ze=>{Array.isArray(K())?Ze(He):Ze(Ve,!1)})}f(()=>p(qe,`"${Ue()??""}" : `)),r(me,we)});var E=s(D,2);E.textContent="},",f(()=>p(x,`"${ee??""}" :{`)),r($e,ue)});var pe=s(le,2);pe.textContent='"actions" :[';var W=s(pe,2);ne(W,1,()=>t().actions,de,($e,ee)=>{var ue=us(),Ee=a(ue);f(()=>p(Ee,`"${e(ee).playType??""} ${e(ee).title??""}",`)),r($e,ue)});var T=s(W,2);T.textContent="],";var R=s(T,2);R.textContent='"substituteEffects" :[';var se=s(R,2);ne(se,1,()=>t().substituteEffects,de,($e,ee)=>{var ue=fs(),Ee=a(ue);f(()=>p(Ee,`"${e(ee).title??""}",`)),r($e,ue)});var Ie=s(se,2);Ie.textContent="],";var $=s(Ie,2);$.textContent='"continuousEffects" :[';var Z=s($,2);ne(Z,1,()=>t().continuousEffects,de,($e,ee)=>{var ue=ps(),Ee=a(ue);f(()=>p(Ee,`"${e(ee).isStarted??""}",`)),r($e,ue)});var oe=s(Z,2);oe.textContent="],";var w=s(oe,2);w.textContent='"procFilters" :[';var j=s(w,2);ne(j,1,()=>t().procFilterBundle.operators,de,($e,ee)=>{var ue=ms(),Ee=a(ue);f(x=>p(Ee,`"${x??""} ${e(ee).title??""} ${e(ee).isEffective??""} ",`),[()=>e(ee).isSpawnedBy.toString()],ye),r($e,ue)});var N=s(j,2);N.textContent="],";var k=s(N,2);k.textContent='"numericStateOperators" :[';var re=s(k,2);ne(re,1,()=>t().numericOprsBundle.operators,de,($e,ee)=>{var ue=gs(),Ee=a(ue);f(x=>p(Ee,`"${x??""} ${e(ee).title??""} ${e(ee).isEffective??""} ${e(ee).isContinuous??""} ${e(ee).targetState??""} ${e(ee).targetStateGen??""} ",`),[()=>e(ee).isSpawnedBy.toString()],ye),r($e,ue)});var u=s(re,2);u.textContent="],";var q=s(u,2);q.textContent='"stateOperators" :[';var be=s(q,2);ne(be,1,()=>t().statusOperatorBundle.operators,de,($e,ee)=>{var ue=hs(),Ee=a(ue);f(x=>p(Ee,`"${x??""} ${e(ee).title??""} ${e(ee).isEffective??""} ",`),[()=>e(ee).isSpawnedBy.toString()],ye),r($e,ue)});var Ce=s(be,2);Ce.textContent="],";var je=s(Ce,2);je.textContent='"lastMoveLogRecord" :{';var fe=s(je,2),P=a(fe),V=s(fe,2),U=a(V),_e=s(V,2),De=a(_e),Ne=s(_e,2);Ne.textContent="},",f(($e,ee)=>{p(P,`"movedBy":"${$e??""}",`),p(U,`"movedAs":"${ee??""}",`),p(De,`"movedAt":"${t().moveLog.latestRecord.movedAt.totalProcSeq??""}",`)},[()=>{var $e;return($e=t().moveLog.latestRecord.movedBy)==null?void 0:$e.toString()},()=>t().moveLog.latestRecord.movedAs.join(" ")],ye),r(G,H)};g(F,G=>{v()==="Normal"?G(ae):G(Me,!1)})}var Q=s(h,2),ce=a(Q);{var X=G=>{var H=ys();r(G,H)},he=G=>{var H=ws(),ie=a(H),le=s(ie,2),pe=a(le);f(W=>{var T;pt(ie,"href",`https://yugioh-wiki.net/index.php?${t().origin.wikiEncodedName}`),pt(le,"href",W),p(pe,`⇒${((T=t())!=null&&T.origin.cardId?"公式カードページ":"公式で検索")??""}`)},[_],ye),r(G,H)};g(ce,G=>{var H;(H=t())!=null&&H.origin.isForTest?G(X):G(he,!1)})}f((G,H,ie)=>{Ae(b,`duel_card duel_card_info ${t().origin.kind??""} ${G??""} svelte-19vwcsh`),p(z,t().nm),p(M,H),p(ve,ie)},[()=>{var G;return(G=t().origin.monsterCategories)==null?void 0:G.join(" ")},()=>"★".repeat(t().lvl||0),()=>"☆".repeat(t().rank||0)],ye),r(I,b)};g(d,I=>{t()&&I(S)})}r(n,m),ot()}Ba(["contextmenu"]);var Cs=l('<div class="duel_field_cell_info_item svelte-1xj7qf1"><!></div>'),Ds=l('<div class="duel_field_cell_info_box svelte-1xj7qf1"><div class="duel_field_cell_info_label svelte-1xj7qf1"> </div> <!></div>'),$s=l('<div class="duel_field_cell_info svelte-1xj7qf1"><div class="duel_field_cell_info_header item_btn svelte-1xj7qf1"><div class="svelte-1xj7qf1"> </div> <div class="svelte-1xj7qf1"> </div></div> <div class="duel_field_cell_info_body svelte-1xj7qf1"></div></div>');function Ss(n,i){it(i,!1);let t=We(i,"cell",12);const c=()=>{t(t())},_=S=>t().cardEntities.filter(I=>I.face===S);t().field.duel.view.onDuelUpdate.append(c),lt();var v=Te(),m=L(v);{var d=S=>{var I=$s(),b=a(I),o=a(b),O=a(o),A=s(o,2),z=a(A),Y=s(b,2);ne(Y,4,()=>["FaceUp","FaceDown"],de,(B,M)=>{var J=Te(),ve=L(J);{var Ye=C=>{var h=Ds(),F=a(h),ae=a(F),Me=s(F,2);ne(Me,1,()=>_(M).toSorted(Ga),de,(Q,ce)=>{var X=Cs(),he=a(X);const G=ye(()=>t().owner===t().field.duel.duelists.Below);Dt(he,{get entity(){return e(ce)},get isVisibleForcibly(){return e(G)},isWideMode:!0,cardActionResolve:void 0}),r(Q,X)}),f(()=>p(ae,M==="FaceUp"?"表向き":"裏向き")),r(C,h)};g(ve,C=>{_(M).length&&C(Ye)})}r(B,J)}),f(()=>{var B;p(O,(B=t().owner)==null?void 0:B.profile.name),p(z,t().cellType)}),r(S,I)};g(m,S=>{t().field.duel.view.infoBoardState==="CellInfo"&&S(d)})}r(n,v),ot()}var Ms=l('<div class="duel_config_item svelte-y4u26k"><label class="toggle svelte-y4u26k"><input type="checkbox" class="svelte-y4u26k"></label> <span class="svelte-y4u26k"> </span></div>'),js=l('<div class="duel_config svelte-y4u26k"><div class="duel_config_title svelte-y4u26k">デュエル設定</div> <div class="duel_config_group svelte-y4u26k"><div class="duel_config_group_title svelte-y4u26k">チェーン設定</div> <!></div></div>');function Ts(n,i){it(i,!1);let t=We(i,"viewController",8),c=We(i,"userProfile",12);lt();var _=Te(),v=L(_);{var m=d=>{var S=js(),I=s(a(S),2),b=s(a(I),2);ne(b,1,()=>Qa,de,(o,O)=>{var A=Ms(),z=a(A),Y=a(z),B=s(z,2),M=a(B);f(()=>p(M,Xa[e(O)])),Va(Y,()=>c().chainConfig[e(O)],J=>c(c().chainConfig[e(O)]=J,!0)),ke("change",Y,()=>c().save()),r(o,A)}),r(d,S)};g(v,d=>{t().infoBoardState==="Config"&&d(m)})}r(n,_),ot()}function Es(n,{from:i,to:t},c={}){var{delay:_=0,duration:v=h=>Math.sqrt(h)*120,easing:m=sa}=c,d=getComputedStyle(n),S=d.transform==="none"?"":d.transform,[I,b]=d.transformOrigin.split(" ").map(parseFloat);I/=n.clientWidth,b/=n.clientHeight;var o=qs(n),O=n.clientWidth/t.width/o,A=n.clientHeight/t.height/o,z=i.left+i.width*I,Y=i.top+i.height*b,B=t.left+t.width*I,M=t.top+t.height*b,J=(z-B)*O,ve=(Y-M)*A,Ye=i.width/t.width,C=i.height/t.height;return{delay:_,duration:typeof v=="function"?v(Math.sqrt(J*J+ve*ve)):v,easing:m,css:(h,F)=>{var ae=F*J,Me=F*ve,Q=h+F*Ye,ce=h+F*C;return`transform: ${S} translate(${ae}px, ${Me}px) scale(${Q}, ${ce});`}}}function qs(n){if("currentCSSZoom"in n)return n.currentCSSZoom;for(var i=n,t=1;i!==null;)t*=+getComputedStyle(i).zoom,i=i.parentElement;return t}var As=l('<div class="chain_number svelte-d2f52m"> </div>'),Ys=l('<div class="duel_card_row svelte-d2f52m"> </div>'),Bs=l('<div class="appendix svelte-d2f52m"> </div>'),Ns=l('<div class="appendix_wrapper svelte-d2f52m"></div>'),Is=l('<div><div><!> <div> </div> <div><!> <div class="duel_card_row svelte-d2f52m"><div> </div> <!></div></div></div></div>'),Fs=l("<div></div>");function Hs(n,i){it(i,!1);let t=We(i,"duel",8),c=We(i,"position",8,"left");const _=-100,v=()=>c()==="left"?-100:100;let m=xe([]),d=Promise.resolve(),S=Promise.resolve();const I=1e3,b=500,o=400,O=z=>{const Y={...z};Y.isKnown=z.chainBlockInfo.action.entity.controller.duelistType==="Player"||z.chainBlockInfo.action.entity.face==="FaceUp",Y.chainBlockInfo.onStateChange.append(B=>{if(B==="done"||B==="failed"||B==="nagated")return d=d.then(async()=>{const M=new Date().getTime()-Y.chainBlockInfo.wasSpawnedAt.getTime();M<I&&await $t(I-M),y(m,e(m).filter(J=>J.seq!==Y.seq)),await $t(b+o)}).then(),"RemoveMe";y(m,e(m))}),S=S.then(async()=>{y(m,[Y,...e(m)].sort((B,M)=>Za.isSameChain(B.clock,M.clock)&&B.chainBlockInfo.action.isWithChainBlock&&M.chainBlockInfo.action.isWithChainBlock?M.clock.totalProcSeq-B.clock.totalProcSeq:B.clock.totalProcSeq-M.clock.totalProcSeq)),await $t(300)}),d=d.then(()=>$t(1e3))};t().chainBlockLog.onInsert.append(O),lt();var A=Fs();ne(A,13,()=>e(m),z=>z.seq,(z,Y)=>{var B=Is();const M=ye(()=>{const{activator:H,action:ie,appendix:le}=e(Y).chainBlockInfo;return{activator:H,action:ie,appendix:le}});var J=a(B),ve=a(J);{var Ye=H=>{var ie=As(),le=a(ie);f(()=>p(le,`チェーン：${e(Y).chainBlockInfo.chainNumber??""}`)),r(H,ie)};g(ve,H=>{e(Y).chainBlockInfo.chainNumber&&H(Ye)})}var C=s(ve,2),h=a(C),F=s(C,2),ae=a(F);{var Me=H=>{var ie=Ys(),le=a(ie);f(()=>p(le,e(Y).isKnown?e(M).action.entity.nm:"？？？")),r(H,ie)};g(ae,H=>{(e(M).action.entity.entityType==="Card"||e(M).action.entity.entityType==="Token")&&H(Me)})}var Q=s(ae,2),ce=a(Q),X=a(ce),he=s(ce,2);{var G=H=>{var ie=Ns();ne(ie,5,()=>e(M).appendix,de,(le,pe)=>{var W=Bs(),T=a(W);f(()=>p(T,e(pe))),r(le,W)}),r(H,ie)};g(he,H=>{e(M).appendix&&H(G)})}f((H,ie,le)=>{Ae(B,`cut_in_row ${(!e(Y).chainBlockInfo.chainNumber||e(Y).chainBlockInfo.chainNumber===1?"cut_in_row_first":"")??""} svelte-d2f52m`),Ae(J,`cut_in_item cut_in_item_${H??""} cut_in_item_${e(Y).chainBlockInfo.state??""} svelte-d2f52m`),Ae(C,`duelist_name duelist_${H??""}_name svelte-d2f52m`),p(h,e(M).activator.profile.name),Ae(F,`duel_card duel_card_${H??""} ${ie??""} ${(e(Y).isKnown?e(M).action.entity.origin.kind:"")??""} ${e(M).action.entity.entityType??""}  svelte-d2f52m`),p(X,le)},[()=>e(M).activator.seat.toLowerCase(),()=>e(Y).isKnown?(e(M).action.entity.status.monsterCategories??[]).join(" "):"Token",()=>e(M).action.toString()],ye),te(3,J,()=>yr,()=>new Date().getTime()-e(Y).chainBlockInfo.wasSpawnedAt.getTime()<I?{x:v(),duration:o}:{y:_,duration:o}),Ja(B,()=>Es,()=>({duration:b})),r(z,B)}),f(()=>Ae(A,`cut_in_container cut_in_container_${c()??""} svelte-d2f52m`)),r(n,A),ot()}const Ps=wr({duration:400});var Us=l('<div class="duel_desk_left v_flex svelte-1i63tk9"><!> <!> <!></div>'),Os=l('<button class="duel_field_header_message svelte-1i63tk9"> </button> <div class="duel_field_header_buttons svelte-1i63tk9"><button class="svelte-1i63tk9">サレンダー</button></div>',1),Ls=l("<tr></tr>"),Rs=l('<table class="duel_field svelte-1i63tk9"><tbody class="svelte-1i63tk9"></tbody></table>'),Ws=l('<button class="svelte-1i63tk9">OK</button>'),Ks=l('<button class="svelte-1i63tk9">cancel</button>'),zs=l("<!> <!>",1),Gs=l('<button class="svelte-1i63tk9"> </button>'),Xs=l('<div style="text-align: left;"><!> <!> <!></div>'),Vs=l('<div><!> <div class=" duel_desk_center v_flex svelte-1i63tk9"><div class="duel_field_header svelte-1i63tk9"><!></div> <div class="duel_field_body svelte-1i63tk9"><!></div> <div class="duel_field_footer svelte-1i63tk9"><!></div></div> <!></div> <div style="position:fixed;left:0;bottom:0"> </div> <!> <div><!></div>',1);function Qs(n,i){it(i,!1);let t=We(i,"duel",12),c=We(i,"userProfile",8),_=xe(0),v=xe(0),m=xe([]),d=xe([]),S=()=>{},I=xe([]),b=xe(),o=xe(),O=xe(()=>!1),A=xe(!1);const z=u=>{S=u.resolve,y(I,u.dummyActionInfos.filter(q=>q.action.entity.entityType==="Duelist").filter(q=>q.action.entity.controller.seat==="Below")),y(b,void 0),y(o,void 0),y(d,[]),y(m,[]),y(A,!1),u.entitiesChoices&&(y(b,u.entitiesChoices),y(O,()=>{var q;return((q=u.entitiesChoices)==null?void 0:q.validator(e(m)))??!1}),y(A,u.entitiesChoices.cancelable),e(b).selectables.every(q=>q.cell.isPlayFieldCell&&q.getIndexInCell()===0||q.cell.cellType==="Hand"&&q.controller.duelistType==="Player"||q.entityType==="Duelist")||t().view.modalController.entitySelector.show({title:t().view.message,position:"Middle",entitiesChoices:u.entitiesChoices,chainBlockInfos:u.chainBlockInfos,cancelable:u.entitiesChoices.cancelable}).then(q=>{S({selectedEntities:q})})),u.cellsChoices&&(y(o,u.cellsChoices),y(O,()=>{var q;return((q=u.cellsChoices)==null?void 0:q.validator(e(d)))??!1}),y(A,u.cellsChoices.cancelable))};t().view.onWaitStart.append(z);const Y=()=>{S=()=>{},y(o,void 0),y(b,void 0),y(d,[]),y(m,[]),y(O,()=>!1),y(A,!1)};t().view.onWaitEnd.append(Y);let B=xe(void 0),M=xe("Normal");const J=({card:u,mode:q})=>{y(B,u),y(M,q)};t().view.onShowCardEntity.append(J);const ve=()=>{t(t())};t().view.onDuelUpdate.append(ve),t().log.onUpdate.append(ve);const Ye=()=>{e(b)&&e(b).validator(e(m))&&S({selectedEntities:e(m)}),e(o)&&e(o).validator(e(d))&&S({selectedCells:e(d)})},C=()=>{S({})},h=u=>{S({actionInfo:u})},F=()=>{S({surrender:!0})};t().main();const ae=()=>e(_)<=1400?"compact":"wide";lt();var Me=Vs(),Q=L(Me),ce=a(Q);{var X=u=>{var q=Us(),be=a(q);Aa(be,{get duelist(){return t().duelists.Above}});var Ce=s(be,2);xs(Ce,{get entity(){return e(B)},get mode(){return e(M)}});var je=s(Ce,2);Aa(je,{get duelist(){return t().duelists.Below}}),r(u,q)};g(ce,u=>{ae()==="wide"&&u(X)})}var he=s(ce,2),G=a(he),H=a(G);{var ie=u=>{var q=Os(),be=L(q),Ce=a(be),je=s(be,2),fe=a(je);f(()=>p(Ce,`[TURN:${t().clock.turn}][PHASE:${t().phase}] ${t().view.message}`)),ke("click",be,()=>{t(t().view.infoBoardState="Log",!0)}),ke("click",fe,F),r(u,q)};g(H,u=>{t().isEnded||u(ie)})}var le=s(G,2),pe=a(le);{var W=u=>{var q=Rs(),be=a(q);ne(be,5,()=>t().field.cells,de,(Ce,je,fe)=>{var P=Ls();Ae(P,`${`duel_desk_row_${fe}`??""} svelte-1i63tk9`),ne(P,5,()=>e(je),de,(V,U,_e)=>{Or(V,{get view(){return t().view},row:fe,column:_e,get selectedEntities(){return e(m)},set selectedEntities(De){y(m,De)},get selectedCells(){return e(d)},set selectedCells(De){y(d,De)},$$legacy:!0})}),r(Ce,P)}),r(u,q)};g(pe,u=>{t().clock.turn>0&&u(W)})}var T=s(le,2),R=a(T);{var se=u=>{var q=zs(),be=L(q);{var Ce=P=>{var V=Ws();f(U=>V.disabled=U,[()=>!e(O)()],ye),ke("click",V,Ye),r(P,V)};g(be,P=>{((e(b)&&e(b).qty)??(e(o)&&e(o).qty)??9999)>1&&P(Ce)})}var je=s(be,2);{var fe=P=>{var V=Ks();ke("click",V,C),r(P,V)};g(je,P=>{e(A)&&P(fe)})}r(u,q)},Ie=u=>{var q=Te(),be=L(q);ne(be,1,()=>e(I),de,(Ce,je)=>{var fe=Gs(),P=a(fe);f(()=>p(P,e(je).action.title)),ke("click",fe,()=>h(e(je))),r(Ce,fe)}),r(u,q)};g(R,u=>{e(b)&&e(b).selectables.length||e(o)&&e(o).selectables?u(se):u(Ie,!1)})}var $=s(he,2);{var Z=u=>{var q=Xs(),be=a(q);Qr(be,{get log(){return t().log}});var Ce=s(be,2);Ss(Ce,{get cell(){return t().view.infoBoardCell}});var je=s(Ce,2);Ts(je,{get userProfile(){return c()},get viewController(){return t().view}}),f(fe=>Ae(q,`duel_desk_right duel_desk_right_${fe??""}  svelte-1i63tk9`),[()=>t().view.infoBoardState.toLowerCase()],ye),te(3,q,()=>ge,()=>({duration:e(_)>1400?0:200,axis:"x"})),r(u,q)};g($,u=>{(e(_)>1400||t().view.infoBoardState!=="Default")&&u(Z)})}var oe=s(Q,2),w=a(oe),j=s(oe,2);er(j,{get modalController(){return t().view.modalController}});var N=s(j,2),k=a(N);const re=ye(()=>ae()==="wide"?"right":"left");Hs(k,{get duel(){return t()},get position(){return e(re)}}),f((u,q)=>{Ae(Q,`flex duel_desk ${u??""}_mode svelte-1i63tk9`),p(w,q),Ae(N,`cutin ${u??""}_mode svelte-1i63tk9`)},[ae,()=>t().clock.toFullString()],ye),Wt("innerWidth",u=>y(_,u)),Wt("innerHeight",u=>y(v,u)),r(n,Me),ot()}var Zs=l('<div class="svelte-swqq02"><button class="button_style_reset svelte-swqq02" title="※shiftキー同時押しで一括外し">クリア</button></div>'),Js=l('<div class="svelte-swqq02"><button class="button_style_reset svelte-swqq02" title="※shiftキー同時押しで一括外し">クリア</button></div>'),ei=l("<div></div>"),ti=l("<!> <!> <!> <!> <!>",1),ai=l('<span> </span> / <span style="display: inline-block;width:2rem;text-align: right;"> </span>',1),ri=l('<li class="deck_editor_item svelte-swqq02"><div role="listitem"><div class="svelte-swqq02"><div class="svelte-swqq02"> </div> <div style="display:flex" class="svelte-swqq02"><div class="svelte-swqq02"><!> <!> <!></div> <div style="flex-grow: 1; width:0.1rem" class="svelte-swqq02"></div> <div class="svelte-swqq02"><!></div></div></div></div> <button class="button_style_reset svelte-swqq02" title="※shiftキー同時押しで一括投入">+</button> <button class="button_style_reset svelte-swqq02" title="※shiftキー同時押しで一括外し">-</button></li>'),si=l('<div class="deck_editor_card_kind svelte-swqq02"><div class="deck_editor_card_kind_header svelte-swqq02"><div class="svelte-swqq02"> </div> <!></div> <ul class="svelte-swqq02"></ul></div>'),ii=l('<div class="deck_editor_deck_type svelte-swqq02"><div class="deck_editor_deck_type_header svelte-swqq02"><div class="svelte-swqq02"> </div> <!></div> <!></div>'),li=l('<div class="svelte-swqq02">読み込み中...</div>'),oi=l('<div class="deck_editor_card_list svelte-swqq02"><!></div>');function Ya(n,i){it(i,!1);let t=We(i,"allCardInfos",8),c=We(i,"deckCardInfos",12),_=We(i,"mode",8),v=We(i,"onAttention",8),m=We(i,"searchCondition",8,void 0);const d={Deck:["Monster","Spell","Trap"],ExtraDeck:["Monster"]},S={Deck:{Monster:[],Spell:[],Trap:[]},ExtraDeck:{Monster:[],Spell:[],Trap:[]}},I=C=>{var h;return(h=C.monsterCategories)!=null&&h.union(Kt).length?"ExtraDeck":"Deck"},b=C=>{Object.values(S).forEach(h=>Object.values(h).forEach(F=>F.reset())),C.filter(h=>h.isImplemented).filter(h=>h.kind!=="XyzMaterial").forEach(h=>{var ae;if(h.kind==="XyzMaterial")return;const F=(ae=h.monsterCategories)!=null&&ae.union(Kt).length?"ExtraDeck":"Deck";S[F][h.kind].push(h)}),Object.values(S).forEach(h=>Object.values(h).forEach(F=>F.sort(aa)))},o=_()==="List"?new Promise(C=>{b(t()),C()}):Promise.resolve(),O=()=>(_()==="Deck"&&(b(c()),y(B,c().length)),S),A=(C,h,F)=>{c(c().filter(ae=>I(ae)!==h||ae.kind!==F&&F))},z=(C,h)=>{try{if(C.ctrlKey){c().push(h);return}const F=c().filter(Me=>Me.name===h.name).length;if(F>2)return;const ae=C.shiftKey?3-F:1;if(ae<1)return;c().push(...Array(ae).fill(h))}finally{c().sort(aa),c(c())}},Y=(C,h)=>{let F=0;c(c().filter(ae=>ae.name!==h.name?!0:(F++,!C.shiftKey&&F>1))),c().sort(aa)};let B=xe(100);const M=()=>{e(B)>t().length+c().length||(y(B,e(B)+10),$t(100).then(M))};$t(100).then(M);const J=(C,h)=>{if(!m())return!0;if(!m().cardKinds.includes(C.kind)||m().name.trim().length&&[C.name,...C.nameTags??[],...C.textTags??[]].every(ae=>!ae.includes(m().name))||C.isForTest&&!m().others.includes("test"))return!1;if(C.kind==="Monster")return C.attributes&&!m().monsterAttributes.union(C.attributes).length||C.types&&!m().monsterTypes.union(C.types).length||!C.monsterCategories?!1:C.monsterCategories.union(m().monsterCategories).length;if(C.kind==="Spell")return C.spellCategory&&m().spellCategories.includes(C.spellCategory);if(C.kind==="Trap")return C.trapCategory&&m().trapCategories.includes(C.trapCategory)};lt();var ve=oi(),Ye=a(ve);ht(Ye,()=>o,C=>{var h=li();r(C,h)},C=>{var h=Te();const F=ye(O);var ae=L(h);ne(ae,1,()=>ar,de,(Me,Q)=>{var ce=ii();const X=ye(()=>Object.values(e(F)[e(Q)]).flatMap(W=>W));var he=a(ce),G=a(he),H=a(G),ie=s(G,2);{var le=W=>{var T=Zs(),R=a(T);ke("click",R,se=>A(se,e(Q),void 0)),r(W,T)};g(ie,W=>{_()==="Deck"&&e(X).some(J)&&W(le)})}var pe=s(he,2);ne(pe,1,()=>oa(e(F)[e(Q)]).filter(W=>d[e(Q)].includes(W)),de,(W,T)=>{var R=si();const se=ye(()=>e(F)[e(Q)][e(T)].filter(J));var Ie=a(R),$=a(Ie),Z=a($),oe=s($,2);{var w=N=>{var k=Js(),re=a(k);ke("click",re,u=>A(u,e(Q),e(T))),r(N,k)};g(oe,N=>{_()==="Deck"&&e(se).length&&N(w)})}var j=s(Ie,2);ne(j,5,()=>e(se),de,(N,k,re)=>{var u=Te(),q=L(u);{var be=Ce=>{var je=ri(),fe=a(je),P=a(fe),V=a(P),U=a(V),_e=s(V,2),De=a(_e),Ne=a(De);{var $e=K=>{var we=ti(),qe=L(we);{var Ke=Se=>{var Le=st();f(()=>p(Le,`★${e(k).level??""}`)),r(Se,Le)};g(qe,Se=>{e(k).level&&Se(Ke)})}var He=s(qe,2);{var Ve=Se=>{var Le=st();f(()=>p(Le,`☆${e(k).rank??""}`)),r(Se,Le)};g(He,Se=>{e(k).rank&&Se(Ve)})}var Ze=s(He,2);ne(Ze,1,()=>e(k).attributes??[],de,(Se,Le)=>{var Fe=ei();f(()=>Ae(Fe,`monster_attr ${e(Le)??""} svelte-swqq02`)),r(Se,Fe)});var et=s(Ze,2);ne(et,1,()=>e(k).types??[],de,(Se,Le)=>{var Fe=st();f(()=>p(Fe,Xt[e(Le)])),r(Se,Fe)});var Xe=s(et,2);ne(Xe,1,()=>e(k).monsterCategories??[],de,(Se,Le)=>{var Fe=st();f(()=>p(Fe,Vt[e(Le)])),r(Se,Fe)}),r(K,we)};g(Ne,K=>{e(k).kind==="Monster"&&K($e)})}var ee=s(Ne,2);{var ue=K=>{var we=st();f(()=>p(we,`${Qt[e(k).spellCategory]??""}魔法`)),r(K,we)};g(ee,K=>{e(k).spellCategory!==void 0&&K(ue)})}var Ee=s(ee,2);{var x=K=>{var we=st();f(()=>p(we,`${Zt[e(k).trapCategory]??""}罠`)),r(K,we)};g(Ee,K=>{e(k).trapCategory!==void 0&&K(x)})}var D=s(De,4),E=a(D);{var me=K=>{var we=ai(),qe=L(we),Ke=a(qe),He=s(qe,2),Ve=a(He);f(()=>{p(Ke,e(k).attack??"?"),p(Ve,e(k).defense??"?")}),r(K,we)};g(E,K=>{e(k).kind==="Monster"&&K(me)})}var Be=s(fe,2),Ue=s(Be,2);f(K=>{Ae(fe,`${K??""} svelte-swqq02`),p(U,e(k).name)},[()=>{var K,we;return`deck_editor_card duel_card ${e(k).kind} ${(we=(K=e(k))==null?void 0:K.monsterCategories)==null?void 0:we.join(" ")} ${e(k).isImplemented?"is_implemented":"is_not_implemented"}`}],ye),ke("mouseenter",fe,()=>v()(e(k))),ke("click",Be,K=>z(K,e(k))),ke("click",Ue,K=>Y(K,e(k))),r(Ce,je)};g(q,Ce=>{re<e(B)&&Ce(be)})}r(N,u)}),f(()=>p(Z,`${Na[e(T)]??""}（${e(se).length??""} / ${e(F)[e(Q)][e(T)].length??""}枚）`)),r(W,R)}),f(W=>p(H,`${tr[e(Q)]??""}（${W??""} / ${e(X).length??""}枚）`),[()=>e(X).filter(J).length],ye),r(Me,ce)}),r(C,h)}),r(n,ve),ot()}var ni=l('<div class="duel_card_info_row svelte-rccxcp" style="position:sticky; top:0;"><div class="svelte-rccxcp"> </div> <div class="svelte-rccxcp"> </div></div>'),vi=l('<div class="duel_card_info_row svelte-rccxcp"><div class="svelte-rccxcp"><pre class="description svelte-rccxcp"> </pre></div></div> <div class="duel_card_info_row svelte-rccxcp" style=" justify-content: space-between;"><div class="svelte-rccxcp"> </div> <div class="svelte-rccxcp"> </div></div>',1),di=l('<div></div> <div class="svelte-rccxcp"> </div>',1),ci=l("<div> </div>"),_i=l("<div> </div>"),ui=l('<div class="duel_card_info_row svelte-rccxcp"><!> <!></div> <div class="duel_card_info_row svelte-rccxcp"></div>',1),fi=l('<div class="duel_card_row svelte-rccxcp"><div class="svelte-rccxcp"></div> <div class="svelte-rccxcp"> </div></div>'),pi=l('<div class="duel_card_row svelte-rccxcp"><div class="svelte-rccxcp"></div> <div class="svelte-rccxcp"> </div></div>'),mi=l('<div class="duel_card_info_row svelte-rccxcp"><div class="svelte-rccxcp">※テスト用カードです</div></div>'),gi=l('<div class="duel_card_info_links svelte-rccxcp"><a target="_blank" rel="noopener noreferrer" title="遊戯王カードWiki" class="svelte-rccxcp">⇒遊戯王カードWiki</a> <a target="_blank" rel="noopener noreferrer" title="コナミカードデータベース" class="svelte-rccxcp"> </a></div>'),hi=l('<div><div class="duel_card_info_header svelte-rccxcp"><div class="duel_card_info_row svelte-rccxcp"><div class="svelte-rccxcp"> </div></div> <!></div> <div class="duel_card_info_body svelte-rccxcp"><!> <!> <div class="duel_card_info_row description svelte-rccxcp"><div class="svelte-rccxcp"><pre class="description svelte-rccxcp"> </pre></div></div> <!></div></div>');function bi(n,i){it(i,!1);let t=We(i,"cardInfo",8,void 0);const c=()=>t()?gt[t().name]:void 0;lt();var _=Te(),v=L(_);{var m=d=>{var S=hi(),I=a(S),b=a(I),o=a(b),O=a(o),A=s(b,2);{var z=X=>{var he=ni(),G=a(he),H=a(G),ie=s(G,2),le=a(ie);f((pe,W)=>{p(H,pe),p(le,W)},[()=>"★".repeat(t().level||0),()=>"☆".repeat(t().rank||0)],ye),r(X,he)};g(A,X=>{t().kind==="Monster"&&X(z)})}var Y=s(I,2),B=a(Y);{var M=X=>{var he=vi(),G=L(he),H=a(G),ie=a(H),le=a(ie),pe=s(G,2),W=a(pe),T=a(W),R=s(W,2),se=a(R);f(()=>{p(le,gt[t().name].pendulumDescription),p(T,`◀ ${t().pendulumScaleL??""}`),p(se,`${t().pendulumScaleR??""} ▶`)}),r(X,he)};g(B,X=>{var he;(he=t().monsterCategories)!=null&&he.includes("Pendulum")&&X(M)})}var J=s(B,2);{var ve=X=>{var he=ui(),G=L(he),H=a(G);{var ie=T=>{var R=di(),se=L(R),Ie=s(se,2),$=a(Ie);f(()=>{Ae(se,`monster_attr ${t().attributes[0]??""} svelte-rccxcp`),p($,`${na[t().attributes[0]]??""}属性`)}),r(T,R)};g(H,T=>{t().attributes&&T(ie)})}var le=s(H,2);{var pe=T=>{var R=ci(),se=a(R);f(()=>{Ae(R,`monster_cat ${t().types[0]??""} svelte-rccxcp`),p(se,`${Xt[t().types[0]]??""}${va[t().types[0]]??""}族`)}),r(T,R)};g(le,T=>{t().types&&T(pe)})}var W=s(G,2);ne(W,5,()=>t().monsterCategories??[],de,(T,R)=>{var se=_i(),Ie=a(se);f(()=>{Ae(se,`monster_cat ${e(R)??""} svelte-rccxcp`),p(Ie,`${Vt[e(R)]??""}${da[e(R)]??""}`)}),r(T,se)}),r(X,he)},Ye=X=>{var he=Te(),G=L(he);{var H=le=>{var pe=fi(),W=s(a(pe),2),T=a(W);f(()=>p(T,`${Qt[t().spellCategory]??""}魔法`)),r(le,pe)},ie=le=>{var pe=Te(),W=L(pe);{var T=R=>{var se=pi(),Ie=s(a(se),2),$=a(Ie);f(()=>p($,`${Zt[t().trapCategory]??""}罠`)),r(R,se)};g(W,R=>{t().kind==="Trap"&&t().trapCategory&&R(T)},!0)}r(le,pe)};g(G,le=>{t().kind==="Spell"&&t().spellCategory?le(H):le(ie,!1)},!0)}r(X,he)};g(J,X=>{t().kind==="Monster"?X(ve):X(Ye,!1)})}var C=s(J,2),h=a(C),F=a(h),ae=a(F),Me=s(C,2);{var Q=X=>{var he=mi();r(X,he)},ce=X=>{var he=gi(),G=a(he),H=s(G,2),ie=a(H);f(le=>{pt(G,"href",`https://yugioh-wiki.net/index.php?${t().wikiEncodedName}`),pt(H,"href",le),p(ie,`⇒${(t().cardId?"公式カードページ":"公式で検索")??""}`)},[()=>rr(t())],ye),r(X,he)};g(Me,X=>{t().isForTest?X(Q):X(ce,!1)})}f((X,he)=>{Ae(S,`duel_card duel_card_info ${t().kind??""} ${X??""} svelte-rccxcp`),p(O,t().name),p(ae,he)},[()=>{var X;return(X=t().monsterCategories)==null?void 0:X.join(" ")},()=>{var X;return(X=c())==null?void 0:X.description}],ye),r(d,S)};g(v,d=>{t()&&d(m)})}r(n,_),ot()}const yi={0:{aaa:"日",aaaa:"日曜日",ddd:"Sun",dddd:"Sunday"},1:{aaa:"月",aaaa:"月曜日",ddd:"Mon",dddd:"Monday"},2:{aaa:"火",aaaa:"火曜日",ddd:"Tue",dddd:"Tuesday"},3:{aaa:"水",aaaa:"水曜日",ddd:"Wed",dddd:"Wednesday"},4:{aaa:"木",aaaa:"木曜日",ddd:"Thu",dddd:"Thursday"},5:{aaa:"金",aaaa:"金曜日",ddd:"Fri",dddd:"Friday"},6:{aaa:"土",aaaa:"土曜日",ddd:"Sat",dddd:"Saturday"}};class wi{constructor(){Qe(this,"DefaultSeparator1","/");Qe(this,"DefaultSeparator2"," ");Qe(this,"DefaultSeparator3",":");Qe(this,"createDate",i=>{if(!i)return;const t=new Date(i);if(!isNaN(t.getTime()))return t});Qe(this,"createDateOr",(i,t)=>this.createDate(i)||t||new Date);Qe(this,"truncateDate",i=>{const t=i||new Date;return new Date(t.getFullYear(),t.getMonth(),t.getDate())});Qe(this,"addDate",(i,t)=>{const c=this.createDateOr(i);return c.setDate(c.getDate()+t),c});Qe(this,"addMonth",(i,t)=>{const c=this.createDateOr(i);return c.setMonth(c.getMonth()+t),c});Qe(this,"addYear",(i,t)=>{const c=this.createDateOr(i);return c.setFullYear(c.getFullYear()+t),c});Qe(this,"getDayOfWeek",(i,t="dddd")=>{const c=this.createDate(i);return c?yi[c.getDay()][t]:""});Qe(this,"formatToYYYYMMDD",(i,t=this.DefaultSeparator1)=>{const c=this.createDate(i);if(!c)return"";const _=c.getFullYear().toString(),v=("0"+(c.getMonth()+1)).slice(-2),m=("0"+c.getDate()).slice(-2);return _+t+v+t+m});Qe(this,"formatToYYYYMM",(i,t=this.DefaultSeparator1)=>{const c=this.createDate(i);if(!c)return"";t||(t="");const _=c.getFullYear().toString(),v=("0"+(c.getMonth()+1)).slice(-2);return _+t+v});Qe(this,"formatToHHMMSS",(i,t=this.DefaultSeparator3)=>{const c=this.createDate(i);if(!c)return"";t||(t="");const _=c.getHours(),v=c.getMinutes(),m=c.getSeconds();return("0"+_).slice(-2)+t+("0"+v).slice(-2)+t+("0"+m).slice(-2)});Qe(this,"formatToHHMM",(i,t=this.DefaultSeparator3)=>{const c=this.createDate(i);if(!c)return"";t||(t="");const _=("0"+c.getHours()).slice(-2),v=("0"+c.getMinutes()).slice(-2);return _+t+v});Qe(this,"formatToYYYYMMDD_HHMM",(i,t=this.DefaultSeparator1,c=this.DefaultSeparator2,_=this.DefaultSeparator3)=>{const v=this.createDate(i);return v?this.formatToYYYYMMDD(v,t)+c+this.formatToHHMM(v,_):""});Qe(this,"formatToYYYYMMDD_HHMMSS",(i,t=this.DefaultSeparator1,c=this.DefaultSeparator2,_=this.DefaultSeparator3)=>{const v=this.createDate(i);return v?this.formatToYYYYMMDD(v,t)+c+this.formatToHHMMSS(v,_):""})}}const dt=new wi;Date.prototype.truncateDate=function(){return dt.truncateDate(this)};Date.prototype.getCloneOr=function(n){return dt.createDateOr(this,n)};Date.prototype.addDate=function(n){return dt.addDate(this,n)};Date.prototype.addMonth=function(n){return dt.addDate(this,n)};Date.prototype.addYear=function(n){return dt.addDate(this,n)};Date.prototype.getDayOfWeek=function(n="dddd"){return dt.getDayOfWeek(this,n)};Date.prototype.formatToYYYYMM=function(n){return dt.formatToYYYYMM(this,n)};Date.prototype.formatToYYYYMMDD=function(n){return dt.formatToYYYYMMDD(this,n)};Date.prototype.formatToYYYYMMDD_HHMM=function(n,i,t){return dt.formatToYYYYMMDD_HHMM(this,n,i,t)};Date.prototype.formatToYYYYMMDD_HHMMSS=function(n,i,t){return dt.formatToYYYYMMDD_HHMMSS(this,n,i,t)};Date.prototype.formatToHHMM=function(n){return dt.formatToHHMM(this,n)};Date.prototype.formatToHHMMSS=function(n){return dt.formatToHHMMSS(this,n)};var ki=l('<li class="deck_info_list_item svelte-2wdgc8"><div class="svelte-2wdgc8"> </div> <div class="svelte-2wdgc8"> </div> <div class="svelte-2wdgc8"> </div></li>'),xi=l('<ul class="deck_info_list svelte-2wdgc8"></ul>'),Ci=l('<label for="file_selector" class="upload_area svelte-2wdgc8" role="region" aria-label="ファイルアップロードエリア"><div class="upload_area_message svelte-2wdgc8">ここにファイルをドロップ</div> <div class="upload_area_footer svelte-2wdgc8"><input type="file" id="file_selector" name="file_selector" accept=".json" multiple></div></label>'),Di=l('<div slot="body" class="modal_body svelte-2wdgc8"><!></div>'),$i=l('<button class="svelte-2wdgc8">追加</button> <button class="svelte-2wdgc8">削除して追加</button> <button class="svelte-2wdgc8">戻る</button>',1),Si=l('<button class="svelte-2wdgc8">Cancel</button>'),Mi=l('<div slot="footer" class="modal_window_footer svelte-2wdgc8"><!></div>');function ji(n,i){it(i,!1);let t=We(i,"eventHolder",8),c=We(i,"args",8),_=We(i,"resolve",8),v=xe(Promise.resolve([])),m=xe();const d=()=>{y(m,new DataTransfer().files),y(v,Promise.resolve([]))},S=async A=>{A.preventDefault(),console.log("hoge",A)},I=async A=>{A.preventDefault(),A.dataTransfer&&o(A.dataTransfer.files)},b=()=>{o(e(m))},o=async A=>{if(!A.length)return;const z=[],Y=[];for(const B of A)try{Y.push(...await _t.createfromJson(B))}catch(M){M instanceof Error&&z.push(M.message)}if(z.length){console.log(...z);return}y(v,e(v).then(()=>Y))},O=d;lt(),sr(n,{get eventHolder(){return t()},get args(){return c()},$$slots:{body:(A,z)=>{var Y=Di(),B=a(Y);ht(B,()=>e(v),null,(M,J)=>{var ve=Te(),Ye=L(ve);{var C=F=>{var ae=xi();ne(ae,5,()=>e(J),de,(Me,Q)=>{var ce=ki(),X=a(ce),he=a(X),G=s(X,2),H=a(G),ie=s(G,2),le=a(ie);f((pe,W,T)=>{p(he,e(Q).name),p(H,`${pe??""}
                /
                ${W??""}`),p(le,`最終使用日時 ： ${T??""}`)},[()=>e(Q).cardNames.filter(pe=>c().mainCardNames.includes(pe)).length,()=>e(Q).cardNames.filter(pe=>c().exCardNames.includes(pe)).length,()=>e(Q).lastUsedAt.formatToYYYYMMDD_HHMM("/"," ",":")],ye),r(Me,ce)}),r(F,ae)},h=F=>{var ae=Ci(),Me=s(a(ae),2),Q=a(Me);ir(Q,()=>e(m),ce=>y(m,ce)),ke("change",Q,b),ke("cancel",Q,O),ke("drop",ae,I),ke("dragover",ae,S),r(F,ae)};g(Ye,F=>{e(J).length?F(C):F(h,!1)})}r(M,ve)}),r(A,Y)},footer:(A,z)=>{var Y=Mi(),B=a(Y);ht(B,()=>e(v),null,(M,J)=>{var ve=Te(),Ye=L(ve);{var C=F=>{var ae=$i(),Me=L(ae),Q=s(Me,2),ce=s(Q,2);f(()=>{Me.disabled=e(J).length===0,Q.disabled=e(J).length===0}),ke("click",Me,()=>_()({deckInfos:e(J),replaceAll:!1})),ke("click",Q,()=>_()({deckInfos:e(J),replaceAll:!0})),ke("click",ce,O),r(F,ae)},h=F=>{var ae=Te(),Me=L(ae);{var Q=ce=>{var X=Si();ke("click",X,()=>_()(void 0)),r(ce,X)};g(Me,ce=>{c().cancelable&&ce(Q)},!0)}r(F,ae)};g(Ye,F=>{e(J).length?F(C):F(h,!1)})}r(M,ve)}),r(A,Y)}}}),ot()}const Gt=class Gt extends or{constructor(i,t){super(i,...Object.values(t))}};Qe(Gt,"createModalController",i=>{const t={deckUploader:new nr({title:"デッキ情報をアップロード",position:"Middle",cancelable:!1,mainCardNames:[],exCardNames:[]})};return Object.assign(new Gt(i,t),t)});let la=Gt;function Ti(n,i){it(i,!1);let t=We(i,"modalController",8);lt(),lr(n,{get modalController(){return t()},children:(c,_)=>{var v=Te(),m=L(v);{var d=S=>{ji(S,{get eventHolder(){return t().eventHolder},get args(){return t().deckUploader.args},get resolve(){return t().deckUploader.resolve}})};g(m,S=>{t().deckUploader.state==="Shown"&&S(d)})}r(c,v)},$$slots:{default:!0}}),ot()}var Ei=l('<label><input type="checkbox"> </label>'),qi=l('<label><input type="checkbox"> </label>'),Ai=l('<label><input type="checkbox"> <div style="display: inline-block;"></div> </label>'),Yi=l('<label><input type="checkbox"> </label>'),Bi=l('<div class="deck_editor_search_box_row svelte-1s1plv5"><div class="svelte-1s1plv5"><button class="search_condition_title black_button svelte-1s1plv5">モンスター</button></div> <div class="svelte-1s1plv5"></div></div> <div class="deck_editor_search_box_row svelte-1s1plv5"><div class="svelte-1s1plv5"><button class="search_condition_title black_button svelte-1s1plv5">属性</button></div> <div class="svelte-1s1plv5"></div></div> <div class="deck_editor_search_box_row svelte-1s1plv5"><div class="svelte-1s1plv5"><button class="search_condition_title black_button svelte-1s1plv5">種族</button></div> <div class="svelte-1s1plv5"></div></div>',1),Ni=l('<label><input type="checkbox"> </label>'),Ii=l('<div class="deck_editor_search_box_row svelte-1s1plv5"><div class="svelte-1s1plv5"><button class="search_condition_title black_button svelte-1s1plv5">魔法</button></div> <div class="svelte-1s1plv5"></div></div>'),Fi=l('<label><input type="checkbox"> </label>'),Hi=l('<div class="deck_editor_search_box_row svelte-1s1plv5"><div class="svelte-1s1plv5"><button class="search_condition_title black_button svelte-1s1plv5">罠</button></div> <div class="svelte-1s1plv5"></div></div>'),Pi=l('<label><input type="checkbox"> </label>'),Ui=l("<option> </option>"),Oi=l('<div class="svelte-1s1plv5"><a class="white_button svelte-1s1plv5" download="SVS_DeckInfos.json">ダウンロード</a></div>'),Li=l('<div class="svelte-1s1plv5"></div>'),Ri=l('<div class="svelte-1s1plv5"><a class="white_button svelte-1s1plv5" download="SVS_DeckInfos.json">ダウンロード(一括)</a></div>'),Wi=l('<div class="svelte-1s1plv5"></div>'),Ki=l('<div class="deck_editor_body_right_header svelte-1s1plv5"><div class="deck_editor_body_right_header_row svelte-1s1plv5"><div class="svelte-1s1plv5">編集対象 <select></select></div> <div class="svelte-1s1plv5"></div> <div class="svelte-1s1plv5">新規名称 <input type="text"></div></div> <div class="deck_editor_body_right_header_row svelte-1s1plv5"></div> <div class="deck_editor_body_right_header_row svelte-1s1plv5"><div class="svelte-1s1plv5">基本操作</div> <div class="svelte-1s1plv5"><button class="white_button svelte-1s1plv5">デッキを保存</button></div> <div class="svelte-1s1plv5"></div> <div class="svelte-1s1plv5"><button class="white_button svelte-1s1plv5">デッキを複製</button></div> <div class="svelte-1s1plv5"><button class="white_button svelte-1s1plv5" title="shiftキー押下で確認メッセージスキップ">デッキを削除</button></div></div> <div class="deck_editor_body_right_header_row svelte-1s1plv5"><div class="svelte-1s1plv5">DL/UL</div> <!> <!> <div class="svelte-1s1plv5"><button class="white_button svelte-1s1plv5">アップロード</button></div></div></div> <!>',1),zi=l("<div>デッキ情報読込中</div>"),Gi=l('<div class="deck_editor svelte-1s1plv5"><div class="deck_editor_header"></div> <div class="deck_editor_body svelte-1s1plv5"><div class="deck_editor_body_left svelte-1s1plv5"><div role="contentinfo"><div class="deck_editor_search_box_header svelte-1s1plv5"><div>検索条件</div> <div><button class="white_button svelte-1s1plv5">条件クリア</button></div></div> <div class="deck_editor_search_box_row svelte-1s1plv5"><div class="svelte-1s1plv5">名称</div> <div class="svelte-1s1plv5"><input type="text" style="width:70%"> <button class="white_button svelte-1s1plv5">クリア</button> <span>※ルビには対応していません</span></div></div> <div class="deck_editor_search_box_row svelte-1s1plv5"><div class="svelte-1s1plv5"><button class="search_condition_title black_button svelte-1s1plv5">種類</button></div> <div class="svelte-1s1plv5"></div></div> <!> <!> <!> <div class="deck_editor_search_box_row svelte-1s1plv5"><div class="svelte-1s1plv5"><button class="search_condition_title black_button svelte-1s1plv5">その他</button></div> <div class="svelte-1s1plv5"></div></div></div> <!></div> <div class="deck_editor_body_center svelte-1s1plv5"><!></div> <div class="deck_editor_body_right svelte-1s1plv5"><!></div></div> <div class="footer svelte-1s1plv5"></div></div> <!>',1);function Xi(n,i){it(i,!1);const t=[],c=[],_=[],v=[],m=[],d=[],S=[],I=la.createModalController({onDragStart:{append:()=>{},remove:()=>{}},onDragEnd:{append:()=>{},remove:()=>{}}}),b={name:"",cardKinds:wa.filter(x=>x!=="XyzMaterial"),monsterCategories:[...$a],monsterAttributes:[...Da],monsterTypes:[...Ca],spellCategories:[...xa],trapCategories:[...ka],others:["test"]},o=xe(structuredClone(b));Re(o,e(o).others=[]);let O=xe("SearchCondition");const A=async()=>{Re(o,e(o).name=""),Re(o,e(o).cardKinds=[]),Re(o,e(o).monsterCategories=[]),Re(o,e(o).monsterAttributes=[]),Re(o,e(o).monsterTypes=[]),Re(o,e(o).spellCategories=[]),Re(o,e(o).trapCategories=[]),Re(o,e(o).others=[])},z=async x=>{Array.isArray(e(o)[x])&&Array.isArray(b[x])&&Re(o,e(o)[x]=e(o)[x].length?[]:[...b[x]])},Y=(x,D,E)=>{Array.isArray(e(o)[D])&&Array.isArray(b[D])&&Re(o,e(o)[D]=[E])},B=async()=>{const D=(await e(ve)).find(E=>E.id===e(J));D&&y(h,{...D,cardInfos:D.cardNames.map(E=>gt[E])})},M=()=>_t.getAllDeckInfo().then(x=>(y(J,(x.find(D=>D.lastUsedAt.getTime()===Math.max(...x.map(E=>E.lastUsedAt.getTime())))??x[0]).id),x));let J=xe(-1),ve=xe(M()),Ye=xe(e(ve).then(x=>_t.convertToObjectURL(x)));e(ve).then(B);const C=()=>{y(ve,M()),y(Ye,e(ve).then(x=>_t.convertToObjectURL(x))),B()};let h=xe({id:-Number.MAX_VALUE,name:"",description:"",lastUsedAt:new Date,cardInfos:[]}),F=xe(gt.ゾンビーノ);const ae=x=>{y(O,"CardDetail"),y(F,x)},Me=async()=>{const D=(await e(ve)).find(E=>E.id===e(J));if(!D)throw new Error("illegal state");return D},Q=async()=>{const x=await Me();await x.saveDeckInfo({...x,name:e(h).name,cardNames:e(h).cardInfos.map(D=>D.name),lastUsedAt:new Date}),C()},ce=async()=>{(await _t.createNewDeck(`デッキ_${new Date().formatToYYYYMMDD_HHMMSS("","","")}`,`コピー日時：${new Date().formatToYYYYMMDD_HHMMSS("-"," ",":")}`,e(h).cardInfos.map(D=>D.name))).saveDeckInfo(),C()},X=async x=>{const D=await Me();!x.shiftKey&&!confirm(`デッキ【${D.name}】を削除します。
よろしいですか？`)||(await D.delete(),C())},he=async()=>{const x=await I.deckUploader.show({title:"デッキ情報アップロード",position:"Middle",cancelable:!0,mainCardNames:Object.values(gt).filter(E=>{var me;return!((me=E.monsterCategories)!=null&&me.union(Kt).length)}).map(E=>E.name),exCardNames:Object.values(gt).filter(E=>{var me;return(me=E.monsterCategories)==null?void 0:me.union(Kt).length}).map(E=>E.name)});if(!x)return;const D=[];if(x.replaceAll){if(!confirm(`既存デッキ情報を全て削除し、アップロードしたファイルに置き換えます。
よろしいですか？`))return;D.push(...(await e(ve)).map(E=>E.id))}await Promise.all(x.deckInfos.map(E=>_t.createNewDeck(E.name,E.description,E.cardNames,E.lastUsedAt))),D.length&&await Promise.all(D.map(_t.remove)),C()};lt();var G=Gi(),H=L(G),ie=s(a(H),2),le=a(ie),pe=a(le),W=a(pe),T=s(a(W),2),R=a(T),se=s(W,2),Ie=s(a(se),2),$=a(Ie),Z=s($,2),oe=s(se,2),w=a(oe),j=a(w),N=s(w,2);ne(N,5,()=>wa.filter(x=>x!=="XyzMaterial"),de,(x,D)=>{var E=Ei(),me=a(E),Be,Ue=s(me);f(()=>{Be!==(Be=e(D))&&(me.value=(me.__value=e(D))==null?"":e(D)),p(Ue,` ${Na[e(D)]??""}`)}),xt(t,[],me,()=>(e(D),e(o).cardKinds),K=>Re(o,e(o).cardKinds=K)),r(x,E)});var k=s(oe,2);{var re=x=>{var D=Bi(),E=L(D),me=a(E),Be=a(me),Ue=s(me,2);ne(Ue,5,()=>$a,de,(Xe,Se)=>{var Le=qi(),Fe=a(Le),tt,ut=s(Fe);f(()=>{tt!==(tt=e(Se))&&(Fe.value=(Fe.__value=e(Se))==null?"":e(Se)),p(ut,` ${Vt[e(Se)]??""}${da[e(Se)]??""}`)}),xt(c,[],Fe,()=>(e(Se),e(o).monsterCategories),vt=>Re(o,e(o).monsterCategories=vt)),r(Xe,Le)});var K=s(E,2),we=a(K),qe=a(we),Ke=s(we,2);ne(Ke,5,()=>Da,de,(Xe,Se)=>{var Le=Ai(),Fe=a(Le),tt,ut=s(Fe,2),vt=s(ut);f(()=>{tt!==(tt=e(Se))&&(Fe.value=(Fe.__value=e(Se))==null?"":e(Se)),Ae(ut,`monster_attr ${e(Se)??""} svelte-1s1plv5`),p(vt,` ${na[e(Se)]??""}`)}),xt(_,[],Fe,()=>(e(Se),e(o).monsterAttributes),Yt=>Re(o,e(o).monsterAttributes=Yt)),r(Xe,Le)});var He=s(K,2),Ve=a(He),Ze=a(Ve),et=s(Ve,2);ne(et,5,()=>Ca,de,(Xe,Se)=>{var Le=Yi(),Fe=a(Le),tt,ut=s(Fe);f(()=>{tt!==(tt=e(Se))&&(Fe.value=(Fe.__value=e(Se))==null?"":e(Se)),p(ut,` ${Xt[e(Se)]??""}
                  ${va[e(Se)]??""}`)}),xt(v,[],Fe,()=>(e(Se),e(o).monsterTypes),vt=>Re(o,e(o).monsterTypes=vt)),ke("dblclick",Le,vt=>Y(vt,"monsterTypes",e(Se))),r(Xe,Le)}),ke("click",Be,()=>z("monsterCategories")),te(3,E,()=>ge,()=>({delay:0,duration:100})),ke("click",qe,()=>z("monsterAttributes")),te(3,K,()=>ge,()=>({delay:0,duration:100})),ke("click",Ze,()=>z("monsterTypes")),te(3,He,()=>ge,()=>({delay:0,duration:100})),r(x,D)};g(k,x=>{e(o).cardKinds.includes("Monster")&&x(re)})}var u=s(k,2);{var q=x=>{var D=Ii(),E=a(D),me=a(E),Be=s(E,2);ne(Be,5,()=>xa,de,(Ue,K)=>{var we=Ni(),qe=a(we),Ke,He=s(qe);f(()=>{Ke!==(Ke=e(K))&&(qe.value=(qe.__value=e(K))==null?"":e(K)),p(He,` ${Qt[e(K)]??""}`)}),xt(m,[],qe,()=>(e(K),e(o).spellCategories),Ve=>Re(o,e(o).spellCategories=Ve)),r(Ue,we)}),ke("click",me,()=>z("spellCategories")),te(3,D,()=>ge,()=>({delay:0,duration:100})),r(x,D)};g(u,x=>{e(o).cardKinds.includes("Spell")&&x(q)})}var be=s(u,2);{var Ce=x=>{var D=Hi(),E=a(D),me=a(E),Be=s(E,2);ne(Be,5,()=>ka,de,(Ue,K)=>{var we=Fi(),qe=a(we),Ke,He=s(qe);f(()=>{Ke!==(Ke=e(K))&&(qe.value=(qe.__value=e(K))==null?"":e(K)),p(He,` ${Zt[e(K)]??""}`)}),xt(d,[],qe,()=>(e(K),e(o).trapCategories),Ve=>Re(o,e(o).trapCategories=Ve)),r(Ue,we)}),ke("click",me,()=>z("trapCategories")),te(3,D,()=>ge,()=>({delay:0,duration:100})),r(x,D)};g(be,x=>{e(o).cardKinds.includes("Trap")&&x(Ce)})}var je=s(be,2),fe=a(je),P=a(fe),V=s(fe,2);ne(V,4,()=>[{key:"test",text:"テスト用カードを表示する"}],de,(x,D)=>{var E=Pi(),me=a(E),Be,Ue=s(me);f(()=>{Be!==(Be=D.key)&&(me.value=(me.__value=D.key)==null?"":D.key),p(Ue,` ${D.text??""}`)}),xt(S,[],me,()=>(D.key,e(o).others),K=>Re(o,e(o).others=K)),r(x,E)});var U=s(pe,2);bi(U,{get cardInfo(){return e(F)}});var _e=s(le,2),De=a(_e);const Ne=ye(()=>Object.values(gt));Ya(De,{mode:"List",get allCardInfos(){return e(Ne)},onAttention:ae,get searchCondition(){return e(o)},get deckCardInfos(){return e(h).cardInfos},set deckCardInfos(x){Re(h,e(h).cardInfos=x)},$$legacy:!0});var $e=s(_e,2),ee=a($e);ht(ee,()=>e(ve),x=>{var D=zi();r(x,D)},(x,D)=>{var E=Ki(),me=L(E),Be=a(me),Ue=a(Be),K=s(a(Ue));f(()=>{e(J),Et(()=>{e(D)})}),ne(K,5,()=>e(D),de,(Pe,Oe)=>{var ze=Ui(),Ge={},at=a(ze);f(()=>{Ge!==(Ge=e(Oe).id)&&(ze.value=(ze.__value=e(Oe).id)==null?"":e(Oe).id),p(at,e(Oe).name)}),r(Pe,ze)});var we=s(Ue,4),qe=s(a(we)),Ke=s(Be,4),He=s(a(Ke),2),Ve=a(He),Ze=s(He,4),et=a(Ze),Xe=s(Ze,2),Se=a(Xe),Le=s(Ke,2),Fe=s(a(Le),2);ht(Fe,Me,Pe=>{var Oe=Li();r(Pe,Oe)},(Pe,Oe)=>{var ze=Oi(),Ge=a(ze);f(at=>pt(Ge,"href",at),[()=>_t.convertToObjectURL([e(Oe)])],ye),r(Pe,ze)});var tt=s(Fe,2);ht(tt,()=>e(Ye),Pe=>{var Oe=Wi();r(Pe,Oe)},(Pe,Oe)=>{var ze=Ri(),Ge=a(ze);f(()=>pt(Ge,"href",e(Oe))),r(Pe,ze)});var ut=s(tt,2),vt=a(ut),Yt=s(me,2);Ya(Yt,{mode:"Deck",allCardInfos:[],onAttention:ae,get deckCardInfos(){return e(h).cardInfos},set deckCardInfos(Pe){Re(h,e(h).cardInfos=Pe)},$$legacy:!0}),qt(K,()=>e(J),Pe=>y(J,Pe)),ke("change",K,B),ra(qe,()=>e(h).name,Pe=>Re(h,e(h).name=Pe)),ke("click",Ve,Q),ke("click",et,ce),ke("click",Se,X),ke("click",vt,he),r(x,E)});var ue=s(ie,2);ue.textContent=`実装済カード${vr+Sa}枚（内、効果のないモンスター${Sa??""}枚）`;var Ee=s(H,2);Ti(Ee,{modalController:I}),f(()=>Ae(pe,`deck_editor_search_box ${(e(O)==="SearchCondition"?"":"minimum")??""} svelte-1s1plv5`)),ke("click",R,A),ra($,()=>e(o).name,x=>Re(o,e(o).name=x)),ke("click",Z,()=>Re(o,e(o).name="")),ke("click",j,()=>z("cardKinds")),ke("click",P,()=>z("others")),te(3,je,()=>ge,()=>({delay:0,duration:100})),ke("mouseenter",pe,()=>y(O,"SearchCondition")),r(n,G),ot()}String.prototype.format=(n,...i)=>{for(const[t,c]of i.entries()){const _=new RegExp(`\\{${t}\\}`,"g");n=n.replace(_,c)}return n};String.prototype.toSnakeCase=function(){return this.split(/(?=[A-Z])/).join("_").toLowerCase()};const Vi=["TblDeckHeader","TblDeckDetail","TblDuelistProfile"],Qi=3;var Zi=l('<input class="game_mode_radio svelte-1mr5pj3" type="radio" name="game_mode"> <label> </label>',1),Ji=l('<option class="svelte-1mr5pj3"> </option>'),el=l('<option class="svelte-1mr5pj3"> </option>'),tl=l('<option class="svelte-1mr5pj3"> </option>'),al=l('<tr class="config_row svelte-1mr5pj3"><td class="svelte-1mr5pj3"><div class="svelte-1mr5pj3"><label for="npc_deck_selector" class="config_row_label deck_selector svelte-1mr5pj3">デッキ：</label></div></td><td class="svelte-1mr5pj3"><div class="svelte-1mr5pj3"><select id="npc_deck_selector" class="deck_selector svelte-1mr5pj3"><option class="svelte-1mr5pj3">デフォルト</option><!></select></div></td></tr>'),rl=l('<option class="svelte-1mr5pj3"> </option>'),sl=l('<tr class="config_row svelte-1mr5pj3"><td class="svelte-1mr5pj3"><div class="svelte-1mr5pj3"><label for="npc_selector" class="config_row_label npc_selector svelte-1mr5pj3">対戦相手：</label></div></td><td class="svelte-1mr5pj3"><div class="svelte-1mr5pj3"><select id="npc_selector" class="npc_selector svelte-1mr5pj3"></select> <div class="svelte-1mr5pj3"> </div></div></td></tr> <!> <tr class="config_row svelte-1mr5pj3"><td class="svelte-1mr5pj3"><div class="svelte-1mr5pj3"><label for="npc_selector" class="config_row_label npc_selector svelte-1mr5pj3">先攻後攻：</label></div></td><td class="svelte-1mr5pj3"><div class="svelte-1mr5pj3"><select id="npc_selector" class="npc_selector svelte-1mr5pj3"></select></div></td></tr>',1),il=l('<option class="svelte-1mr5pj3"> </option>'),ll=l('<tr class="config_row svelte-1mr5pj3"><td class="svelte-1mr5pj3"><div class="svelte-1mr5pj3"><label for="difficulty_selector" class="config_row_label difficulty_selector svelte-1mr5pj3">難易度：</label></div></td><td class="svelte-1mr5pj3"><div class="svelte-1mr5pj3"><select id="difficulty_selector" class="difficulty_selector svelte-1mr5pj3"></select></div></td></tr>'),ol=l('<tr class="config_row svelte-1mr5pj3"><td class="svelte-1mr5pj3"><div class="svelte-1mr5pj3"><label class="config_row_label svelte-1mr5pj3" for="game_mode_radio_preset">ゲームモード：</label></div></td><td class="svelte-1mr5pj3"><div class="svelte-1mr5pj3"></div></td></tr> <tr class="config_row svelte-1mr5pj3"><td class="svelte-1mr5pj3"><div class="svelte-1mr5pj3"><label for="deck_selector" class="config_row_label deck_selector svelte-1mr5pj3">デッキ：</label></div></td><td class="svelte-1mr5pj3"><div class="svelte-1mr5pj3"><select id="deck_selector" class="deck_selector svelte-1mr5pj3"></select></div></td></tr> <!> <tr><td colspan="2" class="svelte-1mr5pj3"><div><button class="btn svelte-1mr5pj3">duel start!</button></div></td></tr>',1),nl=l('<tr><td colspan="2" class="svelte-1mr5pj3"><div>デッキ情報の読み込み、もしくは作成中...</div></td></tr>'),vl=l('<tr><td colspan="2" class="svelte-1mr5pj3"><div><button class="btn svelte-1mr5pj3">deck edit</button></div></td></tr>'),dl=l('<tr class="config_row svelte-1mr5pj3"><td class="svelte-1mr5pj3"><div class="svelte-1mr5pj3"><label for="duelist_name" class="config_row_label duelist_name svelte-1mr5pj3">名前：</label></div></td><td class="svelte-1mr5pj3"><div class="svelte-1mr5pj3"><input id="duelist_name" class="duelist_name svelte-1mr5pj3" type="text"></div></td></tr> <!> <!>',1),cl=l('<tr><td colspan="2" class="svelte-1mr5pj3"><div>デュエリスト情報の読み込み、もしくは作成中...</div></td></tr>'),_l=l('<div class="app_body svelte-1mr5pj3"><table class="config_table svelte-1mr5pj3"><tbody><!></tbody></table></div>'),ul=l('<div class="result_title result_win svelte-1mr5pj3">YOU WIN</div>'),fl=l('<div class="result_title result_lose svelte-1mr5pj3">YOU LOSE</div>'),pl=l('<div class="result_title result_draw svelte-1mr5pj3">DRAW</div>'),ml=l('<div class="twitter_share_button_wrapper svelte-1mr5pj3"><a rel="nofollow" target="_blank" class="twitter_share_button svelte-1mr5pj3">X(twitter)でシェアする</a></div>'),gl=l('<div class="result svelte-1mr5pj3"><!> <div class="reason_of_end svelte-1mr5pj3"> </div> <!> <div class="svelte-1mr5pj3"><button class="white_button svelte-1mr5pj3">TOPへ戻る</button></div></div>'),hl=l('<main style="flex-direction: column; display :flex" class="svelte-1mr5pj3"><div class="link link_left svelte-1mr5pj3"><a href="https://github.com/Setta238/stk_ygo_svelte" target="_blank" rel="noopener noreferrer" title="repository" class="svelte-1mr5pj3">repository</a> <a href="https://x.com/ninja_no" target="_blank" rel="noopener noreferrer" title="repository" class="svelte-1mr5pj3">X(Twitter)</a> <a href="https://posfie.com/@ninja_no/p/Lx7FLj3" target="_blank" rel="noopener noreferrer" title="posfie" class="svelte-1mr5pj3">posfie(toggeter)</a></div> <div class="link link_right svelte-1mr5pj3"><a class="a_button svelte-1mr5pj3" role="button" tabindex="0">TOPへ戻る</a> <a href="/stk_ygo_svelte/note.html" target="_blank" rel="noopener noreferrer" title="repository" class="svelte-1mr5pj3">現時点とこの先のこと</a></div> <!> <div class="debug_info svelte-1mr5pj3"><span class="svelte-1mr5pj3"> </span> <span class="user_agent_info svelte-1mr5pj3"> </span> <span class="screen_info svelte-1mr5pj3"> </span></div> <!></main>');function bl(n,i){it(i,!1);const t=new dr("stk_ygo_svelte",Qi,Vi);let c=xe(0),_=xe(0),v=xe(),m=xe("FtkChallenge"),d=xe("None"),S=xe(0),I=xe(""),b=xe(void 0);const o="https://setta238.github.io/stk_ygo_svelte/",O="遊戯王deそりてあ",A=cr.getOrCreateNew(t).then(w=>(y(m,Ma.includes(w.previousGameMode)?w.previousGameMode:"FtkChallenge"),ce(w.previousNpcId),w)),z=w=>{var N;const j=w.find(k=>k.lastUsedAt.getTime()===Math.max(...w.map(re=>re.lastUsedAt.getTime())))??w[0];y(S,j.id),e(m)==="FtkChallenge"&&j.deckType!=="Preset"&&y(S,((N=Ct.find(k=>k.deckType==="Preset"))==null?void 0:N.id)??e(S))};let Y=xe(_t.getAllDeckInfo(t).then(w=>(Promise.all(w.filter(j=>!j.lastUsedAt).map(j=>{j.saveDeckInfo()})),z(w),w)));const B=async()=>{const w=e(S);let j=(await e(Y)).find(k=>k.id===w)??(await J()).find(k=>k.id===w);j&&await j.updateTimestamp();let N=j;if(N||(N=Ct.find(k=>k.id===w)),!N)throw new Error("illegal state");return N},M=async()=>{(await A).save({previousGameMode:e(m)})},J=()=>(y(Y,_t.getAllDeckInfo(t).then(w=>(z(w),w))),e(Y)),ve=async()=>{(await e(Y)).length||(await _t.prepareSampleDeck(),J())},Ye=async()=>{await Promise.all([M(),ve()]);const w=await B(),j=await A;let N=Tt.find(u=>u.id===Number.MIN_SAFE_INTEGER)??Tt[0],k=Ct.find(u=>u.id===Number.MIN_SAFE_INTEGER)??Ct[0],re="PlayFirst";e(m)==="FtkChallenge"?N=Tt.filter(u=>u.npcType==="FtkChallenge").find(u=>u.difficulty===j.previousDifficulty)??N:e(m)==="Free"&&(N=Tt.find(u=>u.id===j.previousNpcId)??N,k=Ct.slice(-1)[0],re=j.previousStartMode),N.npcType!=="FtkChallenge"&&j.previousNpcDeckId>-1?k=(await e(Y)).find(u=>u.id===j.previousNpcDeckId)??k:k=Ct.find(u=>u.id===N.id)??k,y(v,new ur(j,"Player",w,[],N,"NPC",k,[],re)),e(v).onDuelEnd.append(()=>(y(v,e(v)),"RemoveMe"))},C=async()=>{await Promise.all([M(),ve()]),y(d,"DeckEdit")},h=async w=>{await M(),w.key==="Enter"&&!w.repeat&&(await A).save()},F=()=>{y(Y,J()),y(v,void 0),y(d,"None")};let ae=Date.now();const Me=w=>{Date.now()-ae<200||(ae=Date.now(),y(m,w),J())},Q=w=>{ce(Number(w.currentTarget.value))},ce=w=>{var j;y(b,Tt.find(N=>N.id===w)),y(I,((j=e(b))==null?void 0:j.description)??"")};ve(),lt();var X=hl(),he=s(a(X),2),G=a(he),H=s(he,2);{var ie=w=>{var j=Te(),N=L(j);ht(N,()=>A,null,(k,re)=>{Qs(k,{get duel(){return e(v)},get userProfile(){return e(re)}})}),r(w,j)},le=w=>{var j=Te(),N=L(j);{var k=u=>{Xi(u,{})},re=u=>{var q=_l(),be=a(q),Ce=a(be),je=a(Ce);ht(je,()=>A,fe=>{var P=cl();r(fe,P)},(fe,P)=>{var V=dl(),U=L(V),_e=a(U),De=a(_e),Ne=s(_e),$e=a(Ne),ee=a($e),ue=s(U,2);ht(ue,()=>e(Y),D=>{var E=nl();r(D,E)},(D,E)=>{var me=ol(),Be=L(me),Ue=a(Be),K=a(Ue),we=s(Ue),qe=a(we);ne(qe,5,()=>Ma,de,(Pe,Oe)=>{var ze=Zi(),Ge=L(ze),at=s(Ge,2),bt=a(at);f(ft=>{pt(Ge,"id",`game_mode_radio_${ft??""}`),fr(Ge,e(Oe)),pr(Ge,e(m)===e(Oe)),Ae(at,`game_mode_tab_label game_mode_tab_${ft??""} svelte-1mr5pj3`),pt(at,"for",`game_mode_radio_${ft??""}`),p(bt,e(Oe))},[()=>e(Oe).toLowerCase()],ye),ke("change",Ge,()=>Me(e(Oe))),r(Pe,ze)});var Ke=s(Be,2),He=a(Ke),Ve=a(He),Ze=s(He),et=a(Ze),Xe=a(et);f(()=>{e(S),Et(()=>{e(m),e(E)})}),ne(Xe,5,()=>e(m)==="FtkChallenge"?Ct.filter(Pe=>Pe.deckType==="Preset"):e(E),de,(Pe,Oe)=>{var ze=Ji(),Ge={},at=a(ze);f(()=>{Ge!==(Ge=e(Oe).id)&&(ze.value=(ze.__value=e(Oe).id)==null?"":e(Oe).id),p(at,e(Oe).name)}),r(Pe,ze)});var Se=s(Ke,2);{var Le=Pe=>{var Oe=sl(),ze=L(Oe),Ge=a(ze),at=a(Ge),bt=s(Ge),ft=a(bt),Mt=a(ft);f(()=>{e(P),Et(()=>{})}),ne(Mt,5,()=>Tt,de,(ct,Je)=>{var nt=el(),kt={},jt=a(nt);f(()=>{kt!==(kt=e(Je).id)&&(nt.value=(nt.__value=e(Je).id)==null?"":e(Je).id),p(jt,e(Je).name)}),r(ct,nt)});var Ht=s(Mt,2),Pt=a(Ht),Bt=s(ze,2);{var Nt=ct=>{var Je=al(),nt=a(Je),kt=a(nt),jt=s(nt),pa=a(jt),ma=a(pa);f(()=>{e(P),Et(()=>{e(E)})});var Jt=a(ma);Jt.value=(Jt.__value=Number.MIN_SAFE_INTEGER)==null?"":Number.MIN_SAFE_INTEGER;var Ia=s(Jt);ne(Ia,1,()=>e(E),de,(ea,Lt)=>{var Rt=tl(),ga={},Fa=a(Rt);f(()=>{ga!==(ga=e(Lt).id)&&(Rt.value=(Rt.__value=e(Lt).id)==null?"":e(Lt).id),p(Fa,e(Lt).name)}),r(ea,Rt)}),te(3,kt,()=>ge,()=>({duration:200})),te(3,nt,()=>ge,()=>({duration:200})),qt(ma,()=>e(P).previousNpcDeckId,ea=>e(P).previousNpcDeckId=ea),te(3,pa,()=>ge,()=>({duration:200})),te(3,jt,()=>ge,()=>({duration:200})),te(3,Je,()=>ge,()=>({duration:200})),r(ct,Je)};g(Bt,ct=>{var Je;((Je=e(b))==null?void 0:Je.npcType)!=="FtkChallenge"&&ct(Nt)})}var wt=s(Bt,2),yt=a(wt),Ut=a(yt),Ot=s(yt),ua=a(Ot),fa=a(ua);f(()=>{e(P),Et(()=>{})}),ne(fa,5,()=>oa(ja),de,(ct,Je)=>{var nt=rl(),kt={},jt=a(nt);f(()=>{kt!==(kt=e(Je))&&(nt.value=(nt.__value=e(Je))==null?"":e(Je)),p(jt,ja[e(Je)])}),r(ct,nt)}),f(()=>p(Pt,`※${e(I)??""}`)),te(3,at,()=>ge,()=>({duration:200})),te(3,Ge,()=>ge,()=>({duration:200})),ke("change",Mt,Q),qt(Mt,()=>e(P).previousNpcId,ct=>e(P).previousNpcId=ct),te(3,ft,()=>ge,()=>({duration:200})),te(3,bt,()=>ge,()=>({duration:200})),te(3,ze,()=>ge,()=>({duration:200})),te(3,Ut,()=>ge,()=>({duration:200})),te(3,yt,()=>ge,()=>({duration:200})),qt(fa,()=>e(P).previousStartMode,ct=>e(P).previousStartMode=ct),te(3,ua,()=>ge,()=>({duration:200})),te(3,Ot,()=>ge,()=>({duration:200})),te(3,wt,()=>ge,()=>({duration:200})),r(Pe,Oe)},Fe=Pe=>{var Oe=Te(),ze=L(Oe);{var Ge=at=>{var bt=ll(),ft=a(bt),Mt=a(ft),Ht=s(ft),Pt=a(Ht),Bt=a(Pt);f(()=>{e(P),Et(()=>{})}),ne(Bt,5,()=>mr,de,(Nt,wt)=>{var yt=il(),Ut={},Ot=a(yt);f(()=>{Ut!==(Ut=e(wt))&&(yt.value=(yt.__value=e(wt))==null?"":e(wt)),p(Ot,e(wt))}),r(Nt,yt)}),te(3,Mt,()=>ge,()=>({duration:200})),te(3,ft,()=>ge,()=>({duration:200})),qt(Bt,()=>e(P).previousDifficulty,Nt=>e(P).previousDifficulty=Nt),te(3,Pt,()=>ge,()=>({duration:200})),te(3,Ht,()=>ge,()=>({duration:200})),te(3,bt,()=>ge,()=>({duration:200})),r(at,bt)};g(ze,at=>{e(m)==="FtkChallenge"&&at(Ge)},!0)}r(Pe,Oe)};g(Se,Pe=>{e(m)==="Free"?Pe(Le):Pe(Fe,!1)})}var tt=s(Se,2),ut=a(tt),vt=a(ut),Yt=a(vt);te(3,K,()=>ge,()=>({duration:200})),te(3,Ue,()=>ge,()=>({duration:200})),te(3,qe,()=>ge,()=>({duration:200})),te(3,we,()=>ge,()=>({duration:200})),te(3,Be,()=>ge,()=>({duration:200})),te(3,Ve,()=>ge,()=>({duration:200})),te(3,He,()=>ge,()=>({duration:200})),qt(Xe,()=>e(S),Pe=>y(S,Pe)),te(3,et,()=>ge,()=>({duration:200})),te(3,Ze,()=>ge,()=>({duration:200})),te(3,Ke,()=>ge,()=>({duration:200})),ke("click",Yt,Ye),te(3,vt,()=>ge,()=>({duration:200})),r(D,me)});var Ee=s(ue,2);{var x=D=>{var E=vl(),me=a(E),Be=a(me),Ue=a(Be);ke("click",Ue,C),te(3,Be,()=>ge,()=>({duration:200})),te(3,me,()=>ge,()=>({duration:200})),te(3,E,()=>ge,()=>({duration:200})),r(D,E)};g(Ee,D=>{e(m)==="Free"&&D(x)})}te(3,De,()=>ge,()=>({duration:200})),te(3,_e,()=>ge,()=>({duration:200})),ra(ee,()=>e(P).name,D=>e(P).name=D),ke("keypress",ee,h),te(3,$e,()=>ge,()=>({duration:200})),te(3,Ne,()=>ge,()=>({duration:200})),te(3,U,()=>ge,()=>({duration:200})),r(fe,V)}),r(u,q)};g(N,u=>{e(d)==="DeckEdit"?u(k):u(re,!1)},!0)}r(w,j)};g(H,w=>{e(v)?w(ie):w(le,!1)})}var pe=s(H,2),W=a(pe),T=a(W),R=s(W,2),se=a(R),Ie=s(R,2),$=a(Ie),Z=s(pe,2);{var oe=w=>{var j=gl(),N=a(j);{var k=P=>{var V=Te(),U=L(V);{var _e=Ne=>{var $e=ul();r(Ne,$e)},De=Ne=>{var $e=Te(),ee=L($e);{var ue=Ee=>{var x=fl();r(Ee,x)};g(ee,Ee=>{e(v).winner.seat==="Above"&&Ee(ue)},!0)}r(Ne,$e)};g(U,Ne=>{e(v).winner.seat==="Below"?Ne(_e):Ne(De,!1)})}r(P,V)},re=P=>{var V=pl();r(P,V)};g(N,P=>{e(v).winner?P(k):P(re,!1)})}var u=s(N,2),q=a(u),be=s(u,2);{var Ce=P=>{var V=Te(),U=L(V);{var _e=De=>{var Ne=ml(),$e=a(Ne);f(()=>pt($e,"href",`https://x.com/share?url=${o}&text=${e(v).twitterShareText??""}&hashtags=${O}`)),r(De,Ne)};g(U,De=>{var Ne;((Ne=e(v).winner)==null?void 0:Ne.seat)==="Below"&&De(_e)})}r(P,V)};g(be,P=>{var V;((V=e(b))==null?void 0:V.npcType)==="FtkChallenge"&&P(Ce)})}var je=s(be,2),fe=a(je);f(()=>p(q,e(v).reasonOfEnd)),ke("click",fe,F),te(3,j,()=>br,()=>({delay:200,duration:200})),r(w,j)};g(Z,w=>{e(v)&&e(v).isEnded&&w(oe)})}f(()=>{p(T,"build at: 20250609_123630"),p(se,_r.text),p($,`w:${e(c)??""}px h:${e(_)??""}px`)}),Wt("innerWidth",w=>y(c,w)),Wt("innerHeight",w=>y(_,w)),ke("click",G,F),r(n,X),ot()}gr(bl,{target:document.getElementById("app")});
