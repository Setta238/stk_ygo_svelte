var Ha=Object.defineProperty;var ka=d=>{throw TypeError(d)};var Oa=(d,i,t)=>i in d?Ha(d,i,{enumerable:!0,configurable:!0,writable:!0,value:t}):d[i]=t;var lt=(d,i,t)=>Oa(d,typeof i!="symbol"?i+"":i,t),xa=(d,i,t)=>i.has(d)||ka("Cannot "+t);var pt=(d,i,t)=>(xa(d,i,"read from private field"),t?t.call(d):i.get(d)),Vt=(d,i,t)=>i.has(d)?ka("Cannot add the same private member more than once"):i instanceof WeakSet?i.add(d):i.set(d,t),va=(d,i,t,v)=>(xa(d,i,"write to private field"),v?v.call(d,t):i.set(d,t),t);import{s as Ca,r as Ia,a as C,b as Ra,l as Wa,g as e,d as La,p as mt,c as Ve,m as be,i as gt,t as n,e as a,f as b,h as y,j as de,k as Ue,n as wt,o as ve,q as r,u as bt,v as Me,D as Ka,w as ze,x as Y,y as s,z as ne,A as Nt,B as te,C as oe,E as m,F as Va,G as dt,H as fa,I as Ga,J as Xa,K as Pt,L as yt,M as Gt,N as Na,O as pa,P as ra,Q as ya,R as Xt,S as ea,T as ia,U as na,V as Qa,W as Ja,X as Za,Y as es,Z as ts,_ as as,$ as ss,a0 as ta,a1 as rs,a2 as is,a3 as ns,a4 as Bt,a5 as da,a6 as jt,a7 as os,a8 as ls,a9 as vs,aa as Dt,ab as ds,ac as cs,ad as _s,ae as Da,af as $a,ag as Sa,ah as qa,ai as Ma,aj as za,ak as us,al as Et,am as $t,an as Rt,ao as Wt,ap as fs,aq as ps,ar as ja,as as It,at as Lt,au as ys,av as ms,aw as gs,ax as Ta,ay as bs,az as hs,aA as ws}from"../chunk/entity_proc_20260107_190727.js";import"../chunk/json_20260107_190727.js";(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const p of document.querySelectorAll('link[rel="modulepreload"]'))v(p);new MutationObserver(p=>{for(const c of p)if(c.type==="childList")for(const u of c.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&v(u)}).observe(document,{childList:!0,subtree:!0});function t(p){const c={};return p.integrity&&(c.integrity=p.integrity),p.referrerPolicy&&(c.referrerPolicy=p.referrerPolicy),p.crossOrigin==="use-credentials"?c.credentials="include":p.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function v(p){if(p.ep)return;p.ep=!0;const c=t(p);fetch(p.href,c)}})();const ks=d=>d;function ma(d){const i=d-1;return i*i*i+1}function Ba(d){const i=typeof d=="string"&&d.match(/^\s*(-?[\d.]+)([^\s]*)\s*$/);return i?[parseFloat(i[1]),i[2]||"px"]:[d,"px"]}function xs(d,{delay:i=0,duration:t=400,easing:v=ks}={}){const p=+getComputedStyle(d).opacity;return{delay:i,duration:t,easing:v,css:c=>`opacity: ${c*p}`}}function Cs(d,{delay:i=0,duration:t=400,easing:v=ma,x:p=0,y:c=0,opacity:u=0}={}){const l=getComputedStyle(d),B=+l.opacity,R=l.transform==="none"?"":l.transform,D=B*(1-u),[S,o]=Ba(p),[U,X]=Ba(c);return{delay:i,duration:t,easing:v,css:(H,M)=>`
			transform: ${R} translate(${(1-H)*S}${o}, ${(1-H)*U}${X});
			opacity: ${B-D*M}`}}function fe(d,{delay:i=0,duration:t=400,easing:v=ma,axis:p="y"}={}){const c=getComputedStyle(d),u=+c.opacity,l=p==="y"?"height":"width",B=parseFloat(c[l]),R=p==="y"?["top","bottom"]:["left","right"],D=R.map(E=>`${E[0].toUpperCase()}${E.slice(1)}`),S=parseFloat(c[`padding${D[0]}`]),o=parseFloat(c[`padding${D[1]}`]),U=parseFloat(c[`margin${D[0]}`]),X=parseFloat(c[`margin${D[1]}`]),H=parseFloat(c[`border${D[0]}Width`]),M=parseFloat(c[`border${D[1]}Width`]);return{delay:i,duration:t,easing:v,css:E=>`overflow: hidden;opacity: ${Math.min(E*20,1)*u};${l}: ${E*B}px;padding-${R[0]}: ${E*S}px;padding-${R[1]}: ${E*o}px;margin-${R[0]}: ${E*U}px;margin-${R[1]}: ${E*X}px;border-${R[0]}-width: ${E*H}px;border-${R[1]}-width: ${E*M}px;min-${l}: 0`}}function Ea(d,i){for(const t in i)d[t]=i[t];return d}function Ds({fallback:d,...i}){const t=new Map,v=new Map;function p(u,l,B){const{delay:R=0,duration:D=j=>Math.sqrt(j)*30,easing:S=ma}=Ea(Ea({},i),B),o=u.getBoundingClientRect(),U=l.getBoundingClientRect(),X=o.left-U.left,H=o.top-U.top,M=o.width/U.width,E=o.height/U.height,le=Math.sqrt(X*X+H*H),he=getComputedStyle(l),$e=he.transform==="none"?"":he.transform,w=+he.opacity;return{delay:R,duration:typeof D=="function"?D(le):D,easing:S,css:(j,W)=>`
			   opacity: ${j*w};
			   transform-origin: top left;
			   transform: ${$e} translate(${W*X}px,${W*H}px) scale(${j+(1-j)*M}, ${j+(1-j)*E});
		   `}}function c(u,l,B){return(R,D)=>(u.set(D.key,R),()=>{if(l.has(D.key)){const S=l.get(D.key);return l.delete(D.key),p(S,R,D)}return u.delete(D.key),d&&d(R,D,B)})}return[c(v,t,!1),c(t,v,!0)]}function Aa(d){return Object.prototype.toString.call(d)==="[object Date]"}function $s(d){return d}function ca(d){const i=d-1;return i*i*i+1}function _a(d,i){if(d===i||d!==d)return()=>d;const t=typeof d;if(t!==typeof i||Array.isArray(d)!==Array.isArray(i))throw new Error("Cannot interpolate values of different type");if(Array.isArray(d)){const v=i.map((p,c)=>_a(d[c],p));return p=>v.map(c=>c(p))}if(t==="object"){if(!d||!i)throw new Error("Object cannot be null");if(Aa(d)&&Aa(i)){const c=d.getTime(),l=i.getTime()-c;return B=>new Date(c+B*l)}const v=Object.keys(i),p={};return v.forEach(c=>{p[c]=_a(d[c],i[c])}),c=>{const u={};return v.forEach(l=>{u[l]=p[l](c)}),u}}if(t==="number"){const v=i-d;return p=>d+p*v}return()=>i}var Tt,Kt,Qt,Ft;const ga=class ga{constructor(i,t={}){Vt(this,Tt,Ca(void 0));Vt(this,Kt,Ca(void 0));Vt(this,Qt);Vt(this,Ft,null);pt(this,Tt).v=pt(this,Kt).v=i,va(this,Qt,t)}static of(i,t){const v=new ga(i(),t);return Ia(()=>{v.set(i())}),v}set(i,t){var S;C(pt(this,Kt),i);let{delay:v=0,duration:p=400,easing:c=$s,interpolate:u=_a}={...pt(this,Qt),...t};if(p===0)return(S=pt(this,Ft))==null||S.abort(),C(pt(this,Tt),i),Promise.resolve();const l=Ra.now()+v;let B,R=!1,D=pt(this,Ft);return va(this,Ft,Wa(o=>{if(o<l)return!0;if(!R){R=!0;const X=pt(this,Tt).v;B=u(X,i),typeof p=="function"&&(p=p(X,i)),D==null||D.abort()}const U=o-l;return U>p?(C(pt(this,Tt),i),!1):(C(pt(this,Tt),B(c(U/p))),!0)})),pt(this,Ft).promise}get current(){return e(pt(this,Tt))}get target(){return e(pt(this,Kt))}set target(i){this.set(i)}};Tt=new WeakMap,Kt=new WeakMap,Qt=new WeakMap,Ft=new WeakMap;let aa=ga;var Ss=n('<div class="phase_display svelte-1boxe40"><span class="svelte-1boxe40"> </span> </div>'),qs=n('<div class="lifepoint_display svelte-1boxe40"><div class="svelte-1boxe40"> </div> <div class="svelte-1boxe40"> </div></div>'),Ms=(d,i,t)=>i(e(t)),zs=n('<div class="svelte-1boxe40"><button class="phase_button svelte-1boxe40"> </button></div>'),js=n("<div><!></div>"),Ts=n('<div class="svelte-1boxe40"><!></div>'),Bs=n("<div><!></div>"),Es=n('<div class="config_button_wrapper svelte-1boxe40"><button id="config_button" class="svelte-1boxe40">⚙</button></div>'),As=n("<!> <!> <!> <!>",1),Ys=n('<div style="position: absolute;" class="card_animation_receiver svelte-1boxe40"><!></div>'),Us=n('<div style="position: absolute; top:0rem" class="svelte-1boxe40">｛効果対象｝</div>'),Ls=n('<!> <div style="position: absolute; display:flex;justify-content: center;"><!></div>',1),Ns=n(" <!> 】",1),Ps=n('<div style="position: absolute; bottom:0rem" class="svelte-1boxe40"> <!></div>'),Fs=n("<!> <!>",1),Hs=n('<div class="badge svelte-1boxe40"> </div>'),Os=n('<div class="card_animation_receiver svelte-1boxe40"><!></div>'),Is=n("<!> <!> <!> <!>",1),Rs=n('<td><div role="listitem"><!></div></td>');function Ws(d,i){mt(i,!1);let t=Ve(i,"view",12),v=Ve(i,"row",8),p=Ve(i,"column",8),c=Ve(i,"selectedEntities",28,()=>[]),u=Ve(i,"selectedCells",28,()=>[]),l=be(t().getCell(v(),p())),B=be(new aa(e(l).field.duel.duelists.Above.lp,{duration:400,easing:ca})),R=be(new aa(e(l).field.duel.duelists.Below.lp,{duration:400,easing:ca}));const D=()=>{C(l,t().getCell(v(),p())),Me(B,e(B).target=e(l).field.duel.duelists.Above.lp),Me(R,e(R).target=e(l).field.duel.duelists.Below.lp)};e(l).onUpdate.append(D),t().onDuelUpdate.append(D),t().modalController.onUpdate.append(D);let S,o=be([]),U=()=>console.log("hoge"),X,H=be([]),M=be(!1),E=be(!1),le=!1;const he=$=>{var z,L;C(ae,[]),c().reset(),S=$.activator,U=$.resolve,C(o,$.dummyActionInfos),C(H,$.chainBlockInfos.flatMap(ee=>ee.selectedEntities).getDistinct()),X=$.entitiesChoices,C(M,!1),C(E,((z=$.cellsChoices)==null?void 0:z.selectables.includes(e(l)))??!1),le=e(E)&&((L=$.cellsChoices)==null?void 0:L.qty)===1,D()};t().onWaitStart.append(he);const $e=()=>{S=void 0,C(o,[]),U=()=>{console.log("hoge")},X=void 0,C(H,[]),C(M,!1),C(E,!1),le=!1};t().onWaitEnd.append($e);let w=be(!1),j=[];const W=$=>{j=$.filter(z=>z.dests.includes(e(l))),C(w,j.length>0),D()},J=()=>{j=[],C(w,!1),D()};t().onDragStart.append(W),t().onDragEnd.append(J);const[ke,re]=ti;let ae=be([]);const je=$=>{if(S=void 0,e(l)===$.to||e(l).entities.includes($.entity)){C(ae,[...e(ae),$]);const z=$.resolve;C(l,e(l)),setTimeout(()=>{C(ae,e(ae).filter(L=>L!==$)),$.count++,$.count>1&&z()},600)}};t().onAnimation.append(je);const T=$=>{U({phaseChange:$})},F=()=>e(l).isStackCell&&e(l).entities.flatMap($=>$.actions).filter($=>e(o).map(z=>z.action.seq).some(z=>z===$.seq)).length>0,K=$=>{var z;if(((z=$.target)==null?void 0:z.id)==="config_button"){t(t().infoBoardState="Config",!0),t().requireUpdate();return}if(t(t().infoBoardState="Default",!0),le)U({selectedCells:[e(l)]});else if(e(E))C(M,!e(M)),u(e(M)?[...u(),e(l)]:u().filter(L=>L!==e(l)));else if(e(l).isStackCell){t(t().infoBoardState="CellInfo",!0),t(t().infoBoardCell=e(l),!0),t().requireUpdate();const L=e(l).entities.flatMap(se=>se.actions).map(se=>se.seq),ee=e(o).filter(se=>L.includes(se.action.seq));if(ee.length){if(!S)return;t().modalController.actionSelector.show({title:"カードを選択。",position:"Bottom",activator:S,dummyActionInfos:ee,cancelable:!0}).then(se=>{se&&U({actionInfo:se})});return}}t().requireUpdate(),console.info(e(l),_e(...e(l).visibleEntities))},ce=$=>{$.preventDefault(),$.dataTransfer&&($.dataTransfer.dropEffect="move")},xe=$=>{$.preventDefault(),console.info("drop",$,e(w),j),$.dataTransfer&&($.dataTransfer.dropEffect="move");try{if(e(w)&&j){if(j.length===1){const z=j[0];U({actionInfo:{...z,dest:e(l)}})}else if(j.length>1){if(!S)throw new Ka("想定されない状態");e(l).field.duel.view.modalController.terminateAll(),e(l).field.duel.view.modalController.actionSelector.show({title:"選択",position:"Bottom",activator:S,dummyActionInfos:j.map(z=>({...z,dest:e(l)})),cancelable:!1}).then(z=>{U({actionInfo:z})})}}}finally{t().removeDraggingActions()}},_e=(...$)=>{if(t().waitMode==="Animation")return"Disabled";if(X&&X.selectables.find(L=>$.find(ee=>L===ee)))return"Selectable";if(!e(o)||e(o).length===0||t().waitMode!=="Free"||Object.values(t().modalController.modals).some(L=>L.state==="Shown"))return"Disabled";const z=e(o).filter(L=>$.includes(L.action.entity));return z.length===0?"Disabled":e(l).isStackCell||z[0].action.entity!==$[0]?"Clickable":z.some(L=>L.dests.length)?"Draggable":"Clickable"};gt();var A=Rs(),h=a(A);h.__click=K;var I=a(h);{var Z=$=>{var z=ze(),L=Y(z);{var ee=se=>{var ge=ze(),f=Y(ge);{var x=g=>{var N=Ss(),P=a(N),we=a(P),pe=s(P,1,!0);y((ue,Q)=>{m(we,ue),m(pe,Q)},[()=>String(e(l).field.duel.clock.turn).padStart(2,"0"),()=>e(l).field.duel.phase.toUpperCase()],de),r(g,N)},_=g=>{var N=ze(),P=Y(N);{var we=ue=>{var Q=qs(),V=a(Q),O=a(V),ye=s(V,2),Re=a(ye);y((We,Fe)=>{m(O,We),m(Re,Fe)},[()=>Math.floor(e(B).current),()=>Math.floor(e(R).current)],de),r(ue,Q)},pe=ue=>{var Q=ze(),V=Y(Q);{var O=ye=>{var Re=ze(),We=Y(Re);{var Fe=Le=>{var Xe=ze(),Ee=Y(Xe);{var me=Ce=>{var Ae=ze(),Oe=Y(Ae);ne(Oe,1,()=>t().duel.nextPhaseList,oe,(Ke,Se)=>{var Te=zs(),k=a(Te);k.__click=[Ms,T,Se];var q=a(k);y(G=>m(q,G),[()=>e(Se).toUpperCase()],de),r(Ke,Te)}),r(Ce,Ae)};b(Ee,Ce=>{t().duel.isEnded||Ce(me)})}r(Le,Xe)};b(We,Le=>{t().waitMode==="Free"&&Le(Fe)})}r(ye,Re)};b(V,ye=>{e(l).column===5&&ye(O)},!0)}r(ue,Q)};b(P,ue=>{e(l).column===3?ue(we):ue(pe,!1)},!0)}r(g,N)};b(f,g=>{e(l).column===1?g(x):g(_,!1)})}r(se,ge)};b(L,se=>{e(l).row===3&&se(ee)})}r($,z)},ie=$=>{var z=ze(),L=Y(z);{var ee=ge=>{var f=As();const x=de(()=>e(ae).find(Q=>Q.to===e(l)));var _=Y(f);{var g=Q=>{var V=js(),O=a(V);Nt(O,{get entity(){return e(x).entity},state:"Disabled",dummyActionInfos:[],cardActionResolve:void 0}),y(()=>Ue(V,`card_animation_receiver ${e(l).cellType??""} svelte-1boxe40`)),te(1,V,()=>re,()=>({key:e(x).entity.seq})),r(Q,V)};b(_,Q=>{e(x)&&e(x).index==="Top"&&Q(g)})}var N=s(_,2);ne(N,1,()=>e(l).visibleEntities,oe,(Q,V)=>{var O=ze(),ye=Y(O);{var Re=We=>{var Fe=Ts(),Le=a(Fe);const Xe=de(()=>_e(e(V))),Ee=de(()=>e(o).filter(me=>me.action.entity===e(V)));Nt(Le,{get entity(){return e(V)},get state(){return e(Xe)},get dummyActionInfos(){return e(Ee)},cardActionResolve:void 0,get selectedList(){return c()},set selectedList(me){c(me)},$$legacy:!0}),te(2,Fe,()=>ke,()=>({key:e(V).seq})),r(We,Fe)};b(ye,We=>{e(ae).every(Fe=>Fe.entity.seq!==e(V).seq)&&We(Re)})}r(Q,O)});var P=s(N,2);{var we=Q=>{var V=Bs(),O=a(V);Nt(O,{get entity(){return e(x).entity},state:"Disabled",dummyActionInfos:[],cardActionResolve:void 0}),y(()=>Ue(V,`card_animation_receiver ${e(l).cellType??""} svelte-1boxe40`)),te(1,V,()=>re,()=>({key:e(x).entity.seq})),r(Q,V)};b(P,Q=>{e(x)&&e(x).index!=="Top"&&Q(we)})}var pe=s(P,2);{var ue=Q=>{var V=Es();r(Q,V)};b(pe,Q=>{e(l).owner.seat==="Below"&&Q(ue)})}r(ge,f)},se=ge=>{var f=Is();const x=de(()=>e(ae).find(V=>V.to===e(l)));var _=Y(f);{var g=V=>{var O=Ys(),ye=a(O);Nt(ye,{get entity(){return e(x).entity},state:"Disabled",dummyActionInfos:[],cardActionResolve:void 0}),te(1,O,()=>re,()=>({key:e(x).entity.seq})),r(V,O)};b(_,V=>{e(x)&&e(x).index!=="Top"&&V(g)})}var N=s(_,2);{var P=V=>{var O=Fs(),ye=Y(O);ne(ye,1,()=>e(l).visibleEntities.map((Fe,Le)=>({index:Le,entity:Fe})).toReversed(),oe,(Fe,Le)=>{var Xe=ze(),Ee=Y(Xe);{var me=Ce=>{var Ae=Ls();const Oe=de(()=>!e(l).isStackCell&&e(Le).index===0?_e(...e(l).visibleEntities):void 0);var Ke=Y(Ae);{var Se=G=>{var De=Us();r(G,De)};b(Ke,G=>{e(H).includes(e(Le).entity)&&G(Se)})}var Te=s(Ke,2),k=a(Te);const q=de(()=>e(Le).index===0?e(o).filter(G=>e(l).visibleEntities.includes(G.action.entity)):void 0);Nt(k,{get entity(){return e(Le).entity},get state(){return e(Oe)},get dummyActionInfos(){return e(q)},cardActionResolve:void 0,get selectedList(){return c()},set selectedList(G){c(G)},$$legacy:!0}),y(()=>Ue(Te,`duel_card_wrapper ${(e(Le).entity.exist?"duel_card_wrapper_exists":"")??""} svelte-1boxe40`)),te(2,Te,()=>ke,()=>({key:e(Le).entity.seq})),r(Ce,Ae)};b(Ee,Ce=>{e(ae).every(Ae=>Ae.entity.seq!==e(Le).entity.seq)&&Ce(me)})}r(Fe,Xe)});var Re=s(ye,2);{var We=Fe=>{var Le=Ps(),Xe=a(Le),Ee=s(Xe);ne(Ee,1,()=>fa(e(l).visibleEntities[0].status.maxCounterQty),oe,(me,Ce)=>{var Ae=Ns(),Oe=Y(Ae),Ke=s(Oe);{var Se=Te=>{var k=dt();y(()=>m(k,`/${e(l).visibleEntities[0].status.maxCounterQty[e(Ce)]??""}`)),r(Te,k)};b(Ke,Te=>{(e(l).visibleEntities[0].status.maxCounterQty[e(Ce)]??9999)<100&&Te(Se)})}y((Te,k)=>m(Oe,`【
              ${Te??""}${k??""} `),[()=>Va(e(Ce)),()=>e(l).visibleEntities[0].counterHolder.getQty(e(Ce))],de),r(me,Ae)}),y(()=>m(Xe,`【${e(l).visibleEntities[0].battlePositionName??""}】 `)),r(Fe,Le)};b(Re,Fe=>{e(l).visibleEntities[0].battlePosition&&Fe(We)})}r(V,O)};b(N,V=>{e(l).visibleEntities.length>0&&V(P)})}var we=s(N,2);{var pe=V=>{var O=Hs(),ye=a(O);y(()=>m(ye,e(l).visibleEntities.length)),r(V,O)};b(we,V=>{e(l).isStackCell&&V(pe)})}var ue=s(we,2);{var Q=V=>{var O=Os(),ye=a(O);Nt(ye,{get entity(){return e(x).entity},state:"Disabled",dummyActionInfos:[],cardActionResolve:void 0}),te(1,O,()=>re,()=>({key:e(x).entity.seq})),r(V,O)};b(ue,V=>{e(x)&&e(x).index==="Top"&&V(Q)})}r(ge,f)};b(L,ge=>{e(l).cellType==="Hand"?ge(ee):ge(se,!1)},!0)}r($,z)};b(I,$=>{e(l).isDisabledCell?$(Z):$(ie,!1)})}y($=>{Ue(A,`${`duel_field_cell duel_field_cell_${e(l).cellType} ${e(l).linkArrowSources.length===0?"":"duel_field_cell_linked"}`??""} svelte-1boxe40`),wt(A,"colspan",e(l).cellType==="Hand"?7:1),Ue(h,`${$??""} svelte-1boxe40`)},[()=>`duel_field_cell_inner_box ${e(l).cellType} ${e(w)?"can_accept_drop":""} ${F()?"can_action":""} ${e(M)?"is_selected":e(E)?"is_selectable":""} `],de),ve("dragover",h,ce),ve("drop",h,xe),r(d,A),bt()}La(["click"]);const Ks=(d,i,t=void 0,v="!!!circular reference!!!")=>{let p=[];return JSON.stringify(d,(c,u)=>{if(typeof u=="object"){if(p.indexOf(u)>-1)return v;p.push(u)}let l=u;if(i&&(l=i(c,u)),typeof l=="function")return l.toString();if(l!==u&&typeof l=="object"){if(p.indexOf(l)>-1)return v;p.push(l)}return l},t)};var Vs=n('<div class="title svelte-14z6bdh"> </div>'),Gs=n('<div class="title svelte-14z6bdh"> </div>'),Xs=n('<div class="duel_log_chain_number svelte-14z6bdh"> </div>'),Qs=n('<div><a class="white_button" download="error_info.json">エラー情報ダウンロード</a></div>'),Js=n("<div><!> <!></div>"),Zs=n('<div><div style="display: flex;    justify-content: space-between;"><div style=" white-space: nowrap;text-align: center;"> </div> <!></div> <!></div>'),er=n("<div><!> <!></div>"),tr=n("<div><!> <!></div>"),ar=n('<div class="duel_log svelte-14z6bdh"><div class="duel_log_header svelte-14z6bdh"></div> <div class="duel_log_body svelte-14z6bdh"></div> <div class="duel_log_footer svelte-14z6bdh"></div></div>');function sr(d,i){mt(i,!1);let t=be(void 0),v=Ve(i,"log",8),p,c=be([]);const u=()=>{const D=((p==null?void 0:p.seq)??-1)+1;v().records.slice(D).forEach(S=>{if(!p){C(c,[[[[S]]]]),p=S;return}if(!e(c)[S.clock.turn]){Me(c,e(c)[S.clock.turn]=[[[S]]]),p=S;return}if(!e(c)[S.clock.turn][S.clock.phaseSeq]){Me(c,e(c)[S.clock.turn][S.clock.phaseSeq]=[[S]]),p=S;return}if(p.clock.chainSeq===S.clock.chainSeq&&p.clock.chainBlockSeq===S.clock.chainBlockSeq&&p.duelist===S.duelist){e(c)[S.clock.turn][S.clock.phaseSeq].slice(-1)[0].push(S),p=S;return}e(c)[S.clock.turn][S.clock.phaseSeq].push([S]),p=S}),C(c,e(c)),Ga().then(()=>e(t)&&e(t).scroll(0,e(t).clientHeight*990))};v().onUpdate.append(u),v().duel.view.onDuelUpdate.append(u),u(),gt();var l=ze(),B=Y(l);{var R=D=>{var S=ar(),o=s(a(S),2);ne(o,5,()=>e(c),oe,(U,X)=>{var H=tr(),M=a(H);{var E=he=>{var $e=Vs(),w=a($e);y(()=>m(w,`ターン：${e(X)[0][0][0].clock.turn??""}`)),r(he,$e)};b(M,he=>{e(X)[0][0][0].clock.turn>0&&he(E)})}var le=s(M,2);ne(le,1,()=>e(X),oe,(he,$e)=>{var w=er(),j=a(w);{var W=ke=>{var re=Gs(),ae=a(re);y(()=>m(ae,e($e)[0][0].clock.period.name)),r(ke,re)};b(j,ke=>{e($e)[0][0].clock.turn>0&&ke(W)})}var J=s(j,2);ne(J,1,()=>e($e),oe,(ke,re)=>{var ae=Zs();const je=de(()=>{var A;return((A=e(re).find(h=>h.chainNumber!==void 0))==null?void 0:A.chainNumber)??0});var T=a(ae),F=a(T),K=a(F),ce=s(F,2);{var xe=A=>{var h=Xs(),I=a(h);y(()=>m(I,`チェーン：${e(je)??""}`)),r(A,h)};b(ce,A=>{e(je)&&A(xe)})}var _e=s(T,2);ne(_e,1,()=>e(re),oe,(A,h)=>{var I=Js(),Z=a(I);{var ie=ee=>{var se=dt();y(()=>m(se,e(h).text)),r(ee,se)},$=ee=>{var se=ze(),ge=Y(se);{var f=_=>{var g=dt();y((N,P,we)=>m(g,`移動：${N??""} ${P??""} ⇒ ${we??""}`),[()=>{var N;return(N=e(h).mainEntity)==null?void 0:N.toString()},()=>{var N;return(N=e(h).from)==null?void 0:N.toString()},()=>{var N;return(N=e(h).to)==null?void 0:N.toString()}],de),r(_,g)},x=_=>{var g=ze(),N=Y(g);{var P=pe=>{var ue=dt();y((Q,V)=>m(ue,`生成：${Q??""} void ⇒ ${V??""}`),[()=>{var Q;return(Q=e(h).mainEntity)==null?void 0:Q.toString()},()=>{var Q;return(Q=e(h).to)==null?void 0:Q.toString()}],de),r(pe,ue)},we=pe=>{var ue=ze(),Q=Y(ue);{var V=ye=>{var Re=dt();y((We,Fe)=>m(Re,`消滅：${We??""} ${Fe??""} ⇒ void`),[()=>{var We;return(We=e(h).mainEntity)==null?void 0:We.toString()},()=>{var We;return(We=e(h).from)==null?void 0:We.toString()}],de),r(ye,Re)},O=ye=>{var Re=dt();y(()=>m(Re,e(h).text)),r(ye,Re)};b(Q,ye=>{e(h).type==="EntityDisappear"?ye(V):ye(O,!1)},!0)}r(pe,ue)};b(N,pe=>{e(h).type==="EntityAppear"?pe(P):pe(we,!1)},!0)}r(_,g)};b(ge,_=>{e(h).type==="EntityMove"?_(f):_(x,!1)},!0)}r(ee,se)};b(Z,ee=>{e(h).type==="ChainBlockHeader"?ee(ie):ee($,!1)})}var z=s(Z,2);{var L=ee=>{var se=Qs(),ge=a(se);y(f=>wt(ge,"href",f),[()=>window.URL.createObjectURL(new Blob([Ks(e(h).error,(f,x)=>["pool","bundles","duel"].includes(f)||typeof x=="function"?void 0:x,4)],{type:"text/plain"}))],de),r(ee,se)};b(z,ee=>{e(h).error&&ee(L)})}y(ee=>Ue(I,`duel_log_record duel_log_record_${ee??""} svelte-14z6bdh`),[()=>e(h).type.toSnakeCase()],de),r(A,I)}),y(()=>{var A,h,I;Ue(ae,`duel_log_block_duelist duel_log_block_duelist_${((A=e(re)[0].duelist)==null?void 0:A.seat)??"system"} svelte-14z6bdh`),Ue(F,`duelist ${((h=e(re)[0].duelist)==null?void 0:h.seat)??""} svelte-14z6bdh`),m(K,((I=e(re)[0].duelist)==null?void 0:I.profile.name)||"SYSTEM")}),r(ke,ae)}),y(()=>Ue(w,`duel_log_block_phase duel_log_block_phase_${e($e)[0][0].clock.period.key??""} svelte-14z6bdh`)),r(he,w)}),y(()=>Ue(H,`duel_log_block_turn duel_log_block_turn_${e(X)[0][0][0].clock.turn??""} svelte-14z6bdh`)),r(U,H)}),Xa(o,U=>C(t,U),()=>e(t)),r(D,S)};b(B,D=>{(v().duel.view.infoBoardState==="Log"||v().duel.view.infoBoardState==="Default")&&D(R)})}r(d,l),bt()}var rr=n("<div><div> </div> <div> </div></div>");function Ya(d,i){mt(i,!1);let t=Ve(i,"duelist",12),v=be(0),p=be();const c=async()=>{const o=t().lp-e(v);if(!e(p)||Math.abs(o)<10){C(v,t().lp),e(p)&&(e(p)(),C(p,void 0));return}C(v,e(v)+Math.floor(Math.random()*o)),await Pt(100),c()},u=()=>{t(t()),!e(p)&&t().lp!==e(v)&&new Promise(o=>{C(p,o),Math.abs(t().lp-e(v)),c()})};t().duel.log.onUpdate.append(u),c(),gt();var l=rr(),B=a(l),R=a(B),D=s(B,2),S=a(D);y(o=>{Ue(l,`duelist duelist_${o??""} svelte-1sy3trd`),Ue(B,`duelist_name duelist_${o??""}_name svelte-1sy3trd`),m(R,t().profile.name),Ue(D,`duelist_lp ${(e(p)?"vibration":"")??""} svelte-1sy3trd`),m(S,e(v))},[()=>t().seat.toLowerCase()],de),r(d,l),bt()}const ir=(d,i,t)=>(i(i()!=="Detail"?"Detail":"Normal"),console.info(t()),!0),nr=(d,i,t)=>(i(i()!=="Debug"?"Debug":"Normal"),console.info(t()),!0);var or=n('<div class="duel_card_info_row svelte-1uevs9j" style=" justify-content: space-between;"><div class="svelte-1uevs9j"> </div> <div class="svelte-1uevs9j"> </div></div>'),lr=n('<div></div> <div class="svelte-1uevs9j"> </div>',1),vr=n("<div> </div>"),dr=n('<span class="svelte-1uevs9j">/</span> <div class="monster_defense svelte-1uevs9j"> </div>',1),cr=n("<div> </div>"),_r=n('<div class="duel_card_info_row svelte-1uevs9j"><!> <!> <div style="flex-grow: 1;" class="svelte-1uevs9j"></div> <div class="monster_attack svelte-1uevs9j"> </div> <!></div> <div class="duel_card_info_row svelte-1uevs9j"></div>',1),ur=n('<div class="duel_card_row svelte-1uevs9j"><div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"> </div></div>'),fr=n('<div class="duel_card_row svelte-1uevs9j"><div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"> </div></div>'),pr=n("<!> <!>",1),yr=n('<pre class="description svelte-1uevs9j"> </pre>'),mr=n('<div class="duel_card_info_row svelte-1uevs9j" style="border-style: solid; border-width: 1px;"><!></div>'),gr=n('<pre class="description svelte-1uevs9j"> </pre>'),br=n('<!> <div class="duel_card_info_row svelte-1uevs9j"><!></div>',1),hr=n('<div class="effect_counter_area_item svelte-1uevs9j"><span class="svelte-1uevs9j"> </span> <span class="svelte-1uevs9j"> </span> <span class="svelte-1uevs9j">/</span> <span class="svelte-1uevs9j"> </span></div>'),wr=n('<div class="duel_card_info_row effect_counter_area svelte-1uevs9j"><div class="effect_counter_area_title svelte-1uevs9j">効果使用状況</div> <div class="effect_counter_area_body svelte-1uevs9j"></div></div>'),kr=n("[ <!> ],",1),xr=n('<div class="svelte-1uevs9j"> <!></div>'),Cr=n('<div class="svelte-1uevs9j"> </div> <!> <div class="svelte-1uevs9j"></div>',1),Dr=n('<div class="svelte-1uevs9j"> </div>'),$r=n('<div class="svelte-1uevs9j"> </div>'),Sr=n('<div class="svelte-1uevs9j"> </div>'),qr=n('<div class="svelte-1uevs9j"> </div>'),Mr=n('<div class="svelte-1uevs9j"> </div>'),zr=n('<div class="svelte-1uevs9j"> </div>'),jr=n('<div class="duel_card_info_row svelte-1uevs9j"><div class="svelte-1uevs9j"><!> <div class="svelte-1uevs9j"></div> <!> <div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"></div> <!> <div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"></div> <!> <div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"></div> <!> <div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"></div> <!> <div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"></div> <!> <div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"> </div> <div class="svelte-1uevs9j"> </div> <div class="svelte-1uevs9j"> </div> <div class="svelte-1uevs9j"></div></div></div>'),Tr=n('<div class="svelte-1uevs9j">※エラッタ前のカードです</div>'),Br=n('<div class="svelte-1uevs9j">※テスト用カードです</div>'),Er=n('<a target="_blank" rel="noopener noreferrer" title="コナミカードデータベース" class="svelte-1uevs9j"> </a>'),Ar=n('<div class="duel_card_info_links svelte-1uevs9j"><a target="_blank" rel="noopener noreferrer" title="遊戯王カードWiki" class="svelte-1uevs9j">⇒遊戯王カードWiki</a> <!></div>'),Yr=n("<!> <!>",1),Ur=n('<div role="contentinfo"><div class="duel_card_info_header svelte-1uevs9j"><div class="duel_card_info_row svelte-1uevs9j"><div class="svelte-1uevs9j"> </div></div> <div class="duel_card_info_row svelte-1uevs9j" style="position:sticky; top:0;"><div class="svelte-1uevs9j"> </div> <div class="svelte-1uevs9j"> </div></div> <!></div> <div class="duel_card_info_body svelte-1uevs9j"><!></div> <div class="duel_card_info_footer svelte-1uevs9j"><!></div></div>');function Lr(d,i){mt(i,!1);let t=Ve(i,"entity",8,void 0),v=Ve(i,"mode",12,"Normal");const p=async()=>{if(!t())return;const D=(await Gt).getCardInfo(t().origin.name);if(D)return D.cardId!==void 0&&!D.description&&!D.pendulumDescription&&await Na([D.cardId]),D},c=()=>t()&&t().entityType==="Card"&&(t().origin.cardId??!1)?`https://www.db.yugioh-card.com/yugiohdb/card_search.action?ope=2&cid=${t().origin.cardId}`:t()?`https://www.db.yugioh-card.com/yugiohdb/card_search.action?ope=1&sess=1&rp=10&mode=&sort=1&keyword=${t().origin.name}&stype=1&ctype=&othercon=2&starfr=&starto=&pscalefr=&pscaleto=&linkmarkerfr=&linkmarkerto=&link_m=2&atkfr=&atkto=&deffr=&defto=&releaseDStart=1&releaseMStart=1&releaseYStart=1999&releaseDEnd=&releaseMEnd=&releaseYEnd=`:"";gt();var u=ze(),l=Y(u);{var B=R=>{var D=Ur();D.__click=[ir,v,t],D.__contextmenu=[nr,v,t];var S=a(D),o=a(S),U=a(o),X=a(U),H=s(o,2),M=a(H),E=a(M),le=s(M,2),he=a(le),$e=s(H,2);{var w=T=>{var F=pr(),K=Y(F);{var ce=h=>{var I=or(),Z=a(I),ie=a(Z),$=s(Z,2),z=a($);y(()=>{m(ie,`◀ ${t().psL??""}`),m(z,`${t().psR??""} ▶`)}),r(h,I)};b(K,h=>{var I;(I=t().origin.monsterCategories)!=null&&I.includes("Pendulum")&&h(ce)})}var xe=s(K,2);{var _e=h=>{var I=_r(),Z=Y(I),ie=a(Z);ne(ie,1,()=>t().attr,oe,(f,x)=>{var _=lr(),g=Y(_),N=s(g,2),P=a(N);y(()=>{Ue(g,`monster_attr ${e(x)??""} svelte-1uevs9j`),m(P,`${pa[e(x)]??""}属性`)}),r(f,_)});var $=s(ie,2);ne($,1,()=>t().types,oe,(f,x)=>{var _=vr(),g=a(_);y(()=>{Ue(_,`monster_cat ${e(x)??""} svelte-1uevs9j`),m(g,`${ra[e(x)]??""}${ya[e(x)]??""}族`)}),r(f,_)});var z=s($,4),L=a(z),ee=s(z,2);{var se=f=>{var x=dr(),_=s(Y(x),2),g=a(_);y(()=>m(g,t().def??"?")),r(f,x)};b(ee,f=>{var x;(x=t().status.monsterCategories)!=null&&x.includes("Link")||f(se)})}var ge=s(Z,2);ne(ge,5,()=>t().status.monsterCategories??[],oe,(f,x)=>{var _=cr(),g=a(_);y(()=>{Ue(_,`monster_cat ${e(x)??""} svelte-1uevs9j`),m(g,`${Xt[e(x)]??""}${ea[e(x)]??""}`)}),r(f,_)}),y(()=>m(L,t().atk??"?")),r(h,I)},A=h=>{var I=ze(),Z=Y(I);{var ie=z=>{var L=ur(),ee=s(a(L),2),se=a(ee);y(()=>m(se,`${ia[t().status.spellCategory]??""}魔法`)),r(z,L)},$=z=>{var L=ze(),ee=Y(L);{var se=ge=>{var f=fr(),x=s(a(f),2),_=a(x);y(()=>m(_,`${na[t().status.trapCategory]??""}罠`)),r(ge,f)};b(ee,ge=>{t().kind==="Trap"&&t().status.trapCategory&&ge(se)},!0)}r(z,L)};b(Z,z=>{t().kind==="Spell"&&t().status.spellCategory?z(ie):z($,!1)},!0)}r(h,I)};b(xe,h=>{t().kind==="Monster"?h(_e):h(A,!1)})}r(T,F)};b($e,T=>{v()!=="Debug"&&T(w)})}var j=s(S,2),W=a(j);{var J=T=>{var F=br(),K=Y(F);{var ce=A=>{var h=mr(),I=a(h);yt(I,p,Z=>{var ie=dt('"読み込み中"');r(Z,ie)},(Z,ie)=>{var $=yr(),z=a($);y(()=>{var L;return m(z,(L=e(ie))==null?void 0:L.pendulumDescription)}),r(Z,$)}),r(A,h)};b(K,A=>{var h;(h=t().status.monsterCategories)!=null&&h.includes("Pendulum")&&A(ce)})}var xe=s(K,2),_e=a(xe);yt(_e,p,A=>{var h=dt('"読み込み中"');r(A,h)},(A,h)=>{var I=gr(),Z=a(I);y(()=>{var ie;return m(Z,(ie=e(h))==null?void 0:ie.description)}),r(A,I)}),r(T,F)},ke=T=>{var F=ze(),K=Y(F);{var ce=_e=>{var A=ze(),h=Y(A);{var I=Z=>{var ie=wr(),$=s(a(ie),2);ne($,5,()=>t().actions,oe,(z,L)=>{var ee=ze();const se=de(()=>e(L).actionCountUpperBound),ge=de(()=>e(L).actionCount);var f=Y(ee);{var x=_=>{var g=hr(),N=a(g),P=a(N),we=s(N,2),pe=a(we),ue=s(we,4),Q=a(ue);y(()=>{m(P,e(L).title),m(pe,e(ge)),m(Q,e(se))}),r(_,g)};b(f,_=>{e(se)!==void 0&&e(ge)!==void 0&&_(x)})}r(z,ee)}),r(Z,ie)};b(h,Z=>{t().actions.some(ie=>ie.actionCountUpperBoundKey)&&Z(I)})}r(_e,A)},xe=_e=>{var A=jr(),h=a(A),I=a(h);ne(I,0,()=>["info","status"],oe,(Ee,me)=>{var Ce=Cr(),Ae=Y(Ce),Oe=a(Ae),Ke=s(Ae,2);ne(Ke,1,()=>Object.entries(t()[me]),oe,(Te,k)=>{let q=()=>e(k)[0],G=()=>e(k)[1];var De=xr(),Ie=a(De),Ge=s(Ie);{var Ye=qe=>{var He=kr(),Qe=s(Y(He));ne(Qe,1,G,oe,(ct,At)=>{var St=dt();y(qt=>m(St,`${qt??""},`),[()=>e(At).toString()],de),r(ct,St)}),r(qe,He)},Pe=qe=>{var He=dt();y(Qe=>m(He,`${Qe??""},`),[()=>{var Qe;return(Qe=G())==null?void 0:Qe.toString()}],de),r(qe,He)};b(Ge,qe=>{Array.isArray(G())?qe(Ye):qe(Pe,!1)})}y(()=>m(Ie,`"${q()??""}" : `)),r(Te,De)});var Se=s(Ke,2);Se.textContent="},",y(()=>m(Oe,`"${me??""}" :{`)),r(Ee,Ce)});var Z=s(I,2);Z.textContent='"actions" :[';var ie=s(Z,2);ne(ie,1,()=>t().actions,oe,(Ee,me)=>{var Ce=Dr(),Ae=a(Ce);y(()=>m(Ae,`"${e(me).playType??""} ${e(me).title??""}",`)),r(Ee,Ce)});var $=s(ie,2);$.textContent="],";var z=s($,2);z.textContent='"substituteEffects" :[';var L=s(z,2);ne(L,1,()=>t().substituteEffects,oe,(Ee,me)=>{var Ce=$r(),Ae=a(Ce);y(()=>m(Ae,`"${e(me).title??""}",`)),r(Ee,Ce)});var ee=s(L,2);ee.textContent="],";var se=s(ee,2);se.textContent='"continuousEffects" :[';var ge=s(se,2);ne(ge,1,()=>t().continuousEffects,oe,(Ee,me)=>{var Ce=Sr(),Ae=a(Ce);y(()=>m(Ae,`"${e(me).isStarted??""}",`)),r(Ee,Ce)});var f=s(ge,2);f.textContent="],";var x=s(f,2);x.textContent='"procFilters" :[';var _=s(x,2);ne(_,1,()=>t().procFilterBundle.operators,oe,(Ee,me)=>{var Ce=qr(),Ae=a(Ce);y(Oe=>m(Ae,`"${Oe??""} ${e(me).title??""} ${e(me).isEffective??""} ",`),[()=>e(me).isSpawnedBy.toString()],de),r(Ee,Ce)});var g=s(_,2);g.textContent="],";var N=s(g,2);N.textContent='"numericStateOperators" :[';var P=s(N,2);ne(P,1,()=>t().numericOprsBundle.operators,oe,(Ee,me)=>{var Ce=Mr(),Ae=a(Ce);y(Oe=>m(Ae,`"${Oe??""} ${e(me).title??""} ${e(me).isEffective??""} ${e(me).isContinuous??""} ${e(me).targetState??""} ${e(me).targetStateGen??""} ",`),[()=>e(me).isSpawnedBy.toString()],de),r(Ee,Ce)});var we=s(P,2);we.textContent="],";var pe=s(we,2);pe.textContent='"stateOperators" :[';var ue=s(pe,2);ne(ue,1,()=>t().statusOperatorBundle.operators,oe,(Ee,me)=>{var Ce=zr(),Ae=a(Ce);y(Oe=>m(Ae,`"${Oe??""} ${e(me).title??""} ${e(me).isEffective??""} ",`),[()=>e(me).isSpawnedBy.toString()],de),r(Ee,Ce)});var Q=s(ue,2);Q.textContent="],";var V=s(Q,2);V.textContent='"lastMoveLogRecord" :{';var O=s(V,2),ye=a(O),Re=s(O,2),We=a(Re),Fe=s(Re,2),Le=a(Fe),Xe=s(Fe,2);Xe.textContent="},",y((Ee,me)=>{m(ye,`"movedBy":"${Ee??""}",`),m(We,`"movedAs":"${me??""}",`),m(Le,`"movedAt":"${t().moveLog.latestRecord.movedAt.totalProcSeq??""}",`)},[()=>{var Ee;return(Ee=t().moveLog.latestRecord.movedBy)==null?void 0:Ee.toString()},()=>t().moveLog.latestRecord.movedAs.join(" ")],de),r(_e,A)};b(K,_e=>{v()==="Detail"?_e(ce):_e(xe,!1)},!0)}r(T,F)};b(W,T=>{v()==="Normal"?T(J):T(ke,!1)})}var re=s(j,2),ae=a(re);{var je=T=>{var F=Yr(),K=Y(F);{var ce=h=>{var I=Tr();r(h,I)};b(K,h=>{t().origin.isOldVersion&&h(ce)})}var xe=s(K,2);{var _e=h=>{var I=Br();r(h,I)},A=h=>{var I=Ar(),Z=a(I),ie=s(Z,2);{var $=z=>{var L=Er(),ee=a(L);y(se=>{var ge;wt(L,"href",se),m(ee,`⇒${((ge=t())!=null&&ge.origin.cardId?"公式カードページ":"公式で検索")??""}`)},[c],de),r(z,L)};b(ie,z=>{t()&&t().entityType==="Card"&&z($)})}y(()=>wt(Z,"href",`https://yugioh-wiki.net/index.php?${t().origin.wikiEncodedName}`)),r(h,I)};b(xe,h=>{t().origin.isForTest?h(_e):h(A,!1)})}r(T,F)};b(ae,T=>{t()&&T(je)})}y((T,F,K)=>{Ue(D,`duel_card duel_card_info ${t().origin.kind??""} ${T??""} svelte-1uevs9j`),m(X,t().nm),m(E,F),m(he,K)},[()=>{var T;return(T=t().origin.monsterCategories)==null?void 0:T.join(" ")},()=>"★".repeat(t().lvl||0),()=>"☆".repeat(t().rank||0)],de),r(R,D)};b(l,R=>{t()&&R(B)})}r(d,u),bt()}La(["click","contextmenu"]);var Nr=n('<div class="duel_field_cell_info_item svelte-1xj7qf1"><!></div>'),Pr=n('<div class="duel_field_cell_info_box svelte-1xj7qf1"><div class="duel_field_cell_info_label svelte-1xj7qf1"> </div> <!></div>'),Fr=n('<div class="duel_field_cell_info svelte-1xj7qf1"><div class="duel_field_cell_info_header item_btn svelte-1xj7qf1"><div class="svelte-1xj7qf1"> </div> <div class="svelte-1xj7qf1"> </div></div> <div class="duel_field_cell_info_body svelte-1xj7qf1"></div></div>');function Hr(d,i){mt(i,!1);let t=Ve(i,"cell",12);const v=()=>{t(t())},p=B=>t().cardEntities.filter(R=>R.face===B);t().field.duel.view.onDuelUpdate.append(v),gt();var c=ze(),u=Y(c);{var l=B=>{var R=Fr(),D=a(R),S=a(D),o=a(S),U=s(S,2),X=a(U),H=s(D,2);ne(H,4,()=>["FaceUp","FaceDown"],oe,(M,E)=>{var le=ze(),he=Y(le);{var $e=w=>{var j=Pr(),W=a(j),J=a(W),ke=s(W,2);ne(ke,1,()=>p(E).toSorted(Qa),oe,(re,ae)=>{var je=Nr(),T=a(je);const F=de(()=>t().owner===t().field.duel.duelists.Below);Nt(T,{get entity(){return e(ae)},get isVisibleForcibly(){return e(F)},isWideMode:!0,cardActionResolve:void 0}),r(re,je)}),y(()=>m(J,E==="FaceUp"?"表向き":"裏向き")),r(w,j)};b(he,w=>{p(E).length&&w($e)})}r(M,le)}),y(()=>{var M;m(o,(M=t().owner)==null?void 0:M.profile.name),m(X,t().cellType)}),r(B,R)};b(u,B=>{t().field.duel.view.infoBoardState==="CellInfo"&&B(l)})}r(d,c),bt()}var Or=n('<div class="duel_config_item svelte-y4u26k"><label class="toggle svelte-y4u26k"><input type="checkbox" class="svelte-y4u26k"></label> <span class="svelte-y4u26k"> </span></div>'),Ir=n('<div class="duel_config svelte-y4u26k"><div class="duel_config_title svelte-y4u26k">デュエル設定</div> <div class="duel_config_group svelte-y4u26k"><div class="duel_config_group_title svelte-y4u26k">チェーン設定</div> <!></div></div>');function Rr(d,i){mt(i,!1);let t=Ve(i,"viewController",8),v=Ve(i,"userProfile",12);gt();var p=ze(),c=Y(p);{var u=l=>{var B=Ir(),R=s(a(B),2),D=s(a(R),2);ne(D,1,()=>es,oe,(S,o)=>{var U=Or(),X=a(U),H=a(X),M=s(X,2),E=a(M);y(()=>m(E,Ja[e(o)])),Za(H,()=>v().chainConfig[e(o)],le=>v(v().chainConfig[e(o)]=le,!0)),ve("change",H,()=>v().save()),r(S,U)}),r(l,B)};b(c,l=>{t().infoBoardState==="Config"&&l(u)})}r(d,p),bt()}function Wr(d,{from:i,to:t},v={}){var{delay:p=0,duration:c=j=>Math.sqrt(j)*120,easing:u=ca}=v,l=getComputedStyle(d),B=l.transform==="none"?"":l.transform,[R,D]=l.transformOrigin.split(" ").map(parseFloat);R/=d.clientWidth,D/=d.clientHeight;var S=Kr(d),o=d.clientWidth/t.width/S,U=d.clientHeight/t.height/S,X=i.left+i.width*R,H=i.top+i.height*D,M=t.left+t.width*R,E=t.top+t.height*D,le=(X-M)*o,he=(H-E)*U,$e=i.width/t.width,w=i.height/t.height;return{delay:p,duration:typeof c=="function"?c(Math.sqrt(le*le+he*he)):c,easing:u,css:(j,W)=>{var J=W*le,ke=W*he,re=j+W*$e,ae=j+W*w;return`transform: ${B} translate(${J}px, ${ke}px) scale(${re}, ${ae});`}}}function Kr(d){if("currentCSSZoom"in d)return d.currentCSSZoom;for(var i=d,t=1;i!==null;)t*=+getComputedStyle(i).zoom,i=i.parentElement;return t}var Vr=n('<div class="chain_number svelte-lqu21u"> </div>'),Gr=n('<div class="duel_card_row svelte-lqu21u"> </div>'),Xr=n('<div class="appendix svelte-lqu21u"> </div>'),Qr=n('<div class="appendix_wrapper svelte-lqu21u"></div>'),Jr=n('<div><div><!> <div> </div> <div><!> <div class="duel_card_row svelte-lqu21u"><div> </div> <!></div></div></div></div>'),Zr=n("<div></div>");function ei(d,i){mt(i,!1);let t=Ve(i,"duel",8),v=Ve(i,"position",8,"left");const p=-100,c=()=>v()==="left"?-100:100;let u=be([]),l=Promise.resolve(),B=Promise.resolve();const R=1e3,D=500,S=400,o=X=>{const H={...X};H.isKnown=X.chainBlockInfo.action.entity.controller.duelistType==="Player"||X.chainBlockInfo.action.entity.face==="FaceUp",H.chainBlockInfo.onStateChange.append(M=>{if(M==="done"||M==="failed"||M==="negated")return l=l.then(async()=>{const E=new Date().getTime()-H.chainBlockInfo.wasSpawnedAt.getTime();E<R&&await Pt(R-E),C(u,e(u).filter(le=>le.seq!==H.seq)),await Pt(D+S)}).then(),"RemoveMe";C(u,e(u))}),B=B.then(async()=>{C(u,[H,...e(u)].sort((M,E)=>ts.isSameChain(M.clock,E.clock)&&M.chainBlockInfo.action.isWithChainBlock&&E.chainBlockInfo.action.isWithChainBlock?E.clock.totalProcSeq-M.clock.totalProcSeq:M.clock.totalProcSeq-E.clock.totalProcSeq)),await Pt(300)}),l=l.then(()=>Pt(1e3))};t().chainBlockLog.onInsert.append(o),gt();var U=Zr();ne(U,13,()=>e(u),X=>X.seq,(X,H)=>{var M=Jr();const E=de(()=>{const{activator:K,action:ce,appendix:xe}=e(H).chainBlockInfo;return{activator:K,action:ce,appendix:xe}});var le=a(M),he=a(le);{var $e=K=>{var ce=Vr(),xe=a(ce);y(()=>m(xe,`チェーン：${e(H).chainBlockInfo.chainNumber??""}`)),r(K,ce)};b(he,K=>{e(H).chainBlockInfo.chainNumber&&K($e)})}var w=s(he,2),j=a(w),W=s(w,2),J=a(W);{var ke=K=>{var ce=Gr(),xe=a(ce);y(()=>m(xe,e(H).isKnown?e(E).action.entity.nm:"？？？")),r(K,ce)};b(J,K=>{(e(E).action.entity.entityType==="Card"||e(E).action.entity.entityType==="Token")&&K(ke)})}var re=s(J,2),ae=a(re),je=a(ae),T=s(ae,2);{var F=K=>{var ce=Qr();ne(ce,5,()=>e(E).appendix,oe,(xe,_e)=>{var A=Xr(),h=a(A);y(()=>m(h,e(_e))),r(xe,A)}),r(K,ce)};b(T,K=>{e(E).appendix&&K(F)})}y((K,ce,xe)=>{Ue(M,`cut_in_row ${(!e(H).chainBlockInfo.chainNumber||e(H).chainBlockInfo.chainNumber===1?"cut_in_row_first":"")??""} svelte-lqu21u`),Ue(le,`cut_in_item cut_in_item_${K??""} cut_in_item_${e(H).chainBlockInfo.state??""} svelte-lqu21u`),Ue(w,`duelist_name duelist_${K??""}_name svelte-lqu21u`),m(j,e(E).activator.profile.name),Ue(W,`duel_card duel_card_${K??""} ${ce??""} ${(e(H).isKnown?e(E).action.entity.origin.kind:"")??""} ${e(E).action.entity.entityType??""}  svelte-lqu21u`),m(je,xe)},[()=>e(E).activator.seat.toLowerCase(),()=>e(H).isKnown?(e(E).action.entity.status.monsterCategories??[]).join(" "):"Token",()=>e(E).action.toString()],de),te(3,le,()=>Cs,()=>new Date().getTime()-e(H).chainBlockInfo.wasSpawnedAt.getTime()<R?{x:c(),duration:S}:{y:p,duration:S}),as(M,()=>Wr,()=>({duration:D})),r(X,M)}),y(()=>Ue(U,`cut_in_container cut_in_container_${v()??""} svelte-lqu21u`)),r(d,U),bt()}const ti=Ds({duration:400});var ai=n('<div class="duel_desk_left v_flex svelte-1w535im"><!> <!> <!></div>'),si=n('<button class="duel_field_header_message svelte-1w535im"> </button> <div class="duel_field_header_buttons svelte-1w535im"><button class="svelte-1w535im">サレンダー</button></div>',1),ri=n("<tr></tr>"),ii=n('<table class="duel_field svelte-1w535im"><tbody class="svelte-1w535im"></tbody></table>'),ni=n('<button class="svelte-1w535im">OK</button>'),oi=n('<button class="svelte-1w535im">cancel</button>'),li=n("<!> <!>",1),vi=n('<button class="svelte-1w535im"> </button>'),di=n('<div style="text-align: left;"><!> <!> <!></div>'),ci=n('<div><!> <div class=" duel_desk_center v_flex svelte-1w535im"><div class="duel_field_header svelte-1w535im"><!></div> <div class="duel_field_body svelte-1w535im"><!></div> <div class="duel_field_footer svelte-1w535im"><!></div></div> <!></div> <div style="position:fixed;bottom:0"> </div> <!> <div><!></div>',1);function _i(d,i){mt(i,!1);let t=Ve(i,"duel",12),v=Ve(i,"userProfile",8),p=be(0),c=be(0),u=be([]),l=be([]),B=()=>{},R=be([]),D=be(),S=be(),o=be(()=>!1),U=be(!1);const X=_=>{B=_.resolve,C(R,_.dummyActionInfos.filter(g=>g.action.entity.entityType==="Duelist").filter(g=>g.action.entity.controller.seat==="Below")),C(D,void 0),C(S,void 0),C(l,[]),C(u,[]),C(U,!1),_.entitiesChoices&&(C(D,_.entitiesChoices),C(o,()=>{var g;return((g=_.entitiesChoices)==null?void 0:g.validator(e(u)))??!1}),C(U,_.entitiesChoices.cancelable),e(D).selectables.every(g=>g.cell.isPlayFieldCell&&g.getIndexInCell()===0||g.cell.cellType==="Hand"&&g.controller.duelistType==="Player"||g.entityType==="Duelist")||t().view.modalController.entitySelector.show({title:t().view.message,position:"Middle",entitiesChoices:_.entitiesChoices,chainBlockInfos:_.chainBlockInfos,cancelable:_.entitiesChoices.cancelable}).then(g=>{B({selectedEntities:g})})),_.cellsChoices&&(C(S,_.cellsChoices),C(o,()=>{var g;return((g=_.cellsChoices)==null?void 0:g.validator(e(l)))??!1}),C(U,_.cellsChoices.cancelable))};t().view.onWaitStart.append(X);const H=()=>{B=()=>{},C(S,void 0),C(D,void 0),C(l,[]),C(u,[]),C(o,()=>!1),C(U,!1)};t().view.onWaitEnd.append(H);let M=be(void 0),E=be("Normal");const le=({card:_,mode:g})=>{C(M,_),C(E,g??(e(M)===_||e(E)==="Normal"?"Detail":"Normal"))};t().view.onShowCardEntity.append(le);const he=()=>{t(t())};t().view.onDuelUpdate.append(he),t().log.onUpdate.append(he);const $e=()=>{e(D)&&e(D).validator(e(u))&&B({selectedEntities:e(u)}),e(S)&&e(S).validator(e(l))&&B({selectedCells:e(l)})},w=()=>{B({})},j=_=>{B({actionInfo:_})},W=()=>{B({surrender:!0})};t().main();const J=()=>e(p)<=1400?"compact":"wide";gt();var ke=ci(),re=Y(ke),ae=a(re);{var je=_=>{var g=ai(),N=a(g);Ya(N,{get duelist(){return t().duelists.Above}});var P=s(N,2);Lr(P,{get entity(){return e(M)},get mode(){return e(E)}});var we=s(P,2);Ya(we,{get duelist(){return t().duelists.Below}}),r(_,g)};b(ae,_=>{J()==="wide"&&_(je)})}var T=s(ae,2),F=a(T),K=a(F);{var ce=_=>{var g=si(),N=Y(g),P=a(N),we=s(N,2),pe=a(we);y(()=>m(P,`[TURN:${t().clock.turn}][PHASE:${t().phase}] ${t().view.message}`)),ve("click",N,()=>{t(t().view.infoBoardState="Log",!0)}),ve("click",pe,W),r(_,g)};b(K,_=>{t().isEnded||_(ce)})}var xe=s(F,2),_e=a(xe);{var A=_=>{var g=ii(),N=a(g);ne(N,5,()=>t().field.cells,oe,(P,we,pe)=>{var ue=ri();Ue(ue,`${`duel_desk_row_${pe}`??""} svelte-1w535im`),ne(ue,5,()=>e(we),oe,(Q,V,O)=>{Ws(Q,{get view(){return t().view},row:pe,column:O,get selectedEntities(){return e(u)},set selectedEntities(ye){C(u,ye)},get selectedCells(){return e(l)},set selectedCells(ye){C(l,ye)},$$legacy:!0})}),r(P,ue)}),r(_,g)};b(_e,_=>{t().clock.turn>0&&_(A)})}var h=s(xe,2),I=a(h);{var Z=_=>{var g=li(),N=Y(g);{var P=ue=>{var Q=ni();y(V=>Q.disabled=V,[()=>!e(o)()],de),ve("click",Q,$e),r(ue,Q)};b(N,ue=>{((e(D)&&e(D).qty)??(e(S)&&e(S).qty)??9999)>1&&ue(P)})}var we=s(N,2);{var pe=ue=>{var Q=oi();ve("click",Q,w),r(ue,Q)};b(we,ue=>{e(U)&&ue(pe)})}r(_,g)},ie=_=>{var g=ze(),N=Y(g);ne(N,1,()=>e(R),oe,(P,we)=>{var pe=vi(),ue=a(pe);y(()=>m(ue,e(we).action.title)),ve("click",pe,()=>j(e(we))),r(P,pe)}),r(_,g)};b(I,_=>{e(D)&&e(D).selectables.length||e(S)&&e(S).selectables?_(Z):_(ie,!1)})}var $=s(T,2);{var z=_=>{var g=di(),N=a(g);sr(N,{get log(){return t().log}});var P=s(N,2);Hr(P,{get cell(){return t().view.infoBoardCell}});var we=s(P,2);Rr(we,{get userProfile(){return v()},get viewController(){return t().view}}),y(pe=>Ue(g,`duel_desk_right duel_desk_right_${pe??""}  svelte-1w535im`),[()=>t().view.infoBoardState.toLowerCase()],de),te(3,g,()=>fe,()=>({duration:e(p)>1400?0:200,axis:"x"})),r(_,g)};b($,_=>{(e(p)>1400||t().view.infoBoardState!=="Default")&&_(z)})}var L=s(re,2),ee=a(L),se=s(L,2);ss(se,{get modalController(){return t().view.modalController}});var ge=s(se,2),f=a(ge);const x=de(()=>J()==="wide"?"right":"left");ei(f,{get duel(){return t()},get position(){return e(x)}}),y((_,g)=>{Ue(re,`flex duel_desk ${_??""}_mode svelte-1w535im`),m(ee,g),Ue(ge,`cutin ${_??""}_mode svelte-1w535im`)},[J,()=>t().clock.toFullString()],de),ta("innerWidth",_=>C(p,_)),ta("innerHeight",_=>C(c,_)),r(d,ke),bt()}var ui=n('<div class="svelte-niobyr"><button class="button_style_reset svelte-niobyr" title="※shiftキー同時押しで一括外し">クリア</button></div>'),fi=n('<div class="svelte-niobyr"><button class="button_style_reset svelte-niobyr" title="※shiftキー同時押しで一括外し">クリア</button></div>'),pi=n("<div></div>"),yi=n("<!> <!> <!> <!> <!>",1),mi=n('<span> </span> / <span style="display: inline-block;width:2rem;text-align: right;"> </span>',1),gi=n('<li class="deck_editor_item svelte-niobyr"><div role="listitem"><div class="svelte-niobyr"><div class="svelte-niobyr"> </div> <div style="display:flex; flex-wrap: wrap;" class="svelte-niobyr"><div style="text-wrap-mode: nowrap;" class="svelte-niobyr"><!> <!> <!></div> <div style="flex-grow: 1; height:0px; width:0px" class="svelte-niobyr"></div> <div style="text-wrap-mode: nowrap;" class="svelte-niobyr"><!></div></div></div></div> <button class="button_style_reset svelte-niobyr">+</button> <button class="button_style_reset svelte-niobyr">-</button></li>'),bi=n('<div class="deck_editor_card_kind svelte-niobyr"><div class="deck_editor_card_kind_header svelte-niobyr"><div class="svelte-niobyr"> </div> <!></div> <ul class="svelte-niobyr"></ul></div>'),hi=n('<div class="deck_editor_deck_type svelte-niobyr"><div class="deck_editor_deck_type_header svelte-niobyr"><div class="svelte-niobyr"> </div> <!></div> <!></div>'),wi=n('<div class="svelte-niobyr">読み込み中...</div>'),ki=n('<div class="deck_editor_card_list svelte-niobyr"><!></div>');function Ua(d,i){mt(i,!1);let t=Ve(i,"allCardInfos",8),v=Ve(i,"deckCardInfos",12),p=Ve(i,"mode",8),c=Ve(i,"onAttention",8),u=Ve(i,"searchCondition",8,void 0);const l={Deck:["Monster","Spell","Trap"],ExtraDeck:["Monster"]},B={ExtraDeck:{Monster:[],Spell:[],Trap:[]},Deck:{Monster:[],Spell:[],Trap:[]}},R=w=>{var j;return(j=w.monsterCategories)!=null&&j.union(Bt).length?"ExtraDeck":"Deck"},D=w=>{Object.values(B).forEach(j=>Object.values(j).forEach(W=>W.reset())),w.filter(j=>j.kind!=="XyzMaterial").forEach(j=>{var J;if(j.kind==="XyzMaterial")return;const W=(J=j.monsterCategories)!=null&&J.union(Bt).length?"ExtraDeck":"Deck";B[W][j.kind].push(j)}),Object.values(B).forEach(j=>Object.values(j).forEach(W=>W.sort(da)))},S=p()==="List"?new Promise(w=>{D(t()),w()}):Promise.resolve(),o=()=>(p()==="Deck"&&(D(v()),C(M,v().length)),B),U=(w,j,W)=>{v(v().filter(J=>R(J)!==j||J.kind!==W&&W))},X=(w,j)=>{try{if(w.ctrlKey){v().push(j);return}const W=v().filter(ke=>ke.name===j.name).length;if(W>2)return;const J=w.shiftKey?3-W:1;if(J<1)return;v().push(...Array(J).fill(j))}finally{v().sort(da),v(v())}},H=(w,j)=>{let W=0;v(v().filter(J=>J.name!==j.name?!0:(W++,!w.shiftKey&&W>1))),v().sort(da)};let M=be(100);const E=()=>{C(M,e(M)+10),!(e(M)>499)&&(e(M)>t().length+v().length||Pt(100).then(E))},le=(w,j,W,J)=>{var re;if(j===0&&J==="Monster"&&(C(M,100),Pt(100).then(E)),!u())return!0;if(w.kind==="XyzMaterial")return!1;const ke=w.kind!=="Monster"?w.kind:(re=w.monsterCategories)!=null&&re.union(Bt).length?"ExtraMonster":"Monster";if(!u().deckCardKinds.includes(ke)||u().name.trim().length&&[w.name,...w.nameTags??[],...w.textTags??[]].every(je=>!je.includes(u().name))||!w.isImplemented&&!u().others.includes("implemented")||w.isForTest&&!u().others.includes("test")||w.isOldVersion&&!u().others.includes("oldVersion"))return!1;if(w.kind==="Monster"){if(w.attributes&&!u().monsterAttributes.union(w.attributes).length||w.types&&!u().monsterTypes.union(w.types).length)return!1;const ae=w.level??w.rank??w.link;return jt(u().starLowerBound)&&(ae??0)<u().starLowerBound||jt(u().starUpperBound)&&(ae??0)>u().starUpperBound||jt(u().atkLowerBound)&&(w.attack??0)<u().atkLowerBound||jt(u().atkUpperBound)&&(w.attack??0)>u().atkUpperBound||jt(u().defLowerBound)&&(w.defense??0)<u().defLowerBound||jt(u().defUpperBound)&&(w.defense??0)>u().defUpperBound||jt(u().atkPlusDef)&&(!jt(w.attack)||!jt(w.defense)||w.attack+w.defense!==u().atkPlusDef)||!w.monsterCategories||ke==="ExtraMonster"&&!w.monsterCategories.union(u().exMonsterCategories).length?!1:w.monsterCategories.union(u().monsterCategories).length}if(w.kind==="Spell")return w.spellCategory&&u().spellCategories.includes(w.spellCategory);if(w.kind==="Trap")return w.trapCategory&&u().trapCategories.includes(w.trapCategory)};gt();var he=ki(),$e=a(he);yt($e,()=>S,w=>{var j=wi();r(w,j)},w=>{var j=ze();const W=de(o);var J=Y(j);ne(J,1,()=>ns.toReversed(),oe,(ke,re)=>{var ae=hi();const je=de(()=>Object.values(e(W)[e(re)]).flatMap(A=>A));var T=a(ae),F=a(T),K=a(F),ce=s(F,2);{var xe=A=>{var h=ui(),I=a(h);ve("click",I,Z=>U(Z,e(re),void 0)),r(A,h)};b(ce,A=>{p()==="Deck"&&e(je).some(le)&&A(xe)})}var _e=s(T,2);ne(_e,1,()=>fa(e(W)[e(re)]).filter(A=>l[e(re)].includes(A)),oe,(A,h)=>{var I=bi();const Z=de(()=>e(W)[e(re)][e(h)].filter((...ge)=>le(...ge,e(h))));var ie=a(I),$=a(ie),z=a($),L=s($,2);{var ee=ge=>{var f=fi(),x=a(f);ve("click",x,_=>U(_,e(re),e(h))),r(ge,f)};b(L,ge=>{p()==="Deck"&&e(Z).length&&ge(ee)})}var se=s(ie,2);ne(se,5,()=>e(Z),oe,(ge,f,x)=>{var _=ze(),g=Y(_);{var N=P=>{var we=gi(),pe=a(we),ue=a(pe),Q=a(ue),V=a(Q),O=s(Q,2),ye=a(O),Re=a(ye);{var We=Se=>{var Te=yi(),k=Y(Te);{var q=Pe=>{var qe=dt();y(()=>m(qe,`★${e(f).level??""}`)),r(Pe,qe)};b(k,Pe=>{e(f).level&&Pe(q)})}var G=s(k,2);{var De=Pe=>{var qe=dt();y(()=>m(qe,`☆${e(f).rank??""}`)),r(Pe,qe)};b(G,Pe=>{e(f).rank&&Pe(De)})}var Ie=s(G,2);ne(Ie,1,()=>e(f).attributes??[],oe,(Pe,qe)=>{var He=pi();y(()=>Ue(He,`monster_attr ${e(qe)??""} svelte-niobyr`)),r(Pe,He)});var Ge=s(Ie,2);ne(Ge,1,()=>e(f).types??[],oe,(Pe,qe)=>{var He=dt();y(()=>m(He,ra[e(qe)])),r(Pe,He)});var Ye=s(Ge,2);ne(Ye,1,()=>e(f).monsterCategories??[],oe,(Pe,qe)=>{var He=dt();y(()=>m(He,Xt[e(qe)])),r(Pe,He)}),r(Se,Te)};b(Re,Se=>{e(f).kind==="Monster"&&Se(We)})}var Fe=s(Re,2);{var Le=Se=>{var Te=dt();y(()=>m(Te,`${ia[e(f).spellCategory]??""}魔法`)),r(Se,Te)};b(Fe,Se=>{e(f).spellCategory&&Se(Le)})}var Xe=s(Fe,2);{var Ee=Se=>{var Te=dt();y(()=>m(Te,`${na[e(f).trapCategory]??""}罠`)),r(Se,Te)};b(Xe,Se=>{e(f).trapCategory&&Se(Ee)})}var me=s(ye,4),Ce=a(me);{var Ae=Se=>{var Te=mi(),k=Y(Te),q=a(k),G=s(k,2),De=a(G);y(()=>{m(q,e(f).attack??"?"),m(De,e(f).defense??"?")}),r(Se,Te)};b(Ce,Se=>{e(f).kind==="Monster"&&Se(Ae)})}var Oe=s(pe,2),Ke=s(Oe,2);y(Se=>{Ue(pe,`${Se??""} svelte-niobyr`),m(V,e(f).name),Oe.disabled=!e(f).isImplemented,wt(Oe,"title",e(f).isImplemented?"※shiftキー同時押しで一括投入":""),Ke.disabled=!e(f).isImplemented,wt(Ke,"title",e(f).isImplemented?"※shiftキー同時押しで一括外し":"")},[()=>{var Se,Te;return`deck_editor_card duel_card ${e(f).kind} ${(Te=(Se=e(f))==null?void 0:Se.monsterCategories)==null?void 0:Te.join(" ")} ${e(f).isImplemented?"is_implemented":"is_not_implemented"}`}],de),ve("click",pe,()=>c()(e(f))),ve("click",Oe,Se=>X(Se,e(f))),ve("click",Ke,Se=>H(Se,e(f))),r(P,we)};b(g,P=>{x<e(M)&&P(N)})}r(ge,_)}),y(()=>m(z,`${rs[e(h)]??""}（${e(Z).length??""} / ${e(W)[e(re)][e(h)].length??""}枚）`)),r(A,I)}),y(A=>m(K,`${is[e(re)]??""}（${A??""} / ${e(je).length??""}枚）`),[()=>e(je).filter(le).length],de),r(ke,ae)}),r(w,j)}),r(d,he),bt()}var xi=n('<div class="duel_card_info_row svelte-rccxcp" style="position:sticky; top:0;"><div class="svelte-rccxcp"> </div> <div class="svelte-rccxcp"> </div></div>'),Ci=n('<div class="duel_card_info_row svelte-rccxcp"><div class="svelte-rccxcp"><pre class="description svelte-rccxcp"> </pre></div></div> <div class="duel_card_info_row svelte-rccxcp" style=" justify-content: space-between;"><div class="svelte-rccxcp"> </div> <div class="svelte-rccxcp"> </div></div>',1),Di=n('<div></div> <div class="svelte-rccxcp"> </div>',1),$i=n("<div> </div>"),Si=n('<span class="svelte-rccxcp">/</span> <div class="monster_defense svelte-rccxcp"> </div>',1),qi=n("<div> </div>"),Mi=n('<div class="duel_card_info_row svelte-rccxcp"><!> <!> <div style="flex-grow: 1;" class="svelte-rccxcp"></div> <div class="monster_attack svelte-rccxcp"> </div> <!></div> <div class="duel_card_info_row svelte-rccxcp"></div>',1),zi=n('<div class="duel_card_row svelte-rccxcp"><div class="svelte-rccxcp"></div> <div class="svelte-rccxcp"> </div></div>'),ji=n('<div class="duel_card_row svelte-rccxcp"><div class="svelte-rccxcp"></div> <div class="svelte-rccxcp"> </div></div>'),Ti=n('<div class="duel_card_info_row svelte-rccxcp"><div class="svelte-rccxcp">※エラッタ前カードです</div></div>'),Bi=n('<div class="duel_card_info_row svelte-rccxcp"><div class="svelte-rccxcp">※テスト用カードです</div></div>'),Ei=n('<div class="duel_card_info_links svelte-rccxcp"><a target="_blank" rel="noopener noreferrer" title="遊戯王カードWiki" class="svelte-rccxcp">⇒遊戯王カードWiki</a> <a target="_blank" rel="noopener noreferrer" title="コナミカードデータベース" class="svelte-rccxcp"> </a></div>'),Ai=n('<div><div class="duel_card_info_header svelte-rccxcp"><div class="duel_card_info_row svelte-rccxcp"><div class="svelte-rccxcp"> </div></div> <!></div> <div class="duel_card_info_body svelte-rccxcp"><!> <!> <div class="duel_card_info_row description svelte-rccxcp"><div class="svelte-rccxcp"><pre class="description svelte-rccxcp"> </pre></div></div> <!> <!></div></div>');function Yi(d,i){mt(i,!1);let t=Ve(i,"cardInfo",8,void 0);gt();var v=ze(),p=Y(v);{var c=u=>{var l=Ai(),B=a(l),R=a(B),D=a(R),S=a(D),o=s(R,2);{var U=T=>{var F=xi(),K=a(F),ce=a(K),xe=s(K,2),_e=a(xe);y((A,h)=>{m(ce,A),m(_e,h)},[()=>"★".repeat(t().level||0),()=>"☆".repeat(t().rank||0)],de),r(T,F)};b(o,T=>{t().kind==="Monster"&&T(U)})}var X=s(B,2),H=a(X);{var M=T=>{var F=Ci(),K=Y(F),ce=a(K),xe=a(ce),_e=a(xe),A=s(K,2),h=a(A),I=a(h),Z=s(h,2),ie=a(Z);y(()=>{m(_e,t().pendulumDescription),m(I,`◀ ${t().pendulumScaleL??""}`),m(ie,`${t().pendulumScaleR??""} ▶`)}),r(T,F)};b(H,T=>{var F;(F=t().monsterCategories)!=null&&F.includes("Pendulum")&&T(M)})}var E=s(H,2);{var le=T=>{var F=Mi(),K=Y(F),ce=a(K);{var xe=z=>{var L=Di(),ee=Y(L),se=s(ee,2),ge=a(se);y(()=>{Ue(ee,`monster_attr ${t().attributes[0]??""} svelte-rccxcp`),m(ge,`${pa[t().attributes[0]]??""}属性`)}),r(z,L)};b(ce,z=>{t().attributes&&z(xe)})}var _e=s(ce,2);{var A=z=>{var L=$i(),ee=a(L);y(()=>{Ue(L,`monster_cat ${t().types[0]??""} svelte-rccxcp`),m(ee,`${ra[t().types[0]]??""}${ya[t().types[0]]??""}族`)}),r(z,L)};b(_e,z=>{t().types&&z(A)})}var h=s(_e,4),I=a(h),Z=s(h,2);{var ie=z=>{var L=Si(),ee=s(Y(L),2),se=a(ee);y(()=>m(se,t().defense??"?")),r(z,L)};b(Z,z=>{var L;(L=t().monsterCategories)!=null&&L.includes("Link")||z(ie)})}var $=s(K,2);ne($,5,()=>t().monsterCategories??[],oe,(z,L)=>{var ee=qi(),se=a(ee);y(()=>{Ue(ee,`monster_cat ${e(L)??""} svelte-rccxcp`),m(se,`${Xt[e(L)]??""}${ea[e(L)]??""}`)}),r(z,ee)}),y(()=>m(I,t().attack??"?")),r(T,F)},he=T=>{var F=ze(),K=Y(F);{var ce=_e=>{var A=zi(),h=s(a(A),2),I=a(h);y(()=>m(I,`${ia[t().spellCategory]??""}魔法`)),r(_e,A)},xe=_e=>{var A=ze(),h=Y(A);{var I=Z=>{var ie=ji(),$=s(a(ie),2),z=a($);y(()=>m(z,`${na[t().trapCategory]??""}罠`)),r(Z,ie)};b(h,Z=>{t().kind==="Trap"&&t().trapCategory&&Z(I)},!0)}r(_e,A)};b(K,_e=>{t().kind==="Spell"&&t().spellCategory?_e(ce):_e(xe,!1)},!0)}r(T,F)};b(E,T=>{t().kind==="Monster"?T(le):T(he,!1)})}var $e=s(E,2),w=a($e),j=a(w),W=a(j),J=s($e,2);{var ke=T=>{var F=Ti();r(T,F)};b(J,T=>{t().isOldVersion&&T(ke)})}var re=s(J,2);{var ae=T=>{var F=Bi();r(T,F)},je=T=>{var F=Ei(),K=a(F),ce=s(K,2),xe=a(ce);y(_e=>{wt(K,"href",`https://yugioh-wiki.net/index.php?${t().wikiEncodedName}`),wt(ce,"href",_e),m(xe,`⇒${(t().cardId?"公式カードページ":"公式で検索")??""}`)},[()=>os(t())],de),r(T,F)};b(re,T=>{t().isForTest?T(ae):T(je,!1)})}y(T=>{Ue(l,`duel_card duel_card_info ${t().kind??""} ${T??""} svelte-rccxcp`),m(S,t().name),m(W,t().description)},[()=>{var T;return(T=t().monsterCategories)==null?void 0:T.join(" ")}],de),r(u,l)};b(p,u=>{t()&&u(c)})}r(d,v),bt()}const Ui={0:{aaa:"日",aaaa:"日曜日",ddd:"Sun",dddd:"Sunday"},1:{aaa:"月",aaaa:"月曜日",ddd:"Mon",dddd:"Monday"},2:{aaa:"火",aaaa:"火曜日",ddd:"Tue",dddd:"Tuesday"},3:{aaa:"水",aaaa:"水曜日",ddd:"Wed",dddd:"Wednesday"},4:{aaa:"木",aaaa:"木曜日",ddd:"Thu",dddd:"Thursday"},5:{aaa:"金",aaaa:"金曜日",ddd:"Fri",dddd:"Friday"},6:{aaa:"土",aaaa:"土曜日",ddd:"Sat",dddd:"Saturday"}};class Li{constructor(){lt(this,"DefaultSeparator1","/");lt(this,"DefaultSeparator2"," ");lt(this,"DefaultSeparator3",":");lt(this,"createDate",i=>{if(!i)return;const t=new Date(i);if(!isNaN(t.getTime()))return t});lt(this,"createDateOr",(i,t)=>this.createDate(i)||t||new Date);lt(this,"truncateDate",i=>{const t=i||new Date;return new Date(t.getFullYear(),t.getMonth(),t.getDate())});lt(this,"addDate",(i,t)=>{const v=this.createDateOr(i);return v.setDate(v.getDate()+t),v});lt(this,"addMonth",(i,t)=>{const v=this.createDateOr(i);return v.setMonth(v.getMonth()+t),v});lt(this,"addYear",(i,t)=>{const v=this.createDateOr(i);return v.setFullYear(v.getFullYear()+t),v});lt(this,"getDayOfWeek",(i,t="dddd")=>{const v=this.createDate(i);return v?Ui[v.getDay()][t]:""});lt(this,"formatToYYYYMMDD",(i,t=this.DefaultSeparator1)=>{const v=this.createDate(i);if(!v)return"";const p=v.getFullYear().toString(),c=("0"+(v.getMonth()+1)).slice(-2),u=("0"+v.getDate()).slice(-2);return p+t+c+t+u});lt(this,"formatToYYYYMM",(i,t=this.DefaultSeparator1)=>{const v=this.createDate(i);if(!v)return"";t||(t="");const p=v.getFullYear().toString(),c=("0"+(v.getMonth()+1)).slice(-2);return p+t+c});lt(this,"formatToHHMMSS",(i,t=this.DefaultSeparator3)=>{const v=this.createDate(i);if(!v)return"";t||(t="");const p=v.getHours(),c=v.getMinutes(),u=v.getSeconds();return("0"+p).slice(-2)+t+("0"+c).slice(-2)+t+("0"+u).slice(-2)});lt(this,"formatToHHMM",(i,t=this.DefaultSeparator3)=>{const v=this.createDate(i);if(!v)return"";t||(t="");const p=("0"+v.getHours()).slice(-2),c=("0"+v.getMinutes()).slice(-2);return p+t+c});lt(this,"formatToYYYYMMDD_HHMM",(i,t=this.DefaultSeparator1,v=this.DefaultSeparator2,p=this.DefaultSeparator3)=>{const c=this.createDate(i);return c?this.formatToYYYYMMDD(c,t)+v+this.formatToHHMM(c,p):""});lt(this,"formatToYYYYMMDD_HHMMSS",(i,t=this.DefaultSeparator1,v=this.DefaultSeparator2,p=this.DefaultSeparator3)=>{const c=this.createDate(i);return c?this.formatToYYYYMMDD(c,t)+v+this.formatToHHMMSS(c,p):""})}}const kt=new Li;Date.prototype.truncateDate=function(){return kt.truncateDate(this)};Date.prototype.getCloneOr=function(d){return kt.createDateOr(this,d)};Date.prototype.addDate=function(d){return kt.addDate(this,d)};Date.prototype.addMonth=function(d){return kt.addDate(this,d)};Date.prototype.addYear=function(d){return kt.addDate(this,d)};Date.prototype.getDayOfWeek=function(d="dddd"){return kt.getDayOfWeek(this,d)};Date.prototype.formatToYYYYMM=function(d){return kt.formatToYYYYMM(this,d)};Date.prototype.formatToYYYYMMDD=function(d){return kt.formatToYYYYMMDD(this,d)};Date.prototype.formatToYYYYMMDD_HHMM=function(d,i,t){return kt.formatToYYYYMMDD_HHMM(this,d,i,t)};Date.prototype.formatToYYYYMMDD_HHMMSS=function(d,i,t){return kt.formatToYYYYMMDD_HHMMSS(this,d,i,t)};Date.prototype.formatToHHMM=function(d){return kt.formatToHHMM(this,d)};Date.prototype.formatToHHMMSS=function(d){return kt.formatToHHMMSS(this,d)};var Ni=n('<li class="deck_info_list_item svelte-2wdgc8"><div class="svelte-2wdgc8"> </div> <div class="svelte-2wdgc8"> </div> <div class="svelte-2wdgc8"> </div></li>'),Pi=n('<ul class="deck_info_list svelte-2wdgc8"></ul>'),Fi=n('<label for="file_selector" class="upload_area svelte-2wdgc8" role="region" aria-label="ファイルアップロードエリア"><div class="upload_area_message svelte-2wdgc8">ここにファイルをドロップ</div> <div class="upload_area_footer svelte-2wdgc8"><input type="file" id="file_selector" name="file_selector" accept=".json" multiple></div></label>'),Hi=n('<div slot="body" class="modal_body svelte-2wdgc8"><!></div>'),Oi=n('<button class="svelte-2wdgc8">追加</button> <button class="svelte-2wdgc8">削除して追加</button> <button class="svelte-2wdgc8">戻る</button>',1),Ii=n('<button class="svelte-2wdgc8">Cancel</button>'),Ri=n('<div slot="footer" class="modal_window_footer svelte-2wdgc8"><!></div>');function Wi(d,i){mt(i,!1);let t=Ve(i,"eventHolder",8),v=Ve(i,"args",8),p=Ve(i,"resolve",8),c=be(Promise.resolve([])),u=be();const l=()=>{C(u,new DataTransfer().files),C(c,Promise.resolve([]))},B=async U=>{U.preventDefault(),console.log("hoge",U)},R=async U=>{U.preventDefault(),U.dataTransfer&&S(U.dataTransfer.files)},D=()=>{S(e(u))},S=async U=>{if(!U.length)return;const X=[],H=[];for(const M of U)try{H.push(...await Dt.createfromJson(M))}catch(E){E instanceof Error&&X.push(E.message)}if(X.length){console.log(...X);return}C(c,e(c).then(()=>H))},o=l;gt(),ls(d,{get eventHolder(){return t()},get args(){return v()},$$slots:{body:(U,X)=>{var H=Hi(),M=a(H);yt(M,()=>Gt,null,(E,le)=>{var he=ze(),$e=Y(he);yt($e,()=>e(c),null,(w,j)=>{var W=ze(),J=Y(W);{var ke=ae=>{var je=Pi();ne(je,5,()=>e(j),oe,(T,F)=>{var K=Ni(),ce=a(K),xe=a(ce),_e=s(ce,2),A=a(_e),h=s(_e,2),I=a(h);y((Z,ie,$)=>{m(xe,e(F).name),m(A,`${Z??""}
                  /
                  ${ie??""}`),m(I,`最終使用日時 ： ${$??""}`)},[()=>e(F).cardNames.filter(Z=>{var ie,$;return!(($=(ie=e(le).getCardInfo(Z))==null?void 0:ie.monsterCategories)!=null&&$.union(Bt).length)}).length,()=>e(F).cardNames.filter(Z=>{var ie,$;return($=(ie=e(le).getCardInfo(Z))==null?void 0:ie.monsterCategories)==null?void 0:$.union(Bt).length}).length,()=>e(F).lastUsedAt.formatToYYYYMMDD_HHMM("/"," ",":")],de),r(T,K)}),r(ae,je)},re=ae=>{var je=Fi(),T=s(a(je),2),F=a(T);vs(F,()=>e(u),K=>C(u,K)),ve("change",F,D),ve("cancel",F,o),ve("drop",je,R),ve("dragover",je,B),r(ae,je)};b(J,ae=>{e(j).length?ae(ke):ae(re,!1)})}r(w,W)}),r(E,he)}),r(U,H)},footer:(U,X)=>{var H=Ri(),M=a(H);yt(M,()=>e(c),null,(E,le)=>{var he=ze(),$e=Y(he);{var w=W=>{var J=Oi(),ke=Y(J),re=s(ke,2),ae=s(re,2);y(()=>{ke.disabled=e(le).length===0,re.disabled=e(le).length===0}),ve("click",ke,()=>p()({deckInfos:e(le),replaceAll:!1})),ve("click",re,()=>p()({deckInfos:e(le),replaceAll:!0})),ve("click",ae,o),r(W,J)},j=W=>{var J=ze(),ke=Y(J);{var re=ae=>{var je=Ii();ve("click",je,()=>p()(void 0)),r(ae,je)};b(ke,ae=>{v().cancelable&&ae(re)},!0)}r(W,J)};b($e,W=>{e(le).length?W(w):W(j,!1)})}r(E,he)}),r(U,H)}}}),bt()}const sa=class sa extends cs{constructor(i,t){super(i,...Object.values(t))}};lt(sa,"createModalController",i=>{const t={deckUploader:new _s({title:"デッキ情報をアップロード",position:"Middle",cancelable:!1})};return Object.assign(new sa(i,t),t)});let ua=sa;function Ki(d,i){mt(i,!1);let t=Ve(i,"modalController",8);gt(),ds(d,{get modalController(){return t()},children:(v,p)=>{var c=ze(),u=Y(c);{var l=B=>{Wi(B,{get eventHolder(){return t().eventHolder},get args(){return t().deckUploader.args},get resolve(){return t().deckUploader.resolve}})};b(u,B=>{t().deckUploader.state==="Shown"&&B(l)})}r(v,c)},$$slots:{default:!0}}),bt()}var Vi=n('<label class="svelte-1wqus8z"><input type="checkbox" class="search_condition svelte-1wqus8z"> </label>'),Gi=n('<label class="svelte-1wqus8z"><input type="checkbox" class="search_condition svelte-1wqus8z"> </label>'),Xi=n('<div class="deck_editor_search_box_row monster_ex_categories svelte-1wqus8z"><div class="svelte-1wqus8z"><button class="search_condition_title black_button svelte-1wqus8z">エクストラ</button></div> <div class="svelte-1wqus8z"></div></div>'),Qi=n('<label class="svelte-1wqus8z"><input type="checkbox" class="search_condition svelte-1wqus8z"> </label>'),Ji=n('<label class="svelte-1wqus8z"><input type="checkbox" class="search_condition svelte-1wqus8z"> <div style="display: inline-block;"></div> </label>'),Zi=n('<label class="svelte-1wqus8z"><input type="checkbox" class="search_condition svelte-1wqus8z"> </label>'),en=n('<div class="deck_editor_search_box_row monster_categories svelte-1wqus8z"><div class="svelte-1wqus8z"><button class="search_condition_title black_button svelte-1wqus8z">モンスター</button></div> <div class="svelte-1wqus8z"></div></div> <div class="deck_editor_search_box_row monster_attributes svelte-1wqus8z"><div class="svelte-1wqus8z"><button class="search_condition_title black_button svelte-1wqus8z">属性</button></div> <div class="svelte-1wqus8z"></div></div> <div class="deck_editor_search_box_row svelte-1wqus8z"><div class="svelte-1wqus8z"><button class="search_condition_title black_button svelte-1wqus8z">種族</button></div> <div class="svelte-1wqus8z"></div></div> <div class="deck_editor_search_box_row svelte-1wqus8z"><div class="svelte-1wqus8z"><button class="search_condition_title black_button svelte-1wqus8z">星攻守</button></div> <div class="svelte-1wqus8z"><div class="star_range svelte-1wqus8z"><span class="svelte-1wqus8z">星</span> <input type="number" min="0" max="13" class="svelte-1wqus8z"> <span class="svelte-1wqus8z">～</span> <input type="number" min="0" max="13" class="svelte-1wqus8z"></div> <div class="atk_range svelte-1wqus8z"><span class="svelte-1wqus8z">攻</span> <input type="number" min="0" max="5000" step="100" class="svelte-1wqus8z"> <span class="svelte-1wqus8z">～</span> <input type="number" min="0" max="5000" step="100" class="svelte-1wqus8z"></div> <div class="def_range svelte-1wqus8z"><span class="svelte-1wqus8z">守</span> <input type="number" min="0" max="5000" step="100" class="svelte-1wqus8z"> <span class="svelte-1wqus8z">～</span> <input type="number" min="0" max="5000" step="100" class="svelte-1wqus8z"></div> <div class="atk_plus_def svelte-1wqus8z"><span class="svelte-1wqus8z">攻+守</span> <input type="number" min="0" max="10000" step="100" class="svelte-1wqus8z"></div></div></div>',1),tn=n('<label class="svelte-1wqus8z"><input type="checkbox" class="search_condition svelte-1wqus8z"> </label>'),an=n('<div class="deck_editor_search_box_row svelte-1wqus8z"><div class="svelte-1wqus8z"><button class="search_condition_title black_button svelte-1wqus8z">魔法</button></div> <div class="svelte-1wqus8z"></div></div>'),sn=n('<label class="svelte-1wqus8z"><input type="checkbox" class="search_condition svelte-1wqus8z"> </label>'),rn=n('<div class="deck_editor_search_box_row svelte-1wqus8z"><div class="svelte-1wqus8z"><button class="search_condition_title black_button svelte-1wqus8z">罠</button></div> <div class="svelte-1wqus8z"></div></div>'),nn=n('<label class="svelte-1wqus8z"><input type="checkbox" class="search_condition svelte-1wqus8z"> </label>'),on=n("<div>カード情報読込中</div>"),ln=n("<option> </option>"),vn=n('<div class="svelte-1wqus8z"><a class="white_button svelte-1wqus8z" download="SVS_DeckInfos.json">ダウンロード</a></div>'),dn=n('<div class="svelte-1wqus8z"></div>'),cn=n('<div class="svelte-1wqus8z"><a class="white_button svelte-1wqus8z" download="SVS_DeckInfos.json">ダウンロード(一括)</a></div>'),_n=n('<div class="svelte-1wqus8z"></div>'),un=n('<div class="deck_editor_body_right_header svelte-1wqus8z"><div class="deck_editor_body_right_header_row svelte-1wqus8z"><div class="svelte-1wqus8z">編集対象</div> <div class="svelte-1wqus8z"><select style="width:100%" class="svelte-1wqus8z"></select></div></div> <div class="deck_editor_body_right_header_row svelte-1wqus8z"><div class="svelte-1wqus8z">新規名称</div> <div class="svelte-1wqus8z"><input type="text" style="width:100%" class="svelte-1wqus8z"></div></div> <div class="deck_editor_body_right_header_row svelte-1wqus8z"></div> <div class="deck_editor_body_right_header_row svelte-1wqus8z"><div class="svelte-1wqus8z">基本操作</div> <div class="svelte-1wqus8z"><button class="white_button svelte-1wqus8z">デッキを保存</button></div> <div class="svelte-1wqus8z"><button class="white_button svelte-1wqus8z">デッキを複製</button></div> <div class="svelte-1wqus8z"><button class="white_button svelte-1wqus8z" title="shiftキー押下で確認メッセージスキップ">デッキを削除</button></div></div> <div class="deck_editor_body_right_header_row svelte-1wqus8z"><div class="svelte-1wqus8z">DL/UL</div> <!> <!> <div class="svelte-1wqus8z"><button class="white_button svelte-1wqus8z">アップロード</button></div></div></div> <!>',1),fn=n('<div class="svelte-1wqus8z">デッキ情報読込中</div>'),pn=n('<div class="svelte-1wqus8z"></div>'),yn=n('<div><div class="deck_editor_header svelte-1wqus8z"></div> <div class="deck_editor_body svelte-1wqus8z"><div class="deck_editor_body_left svelte-1wqus8z"><div role="contentinfo" class="deck_editor_search_box svelte-1wqus8z"><div class="deck_editor_search_box_header svelte-1wqus8z"><div class="svelte-1wqus8z">検索条件</div> <div class="svelte-1wqus8z"><button class="white_button svelte-1wqus8z">条件クリア</button></div></div> <div class="deck_editor_search_box_body svelte-1wqus8z"><div class="deck_editor_search_box_row svelte-1wqus8z"><div class="svelte-1wqus8z"><button class="search_condition_title black_button svelte-1wqus8z">名称</button></div> <div class="svelte-1wqus8z"><input type="text" style="width:100%" placeholder="※ルビには対応していません" class="svelte-1wqus8z"></div></div> <div class="deck_editor_search_box_row card_kind svelte-1wqus8z"><div class="svelte-1wqus8z"><button class="search_condition_title black_button svelte-1wqus8z">種類</button></div> <div class="svelte-1wqus8z"></div></div> <!> <!> <!> <!> <div class="deck_editor_search_box_row svelte-1wqus8z"><div class="svelte-1wqus8z"><button class="search_condition_title black_button svelte-1wqus8z">その他</button></div> <div class="svelte-1wqus8z"></div></div></div></div> <!></div> <div class="deck_editor_body_center svelte-1wqus8z"><!></div>  <div class="deck_editor_body_right svelte-1wqus8z"><!></div></div> <div class="footer svelte-1wqus8z"></div></div> <!>',1);function mn(d,i){mt(i,!1);const t=[],v=[],p=[],c=[],u=[],l=[],B=[],R=[],D=ua.createModalController({onDragStart:{append:()=>{},remove:()=>{}},onDragEnd:{append:()=>{},remove:()=>{}}}),S={name:"",deckCardKinds:[...za],exMonsterCategories:[...Bt],monsterCategories:Ma.filter(k=>!Bt.includes(k)),monsterAttributes:[...qa],monsterTypes:[...Sa],spellCategories:$a.filter(k=>k!=="PendulumScale"),trapCategories:[...Da],starLowerBound:0,starUpperBound:13,atkLowerBound:0,atkUpperBound:5e3,defLowerBound:0,defUpperBound:5e3,atkPlusDef:void 0,others:["test","oldVersion","implemented"]},o=be(structuredClone(S));Me(o,e(o).others=["oldVersion"]);let U=be("DeckEdit"),X=be("SearchCondition");const H=async()=>{Me(o,e(o).name=""),Me(o,e(o).deckCardKinds=[]),Me(o,e(o).monsterCategories=[]),Me(o,e(o).monsterAttributes=[]),Me(o,e(o).monsterTypes=[]),Me(o,e(o).spellCategories=[]),Me(o,e(o).trapCategories=[]),Me(o,e(o).others=[]),Me(o,e(o).atkLowerBound=0),Me(o,e(o).atkUpperBound=5e3),Me(o,e(o).defLowerBound=0),Me(o,e(o).defUpperBound=5e3),Me(o,e(o).atkPlusDef=void 0)},M=k=>{k.forEach(q=>{Array.isArray(e(o)[q])&&Array.isArray(S[q])?Me(o,e(o)[q]=e(o)[q].length?[]:[...S[q]]):Me(o,e(o)[q]=S[q])})},E=(k,q,G)=>{Array.isArray(e(o)[q])&&Array.isArray(S[q])&&Me(o,e(o)[q]=[G])},le=async()=>{const q=(await e(w)).find(De=>De.id===e($e));if(!q)return;const G=await Gt;C(J,{...q,cardInfos:q.cardNames.map(De=>{const Ie=G.getCardInfo(De);return Ie===void 0&&console.error(De),Ie}).filter(De=>De!==void 0)})},he=()=>Dt.getAllDeckInfo().then(k=>(C($e,(k.find(q=>q.lastUsedAt.getTime()===Math.max(...k.map(G=>G.lastUsedAt.getTime())))??k[0]).id),k));let $e=be(-1),w=be(he()),j=be(e(w).then(k=>Dt.convertToObjectURL(k)));e(w).then(le);const W=()=>{C(w,he()),C(j,e(w).then(k=>Dt.convertToObjectURL(k))),le()};let J=be({id:-Number.MAX_VALUE,name:"",description:"",lastUsedAt:new Date,cardInfos:[]}),ke=be(void 0),re=0;const ae=k=>{C(X,"CardDetail"),k.cardId!==void 0&&!k.description&&!k.pendulumDescription&&(re=k.cardId,Na([k.cardId]).then(()=>{k.cardId===re&&C(ke,k)})),C(ke,k)},je=async()=>{const q=(await e(w)).find(G=>G.id===e($e));if(!q)throw new Error("illegal state");return q},T=async()=>{const k=await je();await k.saveDeckInfo({...k,name:e(J).name,cardNames:e(J).cardInfos.map(q=>q.name),lastUsedAt:new Date}),W()},F=async()=>{(await Dt.createNewDeck(`デッキ_${new Date().formatToYYYYMMDD_HHMMSS("","","")}`,`コピー日時：${new Date().formatToYYYYMMDD_HHMMSS("-"," ",":")}`,e(J).cardInfos.map(q=>q.name))).saveDeckInfo(),W()},K=async k=>{const q=await je();!k.shiftKey&&!confirm(`デッキ【${q.name}】を削除します。
よろしいですか？`)||(await q.delete(),W())},ce=async()=>{const k=await D.deckUploader.show({title:"デッキ情報アップロード",position:"Middle",cancelable:!0});if(!k)return;const q=[];if(k.replaceAll){if(!confirm(`既存デッキ情報を全て削除し、アップロードしたファイルに置き換えます。
よろしいですか？`))return;q.push(...(await e(w)).map(G=>G.id))}await Promise.all(k.deckInfos.map(G=>Dt.createNewDeck(G.name,G.description,G.cardNames,G.lastUsedAt))),q.length&&await Promise.all(q.map(Dt.remove)),W()},xe=()=>innerWidth<=1400?"compact":"wide";gt();var _e=yn(),A=Y(_e),h=s(a(A),2),I=a(h),Z=a(I),ie=a(Z),$=s(a(ie),2),z=a($),L=s(ie,2),ee=a(L),se=a(ee),ge=a(se),f=s(se,2),x=a(f),_=s(ee,2),g=a(_),N=a(g),P=s(g,2);ne(P,5,()=>za,oe,(k,q)=>{var G=Vi(),De=a(G),Ie,Ge=s(De);y(()=>{Ie!==(Ie=e(q))&&(De.value=(De.__value=e(q))==null?"":e(q)),m(Ge,` ${us[e(q)]??""}`)}),Et(t,[],De,()=>(e(q),e(o).deckCardKinds),Ye=>Me(o,e(o).deckCardKinds=Ye)),r(k,G)});var we=s(_,2);{var pe=k=>{var q=Xi(),G=a(q),De=a(G),Ie=s(G,2);ne(Ie,5,()=>Bt,oe,(Ge,Ye)=>{var Pe=Gi(),qe=a(Pe),He,Qe=s(qe);y(()=>{He!==(He=e(Ye))&&(qe.value=(qe.__value=e(Ye))==null?"":e(Ye)),m(Qe,` ${Xt[e(Ye)]??""}${ea[e(Ye)]??""}`)}),Et(v,[],qe,()=>(e(Ye),e(o).exMonsterCategories),ct=>Me(o,e(o).exMonsterCategories=ct)),r(Ge,Pe)}),ve("click",De,()=>M(["exMonsterCategories"])),te(3,q,()=>fe,()=>({delay:0,duration:100})),r(k,q)};b(we,k=>{e(o).deckCardKinds.includes("ExtraMonster")&&k(pe)})}var ue=s(we,2);{var Q=k=>{var q=en(),G=Y(q),De=a(G),Ie=a(De),Ge=s(De,2);ne(Ge,5,()=>Ma.filter(Be=>!Bt.includes(Be)),oe,(Be,Ne)=>{var ft=Qi(),tt=a(ft),Ct,zt=s(tt);y(()=>{Ct!==(Ct=e(Ne))&&(tt.value=(tt.__value=e(Ne))==null?"":e(Ne)),m(zt,` ${Xt[e(Ne)]??""}${ea[e(Ne)]??""}`)}),Et(p,[],tt,()=>(e(Ne),e(o).monsterCategories),at=>Me(o,e(o).monsterCategories=at)),r(Be,ft)});var Ye=s(G,2),Pe=a(Ye),qe=a(Pe),He=s(Pe,2);ne(He,5,()=>qa,oe,(Be,Ne)=>{var ft=Ji(),tt=a(ft),Ct,zt=s(tt,2),at=s(zt);y(()=>{Ct!==(Ct=e(Ne))&&(tt.value=(tt.__value=e(Ne))==null?"":e(Ne)),Ue(zt,`monster_attr ${e(Ne)??""} svelte-1wqus8z`),m(at,` ${pa[e(Ne)]??""}`)}),Et(c,[],tt,()=>(e(Ne),e(o).monsterAttributes),ot=>Me(o,e(o).monsterAttributes=ot)),r(Be,ft)});var Qe=s(Ye,2),ct=a(Qe),At=a(ct),St=s(ct,2);ne(St,5,()=>Sa,oe,(Be,Ne)=>{var ft=Zi(),tt=a(ft),Ct,zt=s(tt);y(()=>{Ct!==(Ct=e(Ne))&&(tt.value=(tt.__value=e(Ne))==null?"":e(Ne)),m(zt,` ${ra[e(Ne)]??""}
                    ${ya[e(Ne)]??""}`)}),Et(u,[],tt,()=>(e(Ne),e(o).monsterTypes),at=>Me(o,e(o).monsterTypes=at)),ve("dblclick",ft,at=>E(at,"monsterTypes",e(Ne))),r(Be,ft)});var qt=s(Qe,2),Yt=a(qt),Ht=a(Yt),st=s(Yt,2),Ze=a(st),rt=s(a(Ze),2),it=s(rt,4),vt=s(Ze,2),_t=s(a(vt),2),ut=s(_t,4),xt=s(vt,2),Mt=s(a(xt),2),Je=s(Mt,4),et=s(xt,2),nt=s(a(et),2);ve("click",Ie,()=>M(["monsterCategories"])),te(3,G,()=>fe,()=>({delay:0,duration:100})),ve("click",qe,()=>M(["monsterAttributes"])),te(3,Ye,()=>fe,()=>({delay:0,duration:100})),ve("click",At,()=>M(["monsterTypes"])),te(3,Qe,()=>fe,()=>({delay:0,duration:100})),ve("click",Ht,()=>M(["starLowerBound","starUpperBound","atkLowerBound","atkUpperBound","defLowerBound","defUpperBound","atkPlusDef"])),$t(rt,()=>e(o).starLowerBound,Be=>Me(o,e(o).starLowerBound=Be)),$t(it,()=>e(o).starUpperBound,Be=>Me(o,e(o).starUpperBound=Be)),$t(_t,()=>e(o).atkLowerBound,Be=>Me(o,e(o).atkLowerBound=Be)),$t(ut,()=>e(o).atkUpperBound,Be=>Me(o,e(o).atkUpperBound=Be)),$t(Mt,()=>e(o).defLowerBound,Be=>Me(o,e(o).defLowerBound=Be)),$t(Je,()=>e(o).defUpperBound,Be=>Me(o,e(o).defUpperBound=Be)),$t(nt,()=>e(o).atkPlusDef,Be=>Me(o,e(o).atkPlusDef=Be)),te(3,qt,()=>fe,()=>({delay:0,duration:100})),r(k,q)};b(ue,k=>{(e(o).deckCardKinds.includes("Monster")||e(o).deckCardKinds.includes("ExtraMonster"))&&k(Q)})}var V=s(ue,2);{var O=k=>{var q=an(),G=a(q),De=a(G),Ie=s(G,2);ne(Ie,5,()=>$a.filter(Ge=>Ge!=="PendulumScale"),oe,(Ge,Ye)=>{var Pe=tn(),qe=a(Pe),He,Qe=s(qe);y(()=>{He!==(He=e(Ye))&&(qe.value=(qe.__value=e(Ye))==null?"":e(Ye)),m(Qe,` ${ia[e(Ye)]??""}`)}),Et(l,[],qe,()=>(e(Ye),e(o).spellCategories),ct=>Me(o,e(o).spellCategories=ct)),r(Ge,Pe)}),ve("click",De,()=>M(["spellCategories"])),te(3,q,()=>fe,()=>({delay:0,duration:100})),r(k,q)};b(V,k=>{e(o).deckCardKinds.includes("Spell")&&k(O)})}var ye=s(V,2);{var Re=k=>{var q=rn(),G=a(q),De=a(G),Ie=s(G,2);ne(Ie,5,()=>Da,oe,(Ge,Ye)=>{var Pe=sn(),qe=a(Pe),He,Qe=s(qe);y(()=>{He!==(He=e(Ye))&&(qe.value=(qe.__value=e(Ye))==null?"":e(Ye)),m(Qe,` ${na[e(Ye)]??""}`)}),Et(B,[],qe,()=>(e(Ye),e(o).trapCategories),ct=>Me(o,e(o).trapCategories=ct)),r(Ge,Pe)}),ve("click",De,()=>M(["trapCategories"])),te(3,q,()=>fe,()=>({delay:0,duration:100})),r(k,q)};b(ye,k=>{e(o).deckCardKinds.includes("Trap")&&k(Re)})}var We=s(ye,2),Fe=a(We),Le=a(Fe),Xe=s(Fe,2);ne(Xe,4,()=>[{key:"test",text:"テスト用カード"},{key:"oldVersion",text:"エラッタ前カード"},{key:"implemented",text:"未実装カード"}],oe,(k,q)=>{var G=nn(),De=a(G),Ie,Ge=s(De);y(()=>{Ie!==(Ie=q.key)&&(De.value=(De.__value=q.key)==null?"":q.key),m(Ge,` ${q.text??""}`)}),Et(R,[],De,()=>(q.key,e(o).others),Ye=>Me(o,e(o).others=Ye)),r(k,G)});var Ee=s(Z,2);Yi(Ee,{get cardInfo(){return e(ke)}});var me=s(I,2),Ce=a(me);yt(Ce,()=>Gt,k=>{var q=on();r(k,q)},(k,q)=>{const G=de(()=>Object.values(e(q).dic));Ua(k,{mode:"List",get allCardInfos(){return e(G)},onAttention:ae,get searchCondition(){return e(o)},get deckCardInfos(){return e(J).cardInfos},set deckCardInfos(De){Me(J,e(J).cardInfos=De)},$$legacy:!0})});var Ae=s(me,2),Oe=a(Ae);{var Ke=k=>{var q=ze(),G=Y(q);yt(G,()=>e(w),De=>{var Ie=fn();r(De,Ie)},(De,Ie)=>{var Ge=un(),Ye=Y(Ge),Pe=a(Ye),qe=s(a(Pe),2),He=a(qe);y(()=>{e($e),Rt(()=>{e(Ie)})}),ne(He,5,()=>e(Ie),oe,(Je,et)=>{var nt=ln(),Be={},Ne=a(nt);y(()=>{Be!==(Be=e(et).id)&&(nt.value=(nt.__value=e(et).id)==null?"":e(et).id),m(Ne,e(et).name)}),r(Je,nt)});var Qe=s(Pe,2),ct=s(a(Qe),2),At=a(ct),St=s(Qe,4),qt=s(a(St),2),Yt=a(qt),Ht=s(qt,2),st=a(Ht),Ze=s(Ht,2),rt=a(Ze),it=s(St,2),vt=s(a(it),2);yt(vt,je,Je=>{var et=dn();r(Je,et)},(Je,et)=>{var nt=vn(),Be=a(nt);y(Ne=>wt(Be,"href",Ne),[()=>Dt.convertToObjectURL([e(et)])],de),r(Je,nt)});var _t=s(vt,2);yt(_t,()=>e(j),Je=>{var et=_n();r(Je,et)},(Je,et)=>{var nt=cn(),Be=a(nt);y(()=>wt(Be,"href",e(et))),r(Je,nt)});var ut=s(_t,2),xt=a(ut),Mt=s(Ye,2);Ua(Mt,{mode:"Deck",allCardInfos:[],onAttention:ae,get deckCardInfos(){return e(J).cardInfos},set deckCardInfos(Je){Me(J,e(J).cardInfos=Je)},$$legacy:!0}),Wt(He,()=>e($e),Je=>C($e,Je)),ve("change",He,le),$t(At,()=>e(J).name,Je=>Me(J,e(J).name=Je)),ve("click",Yt,T),ve("click",st,F),ve("click",rt,K),ve("click",xt,ce),r(De,Ge)}),r(k,q)},Se=k=>{var q=pn();r(k,q)};b(Oe,k=>{e(U)==="DeckEdit"||xe()==="wide"?k(Ke):k(Se,!1)})}var Te=s(A,2);Ki(Te,{modalController:D}),y((k,q,G)=>Ue(A,`deck_editor screen_size_${k??""} left_pain_mode_${q??""} main_view_mode_${G??""} svelte-1wqus8z`),[xe,()=>e(X).toLowerCase(),()=>e(U).toLowerCase()],de),ve("click",z,H),ve("click",ge,()=>M(["name"])),$t(x,()=>e(o).name,k=>Me(o,e(o).name=k)),ve("click",N,()=>M(["deckCardKinds"])),ve("click",Le,()=>M(["others"])),te(3,We,()=>fe,()=>({delay:0,duration:100})),ve("focusin",Z,()=>{C(X,"SearchCondition"),C(U,"SearchCondition")}),ve("click",Z,()=>{C(X,"SearchCondition"),C(U,"SearchCondition")}),ve("click",Ae,()=>{C(U,"DeckEdit")}),ve("focusin",Ae,()=>{C(U,"DeckEdit")}),r(d,_e),bt()}const gn=["TblDeckHeader","TblDeckDetail","TblDuelistProfile"],bn=3;var hn=n('<input class="game_mode_radio svelte-sy4ydn" type="radio" name="game_mode"> <label> </label>',1),wn=n('<option class="svelte-sy4ydn"> </option>'),kn=n('<option class="svelte-sy4ydn"> </option>'),xn=n('<option class="svelte-sy4ydn"> </option>'),Cn=n('<tr class="config_row svelte-sy4ydn"><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><label for="npc_deck_selector" class="config_row_label deck_selector svelte-sy4ydn">デッキ：</label></div></td><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><select id="npc_deck_selector" class="deck_selector svelte-sy4ydn"><option class="svelte-sy4ydn">デフォルト</option><!></select></div></td></tr>'),Dn=n('<option class="svelte-sy4ydn"> </option>'),$n=n('<tr class="config_row svelte-sy4ydn"><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><label for="npc_selector" class="config_row_label npc_selector svelte-sy4ydn">対戦相手：</label></div></td><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><select id="npc_selector" class="npc_selector svelte-sy4ydn"></select> <div class="svelte-sy4ydn"> </div></div></td></tr> <!> <tr class="config_row svelte-sy4ydn"><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><label for="npc_selector" class="config_row_label npc_selector svelte-sy4ydn">先攻後攻：</label></div></td><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><select id="npc_selector" class="npc_selector svelte-sy4ydn"></select></div></td></tr>',1),Sn=n('<option class="svelte-sy4ydn"> </option>'),qn=n('<tr class="config_row svelte-sy4ydn"><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><label for="difficulty_selector" class="config_row_label difficulty_selector svelte-sy4ydn">難易度：</label></div></td><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><select id="difficulty_selector" class="difficulty_selector svelte-sy4ydn"></select></div></td></tr>'),Mn=n('<tr class="config_row svelte-sy4ydn"><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><label class="config_row_label svelte-sy4ydn" for="game_mode_radio_preset">ゲームモード：</label></div></td><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"></div></td></tr> <tr class="config_row svelte-sy4ydn"><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><label for="deck_selector" class="config_row_label deck_selector svelte-sy4ydn">デッキ：</label></div></td><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><select id="deck_selector" class="deck_selector svelte-sy4ydn"></select></div></td></tr> <!> <tr><td colspan="2" class="svelte-sy4ydn"><div><button class="btn svelte-sy4ydn">duel start!</button></div></td></tr>',1),zn=n('<tr><td colspan="2" class="svelte-sy4ydn"><div>デッキ情報の読み込み、もしくは作成中...</div></td></tr>'),jn=n('<tr><td colspan="2" class="svelte-sy4ydn"><div><button class="btn svelte-sy4ydn">deck edit</button></div></td></tr>'),Tn=n('<tr class="config_row svelte-sy4ydn"><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><label for="duelist_name" class="config_row_label duelist_name svelte-sy4ydn">名前：</label></div></td><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><input id="duelist_name" class="duelist_name svelte-sy4ydn" type="text"></div></td></tr> <!> <!>',1),Bn=n('<tr><td colspan="2" class="svelte-sy4ydn"><div>デュエリスト情報の読み込み、もしくは作成中...</div></td></tr>'),En=n('<div class="app_body svelte-sy4ydn"><table class="config_table svelte-sy4ydn"><tbody><!></tbody></table></div>'),An=n('<span class="svelte-sy4ydn"> </span> <span class="svelte-sy4ydn"> </span>',1),Yn=n('<div class="result_title result_win svelte-sy4ydn">YOU WIN</div>'),Un=n('<div class="result_title result_lose svelte-sy4ydn">YOU LOSE</div>'),Ln=n('<div class="result_title result_draw svelte-sy4ydn">DRAW</div>'),Nn=n('<div class="twitter_share_button_wrapper svelte-sy4ydn"><a rel="nofollow" target="_blank" class="twitter_share_button svelte-sy4ydn">X(twitter)でシェアする</a></div>'),Pn=n('<div class="result svelte-sy4ydn"><!> <div class="reason_of_end svelte-sy4ydn"> </div> <!> <div class="svelte-sy4ydn"><button class="white_button svelte-sy4ydn">TOPへ戻る</button></div></div>'),Fn=n('<main style="flex-direction: column; display :flex" class="svelte-sy4ydn"><div class="link link_left svelte-sy4ydn"><a href="https://github.com/Setta238/stk_ygo_svelte" target="_blank" rel="noopener noreferrer" title="repository" class="svelte-sy4ydn">repository</a> <a href="https://x.com/ninja_no" target="_blank" rel="noopener noreferrer" title="repository" class="svelte-sy4ydn">X(Twitter)</a> <a href="https://posfie.com/@ninja_no/p/Lx7FLj3" target="_blank" rel="noopener noreferrer" title="posfie" class="svelte-sy4ydn">posfie(toggeter)</a></div> <div class="link link_right svelte-sy4ydn"><a class="a_button svelte-sy4ydn" role="button" tabindex="0">TOPへ戻る</a> <a href="/stk_ygo_svelte/note.html" target="_blank" rel="noopener noreferrer" title="repository" class="svelte-sy4ydn">現時点とこの先のこと</a></div> <!> <div class="footer card_summary svelte-sy4ydn"><!></div> <div class="footer debug_info svelte-sy4ydn"><span class="svelte-sy4ydn"> </span> <span class="user_agent_info svelte-sy4ydn"> </span> <span class="screen_info svelte-sy4ydn"> </span></div> <!></main>');function Hn(d,i){mt(i,!1);const t=new fs("stk_ygo_svelte",bn,gn);let v=be(0),p=be(0),c=be(),u=be("FtkChallenge"),l=be("None"),B=be(0),R=be(""),D=be(void 0);const S="https://setta238.github.io/stk_ygo_svelte/",o="遊戯王deそりてあ",U="ninja_no",X=ps.getOrCreateNew(t).then(f=>(C(u,ja.includes(f.previousGameMode)?f.previousGameMode:"FtkChallenge"),je(f.previousNpcId),f)),H=f=>{var _;const x=f.find(g=>g.lastUsedAt.getTime()===Math.max(...f.map(N=>N.lastUsedAt.getTime())))??f[0];C(B,x.id),e(u)==="FtkChallenge"&&x.deckType!=="Preset"&&C(B,((_=Lt.find(g=>g.deckType==="Preset"))==null?void 0:_.id)??e(B))};let M=be(Dt.getAllDeckInfo(t).then(f=>(Promise.all(f.filter(x=>!x.lastUsedAt).map(x=>{x.saveDeckInfo()})),H(f),f)));const E=async()=>{const f=e(B);let x=(await e(M)).find(g=>g.id===f)??(await he()).find(g=>g.id===f);x&&await x.updateTimestamp();let _=x;if(_||(_=Lt.find(g=>g.id===f)),!_)throw new Error("illegal state");return _},le=async()=>{(await X).save({previousGameMode:e(u)})},he=()=>(C(M,Dt.getAllDeckInfo(t).then(f=>(H(f),f))),e(M)),$e=async()=>{(await e(M)).length||(await Dt.prepareSampleDeck(),he())},w=async()=>{await Promise.all([le(),$e()]);const f=await E(),x=await X;let _=It.find(P=>P.id===Number.MIN_SAFE_INTEGER)??It[0],g=Lt.find(P=>P.id===Number.MIN_SAFE_INTEGER)??Lt[0],N="PlayFirst";e(u)==="FtkChallenge"?_=It.filter(P=>P.npcType==="FtkChallenge").find(P=>P.difficulty===x.previousDifficulty)??_:e(u)==="Free"&&(_=It.find(P=>P.id===x.previousNpcId)??_,g=Lt.slice(-1)[0],N=x.previousStartMode),_.npcType!=="FtkChallenge"&&x.previousNpcDeckId>-1?g=(await e(M)).find(P=>P.id===x.previousNpcDeckId)??g:g=Lt.find(P=>P.id===_.id)??g,C(c,new bs(x,"Player",f,[],_,"NPC",g,[],N)),e(c).onDuelEnd.append(()=>(C(c,e(c)),"RemoveMe"))},j=async()=>{await Promise.all([le(),$e()]),C(l,"DeckEdit")},W=async f=>{await le(),f.key==="Enter"&&!f.repeat&&(await X).save()},J=()=>{C(M,he()),C(c,void 0),C(l,"None")};let ke=Date.now();const re=f=>{Date.now()-ke<200||(ke=Date.now(),C(u,f),he())},ae=f=>{je(Number(f.currentTarget.value))},je=f=>{var x;C(D,It.find(_=>_.id===f)),C(R,((x=e(D))==null?void 0:x.description)??"")};$e(),gt();var T=Fn(),F=s(a(T),2),K=a(F),ce=s(F,2);{var xe=f=>{var x=ze(),_=Y(x);yt(_,()=>X,null,(g,N)=>{_i(g,{get duel(){return e(c)},get userProfile(){return e(N)}})}),r(f,x)},_e=f=>{var x=ze(),_=Y(x);{var g=P=>{mn(P,{})},N=P=>{var we=En(),pe=a(we),ue=a(pe),Q=a(ue);yt(Q,()=>X,V=>{var O=Bn();r(V,O)},(V,O)=>{var ye=Tn(),Re=Y(ye),We=a(Re),Fe=a(We),Le=s(We),Xe=a(Le),Ee=a(Xe),me=s(Re,2);yt(me,()=>e(M),Oe=>{var Ke=zn();r(Oe,Ke)},(Oe,Ke)=>{var Se=Mn(),Te=Y(Se),k=a(Te),q=a(k),G=s(k),De=a(G);ne(De,5,()=>ja,oe,(st,Ze)=>{var rt=hn(),it=Y(rt),vt=s(it,2),_t=a(vt);y(ut=>{wt(it,"id",`game_mode_radio_${ut??""}`),ms(it,e(Ze)),gs(it,e(u)===e(Ze)),Ue(vt,`game_mode_tab_label game_mode_tab_${ut??""} svelte-sy4ydn`),wt(vt,"for",`game_mode_radio_${ut??""}`),m(_t,e(Ze))},[()=>e(Ze).toLowerCase()],de),ve("change",it,()=>re(e(Ze))),r(st,rt)});var Ie=s(Te,2),Ge=a(Ie),Ye=a(Ge),Pe=s(Ge),qe=a(Pe),He=a(qe);y(()=>{e(B),Rt(()=>{e(u),e(Ke)})}),ne(He,5,()=>e(u)==="FtkChallenge"?Lt.filter(st=>st.deckType==="Preset"):e(Ke),oe,(st,Ze)=>{var rt=wn(),it={},vt=a(rt);y(()=>{it!==(it=e(Ze).id)&&(rt.value=(rt.__value=e(Ze).id)==null?"":e(Ze).id),m(vt,e(Ze).name)}),r(st,rt)});var Qe=s(Ie,2);{var ct=st=>{var Ze=$n(),rt=Y(Ze),it=a(rt),vt=a(it),_t=s(it),ut=a(_t),xt=a(ut);y(()=>{e(O),Rt(()=>{})}),ne(xt,5,()=>It,oe,(at,ot)=>{var ht=kn(),Ut={},Ot=a(ht);y(()=>{Ut!==(Ut=e(ot).id)&&(ht.value=(ht.__value=e(ot).id)==null?"":e(ot).id),m(Ot,e(ot).name)}),r(at,ht)});var Mt=s(xt,2),Je=a(Mt),et=s(rt,2);{var nt=at=>{var ot=Cn(),ht=a(ot),Ut=a(ht),Ot=s(ht),ba=a(Ot),ha=a(ba);y(()=>{e(O),Rt(()=>{e(Ke)})});var oa=a(ha);oa.value=(oa.__value=Number.MIN_SAFE_INTEGER)==null?"":Number.MIN_SAFE_INTEGER;var Pa=s(oa);ne(Pa,1,()=>e(Ke),oe,(la,Jt)=>{var Zt=xn(),wa={},Fa=a(Zt);y(()=>{wa!==(wa=e(Jt).id)&&(Zt.value=(Zt.__value=e(Jt).id)==null?"":e(Jt).id),m(Fa,e(Jt).name)}),r(la,Zt)}),te(3,Ut,()=>fe,()=>({duration:200})),te(3,ht,()=>fe,()=>({duration:200})),Wt(ha,()=>e(O).previousNpcDeckId,la=>e(O).previousNpcDeckId=la),te(3,ba,()=>fe,()=>({duration:200})),te(3,Ot,()=>fe,()=>({duration:200})),te(3,ot,()=>fe,()=>({duration:200})),r(at,ot)};b(et,at=>{var ot;((ot=e(D))==null?void 0:ot.npcType)!=="FtkChallenge"&&at(nt)})}var Be=s(et,2),Ne=a(Be),ft=a(Ne),tt=s(Ne),Ct=a(tt),zt=a(Ct);y(()=>{e(O),Rt(()=>{})}),ne(zt,5,()=>fa(Ta),oe,(at,ot)=>{var ht=Dn(),Ut={},Ot=a(ht);y(()=>{Ut!==(Ut=e(ot))&&(ht.value=(ht.__value=e(ot))==null?"":e(ot)),m(Ot,Ta[e(ot)])}),r(at,ht)}),y(()=>m(Je,`※${e(R)??""}`)),te(3,vt,()=>fe,()=>({duration:200})),te(3,it,()=>fe,()=>({duration:200})),ve("change",xt,ae),Wt(xt,()=>e(O).previousNpcId,at=>e(O).previousNpcId=at),te(3,ut,()=>fe,()=>({duration:200})),te(3,_t,()=>fe,()=>({duration:200})),te(3,rt,()=>fe,()=>({duration:200})),te(3,ft,()=>fe,()=>({duration:200})),te(3,Ne,()=>fe,()=>({duration:200})),Wt(zt,()=>e(O).previousStartMode,at=>e(O).previousStartMode=at),te(3,Ct,()=>fe,()=>({duration:200})),te(3,tt,()=>fe,()=>({duration:200})),te(3,Be,()=>fe,()=>({duration:200})),r(st,Ze)},At=st=>{var Ze=ze(),rt=Y(Ze);{var it=vt=>{var _t=qn(),ut=a(_t),xt=a(ut),Mt=s(ut),Je=a(Mt),et=a(Je);y(()=>{e(O),Rt(()=>{})}),ne(et,5,()=>hs,oe,(nt,Be)=>{var Ne=Sn(),ft={},tt=a(Ne);y(()=>{ft!==(ft=e(Be))&&(Ne.value=(Ne.__value=e(Be))==null?"":e(Be)),m(tt,e(Be))}),r(nt,Ne)}),te(3,xt,()=>fe,()=>({duration:200})),te(3,ut,()=>fe,()=>({duration:200})),Wt(et,()=>e(O).previousDifficulty,nt=>e(O).previousDifficulty=nt),te(3,Je,()=>fe,()=>({duration:200})),te(3,Mt,()=>fe,()=>({duration:200})),te(3,_t,()=>fe,()=>({duration:200})),r(vt,_t)};b(rt,vt=>{e(u)==="FtkChallenge"&&vt(it)},!0)}r(st,Ze)};b(Qe,st=>{e(u)==="Free"?st(ct):st(At,!1)})}var St=s(Qe,2),qt=a(St),Yt=a(qt),Ht=a(Yt);te(3,q,()=>fe,()=>({duration:200})),te(3,k,()=>fe,()=>({duration:200})),te(3,De,()=>fe,()=>({duration:200})),te(3,G,()=>fe,()=>({duration:200})),te(3,Te,()=>fe,()=>({duration:200})),te(3,Ye,()=>fe,()=>({duration:200})),te(3,Ge,()=>fe,()=>({duration:200})),Wt(He,()=>e(B),st=>C(B,st)),te(3,qe,()=>fe,()=>({duration:200})),te(3,Pe,()=>fe,()=>({duration:200})),te(3,Ie,()=>fe,()=>({duration:200})),ve("click",Ht,w),te(3,Yt,()=>fe,()=>({duration:200})),r(Oe,Se)});var Ce=s(me,2);{var Ae=Oe=>{var Ke=jn(),Se=a(Ke),Te=a(Se),k=a(Te);ve("click",k,j),te(3,Te,()=>fe,()=>({duration:200})),te(3,Se,()=>fe,()=>({duration:200})),te(3,Ke,()=>fe,()=>({duration:200})),r(Oe,Ke)};b(Ce,Oe=>{e(u)==="Free"&&Oe(Ae)})}te(3,Fe,()=>fe,()=>({duration:200})),te(3,We,()=>fe,()=>({duration:200})),$t(Ee,()=>e(O).name,Oe=>e(O).name=Oe),ve("keypress",Ee,W),te(3,Xe,()=>fe,()=>({duration:200})),te(3,Le,()=>fe,()=>({duration:200})),te(3,Re,()=>fe,()=>({duration:200})),r(V,ye)}),r(P,we)};b(_,P=>{e(l)==="DeckEdit"?P(g):P(N,!1)},!0)}r(f,x)};b(ce,f=>{e(c)?f(xe):f(_e,!1)})}var A=s(ce,2),h=a(A);yt(h,()=>Gt,f=>{var x=dt("読み込み中");r(f,x)},(f,x)=>{var _=An(),g=Y(_),N=a(g),P=s(g,2),we=a(P);y((pe,ue,Q)=>{m(N,`公式DB上のカード${pe??""}枚`),m(we,`実装済カード（効果あり）${ue??""}枚 （効果なし）${Q??""}枚`)},[()=>e(x).knmCount.toLocaleString(),()=>e(x).definitionCount.toLocaleString(),()=>e(x).nonDefinitionCount.toLocaleString()],de),r(f,_)});var I=s(A,2),Z=a(I),ie=a(Z),$=s(Z,2),z=a($),L=s($,2),ee=a(L),se=s(I,2);{var ge=f=>{var x=Pn(),_=a(x);{var g=O=>{var ye=ze(),Re=Y(ye);{var We=Le=>{var Xe=Yn();r(Le,Xe)},Fe=Le=>{var Xe=ze(),Ee=Y(Xe);{var me=Ce=>{var Ae=Un();r(Ce,Ae)};b(Ee,Ce=>{e(c).winner.seat==="Above"&&Ce(me)},!0)}r(Le,Xe)};b(Re,Le=>{e(c).winner.seat==="Below"?Le(We):Le(Fe,!1)})}r(O,ye)},N=O=>{var ye=Ln();r(O,ye)};b(_,O=>{e(c).winner?O(g):O(N,!1)})}var P=s(_,2),we=a(P),pe=s(P,2);{var ue=O=>{var ye=Nn(),Re=a(ye);y(()=>wt(Re,"href",`https://x.com/share?url=${S}&text=${e(c).twitterShareText??""}&hashtags=${o}&via=${U}`)),r(O,ye)};b(pe,O=>{e(c).twitterShareText&&O(ue)})}var Q=s(pe,2),V=a(Q);y(()=>m(we,e(c).reasonOfEnd)),ve("click",V,J),te(3,x,()=>xs,()=>({delay:200,duration:200})),r(f,x)};b(se,f=>{e(c)&&e(c).isEnded&&f(ge)})}y(()=>{m(ie,"build at: 20260107_190727"),m(z,ys.text),m(ee,`w:${e(v)??""}px h:${e(p)??""}px`)}),ta("innerWidth",f=>C(v,f)),ta("innerHeight",f=>C(p,f)),ve("click",K,J),r(d,T),bt()}ws(Hn,{target:document.getElementById("app")});
