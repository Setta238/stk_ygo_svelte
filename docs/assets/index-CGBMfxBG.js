var Ua=Object.defineProperty;var ha=o=>{throw TypeError(o)};var Pa=(o,i,t)=>i in o?Ua(o,i,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[i]=t;var Ze=(o,i,t)=>Pa(o,typeof i!="symbol"?i+"":i,t),ya=(o,i,t)=>i.has(o)||ha("Cannot "+t);var at=(o,i,t)=>(ya(o,i,"read from private field"),t?t.call(o):i.get(o)),Ft=(o,i,t)=>i.has(o)?ha("Cannot add the same private member more than once"):i instanceof WeakSet?i.add(o):i.set(o,t),aa=(o,i,t,v)=>(ya(o,i,"write to private field"),v?v.call(o,t):i.set(o,t),t);import{s as ka,r as Oa,a as D,b as La,l as Ra,g as e,d as Na,p as st,c as Le,m as ke,i as it,t as n,e as a,f as y,h as u,j as fe,k as Ae,n as gt,o as ye,q as r,u as nt,v as Pe,S as Wa,w as Me,x as U,y as s,z as ie,D as St,A as ee,B as le,C as f,E as Ka,F as rt,G as oa,H as za,I as Ga,J as Mt,K as bt,L as va,M as Vt,N as da,O as Qt,P as ca,Q as Zt,R as Jt,T as Xa,U as Va,V as Qa,W as Za,X as Ja,Y as er,Z as tr,_ as Kt,$ as ht,a0 as zt,a1 as ra,a2 as Ia,a3 as ar,a4 as rr,a5 as sr,a6 as ir,a7 as nr,a8 as ft,a9 as lr,aa as or,ab as vr,ac as wa,ad as xa,ae as Ca,af as Da,ag as $a,ah as Sa,ai as At,aj as Yt,ak as sa,al as Ma,am as dr,an as Dt,ao as cr,ap as _r,aq as Ta,ar as qt,as as $t,at as ur,au as fr,av as pr,aw as gr,ax as ja,ay as mr,az as br}from"../chunk/entity_proc_20251127_225344.js";import"../chunk/json_20251127_225344.js";(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const _ of document.querySelectorAll('link[rel="modulepreload"]'))v(_);new MutationObserver(_=>{for(const c of _)if(c.type==="childList")for(const b of c.addedNodes)b.tagName==="LINK"&&b.rel==="modulepreload"&&v(b)}).observe(document,{childList:!0,subtree:!0});function t(_){const c={};return _.integrity&&(c.integrity=_.integrity),_.referrerPolicy&&(c.referrerPolicy=_.referrerPolicy),_.crossOrigin==="use-credentials"?c.credentials="include":_.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function v(_){if(_.ep)return;_.ep=!0;const c=t(_);fetch(_.href,c)}})();const hr=o=>o;function _a(o){const i=o-1;return i*i*i+1}function Ea(o){const i=typeof o=="string"&&o.match(/^\s*(-?[\d.]+)([^\s]*)\s*$/);return i?[parseFloat(i[1]),i[2]||"px"]:[o,"px"]}function yr(o,{delay:i=0,duration:t=400,easing:v=hr}={}){const _=+getComputedStyle(o).opacity;return{delay:i,duration:t,easing:v,css:c=>`opacity: ${c*_}`}}function kr(o,{delay:i=0,duration:t=400,easing:v=_a,x:_=0,y:c=0,opacity:b=0}={}){const d=getComputedStyle(o),q=+d.opacity,P=d.transform==="none"?"":d.transform,x=q*(1-b),[l,L]=Ea(_),[F,R]=Ea(c);return{delay:i,duration:t,easing:v,css:(W,A)=>`
			transform: ${P} translate(${(1-W)*l}${L}, ${(1-W)*F}${R});
			opacity: ${q-x*A}`}}function pe(o,{delay:i=0,duration:t=400,easing:v=_a,axis:_="y"}={}){const c=getComputedStyle(o),b=+c.opacity,d=_==="y"?"height":"width",q=parseFloat(c[d]),P=_==="y"?["top","bottom"]:["left","right"],x=P.map(Y=>`${Y[0].toUpperCase()}${Y.slice(1)}`),l=parseFloat(c[`padding${x[0]}`]),L=parseFloat(c[`padding${x[1]}`]),F=parseFloat(c[`margin${x[0]}`]),R=parseFloat(c[`margin${x[1]}`]),W=parseFloat(c[`border${x[0]}Width`]),A=parseFloat(c[`border${x[1]}Width`]);return{delay:i,duration:t,easing:v,css:Y=>`overflow: hidden;opacity: ${Math.min(Y*20,1)*b};${d}: ${Y*q}px;padding-${P[0]}: ${Y*l}px;padding-${P[1]}: ${Y*L}px;margin-${P[0]}: ${Y*F}px;margin-${P[1]}: ${Y*R}px;border-${P[0]}-width: ${Y*W}px;border-${P[1]}-width: ${Y*A}px;min-${d}: 0`}}function qa(o,i){for(const t in i)o[t]=i[t];return o}function wr({fallback:o,...i}){const t=new Map,v=new Map;function _(b,d,q){const{delay:P=0,duration:x=k=>Math.sqrt(k)*30,easing:l=_a}=qa(qa({},i),q),L=b.getBoundingClientRect(),F=d.getBoundingClientRect(),R=L.left-F.left,W=L.top-F.top,A=L.width/F.width,Y=L.height/F.height,te=Math.sqrt(R*R+W*W),ne=getComputedStyle(d),Te=ne.transform==="none"?"":ne.transform,S=+ne.opacity;return{delay:P,duration:typeof x=="function"?x(te):x,easing:l,css:(k,K)=>`
			   opacity: ${k*S};
			   transform-origin: top left;
			   transform: ${Te} translate(${K*R}px,${K*W}px) scale(${k+(1-k)*A}, ${k+(1-k)*Y});
		   `}}function c(b,d,q){return(P,x)=>(b.set(x.key,P),()=>{if(d.has(x.key)){const l=d.get(x.key);return d.delete(x.key),_(l,P,x)}return b.delete(x.key),o&&o(P,x,q)})}return[c(v,t,!1),c(t,v,!0)]}function Aa(o){return Object.prototype.toString.call(o)==="[object Date]"}function xr(o){return o}function ia(o){const i=o-1;return i*i*i+1}function na(o,i){if(o===i||o!==o)return()=>o;const t=typeof o;if(t!==typeof i||Array.isArray(o)!==Array.isArray(i))throw new Error("Cannot interpolate values of different type");if(Array.isArray(o)){const v=i.map((_,c)=>na(o[c],_));return _=>v.map(c=>c(_))}if(t==="object"){if(!o||!i)throw new Error("Object cannot be null");if(Aa(o)&&Aa(i)){const c=o.getTime(),d=i.getTime()-c;return q=>new Date(c+q*d)}const v=Object.keys(i),_={};return v.forEach(c=>{_[c]=na(o[c],i[c])}),c=>{const b={};return v.forEach(d=>{b[d]=_[d](c)}),b}}if(t==="number"){const v=i-o;return _=>o+_*v}return()=>i}var mt,Bt,Ht,Tt;const ua=class ua{constructor(i,t={}){Ft(this,mt,ka(void 0));Ft(this,Bt,ka(void 0));Ft(this,Ht);Ft(this,Tt,null);at(this,mt).v=at(this,Bt).v=i,aa(this,Ht,t)}static of(i,t){const v=new ua(i(),t);return Oa(()=>{v.set(i())}),v}set(i,t){var l;D(at(this,Bt),i);let{delay:v=0,duration:_=400,easing:c=xr,interpolate:b=na}={...at(this,Ht),...t};if(_===0)return(l=at(this,Tt))==null||l.abort(),D(at(this,mt),i),Promise.resolve();const d=La.now()+v;let q,P=!1,x=at(this,Tt);return aa(this,Tt,Ra(L=>{if(L<d)return!0;if(!P){P=!0;const R=at(this,mt).v;q=b(R,i),typeof _=="function"&&(_=_(R,i)),x==null||x.abort()}const F=L-d;return F>_?(D(at(this,mt),i),!1):(D(at(this,mt),q(c(F/_))),!0)})),at(this,Tt).promise}get current(){return e(at(this,mt))}get target(){return e(at(this,Bt))}set target(i){this.set(i)}};mt=new WeakMap,Bt=new WeakMap,Ht=new WeakMap,Tt=new WeakMap;let Gt=ua;var Cr=n('<div class="phase_display svelte-1ycsdg6"><span class="svelte-1ycsdg6"> </span> </div>'),Dr=n('<div class="lifepoint_display svelte-1ycsdg6"><div class="svelte-1ycsdg6"> </div> <div class="svelte-1ycsdg6"> </div></div>'),$r=(o,i,t)=>i(e(t)),Sr=n('<div class="svelte-1ycsdg6"><button class="phase_button svelte-1ycsdg6"> </button></div>'),Mr=n("<div><!></div>"),Tr=n('<div class="svelte-1ycsdg6"><!></div>'),jr=n("<div><!></div>"),Er=n('<div class="config_button_wrapper svelte-1ycsdg6"><button id="config_button" class="svelte-1ycsdg6">⚙</button></div>'),qr=n("<!> <!> <!> <!>",1),Ar=n('<div style="position: absolute;" class="card_animation_receiver svelte-1ycsdg6"><!></div>'),Yr=n('<div style="position: absolute; top:0rem" class="svelte-1ycsdg6">｛効果対象｝</div>'),Br=n('<!> <div style="position: absolute; display:flex;justify-content: center;"><!></div>',1),Nr=n(" <!> 】",1),Ir=n('<div style="position: absolute; bottom:0rem" class="svelte-1ycsdg6"> <!></div>'),Fr=n("<!> <!>",1),Hr=n('<div class="badge svelte-1ycsdg6"> </div>'),Ur=n('<div class="card_animation_receiver svelte-1ycsdg6"><!></div>'),Pr=n("<!> <!> <!> <!>",1),Or=n('<td><div role="listitem"><!></div></td>');function Lr(o,i){st(i,!1);let t=Le(i,"view",12),v=Le(i,"row",8),_=Le(i,"column",8),c=Le(i,"selectedEntities",28,()=>[]),b=Le(i,"selectedCells",28,()=>[]),d=ke(t().getCell(v(),_())),q=ke(new Gt(e(d).field.duel.duelists.Above.lp,{duration:400,easing:ia})),P=ke(new Gt(e(d).field.duel.duelists.Below.lp,{duration:400,easing:ia}));const x=()=>{D(d,t().getCell(v(),_())),Pe(q,e(q).target=e(d).field.duel.duelists.Above.lp),Pe(P,e(P).target=e(d).field.duel.duelists.Below.lp)};e(d).onUpdate.append(x),t().onDuelUpdate.append(x),t().modalController.onUpdate.append(x);let l,L=ke([]),F=()=>console.log("hoge"),R,W=ke([]),A=ke(!1),Y=ke(!1),te=!1;const ne=$=>{var Q,re;D(_e,[]),c().reset(),l=$.activator,F=$.resolve,D(L,$.dummyActionInfos),D(W,$.chainBlockInfos.flatMap(Se=>Se.selectedEntities).getDistinct()),R=$.entitiesChoices,D(A,!1),D(Y,((Q=$.cellsChoices)==null?void 0:Q.selectables.includes(e(d)))??!1),te=e(Y)&&((re=$.cellsChoices)==null?void 0:re.qty)===1,x()};t().onWaitStart.append(ne);const Te=()=>{l=void 0,D(L,[]),F=()=>{console.log("hoge")},R=void 0,D(W,[]),D(A,!1),D(Y,!1),te=!1};t().onWaitEnd.append(Te);let S=ke(!1),k=[];const K=$=>{k=$.filter(Q=>Q.dests.includes(e(d))),D(S,k.length>0),x()},ae=()=>{k=[],D(S,!1),x()};t().onDragStart.append(K),t().onDragEnd.append(ae);const[we,Z]=Rs;let _e=ke([]);const V=$=>{if(l=void 0,e(d)===$.to||e(d).entities.includes($.entity)){D(_e,[...e(_e),$]);const Q=$.resolve;D(d,e(d)),setTimeout(()=>{D(_e,e(_e).filter(re=>re!==$)),$.count++,$.count>1&&Q()},600)}};t().onAnimation.append(V);const ge=$=>{F({phaseChange:$})},X=()=>e(d).isStackCell&&e(d).entities.flatMap($=>$.actions).filter($=>e(L).map(Q=>Q.action.seq).some(Q=>Q===$.seq)).length>0,z=$=>{var Q;if(((Q=$.target)==null?void 0:Q.id)==="config_button"){t(t().infoBoardState="Config",!0),t().requireUpdate();return}if(t(t().infoBoardState="Default",!0),te)F({selectedCells:[e(d)]});else if(e(Y))D(A,!e(A)),b(e(A)?[...b(),e(d)]:b().filter(re=>re!==e(d)));else if(e(d).isStackCell){t(t().infoBoardState="CellInfo",!0),t(t().infoBoardCell=e(d),!0),t().requireUpdate();const re=e(d).entities.flatMap(h=>h.actions).map(h=>h.seq),Se=e(L).filter(h=>re.includes(h.action.seq));if(Se.length){if(!l)return;t().modalController.actionSelector.show({title:"カードを選択。",position:"Bottom",activator:l,dummyActionInfos:Se,cancelable:!0}).then(h=>{h&&F({actionInfo:h})});return}}t().requireUpdate(),console.info(e(d),he(...e(d).visibleEntities))},se=$=>{$.preventDefault(),$.dataTransfer&&($.dataTransfer.dropEffect="move")},oe=$=>{$.preventDefault(),console.info("drop",$,e(S),k),$.dataTransfer&&($.dataTransfer.dropEffect="move");try{if(e(S)&&k){if(k.length===1){const Q=k[0];F({actionInfo:{...Q,dest:e(d)}})}else if(k.length>1){if(!l)throw new Wa("想定されない状態");e(d).field.duel.view.modalController.terminateAll(),e(d).field.duel.view.modalController.actionSelector.show({title:"選択",position:"Bottom",activator:l,dummyActionInfos:k.map(Q=>({...Q,dest:e(d)})),cancelable:!1}).then(Q=>{F({actionInfo:Q})})}}}finally{t().removeDraggingActions()}},he=(...$)=>{if(t().waitMode==="Animation")return"Disabled";if(R&&R.selectables.find(re=>$.find(Se=>re===Se)))return"Selectable";if(!e(L)||e(L).length===0||t().waitMode!=="Free"||Object.values(t().modalController.modals).some(re=>re.state==="Shown"))return"Disabled";const Q=e(L).filter(re=>$.includes(re.action.entity));return Q.length===0?"Disabled":e(d).isStackCell||Q[0].action.entity!==$[0]?"Clickable":Q.some(re=>re.dests.length)?"Draggable":"Clickable"};it();var H=Or(),M=a(H);M.__click=z;var G=a(M);{var J=$=>{var Q=Me(),re=U(Q);{var Se=h=>{var T=Me(),w=U(T);{var I=m=>{var ve=Cr(),ue=a(ve),xe=a(ue),de=s(ue,1,!0);u((me,E)=>{f(xe,me),f(de,E)},[()=>String(e(d).field.duel.clock.turn).padStart(2,"0"),()=>e(d).field.duel.phase.toUpperCase()],fe),r(m,ve)},p=m=>{var ve=Me(),ue=U(ve);{var xe=me=>{var E=Dr(),B=a(E),ce=a(B),Ce=s(B,2),Ke=a(Ce);u((Oe,Be)=>{f(ce,Oe),f(Ke,Be)},[()=>Math.floor(e(q).current),()=>Math.floor(e(P).current)],fe),r(me,E)},de=me=>{var E=Me(),B=U(E);{var ce=Ce=>{var Ke=Me(),Oe=U(Ke);{var Be=Ne=>{var ze=Me(),j=U(ze);{var C=g=>{var N=Me(),be=U(N);ie(be,1,()=>t().duel.nextPhaseList,le,(je,O)=>{var De=Sr(),Ye=a(De);Ye.__click=[$r,ge,O];var Re=a(Ye);u(Ie=>f(Re,Ie),[()=>e(O).toUpperCase()],fe),r(je,De)}),r(g,N)};y(j,g=>{t().duel.isEnded||g(C)})}r(Ne,ze)};y(Oe,Ne=>{t().waitMode==="Free"&&Ne(Be)})}r(Ce,Ke)};y(B,Ce=>{e(d).column===5&&Ce(ce)},!0)}r(me,E)};y(ue,me=>{e(d).column===3?me(xe):me(de,!1)},!0)}r(m,ve)};y(w,m=>{e(d).column===1?m(I):m(p,!1)})}r(h,T)};y(re,h=>{e(d).row===3&&h(Se)})}r($,Q)},Ee=$=>{var Q=Me(),re=U(Q);{var Se=T=>{var w=qr();const I=fe(()=>e(_e).find(E=>E.to===e(d)));var p=U(w);{var m=E=>{var B=Mr(),ce=a(B);St(ce,{get entity(){return e(I).entity},state:"Disabled",dummyActionInfos:[],cardActionResolve:void 0}),u(()=>Ae(B,`card_animation_receiver ${e(d).cellType??""} svelte-1ycsdg6`)),ee(1,B,()=>Z,()=>({key:e(I).entity.seq})),r(E,B)};y(p,E=>{e(I)&&e(I).index==="Top"&&E(m)})}var ve=s(p,2);ie(ve,1,()=>e(d).visibleEntities,le,(E,B)=>{var ce=Me(),Ce=U(ce);{var Ke=Oe=>{var Be=Tr(),Ne=a(Be);const ze=fe(()=>he(e(B))),j=fe(()=>e(L).filter(C=>C.action.entity===e(B)));St(Ne,{get entity(){return e(B)},get state(){return e(ze)},get dummyActionInfos(){return e(j)},cardActionResolve:void 0,get selectedList(){return c()},set selectedList(C){c(C)},$$legacy:!0}),ee(2,Be,()=>we,()=>({key:e(B).seq})),r(Oe,Be)};y(Ce,Oe=>{e(_e).every(Be=>Be.entity.seq!==e(B).seq)&&Oe(Ke)})}r(E,ce)});var ue=s(ve,2);{var xe=E=>{var B=jr(),ce=a(B);St(ce,{get entity(){return e(I).entity},state:"Disabled",dummyActionInfos:[],cardActionResolve:void 0}),u(()=>Ae(B,`card_animation_receiver ${e(d).cellType??""} svelte-1ycsdg6`)),ee(1,B,()=>Z,()=>({key:e(I).entity.seq})),r(E,B)};y(ue,E=>{e(I)&&e(I).index!=="Top"&&E(xe)})}var de=s(ue,2);{var me=E=>{var B=Er();r(E,B)};y(de,E=>{e(d).owner.seat==="Below"&&E(me)})}r(T,w)},h=T=>{var w=Pr();const I=fe(()=>e(_e).find(B=>B.to===e(d)));var p=U(w);{var m=B=>{var ce=Ar(),Ce=a(ce);St(Ce,{get entity(){return e(I).entity},state:"Disabled",dummyActionInfos:[],cardActionResolve:void 0}),ee(1,ce,()=>Z,()=>({key:e(I).entity.seq})),r(B,ce)};y(p,B=>{e(I)&&e(I).index!=="Top"&&B(m)})}var ve=s(p,2);{var ue=B=>{var ce=Fr(),Ce=U(ce);ie(Ce,1,()=>e(d).visibleEntities.map((Be,Ne)=>({index:Ne,entity:Be})).toReversed(),le,(Be,Ne)=>{var ze=Me(),j=U(ze);{var C=g=>{var N=Br();const be=fe(()=>!e(d).isStackCell&&e(Ne).index===0?he(...e(d).visibleEntities):void 0);var je=U(N);{var O=Ie=>{var We=Yr();r(Ie,We)};y(je,Ie=>{e(W).includes(e(Ne).entity)&&Ie(O)})}var De=s(je,2),Ye=a(De);const Re=fe(()=>e(Ne).index===0?e(L).filter(Ie=>e(d).visibleEntities.includes(Ie.action.entity)):void 0);St(Ye,{get entity(){return e(Ne).entity},get state(){return e(be)},get dummyActionInfos(){return e(Re)},cardActionResolve:void 0,get selectedList(){return c()},set selectedList(Ie){c(Ie)},$$legacy:!0}),u(()=>Ae(De,`duel_card_wrapper ${(e(Ne).entity.exist?"duel_card_wrapper_exists":"")??""} svelte-1ycsdg6`)),ee(2,De,()=>we,()=>({key:e(Ne).entity.seq})),r(g,N)};y(j,g=>{e(_e).every(N=>N.entity.seq!==e(Ne).entity.seq)&&g(C)})}r(Be,ze)});var Ke=s(Ce,2);{var Oe=Be=>{var Ne=Ir(),ze=a(Ne),j=s(ze);ie(j,1,()=>oa(e(d).visibleEntities[0].status.maxCounterQty),le,(C,g)=>{var N=Nr(),be=U(N),je=s(be);{var O=De=>{var Ye=rt();u(()=>f(Ye,`/${e(d).visibleEntities[0].status.maxCounterQty[e(g)]??""}`)),r(De,Ye)};y(je,De=>{(e(d).visibleEntities[0].status.maxCounterQty[e(g)]??9999)<100&&De(O)})}u((De,Ye)=>f(be,`【
              ${De??""}${Ye??""} `),[()=>Ka(e(g)),()=>e(d).visibleEntities[0].counterHolder.getQty(e(g))],fe),r(C,N)}),u(()=>f(ze,`【${e(d).visibleEntities[0].battlePositionName??""}】 `)),r(Be,Ne)};y(Ke,Be=>{e(d).visibleEntities[0].battlePosition&&Be(Oe)})}r(B,ce)};y(ve,B=>{e(d).visibleEntities.length>0&&B(ue)})}var xe=s(ve,2);{var de=B=>{var ce=Hr(),Ce=a(ce);u(()=>f(Ce,e(d).visibleEntities.length)),r(B,ce)};y(xe,B=>{e(d).isStackCell&&B(de)})}var me=s(xe,2);{var E=B=>{var ce=Ur(),Ce=a(ce);St(Ce,{get entity(){return e(I).entity},state:"Disabled",dummyActionInfos:[],cardActionResolve:void 0}),ee(1,ce,()=>Z,()=>({key:e(I).entity.seq})),r(B,ce)};y(me,B=>{e(I)&&e(I).index==="Top"&&B(E)})}r(T,w)};y(re,T=>{e(d).cellType==="Hand"?T(Se):T(h,!1)},!0)}r($,Q)};y(G,$=>{e(d).isDisabledCell?$(J):$(Ee,!1)})}u($=>{Ae(H,`${`duel_field_cell duel_field_cell_${e(d).cellType} ${e(d).linkArrowSources.length===0?"":"duel_field_cell_linked"}`??""} svelte-1ycsdg6`),gt(H,"colspan",e(d).cellType==="Hand"?7:1),Ae(M,`${$??""} svelte-1ycsdg6`)},[()=>`duel_field_cell_inner_box ${e(d).cellType} ${e(S)?"can_accept_drop":""} ${X()?"can_action":""} ${e(A)?"is_selected":e(Y)?"is_selectable":""} `],fe),ye("dragover",M,se),ye("drop",M,oe),r(o,H),nt()}Na(["click"]);var Rr=n('<div class="title svelte-14z6bdh"> </div>'),Wr=n('<div class="title svelte-14z6bdh"> </div>'),Kr=n('<div class="duel_log_chain_number svelte-14z6bdh"> </div>'),zr=n("<div><!></div>"),Gr=n('<div><div style="display: flex;    justify-content: space-between;"><div style=" white-space: nowrap;text-align: center;"> </div> <!></div> <!></div>'),Xr=n("<div><!> <!></div>"),Vr=n("<div><!> <!></div>"),Qr=n('<div class="duel_log svelte-14z6bdh"><div class="duel_log_header svelte-14z6bdh"></div> <div class="duel_log_body svelte-14z6bdh"></div> <div class="duel_log_footer svelte-14z6bdh"></div></div>');function Zr(o,i){st(i,!1);let t=ke(void 0),v=Le(i,"log",8),_,c=ke([]);const b=()=>{const x=((_==null?void 0:_.seq)??-1)+1;v().records.slice(x).forEach(l=>{if(!_){D(c,[[[[l]]]]),_=l;return}if(!e(c)[l.clock.turn]){Pe(c,e(c)[l.clock.turn]=[[[l]]]),_=l;return}if(!e(c)[l.clock.turn][l.clock.phaseSeq]){Pe(c,e(c)[l.clock.turn][l.clock.phaseSeq]=[[l]]),_=l;return}if(_.clock.chainSeq===l.clock.chainSeq&&_.clock.chainBlockSeq===l.clock.chainBlockSeq&&_.duelist===l.duelist){e(c)[l.clock.turn][l.clock.phaseSeq].slice(-1)[0].push(l),_=l;return}e(c)[l.clock.turn][l.clock.phaseSeq].push([l]),_=l}),D(c,e(c)),za().then(()=>e(t)&&e(t).scroll(0,e(t).clientHeight*990))};v().onUpdate.append(b),v().duel.view.onDuelUpdate.append(b),b(),it();var d=Me(),q=U(d);{var P=x=>{var l=Qr(),L=s(a(l),2);ie(L,5,()=>e(c),le,(F,R)=>{var W=Vr(),A=a(W);{var Y=ne=>{var Te=Rr(),S=a(Te);u(()=>f(S,`ターン：${e(R)[0][0][0].clock.turn??""}`)),r(ne,Te)};y(A,ne=>{e(R)[0][0][0].clock.turn>0&&ne(Y)})}var te=s(A,2);ie(te,1,()=>e(R),le,(ne,Te)=>{var S=Xr(),k=a(S);{var K=we=>{var Z=Wr(),_e=a(Z);u(()=>f(_e,e(Te)[0][0].clock.period.name)),r(we,Z)};y(k,we=>{e(Te)[0][0].clock.turn>0&&we(K)})}var ae=s(k,2);ie(ae,1,()=>e(Te),le,(we,Z)=>{var _e=Gr();const V=fe(()=>{var H;return((H=e(Z).find(M=>M.chainNumber!==void 0))==null?void 0:H.chainNumber)??0});var ge=a(_e),X=a(ge),z=a(X),se=s(X,2);{var oe=H=>{var M=Kr(),G=a(M);u(()=>f(G,`チェーン：${e(V)??""}`)),r(H,M)};y(se,H=>{e(V)&&H(oe)})}var he=s(ge,2);ie(he,1,()=>e(Z),le,(H,M)=>{var G=zr(),J=a(G);{var Ee=Q=>{var re=rt();u(()=>f(re,e(M).text)),r(Q,re)},$=Q=>{var re=Me(),Se=U(re);{var h=w=>{var I=rt();u((p,m,ve)=>f(I,`移動：${p??""} ${m??""} ⇒ ${ve??""}`),[()=>{var p;return(p=e(M).mainEntity)==null?void 0:p.toString()},()=>{var p;return(p=e(M).from)==null?void 0:p.toString()},()=>{var p;return(p=e(M).to)==null?void 0:p.toString()}],fe),r(w,I)},T=w=>{var I=Me(),p=U(I);{var m=ue=>{var xe=rt();u((de,me)=>f(xe,`生成：${de??""} void ⇒ ${me??""}`),[()=>{var de;return(de=e(M).mainEntity)==null?void 0:de.toString()},()=>{var de;return(de=e(M).to)==null?void 0:de.toString()}],fe),r(ue,xe)},ve=ue=>{var xe=Me(),de=U(xe);{var me=B=>{var ce=rt();u((Ce,Ke)=>f(ce,`消滅：${Ce??""} ${Ke??""} ⇒ void`),[()=>{var Ce;return(Ce=e(M).mainEntity)==null?void 0:Ce.toString()},()=>{var Ce;return(Ce=e(M).from)==null?void 0:Ce.toString()}],fe),r(B,ce)},E=B=>{var ce=rt();u(()=>f(ce,e(M).text)),r(B,ce)};y(de,B=>{e(M).type==="EntityDisappear"?B(me):B(E,!1)},!0)}r(ue,xe)};y(p,ue=>{e(M).type==="EntityAppear"?ue(m):ue(ve,!1)},!0)}r(w,I)};y(Se,w=>{e(M).type==="EntityMove"?w(h):w(T,!1)},!0)}r(Q,re)};y(J,Q=>{e(M).type==="ChainBlockHeader"?Q(Ee):Q($,!1)})}u(Q=>Ae(G,`duel_log_record duel_log_record_${Q??""} svelte-14z6bdh`),[()=>e(M).type.toSnakeCase()],fe),r(H,G)}),u(()=>{var H,M,G;Ae(_e,`duel_log_block_duelist duel_log_block_duelist_${((H=e(Z)[0].duelist)==null?void 0:H.seat)??"system"} svelte-14z6bdh`),Ae(X,`duelist ${((M=e(Z)[0].duelist)==null?void 0:M.seat)??""} svelte-14z6bdh`),f(z,((G=e(Z)[0].duelist)==null?void 0:G.profile.name)||"SYSTEM")}),r(we,_e)}),u(()=>Ae(S,`duel_log_block_phase duel_log_block_phase_${e(Te)[0][0].clock.period.key??""} svelte-14z6bdh`)),r(ne,S)}),u(()=>Ae(W,`duel_log_block_turn duel_log_block_turn_${e(R)[0][0][0].clock.turn??""} svelte-14z6bdh`)),r(F,W)}),Ga(L,F=>D(t,F),()=>e(t)),r(x,l)};y(q,x=>{(v().duel.view.infoBoardState==="Log"||v().duel.view.infoBoardState==="Default")&&x(P)})}r(o,d),nt()}var Jr=n("<div><div> </div> <div> </div></div>");function Ya(o,i){st(i,!1);let t=Le(i,"duelist",12),v=ke(0),_=ke();const c=async()=>{const L=t().lp-e(v);if(!e(_)||Math.abs(L)<10){D(v,t().lp),e(_)&&(e(_)(),D(_,void 0));return}D(v,e(v)+Math.floor(Math.random()*L)),await Mt(100),c()},b=()=>{t(t()),!e(_)&&t().lp!==e(v)&&new Promise(L=>{D(_,L),Math.abs(t().lp-e(v)),c()})};t().duel.log.onUpdate.append(b),c(),it();var d=Jr(),q=a(d),P=a(q),x=s(q,2),l=a(x);u(L=>{Ae(d,`duelist duelist_${L??""} svelte-1sy3trd`),Ae(q,`duelist_name duelist_${L??""}_name svelte-1sy3trd`),f(P,t().profile.name),Ae(x,`duelist_lp ${(e(_)?"vibration":"")??""} svelte-1sy3trd`),f(l,e(v))},[()=>t().seat.toLowerCase()],fe),r(o,d),nt()}const es=(o,i,t)=>(i(i()!=="Detail"?"Detail":"Normal"),console.info(t()),!0),ts=(o,i,t)=>(i(i()!=="Debug"?"Debug":"Normal"),console.info(t()),!0);var as=n('<div class="duel_card_info_row svelte-1uevs9j" style=" justify-content: space-between;"><div class="svelte-1uevs9j"> </div> <div class="svelte-1uevs9j"> </div></div>'),rs=n('<div></div> <div class="svelte-1uevs9j"> </div>',1),ss=n("<div> </div>"),is=n("<div> </div>"),ns=n('<div class="duel_card_info_row svelte-1uevs9j"><!> <!></div> <div class="duel_card_info_row svelte-1uevs9j"></div>',1),ls=n('<div class="duel_card_row svelte-1uevs9j"><div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"> </div></div>'),os=n('<div class="duel_card_row svelte-1uevs9j"><div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"> </div></div>'),vs=n("<!> <!>",1),ds=n('<div class="duel_card_info_row svelte-1uevs9j" style="border-style: solid; border-width: 1px;"><pre class="description svelte-1uevs9j"> </pre></div>'),cs=n('<!> <div class="duel_card_info_row svelte-1uevs9j"><pre class="description svelte-1uevs9j"> </pre></div>',1),_s=n('<div class="effect_counter_area_item svelte-1uevs9j"><span class="svelte-1uevs9j"> </span> <span class="svelte-1uevs9j"> </span> <span class="svelte-1uevs9j">/</span> <span class="svelte-1uevs9j"> </span></div>'),us=n('<div class="duel_card_info_row effect_counter_area svelte-1uevs9j"><div class="effect_counter_area_title svelte-1uevs9j">効果使用状況</div> <div class="effect_counter_area_body svelte-1uevs9j"></div></div>'),fs=n("[ <!> ],",1),ps=n('<div class="svelte-1uevs9j"> <!></div>'),gs=n('<div class="svelte-1uevs9j"> </div> <!> <div class="svelte-1uevs9j"></div>',1),ms=n('<div class="svelte-1uevs9j"> </div>'),bs=n('<div class="svelte-1uevs9j"> </div>'),hs=n('<div class="svelte-1uevs9j"> </div>'),ys=n('<div class="svelte-1uevs9j"> </div>'),ks=n('<div class="svelte-1uevs9j"> </div>'),ws=n('<div class="svelte-1uevs9j"> </div>'),xs=n('<div class="duel_card_info_row svelte-1uevs9j"><div class="svelte-1uevs9j"><!> <div class="svelte-1uevs9j"></div> <!> <div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"></div> <!> <div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"></div> <!> <div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"></div> <!> <div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"></div> <!> <div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"></div> <!> <div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"> </div> <div class="svelte-1uevs9j"> </div> <div class="svelte-1uevs9j"> </div> <div class="svelte-1uevs9j"></div></div></div>'),Cs=n('<div class="svelte-1uevs9j">※テスト用カードです</div>'),Ds=n('<div class="duel_card_info_links svelte-1uevs9j"><a target="_blank" rel="noopener noreferrer" title="遊戯王カードWiki" class="svelte-1uevs9j">⇒遊戯王カードWiki</a> <a target="_blank" rel="noopener noreferrer" title="コナミカードデータベース" class="svelte-1uevs9j"> </a></div>'),$s=n('<div role="contentinfo"><div class="duel_card_info_header svelte-1uevs9j"><div class="duel_card_info_row svelte-1uevs9j"><div class="svelte-1uevs9j"> </div></div> <div class="duel_card_info_row svelte-1uevs9j" style="position:sticky; top:0;"><div class="svelte-1uevs9j"> </div> <div class="svelte-1uevs9j"> </div></div> <!></div> <div class="duel_card_info_body svelte-1uevs9j"><!></div> <div class="duel_card_info_footer svelte-1uevs9j"><!></div></div>');function Ss(o,i){st(i,!1);let t=Le(i,"entity",8,void 0),v=Le(i,"mode",12,"Normal");const _=()=>t()?bt[t().origin.name]:void 0,c=()=>{var P;return t()&&(t().origin.cardId??!1)?`https://www.db.yugioh-card.com/yugiohdb/card_search.action?ope=2&cid=${t().origin.cardId}`:`https://www.db.yugioh-card.com/yugiohdb/card_search.action?ope=1&sess=1&rp=10&mode=&sort=1&keyword=${(P=_())==null?void 0:P.name}&stype=1&ctype=&othercon=2&starfr=&starto=&pscalefr=&pscaleto=&linkmarkerfr=&linkmarkerto=&link_m=2&atkfr=&atkto=&deffr=&defto=&releaseDStart=1&releaseMStart=1&releaseYStart=1999&releaseDEnd=&releaseMEnd=&releaseYEnd=`};it();var b=Me(),d=U(b);{var q=P=>{var x=$s();x.__click=[es,v,t],x.__contextmenu=[ts,v,t];var l=a(x),L=a(l),F=a(L),R=a(F),W=s(L,2),A=a(W),Y=a(A),te=s(A,2),ne=a(te),Te=s(W,2);{var S=X=>{var z=vs(),se=U(z);{var oe=G=>{var J=as(),Ee=a(J),$=a(Ee),Q=s(Ee,2),re=a(Q);u(()=>{f($,`◀ ${t().psL??""}`),f(re,`${t().psR??""} ▶`)}),r(G,J)};y(se,G=>{var J;(J=t().origin.monsterCategories)!=null&&J.includes("Pendulum")&&G(oe)})}var he=s(se,2);{var H=G=>{var J=ns(),Ee=U(J),$=a(Ee);ie($,1,()=>t().attr,le,(Se,h)=>{var T=rs(),w=U(T),I=s(w,2),p=a(I);u(()=>{Ae(w,`monster_attr ${e(h)??""} svelte-1uevs9j`),f(p,`${va[e(h)]??""}属性`)}),r(Se,T)});var Q=s($,2);ie(Q,1,()=>t().types,le,(Se,h)=>{var T=ss(),w=a(T);u(()=>{Ae(T,`monster_cat ${e(h)??""} svelte-1uevs9j`),f(w,`${Vt[e(h)]??""}${da[e(h)]??""}族`)}),r(Se,T)});var re=s(Ee,2);ie(re,5,()=>t().status.monsterCategories??[],le,(Se,h)=>{var T=is(),w=a(T);u(()=>{Ae(T,`monster_cat ${e(h)??""} svelte-1uevs9j`),f(w,`${Qt[e(h)]??""}${ca[e(h)]??""}`)}),r(Se,T)}),r(G,J)},M=G=>{var J=Me(),Ee=U(J);{var $=re=>{var Se=ls(),h=s(a(Se),2),T=a(h);u(()=>f(T,`${Zt[t().status.spellCategory]??""}魔法`)),r(re,Se)},Q=re=>{var Se=Me(),h=U(Se);{var T=w=>{var I=os(),p=s(a(I),2),m=a(p);u(()=>f(m,`${Jt[t().status.trapCategory]??""}罠`)),r(w,I)};y(h,w=>{t().kind==="Trap"&&t().status.trapCategory&&w(T)},!0)}r(re,Se)};y(Ee,re=>{t().kind==="Spell"&&t().status.spellCategory?re($):re(Q,!1)},!0)}r(G,J)};y(he,G=>{t().kind==="Monster"?G(H):G(M,!1)})}r(X,z)};y(Te,X=>{v()!=="Debug"&&X(S)})}var k=s(l,2),K=a(k);{var ae=X=>{var z=cs(),se=U(z);{var oe=G=>{var J=ds(),Ee=a(J),$=a(Ee);u(()=>f($,bt[t().origin.name].pendulumDescription)),r(G,J)};y(se,G=>{var J;(J=t().status.monsterCategories)!=null&&J.includes("Pendulum")&&G(oe)})}var he=s(se,2),H=a(he),M=a(H);u(G=>f(M,G),[()=>{var G;return(G=_())==null?void 0:G.description}],fe),r(X,z)},we=X=>{var z=Me(),se=U(z);{var oe=H=>{var M=Me(),G=U(M);{var J=Ee=>{var $=us(),Q=s(a($),2);ie(Q,5,()=>t().actions,le,(re,Se)=>{var h=Me();const T=fe(()=>e(Se).actionCountUpperBound),w=fe(()=>e(Se).actionCount);var I=U(h);{var p=m=>{var ve=_s(),ue=a(ve),xe=a(ue),de=s(ue,2),me=a(de),E=s(de,4),B=a(E);u(()=>{f(xe,e(Se).title),f(me,e(w)),f(B,e(T))}),r(m,ve)};y(I,m=>{e(T)!==void 0&&e(w)!==void 0&&m(p)})}r(re,h)}),r(Ee,$)};y(G,Ee=>{t().actions.some($=>$.actionCountUpperBoundKey)&&Ee(J)})}r(H,M)},he=H=>{var M=xs(),G=a(M),J=a(G);ie(J,0,()=>["info","status"],le,(C,g)=>{var N=gs(),be=U(N),je=a(be),O=s(be,2);ie(O,1,()=>Object.entries(t()[g]),le,(Ye,Re)=>{let Ie=()=>e(Re)[0],We=()=>e(Re)[1];var vt=ps(),dt=a(vt),tt=s(dt);{var $e=qe=>{var Ve=fs(),Je=s(U(Ve));ie(Je,1,We,le,(lt,yt)=>{var Ge=rt();u(Fe=>f(Ge,`${Fe??""},`),[()=>e(yt).toString()],fe),r(lt,Ge)}),r(qe,Ve)},He=qe=>{var Ve=rt();u(Je=>f(Ve,`${Je??""},`),[()=>{var Je;return(Je=We())==null?void 0:Je.toString()}],fe),r(qe,Ve)};y(tt,qe=>{Array.isArray(We())?qe($e):qe(He,!1)})}u(()=>f(dt,`"${Ie()??""}" : `)),r(Ye,vt)});var De=s(O,2);De.textContent="},",u(()=>f(je,`"${g??""}" :{`)),r(C,N)});var Ee=s(J,2);Ee.textContent='"actions" :[';var $=s(Ee,2);ie($,1,()=>t().actions,le,(C,g)=>{var N=ms(),be=a(N);u(()=>f(be,`"${e(g).playType??""} ${e(g).title??""}",`)),r(C,N)});var Q=s($,2);Q.textContent="],";var re=s(Q,2);re.textContent='"substituteEffects" :[';var Se=s(re,2);ie(Se,1,()=>t().substituteEffects,le,(C,g)=>{var N=bs(),be=a(N);u(()=>f(be,`"${e(g).title??""}",`)),r(C,N)});var h=s(Se,2);h.textContent="],";var T=s(h,2);T.textContent='"continuousEffects" :[';var w=s(T,2);ie(w,1,()=>t().continuousEffects,le,(C,g)=>{var N=hs(),be=a(N);u(()=>f(be,`"${e(g).isStarted??""}",`)),r(C,N)});var I=s(w,2);I.textContent="],";var p=s(I,2);p.textContent='"procFilters" :[';var m=s(p,2);ie(m,1,()=>t().procFilterBundle.operators,le,(C,g)=>{var N=ys(),be=a(N);u(je=>f(be,`"${je??""} ${e(g).title??""} ${e(g).isEffective??""} ",`),[()=>e(g).isSpawnedBy.toString()],fe),r(C,N)});var ve=s(m,2);ve.textContent="],";var ue=s(ve,2);ue.textContent='"numericStateOperators" :[';var xe=s(ue,2);ie(xe,1,()=>t().numericOprsBundle.operators,le,(C,g)=>{var N=ks(),be=a(N);u(je=>f(be,`"${je??""} ${e(g).title??""} ${e(g).isEffective??""} ${e(g).isContinuous??""} ${e(g).targetState??""} ${e(g).targetStateGen??""} ",`),[()=>e(g).isSpawnedBy.toString()],fe),r(C,N)});var de=s(xe,2);de.textContent="],";var me=s(de,2);me.textContent='"stateOperators" :[';var E=s(me,2);ie(E,1,()=>t().statusOperatorBundle.operators,le,(C,g)=>{var N=ws(),be=a(N);u(je=>f(be,`"${je??""} ${e(g).title??""} ${e(g).isEffective??""} ",`),[()=>e(g).isSpawnedBy.toString()],fe),r(C,N)});var B=s(E,2);B.textContent="],";var ce=s(B,2);ce.textContent='"lastMoveLogRecord" :{';var Ce=s(ce,2),Ke=a(Ce),Oe=s(Ce,2),Be=a(Oe),Ne=s(Oe,2),ze=a(Ne),j=s(Ne,2);j.textContent="},",u((C,g)=>{f(Ke,`"movedBy":"${C??""}",`),f(Be,`"movedAs":"${g??""}",`),f(ze,`"movedAt":"${t().moveLog.latestRecord.movedAt.totalProcSeq??""}",`)},[()=>{var C;return(C=t().moveLog.latestRecord.movedBy)==null?void 0:C.toString()},()=>t().moveLog.latestRecord.movedAs.join(" ")],fe),r(H,M)};y(se,H=>{v()==="Detail"?H(oe):H(he,!1)},!0)}r(X,z)};y(K,X=>{v()==="Normal"?X(ae):X(we,!1)})}var Z=s(k,2),_e=a(Z);{var V=X=>{var z=Cs();r(X,z)},ge=X=>{var z=Ds(),se=a(z),oe=s(se,2),he=a(oe);u(H=>{var M;gt(se,"href",`https://yugioh-wiki.net/index.php?${t().origin.wikiEncodedName}`),gt(oe,"href",H),f(he,`⇒${((M=t())!=null&&M.origin.cardId?"公式カードページ":"公式で検索")??""}`)},[c],fe),r(X,z)};y(_e,X=>{var z;(z=t())!=null&&z.origin.isForTest?X(V):X(ge,!1)})}u((X,z,se)=>{Ae(x,`duel_card duel_card_info ${t().origin.kind??""} ${X??""} svelte-1uevs9j`),f(R,t().nm),f(Y,z),f(ne,se)},[()=>{var X;return(X=t().origin.monsterCategories)==null?void 0:X.join(" ")},()=>"★".repeat(t().lvl||0),()=>"☆".repeat(t().rank||0)],fe),r(P,x)};y(d,P=>{t()&&P(q)})}r(o,b),nt()}Na(["click","contextmenu"]);var Ms=n('<div class="duel_field_cell_info_item svelte-1xj7qf1"><!></div>'),Ts=n('<div class="duel_field_cell_info_box svelte-1xj7qf1"><div class="duel_field_cell_info_label svelte-1xj7qf1"> </div> <!></div>'),js=n('<div class="duel_field_cell_info svelte-1xj7qf1"><div class="duel_field_cell_info_header item_btn svelte-1xj7qf1"><div class="svelte-1xj7qf1"> </div> <div class="svelte-1xj7qf1"> </div></div> <div class="duel_field_cell_info_body svelte-1xj7qf1"></div></div>');function Es(o,i){st(i,!1);let t=Le(i,"cell",12);const v=()=>{t(t())},_=q=>t().cardEntities.filter(P=>P.face===q);t().field.duel.view.onDuelUpdate.append(v),it();var c=Me(),b=U(c);{var d=q=>{var P=js(),x=a(P),l=a(x),L=a(l),F=s(l,2),R=a(F),W=s(x,2);ie(W,4,()=>["FaceUp","FaceDown"],le,(A,Y)=>{var te=Me(),ne=U(te);{var Te=S=>{var k=Ts(),K=a(k),ae=a(K),we=s(K,2);ie(we,1,()=>_(Y).toSorted(Xa),le,(Z,_e)=>{var V=Ms(),ge=a(V);const X=fe(()=>t().owner===t().field.duel.duelists.Below);St(ge,{get entity(){return e(_e)},get isVisibleForcibly(){return e(X)},isWideMode:!0,cardActionResolve:void 0}),r(Z,V)}),u(()=>f(ae,Y==="FaceUp"?"表向き":"裏向き")),r(S,k)};y(ne,S=>{_(Y).length&&S(Te)})}r(A,te)}),u(()=>{var A;f(L,(A=t().owner)==null?void 0:A.profile.name),f(R,t().cellType)}),r(q,P)};y(b,q=>{t().field.duel.view.infoBoardState==="CellInfo"&&q(d)})}r(o,c),nt()}var qs=n('<div class="duel_config_item svelte-y4u26k"><label class="toggle svelte-y4u26k"><input type="checkbox" class="svelte-y4u26k"></label> <span class="svelte-y4u26k"> </span></div>'),As=n('<div class="duel_config svelte-y4u26k"><div class="duel_config_title svelte-y4u26k">デュエル設定</div> <div class="duel_config_group svelte-y4u26k"><div class="duel_config_group_title svelte-y4u26k">チェーン設定</div> <!></div></div>');function Ys(o,i){st(i,!1);let t=Le(i,"viewController",8),v=Le(i,"userProfile",12);it();var _=Me(),c=U(_);{var b=d=>{var q=As(),P=s(a(q),2),x=s(a(P),2);ie(x,1,()=>Za,le,(l,L)=>{var F=qs(),R=a(F),W=a(R),A=s(R,2),Y=a(A);u(()=>f(Y,Va[e(L)])),Qa(W,()=>v().chainConfig[e(L)],te=>v(v().chainConfig[e(L)]=te,!0)),ye("change",W,()=>v().save()),r(l,F)}),r(d,q)};y(c,d=>{t().infoBoardState==="Config"&&d(b)})}r(o,_),nt()}function Bs(o,{from:i,to:t},v={}){var{delay:_=0,duration:c=k=>Math.sqrt(k)*120,easing:b=ia}=v,d=getComputedStyle(o),q=d.transform==="none"?"":d.transform,[P,x]=d.transformOrigin.split(" ").map(parseFloat);P/=o.clientWidth,x/=o.clientHeight;var l=Ns(o),L=o.clientWidth/t.width/l,F=o.clientHeight/t.height/l,R=i.left+i.width*P,W=i.top+i.height*x,A=t.left+t.width*P,Y=t.top+t.height*x,te=(R-A)*L,ne=(W-Y)*F,Te=i.width/t.width,S=i.height/t.height;return{delay:_,duration:typeof c=="function"?c(Math.sqrt(te*te+ne*ne)):c,easing:b,css:(k,K)=>{var ae=K*te,we=K*ne,Z=k+K*Te,_e=k+K*S;return`transform: ${q} translate(${ae}px, ${we}px) scale(${Z}, ${_e});`}}}function Ns(o){if("currentCSSZoom"in o)return o.currentCSSZoom;for(var i=o,t=1;i!==null;)t*=+getComputedStyle(i).zoom,i=i.parentElement;return t}var Is=n('<div class="chain_number svelte-d2f52m"> </div>'),Fs=n('<div class="duel_card_row svelte-d2f52m"> </div>'),Hs=n('<div class="appendix svelte-d2f52m"> </div>'),Us=n('<div class="appendix_wrapper svelte-d2f52m"></div>'),Ps=n('<div><div><!> <div> </div> <div><!> <div class="duel_card_row svelte-d2f52m"><div> </div> <!></div></div></div></div>'),Os=n("<div></div>");function Ls(o,i){st(i,!1);let t=Le(i,"duel",8),v=Le(i,"position",8,"left");const _=-100,c=()=>v()==="left"?-100:100;let b=ke([]),d=Promise.resolve(),q=Promise.resolve();const P=1e3,x=500,l=400,L=R=>{const W={...R};W.isKnown=R.chainBlockInfo.action.entity.controller.duelistType==="Player"||R.chainBlockInfo.action.entity.face==="FaceUp",W.chainBlockInfo.onStateChange.append(A=>{if(A==="done"||A==="failed"||A==="nagated")return d=d.then(async()=>{const Y=new Date().getTime()-W.chainBlockInfo.wasSpawnedAt.getTime();Y<P&&await Mt(P-Y),D(b,e(b).filter(te=>te.seq!==W.seq)),await Mt(x+l)}).then(),"RemoveMe";D(b,e(b))}),q=q.then(async()=>{D(b,[W,...e(b)].sort((A,Y)=>Ja.isSameChain(A.clock,Y.clock)&&A.chainBlockInfo.action.isWithChainBlock&&Y.chainBlockInfo.action.isWithChainBlock?Y.clock.totalProcSeq-A.clock.totalProcSeq:A.clock.totalProcSeq-Y.clock.totalProcSeq)),await Mt(300)}),d=d.then(()=>Mt(1e3))};t().chainBlockLog.onInsert.append(L),it();var F=Os();ie(F,13,()=>e(b),R=>R.seq,(R,W)=>{var A=Ps();const Y=fe(()=>{const{activator:z,action:se,appendix:oe}=e(W).chainBlockInfo;return{activator:z,action:se,appendix:oe}});var te=a(A),ne=a(te);{var Te=z=>{var se=Is(),oe=a(se);u(()=>f(oe,`チェーン：${e(W).chainBlockInfo.chainNumber??""}`)),r(z,se)};y(ne,z=>{e(W).chainBlockInfo.chainNumber&&z(Te)})}var S=s(ne,2),k=a(S),K=s(S,2),ae=a(K);{var we=z=>{var se=Fs(),oe=a(se);u(()=>f(oe,e(W).isKnown?e(Y).action.entity.nm:"？？？")),r(z,se)};y(ae,z=>{(e(Y).action.entity.entityType==="Card"||e(Y).action.entity.entityType==="Token")&&z(we)})}var Z=s(ae,2),_e=a(Z),V=a(_e),ge=s(_e,2);{var X=z=>{var se=Us();ie(se,5,()=>e(Y).appendix,le,(oe,he)=>{var H=Hs(),M=a(H);u(()=>f(M,e(he))),r(oe,H)}),r(z,se)};y(ge,z=>{e(Y).appendix&&z(X)})}u((z,se,oe)=>{Ae(A,`cut_in_row ${(!e(W).chainBlockInfo.chainNumber||e(W).chainBlockInfo.chainNumber===1?"cut_in_row_first":"")??""} svelte-d2f52m`),Ae(te,`cut_in_item cut_in_item_${z??""} cut_in_item_${e(W).chainBlockInfo.state??""} svelte-d2f52m`),Ae(S,`duelist_name duelist_${z??""}_name svelte-d2f52m`),f(k,e(Y).activator.profile.name),Ae(K,`duel_card duel_card_${z??""} ${se??""} ${(e(W).isKnown?e(Y).action.entity.origin.kind:"")??""} ${e(Y).action.entity.entityType??""}  svelte-d2f52m`),f(V,oe)},[()=>e(Y).activator.seat.toLowerCase(),()=>e(W).isKnown?(e(Y).action.entity.status.monsterCategories??[]).join(" "):"Token",()=>e(Y).action.toString()],fe),ee(3,te,()=>kr,()=>new Date().getTime()-e(W).chainBlockInfo.wasSpawnedAt.getTime()<P?{x:c(),duration:l}:{y:_,duration:l}),er(A,()=>Bs,()=>({duration:x})),r(R,A)}),u(()=>Ae(F,`cut_in_container cut_in_container_${v()??""} svelte-d2f52m`)),r(o,F),nt()}const Rs=wr({duration:400});var Ws=n('<div class="duel_desk_left v_flex svelte-1i63tk9"><!> <!> <!></div>'),Ks=n('<button class="duel_field_header_message svelte-1i63tk9"> </button> <div class="duel_field_header_buttons svelte-1i63tk9"><button class="svelte-1i63tk9">サレンダー</button></div>',1),zs=n("<tr></tr>"),Gs=n('<table class="duel_field svelte-1i63tk9"><tbody class="svelte-1i63tk9"></tbody></table>'),Xs=n('<button class="svelte-1i63tk9">OK</button>'),Vs=n('<button class="svelte-1i63tk9">cancel</button>'),Qs=n("<!> <!>",1),Zs=n('<button class="svelte-1i63tk9"> </button>'),Js=n('<div style="text-align: left;"><!> <!> <!></div>'),ei=n('<div><!> <div class=" duel_desk_center v_flex svelte-1i63tk9"><div class="duel_field_header svelte-1i63tk9"><!></div> <div class="duel_field_body svelte-1i63tk9"><!></div> <div class="duel_field_footer svelte-1i63tk9"><!></div></div> <!></div> <div style="position:fixed;left:0;bottom:0"> </div> <!> <div><!></div>',1);function ti(o,i){st(i,!1);let t=Le(i,"duel",12),v=Le(i,"userProfile",8),_=ke(0),c=ke(0),b=ke([]),d=ke([]),q=()=>{},P=ke([]),x=ke(),l=ke(),L=ke(()=>!1),F=ke(!1);const R=p=>{q=p.resolve,D(P,p.dummyActionInfos.filter(m=>m.action.entity.entityType==="Duelist").filter(m=>m.action.entity.controller.seat==="Below")),D(x,void 0),D(l,void 0),D(d,[]),D(b,[]),D(F,!1),p.entitiesChoices&&(D(x,p.entitiesChoices),D(L,()=>{var m;return((m=p.entitiesChoices)==null?void 0:m.validator(e(b)))??!1}),D(F,p.entitiesChoices.cancelable),e(x).selectables.every(m=>m.cell.isPlayFieldCell&&m.getIndexInCell()===0||m.cell.cellType==="Hand"&&m.controller.duelistType==="Player"||m.entityType==="Duelist")||t().view.modalController.entitySelector.show({title:t().view.message,position:"Middle",entitiesChoices:p.entitiesChoices,chainBlockInfos:p.chainBlockInfos,cancelable:p.entitiesChoices.cancelable}).then(m=>{q({selectedEntities:m})})),p.cellsChoices&&(D(l,p.cellsChoices),D(L,()=>{var m;return((m=p.cellsChoices)==null?void 0:m.validator(e(d)))??!1}),D(F,p.cellsChoices.cancelable))};t().view.onWaitStart.append(R);const W=()=>{q=()=>{},D(l,void 0),D(x,void 0),D(d,[]),D(b,[]),D(L,()=>!1),D(F,!1)};t().view.onWaitEnd.append(W);let A=ke(void 0),Y=ke("Normal");const te=({card:p,mode:m})=>{D(A,p),D(Y,m??(e(A)===p||e(Y)==="Normal"?"Detail":"Normal"))};t().view.onShowCardEntity.append(te);const ne=()=>{t(t())};t().view.onDuelUpdate.append(ne),t().log.onUpdate.append(ne);const Te=()=>{e(x)&&e(x).validator(e(b))&&q({selectedEntities:e(b)}),e(l)&&e(l).validator(e(d))&&q({selectedCells:e(d)})},S=()=>{q({})},k=p=>{q({actionInfo:p})},K=()=>{q({surrender:!0})};t().main();const ae=()=>e(_)<=1400?"compact":"wide";it();var we=ei(),Z=U(we),_e=a(Z);{var V=p=>{var m=Ws(),ve=a(m);Ya(ve,{get duelist(){return t().duelists.Above}});var ue=s(ve,2);Ss(ue,{get entity(){return e(A)},get mode(){return e(Y)}});var xe=s(ue,2);Ya(xe,{get duelist(){return t().duelists.Below}}),r(p,m)};y(_e,p=>{ae()==="wide"&&p(V)})}var ge=s(_e,2),X=a(ge),z=a(X);{var se=p=>{var m=Ks(),ve=U(m),ue=a(ve),xe=s(ve,2),de=a(xe);u(()=>f(ue,`[TURN:${t().clock.turn}][PHASE:${t().phase}] ${t().view.message}`)),ye("click",ve,()=>{t(t().view.infoBoardState="Log",!0)}),ye("click",de,K),r(p,m)};y(z,p=>{t().isEnded||p(se)})}var oe=s(X,2),he=a(oe);{var H=p=>{var m=Gs(),ve=a(m);ie(ve,5,()=>t().field.cells,le,(ue,xe,de)=>{var me=zs();Ae(me,`${`duel_desk_row_${de}`??""} svelte-1i63tk9`),ie(me,5,()=>e(xe),le,(E,B,ce)=>{Lr(E,{get view(){return t().view},row:de,column:ce,get selectedEntities(){return e(b)},set selectedEntities(Ce){D(b,Ce)},get selectedCells(){return e(d)},set selectedCells(Ce){D(d,Ce)},$$legacy:!0})}),r(ue,me)}),r(p,m)};y(he,p=>{t().clock.turn>0&&p(H)})}var M=s(oe,2),G=a(M);{var J=p=>{var m=Qs(),ve=U(m);{var ue=me=>{var E=Xs();u(B=>E.disabled=B,[()=>!e(L)()],fe),ye("click",E,Te),r(me,E)};y(ve,me=>{((e(x)&&e(x).qty)??(e(l)&&e(l).qty)??9999)>1&&me(ue)})}var xe=s(ve,2);{var de=me=>{var E=Vs();ye("click",E,S),r(me,E)};y(xe,me=>{e(F)&&me(de)})}r(p,m)},Ee=p=>{var m=Me(),ve=U(m);ie(ve,1,()=>e(P),le,(ue,xe)=>{var de=Zs(),me=a(de);u(()=>f(me,e(xe).action.title)),ye("click",de,()=>k(e(xe))),r(ue,de)}),r(p,m)};y(G,p=>{e(x)&&e(x).selectables.length||e(l)&&e(l).selectables?p(J):p(Ee,!1)})}var $=s(ge,2);{var Q=p=>{var m=Js(),ve=a(m);Zr(ve,{get log(){return t().log}});var ue=s(ve,2);Es(ue,{get cell(){return t().view.infoBoardCell}});var xe=s(ue,2);Ys(xe,{get userProfile(){return v()},get viewController(){return t().view}}),u(de=>Ae(m,`duel_desk_right duel_desk_right_${de??""}  svelte-1i63tk9`),[()=>t().view.infoBoardState.toLowerCase()],fe),ee(3,m,()=>pe,()=>({duration:e(_)>1400?0:200,axis:"x"})),r(p,m)};y($,p=>{(e(_)>1400||t().view.infoBoardState!=="Default")&&p(Q)})}var re=s(Z,2),Se=a(re),h=s(re,2);tr(h,{get modalController(){return t().view.modalController}});var T=s(h,2),w=a(T);const I=fe(()=>ae()==="wide"?"right":"left");Ls(w,{get duel(){return t()},get position(){return e(I)}}),u((p,m)=>{Ae(Z,`flex duel_desk ${p??""}_mode svelte-1i63tk9`),f(Se,m),Ae(T,`cutin ${p??""}_mode svelte-1i63tk9`)},[ae,()=>t().clock.toFullString()],fe),Kt("innerWidth",p=>D(_,p)),Kt("innerHeight",p=>D(c,p)),r(o,we),nt()}var ai=n('<div class="svelte-swqq02"><button class="button_style_reset svelte-swqq02" title="※shiftキー同時押しで一括外し">クリア</button></div>'),ri=n('<div class="svelte-swqq02"><button class="button_style_reset svelte-swqq02" title="※shiftキー同時押しで一括外し">クリア</button></div>'),si=n("<div></div>"),ii=n("<!> <!> <!> <!> <!>",1),ni=n('<span> </span> / <span style="display: inline-block;width:2rem;text-align: right;"> </span>',1),li=n('<li class="deck_editor_item svelte-swqq02"><div role="listitem"><div class="svelte-swqq02"><div class="svelte-swqq02"> </div> <div style="display:flex" class="svelte-swqq02"><div class="svelte-swqq02"><!> <!> <!></div> <div style="flex-grow: 1; width:0.1rem" class="svelte-swqq02"></div> <div class="svelte-swqq02"><!></div></div></div></div> <button class="button_style_reset svelte-swqq02" title="※shiftキー同時押しで一括投入">+</button> <button class="button_style_reset svelte-swqq02" title="※shiftキー同時押しで一括外し">-</button></li>'),oi=n('<div class="deck_editor_card_kind svelte-swqq02"><div class="deck_editor_card_kind_header svelte-swqq02"><div class="svelte-swqq02"> </div> <!></div> <ul class="svelte-swqq02"></ul></div>'),vi=n('<div class="deck_editor_deck_type svelte-swqq02"><div class="deck_editor_deck_type_header svelte-swqq02"><div class="svelte-swqq02"> </div> <!></div> <!></div>'),di=n('<div class="svelte-swqq02">読み込み中...</div>'),ci=n('<div class="deck_editor_card_list svelte-swqq02"><!></div>');function Ba(o,i){st(i,!1);let t=Le(i,"allCardInfos",8),v=Le(i,"deckCardInfos",12),_=Le(i,"mode",8),c=Le(i,"onAttention",8),b=Le(i,"searchCondition",8,void 0);const d={Deck:["Monster","Spell","Trap"],ExtraDeck:["Monster"]},q={Deck:{Monster:[],Spell:[],Trap:[]},ExtraDeck:{Monster:[],Spell:[],Trap:[]}},P=S=>{var k;return(k=S.monsterCategories)!=null&&k.union(zt).length?"ExtraDeck":"Deck"},x=S=>{Object.values(q).forEach(k=>Object.values(k).forEach(K=>K.reset())),S.filter(k=>k.isImplemented).filter(k=>k.kind!=="XyzMaterial").forEach(k=>{var ae;if(k.kind==="XyzMaterial")return;const K=(ae=k.monsterCategories)!=null&&ae.union(zt).length?"ExtraDeck":"Deck";q[K][k.kind].push(k)}),Object.values(q).forEach(k=>Object.values(k).forEach(K=>K.sort(ra)))},l=_()==="List"?new Promise(S=>{x(t()),S()}):Promise.resolve(),L=()=>(_()==="Deck"&&(x(v()),D(A,v().length)),q),F=(S,k,K)=>{v(v().filter(ae=>P(ae)!==k||ae.kind!==K&&K))},R=(S,k)=>{try{if(S.ctrlKey){v().push(k);return}const K=v().filter(we=>we.name===k.name).length;if(K>2)return;const ae=S.shiftKey?3-K:1;if(ae<1)return;v().push(...Array(ae).fill(k))}finally{v().sort(ra),v(v())}},W=(S,k)=>{let K=0;v(v().filter(ae=>ae.name!==k.name?!0:(K++,!S.shiftKey&&K>1))),v().sort(ra)};let A=ke(100);const Y=()=>{e(A)>t().length+v().length||(D(A,e(A)+10),Mt(100).then(Y))};Mt(100).then(Y);const te=(S,k)=>{if(!b())return!0;if(!b().cardKinds.includes(S.kind)||b().name.trim().length&&[S.name,...S.nameTags??[],...S.textTags??[]].every(ae=>!ae.includes(b().name))||S.isForTest&&!b().others.includes("test"))return!1;if(S.kind==="Monster")return S.attributes&&!b().monsterAttributes.union(S.attributes).length||S.types&&!b().monsterTypes.union(S.types).length||!S.monsterCategories?!1:S.monsterCategories.union(b().monsterCategories).length;if(S.kind==="Spell")return S.spellCategory&&b().spellCategories.includes(S.spellCategory);if(S.kind==="Trap")return S.trapCategory&&b().trapCategories.includes(S.trapCategory)};it();var ne=ci(),Te=a(ne);ht(Te,()=>l,S=>{var k=di();r(S,k)},S=>{var k=Me();const K=fe(L);var ae=U(k);ie(ae,1,()=>rr,le,(we,Z)=>{var _e=vi();const V=fe(()=>Object.values(e(K)[e(Z)]).flatMap(H=>H));var ge=a(_e),X=a(ge),z=a(X),se=s(X,2);{var oe=H=>{var M=ai(),G=a(M);ye("click",G,J=>F(J,e(Z),void 0)),r(H,M)};y(se,H=>{_()==="Deck"&&e(V).some(te)&&H(oe)})}var he=s(ge,2);ie(he,1,()=>oa(e(K)[e(Z)]).filter(H=>d[e(Z)].includes(H)),le,(H,M)=>{var G=oi();const J=fe(()=>e(K)[e(Z)][e(M)].filter(te));var Ee=a(G),$=a(Ee),Q=a($),re=s($,2);{var Se=T=>{var w=ri(),I=a(w);ye("click",I,p=>F(p,e(Z),e(M))),r(T,w)};y(re,T=>{_()==="Deck"&&e(J).length&&T(Se)})}var h=s(Ee,2);ie(h,5,()=>e(J),le,(T,w,I)=>{var p=Me(),m=U(p);{var ve=ue=>{var xe=li(),de=a(xe),me=a(de),E=a(me),B=a(E),ce=s(E,2),Ce=a(ce),Ke=a(Ce);{var Oe=O=>{var De=ii(),Ye=U(De);{var Re=$e=>{var He=rt();u(()=>f(He,`★${e(w).level??""}`)),r($e,He)};y(Ye,$e=>{e(w).level&&$e(Re)})}var Ie=s(Ye,2);{var We=$e=>{var He=rt();u(()=>f(He,`☆${e(w).rank??""}`)),r($e,He)};y(Ie,$e=>{e(w).rank&&$e(We)})}var vt=s(Ie,2);ie(vt,1,()=>e(w).attributes??[],le,($e,He)=>{var qe=si();u(()=>Ae(qe,`monster_attr ${e(He)??""} svelte-swqq02`)),r($e,qe)});var dt=s(vt,2);ie(dt,1,()=>e(w).types??[],le,($e,He)=>{var qe=rt();u(()=>f(qe,Vt[e(He)])),r($e,qe)});var tt=s(dt,2);ie(tt,1,()=>e(w).monsterCategories??[],le,($e,He)=>{var qe=rt();u(()=>f(qe,Qt[e(He)])),r($e,qe)}),r(O,De)};y(Ke,O=>{e(w).kind==="Monster"&&O(Oe)})}var Be=s(Ke,2);{var Ne=O=>{var De=rt();u(()=>f(De,`${Zt[e(w).spellCategory]??""}魔法`)),r(O,De)};y(Be,O=>{e(w).spellCategory!==void 0&&O(Ne)})}var ze=s(Be,2);{var j=O=>{var De=rt();u(()=>f(De,`${Jt[e(w).trapCategory]??""}罠`)),r(O,De)};y(ze,O=>{e(w).trapCategory!==void 0&&O(j)})}var C=s(Ce,4),g=a(C);{var N=O=>{var De=ni(),Ye=U(De),Re=a(Ye),Ie=s(Ye,2),We=a(Ie);u(()=>{f(Re,e(w).attack??"?"),f(We,e(w).defense??"?")}),r(O,De)};y(g,O=>{e(w).kind==="Monster"&&O(N)})}var be=s(de,2),je=s(be,2);u(O=>{Ae(de,`${O??""} svelte-swqq02`),f(B,e(w).name)},[()=>{var O,De;return`deck_editor_card duel_card ${e(w).kind} ${(De=(O=e(w))==null?void 0:O.monsterCategories)==null?void 0:De.join(" ")} ${e(w).isImplemented?"is_implemented":"is_not_implemented"}`}],fe),ye("mouseenter",de,()=>c()(e(w))),ye("click",be,O=>R(O,e(w))),ye("click",je,O=>W(O,e(w))),r(ue,xe)};y(m,ue=>{I<e(A)&&ue(ve)})}r(T,p)}),u(()=>f(Q,`${Ia[e(M)]??""}（${e(J).length??""} / ${e(K)[e(Z)][e(M)].length??""}枚）`)),r(H,G)}),u(H=>f(z,`${ar[e(Z)]??""}（${H??""} / ${e(V).length??""}枚）`),[()=>e(V).filter(te).length],fe),r(we,_e)}),r(S,k)}),r(o,ne),nt()}var _i=n('<div class="duel_card_info_row svelte-rccxcp" style="position:sticky; top:0;"><div class="svelte-rccxcp"> </div> <div class="svelte-rccxcp"> </div></div>'),ui=n('<div class="duel_card_info_row svelte-rccxcp"><div class="svelte-rccxcp"><pre class="description svelte-rccxcp"> </pre></div></div> <div class="duel_card_info_row svelte-rccxcp" style=" justify-content: space-between;"><div class="svelte-rccxcp"> </div> <div class="svelte-rccxcp"> </div></div>',1),fi=n('<div></div> <div class="svelte-rccxcp"> </div>',1),pi=n("<div> </div>"),gi=n("<div> </div>"),mi=n('<div class="duel_card_info_row svelte-rccxcp"><!> <!></div> <div class="duel_card_info_row svelte-rccxcp"></div>',1),bi=n('<div class="duel_card_row svelte-rccxcp"><div class="svelte-rccxcp"></div> <div class="svelte-rccxcp"> </div></div>'),hi=n('<div class="duel_card_row svelte-rccxcp"><div class="svelte-rccxcp"></div> <div class="svelte-rccxcp"> </div></div>'),yi=n('<div class="duel_card_info_row svelte-rccxcp"><div class="svelte-rccxcp">※テスト用カードです</div></div>'),ki=n('<div class="duel_card_info_links svelte-rccxcp"><a target="_blank" rel="noopener noreferrer" title="遊戯王カードWiki" class="svelte-rccxcp">⇒遊戯王カードWiki</a> <a target="_blank" rel="noopener noreferrer" title="コナミカードデータベース" class="svelte-rccxcp"> </a></div>'),wi=n('<div><div class="duel_card_info_header svelte-rccxcp"><div class="duel_card_info_row svelte-rccxcp"><div class="svelte-rccxcp"> </div></div> <!></div> <div class="duel_card_info_body svelte-rccxcp"><!> <!> <div class="duel_card_info_row description svelte-rccxcp"><div class="svelte-rccxcp"><pre class="description svelte-rccxcp"> </pre></div></div> <!></div></div>');function xi(o,i){st(i,!1);let t=Le(i,"cardInfo",8,void 0);const v=()=>t()?bt[t().name]:void 0;it();var _=Me(),c=U(_);{var b=d=>{var q=wi(),P=a(q),x=a(P),l=a(x),L=a(l),F=s(x,2);{var R=V=>{var ge=_i(),X=a(ge),z=a(X),se=s(X,2),oe=a(se);u((he,H)=>{f(z,he),f(oe,H)},[()=>"★".repeat(t().level||0),()=>"☆".repeat(t().rank||0)],fe),r(V,ge)};y(F,V=>{t().kind==="Monster"&&V(R)})}var W=s(P,2),A=a(W);{var Y=V=>{var ge=ui(),X=U(ge),z=a(X),se=a(z),oe=a(se),he=s(X,2),H=a(he),M=a(H),G=s(H,2),J=a(G);u(()=>{f(oe,bt[t().name].pendulumDescription),f(M,`◀ ${t().pendulumScaleL??""}`),f(J,`${t().pendulumScaleR??""} ▶`)}),r(V,ge)};y(A,V=>{var ge;(ge=t().monsterCategories)!=null&&ge.includes("Pendulum")&&V(Y)})}var te=s(A,2);{var ne=V=>{var ge=mi(),X=U(ge),z=a(X);{var se=M=>{var G=fi(),J=U(G),Ee=s(J,2),$=a(Ee);u(()=>{Ae(J,`monster_attr ${t().attributes[0]??""} svelte-rccxcp`),f($,`${va[t().attributes[0]]??""}属性`)}),r(M,G)};y(z,M=>{t().attributes&&M(se)})}var oe=s(z,2);{var he=M=>{var G=pi(),J=a(G);u(()=>{Ae(G,`monster_cat ${t().types[0]??""} svelte-rccxcp`),f(J,`${Vt[t().types[0]]??""}${da[t().types[0]]??""}族`)}),r(M,G)};y(oe,M=>{t().types&&M(he)})}var H=s(X,2);ie(H,5,()=>t().monsterCategories??[],le,(M,G)=>{var J=gi(),Ee=a(J);u(()=>{Ae(J,`monster_cat ${e(G)??""} svelte-rccxcp`),f(Ee,`${Qt[e(G)]??""}${ca[e(G)]??""}`)}),r(M,J)}),r(V,ge)},Te=V=>{var ge=Me(),X=U(ge);{var z=oe=>{var he=bi(),H=s(a(he),2),M=a(H);u(()=>f(M,`${Zt[t().spellCategory]??""}魔法`)),r(oe,he)},se=oe=>{var he=Me(),H=U(he);{var M=G=>{var J=hi(),Ee=s(a(J),2),$=a(Ee);u(()=>f($,`${Jt[t().trapCategory]??""}罠`)),r(G,J)};y(H,G=>{t().kind==="Trap"&&t().trapCategory&&G(M)},!0)}r(oe,he)};y(X,oe=>{t().kind==="Spell"&&t().spellCategory?oe(z):oe(se,!1)},!0)}r(V,ge)};y(te,V=>{t().kind==="Monster"?V(ne):V(Te,!1)})}var S=s(te,2),k=a(S),K=a(k),ae=a(K),we=s(S,2);{var Z=V=>{var ge=yi();r(V,ge)},_e=V=>{var ge=ki(),X=a(ge),z=s(X,2),se=a(z);u(oe=>{gt(X,"href",`https://yugioh-wiki.net/index.php?${t().wikiEncodedName}`),gt(z,"href",oe),f(se,`⇒${(t().cardId?"公式カードページ":"公式で検索")??""}`)},[()=>sr(t())],fe),r(V,ge)};y(we,V=>{t().isForTest?V(Z):V(_e,!1)})}u((V,ge)=>{Ae(q,`duel_card duel_card_info ${t().kind??""} ${V??""} svelte-rccxcp`),f(L,t().name),f(ae,ge)},[()=>{var V;return(V=t().monsterCategories)==null?void 0:V.join(" ")},()=>{var V;return(V=v())==null?void 0:V.description}],fe),r(d,q)};y(c,d=>{t()&&d(b)})}r(o,_),nt()}const Ci={0:{aaa:"日",aaaa:"日曜日",ddd:"Sun",dddd:"Sunday"},1:{aaa:"月",aaaa:"月曜日",ddd:"Mon",dddd:"Monday"},2:{aaa:"火",aaaa:"火曜日",ddd:"Tue",dddd:"Tuesday"},3:{aaa:"水",aaaa:"水曜日",ddd:"Wed",dddd:"Wednesday"},4:{aaa:"木",aaaa:"木曜日",ddd:"Thu",dddd:"Thursday"},5:{aaa:"金",aaaa:"金曜日",ddd:"Fri",dddd:"Friday"},6:{aaa:"土",aaaa:"土曜日",ddd:"Sat",dddd:"Saturday"}};class Di{constructor(){Ze(this,"DefaultSeparator1","/");Ze(this,"DefaultSeparator2"," ");Ze(this,"DefaultSeparator3",":");Ze(this,"createDate",i=>{if(!i)return;const t=new Date(i);if(!isNaN(t.getTime()))return t});Ze(this,"createDateOr",(i,t)=>this.createDate(i)||t||new Date);Ze(this,"truncateDate",i=>{const t=i||new Date;return new Date(t.getFullYear(),t.getMonth(),t.getDate())});Ze(this,"addDate",(i,t)=>{const v=this.createDateOr(i);return v.setDate(v.getDate()+t),v});Ze(this,"addMonth",(i,t)=>{const v=this.createDateOr(i);return v.setMonth(v.getMonth()+t),v});Ze(this,"addYear",(i,t)=>{const v=this.createDateOr(i);return v.setFullYear(v.getFullYear()+t),v});Ze(this,"getDayOfWeek",(i,t="dddd")=>{const v=this.createDate(i);return v?Ci[v.getDay()][t]:""});Ze(this,"formatToYYYYMMDD",(i,t=this.DefaultSeparator1)=>{const v=this.createDate(i);if(!v)return"";const _=v.getFullYear().toString(),c=("0"+(v.getMonth()+1)).slice(-2),b=("0"+v.getDate()).slice(-2);return _+t+c+t+b});Ze(this,"formatToYYYYMM",(i,t=this.DefaultSeparator1)=>{const v=this.createDate(i);if(!v)return"";t||(t="");const _=v.getFullYear().toString(),c=("0"+(v.getMonth()+1)).slice(-2);return _+t+c});Ze(this,"formatToHHMMSS",(i,t=this.DefaultSeparator3)=>{const v=this.createDate(i);if(!v)return"";t||(t="");const _=v.getHours(),c=v.getMinutes(),b=v.getSeconds();return("0"+_).slice(-2)+t+("0"+c).slice(-2)+t+("0"+b).slice(-2)});Ze(this,"formatToHHMM",(i,t=this.DefaultSeparator3)=>{const v=this.createDate(i);if(!v)return"";t||(t="");const _=("0"+v.getHours()).slice(-2),c=("0"+v.getMinutes()).slice(-2);return _+t+c});Ze(this,"formatToYYYYMMDD_HHMM",(i,t=this.DefaultSeparator1,v=this.DefaultSeparator2,_=this.DefaultSeparator3)=>{const c=this.createDate(i);return c?this.formatToYYYYMMDD(c,t)+v+this.formatToHHMM(c,_):""});Ze(this,"formatToYYYYMMDD_HHMMSS",(i,t=this.DefaultSeparator1,v=this.DefaultSeparator2,_=this.DefaultSeparator3)=>{const c=this.createDate(i);return c?this.formatToYYYYMMDD(c,t)+v+this.formatToHHMMSS(c,_):""})}}const ct=new Di;Date.prototype.truncateDate=function(){return ct.truncateDate(this)};Date.prototype.getCloneOr=function(o){return ct.createDateOr(this,o)};Date.prototype.addDate=function(o){return ct.addDate(this,o)};Date.prototype.addMonth=function(o){return ct.addDate(this,o)};Date.prototype.addYear=function(o){return ct.addDate(this,o)};Date.prototype.getDayOfWeek=function(o="dddd"){return ct.getDayOfWeek(this,o)};Date.prototype.formatToYYYYMM=function(o){return ct.formatToYYYYMM(this,o)};Date.prototype.formatToYYYYMMDD=function(o){return ct.formatToYYYYMMDD(this,o)};Date.prototype.formatToYYYYMMDD_HHMM=function(o,i,t){return ct.formatToYYYYMMDD_HHMM(this,o,i,t)};Date.prototype.formatToYYYYMMDD_HHMMSS=function(o,i,t){return ct.formatToYYYYMMDD_HHMMSS(this,o,i,t)};Date.prototype.formatToHHMM=function(o){return ct.formatToHHMM(this,o)};Date.prototype.formatToHHMMSS=function(o){return ct.formatToHHMMSS(this,o)};var $i=n('<li class="deck_info_list_item svelte-2wdgc8"><div class="svelte-2wdgc8"> </div> <div class="svelte-2wdgc8"> </div> <div class="svelte-2wdgc8"> </div></li>'),Si=n('<ul class="deck_info_list svelte-2wdgc8"></ul>'),Mi=n('<label for="file_selector" class="upload_area svelte-2wdgc8" role="region" aria-label="ファイルアップロードエリア"><div class="upload_area_message svelte-2wdgc8">ここにファイルをドロップ</div> <div class="upload_area_footer svelte-2wdgc8"><input type="file" id="file_selector" name="file_selector" accept=".json" multiple></div></label>'),Ti=n('<div slot="body" class="modal_body svelte-2wdgc8"><!></div>'),ji=n('<button class="svelte-2wdgc8">追加</button> <button class="svelte-2wdgc8">削除して追加</button> <button class="svelte-2wdgc8">戻る</button>',1),Ei=n('<button class="svelte-2wdgc8">Cancel</button>'),qi=n('<div slot="footer" class="modal_window_footer svelte-2wdgc8"><!></div>');function Ai(o,i){st(i,!1);let t=Le(i,"eventHolder",8),v=Le(i,"args",8),_=Le(i,"resolve",8),c=ke(Promise.resolve([])),b=ke();const d=()=>{D(b,new DataTransfer().files),D(c,Promise.resolve([]))},q=async F=>{F.preventDefault(),console.log("hoge",F)},P=async F=>{F.preventDefault(),F.dataTransfer&&l(F.dataTransfer.files)},x=()=>{l(e(b))},l=async F=>{if(!F.length)return;const R=[],W=[];for(const A of F)try{W.push(...await ft.createfromJson(A))}catch(Y){Y instanceof Error&&R.push(Y.message)}if(R.length){console.log(...R);return}D(c,e(c).then(()=>W))},L=d;it(),ir(o,{get eventHolder(){return t()},get args(){return v()},$$slots:{body:(F,R)=>{var W=Ti(),A=a(W);ht(A,()=>e(c),null,(Y,te)=>{var ne=Me(),Te=U(ne);{var S=K=>{var ae=Si();ie(ae,5,()=>e(te),le,(we,Z)=>{var _e=$i(),V=a(_e),ge=a(V),X=s(V,2),z=a(X),se=s(X,2),oe=a(se);u((he,H,M)=>{f(ge,e(Z).name),f(z,`${he??""}
                /
                ${H??""}`),f(oe,`最終使用日時 ： ${M??""}`)},[()=>e(Z).cardNames.filter(he=>v().mainCardNames.includes(he)).length,()=>e(Z).cardNames.filter(he=>v().exCardNames.includes(he)).length,()=>e(Z).lastUsedAt.formatToYYYYMMDD_HHMM("/"," ",":")],fe),r(we,_e)}),r(K,ae)},k=K=>{var ae=Mi(),we=s(a(ae),2),Z=a(we);nr(Z,()=>e(b),_e=>D(b,_e)),ye("change",Z,x),ye("cancel",Z,L),ye("drop",ae,P),ye("dragover",ae,q),r(K,ae)};y(Te,K=>{e(te).length?K(S):K(k,!1)})}r(Y,ne)}),r(F,W)},footer:(F,R)=>{var W=qi(),A=a(W);ht(A,()=>e(c),null,(Y,te)=>{var ne=Me(),Te=U(ne);{var S=K=>{var ae=ji(),we=U(ae),Z=s(we,2),_e=s(Z,2);u(()=>{we.disabled=e(te).length===0,Z.disabled=e(te).length===0}),ye("click",we,()=>_()({deckInfos:e(te),replaceAll:!1})),ye("click",Z,()=>_()({deckInfos:e(te),replaceAll:!0})),ye("click",_e,L),r(K,ae)},k=K=>{var ae=Me(),we=U(ae);{var Z=_e=>{var V=Ei();ye("click",V,()=>_()(void 0)),r(_e,V)};y(we,_e=>{v().cancelable&&_e(Z)},!0)}r(K,ae)};y(Te,K=>{e(te).length?K(S):K(k,!1)})}r(Y,ne)}),r(F,W)}}}),nt()}const Xt=class Xt extends or{constructor(i,t){super(i,...Object.values(t))}};Ze(Xt,"createModalController",i=>{const t={deckUploader:new vr({title:"デッキ情報をアップロード",position:"Middle",cancelable:!1,mainCardNames:[],exCardNames:[]})};return Object.assign(new Xt(i,t),t)});let la=Xt;function Yi(o,i){st(i,!1);let t=Le(i,"modalController",8);it(),lr(o,{get modalController(){return t()},children:(v,_)=>{var c=Me(),b=U(c);{var d=q=>{Ai(q,{get eventHolder(){return t().eventHolder},get args(){return t().deckUploader.args},get resolve(){return t().deckUploader.resolve}})};y(b,q=>{t().deckUploader.state==="Shown"&&q(d)})}r(v,c)},$$slots:{default:!0}}),nt()}var Bi=n('<label><input type="checkbox"> </label>'),Ni=n('<label><input type="checkbox"> </label>'),Ii=n('<label><input type="checkbox"> <div style="display: inline-block;"></div> </label>'),Fi=n('<label><input type="checkbox"> </label>'),Hi=n('<div class="deck_editor_search_box_row svelte-1s1plv5"><div class="svelte-1s1plv5"><button class="search_condition_title black_button svelte-1s1plv5">モンスター</button></div> <div class="svelte-1s1plv5"></div></div> <div class="deck_editor_search_box_row svelte-1s1plv5"><div class="svelte-1s1plv5"><button class="search_condition_title black_button svelte-1s1plv5">属性</button></div> <div class="svelte-1s1plv5"></div></div> <div class="deck_editor_search_box_row svelte-1s1plv5"><div class="svelte-1s1plv5"><button class="search_condition_title black_button svelte-1s1plv5">種族</button></div> <div class="svelte-1s1plv5"></div></div>',1),Ui=n('<label><input type="checkbox"> </label>'),Pi=n('<div class="deck_editor_search_box_row svelte-1s1plv5"><div class="svelte-1s1plv5"><button class="search_condition_title black_button svelte-1s1plv5">魔法</button></div> <div class="svelte-1s1plv5"></div></div>'),Oi=n('<label><input type="checkbox"> </label>'),Li=n('<div class="deck_editor_search_box_row svelte-1s1plv5"><div class="svelte-1s1plv5"><button class="search_condition_title black_button svelte-1s1plv5">罠</button></div> <div class="svelte-1s1plv5"></div></div>'),Ri=n('<label><input type="checkbox"> </label>'),Wi=n("<option> </option>"),Ki=n('<div class="svelte-1s1plv5"><a class="white_button svelte-1s1plv5" download="SVS_DeckInfos.json">ダウンロード</a></div>'),zi=n('<div class="svelte-1s1plv5"></div>'),Gi=n('<div class="svelte-1s1plv5"><a class="white_button svelte-1s1plv5" download="SVS_DeckInfos.json">ダウンロード(一括)</a></div>'),Xi=n('<div class="svelte-1s1plv5"></div>'),Vi=n('<div class="deck_editor_body_right_header svelte-1s1plv5"><div class="deck_editor_body_right_header_row svelte-1s1plv5"><div class="svelte-1s1plv5">編集対象 <select></select></div> <div class="svelte-1s1plv5"></div> <div class="svelte-1s1plv5">新規名称 <input type="text"></div></div> <div class="deck_editor_body_right_header_row svelte-1s1plv5"></div> <div class="deck_editor_body_right_header_row svelte-1s1plv5"><div class="svelte-1s1plv5">基本操作</div> <div class="svelte-1s1plv5"><button class="white_button svelte-1s1plv5">デッキを保存</button></div> <div class="svelte-1s1plv5"></div> <div class="svelte-1s1plv5"><button class="white_button svelte-1s1plv5">デッキを複製</button></div> <div class="svelte-1s1plv5"><button class="white_button svelte-1s1plv5" title="shiftキー押下で確認メッセージスキップ">デッキを削除</button></div></div> <div class="deck_editor_body_right_header_row svelte-1s1plv5"><div class="svelte-1s1plv5">DL/UL</div> <!> <!> <div class="svelte-1s1plv5"><button class="white_button svelte-1s1plv5">アップロード</button></div></div></div> <!>',1),Qi=n("<div>デッキ情報読込中</div>"),Zi=n('<div class="deck_editor svelte-1s1plv5"><div class="deck_editor_header"></div> <div class="deck_editor_body svelte-1s1plv5"><div class="deck_editor_body_left svelte-1s1plv5"><div role="contentinfo"><div class="deck_editor_search_box_header svelte-1s1plv5"><div>検索条件</div> <div><button class="white_button svelte-1s1plv5">条件クリア</button></div></div> <div class="deck_editor_search_box_row svelte-1s1plv5"><div class="svelte-1s1plv5">名称</div> <div class="svelte-1s1plv5"><input type="text" style="width:70%"> <button class="white_button svelte-1s1plv5">クリア</button> <span>※ルビには対応していません</span></div></div> <div class="deck_editor_search_box_row svelte-1s1plv5"><div class="svelte-1s1plv5"><button class="search_condition_title black_button svelte-1s1plv5">種類</button></div> <div class="svelte-1s1plv5"></div></div> <!> <!> <!> <div class="deck_editor_search_box_row svelte-1s1plv5"><div class="svelte-1s1plv5"><button class="search_condition_title black_button svelte-1s1plv5">その他</button></div> <div class="svelte-1s1plv5"></div></div></div> <!></div> <div class="deck_editor_body_center svelte-1s1plv5"><!></div> <div class="deck_editor_body_right svelte-1s1plv5"><!></div></div> <div class="footer svelte-1s1plv5"></div></div> <!>',1);function Ji(o,i){st(i,!1);const t=[],v=[],_=[],c=[],b=[],d=[],q=[],P=la.createModalController({onDragStart:{append:()=>{},remove:()=>{}},onDragEnd:{append:()=>{},remove:()=>{}}}),x={name:"",cardKinds:wa.filter(j=>j!=="XyzMaterial"),monsterCategories:[...Sa],monsterAttributes:[...$a],monsterTypes:[...Da],spellCategories:[...Ca],trapCategories:[...xa],others:["test"]},l=ke(structuredClone(x));Pe(l,e(l).others=[]);let L=ke("SearchCondition");const F=async()=>{Pe(l,e(l).name=""),Pe(l,e(l).cardKinds=[]),Pe(l,e(l).monsterCategories=[]),Pe(l,e(l).monsterAttributes=[]),Pe(l,e(l).monsterTypes=[]),Pe(l,e(l).spellCategories=[]),Pe(l,e(l).trapCategories=[]),Pe(l,e(l).others=[])},R=async j=>{Array.isArray(e(l)[j])&&Array.isArray(x[j])&&Pe(l,e(l)[j]=e(l)[j].length?[]:[...x[j]])},W=(j,C,g)=>{Array.isArray(e(l)[C])&&Array.isArray(x[C])&&Pe(l,e(l)[C]=[g])},A=async()=>{const C=(await e(ne)).find(g=>g.id===e(te));C&&D(k,{...C,cardInfos:C.cardNames.map(g=>bt[g])})},Y=()=>ft.getAllDeckInfo().then(j=>(D(te,(j.find(C=>C.lastUsedAt.getTime()===Math.max(...j.map(g=>g.lastUsedAt.getTime())))??j[0]).id),j));let te=ke(-1),ne=ke(Y()),Te=ke(e(ne).then(j=>ft.convertToObjectURL(j)));e(ne).then(A);const S=()=>{D(ne,Y()),D(Te,e(ne).then(j=>ft.convertToObjectURL(j))),A()};let k=ke({id:-Number.MAX_VALUE,name:"",description:"",lastUsedAt:new Date,cardInfos:[]}),K=ke(bt.ゾンビーノ);const ae=j=>{D(L,"CardDetail"),D(K,j)},we=async()=>{const C=(await e(ne)).find(g=>g.id===e(te));if(!C)throw new Error("illegal state");return C},Z=async()=>{const j=await we();await j.saveDeckInfo({...j,name:e(k).name,cardNames:e(k).cardInfos.map(C=>C.name),lastUsedAt:new Date}),S()},_e=async()=>{(await ft.createNewDeck(`デッキ_${new Date().formatToYYYYMMDD_HHMMSS("","","")}`,`コピー日時：${new Date().formatToYYYYMMDD_HHMMSS("-"," ",":")}`,e(k).cardInfos.map(C=>C.name))).saveDeckInfo(),S()},V=async j=>{const C=await we();!j.shiftKey&&!confirm(`デッキ【${C.name}】を削除します。
よろしいですか？`)||(await C.delete(),S())},ge=async()=>{const j=await P.deckUploader.show({title:"デッキ情報アップロード",position:"Middle",cancelable:!0,mainCardNames:Object.values(bt).filter(g=>{var N;return!((N=g.monsterCategories)!=null&&N.union(zt).length)}).map(g=>g.name),exCardNames:Object.values(bt).filter(g=>{var N;return(N=g.monsterCategories)==null?void 0:N.union(zt).length}).map(g=>g.name)});if(!j)return;const C=[];if(j.replaceAll){if(!confirm(`既存デッキ情報を全て削除し、アップロードしたファイルに置き換えます。
よろしいですか？`))return;C.push(...(await e(ne)).map(g=>g.id))}await Promise.all(j.deckInfos.map(g=>ft.createNewDeck(g.name,g.description,g.cardNames,g.lastUsedAt))),C.length&&await Promise.all(C.map(ft.remove)),S()};it();var X=Zi(),z=U(X),se=s(a(z),2),oe=a(se),he=a(oe),H=a(he),M=s(a(H),2),G=a(M),J=s(H,2),Ee=s(a(J),2),$=a(Ee),Q=s($,2),re=s(J,2),Se=a(re),h=a(Se),T=s(Se,2);ie(T,5,()=>wa.filter(j=>j!=="XyzMaterial"),le,(j,C)=>{var g=Bi(),N=a(g),be,je=s(N);u(()=>{be!==(be=e(C))&&(N.value=(N.__value=e(C))==null?"":e(C)),f(je,` ${Ia[e(C)]??""}`)}),Dt(t,[],N,()=>(e(C),e(l).cardKinds),O=>Pe(l,e(l).cardKinds=O)),r(j,g)});var w=s(re,2);{var I=j=>{var C=Hi(),g=U(C),N=a(g),be=a(N),je=s(N,2);ie(je,5,()=>Sa,le,(tt,$e)=>{var He=Ni(),qe=a(He),Ve,Je=s(qe);u(()=>{Ve!==(Ve=e($e))&&(qe.value=(qe.__value=e($e))==null?"":e($e)),f(Je,` ${Qt[e($e)]??""}${ca[e($e)]??""}`)}),Dt(v,[],qe,()=>(e($e),e(l).monsterCategories),lt=>Pe(l,e(l).monsterCategories=lt)),r(tt,He)});var O=s(g,2),De=a(O),Ye=a(De),Re=s(De,2);ie(Re,5,()=>$a,le,(tt,$e)=>{var He=Ii(),qe=a(He),Ve,Je=s(qe,2),lt=s(Je);u(()=>{Ve!==(Ve=e($e))&&(qe.value=(qe.__value=e($e))==null?"":e($e)),Ae(Je,`monster_attr ${e($e)??""} svelte-1s1plv5`),f(lt,` ${va[e($e)]??""}`)}),Dt(_,[],qe,()=>(e($e),e(l).monsterAttributes),yt=>Pe(l,e(l).monsterAttributes=yt)),r(tt,He)});var Ie=s(O,2),We=a(Ie),vt=a(We),dt=s(We,2);ie(dt,5,()=>Da,le,(tt,$e)=>{var He=Fi(),qe=a(He),Ve,Je=s(qe);u(()=>{Ve!==(Ve=e($e))&&(qe.value=(qe.__value=e($e))==null?"":e($e)),f(Je,` ${Vt[e($e)]??""}
                  ${da[e($e)]??""}`)}),Dt(c,[],qe,()=>(e($e),e(l).monsterTypes),lt=>Pe(l,e(l).monsterTypes=lt)),ye("dblclick",He,lt=>W(lt,"monsterTypes",e($e))),r(tt,He)}),ye("click",be,()=>R("monsterCategories")),ee(3,g,()=>pe,()=>({delay:0,duration:100})),ye("click",Ye,()=>R("monsterAttributes")),ee(3,O,()=>pe,()=>({delay:0,duration:100})),ye("click",vt,()=>R("monsterTypes")),ee(3,Ie,()=>pe,()=>({delay:0,duration:100})),r(j,C)};y(w,j=>{e(l).cardKinds.includes("Monster")&&j(I)})}var p=s(w,2);{var m=j=>{var C=Pi(),g=a(C),N=a(g),be=s(g,2);ie(be,5,()=>Ca,le,(je,O)=>{var De=Ui(),Ye=a(De),Re,Ie=s(Ye);u(()=>{Re!==(Re=e(O))&&(Ye.value=(Ye.__value=e(O))==null?"":e(O)),f(Ie,` ${Zt[e(O)]??""}`)}),Dt(b,[],Ye,()=>(e(O),e(l).spellCategories),We=>Pe(l,e(l).spellCategories=We)),r(je,De)}),ye("click",N,()=>R("spellCategories")),ee(3,C,()=>pe,()=>({delay:0,duration:100})),r(j,C)};y(p,j=>{e(l).cardKinds.includes("Spell")&&j(m)})}var ve=s(p,2);{var ue=j=>{var C=Li(),g=a(C),N=a(g),be=s(g,2);ie(be,5,()=>xa,le,(je,O)=>{var De=Oi(),Ye=a(De),Re,Ie=s(Ye);u(()=>{Re!==(Re=e(O))&&(Ye.value=(Ye.__value=e(O))==null?"":e(O)),f(Ie,` ${Jt[e(O)]??""}`)}),Dt(d,[],Ye,()=>(e(O),e(l).trapCategories),We=>Pe(l,e(l).trapCategories=We)),r(je,De)}),ye("click",N,()=>R("trapCategories")),ee(3,C,()=>pe,()=>({delay:0,duration:100})),r(j,C)};y(ve,j=>{e(l).cardKinds.includes("Trap")&&j(ue)})}var xe=s(ve,2),de=a(xe),me=a(de),E=s(de,2);ie(E,4,()=>[{key:"test",text:"テスト用カードを表示する"}],le,(j,C)=>{var g=Ri(),N=a(g),be,je=s(N);u(()=>{be!==(be=C.key)&&(N.value=(N.__value=C.key)==null?"":C.key),f(je,` ${C.text??""}`)}),Dt(q,[],N,()=>(C.key,e(l).others),O=>Pe(l,e(l).others=O)),r(j,g)});var B=s(he,2);xi(B,{get cardInfo(){return e(K)}});var ce=s(oe,2),Ce=a(ce);const Ke=fe(()=>Object.values(bt));Ba(Ce,{mode:"List",get allCardInfos(){return e(Ke)},onAttention:ae,get searchCondition(){return e(l)},get deckCardInfos(){return e(k).cardInfos},set deckCardInfos(j){Pe(k,e(k).cardInfos=j)},$$legacy:!0});var Oe=s(ce,2),Be=a(Oe);ht(Be,()=>e(ne),j=>{var C=Qi();r(j,C)},(j,C)=>{var g=Vi(),N=U(g),be=a(N),je=a(be),O=s(a(je));u(()=>{e(te),At(()=>{e(C)})}),ie(O,5,()=>e(C),le,(Ge,Fe)=>{var Ue=Wi(),Xe={},Qe=a(Ue);u(()=>{Xe!==(Xe=e(Fe).id)&&(Ue.value=(Ue.__value=e(Fe).id)==null?"":e(Fe).id),f(Qe,e(Fe).name)}),r(Ge,Ue)});var De=s(je,4),Ye=s(a(De)),Re=s(be,4),Ie=s(a(Re),2),We=a(Ie),vt=s(Ie,4),dt=a(vt),tt=s(vt,2),$e=a(tt),He=s(Re,2),qe=s(a(He),2);ht(qe,we,Ge=>{var Fe=zi();r(Ge,Fe)},(Ge,Fe)=>{var Ue=Ki(),Xe=a(Ue);u(Qe=>gt(Xe,"href",Qe),[()=>ft.convertToObjectURL([e(Fe)])],fe),r(Ge,Ue)});var Ve=s(qe,2);ht(Ve,()=>e(Te),Ge=>{var Fe=Xi();r(Ge,Fe)},(Ge,Fe)=>{var Ue=Gi(),Xe=a(Ue);u(()=>gt(Xe,"href",e(Fe))),r(Ge,Ue)});var Je=s(Ve,2),lt=a(Je),yt=s(N,2);Ba(yt,{mode:"Deck",allCardInfos:[],onAttention:ae,get deckCardInfos(){return e(k).cardInfos},set deckCardInfos(Ge){Pe(k,e(k).cardInfos=Ge)},$$legacy:!0}),Yt(O,()=>e(te),Ge=>D(te,Ge)),ye("change",O,A),sa(Ye,()=>e(k).name,Ge=>Pe(k,e(k).name=Ge)),ye("click",We,Z),ye("click",dt,_e),ye("click",$e,V),ye("click",lt,ge),r(j,g)});var Ne=s(se,2);Ne.textContent=`実装済カード${dr+Ma}枚（内、効果のないモンスター${Ma??""}枚）`;var ze=s(z,2);Yi(ze,{modalController:P}),u(()=>Ae(he,`deck_editor_search_box ${(e(L)==="SearchCondition"?"":"minimum")??""} svelte-1s1plv5`)),ye("click",G,F),sa($,()=>e(l).name,j=>Pe(l,e(l).name=j)),ye("click",Q,()=>Pe(l,e(l).name="")),ye("click",h,()=>R("cardKinds")),ye("click",me,()=>R("others")),ee(3,xe,()=>pe,()=>({delay:0,duration:100})),ye("mouseenter",he,()=>D(L,"SearchCondition")),r(o,X),nt()}String.prototype.format=(o,...i)=>{for(const[t,v]of i.entries()){const _=new RegExp(`\\{${t}\\}`,"g");o=o.replace(_,v)}return o};String.prototype.toSnakeCase=function(){return this.split(/(?=[A-Z])/).join("_").toLowerCase()};const en=["TblDeckHeader","TblDeckDetail","TblDuelistProfile"],tn=3;var an=n('<input class="game_mode_radio svelte-abgng1" type="radio" name="game_mode"> <label> </label>',1),rn=n('<option class="svelte-abgng1"> </option>'),sn=n('<option class="svelte-abgng1"> </option>'),nn=n('<option class="svelte-abgng1"> </option>'),ln=n('<tr class="config_row svelte-abgng1"><td class="svelte-abgng1"><div class="svelte-abgng1"><label for="npc_deck_selector" class="config_row_label deck_selector svelte-abgng1">デッキ：</label></div></td><td class="svelte-abgng1"><div class="svelte-abgng1"><select id="npc_deck_selector" class="deck_selector svelte-abgng1"><option class="svelte-abgng1">デフォルト</option><!></select></div></td></tr>'),on=n('<option class="svelte-abgng1"> </option>'),vn=n('<tr class="config_row svelte-abgng1"><td class="svelte-abgng1"><div class="svelte-abgng1"><label for="npc_selector" class="config_row_label npc_selector svelte-abgng1">対戦相手：</label></div></td><td class="svelte-abgng1"><div class="svelte-abgng1"><select id="npc_selector" class="npc_selector svelte-abgng1"></select> <div class="svelte-abgng1"> </div></div></td></tr> <!> <tr class="config_row svelte-abgng1"><td class="svelte-abgng1"><div class="svelte-abgng1"><label for="npc_selector" class="config_row_label npc_selector svelte-abgng1">先攻後攻：</label></div></td><td class="svelte-abgng1"><div class="svelte-abgng1"><select id="npc_selector" class="npc_selector svelte-abgng1"></select></div></td></tr>',1),dn=n('<option class="svelte-abgng1"> </option>'),cn=n('<tr class="config_row svelte-abgng1"><td class="svelte-abgng1"><div class="svelte-abgng1"><label for="difficulty_selector" class="config_row_label difficulty_selector svelte-abgng1">難易度：</label></div></td><td class="svelte-abgng1"><div class="svelte-abgng1"><select id="difficulty_selector" class="difficulty_selector svelte-abgng1"></select></div></td></tr>'),_n=n('<tr class="config_row svelte-abgng1"><td class="svelte-abgng1"><div class="svelte-abgng1"><label class="config_row_label svelte-abgng1" for="game_mode_radio_preset">ゲームモード：</label></div></td><td class="svelte-abgng1"><div class="svelte-abgng1"></div></td></tr> <tr class="config_row svelte-abgng1"><td class="svelte-abgng1"><div class="svelte-abgng1"><label for="deck_selector" class="config_row_label deck_selector svelte-abgng1">デッキ：</label></div></td><td class="svelte-abgng1"><div class="svelte-abgng1"><select id="deck_selector" class="deck_selector svelte-abgng1"></select></div></td></tr> <!> <tr><td colspan="2" class="svelte-abgng1"><div><button class="btn svelte-abgng1">duel start!</button></div></td></tr>',1),un=n('<tr><td colspan="2" class="svelte-abgng1"><div>デッキ情報の読み込み、もしくは作成中...</div></td></tr>'),fn=n('<tr><td colspan="2" class="svelte-abgng1"><div><button class="btn svelte-abgng1">deck edit</button></div></td></tr>'),pn=n('<tr class="config_row svelte-abgng1"><td class="svelte-abgng1"><div class="svelte-abgng1"><label for="duelist_name" class="config_row_label duelist_name svelte-abgng1">名前：</label></div></td><td class="svelte-abgng1"><div class="svelte-abgng1"><input id="duelist_name" class="duelist_name svelte-abgng1" type="text"></div></td></tr> <!> <!>',1),gn=n('<tr><td colspan="2" class="svelte-abgng1"><div>デュエリスト情報の読み込み、もしくは作成中...</div></td></tr>'),mn=n('<div class="app_body svelte-abgng1"><table class="config_table svelte-abgng1"><tbody><!></tbody></table></div>'),bn=n('<div class="result_title result_win svelte-abgng1">YOU WIN</div>'),hn=n('<div class="result_title result_lose svelte-abgng1">YOU LOSE</div>'),yn=n('<div class="result_title result_draw svelte-abgng1">DRAW</div>'),kn=n('<div class="twitter_share_button_wrapper svelte-abgng1"><a rel="nofollow" target="_blank" class="twitter_share_button svelte-abgng1">X(twitter)でシェアする</a></div>'),wn=n('<div class="result svelte-abgng1"><!> <div class="reason_of_end svelte-abgng1"> </div> <!> <div class="svelte-abgng1"><button class="white_button svelte-abgng1">TOPへ戻る</button></div></div>'),xn=n('<main style="flex-direction: column; display :flex" class="svelte-abgng1"><div class="link link_left svelte-abgng1"><a href="https://github.com/Setta238/stk_ygo_svelte" target="_blank" rel="noopener noreferrer" title="repository" class="svelte-abgng1">repository</a> <a href="https://x.com/ninja_no" target="_blank" rel="noopener noreferrer" title="repository" class="svelte-abgng1">X(Twitter)</a> <a href="https://posfie.com/@ninja_no/p/Lx7FLj3" target="_blank" rel="noopener noreferrer" title="posfie" class="svelte-abgng1">posfie(toggeter)</a></div> <div class="link link_right svelte-abgng1"><a class="a_button svelte-abgng1" role="button" tabindex="0">TOPへ戻る</a> <a href="/stk_ygo_svelte/note.html" target="_blank" rel="noopener noreferrer" title="repository" class="svelte-abgng1">現時点とこの先のこと</a></div> <!> <div class="debug_info svelte-abgng1"><span class="svelte-abgng1"> </span> <span class="user_agent_info svelte-abgng1"> </span> <span class="screen_info svelte-abgng1"> </span></div> <!></main>');function Cn(o,i){st(i,!1);const t=new cr("stk_ygo_svelte",tn,en);let v=ke(0),_=ke(0),c=ke(),b=ke("FtkChallenge"),d=ke("None"),q=ke(0),P=ke(""),x=ke(void 0);const l="https://setta238.github.io/stk_ygo_svelte/",L="遊戯王deそりてあ",F="ninja_no",R=_r.getOrCreateNew(t).then(h=>(D(b,Ta.includes(h.previousGameMode)?h.previousGameMode:"FtkChallenge"),V(h.previousNpcId),h)),W=h=>{var w;const T=h.find(I=>I.lastUsedAt.getTime()===Math.max(...h.map(p=>p.lastUsedAt.getTime())))??h[0];D(q,T.id),e(b)==="FtkChallenge"&&T.deckType!=="Preset"&&D(q,((w=$t.find(I=>I.deckType==="Preset"))==null?void 0:w.id)??e(q))};let A=ke(ft.getAllDeckInfo(t).then(h=>(Promise.all(h.filter(T=>!T.lastUsedAt).map(T=>{T.saveDeckInfo()})),W(h),h)));const Y=async()=>{const h=e(q);let T=(await e(A)).find(I=>I.id===h)??(await ne()).find(I=>I.id===h);T&&await T.updateTimestamp();let w=T;if(w||(w=$t.find(I=>I.id===h)),!w)throw new Error("illegal state");return w},te=async()=>{(await R).save({previousGameMode:e(b)})},ne=()=>(D(A,ft.getAllDeckInfo(t).then(h=>(W(h),h))),e(A)),Te=async()=>{(await e(A)).length||(await ft.prepareSampleDeck(),ne())},S=async()=>{await Promise.all([te(),Te()]);const h=await Y(),T=await R;let w=qt.find(m=>m.id===Number.MIN_SAFE_INTEGER)??qt[0],I=$t.find(m=>m.id===Number.MIN_SAFE_INTEGER)??$t[0],p="PlayFirst";e(b)==="FtkChallenge"?w=qt.filter(m=>m.npcType==="FtkChallenge").find(m=>m.difficulty===T.previousDifficulty)??w:e(b)==="Free"&&(w=qt.find(m=>m.id===T.previousNpcId)??w,I=$t.slice(-1)[0],p=T.previousStartMode),w.npcType!=="FtkChallenge"&&T.previousNpcDeckId>-1?I=(await e(A)).find(m=>m.id===T.previousNpcDeckId)??I:I=$t.find(m=>m.id===w.id)??I,D(c,new fr(T,"Player",h,[],w,"NPC",I,[],p)),e(c).onDuelEnd.append(()=>(D(c,e(c)),"RemoveMe"))},k=async()=>{await Promise.all([te(),Te()]),D(d,"DeckEdit")},K=async h=>{await te(),h.key==="Enter"&&!h.repeat&&(await R).save()},ae=()=>{D(A,ne()),D(c,void 0),D(d,"None")};let we=Date.now();const Z=h=>{Date.now()-we<200||(we=Date.now(),D(b,h),ne())},_e=h=>{V(Number(h.currentTarget.value))},V=h=>{var T;D(x,qt.find(w=>w.id===h)),D(P,((T=e(x))==null?void 0:T.description)??"")};Te(),it();var ge=xn(),X=s(a(ge),2),z=a(X),se=s(X,2);{var oe=h=>{var T=Me(),w=U(T);ht(w,()=>R,null,(I,p)=>{ti(I,{get duel(){return e(c)},get userProfile(){return e(p)}})}),r(h,T)},he=h=>{var T=Me(),w=U(T);{var I=m=>{Ji(m,{})},p=m=>{var ve=mn(),ue=a(ve),xe=a(ue),de=a(xe);ht(de,()=>R,me=>{var E=gn();r(me,E)},(me,E)=>{var B=pn(),ce=U(B),Ce=a(ce),Ke=a(Ce),Oe=s(Ce),Be=a(Oe),Ne=a(Be),ze=s(ce,2);ht(ze,()=>e(A),g=>{var N=un();r(g,N)},(g,N)=>{var be=_n(),je=U(be),O=a(je),De=a(O),Ye=s(O),Re=a(Ye);ie(Re,5,()=>Ta,le,(Fe,Ue)=>{var Xe=an(),Qe=U(Xe),_t=s(Qe,2),kt=a(_t);u(pt=>{gt(Qe,"id",`game_mode_radio_${pt??""}`),pr(Qe,e(Ue)),gr(Qe,e(b)===e(Ue)),Ae(_t,`game_mode_tab_label game_mode_tab_${pt??""} svelte-abgng1`),gt(_t,"for",`game_mode_radio_${pt??""}`),f(kt,e(Ue))},[()=>e(Ue).toLowerCase()],fe),ye("change",Qe,()=>Z(e(Ue))),r(Fe,Xe)});var Ie=s(je,2),We=a(Ie),vt=a(We),dt=s(We),tt=a(dt),$e=a(tt);u(()=>{e(q),At(()=>{e(b),e(N)})}),ie($e,5,()=>e(b)==="FtkChallenge"?$t.filter(Fe=>Fe.deckType==="Preset"):e(N),le,(Fe,Ue)=>{var Xe=rn(),Qe={},_t=a(Xe);u(()=>{Qe!==(Qe=e(Ue).id)&&(Xe.value=(Xe.__value=e(Ue).id)==null?"":e(Ue).id),f(_t,e(Ue).name)}),r(Fe,Xe)});var He=s(Ie,2);{var qe=Fe=>{var Ue=vn(),Xe=U(Ue),Qe=a(Xe),_t=a(Qe),kt=s(Qe),pt=a(kt),jt=a(pt);u(()=>{e(E),At(()=>{})}),ie(jt,5,()=>qt,le,(ut,et)=>{var ot=sn(),Ct={},Et=a(ot);u(()=>{Ct!==(Ct=e(et).id)&&(ot.value=(ot.__value=e(et).id)==null?"":e(et).id),f(Et,e(et).name)}),r(ut,ot)});var Ut=s(jt,2),Pt=a(Ut),Nt=s(Xe,2);{var It=ut=>{var et=ln(),ot=a(et),Ct=a(ot),Et=s(ot),ga=a(Et),ma=a(ga);u(()=>{e(E),At(()=>{e(N)})});var ea=a(ma);ea.value=(ea.__value=Number.MIN_SAFE_INTEGER)==null?"":Number.MIN_SAFE_INTEGER;var Fa=s(ea);ie(Fa,1,()=>e(N),le,(ta,Rt)=>{var Wt=nn(),ba={},Ha=a(Wt);u(()=>{ba!==(ba=e(Rt).id)&&(Wt.value=(Wt.__value=e(Rt).id)==null?"":e(Rt).id),f(Ha,e(Rt).name)}),r(ta,Wt)}),ee(3,Ct,()=>pe,()=>({duration:200})),ee(3,ot,()=>pe,()=>({duration:200})),Yt(ma,()=>e(E).previousNpcDeckId,ta=>e(E).previousNpcDeckId=ta),ee(3,ga,()=>pe,()=>({duration:200})),ee(3,Et,()=>pe,()=>({duration:200})),ee(3,et,()=>pe,()=>({duration:200})),r(ut,et)};y(Nt,ut=>{var et;((et=e(x))==null?void 0:et.npcType)!=="FtkChallenge"&&ut(It)})}var xt=s(Nt,2),wt=a(xt),Ot=a(wt),Lt=s(wt),fa=a(Lt),pa=a(fa);u(()=>{e(E),At(()=>{})}),ie(pa,5,()=>oa(ja),le,(ut,et)=>{var ot=on(),Ct={},Et=a(ot);u(()=>{Ct!==(Ct=e(et))&&(ot.value=(ot.__value=e(et))==null?"":e(et)),f(Et,ja[e(et)])}),r(ut,ot)}),u(()=>f(Pt,`※${e(P)??""}`)),ee(3,_t,()=>pe,()=>({duration:200})),ee(3,Qe,()=>pe,()=>({duration:200})),ye("change",jt,_e),Yt(jt,()=>e(E).previousNpcId,ut=>e(E).previousNpcId=ut),ee(3,pt,()=>pe,()=>({duration:200})),ee(3,kt,()=>pe,()=>({duration:200})),ee(3,Xe,()=>pe,()=>({duration:200})),ee(3,Ot,()=>pe,()=>({duration:200})),ee(3,wt,()=>pe,()=>({duration:200})),Yt(pa,()=>e(E).previousStartMode,ut=>e(E).previousStartMode=ut),ee(3,fa,()=>pe,()=>({duration:200})),ee(3,Lt,()=>pe,()=>({duration:200})),ee(3,xt,()=>pe,()=>({duration:200})),r(Fe,Ue)},Ve=Fe=>{var Ue=Me(),Xe=U(Ue);{var Qe=_t=>{var kt=cn(),pt=a(kt),jt=a(pt),Ut=s(pt),Pt=a(Ut),Nt=a(Pt);u(()=>{e(E),At(()=>{})}),ie(Nt,5,()=>mr,le,(It,xt)=>{var wt=dn(),Ot={},Lt=a(wt);u(()=>{Ot!==(Ot=e(xt))&&(wt.value=(wt.__value=e(xt))==null?"":e(xt)),f(Lt,e(xt))}),r(It,wt)}),ee(3,jt,()=>pe,()=>({duration:200})),ee(3,pt,()=>pe,()=>({duration:200})),Yt(Nt,()=>e(E).previousDifficulty,It=>e(E).previousDifficulty=It),ee(3,Pt,()=>pe,()=>({duration:200})),ee(3,Ut,()=>pe,()=>({duration:200})),ee(3,kt,()=>pe,()=>({duration:200})),r(_t,kt)};y(Xe,_t=>{e(b)==="FtkChallenge"&&_t(Qe)},!0)}r(Fe,Ue)};y(He,Fe=>{e(b)==="Free"?Fe(qe):Fe(Ve,!1)})}var Je=s(He,2),lt=a(Je),yt=a(lt),Ge=a(yt);ee(3,De,()=>pe,()=>({duration:200})),ee(3,O,()=>pe,()=>({duration:200})),ee(3,Re,()=>pe,()=>({duration:200})),ee(3,Ye,()=>pe,()=>({duration:200})),ee(3,je,()=>pe,()=>({duration:200})),ee(3,vt,()=>pe,()=>({duration:200})),ee(3,We,()=>pe,()=>({duration:200})),Yt($e,()=>e(q),Fe=>D(q,Fe)),ee(3,tt,()=>pe,()=>({duration:200})),ee(3,dt,()=>pe,()=>({duration:200})),ee(3,Ie,()=>pe,()=>({duration:200})),ye("click",Ge,S),ee(3,yt,()=>pe,()=>({duration:200})),r(g,be)});var j=s(ze,2);{var C=g=>{var N=fn(),be=a(N),je=a(be),O=a(je);ye("click",O,k),ee(3,je,()=>pe,()=>({duration:200})),ee(3,be,()=>pe,()=>({duration:200})),ee(3,N,()=>pe,()=>({duration:200})),r(g,N)};y(j,g=>{e(b)==="Free"&&g(C)})}ee(3,Ke,()=>pe,()=>({duration:200})),ee(3,Ce,()=>pe,()=>({duration:200})),sa(Ne,()=>e(E).name,g=>e(E).name=g),ye("keypress",Ne,K),ee(3,Be,()=>pe,()=>({duration:200})),ee(3,Oe,()=>pe,()=>({duration:200})),ee(3,ce,()=>pe,()=>({duration:200})),r(me,B)}),r(m,ve)};y(w,m=>{e(d)==="DeckEdit"?m(I):m(p,!1)},!0)}r(h,T)};y(se,h=>{e(c)?h(oe):h(he,!1)})}var H=s(se,2),M=a(H),G=a(M),J=s(M,2),Ee=a(J),$=s(J,2),Q=a($),re=s(H,2);{var Se=h=>{var T=wn(),w=a(T);{var I=E=>{var B=Me(),ce=U(B);{var Ce=Oe=>{var Be=bn();r(Oe,Be)},Ke=Oe=>{var Be=Me(),Ne=U(Be);{var ze=j=>{var C=hn();r(j,C)};y(Ne,j=>{e(c).winner.seat==="Above"&&j(ze)},!0)}r(Oe,Be)};y(ce,Oe=>{e(c).winner.seat==="Below"?Oe(Ce):Oe(Ke,!1)})}r(E,B)},p=E=>{var B=yn();r(E,B)};y(w,E=>{e(c).winner?E(I):E(p,!1)})}var m=s(w,2),ve=a(m),ue=s(m,2);{var xe=E=>{var B=kn(),ce=a(B);u(()=>gt(ce,"href",`https://x.com/share?url=${l}&text=${e(c).twitterShareText??""}&hashtags=${L}&via=${F}`)),r(E,B)};y(ue,E=>{e(c).twitterShareText&&E(xe)})}var de=s(ue,2),me=a(de);u(()=>f(ve,e(c).reasonOfEnd)),ye("click",me,ae),ee(3,T,()=>yr,()=>({delay:200,duration:200})),r(h,T)};y(re,h=>{e(c)&&e(c).isEnded&&h(Se)})}u(()=>{f(G,"build at: 20251127_225344"),f(Ee,ur.text),f(Q,`w:${e(v)??""}px h:${e(_)??""}px`)}),Kt("innerWidth",h=>D(v,h)),Kt("innerHeight",h=>D(_,h)),ye("click",z,ae),r(o,ge),nt()}br(Cn,{target:document.getElementById("app")});
