var Fa=Object.defineProperty;var ga=n=>{throw TypeError(n)};var Ha=(n,i,t)=>i in n?Fa(n,i,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[i]=t;var Ze=(n,i,t)=>Ha(n,typeof i!="symbol"?i+"":i,t),ma=(n,i,t)=>i.has(n)||ga("Cannot "+t);var it=(n,i,t)=>(ma(n,i,"read from private field"),t?t.call(n):i.get(n)),Nt=(n,i,t)=>i.has(n)?ga("Cannot add the same private member more than once"):i instanceof WeakSet?i.add(n):i.set(n,t),Jt=(n,i,t,d)=>(ma(n,i,"write to private field"),d?d.call(n,t):i.set(n,t),t);import{s as ha,r as Pa,a as k,b as Ua,l as ja,g as e,d as Ya,p as ot,c as Re,m as De,i as nt,t as o,e as a,f as y,h as u,j as xe,k as Ye,n as ht,o as Ce,q as r,u as vt,v as Oe,S as Oa,w as Ae,x as O,y as s,z as oe,D as Ct,A as Z,B as ne,C as f,E as La,F as lt,G as ia,H as Ra,I as Wa,J as Dt,K as gt,L as la,M as zt,N as oa,O as Gt,P as na,Q as Xt,R as Vt,T as Ka,U as za,V as Ga,W as Xa,X as Va,Y as Qa,Z as Za,_ as Lt,$ as mt,a0 as Rt,a1 as ea,a2 as Ba,a3 as Ja,a4 as er,a5 as tr,a6 as ar,a7 as rr,a8 as ut,a9 as sr,aa as ir,ab as lr,ac as ba,ad as ya,ae as wa,af as ka,ag as xa,ah as Ca,ai as Et,aj as qt,ak as ta,al as Da,am as or,an as kt,ao as nr,ap as vr,aq as $a,ar as Tt,as as xt,at as dr,au as cr,av as _r,aw as ur,ax as Sa,ay as fr,az as pr}from"../chunk/entity_proc_20250608_171917.js";import"../chunk/json_20250608_171917.js";(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const _ of document.querySelectorAll('link[rel="modulepreload"]'))d(_);new MutationObserver(_=>{for(const c of _)if(c.type==="childList")for(const g of c.addedNodes)g.tagName==="LINK"&&g.rel==="modulepreload"&&d(g)}).observe(document,{childList:!0,subtree:!0});function t(_){const c={};return _.integrity&&(c.integrity=_.integrity),_.referrerPolicy&&(c.referrerPolicy=_.referrerPolicy),_.crossOrigin==="use-credentials"?c.credentials="include":_.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function d(_){if(_.ep)return;_.ep=!0;const c=t(_);fetch(_.href,c)}})();const gr=n=>n;function va(n){const i=n-1;return i*i*i+1}function Ma(n){const i=typeof n=="string"&&n.match(/^\s*(-?[\d.]+)([^\s]*)\s*$/);return i?[parseFloat(i[1]),i[2]||"px"]:[n,"px"]}function mr(n,{delay:i=0,duration:t=400,easing:d=gr}={}){const _=+getComputedStyle(n).opacity;return{delay:i,duration:t,easing:d,css:c=>`opacity: ${c*_}`}}function hr(n,{delay:i=0,duration:t=400,easing:d=va,x:_=0,y:c=0,opacity:g=0}={}){const v=getComputedStyle(n),M=+v.opacity,N=v.transform==="none"?"":v.transform,w=M*(1-g),[l,I]=Ma(_),[A,z]=Ma(c);return{delay:i,duration:t,easing:d,css:(F,Y)=>`
			transform: ${N} translate(${(1-F)*l}${I}, ${(1-F)*A}${z});
			opacity: ${M-w*Y}`}}function ge(n,{delay:i=0,duration:t=400,easing:d=va,axis:_="y"}={}){const c=getComputedStyle(n),g=+c.opacity,v=_==="y"?"height":"width",M=parseFloat(c[v]),N=_==="y"?["top","bottom"]:["left","right"],w=N.map(T=>`${T[0].toUpperCase()}${T.slice(1)}`),l=parseFloat(c[`padding${w[0]}`]),I=parseFloat(c[`padding${w[1]}`]),A=parseFloat(c[`margin${w[0]}`]),z=parseFloat(c[`margin${w[1]}`]),F=parseFloat(c[`border${w[0]}Width`]),Y=parseFloat(c[`border${w[1]}Width`]);return{delay:i,duration:t,easing:d,css:T=>`overflow: hidden;opacity: ${Math.min(T*20,1)*g};${v}: ${T*M}px;padding-${N[0]}: ${T*l}px;padding-${N[1]}: ${T*I}px;margin-${N[0]}: ${T*A}px;margin-${N[1]}: ${T*z}px;border-${N[0]}-width: ${T*F}px;border-${N[1]}-width: ${T*Y}px;min-${v}: 0`}}function Ta(n,i){for(const t in i)n[t]=i[t];return n}function br({fallback:n,...i}){const t=new Map,d=new Map;function _(g,v,M){const{delay:N=0,duration:w=m=>Math.sqrt(m)*30,easing:l=va}=Ta(Ta({},i),M),I=g.getBoundingClientRect(),A=v.getBoundingClientRect(),z=I.left-A.left,F=I.top-A.top,Y=I.width/A.width,T=I.height/A.height,te=Math.sqrt(z*z+F*F),de=getComputedStyle(v),Be=de.transform==="none"?"":de.transform,D=+de.opacity;return{delay:N,duration:typeof w=="function"?w(te):w,easing:l,css:(m,P)=>`
			   opacity: ${m*D};
			   transform-origin: top left;
			   transform: ${Be} translate(${P*z}px,${P*F}px) scale(${m+(1-m)*Y}, ${m+(1-m)*T});
		   `}}function c(g,v,M){return(N,w)=>(g.set(w.key,N),()=>{if(v.has(w.key)){const l=v.get(w.key);return v.delete(w.key),_(l,N,w)}return g.delete(w.key),n&&n(N,w,M)})}return[c(d,t,!1),c(t,d,!0)]}function Ea(n){return Object.prototype.toString.call(n)==="[object Date]"}function yr(n){return n}function aa(n){const i=n-1;return i*i*i+1}function ra(n,i){if(n===i||n!==n)return()=>n;const t=typeof n;if(t!==typeof i||Array.isArray(n)!==Array.isArray(i))throw new Error("Cannot interpolate values of different type");if(Array.isArray(n)){const d=i.map((_,c)=>ra(n[c],_));return _=>d.map(c=>c(_))}if(t==="object"){if(!n||!i)throw new Error("Object cannot be null");if(Ea(n)&&Ea(i)){const c=n.getTime(),v=i.getTime()-c;return M=>new Date(c+M*v)}const d=Object.keys(i),_={};return d.forEach(c=>{_[c]=ra(n[c],i[c])}),c=>{const g={};return d.forEach(v=>{g[v]=_[v](c)}),g}}if(t==="number"){const d=i-n;return _=>n+_*d}return()=>i}var pt,At,It,$t;const da=class da{constructor(i,t={}){Nt(this,pt,ha(void 0));Nt(this,At,ha(void 0));Nt(this,It);Nt(this,$t,null);it(this,pt).v=it(this,At).v=i,Jt(this,It,t)}static of(i,t){const d=new da(i(),t);return Pa(()=>{d.set(i())}),d}set(i,t){var l;k(it(this,At),i);let{delay:d=0,duration:_=400,easing:c=yr,interpolate:g=ra}={...it(this,It),...t};if(_===0)return(l=it(this,$t))==null||l.abort(),k(it(this,pt),i),Promise.resolve();const v=Ua.now()+d;let M,N=!1,w=it(this,$t);return Jt(this,$t,ja(I=>{if(I<v)return!0;if(!N){N=!0;const z=it(this,pt).v;M=g(z,i),typeof _=="function"&&(_=_(z,i)),w==null||w.abort()}const A=I-v;return A>_?(k(it(this,pt),i),!1):(k(it(this,pt),M(c(A/_))),!0)})),it(this,$t).promise}get current(){return e(it(this,pt))}get target(){return e(it(this,At))}set target(i){this.set(i)}};pt=new WeakMap,At=new WeakMap,It=new WeakMap,$t=new WeakMap;let Wt=da;var wr=o('<div class="phase_display svelte-1ycsdg6"><span class="svelte-1ycsdg6"> </span> </div>'),kr=o('<div class="lifepoint_display svelte-1ycsdg6"><div class="svelte-1ycsdg6"> </div> <div class="svelte-1ycsdg6"> </div></div>'),xr=(n,i,t)=>i(e(t)),Cr=o('<div class="svelte-1ycsdg6"><button class="phase_button svelte-1ycsdg6"> </button></div>'),Dr=o("<div><!></div>"),$r=o('<div class="svelte-1ycsdg6"><!></div>'),Sr=o("<div><!></div>"),Mr=o('<div class="config_button_wrapper svelte-1ycsdg6"><button id="config_button" class="svelte-1ycsdg6">⚙</button></div>'),Tr=o("<!> <!> <!> <!>",1),Er=o('<div style="position: absolute;" class="card_animation_receiver svelte-1ycsdg6"><!></div>'),qr=o('<div style="position: absolute; top:0rem" class="svelte-1ycsdg6">｛効果対象｝</div>'),Ar=o('<!> <div style="position: absolute; display:flex;justify-content: center;"><!></div>',1),Yr=o(" <!> 】",1),Br=o('<div style="position: absolute; bottom:0rem" class="svelte-1ycsdg6"> <!></div>'),Nr=o("<!> <!>",1),Ir=o('<div class="badge svelte-1ycsdg6"> </div>'),Fr=o('<div class="card_animation_receiver svelte-1ycsdg6"><!></div>'),Hr=o("<!> <!> <!> <!>",1),Pr=o('<td><div role="listitem"><!></div></td>');function Ur(n,i){ot(i,!1);let t=Re(i,"view",12),d=Re(i,"row",8),_=Re(i,"column",8),c=Re(i,"selectedEntities",28,()=>[]),g=Re(i,"selectedCells",28,()=>[]),v=De(t().getCell(d(),_())),M=De(new Wt(e(v).field.duel.duelists.Above.lp,{duration:400,easing:aa})),N=De(new Wt(e(v).field.duel.duelists.Below.lp,{duration:400,easing:aa}));const w=()=>{k(v,t().getCell(d(),_())),Oe(M,e(M).target=e(v).field.duel.duelists.Above.lp),Oe(N,e(N).target=e(v).field.duel.duelists.Below.lp)};e(v).onUpdate.append(w),t().onDuelUpdate.append(w),t().modalController.onUpdate.append(w);let l,I=De([]),A=()=>console.log("hoge"),z,F=De([]),Y=De(!1),T=De(!1),te=!1;const de=$=>{var p,C;k(ve,[]),c().reset(),l=$.activator,A=$.resolve,k(I,$.dummyActionInfos),k(F,$.chainBlockInfos.flatMap(G=>G.selectedEntities).getDistinct()),z=$.entitiesChoices,k(Y,!1),k(T,((p=$.cellsChoices)==null?void 0:p.selectables.includes(e(v)))??!1),te=e(T)&&((C=$.cellsChoices)==null?void 0:C.qty)===1,w()};t().onWaitStart.append(de);const Be=()=>{l=void 0,k(I,[]),A=()=>{console.log("hoge")},z=void 0,k(F,[]),k(Y,!1),k(T,!1),te=!1};t().onWaitEnd.append(Be);let D=De(!1),m=[];const P=$=>{m=$.filter(p=>p.dests.includes(e(v))),k(D,m.length>0),w()},ee=()=>{m=[],k(D,!1),w()};t().onDragStart.append(P),t().onDragEnd.append(ee);const[$e,V]=Hs;let ve=De([]);const X=$=>{if(l=void 0,e(v)===$.to||e(v).entities.includes($.entity)){k(ve,[...e(ve),$]);const p=$.resolve;k(v,e(v)),setTimeout(()=>{k(ve,e(ve).filter(C=>C!==$)),$.count++,$.count>1&&p()},600)}};t().onAnimation.append(X);const me=$=>{A({phaseChange:$})},W=()=>e(v).isStackCell&&e(v).entities.flatMap($=>$.actions).filter($=>e(I).map(p=>p.action.seq).some(p=>p===$.seq)).length>0,U=$=>{var p;if(((p=$.target)==null?void 0:p.id)==="config_button"){t(t().infoBoardState="Config",!0),t().requireUpdate();return}if(t(t().infoBoardState="Default",!0),te)A({selectedCells:[e(v)]});else if(e(T))k(Y,!e(Y)),g(e(Y)?[...g(),e(v)]:g().filter(C=>C!==e(v)));else if(e(v).isStackCell){t(t().infoBoardState="CellInfo",!0),t(t().infoBoardCell=e(v),!0),t().requireUpdate();const C=e(v).entities.flatMap(H=>H.actions).map(H=>H.seq),G=e(I).filter(H=>C.includes(H.action.seq));if(G.length){if(!l)return;t().modalController.actionSelector.show({title:"カードを選択。",position:"Bottom",activator:l,dummyActionInfos:G,cancelable:!0}).then(H=>{H&&A({actionInfo:H})});return}}t().requireUpdate(),console.info(e(v),he(...e(v).visibleEntities))},ae=$=>{$.preventDefault(),$.dataTransfer&&($.dataTransfer.dropEffect="move")},re=$=>{$.preventDefault(),console.info("drop",$,e(D),m),$.dataTransfer&&($.dataTransfer.dropEffect="move");try{if(e(D)&&m){if(m.length===1){const p=m[0];A({actionInfo:{...p,dest:e(v)}})}else if(m.length>1){if(!l)throw new Oa("想定されない状態");e(v).field.duel.view.modalController.terminateAll(),e(v).field.duel.view.modalController.actionSelector.show({title:"選択",position:"Bottom",activator:l,dummyActionInfos:m.map(p=>({...p,dest:e(v)})),cancelable:!1}).then(p=>{A({actionInfo:p})})}}}finally{t().removeDraggingActions()}},he=(...$)=>{if(t().waitMode==="Animation")return"Disabled";if(z&&z.selectables.find(C=>$.find(G=>C===G)))return"Selectable";if(!e(I)||e(I).length===0||t().waitMode!=="Free"||Object.values(t().modalController.modals).some(C=>C.state==="Shown"))return"Disabled";const p=e(I).filter(C=>$.includes(C.action.entity));return p.length===0?"Disabled":e(v).isStackCell||p[0].action.entity!==$[0]?"Clickable":p.some(C=>C.dests.length)?"Draggable":"Clickable"};nt();var L=Pr(),E=a(L);E.__click=U;var R=a(E);{var se=$=>{var p=Ae(),C=O(p);{var G=H=>{var ie=Ae(),x=O(ie);{var ue=S=>{var ce=wr(),be=a(ce),Q=a(be),fe=s(be,1,!0);u((_e,J)=>{f(Q,_e),f(fe,J)},[()=>String(e(v).field.duel.clock.turn).padStart(2,"0"),()=>e(v).field.duel.phase.toUpperCase()],xe),r(S,ce)},h=S=>{var ce=Ae(),be=O(ce);{var Q=_e=>{var J=kr(),K=a(J),ye=a(K),Se=s(K,2),Ke=a(Se);u((qe,le)=>{f(ye,qe),f(Ke,le)},[()=>Math.floor(e(M).current),()=>Math.floor(e(N).current)],xe),r(_e,J)},fe=_e=>{var J=Ae(),K=O(J);{var ye=Se=>{var Ke=Ae(),qe=O(Ke);{var le=we=>{var Te=Ae(),b=O(Te);{var q=B=>{var pe=Ae(),Fe=O(pe);oe(Fe,1,()=>t().duel.nextPhaseList,ne,(Le,j)=>{var ke=Cr(),Ee=a(ke);Ee.__click=[xr,me,j];var ze=a(Ee);u(He=>f(ze,He),[()=>e(j).toUpperCase()],xe),r(Le,ke)}),r(B,pe)};y(b,B=>{t().duel.isEnded||B(q)})}r(we,Te)};y(qe,we=>{t().waitMode==="Free"&&we(le)})}r(Se,Ke)};y(K,Se=>{e(v).column===5&&Se(ye)},!0)}r(_e,J)};y(be,_e=>{e(v).column===3?_e(Q):_e(fe,!1)},!0)}r(S,ce)};y(x,S=>{e(v).column===1?S(ue):S(h,!1)})}r(H,ie)};y(C,H=>{e(v).row===3&&H(G)})}r($,p)},Ne=$=>{var p=Ae(),C=O(p);{var G=ie=>{var x=Tr();const ue=xe(()=>e(ve).find(J=>J.to===e(v)));var h=O(x);{var S=J=>{var K=Dr(),ye=a(K);Ct(ye,{get entity(){return e(ue).entity},state:"Disabled",dummyActionInfos:[],cardActionResolve:void 0}),u(()=>Ye(K,`card_animation_receiver ${e(v).cellType??""} svelte-1ycsdg6`)),Z(1,K,()=>V,()=>({key:e(ue).entity.seq})),r(J,K)};y(h,J=>{e(ue)&&e(ue).index==="Top"&&J(S)})}var ce=s(h,2);oe(ce,1,()=>e(v).visibleEntities,ne,(J,K)=>{var ye=Ae(),Se=O(ye);{var Ke=qe=>{var le=$r(),we=a(le);const Te=xe(()=>he(e(K))),b=xe(()=>e(I).filter(q=>q.action.entity===e(K)));Ct(we,{get entity(){return e(K)},get state(){return e(Te)},get dummyActionInfos(){return e(b)},cardActionResolve:void 0,get selectedList(){return c()},set selectedList(q){c(q)},$$legacy:!0}),Z(2,le,()=>$e,()=>({key:e(K).seq})),r(qe,le)};y(Se,qe=>{e(ve).every(le=>le.entity.seq!==e(K).seq)&&qe(Ke)})}r(J,ye)});var be=s(ce,2);{var Q=J=>{var K=Sr(),ye=a(K);Ct(ye,{get entity(){return e(ue).entity},state:"Disabled",dummyActionInfos:[],cardActionResolve:void 0}),u(()=>Ye(K,`card_animation_receiver ${e(v).cellType??""} svelte-1ycsdg6`)),Z(1,K,()=>V,()=>({key:e(ue).entity.seq})),r(J,K)};y(be,J=>{e(ue)&&e(ue).index!=="Top"&&J(Q)})}var fe=s(be,2);{var _e=J=>{var K=Mr();r(J,K)};y(fe,J=>{e(v).owner.seat==="Below"&&J(_e)})}r(ie,x)},H=ie=>{var x=Hr();const ue=xe(()=>e(ve).find(K=>K.to===e(v)));var h=O(x);{var S=K=>{var ye=Er(),Se=a(ye);Ct(Se,{get entity(){return e(ue).entity},state:"Disabled",dummyActionInfos:[],cardActionResolve:void 0}),Z(1,ye,()=>V,()=>({key:e(ue).entity.seq})),r(K,ye)};y(h,K=>{e(ue)&&e(ue).index!=="Top"&&K(S)})}var ce=s(h,2);{var be=K=>{var ye=Nr(),Se=O(ye);oe(Se,1,()=>e(v).visibleEntities.map((le,we)=>({index:we,entity:le})).toReversed(),ne,(le,we)=>{var Te=Ae(),b=O(Te);{var q=B=>{var pe=Ar();const Fe=xe(()=>!e(v).isStackCell&&e(we).index===0?he(...e(v).visibleEntities):void 0);var Le=O(pe);{var j=He=>{var Ve=qr();r(He,Ve)};y(Le,He=>{e(F).includes(e(we).entity)&&He(j)})}var ke=s(Le,2),Ee=a(ke);const ze=xe(()=>e(we).index===0?e(I).filter(He=>e(v).visibleEntities.includes(He.action.entity)):void 0);Ct(Ee,{get entity(){return e(we).entity},get state(){return e(Fe)},get dummyActionInfos(){return e(ze)},cardActionResolve:void 0,get selectedList(){return c()},set selectedList(He){c(He)},$$legacy:!0}),u(()=>Ye(ke,`duel_card_wrapper ${(e(we).entity.exist?"duel_card_wrapper_exists":"")??""} svelte-1ycsdg6`)),Z(2,ke,()=>$e,()=>({key:e(we).entity.seq})),r(B,pe)};y(b,B=>{e(ve).every(pe=>pe.entity.seq!==e(we).entity.seq)&&B(q)})}r(le,Te)});var Ke=s(Se,2);{var qe=le=>{var we=Br(),Te=a(we),b=s(Te);oe(b,1,()=>ia(e(v).visibleEntities[0].status.maxCounterQty),ne,(q,B)=>{var pe=Yr(),Fe=O(pe),Le=s(Fe);{var j=ke=>{var Ee=lt();u(()=>f(Ee,`/${e(v).visibleEntities[0].status.maxCounterQty[e(B)]??""}`)),r(ke,Ee)};y(Le,ke=>{(e(v).visibleEntities[0].status.maxCounterQty[e(B)]??9999)<100&&ke(j)})}u((ke,Ee)=>f(Fe,`【
              ${ke??""}${Ee??""} `),[()=>La(e(B)),()=>e(v).visibleEntities[0].counterHolder.getQty(e(B))],xe),r(q,pe)}),u(()=>f(Te,`【${e(v).visibleEntities[0].battlePositionName??""}】 `)),r(le,we)};y(Ke,le=>{e(v).visibleEntities[0].battlePosition&&le(qe)})}r(K,ye)};y(ce,K=>{e(v).visibleEntities.length>0&&K(be)})}var Q=s(ce,2);{var fe=K=>{var ye=Ir(),Se=a(ye);u(()=>f(Se,e(v).visibleEntities.length)),r(K,ye)};y(Q,K=>{e(v).isStackCell&&K(fe)})}var _e=s(Q,2);{var J=K=>{var ye=Fr(),Se=a(ye);Ct(Se,{get entity(){return e(ue).entity},state:"Disabled",dummyActionInfos:[],cardActionResolve:void 0}),Z(1,ye,()=>V,()=>({key:e(ue).entity.seq})),r(K,ye)};y(_e,K=>{e(ue)&&e(ue).index==="Top"&&K(J)})}r(ie,x)};y(C,ie=>{e(v).cellType==="Hand"?ie(G):ie(H,!1)},!0)}r($,p)};y(R,$=>{e(v).isDisabledCell?$(se):$(Ne,!1)})}u($=>{Ye(L,`${`duel_field_cell duel_field_cell_${e(v).cellType} ${e(v).linkArrowSources.length===0?"":"duel_field_cell_linked"}`??""} svelte-1ycsdg6`),ht(L,"colspan",e(v).cellType==="Hand"?7:1),Ye(E,`${$??""} svelte-1ycsdg6`)},[()=>`duel_field_cell_inner_box ${e(v).cellType} ${e(D)?"can_accept_drop":""} ${W()?"can_action":""} ${e(Y)?"is_selected":e(T)?"is_selectable":""} `],xe),Ce("dragover",E,ae),Ce("drop",E,re),r(n,L),vt()}Ya(["click"]);var jr=o('<div class="title svelte-14z6bdh"> </div>'),Or=o('<div class="title svelte-14z6bdh"> </div>'),Lr=o('<div class="duel_log_chain_number svelte-14z6bdh"> </div>'),Rr=o("<div><!></div>"),Wr=o('<div><div style="display: flex;    justify-content: space-between;"><div style=" white-space: nowrap;text-align: center;"> </div> <!></div> <!></div>'),Kr=o("<div><!> <!></div>"),zr=o("<div><!> <!></div>"),Gr=o('<div class="duel_log svelte-14z6bdh"><div class="duel_log_header svelte-14z6bdh"></div> <div class="duel_log_body svelte-14z6bdh"></div> <div class="duel_log_footer svelte-14z6bdh"></div></div>');function Xr(n,i){ot(i,!1);let t=De(void 0),d=Re(i,"log",8),_,c=De([]);const g=()=>{const w=((_==null?void 0:_.seq)??-1)+1;d().records.slice(w).forEach(l=>{if(!_){k(c,[[[[l]]]]),_=l;return}if(!e(c)[l.clock.turn]){Oe(c,e(c)[l.clock.turn]=[[[l]]]),_=l;return}if(!e(c)[l.clock.turn][l.clock.phaseSeq]){Oe(c,e(c)[l.clock.turn][l.clock.phaseSeq]=[[l]]),_=l;return}if(_.clock.chainSeq===l.clock.chainSeq&&_.clock.chainBlockSeq===l.clock.chainBlockSeq&&_.duelist===l.duelist){e(c)[l.clock.turn][l.clock.phaseSeq].slice(-1)[0].push(l),_=l;return}e(c)[l.clock.turn][l.clock.phaseSeq].push([l]),_=l}),k(c,e(c)),Ra().then(()=>e(t)&&e(t).scroll(0,e(t).clientHeight*990))};d().onUpdate.append(g),d().duel.view.onDuelUpdate.append(g),g(),nt();var v=Ae(),M=O(v);{var N=w=>{var l=Gr(),I=s(a(l),2);oe(I,5,()=>e(c),ne,(A,z)=>{var F=zr(),Y=a(F);{var T=de=>{var Be=jr(),D=a(Be);u(()=>f(D,`ターン：${e(z)[0][0][0].clock.turn??""}`)),r(de,Be)};y(Y,de=>{e(z)[0][0][0].clock.turn>0&&de(T)})}var te=s(Y,2);oe(te,1,()=>e(z),ne,(de,Be)=>{var D=Kr(),m=a(D);{var P=$e=>{var V=Or(),ve=a(V);u(()=>f(ve,e(Be)[0][0].clock.period.name)),r($e,V)};y(m,$e=>{e(Be)[0][0].clock.turn>0&&$e(P)})}var ee=s(m,2);oe(ee,1,()=>e(Be),ne,($e,V)=>{var ve=Wr();const X=xe(()=>{var L;return((L=e(V).find(E=>E.chainNumber!==void 0))==null?void 0:L.chainNumber)??0});var me=a(ve),W=a(me),U=a(W),ae=s(W,2);{var re=L=>{var E=Lr(),R=a(E);u(()=>f(R,`チェーン：${e(X)??""}`)),r(L,E)};y(ae,L=>{e(X)&&L(re)})}var he=s(me,2);oe(he,1,()=>e(V),ne,(L,E)=>{var R=Rr(),se=a(R);{var Ne=p=>{var C=lt();u(()=>f(C,e(E).text)),r(p,C)},$=p=>{var C=Ae(),G=O(C);{var H=x=>{var ue=lt();u((h,S,ce)=>f(ue,`移動：${h??""} ${S??""} ⇒ ${ce??""}`),[()=>{var h;return(h=e(E).mainEntity)==null?void 0:h.toString()},()=>{var h;return(h=e(E).from)==null?void 0:h.toString()},()=>{var h;return(h=e(E).to)==null?void 0:h.toString()}],xe),r(x,ue)},ie=x=>{var ue=Ae(),h=O(ue);{var S=be=>{var Q=lt();u((fe,_e)=>f(Q,`生成：${fe??""} void ⇒ ${_e??""}`),[()=>{var fe;return(fe=e(E).mainEntity)==null?void 0:fe.toString()},()=>{var fe;return(fe=e(E).to)==null?void 0:fe.toString()}],xe),r(be,Q)},ce=be=>{var Q=Ae(),fe=O(Q);{var _e=K=>{var ye=lt();u((Se,Ke)=>f(ye,`消滅：${Se??""} ${Ke??""} ⇒ void`),[()=>{var Se;return(Se=e(E).mainEntity)==null?void 0:Se.toString()},()=>{var Se;return(Se=e(E).from)==null?void 0:Se.toString()}],xe),r(K,ye)},J=K=>{var ye=lt();u(()=>f(ye,e(E).text)),r(K,ye)};y(fe,K=>{e(E).type==="EntityDisappear"?K(_e):K(J,!1)},!0)}r(be,Q)};y(h,be=>{e(E).type==="EntityAppear"?be(S):be(ce,!1)},!0)}r(x,ue)};y(G,x=>{e(E).type==="EntityMove"?x(H):x(ie,!1)},!0)}r(p,C)};y(se,p=>{e(E).type==="ChainBlockHeader"?p(Ne):p($,!1)})}u(p=>Ye(R,`duel_log_record duel_log_record_${p??""} svelte-14z6bdh`),[()=>e(E).type.toSnakeCase()],xe),r(L,R)}),u(()=>{var L,E,R;Ye(ve,`duel_log_block_duelist duel_log_block_duelist_${((L=e(V)[0].duelist)==null?void 0:L.seat)??"system"} svelte-14z6bdh`),Ye(W,`duelist ${((E=e(V)[0].duelist)==null?void 0:E.seat)??""} svelte-14z6bdh`),f(U,((R=e(V)[0].duelist)==null?void 0:R.profile.name)||"SYSTEM")}),r($e,ve)}),u(()=>Ye(D,`duel_log_block_phase duel_log_block_phase_${e(Be)[0][0].clock.period.key??""} svelte-14z6bdh`)),r(de,D)}),u(()=>Ye(F,`duel_log_block_turn duel_log_block_turn_${e(z)[0][0][0].clock.turn??""} svelte-14z6bdh`)),r(A,F)}),Wa(I,A=>k(t,A),()=>e(t)),r(w,l)};y(M,w=>{(d().duel.view.infoBoardState==="Log"||d().duel.view.infoBoardState==="Default")&&w(N)})}r(n,v),vt()}var Vr=o("<div><div> </div> <div> </div></div>");function qa(n,i){ot(i,!1);let t=Re(i,"duelist",12),d=De(0),_=De();const c=async()=>{const I=t().lp-e(d);if(!e(_)||Math.abs(I)<10){k(d,t().lp),e(_)&&(e(_)(),k(_,void 0));return}k(d,e(d)+Math.floor(Math.random()*I)),await Dt(100),c()},g=()=>{t(t()),!e(_)&&t().lp!==e(d)&&new Promise(I=>{k(_,I),Math.abs(t().lp-e(d)),c()})};t().duel.log.onUpdate.append(g),c(),nt();var v=Vr(),M=a(v),N=a(M),w=s(M,2),l=a(w);u(I=>{Ye(v,`duelist duelist_${I??""} svelte-1sy3trd`),Ye(M,`duelist_name duelist_${I??""}_name svelte-1sy3trd`),f(N,t().profile.name),Ye(w,`duelist_lp ${(e(_)?"vibration":"")??""} svelte-1sy3trd`),f(l,e(d))},[()=>t().seat.toLowerCase()],xe),r(n,v),vt()}const Qr=(n,i,t)=>(i(i()==="Normal"?"Debug":"Normal"),console.info(t()),!0);var Zr=o('<div class="duel_card_info_row svelte-19vwcsh" style=" justify-content: space-between;"><div class="svelte-19vwcsh"> </div> <div class="svelte-19vwcsh"> </div></div>'),Jr=o('<div></div> <div class="svelte-19vwcsh"> </div>',1),es=o("<div> </div>"),ts=o("<div> </div>"),as=o('<div class="duel_card_info_row svelte-19vwcsh"><!> <!></div> <div class="duel_card_info_row svelte-19vwcsh"></div>',1),rs=o('<div class="duel_card_row svelte-19vwcsh"><div class="svelte-19vwcsh"></div> <div class="svelte-19vwcsh"> </div></div>'),ss=o('<div class="duel_card_row svelte-19vwcsh"><div class="svelte-19vwcsh"></div> <div class="svelte-19vwcsh"> </div></div>'),is=o("<!> <!>",1),ls=o('<div class="duel_card_info_row svelte-19vwcsh" style="border-style: solid; border-width: 1px;"><pre class="description svelte-19vwcsh"> </pre></div>'),os=o('<!> <div class="duel_card_info_row svelte-19vwcsh"><pre class="description svelte-19vwcsh"> </pre></div>',1),ns=o("[ <!> ],",1),vs=o('<div class="svelte-19vwcsh"> <!></div>'),ds=o('<div class="svelte-19vwcsh"> </div> <!> <div class="svelte-19vwcsh"></div>',1),cs=o('<div class="svelte-19vwcsh"> </div>'),_s=o('<div class="svelte-19vwcsh"> </div>'),us=o('<div class="svelte-19vwcsh"> </div>'),fs=o('<div class="svelte-19vwcsh"> </div>'),ps=o('<div class="svelte-19vwcsh"> </div>'),gs=o('<div class="svelte-19vwcsh"> </div>'),ms=o('<div class="duel_card_info_row svelte-19vwcsh"><div class="svelte-19vwcsh"><!> <div class="svelte-19vwcsh"></div> <!> <div class="svelte-19vwcsh"></div> <div class="svelte-19vwcsh"></div> <!> <div class="svelte-19vwcsh"></div> <div class="svelte-19vwcsh"></div> <!> <div class="svelte-19vwcsh"></div> <div class="svelte-19vwcsh"></div> <!> <div class="svelte-19vwcsh"></div> <div class="svelte-19vwcsh"></div> <!> <div class="svelte-19vwcsh"></div> <div class="svelte-19vwcsh"></div> <!> <div class="svelte-19vwcsh"></div> <div class="svelte-19vwcsh"></div> <div class="svelte-19vwcsh"> </div> <div class="svelte-19vwcsh"> </div> <div class="svelte-19vwcsh"> </div> <div class="svelte-19vwcsh"></div></div></div>'),hs=o('<div class="svelte-19vwcsh">※テスト用カードです</div>'),bs=o('<div class="duel_card_info_links svelte-19vwcsh"><a target="_blank" rel="noopener noreferrer" title="遊戯王カードWiki" class="svelte-19vwcsh">⇒遊戯王カードWiki</a> <a target="_blank" rel="noopener noreferrer" title="コナミカードデータベース" class="svelte-19vwcsh"> </a></div>'),ys=o('<div role="contentinfo"><div class="duel_card_info_header svelte-19vwcsh"><div class="duel_card_info_row svelte-19vwcsh"><div class="svelte-19vwcsh"> </div></div> <div class="duel_card_info_row svelte-19vwcsh" style="position:sticky; top:0;"><div class="svelte-19vwcsh"> </div> <div class="svelte-19vwcsh"> </div></div> <!></div> <div class="duel_card_info_body svelte-19vwcsh"><!></div> <div class="duel_card_info_footer svelte-19vwcsh"><!></div></div>');function ws(n,i){ot(i,!1);let t=Re(i,"entity",8,void 0);const d=()=>t()?gt[t().origin.name]:void 0,_=()=>{var N;return t()&&(t().origin.cardId??!1)?`https://www.db.yugioh-card.com/yugiohdb/card_search.action?ope=2&cid=${t().origin.cardId}`:`https://www.db.yugioh-card.com/yugiohdb/card_search.action?ope=1&sess=1&rp=10&mode=&sort=1&keyword=${(N=d())==null?void 0:N.name}&stype=1&ctype=&othercon=2&starfr=&starto=&pscalefr=&pscaleto=&linkmarkerfr=&linkmarkerto=&link_m=2&atkfr=&atkto=&deffr=&defto=&releaseDStart=1&releaseMStart=1&releaseYStart=1999&releaseDEnd=&releaseMEnd=&releaseYEnd=`};let c=Re(i,"mode",12,"Normal");nt();var g=Ae(),v=O(g);{var M=N=>{var w=ys();w.__contextmenu=[Qr,c,t];var l=a(w),I=a(l),A=a(I),z=a(A),F=s(I,2),Y=a(F),T=a(Y),te=s(Y,2),de=a(te),Be=s(F,2);{var D=W=>{var U=is(),ae=O(U);{var re=R=>{var se=Zr(),Ne=a(se),$=a(Ne),p=s(Ne,2),C=a(p);u(()=>{f($,`◀ ${t().psL??""}`),f(C,`${t().psR??""} ▶`)}),r(R,se)};y(ae,R=>{var se;(se=t().status.monsterCategories)!=null&&se.includes("Pendulum")&&R(re)})}var he=s(ae,2);{var L=R=>{var se=as(),Ne=O(se),$=a(Ne);oe($,1,()=>t().attr,ne,(G,H)=>{var ie=Jr(),x=O(ie),ue=s(x,2),h=a(ue);u(()=>{Ye(x,`monster_attr ${e(H)??""} svelte-19vwcsh`),f(h,`${la[e(H)]??""}属性`)}),r(G,ie)});var p=s($,2);oe(p,1,()=>t().types,ne,(G,H)=>{var ie=es(),x=a(ie);u(()=>{Ye(ie,`monster_cat ${e(H)??""} svelte-19vwcsh`),f(x,`${zt[e(H)]??""}${oa[e(H)]??""}族`)}),r(G,ie)});var C=s(Ne,2);oe(C,5,()=>t().status.monsterCategories??[],ne,(G,H)=>{var ie=ts(),x=a(ie);u(()=>{Ye(ie,`monster_cat ${e(H)??""} svelte-19vwcsh`),f(x,`${Gt[e(H)]??""}${na[e(H)]??""}`)}),r(G,ie)}),r(R,se)},E=R=>{var se=Ae(),Ne=O(se);{var $=C=>{var G=rs(),H=s(a(G),2),ie=a(H);u(()=>f(ie,`${Xt[t().status.spellCategory]??""}魔法`)),r(C,G)},p=C=>{var G=Ae(),H=O(G);{var ie=x=>{var ue=ss(),h=s(a(ue),2),S=a(h);u(()=>f(S,`${Vt[t().status.trapCategory]??""}罠`)),r(x,ue)};y(H,x=>{t().kind==="Trap"&&t().status.trapCategory&&x(ie)},!0)}r(C,G)};y(Ne,C=>{t().kind==="Spell"&&t().status.spellCategory?C($):C(p,!1)},!0)}r(R,se)};y(he,R=>{t().kind==="Monster"?R(L):R(E,!1)})}r(W,U)};y(Be,W=>{c()==="Normal"&&W(D)})}var m=s(l,2),P=a(m);{var ee=W=>{var U=os(),ae=O(U);{var re=R=>{var se=ls(),Ne=a(se),$=a(Ne);u(()=>f($,gt[t().origin.name].pendulumDescription)),r(R,se)};y(ae,R=>{var se;(se=t().status.monsterCategories)!=null&&se.includes("Pendulum")&&R(re)})}var he=s(ae,2),L=a(he),E=a(L);u(R=>f(E,R),[()=>{var R;return(R=d())==null?void 0:R.description}],xe),r(W,U)},$e=W=>{var U=ms(),ae=a(U),re=a(ae);oe(re,0,()=>["info","status"],ne,(qe,le)=>{var we=ds(),Te=O(we),b=a(Te),q=s(Te,2);oe(q,1,()=>Object.entries(t()[le]),ne,(pe,Fe)=>{let Le=()=>e(Fe)[0],j=()=>e(Fe)[1];var ke=vs(),Ee=a(ke),ze=s(Ee);{var He=Je=>{var at=ns(),Qe=s(O(at));oe(Qe,1,j,ne,(Me,Ue)=>{var Ie=lt();u(et=>f(Ie,`${et??""},`),[()=>e(Ue).toString()],xe),r(Me,Ie)}),r(Je,at)},Ve=Je=>{var at=lt();u(Qe=>f(at,`${Qe??""},`),[()=>{var Qe;return(Qe=j())==null?void 0:Qe.toString()}],xe),r(Je,at)};y(ze,Je=>{Array.isArray(j())?Je(He):Je(Ve,!1)})}u(()=>f(Ee,`"${Le()??""}" : `)),r(pe,ke)});var B=s(q,2);B.textContent="},",u(()=>f(b,`"${le??""}" :{`)),r(qe,we)});var he=s(re,2);he.textContent='"actions" :[';var L=s(he,2);oe(L,1,()=>t().actions,ne,(qe,le)=>{var we=cs(),Te=a(we);u(()=>f(Te,`"${e(le).playType??""} ${e(le).title??""}",`)),r(qe,we)});var E=s(L,2);E.textContent="],";var R=s(E,2);R.textContent='"substituteEffects" :[';var se=s(R,2);oe(se,1,()=>t().substituteEffects,ne,(qe,le)=>{var we=_s(),Te=a(we);u(()=>f(Te,`"${e(le).title??""}",`)),r(qe,we)});var Ne=s(se,2);Ne.textContent="],";var $=s(Ne,2);$.textContent='"continuousEffects" :[';var p=s($,2);oe(p,1,()=>t().continuousEffects,ne,(qe,le)=>{var we=us(),Te=a(we);u(()=>f(Te,`"${e(le).isStarted??""}",`)),r(qe,we)});var C=s(p,2);C.textContent="],";var G=s(C,2);G.textContent='"procFilters" :[';var H=s(G,2);oe(H,1,()=>t().procFilterBundle.operators,ne,(qe,le)=>{var we=fs(),Te=a(we);u(b=>f(Te,`"${b??""} ${e(le).title??""} ${e(le).isEffective??""} ",`),[()=>e(le).isSpawnedBy.toString()],xe),r(qe,we)});var ie=s(H,2);ie.textContent="],";var x=s(ie,2);x.textContent='"numericStateOperators" :[';var ue=s(x,2);oe(ue,1,()=>t().numericOprsBundle.operators,ne,(qe,le)=>{var we=ps(),Te=a(we);u(b=>f(Te,`"${b??""} ${e(le).title??""} ${e(le).isEffective??""} ${e(le).isContinuous??""} ${e(le).targetState??""} ${e(le).targetStateGen??""} ",`),[()=>e(le).isSpawnedBy.toString()],xe),r(qe,we)});var h=s(ue,2);h.textContent="],";var S=s(h,2);S.textContent='"stateOperators" :[';var ce=s(S,2);oe(ce,1,()=>t().statusOperatorBundle.operators,ne,(qe,le)=>{var we=gs(),Te=a(we);u(b=>f(Te,`"${b??""} ${e(le).title??""} ${e(le).isEffective??""} ",`),[()=>e(le).isSpawnedBy.toString()],xe),r(qe,we)});var be=s(ce,2);be.textContent="],";var Q=s(be,2);Q.textContent='"lastMoveLogRecord" :{';var fe=s(Q,2),_e=a(fe),J=s(fe,2),K=a(J),ye=s(J,2),Se=a(ye),Ke=s(ye,2);Ke.textContent="},",u((qe,le)=>{f(_e,`"movedBy":"${qe??""}",`),f(K,`"movedAs":"${le??""}",`),f(Se,`"movedAt":"${t().moveLog.latestRecord.movedAt.totalProcSeq??""}",`)},[()=>{var qe;return(qe=t().moveLog.latestRecord.movedBy)==null?void 0:qe.toString()},()=>t().moveLog.latestRecord.movedAs.join(" ")],xe),r(W,U)};y(P,W=>{c()==="Normal"?W(ee):W($e,!1)})}var V=s(m,2),ve=a(V);{var X=W=>{var U=hs();r(W,U)},me=W=>{var U=bs(),ae=a(U),re=s(ae,2),he=a(re);u(L=>{var E;ht(ae,"href",`https://yugioh-wiki.net/index.php?${t().origin.wikiEncodedName}`),ht(re,"href",L),f(he,`⇒${((E=t())!=null&&E.origin.cardId?"公式カードページ":"公式で検索")??""}`)},[_],xe),r(W,U)};y(ve,W=>{var U;(U=t())!=null&&U.origin.isForTest?W(X):W(me,!1)})}u((W,U,ae)=>{Ye(w,`duel_card duel_card_info ${t().origin.kind??""} ${W??""} svelte-19vwcsh`),f(z,t().nm),f(T,U),f(de,ae)},[()=>{var W;return(W=t().origin.monsterCategories)==null?void 0:W.join(" ")},()=>"★".repeat(t().lvl||0),()=>"☆".repeat(t().rank||0)],xe),r(N,w)};y(v,N=>{t()&&N(M)})}r(n,g),vt()}Ya(["contextmenu"]);var ks=o('<div class="duel_field_cell_info_item svelte-1xj7qf1"><!></div>'),xs=o('<div class="duel_field_cell_info_box svelte-1xj7qf1"><div class="duel_field_cell_info_label svelte-1xj7qf1"> </div> <!></div>'),Cs=o('<div class="duel_field_cell_info svelte-1xj7qf1"><div class="duel_field_cell_info_header item_btn svelte-1xj7qf1"><div class="svelte-1xj7qf1"> </div> <div class="svelte-1xj7qf1"> </div></div> <div class="duel_field_cell_info_body svelte-1xj7qf1"></div></div>');function Ds(n,i){ot(i,!1);let t=Re(i,"cell",12);const d=()=>{t(t())},_=M=>t().cardEntities.filter(N=>N.face===M);t().field.duel.view.onDuelUpdate.append(d),nt();var c=Ae(),g=O(c);{var v=M=>{var N=Cs(),w=a(N),l=a(w),I=a(l),A=s(l,2),z=a(A),F=s(w,2);oe(F,4,()=>["FaceUp","FaceDown"],ne,(Y,T)=>{var te=Ae(),de=O(te);{var Be=D=>{var m=xs(),P=a(m),ee=a(P),$e=s(P,2);oe($e,1,()=>_(T).toSorted(Ka),ne,(V,ve)=>{var X=ks(),me=a(X);const W=xe(()=>t().owner===t().field.duel.duelists.Below);Ct(me,{get entity(){return e(ve)},get isVisibleForcibly(){return e(W)},isWideMode:!0,cardActionResolve:void 0}),r(V,X)}),u(()=>f(ee,T==="FaceUp"?"表向き":"裏向き")),r(D,m)};y(de,D=>{_(T).length&&D(Be)})}r(Y,te)}),u(()=>{var Y;f(I,(Y=t().owner)==null?void 0:Y.profile.name),f(z,t().cellType)}),r(M,N)};y(g,M=>{t().field.duel.view.infoBoardState==="CellInfo"&&M(v)})}r(n,c),vt()}var $s=o('<div class="duel_config_item svelte-y4u26k"><label class="toggle svelte-y4u26k"><input type="checkbox" class="svelte-y4u26k"></label> <span class="svelte-y4u26k"> </span></div>'),Ss=o('<div class="duel_config svelte-y4u26k"><div class="duel_config_title svelte-y4u26k">デュエル設定</div> <div class="duel_config_group svelte-y4u26k"><div class="duel_config_group_title svelte-y4u26k">チェーン設定</div> <!></div></div>');function Ms(n,i){ot(i,!1);let t=Re(i,"viewController",8),d=Re(i,"userProfile",12);nt();var _=Ae(),c=O(_);{var g=v=>{var M=Ss(),N=s(a(M),2),w=s(a(N),2);oe(w,1,()=>Xa,ne,(l,I)=>{var A=$s(),z=a(A),F=a(z),Y=s(z,2),T=a(Y);u(()=>f(T,za[e(I)])),Ga(F,()=>d().chainConfig[e(I)],te=>d(d().chainConfig[e(I)]=te,!0)),Ce("change",F,()=>d().save()),r(l,A)}),r(v,M)};y(c,v=>{t().infoBoardState==="Config"&&v(g)})}r(n,_),vt()}function Ts(n,{from:i,to:t},d={}){var{delay:_=0,duration:c=m=>Math.sqrt(m)*120,easing:g=aa}=d,v=getComputedStyle(n),M=v.transform==="none"?"":v.transform,[N,w]=v.transformOrigin.split(" ").map(parseFloat);N/=n.clientWidth,w/=n.clientHeight;var l=Es(n),I=n.clientWidth/t.width/l,A=n.clientHeight/t.height/l,z=i.left+i.width*N,F=i.top+i.height*w,Y=t.left+t.width*N,T=t.top+t.height*w,te=(z-Y)*I,de=(F-T)*A,Be=i.width/t.width,D=i.height/t.height;return{delay:_,duration:typeof c=="function"?c(Math.sqrt(te*te+de*de)):c,easing:g,css:(m,P)=>{var ee=P*te,$e=P*de,V=m+P*Be,ve=m+P*D;return`transform: ${M} translate(${ee}px, ${$e}px) scale(${V}, ${ve});`}}}function Es(n){if("currentCSSZoom"in n)return n.currentCSSZoom;for(var i=n,t=1;i!==null;)t*=+getComputedStyle(i).zoom,i=i.parentElement;return t}var qs=o('<div class="chain_number svelte-d2f52m"> </div>'),As=o('<div class="duel_card_row svelte-d2f52m"> </div>'),Ys=o('<div class="appendix svelte-d2f52m"> </div>'),Bs=o('<div class="appendix_wrapper svelte-d2f52m"></div>'),Ns=o('<div><div><!> <div> </div> <div><!> <div class="duel_card_row svelte-d2f52m"><div> </div> <!></div></div></div></div>'),Is=o("<div></div>");function Fs(n,i){ot(i,!1);let t=Re(i,"duel",8),d=Re(i,"position",8,"left");const _=-100,c=()=>d()==="left"?-100:100;let g=De([]),v=Promise.resolve(),M=Promise.resolve();const N=1e3,w=500,l=400,I=z=>{const F={...z};F.isKnown=z.chainBlockInfo.action.entity.controller.duelistType==="Player"||z.chainBlockInfo.action.entity.face==="FaceUp",F.chainBlockInfo.onStateChange.append(Y=>{if(Y==="done"||Y==="failed"||Y==="nagated")return v=v.then(async()=>{const T=new Date().getTime()-F.chainBlockInfo.wasSpawnedAt.getTime();T<N&&await Dt(N-T),k(g,e(g).filter(te=>te.seq!==F.seq)),await Dt(w+l)}).then(),"RemoveMe";k(g,e(g))}),M=M.then(async()=>{k(g,[F,...e(g)].sort((Y,T)=>Va.isSameChain(Y.clock,T.clock)&&Y.chainBlockInfo.action.isWithChainBlock&&T.chainBlockInfo.action.isWithChainBlock?T.clock.totalProcSeq-Y.clock.totalProcSeq:Y.clock.totalProcSeq-T.clock.totalProcSeq)),await Dt(300)}),v=v.then(()=>Dt(1e3))};t().chainBlockLog.onInsert.append(I),nt();var A=Is();oe(A,13,()=>e(g),z=>z.seq,(z,F)=>{var Y=Ns();const T=xe(()=>{const{activator:U,action:ae,appendix:re}=e(F).chainBlockInfo;return{activator:U,action:ae,appendix:re}});var te=a(Y),de=a(te);{var Be=U=>{var ae=qs(),re=a(ae);u(()=>f(re,`チェーン：${e(F).chainBlockInfo.chainNumber??""}`)),r(U,ae)};y(de,U=>{e(F).chainBlockInfo.chainNumber&&U(Be)})}var D=s(de,2),m=a(D),P=s(D,2),ee=a(P);{var $e=U=>{var ae=As(),re=a(ae);u(()=>f(re,e(F).isKnown?e(T).action.entity.nm:"？？？")),r(U,ae)};y(ee,U=>{(e(T).action.entity.entityType==="Card"||e(T).action.entity.entityType==="Token")&&U($e)})}var V=s(ee,2),ve=a(V),X=a(ve),me=s(ve,2);{var W=U=>{var ae=Bs();oe(ae,5,()=>e(T).appendix,ne,(re,he)=>{var L=Ys(),E=a(L);u(()=>f(E,e(he))),r(re,L)}),r(U,ae)};y(me,U=>{e(T).appendix&&U(W)})}u((U,ae,re)=>{Ye(Y,`cut_in_row ${(!e(F).chainBlockInfo.chainNumber||e(F).chainBlockInfo.chainNumber===1?"cut_in_row_first":"")??""} svelte-d2f52m`),Ye(te,`cut_in_item cut_in_item_${U??""} cut_in_item_${e(F).chainBlockInfo.state??""} svelte-d2f52m`),Ye(D,`duelist_name duelist_${U??""}_name svelte-d2f52m`),f(m,e(T).activator.profile.name),Ye(P,`duel_card duel_card_${U??""} ${ae??""} ${(e(F).isKnown?e(T).action.entity.origin.kind:"")??""} ${e(T).action.entity.entityType??""}  svelte-d2f52m`),f(X,re)},[()=>e(T).activator.seat.toLowerCase(),()=>e(F).isKnown?(e(T).action.entity.status.monsterCategories??[]).join(" "):"Token",()=>e(T).action.toString()],xe),Z(3,te,()=>hr,()=>new Date().getTime()-e(F).chainBlockInfo.wasSpawnedAt.getTime()<N?{x:c(),duration:l}:{y:_,duration:l}),Qa(Y,()=>Ts,()=>({duration:w})),r(z,Y)}),u(()=>Ye(A,`cut_in_container cut_in_container_${d()??""} svelte-d2f52m`)),r(n,A),vt()}const Hs=br({duration:400});var Ps=o('<div class="duel_desk_left v_flex svelte-1i63tk9"><!> <!> <!></div>'),Us=o('<button class="duel_field_header_message svelte-1i63tk9"> </button> <div class="duel_field_header_buttons svelte-1i63tk9"><button class="svelte-1i63tk9">サレンダー</button></div>',1),js=o("<tr></tr>"),Os=o('<table class="duel_field svelte-1i63tk9"><tbody class="svelte-1i63tk9"></tbody></table>'),Ls=o('<button class="svelte-1i63tk9">OK</button>'),Rs=o('<button class="svelte-1i63tk9">cancel</button>'),Ws=o("<!> <!>",1),Ks=o('<button class="svelte-1i63tk9"> </button>'),zs=o('<div style="text-align: left;"><!> <!> <!></div>'),Gs=o('<div><!> <div class=" duel_desk_center v_flex svelte-1i63tk9"><div class="duel_field_header svelte-1i63tk9"><!></div> <div class="duel_field_body svelte-1i63tk9"><!></div> <div class="duel_field_footer svelte-1i63tk9"><!></div></div> <!></div> <div style="position:fixed;left:0;bottom:0"> </div> <!> <div><!></div>',1);function Xs(n,i){ot(i,!1);let t=Re(i,"duel",12),d=Re(i,"userProfile",8),_=De(0),c=De(0),g=De([]),v=De([]),M=()=>{},N=De([]),w=De(),l=De(),I=De(()=>!1),A=De(!1);const z=h=>{M=h.resolve,k(N,h.dummyActionInfos.filter(S=>S.action.entity.entityType==="Duelist").filter(S=>S.action.entity.controller.seat==="Below")),k(w,void 0),k(l,void 0),k(v,[]),k(g,[]),k(A,!1),h.entitiesChoices&&(k(w,h.entitiesChoices),k(I,()=>{var S;return((S=h.entitiesChoices)==null?void 0:S.validator(e(g)))??!1}),k(A,h.entitiesChoices.cancelable),e(w).selectables.every(S=>S.cell.isPlayFieldCell&&S.getIndexInCell()===0||S.cell.cellType==="Hand"&&S.controller.duelistType==="Player"||S.entityType==="Duelist")||t().view.modalController.entitySelector.show({title:t().view.message,position:"Middle",entitiesChoices:h.entitiesChoices,chainBlockInfos:h.chainBlockInfos,cancelable:h.entitiesChoices.cancelable}).then(S=>{M({selectedEntities:S})})),h.cellsChoices&&(k(l,h.cellsChoices),k(I,()=>{var S;return((S=h.cellsChoices)==null?void 0:S.validator(e(v)))??!1}),k(A,h.cellsChoices.cancelable))};t().view.onWaitStart.append(z);const F=()=>{M=()=>{},k(l,void 0),k(w,void 0),k(v,[]),k(g,[]),k(I,()=>!1),k(A,!1)};t().view.onWaitEnd.append(F);let Y=De(void 0),T=De("Normal");const te=({card:h,mode:S})=>{k(Y,h),k(T,S)};t().view.onShowCardEntity.append(te);const de=()=>{t(t())};t().view.onDuelUpdate.append(de),t().log.onUpdate.append(de);const Be=()=>{e(w)&&e(w).validator(e(g))&&M({selectedEntities:e(g)}),e(l)&&e(l).validator(e(v))&&M({selectedCells:e(v)})},D=()=>{M({})},m=h=>{M({actionInfo:h})},P=()=>{M({surrender:!0})};t().main();const ee=()=>e(_)<=1400?"compact":"wide";nt();var $e=Gs(),V=O($e),ve=a(V);{var X=h=>{var S=Ps(),ce=a(S);qa(ce,{get duelist(){return t().duelists.Above}});var be=s(ce,2);ws(be,{get entity(){return e(Y)},get mode(){return e(T)}});var Q=s(be,2);qa(Q,{get duelist(){return t().duelists.Below}}),r(h,S)};y(ve,h=>{ee()==="wide"&&h(X)})}var me=s(ve,2),W=a(me),U=a(W);{var ae=h=>{var S=Us(),ce=O(S),be=a(ce),Q=s(ce,2),fe=a(Q);u(()=>f(be,`[TURN:${t().clock.turn}][PHASE:${t().phase}] ${t().view.message}`)),Ce("click",ce,()=>{t(t().view.infoBoardState="Log",!0)}),Ce("click",fe,P),r(h,S)};y(U,h=>{t().isEnded||h(ae)})}var re=s(W,2),he=a(re);{var L=h=>{var S=Os(),ce=a(S);oe(ce,5,()=>t().field.cells,ne,(be,Q,fe)=>{var _e=js();Ye(_e,`${`duel_desk_row_${fe}`??""} svelte-1i63tk9`),oe(_e,5,()=>e(Q),ne,(J,K,ye)=>{Ur(J,{get view(){return t().view},row:fe,column:ye,get selectedEntities(){return e(g)},set selectedEntities(Se){k(g,Se)},get selectedCells(){return e(v)},set selectedCells(Se){k(v,Se)},$$legacy:!0})}),r(be,_e)}),r(h,S)};y(he,h=>{t().clock.turn>0&&h(L)})}var E=s(re,2),R=a(E);{var se=h=>{var S=Ws(),ce=O(S);{var be=_e=>{var J=Ls();u(K=>J.disabled=K,[()=>!e(I)()],xe),Ce("click",J,Be),r(_e,J)};y(ce,_e=>{((e(w)&&e(w).qty)??(e(l)&&e(l).qty)??9999)>1&&_e(be)})}var Q=s(ce,2);{var fe=_e=>{var J=Rs();Ce("click",J,D),r(_e,J)};y(Q,_e=>{e(A)&&_e(fe)})}r(h,S)},Ne=h=>{var S=Ae(),ce=O(S);oe(ce,1,()=>e(N),ne,(be,Q)=>{var fe=Ks(),_e=a(fe);u(()=>f(_e,e(Q).action.title)),Ce("click",fe,()=>m(e(Q))),r(be,fe)}),r(h,S)};y(R,h=>{e(w)&&e(w).selectables.length||e(l)&&e(l).selectables?h(se):h(Ne,!1)})}var $=s(me,2);{var p=h=>{var S=zs(),ce=a(S);Xr(ce,{get log(){return t().log}});var be=s(ce,2);Ds(be,{get cell(){return t().view.infoBoardCell}});var Q=s(be,2);Ms(Q,{get userProfile(){return d()},get viewController(){return t().view}}),u(fe=>Ye(S,`duel_desk_right duel_desk_right_${fe??""}  svelte-1i63tk9`),[()=>t().view.infoBoardState.toLowerCase()],xe),Z(3,S,()=>ge,()=>({duration:e(_)>1400?0:200,axis:"x"})),r(h,S)};y($,h=>{(e(_)>1400||t().view.infoBoardState!=="Default")&&h(p)})}var C=s(V,2),G=a(C),H=s(C,2);Za(H,{get modalController(){return t().view.modalController}});var ie=s(H,2),x=a(ie);const ue=xe(()=>ee()==="wide"?"right":"left");Fs(x,{get duel(){return t()},get position(){return e(ue)}}),u((h,S)=>{Ye(V,`flex duel_desk ${h??""}_mode svelte-1i63tk9`),f(G,S),Ye(ie,`cutin ${h??""}_mode svelte-1i63tk9`)},[ee,()=>t().clock.toFullString()],xe),Lt("innerWidth",h=>k(_,h)),Lt("innerHeight",h=>k(c,h)),r(n,$e),vt()}var Vs=o('<div class="svelte-swqq02"><button class="button_style_reset svelte-swqq02" title="※shiftキー同時押しで一括外し">クリア</button></div>'),Qs=o('<div class="svelte-swqq02"><button class="button_style_reset svelte-swqq02" title="※shiftキー同時押しで一括外し">クリア</button></div>'),Zs=o("<div></div>"),Js=o("<!> <!> <!> <!> <!>",1),ei=o('<span> </span> / <span style="display: inline-block;width:2rem;text-align: right;"> </span>',1),ti=o('<li class="deck_editor_item svelte-swqq02"><div role="listitem"><div class="svelte-swqq02"><div class="svelte-swqq02"> </div> <div style="display:flex" class="svelte-swqq02"><div class="svelte-swqq02"><!> <!> <!></div> <div style="flex-grow: 1; width:0.1rem" class="svelte-swqq02"></div> <div class="svelte-swqq02"><!></div></div></div></div> <button class="button_style_reset svelte-swqq02" title="※shiftキー同時押しで一括投入">+</button> <button class="button_style_reset svelte-swqq02" title="※shiftキー同時押しで一括外し">-</button></li>'),ai=o('<div class="deck_editor_card_kind svelte-swqq02"><div class="deck_editor_card_kind_header svelte-swqq02"><div class="svelte-swqq02"> </div> <!></div> <ul class="svelte-swqq02"></ul></div>'),ri=o('<div class="deck_editor_deck_type svelte-swqq02"><div class="deck_editor_deck_type_header svelte-swqq02"><div class="svelte-swqq02"> </div> <!></div> <!></div>'),si=o('<div class="svelte-swqq02">読み込み中...</div>'),ii=o('<div class="deck_editor_card_list svelte-swqq02"><!></div>');function Aa(n,i){ot(i,!1);let t=Re(i,"allCardInfos",8),d=Re(i,"deckCardInfos",12),_=Re(i,"mode",8),c=Re(i,"onAttention",8),g=Re(i,"searchCondition",8,void 0);const v={Deck:["Monster","Spell","Trap"],ExtraDeck:["Monster"]},M={Deck:{Monster:[],Spell:[],Trap:[]},ExtraDeck:{Monster:[],Spell:[],Trap:[]}},N=D=>{var m;return(m=D.monsterCategories)!=null&&m.union(Rt).length?"ExtraDeck":"Deck"},w=D=>{Object.values(M).forEach(m=>Object.values(m).forEach(P=>P.reset())),D.filter(m=>m.isImplemented).filter(m=>m.kind!=="XyzMaterial").forEach(m=>{var ee;if(m.kind==="XyzMaterial")return;const P=(ee=m.monsterCategories)!=null&&ee.union(Rt).length?"ExtraDeck":"Deck";M[P][m.kind].push(m)}),Object.values(M).forEach(m=>Object.values(m).forEach(P=>P.sort(ea)))},l=_()==="List"?new Promise(D=>{w(t()),D()}):Promise.resolve(),I=()=>(_()==="Deck"&&(w(d()),k(Y,d().length)),M),A=(D,m,P)=>{d(d().filter(ee=>N(ee)!==m||ee.kind!==P&&P))},z=(D,m)=>{try{if(D.ctrlKey){d().push(m);return}const P=d().filter($e=>$e.name===m.name).length;if(P>2)return;const ee=D.shiftKey?3-P:1;if(ee<1)return;d().push(...Array(ee).fill(m))}finally{d().sort(ea),d(d())}},F=(D,m)=>{let P=0;d(d().filter(ee=>ee.name!==m.name?!0:(P++,!D.shiftKey&&P>1))),d().sort(ea)};let Y=De(100);const T=()=>{e(Y)>t().length+d().length||(k(Y,e(Y)+10),Dt(100).then(T))};Dt(100).then(T);const te=(D,m)=>{if(!g())return!0;if(!g().cardKinds.includes(D.kind)||g().name.trim().length&&[D.name,...D.nameTags??[],...D.textTags??[]].every(ee=>!ee.includes(g().name))||D.isForTest&&!g().others.includes("test"))return!1;if(D.kind==="Monster")return D.attributes&&!g().monsterAttributes.union(D.attributes).length||D.types&&!g().monsterTypes.union(D.types).length||!D.monsterCategories?!1:D.monsterCategories.union(g().monsterCategories).length;if(D.kind==="Spell")return D.spellCategory&&g().spellCategories.includes(D.spellCategory);if(D.kind==="Trap")return D.trapCategory&&g().trapCategories.includes(D.trapCategory)};nt();var de=ii(),Be=a(de);mt(Be,()=>l,D=>{var m=si();r(D,m)},D=>{var m=Ae();const P=xe(I);var ee=O(m);oe(ee,1,()=>er,ne,($e,V)=>{var ve=ri();const X=xe(()=>Object.values(e(P)[e(V)]).flatMap(L=>L));var me=a(ve),W=a(me),U=a(W),ae=s(W,2);{var re=L=>{var E=Vs(),R=a(E);Ce("click",R,se=>A(se,e(V),void 0)),r(L,E)};y(ae,L=>{_()==="Deck"&&e(X).some(te)&&L(re)})}var he=s(me,2);oe(he,1,()=>ia(e(P)[e(V)]).filter(L=>v[e(V)].includes(L)),ne,(L,E)=>{var R=ai();const se=xe(()=>e(P)[e(V)][e(E)].filter(te));var Ne=a(R),$=a(Ne),p=a($),C=s($,2);{var G=ie=>{var x=Qs(),ue=a(x);Ce("click",ue,h=>A(h,e(V),e(E))),r(ie,x)};y(C,ie=>{_()==="Deck"&&e(se).length&&ie(G)})}var H=s(Ne,2);oe(H,5,()=>e(se),ne,(ie,x,ue)=>{var h=Ae(),S=O(h);{var ce=be=>{var Q=ti(),fe=a(Q),_e=a(fe),J=a(_e),K=a(J),ye=s(J,2),Se=a(ye),Ke=a(Se);{var qe=j=>{var ke=Js(),Ee=O(ke);{var ze=Me=>{var Ue=lt();u(()=>f(Ue,`★${e(x).level??""}`)),r(Me,Ue)};y(Ee,Me=>{e(x).level&&Me(ze)})}var He=s(Ee,2);{var Ve=Me=>{var Ue=lt();u(()=>f(Ue,`☆${e(x).rank??""}`)),r(Me,Ue)};y(He,Me=>{e(x).rank&&Me(Ve)})}var Je=s(He,2);oe(Je,1,()=>e(x).attributes??[],ne,(Me,Ue)=>{var Ie=Zs();u(()=>Ye(Ie,`monster_attr ${e(Ue)??""} svelte-swqq02`)),r(Me,Ie)});var at=s(Je,2);oe(at,1,()=>e(x).types??[],ne,(Me,Ue)=>{var Ie=lt();u(()=>f(Ie,zt[e(Ue)])),r(Me,Ie)});var Qe=s(at,2);oe(Qe,1,()=>e(x).monsterCategories??[],ne,(Me,Ue)=>{var Ie=lt();u(()=>f(Ie,Gt[e(Ue)])),r(Me,Ie)}),r(j,ke)};y(Ke,j=>{e(x).kind==="Monster"&&j(qe)})}var le=s(Ke,2);{var we=j=>{var ke=lt();u(()=>f(ke,`${Xt[e(x).spellCategory]??""}魔法`)),r(j,ke)};y(le,j=>{e(x).spellCategory!==void 0&&j(we)})}var Te=s(le,2);{var b=j=>{var ke=lt();u(()=>f(ke,`${Vt[e(x).trapCategory]??""}罠`)),r(j,ke)};y(Te,j=>{e(x).trapCategory!==void 0&&j(b)})}var q=s(Se,4),B=a(q);{var pe=j=>{var ke=ei(),Ee=O(ke),ze=a(Ee),He=s(Ee,2),Ve=a(He);u(()=>{f(ze,e(x).attack??"?"),f(Ve,e(x).defense??"?")}),r(j,ke)};y(B,j=>{e(x).kind==="Monster"&&j(pe)})}var Fe=s(fe,2),Le=s(Fe,2);u(j=>{Ye(fe,`${j??""} svelte-swqq02`),f(K,e(x).name)},[()=>{var j,ke;return`deck_editor_card duel_card ${e(x).kind} ${(ke=(j=e(x))==null?void 0:j.monsterCategories)==null?void 0:ke.join(" ")} ${e(x).isImplemented?"is_implemented":"is_not_implemented"}`}],xe),Ce("mouseenter",fe,()=>c()(e(x))),Ce("click",Fe,j=>z(j,e(x))),Ce("click",Le,j=>F(j,e(x))),r(be,Q)};y(S,be=>{ue<e(Y)&&be(ce)})}r(ie,h)}),u(()=>f(p,`${Ba[e(E)]??""}（${e(se).length??""} / ${e(P)[e(V)][e(E)].length??""}枚）`)),r(L,R)}),u(L=>f(U,`${Ja[e(V)]??""}（${L??""} / ${e(X).length??""}枚）`),[()=>e(X).filter(te).length],xe),r($e,ve)}),r(D,m)}),r(n,de),vt()}var li=o('<div class="duel_card_info_row svelte-rccxcp" style="position:sticky; top:0;"><div class="svelte-rccxcp"> </div> <div class="svelte-rccxcp"> </div></div>'),oi=o('<div class="duel_card_info_row svelte-rccxcp"><div class="svelte-rccxcp"><pre class="description svelte-rccxcp"> </pre></div></div> <div class="duel_card_info_row svelte-rccxcp" style=" justify-content: space-between;"><div class="svelte-rccxcp"> </div> <div class="svelte-rccxcp"> </div></div>',1),ni=o('<div></div> <div class="svelte-rccxcp"> </div>',1),vi=o("<div> </div>"),di=o("<div> </div>"),ci=o('<div class="duel_card_info_row svelte-rccxcp"><!> <!></div> <div class="duel_card_info_row svelte-rccxcp"></div>',1),_i=o('<div class="duel_card_row svelte-rccxcp"><div class="svelte-rccxcp"></div> <div class="svelte-rccxcp"> </div></div>'),ui=o('<div class="duel_card_row svelte-rccxcp"><div class="svelte-rccxcp"></div> <div class="svelte-rccxcp"> </div></div>'),fi=o('<div class="duel_card_info_row svelte-rccxcp"><div class="svelte-rccxcp">※テスト用カードです</div></div>'),pi=o('<div class="duel_card_info_links svelte-rccxcp"><a target="_blank" rel="noopener noreferrer" title="遊戯王カードWiki" class="svelte-rccxcp">⇒遊戯王カードWiki</a> <a target="_blank" rel="noopener noreferrer" title="コナミカードデータベース" class="svelte-rccxcp"> </a></div>'),gi=o('<div><div class="duel_card_info_header svelte-rccxcp"><div class="duel_card_info_row svelte-rccxcp"><div class="svelte-rccxcp"> </div></div> <!></div> <div class="duel_card_info_body svelte-rccxcp"><!> <!> <div class="duel_card_info_row description svelte-rccxcp"><div class="svelte-rccxcp"><pre class="description svelte-rccxcp"> </pre></div></div> <!></div></div>');function mi(n,i){ot(i,!1);let t=Re(i,"cardInfo",8,void 0);const d=()=>t()?gt[t().name]:void 0;nt();var _=Ae(),c=O(_);{var g=v=>{var M=gi(),N=a(M),w=a(N),l=a(w),I=a(l),A=s(w,2);{var z=X=>{var me=li(),W=a(me),U=a(W),ae=s(W,2),re=a(ae);u((he,L)=>{f(U,he),f(re,L)},[()=>"★".repeat(t().level||0),()=>"☆".repeat(t().rank||0)],xe),r(X,me)};y(A,X=>{t().kind==="Monster"&&X(z)})}var F=s(N,2),Y=a(F);{var T=X=>{var me=oi(),W=O(me),U=a(W),ae=a(U),re=a(ae),he=s(W,2),L=a(he),E=a(L),R=s(L,2),se=a(R);u(()=>{f(re,gt[t().name].pendulumDescription),f(E,`◀ ${t().pendulumScaleL??""}`),f(se,`${t().pendulumScaleR??""} ▶`)}),r(X,me)};y(Y,X=>{var me;(me=t().monsterCategories)!=null&&me.includes("Pendulum")&&X(T)})}var te=s(Y,2);{var de=X=>{var me=ci(),W=O(me),U=a(W);{var ae=E=>{var R=ni(),se=O(R),Ne=s(se,2),$=a(Ne);u(()=>{Ye(se,`monster_attr ${t().attributes[0]??""} svelte-rccxcp`),f($,`${la[t().attributes[0]]??""}属性`)}),r(E,R)};y(U,E=>{t().attributes&&E(ae)})}var re=s(U,2);{var he=E=>{var R=vi(),se=a(R);u(()=>{Ye(R,`monster_cat ${t().types[0]??""} svelte-rccxcp`),f(se,`${zt[t().types[0]]??""}${oa[t().types[0]]??""}族`)}),r(E,R)};y(re,E=>{t().types&&E(he)})}var L=s(W,2);oe(L,5,()=>t().monsterCategories??[],ne,(E,R)=>{var se=di(),Ne=a(se);u(()=>{Ye(se,`monster_cat ${e(R)??""} svelte-rccxcp`),f(Ne,`${Gt[e(R)]??""}${na[e(R)]??""}`)}),r(E,se)}),r(X,me)},Be=X=>{var me=Ae(),W=O(me);{var U=re=>{var he=_i(),L=s(a(he),2),E=a(L);u(()=>f(E,`${Xt[t().spellCategory]??""}魔法`)),r(re,he)},ae=re=>{var he=Ae(),L=O(he);{var E=R=>{var se=ui(),Ne=s(a(se),2),$=a(Ne);u(()=>f($,`${Vt[t().trapCategory]??""}罠`)),r(R,se)};y(L,R=>{t().kind==="Trap"&&t().trapCategory&&R(E)},!0)}r(re,he)};y(W,re=>{t().kind==="Spell"&&t().spellCategory?re(U):re(ae,!1)},!0)}r(X,me)};y(te,X=>{t().kind==="Monster"?X(de):X(Be,!1)})}var D=s(te,2),m=a(D),P=a(m),ee=a(P),$e=s(D,2);{var V=X=>{var me=fi();r(X,me)},ve=X=>{var me=pi(),W=a(me),U=s(W,2),ae=a(U);u(re=>{ht(W,"href",`https://yugioh-wiki.net/index.php?${t().wikiEncodedName}`),ht(U,"href",re),f(ae,`⇒${(t().cardId?"公式カードページ":"公式で検索")??""}`)},[()=>tr(t())],xe),r(X,me)};y($e,X=>{t().isForTest?X(V):X(ve,!1)})}u((X,me)=>{Ye(M,`duel_card duel_card_info ${t().kind??""} ${X??""} svelte-rccxcp`),f(I,t().name),f(ee,me)},[()=>{var X;return(X=t().monsterCategories)==null?void 0:X.join(" ")},()=>{var X;return(X=d())==null?void 0:X.description}],xe),r(v,M)};y(c,v=>{t()&&v(g)})}r(n,_),vt()}const hi={0:{aaa:"日",aaaa:"日曜日",ddd:"Sun",dddd:"Sunday"},1:{aaa:"月",aaaa:"月曜日",ddd:"Mon",dddd:"Monday"},2:{aaa:"火",aaaa:"火曜日",ddd:"Tue",dddd:"Tuesday"},3:{aaa:"水",aaaa:"水曜日",ddd:"Wed",dddd:"Wednesday"},4:{aaa:"木",aaaa:"木曜日",ddd:"Thu",dddd:"Thursday"},5:{aaa:"金",aaaa:"金曜日",ddd:"Fri",dddd:"Friday"},6:{aaa:"土",aaaa:"土曜日",ddd:"Sat",dddd:"Saturday"}};class bi{constructor(){Ze(this,"DefaultSeparator1","/");Ze(this,"DefaultSeparator2"," ");Ze(this,"DefaultSeparator3",":");Ze(this,"createDate",i=>{if(!i)return;const t=new Date(i);if(!isNaN(t.getTime()))return t});Ze(this,"createDateOr",(i,t)=>this.createDate(i)||t||new Date);Ze(this,"truncateDate",i=>{const t=i||new Date;return new Date(t.getFullYear(),t.getMonth(),t.getDate())});Ze(this,"addDate",(i,t)=>{const d=this.createDateOr(i);return d.setDate(d.getDate()+t),d});Ze(this,"addMonth",(i,t)=>{const d=this.createDateOr(i);return d.setMonth(d.getMonth()+t),d});Ze(this,"addYear",(i,t)=>{const d=this.createDateOr(i);return d.setFullYear(d.getFullYear()+t),d});Ze(this,"getDayOfWeek",(i,t="dddd")=>{const d=this.createDate(i);return d?hi[d.getDay()][t]:""});Ze(this,"formatToYYYYMMDD",(i,t=this.DefaultSeparator1)=>{const d=this.createDate(i);if(!d)return"";const _=d.getFullYear().toString(),c=("0"+(d.getMonth()+1)).slice(-2),g=("0"+d.getDate()).slice(-2);return _+t+c+t+g});Ze(this,"formatToYYYYMM",(i,t=this.DefaultSeparator1)=>{const d=this.createDate(i);if(!d)return"";t||(t="");const _=d.getFullYear().toString(),c=("0"+(d.getMonth()+1)).slice(-2);return _+t+c});Ze(this,"formatToHHMMSS",(i,t=this.DefaultSeparator3)=>{const d=this.createDate(i);if(!d)return"";t||(t="");const _=d.getHours(),c=d.getMinutes(),g=d.getSeconds();return("0"+_).slice(-2)+t+("0"+c).slice(-2)+t+("0"+g).slice(-2)});Ze(this,"formatToHHMM",(i,t=this.DefaultSeparator3)=>{const d=this.createDate(i);if(!d)return"";t||(t="");const _=("0"+d.getHours()).slice(-2),c=("0"+d.getMinutes()).slice(-2);return _+t+c});Ze(this,"formatToYYYYMMDD_HHMM",(i,t=this.DefaultSeparator1,d=this.DefaultSeparator2,_=this.DefaultSeparator3)=>{const c=this.createDate(i);return c?this.formatToYYYYMMDD(c,t)+d+this.formatToHHMM(c,_):""});Ze(this,"formatToYYYYMMDD_HHMMSS",(i,t=this.DefaultSeparator1,d=this.DefaultSeparator2,_=this.DefaultSeparator3)=>{const c=this.createDate(i);return c?this.formatToYYYYMMDD(c,t)+d+this.formatToHHMMSS(c,_):""})}}const ct=new bi;Date.prototype.truncateDate=function(){return ct.truncateDate(this)};Date.prototype.getCloneOr=function(n){return ct.createDateOr(this,n)};Date.prototype.addDate=function(n){return ct.addDate(this,n)};Date.prototype.addMonth=function(n){return ct.addDate(this,n)};Date.prototype.addYear=function(n){return ct.addDate(this,n)};Date.prototype.getDayOfWeek=function(n="dddd"){return ct.getDayOfWeek(this,n)};Date.prototype.formatToYYYYMM=function(n){return ct.formatToYYYYMM(this,n)};Date.prototype.formatToYYYYMMDD=function(n){return ct.formatToYYYYMMDD(this,n)};Date.prototype.formatToYYYYMMDD_HHMM=function(n,i,t){return ct.formatToYYYYMMDD_HHMM(this,n,i,t)};Date.prototype.formatToYYYYMMDD_HHMMSS=function(n,i,t){return ct.formatToYYYYMMDD_HHMMSS(this,n,i,t)};Date.prototype.formatToHHMM=function(n){return ct.formatToHHMM(this,n)};Date.prototype.formatToHHMMSS=function(n){return ct.formatToHHMMSS(this,n)};var yi=o('<li class="deck_info_list_item svelte-2wdgc8"><div class="svelte-2wdgc8"> </div> <div class="svelte-2wdgc8"> </div> <div class="svelte-2wdgc8"> </div></li>'),wi=o('<ul class="deck_info_list svelte-2wdgc8"></ul>'),ki=o('<label for="file_selector" class="upload_area svelte-2wdgc8" role="region" aria-label="ファイルアップロードエリア"><div class="upload_area_message svelte-2wdgc8">ここにファイルをドロップ</div> <div class="upload_area_footer svelte-2wdgc8"><input type="file" id="file_selector" name="file_selector" accept=".json" multiple></div></label>'),xi=o('<div slot="body" class="modal_body svelte-2wdgc8"><!></div>'),Ci=o('<button class="svelte-2wdgc8">追加</button> <button class="svelte-2wdgc8">削除して追加</button> <button class="svelte-2wdgc8">戻る</button>',1),Di=o('<button class="svelte-2wdgc8">Cancel</button>'),$i=o('<div slot="footer" class="modal_window_footer svelte-2wdgc8"><!></div>');function Si(n,i){ot(i,!1);let t=Re(i,"eventHolder",8),d=Re(i,"args",8),_=Re(i,"resolve",8),c=De(Promise.resolve([])),g=De();const v=()=>{k(g,new DataTransfer().files),k(c,Promise.resolve([]))},M=async A=>{A.preventDefault(),console.log("hoge",A)},N=async A=>{A.preventDefault(),A.dataTransfer&&l(A.dataTransfer.files)},w=()=>{l(e(g))},l=async A=>{if(!A.length)return;const z=[],F=[];for(const Y of A)try{F.push(...await ut.createfromJson(Y))}catch(T){T instanceof Error&&z.push(T.message)}if(z.length){console.log(...z);return}k(c,e(c).then(()=>F))},I=v;nt(),ar(n,{get eventHolder(){return t()},get args(){return d()},$$slots:{body:(A,z)=>{var F=xi(),Y=a(F);mt(Y,()=>e(c),null,(T,te)=>{var de=Ae(),Be=O(de);{var D=P=>{var ee=wi();oe(ee,5,()=>e(te),ne,($e,V)=>{var ve=yi(),X=a(ve),me=a(X),W=s(X,2),U=a(W),ae=s(W,2),re=a(ae);u((he,L,E)=>{f(me,e(V).name),f(U,`${he??""}
                /
                ${L??""}`),f(re,`最終使用日時 ： ${E??""}`)},[()=>e(V).cardNames.filter(he=>d().mainCardNames.includes(he)).length,()=>e(V).cardNames.filter(he=>d().exCardNames.includes(he)).length,()=>e(V).lastUsedAt.formatToYYYYMMDD_HHMM("/"," ",":")],xe),r($e,ve)}),r(P,ee)},m=P=>{var ee=ki(),$e=s(a(ee),2),V=a($e);rr(V,()=>e(g),ve=>k(g,ve)),Ce("change",V,w),Ce("cancel",V,I),Ce("drop",ee,N),Ce("dragover",ee,M),r(P,ee)};y(Be,P=>{e(te).length?P(D):P(m,!1)})}r(T,de)}),r(A,F)},footer:(A,z)=>{var F=$i(),Y=a(F);mt(Y,()=>e(c),null,(T,te)=>{var de=Ae(),Be=O(de);{var D=P=>{var ee=Ci(),$e=O(ee),V=s($e,2),ve=s(V,2);u(()=>{$e.disabled=e(te).length===0,V.disabled=e(te).length===0}),Ce("click",$e,()=>_()({deckInfos:e(te),replaceAll:!1})),Ce("click",V,()=>_()({deckInfos:e(te),replaceAll:!0})),Ce("click",ve,I),r(P,ee)},m=P=>{var ee=Ae(),$e=O(ee);{var V=ve=>{var X=Di();Ce("click",X,()=>_()(void 0)),r(ve,X)};y($e,ve=>{d().cancelable&&ve(V)},!0)}r(P,ee)};y(Be,P=>{e(te).length?P(D):P(m,!1)})}r(T,de)}),r(A,F)}}}),vt()}const Kt=class Kt extends ir{constructor(i,t){super(i,...Object.values(t))}};Ze(Kt,"createModalController",i=>{const t={deckUploader:new lr({title:"デッキ情報をアップロード",position:"Middle",cancelable:!1,mainCardNames:[],exCardNames:[]})};return Object.assign(new Kt(i,t),t)});let sa=Kt;function Mi(n,i){ot(i,!1);let t=Re(i,"modalController",8);nt(),sr(n,{get modalController(){return t()},children:(d,_)=>{var c=Ae(),g=O(c);{var v=M=>{Si(M,{get eventHolder(){return t().eventHolder},get args(){return t().deckUploader.args},get resolve(){return t().deckUploader.resolve}})};y(g,M=>{t().deckUploader.state==="Shown"&&M(v)})}r(d,c)},$$slots:{default:!0}}),vt()}var Ti=o('<label><input type="checkbox"> </label>'),Ei=o('<label><input type="checkbox"> </label>'),qi=o('<label><input type="checkbox"> <div style="display: inline-block;"></div> </label>'),Ai=o('<label><input type="checkbox"> </label>'),Yi=o('<div class="deck_editor_search_box_row svelte-1s1plv5"><div class="svelte-1s1plv5"><button class="search_condition_title black_button svelte-1s1plv5">モンスター</button></div> <div class="svelte-1s1plv5"></div></div> <div class="deck_editor_search_box_row svelte-1s1plv5"><div class="svelte-1s1plv5"><button class="search_condition_title black_button svelte-1s1plv5">属性</button></div> <div class="svelte-1s1plv5"></div></div> <div class="deck_editor_search_box_row svelte-1s1plv5"><div class="svelte-1s1plv5"><button class="search_condition_title black_button svelte-1s1plv5">種族</button></div> <div class="svelte-1s1plv5"></div></div>',1),Bi=o('<label><input type="checkbox"> </label>'),Ni=o('<div class="deck_editor_search_box_row svelte-1s1plv5"><div class="svelte-1s1plv5"><button class="search_condition_title black_button svelte-1s1plv5">魔法</button></div> <div class="svelte-1s1plv5"></div></div>'),Ii=o('<label><input type="checkbox"> </label>'),Fi=o('<div class="deck_editor_search_box_row svelte-1s1plv5"><div class="svelte-1s1plv5"><button class="search_condition_title black_button svelte-1s1plv5">罠</button></div> <div class="svelte-1s1plv5"></div></div>'),Hi=o('<label><input type="checkbox"> </label>'),Pi=o("<option> </option>"),Ui=o('<div class="svelte-1s1plv5"><a class="white_button svelte-1s1plv5" download="SVS_DeckInfos.json">ダウンロード</a></div>'),ji=o('<div class="svelte-1s1plv5"></div>'),Oi=o('<div class="svelte-1s1plv5"><a class="white_button svelte-1s1plv5" download="SVS_DeckInfos.json">ダウンロード(一括)</a></div>'),Li=o('<div class="svelte-1s1plv5"></div>'),Ri=o('<div class="deck_editor_body_right_header svelte-1s1plv5"><div class="deck_editor_body_right_header_row svelte-1s1plv5"><div class="svelte-1s1plv5">編集対象 <select></select></div> <div class="svelte-1s1plv5"></div> <div class="svelte-1s1plv5">新規名称 <input type="text"></div></div> <div class="deck_editor_body_right_header_row svelte-1s1plv5"></div> <div class="deck_editor_body_right_header_row svelte-1s1plv5"><div class="svelte-1s1plv5">基本操作</div> <div class="svelte-1s1plv5"><button class="white_button svelte-1s1plv5">デッキを保存</button></div> <div class="svelte-1s1plv5"></div> <div class="svelte-1s1plv5"><button class="white_button svelte-1s1plv5">デッキを複製</button></div> <div class="svelte-1s1plv5"><button class="white_button svelte-1s1plv5" title="shiftキー押下で確認メッセージスキップ">デッキを削除</button></div></div> <div class="deck_editor_body_right_header_row svelte-1s1plv5"><div class="svelte-1s1plv5">DL/UL</div> <!> <!> <div class="svelte-1s1plv5"><button class="white_button svelte-1s1plv5">アップロード</button></div></div></div> <!>',1),Wi=o("<div>デッキ情報読込中</div>"),Ki=o('<div class="deck_editor svelte-1s1plv5"><div class="deck_editor_header"></div> <div class="deck_editor_body svelte-1s1plv5"><div class="deck_editor_body_left svelte-1s1plv5"><div role="contentinfo"><div class="deck_editor_search_box_header svelte-1s1plv5"><div>検索条件</div> <div><button class="white_button svelte-1s1plv5">条件クリア</button></div></div> <div class="deck_editor_search_box_row svelte-1s1plv5"><div class="svelte-1s1plv5">名称</div> <div class="svelte-1s1plv5"><input type="text" style="width:70%"> <button class="white_button svelte-1s1plv5">クリア</button> <span>※ルビには対応していません</span></div></div> <div class="deck_editor_search_box_row svelte-1s1plv5"><div class="svelte-1s1plv5"><button class="search_condition_title black_button svelte-1s1plv5">種類</button></div> <div class="svelte-1s1plv5"></div></div> <!> <!> <!> <div class="deck_editor_search_box_row svelte-1s1plv5"><div class="svelte-1s1plv5"><button class="search_condition_title black_button svelte-1s1plv5">その他</button></div> <div class="svelte-1s1plv5"></div></div></div> <!></div> <div class="deck_editor_body_center svelte-1s1plv5"><!></div> <div class="deck_editor_body_right svelte-1s1plv5"><!></div></div> <div class="footer svelte-1s1plv5"></div></div> <!>',1);function zi(n,i){ot(i,!1);const t=[],d=[],_=[],c=[],g=[],v=[],M=[],N=sa.createModalController({onDragStart:{append:()=>{},remove:()=>{}},onDragEnd:{append:()=>{},remove:()=>{}}}),w={name:"",cardKinds:ba.filter(b=>b!=="XyzMaterial"),monsterCategories:[...Ca],monsterAttributes:[...xa],monsterTypes:[...ka],spellCategories:[...wa],trapCategories:[...ya],others:["test"]},l=De(structuredClone(w));Oe(l,e(l).others=[]);let I=De("SearchCondition");const A=async()=>{Oe(l,e(l).name=""),Oe(l,e(l).cardKinds=[]),Oe(l,e(l).monsterCategories=[]),Oe(l,e(l).monsterAttributes=[]),Oe(l,e(l).monsterTypes=[]),Oe(l,e(l).spellCategories=[]),Oe(l,e(l).trapCategories=[]),Oe(l,e(l).others=[])},z=async b=>{Array.isArray(e(l)[b])&&Array.isArray(w[b])&&Oe(l,e(l)[b]=e(l)[b].length?[]:[...w[b]])},F=(b,q,B)=>{Array.isArray(e(l)[q])&&Array.isArray(w[q])&&Oe(l,e(l)[q]=[B])},Y=async()=>{const q=(await e(de)).find(B=>B.id===e(te));q&&k(m,{...q,cardInfos:q.cardNames.map(B=>gt[B])})},T=()=>ut.getAllDeckInfo().then(b=>(k(te,(b.find(q=>q.lastUsedAt.getTime()===Math.max(...b.map(B=>B.lastUsedAt.getTime())))??b[0]).id),b));let te=De(-1),de=De(T()),Be=De(e(de).then(b=>ut.convertToObjectURL(b)));e(de).then(Y);const D=()=>{k(de,T()),k(Be,e(de).then(b=>ut.convertToObjectURL(b))),Y()};let m=De({id:-Number.MAX_VALUE,name:"",description:"",lastUsedAt:new Date,cardInfos:[]}),P=De(gt.ゾンビーノ);const ee=b=>{k(I,"CardDetail"),k(P,b)},$e=async()=>{const q=(await e(de)).find(B=>B.id===e(te));if(!q)throw new Error("illegal state");return q},V=async()=>{const b=await $e();await b.saveDeckInfo({...b,name:e(m).name,cardNames:e(m).cardInfos.map(q=>q.name),lastUsedAt:new Date}),D()},ve=async()=>{(await ut.createNewDeck(`デッキ_${new Date().formatToYYYYMMDD_HHMMSS("","","")}`,`コピー日時：${new Date().formatToYYYYMMDD_HHMMSS("-"," ",":")}`,e(m).cardInfos.map(q=>q.name))).saveDeckInfo(),D()},X=async b=>{const q=await $e();!b.shiftKey&&!confirm(`デッキ【${q.name}】を削除します。
よろしいですか？`)||(await q.delete(),D())},me=async()=>{const b=await N.deckUploader.show({title:"デッキ情報アップロード",position:"Middle",cancelable:!0,mainCardNames:Object.values(gt).filter(B=>{var pe;return!((pe=B.monsterCategories)!=null&&pe.union(Rt).length)}).map(B=>B.name),exCardNames:Object.values(gt).filter(B=>{var pe;return(pe=B.monsterCategories)==null?void 0:pe.union(Rt).length}).map(B=>B.name)});if(!b)return;const q=[];if(b.replaceAll){if(!confirm(`既存デッキ情報を全て削除し、アップロードしたファイルに置き換えます。
よろしいですか？`))return;q.push(...(await e(de)).map(B=>B.id))}await Promise.all(b.deckInfos.map(B=>ut.createNewDeck(B.name,B.description,B.cardNames,B.lastUsedAt))),q.length&&await Promise.all(q.map(ut.remove)),D()};nt();var W=Ki(),U=O(W),ae=s(a(U),2),re=a(ae),he=a(re),L=a(he),E=s(a(L),2),R=a(E),se=s(L,2),Ne=s(a(se),2),$=a(Ne),p=s($,2),C=s(se,2),G=a(C),H=a(G),ie=s(G,2);oe(ie,5,()=>ba.filter(b=>b!=="XyzMaterial"),ne,(b,q)=>{var B=Ti(),pe=a(B),Fe,Le=s(pe);u(()=>{Fe!==(Fe=e(q))&&(pe.value=(pe.__value=e(q))==null?"":e(q)),f(Le,` ${Ba[e(q)]??""}`)}),kt(t,[],pe,()=>(e(q),e(l).cardKinds),j=>Oe(l,e(l).cardKinds=j)),r(b,B)});var x=s(C,2);{var ue=b=>{var q=Yi(),B=O(q),pe=a(B),Fe=a(pe),Le=s(pe,2);oe(Le,5,()=>Ca,ne,(Qe,Me)=>{var Ue=Ei(),Ie=a(Ue),et,ft=s(Ie);u(()=>{et!==(et=e(Me))&&(Ie.value=(Ie.__value=e(Me))==null?"":e(Me)),f(ft,` ${Gt[e(Me)]??""}${na[e(Me)]??""}`)}),kt(d,[],Ie,()=>(e(Me),e(l).monsterCategories),We=>Oe(l,e(l).monsterCategories=We)),r(Qe,Ue)});var j=s(B,2),ke=a(j),Ee=a(ke),ze=s(ke,2);oe(ze,5,()=>xa,ne,(Qe,Me)=>{var Ue=qi(),Ie=a(Ue),et,ft=s(Ie,2),We=s(ft);u(()=>{et!==(et=e(Me))&&(Ie.value=(Ie.__value=e(Me))==null?"":e(Me)),Ye(ft,`monster_attr ${e(Me)??""} svelte-1s1plv5`),f(We,` ${la[e(Me)]??""}`)}),kt(_,[],Ie,()=>(e(Me),e(l).monsterAttributes),Xe=>Oe(l,e(l).monsterAttributes=Xe)),r(Qe,Ue)});var He=s(j,2),Ve=a(He),Je=a(Ve),at=s(Ve,2);oe(at,5,()=>ka,ne,(Qe,Me)=>{var Ue=Ai(),Ie=a(Ue),et,ft=s(Ie);u(()=>{et!==(et=e(Me))&&(Ie.value=(Ie.__value=e(Me))==null?"":e(Me)),f(ft,` ${zt[e(Me)]??""}
                  ${oa[e(Me)]??""}`)}),kt(c,[],Ie,()=>(e(Me),e(l).monsterTypes),We=>Oe(l,e(l).monsterTypes=We)),Ce("dblclick",Ue,We=>F(We,"monsterTypes",e(Me))),r(Qe,Ue)}),Ce("click",Fe,()=>z("monsterCategories")),Z(3,B,()=>ge,()=>({delay:0,duration:100})),Ce("click",Ee,()=>z("monsterAttributes")),Z(3,j,()=>ge,()=>({delay:0,duration:100})),Ce("click",Je,()=>z("monsterTypes")),Z(3,He,()=>ge,()=>({delay:0,duration:100})),r(b,q)};y(x,b=>{e(l).cardKinds.includes("Monster")&&b(ue)})}var h=s(x,2);{var S=b=>{var q=Ni(),B=a(q),pe=a(B),Fe=s(B,2);oe(Fe,5,()=>wa,ne,(Le,j)=>{var ke=Bi(),Ee=a(ke),ze,He=s(Ee);u(()=>{ze!==(ze=e(j))&&(Ee.value=(Ee.__value=e(j))==null?"":e(j)),f(He,` ${Xt[e(j)]??""}`)}),kt(g,[],Ee,()=>(e(j),e(l).spellCategories),Ve=>Oe(l,e(l).spellCategories=Ve)),r(Le,ke)}),Ce("click",pe,()=>z("spellCategories")),Z(3,q,()=>ge,()=>({delay:0,duration:100})),r(b,q)};y(h,b=>{e(l).cardKinds.includes("Spell")&&b(S)})}var ce=s(h,2);{var be=b=>{var q=Fi(),B=a(q),pe=a(B),Fe=s(B,2);oe(Fe,5,()=>ya,ne,(Le,j)=>{var ke=Ii(),Ee=a(ke),ze,He=s(Ee);u(()=>{ze!==(ze=e(j))&&(Ee.value=(Ee.__value=e(j))==null?"":e(j)),f(He,` ${Vt[e(j)]??""}`)}),kt(v,[],Ee,()=>(e(j),e(l).trapCategories),Ve=>Oe(l,e(l).trapCategories=Ve)),r(Le,ke)}),Ce("click",pe,()=>z("trapCategories")),Z(3,q,()=>ge,()=>({delay:0,duration:100})),r(b,q)};y(ce,b=>{e(l).cardKinds.includes("Trap")&&b(be)})}var Q=s(ce,2),fe=a(Q),_e=a(fe),J=s(fe,2);oe(J,4,()=>[{key:"test",text:"テスト用カードを表示する"}],ne,(b,q)=>{var B=Hi(),pe=a(B),Fe,Le=s(pe);u(()=>{Fe!==(Fe=q.key)&&(pe.value=(pe.__value=q.key)==null?"":q.key),f(Le,` ${q.text??""}`)}),kt(M,[],pe,()=>(q.key,e(l).others),j=>Oe(l,e(l).others=j)),r(b,B)});var K=s(he,2);mi(K,{get cardInfo(){return e(P)}});var ye=s(re,2),Se=a(ye);const Ke=xe(()=>Object.values(gt));Aa(Se,{mode:"List",get allCardInfos(){return e(Ke)},onAttention:ee,get searchCondition(){return e(l)},get deckCardInfos(){return e(m).cardInfos},set deckCardInfos(b){Oe(m,e(m).cardInfos=b)},$$legacy:!0});var qe=s(ye,2),le=a(qe);mt(le,()=>e(de),b=>{var q=Wi();r(b,q)},(b,q)=>{var B=Ri(),pe=O(B),Fe=a(pe),Le=a(Fe),j=s(a(Le));u(()=>{e(te),Et(()=>{e(q)})}),oe(j,5,()=>e(q),ne,(Pe,je)=>{var Ge=Pi(),rt={},st=a(Ge);u(()=>{rt!==(rt=e(je).id)&&(Ge.value=(Ge.__value=e(je).id)==null?"":e(je).id),f(st,e(je).name)}),r(Pe,Ge)});var ke=s(Le,4),Ee=s(a(ke)),ze=s(Fe,4),He=s(a(ze),2),Ve=a(He),Je=s(He,4),at=a(Je),Qe=s(Je,2),Me=a(Qe),Ue=s(ze,2),Ie=s(a(Ue),2);mt(Ie,$e,Pe=>{var je=ji();r(Pe,je)},(Pe,je)=>{var Ge=Ui(),rt=a(Ge);u(st=>ht(rt,"href",st),[()=>ut.convertToObjectURL([e(je)])],xe),r(Pe,Ge)});var et=s(Ie,2);mt(et,()=>e(Be),Pe=>{var je=Li();r(Pe,je)},(Pe,je)=>{var Ge=Oi(),rt=a(Ge);u(()=>ht(rt,"href",e(je))),r(Pe,Ge)});var ft=s(et,2),We=a(ft),Xe=s(pe,2);Aa(Xe,{mode:"Deck",allCardInfos:[],onAttention:ee,get deckCardInfos(){return e(m).cardInfos},set deckCardInfos(Pe){Oe(m,e(m).cardInfos=Pe)},$$legacy:!0}),qt(j,()=>e(te),Pe=>k(te,Pe)),Ce("change",j,Y),ta(Ee,()=>e(m).name,Pe=>Oe(m,e(m).name=Pe)),Ce("click",Ve,V),Ce("click",at,ve),Ce("click",Me,X),Ce("click",We,me),r(b,B)});var we=s(ae,2);we.textContent=`実装済カード${or+Da}枚（内、効果のないモンスター${Da??""}枚）`;var Te=s(U,2);Mi(Te,{modalController:N}),u(()=>Ye(he,`deck_editor_search_box ${(e(I)==="SearchCondition"?"":"minimum")??""} svelte-1s1plv5`)),Ce("click",R,A),ta($,()=>e(l).name,b=>Oe(l,e(l).name=b)),Ce("click",p,()=>Oe(l,e(l).name="")),Ce("click",H,()=>z("cardKinds")),Ce("click",_e,()=>z("others")),Z(3,Q,()=>ge,()=>({delay:0,duration:100})),Ce("mouseenter",he,()=>k(I,"SearchCondition")),r(n,W),vt()}String.prototype.format=(n,...i)=>{for(const[t,d]of i.entries()){const _=new RegExp(`\\{${t}\\}`,"g");n=n.replace(_,d)}return n};String.prototype.toSnakeCase=function(){return this.split(/(?=[A-Z])/).join("_").toLowerCase()};const Gi=["TblDeckHeader","TblDeckDetail","TblDuelistProfile"],Xi=3;var Vi=o('<input class="game_mode_radio svelte-1aa1tc6" type="radio" name="game_mode"> <label> </label>',1),Qi=o('<option class="svelte-1aa1tc6"> </option>'),Zi=o('<option class="svelte-1aa1tc6"> </option>'),Ji=o('<option class="svelte-1aa1tc6"> </option>'),el=o('<tr class="config_row svelte-1aa1tc6"><td class="svelte-1aa1tc6"><div class="svelte-1aa1tc6"><label for="npc_deck_selector" class="config_row_label deck_selector svelte-1aa1tc6">デッキ：</label></div></td><td class="svelte-1aa1tc6"><div class="svelte-1aa1tc6"><select id="npc_deck_selector" class="deck_selector svelte-1aa1tc6"><option class="svelte-1aa1tc6">デフォルト</option><!></select></div></td></tr>'),tl=o('<option class="svelte-1aa1tc6"> </option>'),al=o('<tr class="config_row svelte-1aa1tc6"><td class="svelte-1aa1tc6"><div class="svelte-1aa1tc6"><label for="npc_selector" class="config_row_label npc_selector svelte-1aa1tc6">対戦相手：</label></div></td><td class="svelte-1aa1tc6"><div class="svelte-1aa1tc6"><select id="npc_selector" class="npc_selector svelte-1aa1tc6"></select> <div class="svelte-1aa1tc6"> </div></div></td></tr> <!> <tr class="config_row svelte-1aa1tc6"><td class="svelte-1aa1tc6"><div class="svelte-1aa1tc6"><label for="npc_selector" class="config_row_label npc_selector svelte-1aa1tc6">先攻後攻：</label></div></td><td class="svelte-1aa1tc6"><div class="svelte-1aa1tc6"><select id="npc_selector" class="npc_selector svelte-1aa1tc6"></select></div></td></tr>',1),rl=o('<option class="svelte-1aa1tc6"> </option>'),sl=o('<tr class="config_row svelte-1aa1tc6"><td class="svelte-1aa1tc6"><div class="svelte-1aa1tc6"><label for="difficulty_selector" class="config_row_label difficulty_selector svelte-1aa1tc6">難易度：</label></div></td><td class="svelte-1aa1tc6"><div class="svelte-1aa1tc6"><select id="difficulty_selector" class="difficulty_selector svelte-1aa1tc6"></select></div></td></tr>'),il=o('<tr class="config_row svelte-1aa1tc6"><td class="svelte-1aa1tc6"><div class="svelte-1aa1tc6"><label class="config_row_label svelte-1aa1tc6" for="game_mode_radio_preset">ゲームモード：</label></div></td><td class="svelte-1aa1tc6"><div class="svelte-1aa1tc6"></div></td></tr> <tr class="config_row svelte-1aa1tc6"><td class="svelte-1aa1tc6"><div class="svelte-1aa1tc6"><label for="deck_selector" class="config_row_label deck_selector svelte-1aa1tc6">デッキ：</label></div></td><td class="svelte-1aa1tc6"><div class="svelte-1aa1tc6"><select id="deck_selector" class="deck_selector svelte-1aa1tc6"></select></div></td></tr> <!> <tr><td colspan="2" class="svelte-1aa1tc6"><div><button class="btn svelte-1aa1tc6">duel start!</button></div></td></tr>',1),ll=o('<tr><td colspan="2" class="svelte-1aa1tc6"><div>デッキ情報の読み込み、もしくは作成中...</div></td></tr>'),ol=o('<tr><td colspan="2" class="svelte-1aa1tc6"><div><button class="btn svelte-1aa1tc6">deck edit</button></div></td></tr>'),nl=o('<tr class="config_row svelte-1aa1tc6"><td class="svelte-1aa1tc6"><div class="svelte-1aa1tc6"><label for="duelist_name" class="config_row_label duelist_name svelte-1aa1tc6">名前：</label></div></td><td class="svelte-1aa1tc6"><div class="svelte-1aa1tc6"><input id="duelist_name" class="duelist_name svelte-1aa1tc6" type="text"></div></td></tr> <!> <!>',1),vl=o('<tr><td colspan="2" class="svelte-1aa1tc6"><div>デュエリスト情報の読み込み、もしくは作成中...</div></td></tr>'),dl=o('<div class="app_body svelte-1aa1tc6"><table class="config_table svelte-1aa1tc6"><tbody><!></tbody></table></div>'),cl=o('<div class="result_title result_win svelte-1aa1tc6">YOU WIN</div>'),_l=o('<div class="result_title result_lose svelte-1aa1tc6">YOU LOSE</div>'),ul=o('<div class="result_title result_draw svelte-1aa1tc6">DRAW</div>'),fl=o('<div class="result svelte-1aa1tc6"><!> <div class="reason_of_end svelte-1aa1tc6"> </div> <button class="white_button svelte-1aa1tc6">TOPへ戻る</button></div>'),pl=o('<main style="flex-direction: column; display :flex" class="svelte-1aa1tc6"><div class="link link_left svelte-1aa1tc6"><a href="https://github.com/Setta238/stk_ygo_svelte" target="_blank" rel="noopener noreferrer" title="repository" class="svelte-1aa1tc6">repository</a> <a href="https://x.com/ninja_no" target="_blank" rel="noopener noreferrer" title="repository" class="svelte-1aa1tc6">X(Twitter)</a> <a href="https://posfie.com/@ninja_no/p/Lx7FLj3" target="_blank" rel="noopener noreferrer" title="posfie" class="svelte-1aa1tc6">posfie(toggeter)</a></div> <div class="link link_right svelte-1aa1tc6"><a class="a_button svelte-1aa1tc6" role="button" tabindex="0">TOPへ戻る</a> <a href="/stk_ygo_svelte/note.html" target="_blank" rel="noopener noreferrer" title="repository" class="svelte-1aa1tc6">現時点とこの先のこと</a></div> <!> <div class="debug_info svelte-1aa1tc6"><span class="svelte-1aa1tc6"> </span> <span class="user_agent_info svelte-1aa1tc6"> </span> <span class="screen_info svelte-1aa1tc6"> </span></div> <!></main>');function gl(n,i){ot(i,!1);const t=new nr("stk_ygo_svelte",Xi,Gi);let d=De(0),_=De(0),c=De(),g=De("FtkChallenge"),v=De("None"),M=De(0),N=De(""),w=De(void 0);const l=vr.getOrCreateNew(t).then(p=>(k(g,$a.includes(p.previousGameMode)?p.previousGameMode:"FtkChallenge"),$e(p.previousNpcId),p)),I=p=>{var G;const C=p.find(H=>H.lastUsedAt.getTime()===Math.max(...p.map(ie=>ie.lastUsedAt.getTime())))??p[0];k(M,C.id),e(g)==="FtkChallenge"&&C.deckType!=="Preset"&&k(M,((G=xt.find(H=>H.deckType==="Preset"))==null?void 0:G.id)??e(M))};let A=De(ut.getAllDeckInfo(t).then(p=>(Promise.all(p.filter(C=>!C.lastUsedAt).map(C=>{C.saveDeckInfo()})),I(p),p)));const z=async()=>{const p=e(M);let C=(await e(A)).find(H=>H.id===p)??(await Y()).find(H=>H.id===p);C&&await C.updateTimestamp();let G=C;if(G||(G=xt.find(H=>H.id===p)),!G)throw new Error("illegal state");return G},F=async()=>{(await l).save({previousGameMode:e(g)})},Y=()=>(k(A,ut.getAllDeckInfo(t).then(p=>(I(p),p))),e(A)),T=async()=>{(await e(A)).length||(await ut.prepareSampleDeck(),Y())},te=async()=>{await Promise.all([F(),T()]);const p=await z(),C=await l;let G=Tt.find(x=>x.id===Number.MIN_SAFE_INTEGER)??Tt[0],H=xt.find(x=>x.id===Number.MIN_SAFE_INTEGER)??xt[0],ie="PlayFirst";e(g)==="FtkChallenge"?G=Tt.filter(x=>x.npcType==="FtkChallenge").find(x=>x.difficulty===C.previousDifficulty)??G:e(g)==="Free"&&(G=Tt.find(x=>x.id===C.previousNpcId)??G,H=xt.slice(-1)[0],ie=C.previousStartMode),G.npcType!=="FtkChallenge"&&C.previousNpcDeckId>-1?H=(await e(A)).find(x=>x.id===C.previousNpcDeckId)??H:H=xt.find(x=>x.id===G.id)??H,k(c,new cr(C,"Player",p,[],G,"NPC",H,[],ie)),e(c).onDuelEnd.append(()=>(k(c,e(c)),"RemoveMe"))},de=async()=>{await Promise.all([F(),T()]),k(v,"DeckEdit")},Be=async p=>{await F(),p.key==="Enter"&&!p.repeat&&(await l).save()},D=()=>{k(A,Y()),k(c,void 0),k(v,"None")};let m=Date.now();const P=p=>{Date.now()-m<200||(m=Date.now(),k(g,p),Y())},ee=p=>{$e(Number(p.currentTarget.value))},$e=p=>{var C;k(w,Tt.find(G=>G.id===p)),k(N,((C=e(w))==null?void 0:C.description)??"")};T(),nt();var V=pl(),ve=s(a(V),2),X=a(ve),me=s(ve,2);{var W=p=>{var C=Ae(),G=O(C);mt(G,()=>l,null,(H,ie)=>{Xs(H,{get duel(){return e(c)},get userProfile(){return e(ie)}})}),r(p,C)},U=p=>{var C=Ae(),G=O(C);{var H=x=>{zi(x,{})},ie=x=>{var ue=dl(),h=a(ue),S=a(h),ce=a(S);mt(ce,()=>l,be=>{var Q=vl();r(be,Q)},(be,Q)=>{var fe=nl(),_e=O(fe),J=a(_e),K=a(J),ye=s(J),Se=a(ye),Ke=a(Se),qe=s(_e,2);mt(qe,()=>e(A),Te=>{var b=ll();r(Te,b)},(Te,b)=>{var q=il(),B=O(q),pe=a(B),Fe=a(pe),Le=s(pe),j=a(Le);oe(j,5,()=>$a,ne,(We,Xe)=>{var Pe=Vi(),je=O(Pe),Ge=s(je,2),rt=a(Ge);u(st=>{ht(je,"id",`game_mode_radio_${st??""}`),_r(je,e(Xe)),ur(je,e(g)===e(Xe)),Ye(Ge,`game_mode_tab_label game_mode_tab_${st??""} svelte-1aa1tc6`),ht(Ge,"for",`game_mode_radio_${st??""}`),f(rt,e(Xe))},[()=>e(Xe).toLowerCase()],xe),Ce("change",je,()=>P(e(Xe))),r(We,Pe)});var ke=s(B,2),Ee=a(ke),ze=a(Ee),He=s(Ee),Ve=a(He),Je=a(Ve);u(()=>{e(M),Et(()=>{e(g),e(b)})}),oe(Je,5,()=>e(g)==="FtkChallenge"?xt.filter(We=>We.deckType==="Preset"):e(b),ne,(We,Xe)=>{var Pe=Qi(),je={},Ge=a(Pe);u(()=>{je!==(je=e(Xe).id)&&(Pe.value=(Pe.__value=e(Xe).id)==null?"":e(Xe).id),f(Ge,e(Xe).name)}),r(We,Pe)});var at=s(ke,2);{var Qe=We=>{var Xe=al(),Pe=O(Xe),je=a(Pe),Ge=a(je),rt=s(je),st=a(rt),St=a(st);u(()=>{e(Q),Et(()=>{})}),oe(St,5,()=>Tt,ne,(_t,tt)=>{var dt=Zi(),wt={},Mt=a(dt);u(()=>{wt!==(wt=e(tt).id)&&(dt.value=(dt.__value=e(tt).id)==null?"":e(tt).id),f(Mt,e(tt).name)}),r(_t,dt)});var Ft=s(St,2),Ht=a(Ft),Yt=s(Pe,2);{var Bt=_t=>{var tt=el(),dt=a(tt),wt=a(dt),Mt=s(dt),ua=a(Mt),fa=a(ua);u(()=>{e(Q),Et(()=>{e(b)})});var Qt=a(fa);Qt.value=(Qt.__value=Number.MIN_SAFE_INTEGER)==null?"":Number.MIN_SAFE_INTEGER;var Na=s(Qt);oe(Na,1,()=>e(b),ne,(Zt,jt)=>{var Ot=Ji(),pa={},Ia=a(Ot);u(()=>{pa!==(pa=e(jt).id)&&(Ot.value=(Ot.__value=e(jt).id)==null?"":e(jt).id),f(Ia,e(jt).name)}),r(Zt,Ot)}),Z(3,wt,()=>ge,()=>({duration:200})),Z(3,dt,()=>ge,()=>({duration:200})),qt(fa,()=>e(Q).previousNpcDeckId,Zt=>e(Q).previousNpcDeckId=Zt),Z(3,ua,()=>ge,()=>({duration:200})),Z(3,Mt,()=>ge,()=>({duration:200})),Z(3,tt,()=>ge,()=>({duration:200})),r(_t,tt)};y(Yt,_t=>{var tt;((tt=e(w))==null?void 0:tt.npcType)!=="FtkChallenge"&&_t(Bt)})}var yt=s(Yt,2),bt=a(yt),Pt=a(bt),Ut=s(bt),ca=a(Ut),_a=a(ca);u(()=>{e(Q),Et(()=>{})}),oe(_a,5,()=>ia(Sa),ne,(_t,tt)=>{var dt=tl(),wt={},Mt=a(dt);u(()=>{wt!==(wt=e(tt))&&(dt.value=(dt.__value=e(tt))==null?"":e(tt)),f(Mt,Sa[e(tt)])}),r(_t,dt)}),u(()=>f(Ht,`※${e(N)??""}`)),Z(3,Ge,()=>ge,()=>({duration:200})),Z(3,je,()=>ge,()=>({duration:200})),Ce("change",St,ee),qt(St,()=>e(Q).previousNpcId,_t=>e(Q).previousNpcId=_t),Z(3,st,()=>ge,()=>({duration:200})),Z(3,rt,()=>ge,()=>({duration:200})),Z(3,Pe,()=>ge,()=>({duration:200})),Z(3,Pt,()=>ge,()=>({duration:200})),Z(3,bt,()=>ge,()=>({duration:200})),qt(_a,()=>e(Q).previousStartMode,_t=>e(Q).previousStartMode=_t),Z(3,ca,()=>ge,()=>({duration:200})),Z(3,Ut,()=>ge,()=>({duration:200})),Z(3,yt,()=>ge,()=>({duration:200})),r(We,Xe)},Me=We=>{var Xe=Ae(),Pe=O(Xe);{var je=Ge=>{var rt=sl(),st=a(rt),St=a(st),Ft=s(st),Ht=a(Ft),Yt=a(Ht);u(()=>{e(Q),Et(()=>{})}),oe(Yt,5,()=>fr,ne,(Bt,yt)=>{var bt=rl(),Pt={},Ut=a(bt);u(()=>{Pt!==(Pt=e(yt))&&(bt.value=(bt.__value=e(yt))==null?"":e(yt)),f(Ut,e(yt))}),r(Bt,bt)}),Z(3,St,()=>ge,()=>({duration:200})),Z(3,st,()=>ge,()=>({duration:200})),qt(Yt,()=>e(Q).previousDifficulty,Bt=>e(Q).previousDifficulty=Bt),Z(3,Ht,()=>ge,()=>({duration:200})),Z(3,Ft,()=>ge,()=>({duration:200})),Z(3,rt,()=>ge,()=>({duration:200})),r(Ge,rt)};y(Pe,Ge=>{e(g)==="FtkChallenge"&&Ge(je)},!0)}r(We,Xe)};y(at,We=>{e(g)==="Free"?We(Qe):We(Me,!1)})}var Ue=s(at,2),Ie=a(Ue),et=a(Ie),ft=a(et);Z(3,Fe,()=>ge,()=>({duration:200})),Z(3,pe,()=>ge,()=>({duration:200})),Z(3,j,()=>ge,()=>({duration:200})),Z(3,Le,()=>ge,()=>({duration:200})),Z(3,B,()=>ge,()=>({duration:200})),Z(3,ze,()=>ge,()=>({duration:200})),Z(3,Ee,()=>ge,()=>({duration:200})),qt(Je,()=>e(M),We=>k(M,We)),Z(3,Ve,()=>ge,()=>({duration:200})),Z(3,He,()=>ge,()=>({duration:200})),Z(3,ke,()=>ge,()=>({duration:200})),Ce("click",ft,te),Z(3,et,()=>ge,()=>({duration:200})),r(Te,q)});var le=s(qe,2);{var we=Te=>{var b=ol(),q=a(b),B=a(q),pe=a(B);Ce("click",pe,de),Z(3,B,()=>ge,()=>({duration:200})),Z(3,q,()=>ge,()=>({duration:200})),Z(3,b,()=>ge,()=>({duration:200})),r(Te,b)};y(le,Te=>{e(g)==="Free"&&Te(we)})}Z(3,K,()=>ge,()=>({duration:200})),Z(3,J,()=>ge,()=>({duration:200})),ta(Ke,()=>e(Q).name,Te=>e(Q).name=Te),Ce("keypress",Ke,Be),Z(3,Se,()=>ge,()=>({duration:200})),Z(3,ye,()=>ge,()=>({duration:200})),Z(3,_e,()=>ge,()=>({duration:200})),r(be,fe)}),r(x,ue)};y(G,x=>{e(v)==="DeckEdit"?x(H):x(ie,!1)},!0)}r(p,C)};y(me,p=>{e(c)?p(W):p(U,!1)})}var ae=s(me,2),re=a(ae),he=a(re),L=s(re,2),E=a(L),R=s(L,2),se=a(R),Ne=s(ae,2);{var $=p=>{var C=fl(),G=a(C);{var H=S=>{var ce=Ae(),be=O(ce);{var Q=_e=>{var J=cl();r(_e,J)},fe=_e=>{var J=Ae(),K=O(J);{var ye=Se=>{var Ke=_l();r(Se,Ke)};y(K,Se=>{e(c).winner.seat==="Above"&&Se(ye)},!0)}r(_e,J)};y(be,_e=>{e(c).winner.seat==="Below"?_e(Q):_e(fe,!1)})}r(S,ce)},ie=S=>{var ce=ul();r(S,ce)};y(G,S=>{e(c).winner?S(H):S(ie,!1)})}var x=s(G,2),ue=a(x),h=s(x,2);u(()=>f(ue,e(c).reasonOfEnd)),Ce("click",h,D),Z(3,C,()=>mr,()=>({delay:200,duration:200})),r(p,C)};y(Ne,p=>{e(c)&&e(c).isEnded&&p($)})}u(()=>{f(he,"build at: 20250608_171917"),f(E,dr.text),f(se,`w:${e(d)??""}px h:${e(_)??""}px`)}),Lt("innerWidth",p=>k(d,p)),Lt("innerHeight",p=>k(_,p)),Ce("click",X,D),r(n,V),vt()}pr(gl,{target:document.getElementById("app")});
