var Za=Object.defineProperty;var ja=f=>{throw TypeError(f)};var er=(f,i,t)=>i in f?Za(f,i,{enumerable:!0,configurable:!0,writable:!0,value:t}):f[i]=t;var nt=(f,i,t)=>er(f,typeof i!="symbol"?i+"":i,t),Aa=(f,i,t)=>i.has(f)||ja("Cannot "+t);var ft=(f,i,t)=>(Aa(f,i,"read from private field"),t?t.call(f):i.get(f)),la=(f,i,t)=>i.has(f)?ja("Cannot add the same private member more than once"):i instanceof WeakSet?i.add(f):i.set(f,t),ka=(f,i,t,o)=>(Aa(f,i,"write to private field"),o?o.call(f,t):i.set(f,t),t);import{s as Ba,r as tr,a as D,b as ar,l as rr,g as e,d as za,p as ct,c as Ae,m as le,i as _t,t as l,e as a,f as C,h as g,j as de,k as Be,n as rt,o as z,q as r,u as ut,v as be,D as sr,w as we,x as H,y as s,z as _e,A as Vt,B as oe,C as ue,E as b,F as ir,G as at,H as Xt,I as nr,J as Va,K as ea,L as ca,M as $a,N as oa,O as xa,P as Kt,Q as mt,R as Sa,S as ga,T as Ma,U as da,V as _a,W as Xa,X as ya,Y as ha,Z as lr,_ as or,$ as dr,a0 as vr,a1 as cr,a2 as _r,a3 as ur,a4 as ua,a5 as Ga,a6 as ta,a7 as Qa,a8 as fa,a9 as Lt,aa as fr,ab as mr,ac as aa,ad as pr,ae as Dt,af as gr,ag as yr,ah as hr,ai as La,aj as qa,ak as Ya,al as Ua,am as Ha,an as Pa,ao as br,ap as Et,aq as It,ar as Ot,as as kr,at as Rt,au as xr,av as wr,aw as Na,ax as Zt,ay as zt,az as Cr,aA as Dr,aB as $r,aC as Fa,aD as Sr,aE as Mr,aF as Tr}from"../chunk/entity_proc_20260124_123157.js";import"../chunk/json_20260124_123157.js";(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const m of document.querySelectorAll('link[rel="modulepreload"]'))o(m);new MutationObserver(m=>{for(const c of m)if(c.type==="childList")for(const u of c.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&o(u)}).observe(document,{childList:!0,subtree:!0});function t(m){const c={};return m.integrity&&(c.integrity=m.integrity),m.referrerPolicy&&(c.referrerPolicy=m.referrerPolicy),m.crossOrigin==="use-credentials"?c.credentials="include":m.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function o(m){if(m.ep)return;m.ep=!0;const c=t(m);fetch(m.href,c)}})();const Er=f=>f;function Ta(f){const i=f-1;return i*i*i+1}function Ia(f){const i=typeof f=="string"&&f.match(/^\s*(-?[\d.]+)([^\s]*)\s*$/);return i?[parseFloat(i[1]),i[2]||"px"]:[f,"px"]}function jr(f,{delay:i=0,duration:t=400,easing:o=Er}={}){const m=+getComputedStyle(f).opacity;return{delay:i,duration:t,easing:o,css:c=>`opacity: ${c*m}`}}function Ar(f,{delay:i=0,duration:t=400,easing:o=Ta,x:m=0,y:c=0,opacity:u=0}={}){const d=getComputedStyle(f),B=+d.opacity,A=d.transform==="none"?"":d.transform,$=B*(1-u),[S,n]=Ia(m),[L,R]=Ia(c);return{delay:i,duration:t,easing:o,css:(I,_)=>`
			transform: ${A} translate(${(1-I)*S}${n}, ${(1-I)*L}${R});
			opacity: ${B-$*_}`}}function ke(f,{delay:i=0,duration:t=400,easing:o=Ta,axis:m="y"}={}){const c=getComputedStyle(f),u=+c.opacity,d=m==="y"?"height":"width",B=parseFloat(c[d]),A=m==="y"?["top","bottom"]:["left","right"],$=A.map(p=>`${p[0].toUpperCase()}${p.slice(1)}`),S=parseFloat(c[`padding${$[0]}`]),n=parseFloat(c[`padding${$[1]}`]),L=parseFloat(c[`margin${$[0]}`]),R=parseFloat(c[`margin${$[1]}`]),I=parseFloat(c[`border${$[0]}Width`]),_=parseFloat(c[`border${$[1]}Width`]);return{delay:i,duration:t,easing:o,css:p=>`overflow: hidden;opacity: ${Math.min(p*20,1)*u};${d}: ${p*B}px;padding-${A[0]}: ${p*S}px;padding-${A[1]}: ${p*n}px;margin-${A[0]}: ${p*L}px;margin-${A[1]}: ${p*R}px;border-${A[0]}-width: ${p*I}px;border-${A[1]}-width: ${p*_}px;min-${d}: 0`}}function Oa(f,i){for(const t in i)f[t]=i[t];return f}function Br({fallback:f,...i}){const t=new Map,o=new Map;function m(u,d,B){const{delay:A=0,duration:$=q=>Math.sqrt(q)*30,easing:S=Ta}=Oa(Oa({},i),B),n=u.getBoundingClientRect(),L=d.getBoundingClientRect(),R=n.left-L.left,I=n.top-L.top,_=n.width/L.width,p=n.height/L.height,K=Math.sqrt(R*R+I*I),te=getComputedStyle(d),$e=te.transform==="none"?"":te.transform,j=+te.opacity;return{delay:A,duration:typeof $=="function"?$(K):$,easing:S,css:(q,ce)=>`
			   opacity: ${q*j};
			   transform-origin: top left;
			   transform: ${$e} translate(${ce*R}px,${ce*I}px) scale(${q+(1-q)*_}, ${q+(1-q)*p});
		   `}}function c(u,d,B){return(A,$)=>(u.set($.key,A),()=>{if(d.has($.key)){const S=d.get($.key);return d.delete($.key),m(S,A,$)}return u.delete($.key),f&&f(A,$,B)})}return[c(o,t,!1),c(t,o,!0)]}function Ra(f){return Object.prototype.toString.call(f)==="[object Date]"}function Lr(f){return f}function wa(f){const i=f-1;return i*i*i+1}function Ca(f,i){if(f===i||f!==f)return()=>f;const t=typeof f;if(t!==typeof i||Array.isArray(f)!==Array.isArray(i))throw new Error("Cannot interpolate values of different type");if(Array.isArray(f)){const o=i.map((m,c)=>Ca(f[c],m));return m=>o.map(c=>c(m))}if(t==="object"){if(!f||!i)throw new Error("Object cannot be null");if(Ra(f)&&Ra(i)){const c=f.getTime(),d=i.getTime()-c;return B=>new Date(c+B*d)}const o=Object.keys(i),m={};return o.forEach(c=>{m[c]=Ca(f[c],i[c])}),c=>{const u={};return o.forEach(d=>{u[d]=m[d](c)}),u}}if(t==="number"){const o=i-f;return m=>f+m*o}return()=>i}var qt,ra,va,Gt;const Ea=class Ea{constructor(i,t={}){la(this,qt,Ba(void 0));la(this,ra,Ba(void 0));la(this,va);la(this,Gt,null);ft(this,qt).v=ft(this,ra).v=i,ka(this,va,t)}static of(i,t){const o=new Ea(i(),t);return tr(()=>{o.set(i())}),o}set(i,t){var S;D(ft(this,ra),i);let{delay:o=0,duration:m=400,easing:c=Lr,interpolate:u=Ca}={...ft(this,va),...t};if(m===0)return(S=ft(this,Gt))==null||S.abort(),D(ft(this,qt),i),Promise.resolve();const d=ar.now()+o;let B,A=!1,$=ft(this,Gt);return ka(this,Gt,rr(n=>{if(n<d)return!0;if(!A){A=!0;const R=ft(this,qt).v;B=u(R,i),typeof m=="function"&&(m=m(R,i)),$==null||$.abort()}const L=n-d;return L>m?(D(ft(this,qt),i),!1):(D(ft(this,qt),B(c(L/m))),!0)})),ft(this,Gt).promise}get current(){return e(ft(this,qt))}get target(){return e(ft(this,ra))}set target(i){this.set(i)}};qt=new WeakMap,ra=new WeakMap,va=new WeakMap,Gt=new WeakMap;let ma=Ea;var qr=l('<div class="phase_display svelte-1boxe40"><span class="svelte-1boxe40"> </span> </div>'),Yr=l('<div class="lifepoint_display svelte-1boxe40"><div class="svelte-1boxe40"> </div> <div class="svelte-1boxe40"> </div></div>'),Ur=(f,i,t)=>i(e(t)),Hr=l('<div class="svelte-1boxe40"><button class="phase_button svelte-1boxe40"> </button></div>'),Pr=l("<div><!></div>"),Nr=l('<div class="svelte-1boxe40"><!></div>'),Fr=l("<div><!></div>"),Ir=l('<div class="config_button_wrapper svelte-1boxe40"><button id="config_button" class="svelte-1boxe40">⚙</button></div>'),Or=l("<!> <!> <!> <!>",1),Rr=l('<div style="position: absolute;" class="card_animation_receiver svelte-1boxe40"><!></div>'),Kr=l('<div style="position: absolute; top:0rem" class="svelte-1boxe40">｛効果対象｝</div>'),Wr=l('<!> <div style="position: absolute; display:flex;justify-content: center;"><!></div>',1),zr=l(" <!> 】",1),Vr=l('<div style="position: absolute; bottom:0rem" class="svelte-1boxe40"> <!></div>'),Xr=l("<!> <!>",1),Gr=l('<div class="badge svelte-1boxe40"> </div>'),Qr=l('<div class="card_animation_receiver svelte-1boxe40"><!></div>'),Jr=l("<!> <!> <!> <!>",1),Zr=l('<td><div role="listitem"><!></div></td>');function es(f,i){ct(i,!1);let t=Ae(i,"view",12),o=Ae(i,"row",8),m=Ae(i,"column",8),c=Ae(i,"selectedEntities",28,()=>[]),u=Ae(i,"selectedCells",28,()=>[]),d=le(t().getCell(o(),m())),B=le(new ma(e(d).field.duel.duelists.Above.lp,{duration:400,easing:wa})),A=le(new ma(e(d).field.duel.duelists.Below.lp,{duration:400,easing:wa}));const $=()=>{D(d,t().getCell(o(),m())),be(B,e(B).target=e(d).field.duel.duelists.Above.lp),be(A,e(A).target=e(d).field.duel.duelists.Below.lp)};e(d).onUpdate.append($),t().onDuelUpdate.append($),t().modalController.onUpdate.append($);let S,n=le([]),L=()=>console.log("hoge"),R,I=le([]),_=le(!1),p=le(!1),K=!1;const te=x=>{var F,W;D(ie,[]),c().reset(),S=x.activator,L=x.resolve,D(n,x.dummyActionInfos),D(I,x.chainBlockInfos.flatMap(J=>J.selectedEntities).getDistinct()),R=x.entitiesChoices,D(_,!1),D(p,((F=x.cellsChoices)==null?void 0:F.selectables.includes(e(d)))??!1),K=e(p)&&((W=x.cellsChoices)==null?void 0:W.qty)===1,$()};t().onWaitStart.append(te);const $e=()=>{S=void 0,D(n,[]),L=()=>{console.log("hoge")},R=void 0,D(I,[]),D(_,!1),D(p,!1),K=!1};t().onWaitEnd.append($e);let j=le(!1),q=[];const ce=x=>{q=x.filter(F=>F.dests.includes(e(d))),D(j,q.length>0),$()},Me=()=>{q=[],D(j,!1),$()};t().onDragStart.append(ce),t().onDragEnd.append(Me);const[xe,ve]=ui;let ie=le([]);const je=x=>{if(S=void 0,e(d)===x.to||e(d).entities.includes(x.entity)){D(ie,[...e(ie),x]);const F=x.resolve;D(d,e(d)),setTimeout(()=>{D(ie,e(ie).filter(W=>W!==x)),x.count++,x.count>1&&F()},600)}};t().onAnimation.append(je);const ge=x=>{L({phaseChange:x})},Y=()=>e(d).isStackCell&&e(d).entities.flatMap(x=>x.actions).filter(x=>e(n).map(F=>F.action.seq).some(F=>F===x.seq)).length>0,N=x=>{var F;if(((F=x.target)==null?void 0:F.id)==="config_button"){t(t().infoBoardState="Config",!0),t().requireUpdate();return}if(t(t().infoBoardState="Default",!0),K)L({selectedCells:[e(d)]});else if(e(p))D(_,!e(_)),u(e(_)?[...u(),e(d)]:u().filter(W=>W!==e(d)));else if(e(d).isStackCell){t(t().infoBoardState="CellInfo",!0),t(t().infoBoardCell=e(d),!0),t().requireUpdate();const W=e(d).entities.flatMap(X=>X.actions).map(X=>X.seq),J=e(n).filter(X=>W.includes(X.action.seq));if(J.length){if(!S)return;t().modalController.actionSelector.show({title:"カードを選択。",position:"Bottom",activator:S,dummyActionInfos:J,cancelable:!0}).then(X=>{X&&L({actionInfo:X})});return}}t().requireUpdate(),console.info(e(d),Te(...e(d).visibleEntities))},V=x=>{x.preventDefault(),x.dataTransfer&&(x.dataTransfer.dropEffect="move")},Q=x=>{x.preventDefault(),console.info("drop",x,e(j),q),x.dataTransfer&&(x.dataTransfer.dropEffect="move");try{if(e(j)&&q){if(q.length===1){const F=q[0];L({actionInfo:{...F,dest:e(d)}})}else if(q.length>1){if(!S)throw new sr("想定されない状態");e(d).field.duel.view.modalController.terminateAll(),e(d).field.duel.view.modalController.actionSelector.show({title:"選択",position:"Bottom",activator:S,dummyActionInfos:q.map(F=>({...F,dest:e(d)})),cancelable:!1}).then(F=>{L({actionInfo:F})})}}}finally{t().removeDraggingActions()}},Te=(...x)=>{if(t().waitMode==="Animation")return"Disabled";if(R&&R.selectables.find(W=>x.find(J=>W===J)))return"Selectable";if(!e(n)||e(n).length===0||t().waitMode!=="Free"||Object.values(t().modalController.modals).some(W=>W.state==="Shown"))return"Disabled";const F=e(n).filter(W=>x.includes(W.action.entity));return F.length===0?"Disabled":e(d).isStackCell||F[0].action.entity!==x[0]?"Clickable":F.some(W=>W.dests.length)?"Draggable":"Clickable"};_t();var E=Zr(),M=a(E);M.__click=N;var P=a(M);{var Z=x=>{var F=we(),W=H(F);{var J=X=>{var fe=we(),T=H(fe);{var w=y=>{var U=qr(),G=a(U),Ce=a(G),De=s(G,1,!0);g((me,ne)=>{b(Ce,me),b(De,ne)},[()=>String(e(d).field.duel.clock.turn).padStart(2,"0"),()=>e(d).field.duel.phase.toUpperCase()],de),r(y,U)},v=y=>{var U=we(),G=H(U);{var Ce=me=>{var ne=Yr(),re=a(ne),ae=a(re),Se=s(re,2),Re=a(Se);g((Ie,Ke)=>{b(ae,Ie),b(Re,Ke)},[()=>Math.floor(e(B).current),()=>Math.floor(e(A).current)],de),r(me,ne)},De=me=>{var ne=we(),re=H(ne);{var ae=Se=>{var Re=we(),Ie=H(Re);{var Ke=Ue=>{var Ge=we(),lt=H(Ge);{var Ye=he=>{var Le=we(),He=H(Le);_e(He,1,()=>t().duel.nextPhaseList,ue,(We,st)=>{var Xe=Hr(),et=a(Xe);et.__click=[Ur,ge,st];var $t=a(et);g(vt=>b($t,vt),[()=>e(st).toUpperCase()],de),r(We,Xe)}),r(he,Le)};C(lt,he=>{t().duel.isEnded||he(Ye)})}r(Ue,Ge)};C(Ie,Ue=>{t().waitMode==="Free"&&Ue(Ke)})}r(Se,Re)};C(re,Se=>{e(d).column===5&&Se(ae)},!0)}r(me,ne)};C(G,me=>{e(d).column===3?me(Ce):me(De,!1)},!0)}r(y,U)};C(T,y=>{e(d).column===1?y(w):y(v,!1)})}r(X,fe)};C(W,X=>{e(d).row===3&&X(J)})}r(x,F)},se=x=>{var F=we(),W=H(F);{var J=fe=>{var T=Or();const w=de(()=>e(ie).find(ne=>ne.to===e(d)));var v=H(T);{var y=ne=>{var re=Pr(),ae=a(re);Vt(ae,{get entity(){return e(w).entity},state:"Disabled",dummyActionInfos:[],cardActionResolve:void 0}),g(()=>Be(re,`card_animation_receiver ${e(d).cellType??""} svelte-1boxe40`)),oe(1,re,()=>ve,()=>({key:e(w).entity.seq})),r(ne,re)};C(v,ne=>{e(w)&&e(w).index==="Top"&&ne(y)})}var U=s(v,2);_e(U,1,()=>e(d).visibleEntities,ue,(ne,re)=>{var ae=we(),Se=H(ae);{var Re=Ie=>{var Ke=Nr(),Ue=a(Ke);const Ge=de(()=>Te(e(re))),lt=de(()=>e(n).filter(Ye=>Ye.action.entity===e(re)));Vt(Ue,{get entity(){return e(re)},get state(){return e(Ge)},get dummyActionInfos(){return e(lt)},cardActionResolve:void 0,get selectedList(){return c()},set selectedList(Ye){c(Ye)},$$legacy:!0}),oe(2,Ke,()=>xe,()=>({key:e(re).seq})),r(Ie,Ke)};C(Se,Ie=>{e(ie).every(Ke=>Ke.entity.seq!==e(re).seq)&&Ie(Re)})}r(ne,ae)});var G=s(U,2);{var Ce=ne=>{var re=Fr(),ae=a(re);Vt(ae,{get entity(){return e(w).entity},state:"Disabled",dummyActionInfos:[],cardActionResolve:void 0}),g(()=>Be(re,`card_animation_receiver ${e(d).cellType??""} svelte-1boxe40`)),oe(1,re,()=>ve,()=>({key:e(w).entity.seq})),r(ne,re)};C(G,ne=>{e(w)&&e(w).index!=="Top"&&ne(Ce)})}var De=s(G,2);{var me=ne=>{var re=Ir();r(ne,re)};C(De,ne=>{e(d).owner.seat==="Below"&&ne(me)})}r(fe,T)},X=fe=>{var T=Jr();const w=de(()=>e(ie).find(re=>re.to===e(d)));var v=H(T);{var y=re=>{var ae=Rr(),Se=a(ae);Vt(Se,{get entity(){return e(w).entity},state:"Disabled",dummyActionInfos:[],cardActionResolve:void 0}),oe(1,ae,()=>ve,()=>({key:e(w).entity.seq})),r(re,ae)};C(v,re=>{e(w)&&e(w).index!=="Top"&&re(y)})}var U=s(v,2);{var G=re=>{var ae=Xr(),Se=H(ae);_e(Se,1,()=>e(d).visibleEntities.map((Ke,Ue)=>({index:Ue,entity:Ke})).toReversed(),ue,(Ke,Ue)=>{var Ge=we(),lt=H(Ge);{var Ye=he=>{var Le=Wr();const He=de(()=>!e(d).isStackCell&&e(Ue).index===0?Te(...e(d).visibleEntities):void 0);var We=H(Le);{var st=vt=>{var St=Kr();r(vt,St)};C(We,vt=>{e(I).includes(e(Ue).entity)&&vt(st)})}var Xe=s(We,2),et=a(Xe);const $t=de(()=>e(Ue).index===0?e(n).filter(vt=>e(d).visibleEntities.includes(vt.action.entity)):void 0);Vt(et,{get entity(){return e(Ue).entity},get state(){return e(He)},get dummyActionInfos(){return e($t)},cardActionResolve:void 0,get selectedList(){return c()},set selectedList(vt){c(vt)},$$legacy:!0}),g(()=>Be(Xe,`duel_card_wrapper ${(e(Ue).entity.exist?"duel_card_wrapper_exists":"")??""} svelte-1boxe40`)),oe(2,Xe,()=>xe,()=>({key:e(Ue).entity.seq})),r(he,Le)};C(lt,he=>{e(ie).every(Le=>Le.entity.seq!==e(Ue).entity.seq)&&he(Ye)})}r(Ke,Ge)});var Re=s(Se,2);{var Ie=Ke=>{var Ue=Vr(),Ge=a(Ue),lt=s(Ge);_e(lt,1,()=>Xt(e(d).visibleEntities[0].status.maxCounterQty),ue,(Ye,he)=>{var Le=zr(),He=H(Le),We=s(He);{var st=Xe=>{var et=at();g(()=>b(et,`/${e(d).visibleEntities[0].status.maxCounterQty[e(he)]??""}`)),r(Xe,et)};C(We,Xe=>{(e(d).visibleEntities[0].status.maxCounterQty[e(he)]??9999)<100&&Xe(st)})}g((Xe,et)=>b(He,`【
              ${Xe??""}${et??""} `),[()=>ir(e(he)),()=>e(d).visibleEntities[0].counterHolder.getQty(e(he))],de),r(Ye,Le)}),g(()=>b(Ge,`【${e(d).visibleEntities[0].battlePositionName??""}】 `)),r(Ke,Ue)};C(Re,Ke=>{e(d).visibleEntities[0].battlePosition&&Ke(Ie)})}r(re,ae)};C(U,re=>{e(d).visibleEntities.length>0&&re(G)})}var Ce=s(U,2);{var De=re=>{var ae=Gr(),Se=a(ae);g(()=>b(Se,e(d).visibleEntities.length)),r(re,ae)};C(Ce,re=>{e(d).isStackCell&&re(De)})}var me=s(Ce,2);{var ne=re=>{var ae=Qr(),Se=a(ae);Vt(Se,{get entity(){return e(w).entity},state:"Disabled",dummyActionInfos:[],cardActionResolve:void 0}),oe(1,ae,()=>ve,()=>({key:e(w).entity.seq})),r(re,ae)};C(me,re=>{e(w)&&e(w).index==="Top"&&re(ne)})}r(fe,T)};C(W,fe=>{e(d).cellType==="Hand"?fe(J):fe(X,!1)},!0)}r(x,F)};C(P,x=>{e(d).isDisabledCell?x(Z):x(se,!1)})}g(x=>{Be(E,`${`duel_field_cell duel_field_cell_${e(d).cellType} ${e(d).linkArrowSources.length===0?"":"duel_field_cell_linked"}`??""} svelte-1boxe40`),rt(E,"colspan",e(d).cellType==="Hand"?7:1),Be(M,`${x??""} svelte-1boxe40`)},[()=>`duel_field_cell_inner_box ${e(d).cellType} ${e(j)?"can_accept_drop":""} ${Y()?"can_action":""} ${e(_)?"is_selected":e(p)?"is_selectable":""} `],de),z("dragover",M,V),z("drop",M,Q),r(f,E),ut()}za(["click"]);const ts=(f,i,t=void 0,o="!!!circular reference!!!")=>{let m=[];return JSON.stringify(f,(c,u)=>{if(typeof u=="object"){if(m.indexOf(u)>-1)return o;m.push(u)}let d=u;if(i&&(d=i(c,u)),typeof d=="function")return d.toString();if(d!==u&&typeof d=="object"){if(m.indexOf(d)>-1)return o;m.push(d)}return d},t)};var as=l('<div class="title svelte-14z6bdh"> </div>'),rs=l('<div class="title svelte-14z6bdh"> </div>'),ss=l('<div class="duel_log_chain_number svelte-14z6bdh"> </div>'),is=l('<div><a class="white_button" download="error_info.json">エラー情報ダウンロード</a></div>'),ns=l("<div><!> <!></div>"),ls=l('<div><div style="display: flex;    justify-content: space-between;"><div style=" white-space: nowrap;text-align: center;"> </div> <!></div> <!></div>'),os=l("<div><!> <!></div>"),ds=l("<div><!> <!></div>"),vs=l('<div class="duel_log svelte-14z6bdh"><div class="duel_log_header svelte-14z6bdh"></div> <div class="duel_log_body svelte-14z6bdh"></div> <div class="duel_log_footer svelte-14z6bdh"></div></div>');function cs(f,i){ct(i,!1);let t=le(void 0),o=Ae(i,"log",8),m,c=le([]);const u=()=>{const $=((m==null?void 0:m.seq)??-1)+1;o().records.slice($).forEach(S=>{if(!m){D(c,[[[[S]]]]),m=S;return}if(!e(c)[S.clock.turn]){be(c,e(c)[S.clock.turn]=[[[S]]]),m=S;return}if(!e(c)[S.clock.turn][S.clock.phaseSeq]){be(c,e(c)[S.clock.turn][S.clock.phaseSeq]=[[S]]),m=S;return}if(m.clock.chainSeq===S.clock.chainSeq&&m.clock.chainBlockSeq===S.clock.chainBlockSeq&&m.duelist===S.duelist){e(c)[S.clock.turn][S.clock.phaseSeq].slice(-1)[0].push(S),m=S;return}e(c)[S.clock.turn][S.clock.phaseSeq].push([S]),m=S}),D(c,e(c)),nr().then(()=>e(t)&&e(t).scroll(0,e(t).clientHeight*990))};o().onUpdate.append(u),o().duel.view.onDuelUpdate.append(u),u(),_t();var d=we(),B=H(d);{var A=$=>{var S=vs(),n=s(a(S),2);_e(n,5,()=>e(c),ue,(L,R)=>{var I=ds(),_=a(I);{var p=te=>{var $e=as(),j=a($e);g(()=>b(j,`ターン：${e(R)[0][0][0].clock.turn??""}`)),r(te,$e)};C(_,te=>{e(R)[0][0][0].clock.turn>0&&te(p)})}var K=s(_,2);_e(K,1,()=>e(R),ue,(te,$e)=>{var j=os(),q=a(j);{var ce=xe=>{var ve=rs(),ie=a(ve);g(()=>b(ie,e($e)[0][0].clock.period.name)),r(xe,ve)};C(q,xe=>{e($e)[0][0].clock.turn>0&&xe(ce)})}var Me=s(q,2);_e(Me,1,()=>e($e),ue,(xe,ve)=>{var ie=ls();const je=de(()=>{var E;return((E=e(ve).find(M=>M.chainNumber!==void 0))==null?void 0:E.chainNumber)??0});var ge=a(ie),Y=a(ge),N=a(Y),V=s(Y,2);{var Q=E=>{var M=ss(),P=a(M);g(()=>b(P,`チェーン：${e(je)??""}`)),r(E,M)};C(V,E=>{e(je)&&E(Q)})}var Te=s(ge,2);_e(Te,1,()=>e(ve),ue,(E,M)=>{var P=ns(),Z=a(P);{var se=J=>{var X=at();g(()=>b(X,e(M).text)),r(J,X)},x=J=>{var X=we(),fe=H(X);{var T=v=>{var y=at();g((U,G,Ce)=>b(y,`移動：${U??""} ${G??""} ⇒ ${Ce??""}`),[()=>{var U;return(U=e(M).mainEntity)==null?void 0:U.toString()},()=>{var U;return(U=e(M).from)==null?void 0:U.toString()},()=>{var U;return(U=e(M).to)==null?void 0:U.toString()}],de),r(v,y)},w=v=>{var y=we(),U=H(y);{var G=De=>{var me=at();g((ne,re)=>b(me,`生成：${ne??""} void ⇒ ${re??""}`),[()=>{var ne;return(ne=e(M).mainEntity)==null?void 0:ne.toString()},()=>{var ne;return(ne=e(M).to)==null?void 0:ne.toString()}],de),r(De,me)},Ce=De=>{var me=we(),ne=H(me);{var re=Se=>{var Re=at();g((Ie,Ke)=>b(Re,`消滅：${Ie??""} ${Ke??""} ⇒ void`),[()=>{var Ie;return(Ie=e(M).mainEntity)==null?void 0:Ie.toString()},()=>{var Ie;return(Ie=e(M).from)==null?void 0:Ie.toString()}],de),r(Se,Re)},ae=Se=>{var Re=at();g(()=>b(Re,e(M).text)),r(Se,Re)};C(ne,Se=>{e(M).type==="EntityDisappear"?Se(re):Se(ae,!1)},!0)}r(De,me)};C(U,De=>{e(M).type==="EntityAppear"?De(G):De(Ce,!1)},!0)}r(v,y)};C(fe,v=>{e(M).type==="EntityMove"?v(T):v(w,!1)},!0)}r(J,X)};C(Z,J=>{e(M).type==="ChainBlockHeader"?J(se):J(x,!1)})}var F=s(Z,2);{var W=J=>{var X=is(),fe=a(X);g(T=>rt(fe,"href",T),[()=>window.URL.createObjectURL(new Blob([ts(e(M).error,(T,w)=>["pool","bundles","duel"].includes(T)||typeof w=="function"?void 0:w,4)],{type:"text/plain"}))],de),r(J,X)};C(F,J=>{e(M).error&&J(W)})}g(J=>Be(P,`duel_log_record duel_log_record_${J??""} svelte-14z6bdh`),[()=>e(M).type.toSnakeCase()],de),r(E,P)}),g(()=>{var E,M,P;Be(ie,`duel_log_block_duelist duel_log_block_duelist_${((E=e(ve)[0].duelist)==null?void 0:E.seat)??"system"} svelte-14z6bdh`),Be(Y,`duelist ${((M=e(ve)[0].duelist)==null?void 0:M.seat)??""} svelte-14z6bdh`),b(N,((P=e(ve)[0].duelist)==null?void 0:P.profile.name)||"SYSTEM")}),r(xe,ie)}),g(()=>Be(j,`duel_log_block_phase duel_log_block_phase_${e($e)[0][0].clock.period.key??""} svelte-14z6bdh`)),r(te,j)}),g(()=>Be(I,`duel_log_block_turn duel_log_block_turn_${e(R)[0][0][0].clock.turn??""} svelte-14z6bdh`)),r(L,I)}),Va(n,L=>D(t,L),()=>e(t)),r($,S)};C(B,$=>{(o().duel.view.infoBoardState==="Log"||o().duel.view.infoBoardState==="Default")&&$(A)})}r(f,d),ut()}var _s=l("<div><div> </div> <div> </div></div>");function Ka(f,i){ct(i,!1);let t=Ae(i,"duelist",12),o=le(0),m=le();const c=async()=>{const n=t().lp-e(o);if(!e(m)||Math.abs(n)<10){D(o,t().lp),e(m)&&(e(m)(),D(m,void 0));return}D(o,e(o)+Math.floor(Math.random()*n)),await ea(100),c()},u=()=>{t(t()),!e(m)&&t().lp!==e(o)&&new Promise(n=>{D(m,n),Math.abs(t().lp-e(o)),c()})};t().duel.log.onUpdate.append(u),c(),_t();var d=_s(),B=a(d),A=a(B),$=s(B,2),S=a($);g(n=>{Be(d,`duelist duelist_${n??""} svelte-1sy3trd`),Be(B,`duelist_name duelist_${n??""}_name svelte-1sy3trd`),b(A,t().profile.name),Be($,`duelist_lp ${(e(m)?"vibration":"")??""} svelte-1sy3trd`),b(S,e(o))},[()=>t().seat.toLowerCase()],de),r(f,d),ut()}const us=(f,i,t)=>(i(i()!=="Detail"?"Detail":"Normal"),console.info(t()),!0),fs=(f,i,t)=>(i(i()!=="Debug"?"Debug":"Normal"),console.info(t()),!0);var ms=l('<div class="svelte-1uevs9j"> </div>'),ps=l('<div class="svelte-1uevs9j"> </div>'),gs=l('<div class="link_arrow_emoji svelte-1uevs9j"> </div>'),ys=l('<div class="duel_card_info_row svelte-1uevs9j" style=" justify-content: space-between;"><div class="svelte-1uevs9j"> </div> <div class="svelte-1uevs9j"> </div></div>'),hs=l('<div></div> <div class="svelte-1uevs9j"> </div>',1),bs=l("<div> </div>"),ks=l('<span class="svelte-1uevs9j">/</span> <div class="monster_defense svelte-1uevs9j"> </div>',1),xs=l("<div> </div>"),ws=l('<div class="duel_card_info_row svelte-1uevs9j"><!> <!> <div style="flex-grow: 1;" class="svelte-1uevs9j"></div> <div class="monster_attack svelte-1uevs9j"> </div> <!></div> <div class="duel_card_info_row svelte-1uevs9j"></div>',1),Cs=l('<div class="duel_card_row svelte-1uevs9j"><div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"> </div></div>'),Ds=l('<div class="duel_card_row svelte-1uevs9j"><div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"> </div></div>'),$s=l("<!> <!>",1),Ss=l('<pre class="description svelte-1uevs9j"> </pre>'),Ms=l('<div class="duel_card_info_row svelte-1uevs9j" style="border-style: solid; border-width: 1px;"><!></div>'),Ts=l('<pre class="description svelte-1uevs9j"> </pre>'),Es=l('<!> <div class="duel_card_info_row svelte-1uevs9j"><!></div>',1),js=l('<div class="effect_counter_area_item svelte-1uevs9j"><span class="svelte-1uevs9j"> </span> <span class="svelte-1uevs9j"> </span> <span class="svelte-1uevs9j">/</span> <span class="svelte-1uevs9j"> </span></div>'),As=l('<div class="duel_card_info_row effect_counter_area svelte-1uevs9j"><div class="effect_counter_area_title svelte-1uevs9j">効果使用状況</div> <div class="effect_counter_area_body svelte-1uevs9j"></div></div>'),Bs=l("[ <!> ],",1),Ls=l('<div class="svelte-1uevs9j"> <!></div>'),qs=l('<div class="svelte-1uevs9j"> </div> <!> <div class="svelte-1uevs9j"></div>',1),Ys=l('<div class="svelte-1uevs9j"> </div>'),Us=l('<div class="svelte-1uevs9j"> </div>'),Hs=l('<div class="svelte-1uevs9j"> </div>'),Ps=l('<div class="svelte-1uevs9j"> </div>'),Ns=l('<div class="svelte-1uevs9j"> </div>'),Fs=l('<div class="svelte-1uevs9j"> </div>'),Is=l('<div class="duel_card_info_row svelte-1uevs9j"><div class="svelte-1uevs9j"><!> <div class="svelte-1uevs9j"></div> <!> <div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"></div> <!> <div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"></div> <!> <div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"></div> <!> <div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"></div> <!> <div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"></div> <!> <div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"> </div> <div class="svelte-1uevs9j"> </div> <div class="svelte-1uevs9j"> </div> <div class="svelte-1uevs9j"></div></div></div>'),Os=l('<div class="svelte-1uevs9j">※エラッタ前のカードです</div>'),Rs=l('<div class="svelte-1uevs9j">※テスト用カードです</div>'),Ks=l('<a target="_blank" rel="noopener noreferrer" title="コナミカードデータベース" class="svelte-1uevs9j"> </a>'),Ws=l('<a target="_blank" rel="noopener noreferrer" title="遊戯王カードWiki" class="svelte-1uevs9j">⇒遊戯王カードWiki</a>'),zs=l('<div class="duel_card_info_links svelte-1uevs9j"><!> <!> <a target="_blank" rel="noopener noreferrer" title="google" class="svelte-1uevs9j">⇒google検索</a></div>'),Vs=l("<!> <!>",1),Xs=l('<div role="contentinfo"><div class="duel_card_info_header svelte-1uevs9j"><div class="duel_card_info_row svelte-1uevs9j"><div class="svelte-1uevs9j"> </div></div> <div class="duel_card_info_row svelte-1uevs9j" style="position:sticky; top:0;"><!> <div class="svelte-1uevs9j"> </div></div> <!></div> <div class="duel_card_info_body svelte-1uevs9j"><!></div> <div class="duel_card_info_footer svelte-1uevs9j"><!></div></div>');function Gs(f,i){ct(i,!1);let t=Ae(i,"entity",8),o=Ae(i,"mode",12,"Normal"),m=le(new Promise(()=>{}));const c=()=>{var $,S;let A=t()&&t().entityType==="Card"?t().origin.cardId:(S=($=t())==null?void 0:$.parent)==null?void 0:S.origin.cardId;return A??!1?`https://www.db.yugioh-card.com/yugiohdb/card_search.action?ope=2&cid=${A}`:t()?`https://www.db.yugioh-card.com/yugiohdb/card_search.action?ope=1&sess=1&rp=10&mode=&sort=1&keyword=${t().origin.name}&stype=1&ctype=&othercon=2&starfr=&starto=&pscalefr=&pscaleto=&linkmarkerfr=&linkmarkerto=&link_m=2&atkfr=&atkto=&deffr=&defto=&releaseDStart=1&releaseMStart=1&releaseYStart=1999&releaseDEnd=&releaseMEnd=&releaseYEnd=`:""};ca(()=>(Kt(t()),xa),()=>{D(m,oa.then(async A=>{if(t().origin.description||t().origin.pendulumDescription||t().origin.wikiEncodedName)return t().origin;const $=A.getCardInfo(t().origin.name);if($)return $.cardId!==void 0&&!$.description&&!$.pendulumDescription&&await xa([$.cardId]),$}))}),$a(),_t();var u=we(),d=H(u);{var B=A=>{var $=Xs();$.__click=[us,o,t],$.__contextmenu=[fs,o,t];var S=a($),n=a(S),L=a(n),R=a(L),I=s(n,2),_=a(I);{var p=Y=>{var N=ms(),V=a(N);g(Q=>b(V,Q),[()=>"★".repeat(t().lvl)],de),r(Y,N)},K=Y=>{var N=we(),V=H(N);{var Q=E=>{var M=ps(),P=a(M);g(Z=>b(P,Z),[()=>"☆".repeat(t().rank)],de),r(E,M)},Te=E=>{var M=we(),P=H(M);{var Z=se=>{var x=gs(),F=a(x);g(W=>b(F,W),[()=>t().origin.linkArrowKeys.map(W=>Xa[W].emoji).join("")],de),r(se,x)};C(P,se=>{t().origin.linkArrowKeys&&se(Z)},!0)}r(E,M)};C(V,E=>{t().rank&&t().rank>0?E(Q):E(Te,!1)},!0)}r(Y,N)};C(_,Y=>{t().lvl&&t().lvl>0?Y(p):Y(K,!1)})}var te=s(_,2),$e=a(te),j=s(I,2);{var q=Y=>{var N=$s(),V=H(N);{var Q=P=>{var Z=ys(),se=a(Z),x=a(se),F=s(se,2),W=a(F);g(()=>{b(x,`◀ ${t().psL??""}`),b(W,`${t().psR??""} ▶`)}),r(P,Z)};C(V,P=>{var Z;(Z=t().origin.monsterCategories)!=null&&Z.includes("Pendulum")&&P(Q)})}var Te=s(V,2);{var E=P=>{var Z=ws(),se=H(Z),x=a(se);_e(x,1,()=>t().attr,ue,(w,v)=>{var y=hs(),U=H(y),G=s(U,2),Ce=a(G);g(()=>{Be(U,`monster_attr ${e(v)??""} svelte-1uevs9j`),b(Ce,`${Sa[e(v)]??""}属性`)}),r(w,y)});var F=s(x,2);_e(F,1,()=>t().types,ue,(w,v)=>{var y=bs(),U=a(y);g(()=>{Be(y,`monster_cat ${e(v)??""} svelte-1uevs9j`),b(U,`${ga[e(v)]??""}${Ma[e(v)]??""}族`)}),r(w,y)});var W=s(F,4),J=a(W),X=s(W,2);{var fe=w=>{var v=ks(),y=s(H(v),2),U=a(y);g(()=>b(U,t().def??"?")),r(w,v)};C(X,w=>{var v;(v=t().status.monsterCategories)!=null&&v.includes("Link")||w(fe)})}var T=s(se,2);_e(T,5,()=>t().status.monsterCategories??[],ue,(w,v)=>{var y=xs(),U=a(y);g(()=>{Be(y,`monster_cat ${e(v)??""} svelte-1uevs9j`),b(U,`${da[e(v)]??""}${_a[e(v)]??""}`)}),r(w,y)}),g(()=>b(J,t().atk??"?")),r(P,Z)},M=P=>{var Z=we(),se=H(Z);{var x=W=>{var J=Cs(),X=s(a(J),2),fe=a(X);g(()=>b(fe,`${ya[t().status.spellCategory]??""}魔法`)),r(W,J)},F=W=>{var J=we(),X=H(J);{var fe=T=>{var w=Ds(),v=s(a(w),2),y=a(v);g(()=>b(y,`${ha[t().status.trapCategory]??""}罠`)),r(T,w)};C(X,T=>{t().kind==="Trap"&&t().status.trapCategory&&T(fe)},!0)}r(W,J)};C(se,W=>{t().kind==="Spell"&&t().status.spellCategory?W(x):W(F,!1)},!0)}r(P,Z)};C(Te,P=>{t().kind==="Monster"?P(E):P(M,!1)})}r(Y,N)};C(j,Y=>{o()!=="Debug"&&Y(q)})}var ce=s(S,2),Me=a(ce);{var xe=Y=>{var N=Es(),V=H(N);{var Q=M=>{var P=Ms(),Z=a(P);mt(Z,()=>e(m),se=>{var x=at('"読み込み中"');r(se,x)},(se,x)=>{var F=Ss(),W=a(F);g(()=>{var J;return b(W,(J=e(x))==null?void 0:J.pendulumDescription)}),r(se,F)}),r(M,P)};C(V,M=>{var P;(P=t().status.monsterCategories)!=null&&P.includes("Pendulum")&&M(Q)})}var Te=s(V,2),E=a(Te);mt(E,()=>e(m),M=>{var P=at('"読み込み中"');r(M,P)},(M,P)=>{var Z=Ts(),se=a(Z);g(()=>{var x;return b(se,(x=e(P))==null?void 0:x.description)}),r(M,Z)}),r(Y,N)},ve=Y=>{var N=we(),V=H(N);{var Q=E=>{var M=we(),P=H(M);{var Z=se=>{var x=As(),F=s(a(x),2);_e(F,5,()=>t().actions,ue,(W,J)=>{var X=we();const fe=de(()=>e(J).actionCountUpperBound),T=de(()=>e(J).actionCount);var w=H(X);{var v=y=>{var U=js(),G=a(U),Ce=a(G),De=s(G,2),me=a(De),ne=s(De,4),re=a(ne);g(()=>{b(Ce,e(J).title),b(me,e(T)),b(re,e(fe))}),r(y,U)};C(w,y=>{e(fe)!==void 0&&e(T)!==void 0&&y(v)})}r(W,X)}),r(se,x)};C(P,se=>{t().actions.some(x=>x.actionCountUpperBoundKey)&&se(Z)})}r(E,M)},Te=E=>{var M=Is(),P=a(M),Z=a(P);_e(Z,0,()=>["info","status"],ue,(Ye,he)=>{var Le=qs(),He=H(Le),We=a(He),st=s(He,2);_e(st,1,()=>Object.entries(t()[he]),ue,(et,$t)=>{let vt=()=>e($t)[0],St=()=>e($t)[1];var jt=Ls(),Yt=a(jt),sa=s(Yt);{var Ut=kt=>{var Mt=Bs(),xt=s(H(Mt));_e(xt,1,St,ue,(ia,na)=>{var h=at();g(k=>b(h,`${k??""},`),[()=>e(na).toString()],de),r(ia,h)}),r(kt,Mt)},Qt=kt=>{var Mt=at();g(xt=>b(Mt,`${xt??""},`),[()=>{var xt;return(xt=St())==null?void 0:xt.toString()}],de),r(kt,Mt)};C(sa,kt=>{Array.isArray(St())?kt(Ut):kt(Qt,!1)})}g(()=>b(Yt,`"${vt()??""}" : `)),r(et,jt)});var Xe=s(st,2);Xe.textContent="},",g(()=>b(We,`"${he??""}" :{`)),r(Ye,Le)});var se=s(Z,2);se.textContent='"actions" :[';var x=s(se,2);_e(x,1,()=>t().actions,ue,(Ye,he)=>{var Le=Ys(),He=a(Le);g(()=>b(He,`"${e(he).playType??""} ${e(he).title??""}",`)),r(Ye,Le)});var F=s(x,2);F.textContent="],";var W=s(F,2);W.textContent='"substituteEffects" :[';var J=s(W,2);_e(J,1,()=>t().substituteEffects,ue,(Ye,he)=>{var Le=Us(),He=a(Le);g(()=>b(He,`"${e(he).title??""}",`)),r(Ye,Le)});var X=s(J,2);X.textContent="],";var fe=s(X,2);fe.textContent='"continuousEffects" :[';var T=s(fe,2);_e(T,1,()=>t().continuousEffects,ue,(Ye,he)=>{var Le=Hs(),He=a(Le);g(()=>b(He,`"${e(he).isStarted??""}",`)),r(Ye,Le)});var w=s(T,2);w.textContent="],";var v=s(w,2);v.textContent='"procFilters" :[';var y=s(v,2);_e(y,1,()=>t().procFilterBundle.operators,ue,(Ye,he)=>{var Le=Ps(),He=a(Le);g(We=>b(He,`"${We??""} ${e(he).title??""} ${e(he).isEffective??""} ",`),[()=>e(he).isSpawnedBy.toString()],de),r(Ye,Le)});var U=s(y,2);U.textContent="],";var G=s(U,2);G.textContent='"numericStateOperators" :[';var Ce=s(G,2);_e(Ce,1,()=>t().numericOprsBundle.operators,ue,(Ye,he)=>{var Le=Ns(),He=a(Le);g(We=>b(He,`"${We??""} ${e(he).title??""} ${e(he).isEffective??""} ${e(he).isContinuous??""} ${e(he).targetState??""} ${e(he).targetStateGen??""} ",`),[()=>e(he).isSpawnedBy.toString()],de),r(Ye,Le)});var De=s(Ce,2);De.textContent="],";var me=s(De,2);me.textContent='"stateOperators" :[';var ne=s(me,2);_e(ne,1,()=>t().statusOperatorBundle.operators,ue,(Ye,he)=>{var Le=Fs(),He=a(Le);g(We=>b(He,`"${We??""} ${e(he).title??""} ${e(he).isEffective??""} ",`),[()=>e(he).isSpawnedBy.toString()],de),r(Ye,Le)});var re=s(ne,2);re.textContent="],";var ae=s(re,2);ae.textContent='"lastMoveLogRecord" :{';var Se=s(ae,2),Re=a(Se),Ie=s(Se,2),Ke=a(Ie),Ue=s(Ie,2),Ge=a(Ue),lt=s(Ue,2);lt.textContent="},",g((Ye,he)=>{b(Re,`"movedBy":"${Ye??""}",`),b(Ke,`"movedAs":"${he??""}",`),b(Ge,`"movedAt":"${t().moveLog.latestRecord.movedAt.totalProcSeq??""}",`)},[()=>{var Ye;return(Ye=t().moveLog.latestRecord.movedBy)==null?void 0:Ye.toString()},()=>t().moveLog.latestRecord.movedAs.join(" ")],de),r(E,M)};C(V,E=>{o()==="Detail"?E(Q):E(Te,!1)},!0)}r(Y,N)};C(Me,Y=>{o()==="Normal"?Y(xe):Y(ve,!1)})}var ie=s(ce,2),je=a(ie);{var ge=Y=>{var N=Vs(),V=H(N);{var Q=P=>{var Z=Os();r(P,Z)};C(V,P=>{t().origin.isOldVersion&&P(Q)})}var Te=s(V,2);{var E=P=>{var Z=Rs();r(P,Z)},M=P=>{var Z=zs(),se=a(Z);{var x=J=>{var X=Ks();const fe=de(()=>t().entityType==="Card"?t():t().parent);var T=a(X);g(w=>{var v;rt(X,"href",w),b(T,`⇒${((v=e(fe))!=null&&v.origin.cardId?"公式カードページ":"公式で検索")??""}`)},[c],de),r(J,X)};C(se,J=>{var X;t()&&(t().entityType==="Card"||((X=t().parent)==null?void 0:X.entityType)==="Card")&&J(x)})}var F=s(se,2);mt(F,()=>e(m),null,(J,X)=>{var fe=we(),T=H(fe);{var w=v=>{var y=Ws();g(()=>rt(y,"href",`https://yugioh-wiki.net/index.php?${e(X).wikiEncodedName}`)),r(v,y)};C(T,v=>{e(X)&&e(X).wikiEncodedName&&v(w)})}r(J,fe)});var W=s(F,2);g(()=>rt(W,"href",`https://www.google.com/search?q=遊戯王 ${t().origin.name}`)),r(P,Z)};C(Te,P=>{t().origin.isForTest?P(E):P(M,!1)})}r(Y,N)};C(je,Y=>{t()&&Y(ge)})}g((Y,N)=>{Be($,`duel_card duel_card_info ${t().origin.kind??""} ${Y??""} svelte-1uevs9j`),b(R,t().nm),b($e,N)},[()=>{var Y;return(Y=t().origin.monsterCategories)==null?void 0:Y.join(" ")},()=>"★".repeat(t().lvl||0)],de),r(A,$)};C(d,A=>{t()&&A(B)})}r(f,u),ut()}za(["click","contextmenu"]);var Qs=l('<div class="duel_field_cell_info_item svelte-1xj7qf1"><!></div>'),Js=l('<div class="duel_field_cell_info_box svelte-1xj7qf1"><div class="duel_field_cell_info_label svelte-1xj7qf1"> </div> <!></div>'),Zs=l('<div class="duel_field_cell_info svelte-1xj7qf1"><div class="duel_field_cell_info_header item_btn svelte-1xj7qf1"><div class="svelte-1xj7qf1"> </div> <div class="svelte-1xj7qf1"> </div></div> <div class="duel_field_cell_info_body svelte-1xj7qf1"></div></div>');function ei(f,i){ct(i,!1);let t=Ae(i,"cell",12);const o=()=>{t(t())},m=B=>t().cardEntities.filter(A=>A.face===B);t().field.duel.view.onDuelUpdate.append(o),_t();var c=we(),u=H(c);{var d=B=>{var A=Zs(),$=a(A),S=a($),n=a(S),L=s(S,2),R=a(L),I=s($,2);_e(I,4,()=>["FaceUp","FaceDown"],ue,(_,p)=>{var K=we(),te=H(K);{var $e=j=>{var q=Js(),ce=a(q),Me=a(ce),xe=s(ce,2);_e(xe,1,()=>m(p).toSorted(lr),ue,(ve,ie)=>{var je=Qs(),ge=a(je);const Y=de(()=>t().owner===t().field.duel.duelists.Below);Vt(ge,{get entity(){return e(ie)},get isVisibleForcibly(){return e(Y)},isWideMode:!0,cardActionResolve:void 0}),r(ve,je)}),g(()=>b(Me,p==="FaceUp"?"表向き":"裏向き")),r(j,q)};C(te,j=>{m(p).length&&j($e)})}r(_,K)}),g(()=>{var _;b(n,(_=t().owner)==null?void 0:_.profile.name),b(R,t().cellType)}),r(B,A)};C(u,B=>{t().field.duel.view.infoBoardState==="CellInfo"&&B(d)})}r(f,c),ut()}var ti=l('<div class="duel_config_item svelte-y4u26k"><label class="toggle svelte-y4u26k"><input type="checkbox" class="svelte-y4u26k"></label> <span class="svelte-y4u26k"> </span></div>'),ai=l('<div class="duel_config svelte-y4u26k"><div class="duel_config_title svelte-y4u26k">デュエル設定</div> <div class="duel_config_group svelte-y4u26k"><div class="duel_config_group_title svelte-y4u26k">チェーン設定</div> <!></div></div>');function ri(f,i){ct(i,!1);let t=Ae(i,"viewController",8),o=Ae(i,"userProfile",12);_t();var m=we(),c=H(m);{var u=d=>{var B=ai(),A=s(a(B),2),$=s(a(A),2);_e($,1,()=>vr,ue,(S,n)=>{var L=ti(),R=a(L),I=a(R),_=s(R,2),p=a(_);g(()=>b(p,or[e(n)])),dr(I,()=>o().chainConfig[e(n)],K=>o(o().chainConfig[e(n)]=K,!0)),z("change",I,()=>o().save()),r(S,L)}),r(d,B)};C(c,d=>{t().infoBoardState==="Config"&&d(u)})}r(f,m),ut()}function si(f,{from:i,to:t},o={}){var{delay:m=0,duration:c=q=>Math.sqrt(q)*120,easing:u=wa}=o,d=getComputedStyle(f),B=d.transform==="none"?"":d.transform,[A,$]=d.transformOrigin.split(" ").map(parseFloat);A/=f.clientWidth,$/=f.clientHeight;var S=ii(f),n=f.clientWidth/t.width/S,L=f.clientHeight/t.height/S,R=i.left+i.width*A,I=i.top+i.height*$,_=t.left+t.width*A,p=t.top+t.height*$,K=(R-_)*n,te=(I-p)*L,$e=i.width/t.width,j=i.height/t.height;return{delay:m,duration:typeof c=="function"?c(Math.sqrt(K*K+te*te)):c,easing:u,css:(q,ce)=>{var Me=ce*K,xe=ce*te,ve=q+ce*$e,ie=q+ce*j;return`transform: ${B} translate(${Me}px, ${xe}px) scale(${ve}, ${ie});`}}}function ii(f){if("currentCSSZoom"in f)return f.currentCSSZoom;for(var i=f,t=1;i!==null;)t*=+getComputedStyle(i).zoom,i=i.parentElement;return t}var ni=l('<div class="chain_number svelte-lqu21u"> </div>'),li=l('<div class="duel_card_row svelte-lqu21u"> </div>'),oi=l('<div class="appendix svelte-lqu21u"> </div>'),di=l('<div class="appendix_wrapper svelte-lqu21u"></div>'),vi=l('<div><div><!> <div> </div> <div><!> <div class="duel_card_row svelte-lqu21u"><div> </div> <!></div></div></div></div>'),ci=l("<div></div>");function _i(f,i){ct(i,!1);let t=Ae(i,"duel",8),o=Ae(i,"position",8,"left");const m=-100,c=()=>o()==="left"?-100:100;let u=le([]),d=Promise.resolve(),B=Promise.resolve();const A=1e3,$=500,S=400,n=R=>{const I={...R};I.isKnown=R.chainBlockInfo.action.entity.controller.duelistType==="Player"||R.chainBlockInfo.action.entity.face==="FaceUp",I.chainBlockInfo.onStateChange.append(_=>{if(_==="done"||_==="failed"||_==="negated")return d=d.then(async()=>{const p=new Date().getTime()-I.chainBlockInfo.wasSpawnedAt.getTime();p<A&&await ea(A-p),D(u,e(u).filter(K=>K.seq!==I.seq)),await ea($+S)}).then(),"RemoveMe";D(u,e(u))}),B=B.then(async()=>{D(u,[I,...e(u)].sort((_,p)=>cr.isSameChain(_.clock,p.clock)&&_.chainBlockInfo.action.isWithChainBlock&&p.chainBlockInfo.action.isWithChainBlock?p.clock.totalProcSeq-_.clock.totalProcSeq:_.clock.totalProcSeq-p.clock.totalProcSeq)),await ea(300)}),d=d.then(()=>ea(1e3))};t().chainBlockLog.onInsert.append(n),_t();var L=ci();_e(L,13,()=>e(u),R=>R.seq,(R,I)=>{var _=vi();const p=de(()=>{const{activator:N,action:V,appendix:Q}=e(I).chainBlockInfo;return{activator:N,action:V,appendix:Q}});var K=a(_),te=a(K);{var $e=N=>{var V=ni(),Q=a(V);g(()=>b(Q,`チェーン：${e(I).chainBlockInfo.chainNumber??""}`)),r(N,V)};C(te,N=>{e(I).chainBlockInfo.chainNumber&&N($e)})}var j=s(te,2),q=a(j),ce=s(j,2),Me=a(ce);{var xe=N=>{var V=li(),Q=a(V);g(()=>b(Q,e(I).isKnown?e(p).action.entity.nm:"？？？")),r(N,V)};C(Me,N=>{(e(p).action.entity.entityType==="Card"||e(p).action.entity.entityType==="Token")&&N(xe)})}var ve=s(Me,2),ie=a(ve),je=a(ie),ge=s(ie,2);{var Y=N=>{var V=di();_e(V,5,()=>e(p).appendix,ue,(Q,Te)=>{var E=oi(),M=a(E);g(()=>b(M,e(Te))),r(Q,E)}),r(N,V)};C(ge,N=>{e(p).appendix&&N(Y)})}g((N,V,Q)=>{Be(_,`cut_in_row ${(!e(I).chainBlockInfo.chainNumber||e(I).chainBlockInfo.chainNumber===1?"cut_in_row_first":"")??""} svelte-lqu21u`),Be(K,`cut_in_item cut_in_item_${N??""} cut_in_item_${e(I).chainBlockInfo.state??""} svelte-lqu21u`),Be(j,`duelist_name duelist_${N??""}_name svelte-lqu21u`),b(q,e(p).activator.profile.name),Be(ce,`duel_card duel_card_${N??""} ${V??""} ${(e(I).isKnown?e(p).action.entity.origin.kind:"")??""} ${e(p).action.entity.entityType??""}  svelte-lqu21u`),b(je,Q)},[()=>e(p).activator.seat.toLowerCase(),()=>e(I).isKnown?(e(p).action.entity.status.monsterCategories??[]).join(" "):"Token",()=>e(p).action.toString()],de),oe(3,K,()=>Ar,()=>new Date().getTime()-e(I).chainBlockInfo.wasSpawnedAt.getTime()<A?{x:c(),duration:S}:{y:m,duration:S}),_r(_,()=>si,()=>({duration:$})),r(R,_)}),g(()=>Be(L,`cut_in_container cut_in_container_${o()??""} svelte-lqu21u`)),r(f,L),ut()}const ui=Br({duration:400});var fi=l('<div class="duel_desk_left v_flex svelte-1w535im"><!> <!> <!></div>'),mi=l('<button class="duel_field_header_message svelte-1w535im"> </button> <div class="duel_field_header_buttons svelte-1w535im"><button class="svelte-1w535im">サレンダー</button></div>',1),pi=l("<tr></tr>"),gi=l('<table class="duel_field svelte-1w535im"><tbody class="svelte-1w535im"></tbody></table>'),yi=l('<button class="svelte-1w535im">OK</button>'),hi=l('<button class="svelte-1w535im">cancel</button>'),bi=l("<!> <!>",1),ki=l('<button class="svelte-1w535im"> </button>'),xi=l('<div style="text-align: left;"><!> <!> <!></div>'),wi=l('<div><!> <div class=" duel_desk_center v_flex svelte-1w535im"><div class="duel_field_header svelte-1w535im"><!></div> <div class="duel_field_body svelte-1w535im"><!></div> <div class="duel_field_footer svelte-1w535im"><!></div></div> <!></div> <div style="position:fixed;bottom:0"> </div> <!> <div><!></div>',1);function Ci(f,i){ct(i,!1);let t=Ae(i,"duel",12),o=Ae(i,"userProfile",8),m=le(0),c=le(0),u=le([]),d=le([]),B=()=>{},A=le([]),$=le(),S=le(),n=le(()=>!1),L=le(!1);const R=v=>{B=v.resolve,D(A,v.dummyActionInfos.filter(y=>y.action.entity.entityType==="Duelist").filter(y=>y.action.entity.controller.seat==="Below")),D($,void 0),D(S,void 0),D(d,[]),D(u,[]),D(L,!1),v.entitiesChoices&&(D($,v.entitiesChoices),D(n,()=>{var y;return((y=v.entitiesChoices)==null?void 0:y.validator(e(u)))??!1}),D(L,v.entitiesChoices.cancelable),e($).selectables.every(y=>y.cell.isPlayFieldCell&&y.getIndexInCell()===0||y.cell.cellType==="Hand"&&y.controller.duelistType==="Player"||y.entityType==="Duelist")||t().view.modalController.entitySelector.show({title:t().view.message,position:"Middle",entitiesChoices:v.entitiesChoices,chainBlockInfos:v.chainBlockInfos,cancelable:v.entitiesChoices.cancelable}).then(y=>{B({selectedEntities:y})})),v.cellsChoices&&(D(S,v.cellsChoices),D(n,()=>{var y;return((y=v.cellsChoices)==null?void 0:y.validator(e(d)))??!1}),D(L,v.cellsChoices.cancelable))};t().view.onWaitStart.append(R);const I=()=>{B=()=>{},D(S,void 0),D($,void 0),D(d,[]),D(u,[]),D(n,()=>!1),D(L,!1)};t().view.onWaitEnd.append(I);let _=le(void 0),p=le("Normal");const K=({card:v,mode:y})=>{D(_,v),D(p,y??(e(_)===v||e(p)==="Normal"?"Detail":"Normal"))};t().view.onShowCardEntity.append(K);const te=()=>{t(t())};t().view.onDuelUpdate.append(te),t().log.onUpdate.append(te);const $e=()=>{e($)&&e($).validator(e(u))&&B({selectedEntities:e(u)}),e(S)&&e(S).validator(e(d))&&B({selectedCells:e(d)})},j=()=>{B({})},q=v=>{B({actionInfo:v})},ce=()=>{B({surrender:!0})};t().main();const Me=()=>e(m)<=1400?"compact":"wide";_t();var xe=wi(),ve=H(xe),ie=a(ve);{var je=v=>{var y=fi(),U=a(y);Ka(U,{get duelist(){return t().duelists.Above}});var G=s(U,2);{var Ce=me=>{Gs(me,{get entity(){return e(_)},get mode(){return e(p)}})};C(G,me=>{e(_)&&me(Ce)})}var De=s(G,2);Ka(De,{get duelist(){return t().duelists.Below}}),r(v,y)};C(ie,v=>{Me()==="wide"&&v(je)})}var ge=s(ie,2),Y=a(ge),N=a(Y);{var V=v=>{var y=mi(),U=H(y),G=a(U),Ce=s(U,2),De=a(Ce);g(()=>b(G,`[TURN:${t().clock.turn}][PHASE:${t().phase}] ${t().view.message}`)),z("click",U,()=>{t(t().view.infoBoardState="Log",!0)}),z("click",De,ce),r(v,y)};C(N,v=>{t().isEnded||v(V)})}var Q=s(Y,2),Te=a(Q);{var E=v=>{var y=gi(),U=a(y);_e(U,5,()=>t().field.cells,ue,(G,Ce,De)=>{var me=pi();Be(me,`${`duel_desk_row_${De}`??""} svelte-1w535im`),_e(me,5,()=>e(Ce),ue,(ne,re,ae)=>{es(ne,{get view(){return t().view},row:De,column:ae,get selectedEntities(){return e(u)},set selectedEntities(Se){D(u,Se)},get selectedCells(){return e(d)},set selectedCells(Se){D(d,Se)},$$legacy:!0})}),r(G,me)}),r(v,y)};C(Te,v=>{t().clock.turn>0&&v(E)})}var M=s(Q,2),P=a(M);{var Z=v=>{var y=bi(),U=H(y);{var G=me=>{var ne=yi();g(re=>ne.disabled=re,[()=>!e(n)()],de),z("click",ne,$e),r(me,ne)};C(U,me=>{((e($)&&e($).qty)??(e(S)&&e(S).qty)??9999)>1&&me(G)})}var Ce=s(U,2);{var De=me=>{var ne=hi();z("click",ne,j),r(me,ne)};C(Ce,me=>{e(L)&&me(De)})}r(v,y)},se=v=>{var y=we(),U=H(y);_e(U,1,()=>e(A),ue,(G,Ce)=>{var De=ki(),me=a(De);g(()=>b(me,e(Ce).action.title)),z("click",De,()=>q(e(Ce))),r(G,De)}),r(v,y)};C(P,v=>{e($)&&e($).selectables.length||e(S)&&e(S).selectables?v(Z):v(se,!1)})}var x=s(ge,2);{var F=v=>{var y=xi(),U=a(y);cs(U,{get log(){return t().log}});var G=s(U,2);ei(G,{get cell(){return t().view.infoBoardCell}});var Ce=s(G,2);ri(Ce,{get userProfile(){return o()},get viewController(){return t().view}}),g(De=>Be(y,`duel_desk_right duel_desk_right_${De??""}  svelte-1w535im`),[()=>t().view.infoBoardState.toLowerCase()],de),oe(3,y,()=>ke,()=>({duration:e(m)>1400?0:200,axis:"x"})),r(v,y)};C(x,v=>{(e(m)>1400||t().view.infoBoardState!=="Default")&&v(F)})}var W=s(ve,2),J=a(W),X=s(W,2);ur(X,{get modalController(){return t().view.modalController}});var fe=s(X,2),T=a(fe);const w=de(()=>Me()==="wide"?"right":"left");_i(T,{get duel(){return t()},get position(){return e(w)}}),g((v,y)=>{Be(ve,`flex duel_desk ${v??""}_mode svelte-1w535im`),b(J,y),Be(fe,`cutin ${v??""}_mode svelte-1w535im`)},[Me,()=>t().clock.toFullString()],de),ua("innerWidth",v=>D(m,v)),ua("innerHeight",v=>D(c,v)),r(f,xe),ut()}var Di=l("<div></div>"),$i=l("<!> <!> <!> <!>",1),Si=l('<span class="atk svelte-1y1qbq4"> </span> <span class="slash svelte-1y1qbq4">/</span> <span class="def svelte-1y1qbq4"> </span>',1),Mi=l('<div role="listitem"><div class="svelte-1y1qbq4"><div class="duel_card_row card_name svelte-1y1qbq4"> </div> <div style="display:flex; flex-wrap: wrap;" class="svelte-1y1qbq4"><div style="" class="svelte-1y1qbq4"><!> <!> <!></div> <div class="atk_def svelte-1y1qbq4"><!></div></div></div></div>');function Ja(f,i){ct(i,!1);let t=Ae(i,"mode",8),o=Ae(i,"cardInfo",8),m=Ae(i,"onAttention",8),c=Ae(i,"cardControlEventHandlers",8);_t();var u=Mi(),d=a(u),B=a(d),A=a(B),$=s(B,2),S=a($),n=a(S);{var L=j=>{var q=$i(),ce=H(q);{var Me=ge=>{var Y=at();g(()=>b(Y,`★${o().level??""}`)),r(ge,Y)},xe=ge=>{var Y=we(),N=H(Y);{var V=Te=>{var E=at();g(()=>b(E,`☆${o().rank??""}`)),r(Te,E)},Q=Te=>{var E=we(),M=H(E);{var P=Z=>{var se=at();g(()=>b(se,`Ｌ${o().link??""}`)),r(Z,se)};C(M,Z=>{o().link&&Z(P)},!0)}r(Te,E)};C(N,Te=>{o().rank?Te(V):Te(Q,!1)},!0)}r(ge,Y)};C(ce,ge=>{o().level?ge(Me):ge(xe,!1)})}var ve=s(ce,2);_e(ve,1,()=>o().attributes??[],ue,(ge,Y)=>{var N=Di();g(()=>Be(N,`monster_attr ${e(Y)??""} svelte-1y1qbq4`)),r(ge,N)});var ie=s(ve,2);_e(ie,1,()=>o().types??[],ue,(ge,Y)=>{var N=at();g(()=>b(N,ga[e(Y)])),r(ge,N)});var je=s(ie,2);_e(je,1,()=>o().monsterCategories??[],ue,(ge,Y)=>{var N=at();g(()=>b(N,da[e(Y)])),r(ge,N)}),r(j,q)};C(n,j=>{o().kind==="Monster"&&j(L)})}var R=s(n,2);{var I=j=>{var q=at();g(()=>b(q,`${ya[o().spellCategory]??""}魔法`)),r(j,q)};C(R,j=>{o().spellCategory&&j(I)})}var _=s(R,2);{var p=j=>{var q=at();g(()=>b(q,`${ha[o().trapCategory]??""}罠`)),r(j,q)};C(_,j=>{o().trapCategory&&j(p)})}var K=s(S,2),te=a(K);{var $e=j=>{var q=Si(),ce=H(q),Me=a(ce),xe=s(ce,4),ve=a(xe);g(()=>{b(Me,o().attack??"?"),b(ve,o().defense??"?")}),r(j,q)};C(te,j=>{o().kind==="Monster"&&j($e)})}g(j=>{Be(u,`${j??""} svelte-1y1qbq4`),b(A,o().name)},[()=>{var j,q;return`deck_editor_card duel_card ${o().kind} ${(q=(j=o())==null?void 0:j.monsterCategories)==null?void 0:q.join(" ")} ${o().isImplemented?"is_implemented":"is_not_implemented"}`}],de),z("click",u,()=>m()(o())),z("touchstart",u,j=>c().onCardDragStart(j,t(),o())),z("touchmove",u,j=>c().onCardDragging(j,t())),z("touchend",u,function(...j){var q;(q=c().onCardDragEnd)==null||q.apply(this,j)}),z("touchcancel",u,function(...j){var q;(q=c().onCardDragCancel)==null||q.apply(this,j)}),z("mousedown",u,j=>c().onCardDragStart(j,t(),o())),z("mousemove",u,j=>c().onCardDragging(j,t())),z("mouseup",u,function(...j){var q;(q=c().onCardDragEnd)==null||q.apply(this,j)}),r(f,u),ut()}var Ti=l('<button class="button_style_reset plus_minus_button svelte-1ty6ui7">+</button> <button class="button_style_reset plus_minus_button svelte-1ty6ui7">-</button>',1),Ei=l('<li class="deck_editor_item svelte-1ty6ui7"><!> <!></li>'),ji=l('<div class="deck_editor_card_list_wrapper svelte-1ty6ui7"><ul></ul></div>');function Ai(f,i){ct(i,!1);let t=Ae(i,"cardList",8),o=Ae(i,"mode",8),m=Ae(i,"state",8),c=Ae(i,"onAttention",8),u=Ae(i,"cardControlEventHandlers",8);const d=20;let B=le(0),A=le(d),$=le(0),S=le(0),n=le(0),L=le();ca(()=>(e(L),Kt(o()),Kt(t()),e(n),e(S),Kt(m())),()=>{if(e(L))if(be(L,e(L).scrollTop=0),o()==="List"){const _=t().length>d?d:t().length;e(n)||(D(S,e(L).scrollHeight/_),D(n,Math.ceil(e(S)))),console.log(m(),t().length),t().length>d?D($,e(n)*(t().length-d*2)+Math.ceil(e(S)*(d*2-1))):D($,e(n)*t().length)}else D(A,t().length)}),$a(),_t();var R=ji(),I=a(R);_e(I,5,t,ue,(_,p,K)=>{var te=we(),$e=H(te);{var j=q=>{var ce=Ei(),Me=a(ce);Ja(Me,{get mode(){return o()},get cardInfo(){return e(p)},get onAttention(){return c()},get cardControlEventHandlers(){return u()}});var xe=s(Me,2);{var ve=ie=>{var je=Ti(),ge=H(je),Y=s(ge,2);g(N=>{ge.disabled=!e(p).isImplemented,rt(ge,"title",e(p).isImplemented?`※shiftキー同時押しで一括投入
※ctrlキー同時押しで枚数制限無視`:""),Y.disabled=N,rt(Y,"title",e(p).isImplemented?"※shiftキー同時押しで一括外し":"")},[()=>t().every(N=>N.name!==e(p).name)],de),z("click",ge,N=>u().onCardAppend(N,e(p))),z("click",Y,N=>u().onCardRemove(N,e(p))),r(ie,je)};C(xe,ie=>{o()==="Deck"&&ie(ve)})}r(q,ce)};C($e,q=>{K>=e(B)&&K<=e(A)&&q(j)})}r(_,te)}),Va(I,_=>D(L,_),()=>e(L)),g(_=>{Be(I,`deck_editor_card_list ${_??""}  indexLowerBound_${e(B)??""} indexUpperBound=${e(A)??""} svelte-1ty6ui7`),rt(I,"style",`height: ${(e($)?e($)+"px":"fit-content")??""};padding-top: ${e(B)*e(n)}px`)},[()=>m().toLowerCase()],de),z("scroll",R,_=>{if(!e(n))return;const p=Math.ceil(_.currentTarget.scrollTop/e(n));D(B,p<d?0:p-d),D(A,p+d)}),r(f,R),ut()}var Bi=l('<div class="svelte-bxy0h6"><button class="button_style_reset svelte-bxy0h6">クリア</button></div>'),Li=l('<div><div class="deck_editor_card_kind_header svelte-bxy0h6"><div class="svelte-bxy0h6"> <!> 枚）</div> <div style="display: flex;" class="svelte-bxy0h6"><!> <div class="triangle svelte-bxy0h6">▲</div></div></div> <div class="deck_editor_card_kind_body svelte-bxy0h6"><!></div></div>'),qi=l('<div class="deck_editor_card_list svelte-bxy0h6"></div>');function Wa(f,i){ct(i,!1);let t=Ae(i,"allCardTree",8),o=Ae(i,"deckCardTree",12),m=Ae(i,"mode",8),c=Ae(i,"onAttention",8),u=Ae(i,"searchCondition",8,void 0),d=Ae(i,"cardControlEventHandlers",8),B=le("ExtraMonster");const A=le(m()==="List"?t():o()),$=(..._)=>{const p=_.length?_:Xt(e(A)),K=(te,$e)=>{var j;return Qa(te,$e,(j=u())==null?void 0:j.sort.filter(q=>q.priority>0).toSorted((q,ce)=>q.priority-ce.priority))};p.forEach(te=>e(A)[te].sort(K))},S=(_,p)=>{o(o()[p]=[],!0)};let n=le(m()==="Deck"?structuredClone(e(A)):{ExtraMonster:[],Monster:[],Spell:[],Trap:[]}),L=le("");const R=_=>{if(!u())return!0;if(_.kind==="XyzMaterial")return!1;const p=fa(_);if(!u().deckCardKinds.includes(p)||u().name.trim().length&&[_.name,..._.nameTags??[],..._.textTags??[]].every(te=>!te.includes(u().name))||!_.isImplemented&&!u().others.includes("implemented")||_.isForTest&&!u().others.includes("test")||_.isOldVersion&&!u().others.includes("oldVersion"))return!1;if(_.kind==="Monster"){if(_.attributes&&!u().monsterAttributes.union(_.attributes).length||_.types&&!u().monsterTypes.union(_.types).length)return!1;const K=_.level??_.rank??_.link;return Lt(u().starLowerBound)&&(K??0)<u().starLowerBound||Lt(u().starUpperBound)&&(K??0)>u().starUpperBound||Lt(u().atkLowerBound)&&(_.attack??0)<u().atkLowerBound||Lt(u().atkUpperBound)&&(_.attack??0)>u().atkUpperBound||Lt(u().defLowerBound)&&(_.defense??0)<u().defLowerBound||Lt(u().defUpperBound)&&(_.defense??0)>u().defUpperBound||Lt(u().atkPlusDef)&&(!Lt(_.attack)||!Lt(_.defense)||_.attack+_.defense!==u().atkPlusDef)||!_.monsterCategories||p==="ExtraMonster"&&!_.monsterCategories.union(u().exMonsterCategories).length?!1:_.monsterCategories.union(u().monsterCategories).length}if(_.kind==="Spell")return _.spellCategory&&u().spellCategories.includes(_.spellCategory);if(_.kind==="Trap")return _.trapCategory&&u().trapCategories.includes(_.trapCategory)};ca(()=>(Kt(m()),e(A),Kt(o()),e(B),e(n)),()=>{if(m()==="Deck"){if(Xt(e(A)).forEach(_=>be(A,e(A)[_]=o()[_])),e(A)[e(B)].length){const _=Xt(e(A)).map(p=>({kind:p,cardInfos:e(A)[p]})).filter(({cardInfos:p})=>p.length).find(({kind:p,cardInfos:K})=>K.length!==e(n)[p].length);_&&e(B)!==_.kind&&D(B,_.kind)}else D(B,Xt(e(A)).find(_=>e(A)[_].find(R))??"ExtraMonster");D(n,structuredClone(e(A)))}}),ca(()=>(Kt(m()),Kt(u()),e(L)),()=>{var _;if(m()==="List"){const p=JSON.stringify((_=u())==null?void 0:_.sort);e(L)!==p&&(D(L,p),$())}}),$a(),_t();var I=qi();_e(I,5,()=>ta,ue,(_,p,K)=>{var te=Li();const $e=de(()=>e(A)[e(p)].filter(R));var j=a(te),q=a(j),ce=a(q),Me=s(ce);{var xe=V=>{var Q=at();g(Te=>b(Q,`/ ${Te??""}`),[()=>e(A)[e(p)].length.toLocaleString()],de),r(V,Q)};C(Me,V=>{m()==="List"&&V(xe)})}var ve=s(q,2),ie=a(ve);{var je=V=>{var Q=Bi(),Te=a(Q);z("click",Te,E=>S(E,e(p))),r(V,Q)};C(ie,V=>{m()==="Deck"&&e($e).length&&V(je)})}var ge=s(j,2),Y=a(ge);const N=de(()=>e(B)===e(p)?"Open":"Close");Ai(Y,{get mode(){return m()},get cardList(){return e($e)},get onAttention(){return c()},get cardControlEventHandlers(){return d()},get state(){return e(N)}}),g(V=>{Be(te,`deck_editor_card_kind deckCardKind ${(e(p)===e(B)?"selected":"")??""} ${(e($e).length?"":"empty")??""} svelte-bxy0h6`),b(ce,`${Ga[e(p)]??""}（${V??""} `)},[()=>e($e).length.toLocaleString()],de),z("click",j,()=>{if(e(B)!==e(p)){D(B,e(p));return}D(B,ta.map((V,Q)=>Q+K).map(V=>V%ta.length).map(V=>ta[V]).filter(V=>V!==e(p)).find(V=>e(A)[V].some(R))??e(p))}),r(_,te)}),r(f,I),ut()}var Yi=l('<div class="svelte-7xhk0x"> </div>'),Ui=l('<div class="svelte-7xhk0x"> </div>'),Hi=l('<div class="link_arrow_emoji svelte-7xhk0x"> </div>'),Pi=l('<div class="duel_card_info_row svelte-7xhk0x" style="position:sticky; top:0;"><!></div>'),Ni=l('<div class="duel_card_info_row svelte-7xhk0x"><div class="svelte-7xhk0x"><pre class="description svelte-7xhk0x"> </pre></div></div> <div class="duel_card_info_row svelte-7xhk0x" style=" justify-content: space-between;"><div class="svelte-7xhk0x"> </div> <div class="svelte-7xhk0x"> </div></div>',1),Fi=l('<div></div> <div class="svelte-7xhk0x"> </div>',1),Ii=l("<div> </div>"),Oi=l('<span class="svelte-7xhk0x">/</span> <div class="monster_defense svelte-7xhk0x"> </div>',1),Ri=l("<div> </div>"),Ki=l('<div class="duel_card_info_row svelte-7xhk0x"><!> <!> <div style="flex-grow: 1;" class="svelte-7xhk0x"></div> <div class="monster_attack svelte-7xhk0x"> </div> <!></div> <div class="duel_card_info_row svelte-7xhk0x"></div>',1),Wi=l('<div class="duel_card_row svelte-7xhk0x"><div class="svelte-7xhk0x"></div> <div class="svelte-7xhk0x"> </div></div>'),zi=l('<div class="duel_card_row svelte-7xhk0x"><div class="svelte-7xhk0x"></div> <div class="svelte-7xhk0x"> </div></div>'),Vi=l('<div class="duel_card_info_row svelte-7xhk0x"><div class="svelte-7xhk0x">※エラッタ前カードです</div></div>'),Xi=l('<div class="duel_card_info_row svelte-7xhk0x"><div class="svelte-7xhk0x">※テスト用カードです</div></div>'),Gi=l('<div class="duel_card_info_links svelte-7xhk0x"><a target="_blank" rel="noopener noreferrer" title="コナミカードデータベース" class="svelte-7xhk0x"> </a> <a target="_blank" rel="noopener noreferrer" title="遊戯王カードWiki" class="svelte-7xhk0x">⇒遊戯王カードWiki</a> <a target="_blank" rel="noopener noreferrer" title="google" class="svelte-7xhk0x">⇒google検索</a></div>'),Qi=l('<div><div class="duel_card_info_header svelte-7xhk0x"><div class="duel_card_info_row svelte-7xhk0x"><div class="svelte-7xhk0x"> </div></div> <!> <div class="plus_minus_button_area svelte-7xhk0x"><button class="button_style_reset plus_minus_button svelte-7xhk0x">+</button> <button class="button_style_reset plus_minus_button svelte-7xhk0x">-</button></div></div> <div class="duel_card_info_body svelte-7xhk0x"><!> <!> <div class="duel_card_info_row description svelte-7xhk0x"><div class="svelte-7xhk0x"><pre class="description svelte-7xhk0x"> </pre></div></div> <!> <!></div></div>');function Ji(f,i){ct(i,!1);let t=Ae(i,"cardInfo",8,void 0),o=Ae(i,"onAttention",8),m=Ae(i,"cardControlEventHandlers",8),c=Ae(i,"deckCardTree",8);_t();var u=we(),d=H(u);{var B=A=>{var $=Qi(),S=a($),n=a(S),L=a(n),R=a(L),I=s(n,2);{var _=E=>{var M=Pi(),P=a(M);{var Z=x=>{var F=Yi(),W=a(F);g(J=>b(W,J),[()=>"★".repeat(t().level)],de),r(x,F)},se=x=>{var F=we(),W=H(F);{var J=fe=>{var T=Ui(),w=a(T);g(v=>b(w,v),[()=>"★".repeat(t().rank)],de),r(fe,T)},X=fe=>{var T=we(),w=H(T);{var v=y=>{var U=Hi(),G=a(U);g(Ce=>b(G,Ce),[()=>t().linkArrowKeys.map(Ce=>Xa[Ce].emoji).join("")],de),r(y,U)};C(w,y=>{t().linkArrowKeys&&y(v)},!0)}r(fe,T)};C(W,fe=>{t().rank&&t().rank>0?fe(J):fe(X,!1)},!0)}r(x,F)};C(P,x=>{t().level&&t().level>0?x(Z):x(se,!1)})}r(E,M)};C(I,E=>{t().kind==="Monster"&&E(_)})}var p=s(I,2),K=a(p),te=s(K,2),$e=s(S,2),j=a($e);{var q=E=>{var M=Ni(),P=H(M),Z=a(P),se=a(Z),x=a(se),F=s(P,2),W=a(F),J=a(W),X=s(W,2),fe=a(X);g(()=>{b(x,t().pendulumDescription),b(J,`◀ ${t().pendulumScaleL??""}`),b(fe,`${t().pendulumScaleR??""} ▶`)}),r(E,M)};C(j,E=>{var M;(M=t().monsterCategories)!=null&&M.includes("Pendulum")&&E(q)})}var ce=s(j,2);{var Me=E=>{var M=Ki(),P=H(M),Z=a(P);{var se=w=>{var v=Fi(),y=H(v),U=s(y,2),G=a(U);g(()=>{Be(y,`monster_attr ${t().attributes[0]??""} svelte-7xhk0x`),b(G,`${Sa[t().attributes[0]]??""}属性`)}),r(w,v)};C(Z,w=>{t().attributes&&w(se)})}var x=s(Z,2);{var F=w=>{var v=Ii(),y=a(v);g(()=>{Be(v,`monster_cat ${t().types[0]??""} svelte-7xhk0x`),b(y,`${ga[t().types[0]]??""}${Ma[t().types[0]]??""}族`)}),r(w,v)};C(x,w=>{t().types&&w(F)})}var W=s(x,4),J=a(W),X=s(W,2);{var fe=w=>{var v=Oi(),y=s(H(v),2),U=a(y);g(()=>b(U,t().defense??"?")),r(w,v)};C(X,w=>{var v;(v=t().monsterCategories)!=null&&v.includes("Link")||w(fe)})}var T=s(P,2);_e(T,5,()=>t().monsterCategories??[],ue,(w,v)=>{var y=Ri(),U=a(y);g(()=>{Be(y,`monster_cat ${e(v)??""} svelte-7xhk0x`),b(U,`${da[e(v)]??""}${_a[e(v)]??""}`)}),r(w,y)}),g(()=>b(J,t().attack??"?")),r(E,M)},xe=E=>{var M=we(),P=H(M);{var Z=x=>{var F=Wi(),W=s(a(F),2),J=a(W);g(()=>b(J,`${ya[t().spellCategory]??""}魔法`)),r(x,F)},se=x=>{var F=we(),W=H(F);{var J=X=>{var fe=zi(),T=s(a(fe),2),w=a(T);g(()=>b(w,`${ha[t().trapCategory]??""}罠`)),r(X,fe)};C(W,X=>{t().kind==="Trap"&&t().trapCategory&&X(J)},!0)}r(x,F)};C(P,x=>{t().kind==="Spell"&&t().spellCategory?x(Z):x(se,!1)},!0)}r(E,M)};C(ce,E=>{t().kind==="Monster"?E(Me):E(xe,!1)})}var ve=s(ce,2),ie=a(ve),je=a(ie),ge=a(je),Y=s(ve,2);{var N=E=>{var M=Vi();r(E,M)};C(Y,E=>{t().isOldVersion&&E(N)})}var V=s(Y,2);{var Q=E=>{var M=Xi();r(E,M)},Te=E=>{var M=Gi(),P=a(M),Z=a(P),se=s(P,2),x=s(se,2);g(F=>{rt(P,"href",F),b(Z,`⇒${(t().cardId?"公式カードページ":"公式で検索")??""}`),rt(se,"href",`https://yugioh-wiki.net/index.php?${t().wikiEncodedName}`),rt(x,"href",`https://www.google.com/search?q=遊戯王 ${t().name}`)},[()=>fr(t())],de),r(E,M)};C(V,E=>{t().isForTest?E(Q):E(Te,!1)})}g((E,M)=>{Be($,`duel_card duel_card_info ${t().kind??""} ${E??""} svelte-7xhk0x`),b(R,t().name),K.disabled=!t().isImplemented,rt(K,"title",t().isImplemented?`※shiftキー同時押しで一括投入
※ctrlキー同時押しで枚数制限無視`:""),te.disabled=M,rt(te,"title",t().isImplemented?"※shiftキー同時押しで一括外し":""),b(ge,t().description)},[()=>{var E;return(E=t().monsterCategories)==null?void 0:E.join(" ")},()=>c()[fa(t())].every(E=>E.name!==t().name)],de),z("click",K,E=>m().onCardAppend(E,t())),z("click",te,E=>m().onCardRemove(E,t())),z("click",$,()=>o()(t())),r(A,$)};C(d,A=>{t()&&A(B)})}r(f,u),ut()}const Zi={0:{aaa:"日",aaaa:"日曜日",ddd:"Sun",dddd:"Sunday"},1:{aaa:"月",aaaa:"月曜日",ddd:"Mon",dddd:"Monday"},2:{aaa:"火",aaaa:"火曜日",ddd:"Tue",dddd:"Tuesday"},3:{aaa:"水",aaaa:"水曜日",ddd:"Wed",dddd:"Wednesday"},4:{aaa:"木",aaaa:"木曜日",ddd:"Thu",dddd:"Thursday"},5:{aaa:"金",aaaa:"金曜日",ddd:"Fri",dddd:"Friday"},6:{aaa:"土",aaaa:"土曜日",ddd:"Sat",dddd:"Saturday"}};class en{constructor(){nt(this,"DefaultSeparator1","/");nt(this,"DefaultSeparator2"," ");nt(this,"DefaultSeparator3",":");nt(this,"createDate",i=>{if(!i)return;const t=new Date(i);if(!isNaN(t.getTime()))return t});nt(this,"createDateOr",(i,t)=>this.createDate(i)||t||new Date);nt(this,"truncateDate",i=>{const t=i||new Date;return new Date(t.getFullYear(),t.getMonth(),t.getDate())});nt(this,"addDate",(i,t)=>{const o=this.createDateOr(i);return o.setDate(o.getDate()+t),o});nt(this,"addMonth",(i,t)=>{const o=this.createDateOr(i);return o.setMonth(o.getMonth()+t),o});nt(this,"addYear",(i,t)=>{const o=this.createDateOr(i);return o.setFullYear(o.getFullYear()+t),o});nt(this,"getDayOfWeek",(i,t="dddd")=>{const o=this.createDate(i);return o?Zi[o.getDay()][t]:""});nt(this,"formatToYYYYMMDD",(i,t=this.DefaultSeparator1)=>{const o=this.createDate(i);if(!o)return"";const m=o.getFullYear().toString(),c=("0"+(o.getMonth()+1)).slice(-2),u=("0"+o.getDate()).slice(-2);return m+t+c+t+u});nt(this,"formatToYYYYMM",(i,t=this.DefaultSeparator1)=>{const o=this.createDate(i);if(!o)return"";t||(t="");const m=o.getFullYear().toString(),c=("0"+(o.getMonth()+1)).slice(-2);return m+t+c});nt(this,"formatToHHMMSS",(i,t=this.DefaultSeparator3)=>{const o=this.createDate(i);if(!o)return"";t||(t="");const m=o.getHours(),c=o.getMinutes(),u=o.getSeconds();return("0"+m).slice(-2)+t+("0"+c).slice(-2)+t+("0"+u).slice(-2)});nt(this,"formatToHHMM",(i,t=this.DefaultSeparator3)=>{const o=this.createDate(i);if(!o)return"";t||(t="");const m=("0"+o.getHours()).slice(-2),c=("0"+o.getMinutes()).slice(-2);return m+t+c});nt(this,"formatToYYYYMMDD_HHMM",(i,t=this.DefaultSeparator1,o=this.DefaultSeparator2,m=this.DefaultSeparator3)=>{const c=this.createDate(i);return c?this.formatToYYYYMMDD(c,t)+o+this.formatToHHMM(c,m):""});nt(this,"formatToYYYYMMDD_HHMMSS",(i,t=this.DefaultSeparator1,o=this.DefaultSeparator2,m=this.DefaultSeparator3)=>{const c=this.createDate(i);return c?this.formatToYYYYMMDD(c,t)+o+this.formatToHHMMSS(c,m):""})}}const bt=new en;Date.prototype.truncateDate=function(){return bt.truncateDate(this)};Date.prototype.getCloneOr=function(f){return bt.createDateOr(this,f)};Date.prototype.addDate=function(f){return bt.addDate(this,f)};Date.prototype.addMonth=function(f){return bt.addDate(this,f)};Date.prototype.addYear=function(f){return bt.addDate(this,f)};Date.prototype.getDayOfWeek=function(f="dddd"){return bt.getDayOfWeek(this,f)};Date.prototype.formatToYYYYMM=function(f){return bt.formatToYYYYMM(this,f)};Date.prototype.formatToYYYYMMDD=function(f){return bt.formatToYYYYMMDD(this,f)};Date.prototype.formatToYYYYMMDD_HHMM=function(f,i,t){return bt.formatToYYYYMMDD_HHMM(this,f,i,t)};Date.prototype.formatToYYYYMMDD_HHMMSS=function(f,i,t){return bt.formatToYYYYMMDD_HHMMSS(this,f,i,t)};Date.prototype.formatToHHMM=function(f){return bt.formatToHHMM(this,f)};Date.prototype.formatToHHMMSS=function(f){return bt.formatToHHMMSS(this,f)};var tn=l('<li class="deck_info_list_item svelte-2wdgc8"><div class="svelte-2wdgc8"> </div> <div class="svelte-2wdgc8"> </div> <div class="svelte-2wdgc8"> </div></li>'),an=l('<ul class="deck_info_list svelte-2wdgc8"></ul>'),rn=l('<label for="file_selector" class="upload_area svelte-2wdgc8" role="region" aria-label="ファイルアップロードエリア"><div class="upload_area_message svelte-2wdgc8">ここにファイルをドロップ</div> <div class="upload_area_footer svelte-2wdgc8"><input type="file" id="file_selector" name="file_selector" accept=".json" multiple></div></label>'),sn=l('<div slot="body" class="modal_body svelte-2wdgc8"><!></div>'),nn=l('<button class="svelte-2wdgc8">追加</button> <button class="svelte-2wdgc8">削除して追加</button> <button class="svelte-2wdgc8">戻る</button>',1),ln=l('<button class="svelte-2wdgc8">Cancel</button>'),on=l('<div slot="footer" class="modal_window_footer svelte-2wdgc8"><!></div>');function dn(f,i){ct(i,!1);let t=Ae(i,"eventHolder",8),o=Ae(i,"args",8),m=Ae(i,"resolve",8),c=le(Promise.resolve([])),u=le();const d=()=>{D(u,new DataTransfer().files),D(c,Promise.resolve([]))},B=async L=>{L.preventDefault(),console.log("hoge",L)},A=async L=>{L.preventDefault(),L.dataTransfer&&S(L.dataTransfer.files)},$=()=>{S(e(u))},S=async L=>{if(!L.length)return;const R=[],I=[];for(const _ of L)try{I.push(...await Dt.createfromJson(_))}catch(p){p instanceof Error&&R.push(p.message)}if(R.length){console.log(...R);return}D(c,e(c).then(()=>I))},n=d;_t(),mr(f,{get eventHolder(){return t()},get args(){return o()},$$slots:{body:(L,R)=>{var I=sn(),_=a(I);mt(_,()=>oa,null,(p,K)=>{var te=we(),$e=H(te);mt($e,()=>e(c),null,(j,q)=>{var ce=we(),Me=H(ce);{var xe=ie=>{var je=an();_e(je,5,()=>e(q),ue,(ge,Y)=>{var N=tn(),V=a(N),Q=a(V),Te=s(V,2),E=a(Te),M=s(Te,2),P=a(M);g((Z,se,x)=>{b(Q,e(Y).name),b(E,`${Z??""}
                  /
                  ${se??""}`),b(P,`最終使用日時 ： ${x??""}`)},[()=>e(Y).cardNames.filter(Z=>{var se,x;return!((x=(se=e(K).getCardInfo(Z))==null?void 0:se.monsterCategories)!=null&&x.union(aa).length)}).length,()=>e(Y).cardNames.filter(Z=>{var se,x;return(x=(se=e(K).getCardInfo(Z))==null?void 0:se.monsterCategories)==null?void 0:x.union(aa).length}).length,()=>e(Y).lastUsedAt.formatToYYYYMMDD_HHMM("/"," ",":")],de),r(ge,N)}),r(ie,je)},ve=ie=>{var je=rn(),ge=s(a(je),2),Y=a(ge);pr(Y,()=>e(u),N=>D(u,N)),z("change",Y,$),z("cancel",Y,n),z("drop",je,A),z("dragover",je,B),r(ie,je)};C(Me,ie=>{e(q).length?ie(xe):ie(ve,!1)})}r(j,ce)}),r(p,te)}),r(L,I)},footer:(L,R)=>{var I=on(),_=a(I);mt(_,()=>e(c),null,(p,K)=>{var te=we(),$e=H(te);{var j=ce=>{var Me=nn(),xe=H(Me),ve=s(xe,2),ie=s(ve,2);g(()=>{xe.disabled=e(K).length===0,ve.disabled=e(K).length===0}),z("click",xe,()=>m()({deckInfos:e(K),replaceAll:!1})),z("click",ve,()=>m()({deckInfos:e(K),replaceAll:!0})),z("click",ie,n),r(ce,Me)},q=ce=>{var Me=we(),xe=H(Me);{var ve=ie=>{var je=ln();z("click",je,()=>m()(void 0)),r(ie,je)};C(xe,ie=>{o().cancelable&&ie(ve)},!0)}r(ce,Me)};C($e,ce=>{e(K).length?ce(j):ce(q,!1)})}r(p,te)}),r(L,I)}}}),ut()}const pa=class pa extends yr{constructor(i,t){super(i,...Object.values(t))}};nt(pa,"createModalController",i=>{const t={deckUploader:new hr({title:"デッキ情報をアップロード",position:"Middle",cancelable:!1})};return Object.assign(new pa(i,t),t)});let Da=pa;function vn(f,i){ct(i,!1);let t=Ae(i,"modalController",8);_t(),gr(f,{get modalController(){return t()},children:(o,m)=>{var c=we(),u=H(c);{var d=B=>{dn(B,{get eventHolder(){return t().eventHolder},get args(){return t().deckUploader.args},get resolve(){return t().deckUploader.resolve}})};C(u,B=>{t().deckUploader.state==="Shown"&&B(d)})}r(o,c)},$$slots:{default:!0}}),ut()}var cn=l("<button> </button>"),_n=l('<label class="svelte-1m129ml"><input type="checkbox" class="search_condition svelte-1m129ml"> </label>'),un=l('<label class="svelte-1m129ml"><input type="checkbox" class="search_condition svelte-1m129ml"> </label>'),fn=l('<div class="deck_editor_search_box_row monster_ex_categories svelte-1m129ml"><div class="svelte-1m129ml"><button class="search_condition_title black_button svelte-1m129ml">エクストラ</button></div> <div class="svelte-1m129ml"></div></div>'),mn=l('<label class="svelte-1m129ml"><input type="checkbox" class="search_condition svelte-1m129ml"> </label>'),pn=l('<label class="svelte-1m129ml"><input type="checkbox" class="search_condition svelte-1m129ml"> <div style="display: inline-block;"></div> </label>'),gn=l('<label class="svelte-1m129ml"><input type="checkbox" class="search_condition svelte-1m129ml"> </label>'),yn=l('<option class="svelte-1m129ml"></option>'),hn=l('<option class="svelte-1m129ml"></option>'),bn=l('<div class="deck_editor_search_box_row monster_categories svelte-1m129ml"><div class="svelte-1m129ml"><button class="search_condition_title black_button svelte-1m129ml">モンスター</button></div> <div class="svelte-1m129ml"></div></div> <div class="deck_editor_search_box_row monster_attributes svelte-1m129ml"><div class="svelte-1m129ml"><button class="search_condition_title black_button svelte-1m129ml">属性</button></div> <div class="svelte-1m129ml"></div></div> <div class="deck_editor_search_box_row svelte-1m129ml"><div class="svelte-1m129ml"><button class="search_condition_title black_button svelte-1m129ml">種族</button></div> <div class="svelte-1m129ml"></div></div> <div class="deck_editor_search_box_row svelte-1m129ml"><div class="svelte-1m129ml"><button class="search_condition_title black_button svelte-1m129ml">星攻守</button></div> <div class="svelte-1m129ml"><div class="star_range svelte-1m129ml"><span class="svelte-1m129ml">星</span> <select class="svelte-1m129ml"></select> <span class="svelte-1m129ml">～</span> <select class="svelte-1m129ml"></select></div> <div class="atk_range svelte-1m129ml"><span class="svelte-1m129ml">攻</span> <input type="number" min="0" max="5000" step="100" class="svelte-1m129ml"> <span class="svelte-1m129ml">～</span> <input type="number" min="0" max="5000" step="100" class="svelte-1m129ml"></div> <div class="def_range svelte-1m129ml"><span class="svelte-1m129ml">守</span> <input type="number" min="0" max="5000" step="100" class="svelte-1m129ml"> <span class="svelte-1m129ml">～</span> <input type="number" min="0" max="5000" step="100" class="svelte-1m129ml"></div> <div class="atk_plus_def svelte-1m129ml"><span class="svelte-1m129ml">攻+守</span> <input type="number" min="0" max="10000" step="100" class="svelte-1m129ml"></div></div></div>',1),kn=l('<label class="svelte-1m129ml"><input type="checkbox" class="search_condition svelte-1m129ml"> </label>'),xn=l('<div class="deck_editor_search_box_row svelte-1m129ml"><div class="svelte-1m129ml"><button class="search_condition_title black_button svelte-1m129ml">魔法</button></div> <div class="svelte-1m129ml"></div></div>'),wn=l('<label class="svelte-1m129ml"><input type="checkbox" class="search_condition svelte-1m129ml"> </label>'),Cn=l('<div class="deck_editor_search_box_row svelte-1m129ml"><div class="svelte-1m129ml"><button class="search_condition_title black_button svelte-1m129ml">罠</button></div> <div class="svelte-1m129ml"></div></div>'),Dn=l('<label class="svelte-1m129ml"><input type="checkbox" class="search_condition svelte-1m129ml"> </label>'),$n=l('<div class="deck_editor_card_detail svelte-1m129ml"><!></div>'),Sn=l("<div>カード情報読込中</div>"),Mn=l("<option> </option>"),Tn=l('<div class="svelte-1m129ml"><a class="white_button svelte-1m129ml" download="SVS_DeckInfos.json">ダウンロード</a></div>'),En=l('<div class="svelte-1m129ml"></div>'),jn=l('<div class="svelte-1m129ml"><a class="white_button svelte-1m129ml" download="SVS_DeckInfos.json">ダウンロード(一括)</a></div>'),An=l('<div class="svelte-1m129ml"></div>'),Bn=l('<div class="deck_editor_body_right_header svelte-1m129ml"><div class="deck_editor_body_right_header_row svelte-1m129ml"><div class="svelte-1m129ml">編集対象</div> <div class="svelte-1m129ml"><select style="width:100%" class="svelte-1m129ml"></select></div></div> <div class="deck_editor_body_right_header_row svelte-1m129ml"><div class="svelte-1m129ml">新規名称</div> <div class="svelte-1m129ml"><input type="text" style="width:100%" class="svelte-1m129ml"></div></div> <div class="deck_editor_body_right_header_row svelte-1m129ml"></div> <div class="deck_editor_body_right_header_row svelte-1m129ml"><div class="svelte-1m129ml">基本操作</div> <div class="svelte-1m129ml"><button class="white_button svelte-1m129ml">デッキを保存</button></div> <div class="svelte-1m129ml"><button class="white_button svelte-1m129ml">デッキを複製</button></div> <div class="svelte-1m129ml"><button class="white_button svelte-1m129ml" title="shiftキー押下で確認メッセージスキップ">デッキを削除</button></div></div> <div class="deck_editor_body_right_header_row svelte-1m129ml"><div class="svelte-1m129ml">DL/UL</div> <!> <!> <div class="svelte-1m129ml"><button class="white_button svelte-1m129ml">アップロード</button></div></div></div> <div><!></div>',1),Ln=l("<div>デッキ情報読込中</div>"),qn=l('<div class="deck_editor_body_right_dummy svelte-1m129ml"></div>'),Yn=l("<div><!></div>"),Un=l('<div><div class="deck_editor_header svelte-1m129ml"></div> <div class="deck_editor_body svelte-1m129ml"><div class="deck_editor_body_left svelte-1m129ml"><div role="contentinfo" class="deck_editor_search_box svelte-1m129ml"><div class="deck_editor_search_box_header svelte-1m129ml"><div class="svelte-1m129ml"><button class="deck_editor_search_box_title svelte-1m129ml">検索条件</button></div> <div class="deck_editor_sort_setting_container svelte-1m129ml"></div></div> <div class="deck_editor_search_box_body svelte-1m129ml"><div class="deck_editor_search_box_row svelte-1m129ml"><div class="svelte-1m129ml"><button class="search_condition_title black_button svelte-1m129ml">名称</button></div> <div class="svelte-1m129ml"><input type="text" style="width:100%" placeholder="※ルビには対応していません" class="svelte-1m129ml"></div></div> <div class="deck_editor_search_box_row card_kind svelte-1m129ml"><div class="svelte-1m129ml"><button class="search_condition_title black_button svelte-1m129ml">種類</button></div> <div class="svelte-1m129ml"></div></div> <!> <!> <!> <!> <div class="deck_editor_search_box_row svelte-1m129ml"><div class="svelte-1m129ml"><button class="search_condition_title black_button svelte-1m129ml">その他</button></div> <div class="svelte-1m129ml"></div></div></div></div> <!></div> <div class="deck_editor_body_center svelte-1m129ml"><div class="deck_editor_body_center_body svelte-1m129ml"><!></div></div>  <div class="deck_editor_body_right svelte-1m129ml"><!></div></div> <div class="footer svelte-1m129ml"></div></div> <!> <!>',1);function Hn(f,i){ct(i,!1);const t=[],o=[],m=[],c=[],u=[],d=[],B=[],A=[],$=Da.createModalController({onDragStart:{append:()=>{},remove:()=>{}},onDragEnd:{append:()=>{},remove:()=>{}}}),S={name:"",deckCardKinds:[...ta],exMonsterCategories:[...aa],monsterCategories:Ha.filter(h=>!aa.includes(h)),monsterAttributes:[...Ua],monsterTypes:[...Ya],spellCategories:qa.filter(h=>h!=="PendulumScale"),trapCategories:[...La],starLowerBound:0,starUpperBound:13,atkLowerBound:0,atkUpperBound:5e3,defLowerBound:0,defUpperBound:5e3,atkPlusDef:void 0,others:["oldVersion"],sort:[...Pa]},n=le(structuredClone(S));be(n,e(n).monsterCategories=["Effect","Tuner","Pendulum"]);let L=le("DeckEdit"),R=le("SearchCondition");const I=()=>{if(!e(n).deckCardKinds.length){Xt(e(n)).forEach(h=>{Array.isArray(e(n)[h])&&Array.isArray(S[h])?be(n,e(n)[h]=[...S[h]]):be(n,e(n)[h]=S[h])});return}be(n,e(n).name=""),be(n,e(n).deckCardKinds=[]),be(n,e(n).exMonsterCategories=[]),be(n,e(n).monsterCategories=[]),be(n,e(n).monsterAttributes=[]),be(n,e(n).monsterTypes=[]),be(n,e(n).spellCategories=[]),be(n,e(n).trapCategories=[]),be(n,e(n).others=[]),be(n,e(n).atkLowerBound=0),be(n,e(n).atkUpperBound=5e3),be(n,e(n).defLowerBound=0),be(n,e(n).defUpperBound=5e3),be(n,e(n).atkPlusDef=void 0),be(n,e(n).sort=[...Pa])},_=h=>{h.forEach(k=>{Array.isArray(e(n)[k])&&Array.isArray(S[k])?be(n,e(n)[k]=e(n)[k].length?[]:[...S[k]]):be(n,e(n)[k]=S[k])})};let p=le(),K,te=le(!1);const $e=200,j=()=>{D(te,!1),D(p,void 0),K=void 0},q=(h,k)=>{const O=fa(k),ee=e(Q).cardTree[O].filter(Pe=>Pe.name===k.name).length;let pe=h.shiftKey?3-ee:1;console.debug(k,O,ee,pe),!h.ctrlKey&&ee>2&&(pe=0),pe&&be(Q,e(Q).cardTree[O]=[...e(Q).cardTree[O],...Array(pe).fill(k)].sort(Qa)),j(),M(k)},ce=(h,k)=>{const O=fa(k);let ee=0;be(Q,e(Q).cardTree[O]=e(Q).cardTree[O].filter(pe=>pe.name!==k.name?!0:(ee++,!h.shiftKey&&ee>1))),j(),M(k)},Me=h=>{if(h.changedTouches&&h.changedTouches.length!==1)return;const{clientX:k,clientY:O}=h.changedTouches?h.changedTouches[0]:h;return{clientX:k,clientY:O}},xe={onCardAppend:q,onCardRemove:ce,onCardDragCancel:j,onCardDragStart:(h,k,O)=>{if(M(O),k!=="List"&&k!=="Deck"){j();return}if(k==="List"&&!O.isImplemented){j();return}const ee=Me(h);if(!ee){j();return}K={from:k,cardInfo:O,pos:ee,startPos:ee},ea($e).then(()=>{(K==null?void 0:K.cardInfo)===O&&D(p,K)}),D(te,!1)},onCardDragging:(h,k)=>{if(e(p)&&h.preventDefault&&h.preventDefault(),e(p)&&h.stopPropagation&&h.stopPropagation(),!K){j();return}const O=Me(h);if(!O){j();return}const ee=e(p)||K;D(te,!!(ee.from==="List"&&ee.cardInfo.isImplemented&&document.elementsFromPoint(O.clientX,O.clientY).some(pe=>pe.classList.contains("deck_editor_body_right_body")||pe.classList.contains("deck_editor_body_right_dummy")))),e(te)&&D(L,"DeckEdit"),e(p)?D(p,{...e(p),pos:O}):K.pos={...O}},onCardDragEnd:h=>{if(!K||!e(p)){j();return}const k=Me(h);if(!k){j();return}e(p).from==="List"&&e(p).cardInfo.isImplemented&&document.elementsFromPoint(k.clientX,k.clientY).some(O=>O.classList.contains("deck_editor_body_right_body"))&&q(h,e(p).cardInfo),e(p).from==="Deck"&&!document.elementsFromPoint(k.clientX,k.clientY).some(O=>O.classList.contains("deck_editor_body_right_body"))&&ce(h,e(p).cardInfo),j()}},ve=(h,k,O)=>{Array.isArray(e(n)[k])&&Array.isArray(S[k])&&be(n,e(n)[k]=[O])},ie=async()=>{const k=(await e(Y)).find(ee=>ee.id===e(ge));if(!k)return;const O=await oa;D(Q,{...k,cardTree:kr(k.cardNames.map(ee=>{const pe=O.getCardInfo(ee);return pe===void 0&&console.error(ee),pe}).filter(ee=>ee!==void 0))})},je=()=>Dt.getAllDeckInfo().then(h=>(D(ge,(h.find(k=>k.lastUsedAt.getTime()===Math.max(...h.map(O=>O.lastUsedAt.getTime())))??h[0]).id),h));let ge=le(-1),Y=le(je()),N=le(e(Y).then(h=>Dt.convertToObjectURL(h)));e(Y).then(ie);const V=()=>{D(Y,je()),D(N,e(Y).then(h=>Dt.convertToObjectURL(h))),ie()};let Q=le({id:-Number.MAX_VALUE,name:"",description:"",lastUsedAt:new Date,cardTree:{ExtraMonster:[],Monster:[],Spell:[],Trap:[]}}),Te=le(void 0),E=0;const M=h=>{D(R,"CardDetail"),h.cardId!==void 0&&!h.description&&!h.pendulumDescription&&(E=h.cardId,xa([h.cardId]).then(()=>{h.cardId===E&&D(Te,h)})),D(Te,h)},P=async()=>{const k=(await e(Y)).find(O=>O.id===e(ge));if(!k)throw new Error("illegal state");return k},Z=async()=>{const h=await P();await h.saveDeckInfo({...h,name:e(Q).name,cardNames:Object.values(e(Q).cardTree).flatMap(k=>k).map(k=>k.name),lastUsedAt:new Date}),V()},se=async()=>{(await Dt.createNewDeck(`デッキ_${new Date().formatToYYYYMMDD_HHMMSS("","","")}`,`コピー日時：${new Date().formatToYYYYMMDD_HHMMSS("-"," ",":")}`,Object.values(e(Q).cardTree).flatMap(k=>k).map(k=>k.name))).saveDeckInfo(),V()},x=async h=>{const k=await P();!h.shiftKey&&!confirm(`デッキ【${k.name}】を削除します。
よろしいですか？`)||(await k.delete(),V())},F=async()=>{const h=await $.deckUploader.show({title:"デッキ情報アップロード",position:"Middle",cancelable:!0});if(!h)return;const k=[];if(h.replaceAll){if(!confirm(`既存デッキ情報を全て削除し、アップロードしたファイルに置き換えます。
よろしいですか？`))return;k.push(...(await e(Y)).map(O=>O.id))}await Promise.all(h.deckInfos.map(O=>Dt.createNewDeck(O.name,O.description,O.cardNames,O.lastUsedAt))),k.length&&await Promise.all(k.map(Dt.remove)),V()},W=()=>innerWidth<=1400?"compact":"wide";_t();var J=Un(),X=H(J),fe=s(a(X),2),T=a(fe),w=a(T),v=a(w),y=a(v),U=a(y),G=s(y,2);_e(G,5,()=>e(n).sort,ue,(h,k,O)=>{var ee=cn(),pe=a(ee);g(()=>{Be(ee,`deck_editor_sort_setting_item ${e(k).order??""} priority_${e(k).priority??""} svelte-1m129ml`),b(pe,`${br[e(k).key]??""}
                ${(e(k).order==="asc"?"▲":"▼")??""}`)}),z("click",ee,()=>{e(n).sort.forEach(Pe=>Pe.priority++),e(k).order=e(k).order==="asc"?"desc":"asc",Et(()=>e(n).sort),e(k).priority=1,Et(()=>e(n).sort)}),r(h,ee)});var Ce=s(v,2),De=a(Ce),me=a(De),ne=a(me),re=s(me,2),ae=a(re),Se=s(De,2),Re=a(Se),Ie=a(Re),Ke=s(Re,2);_e(Ke,5,()=>ta,ue,(h,k)=>{var O=_n(),ee=a(O),pe,Pe=s(ee);g(()=>{pe!==(pe=e(k))&&(ee.value=(ee.__value=e(k))==null?"":e(k)),b(Pe,` ${Ga[e(k)]??""}`)}),It(t,[],ee,()=>(e(k),e(n).deckCardKinds),ye=>be(n,e(n).deckCardKinds=ye)),z("dblclick",O,ye=>ve(ye,"deckCardKinds",e(k))),r(h,O)});var Ue=s(Se,2);{var Ge=h=>{var k=fn(),O=a(k),ee=a(O),pe=s(O,2);_e(pe,5,()=>aa,ue,(Pe,ye)=>{var Ne=un(),ze=a(Ne),Ve,tt=s(ze);g(()=>{Ve!==(Ve=e(ye))&&(ze.value=(ze.__value=e(ye))==null?"":e(ye)),b(tt,` ${da[e(ye)]??""}${_a[e(ye)]??""}`)}),It(o,[],ze,()=>(e(ye),e(n).exMonsterCategories),Je=>be(n,e(n).exMonsterCategories=Je)),z("dblclick",Ne,Je=>ve(Je,"exMonsterCategories",e(ye))),r(Pe,Ne)}),z("click",ee,()=>_(["exMonsterCategories"])),oe(3,k,()=>ke,()=>({delay:0,duration:100})),r(h,k)};C(Ue,h=>{e(n).deckCardKinds.includes("ExtraMonster")&&h(Ge)})}var lt=s(Ue,2);{var Ye=h=>{var k=bn(),O=H(k),ee=a(O),pe=a(ee),Pe=s(ee,2);_e(Pe,5,()=>Ha.filter(Ee=>!aa.includes(Ee)).filter(Ee=>Ee!=="Token"),ue,(Ee,qe)=>{var Oe=mn(),Fe=a(Oe),Ct,Ft=s(Fe);g(()=>{Ct!==(Ct=e(qe))&&(Fe.value=(Fe.__value=e(qe))==null?"":e(qe)),b(Ft,` ${da[e(qe)]??""}${_a[e(qe)]??""}`)}),It(m,[],Fe,()=>(e(qe),e(n).monsterCategories),Bt=>be(n,e(n).monsterCategories=Bt)),z("dblclick",Oe,Bt=>ve(Bt,"monsterCategories",e(qe))),r(Ee,Oe)});var ye=s(O,2),Ne=a(ye),ze=a(Ne),Ve=s(Ne,2);_e(Ve,5,()=>Ua,ue,(Ee,qe)=>{var Oe=pn(),Fe=a(Oe),Ct,Ft=s(Fe,2),Bt=s(Ft);g(()=>{Ct!==(Ct=e(qe))&&(Fe.value=(Fe.__value=e(qe))==null?"":e(qe)),Be(Ft,`monster_attr ${e(qe)??""} svelte-1m129ml`),b(Bt,` ${Sa[e(qe)]??""}`)}),It(c,[],Fe,()=>(e(qe),e(n).monsterAttributes),ba=>be(n,e(n).monsterAttributes=ba)),z("dblclick",Oe,ba=>ve(ba,"monsterAttributes",e(qe))),r(Ee,Oe)});var tt=s(ye,2),Je=a(tt),Ht=a(Je),Tt=s(Je,2);_e(Tt,5,()=>Ya,ue,(Ee,qe)=>{var Oe=gn(),Fe=a(Oe),Ct,Ft=s(Fe);g(()=>{Ct!==(Ct=e(qe))&&(Fe.value=(Fe.__value=e(qe))==null?"":e(qe)),b(Ft,` ${ga[e(qe)]??""}
                    ${Ma[e(qe)]??""}`)}),It(u,[],Fe,()=>(e(qe),e(n).monsterTypes),Bt=>be(n,e(n).monsterTypes=Bt)),z("dblclick",Oe,Bt=>ve(Bt,"monsterTypes",e(qe))),r(Ee,Oe)});var wt=s(tt,2),gt=a(wt),pt=a(gt),Pt=s(gt,2),At=a(Pt),Nt=s(a(At),2);g(()=>{e(n),Et(()=>{})}),_e(Nt,4,()=>Array(14),ue,(Ee,qe,Oe)=>{var Fe=yn();Fe.value=(Fe.__value=Oe)==null?"":Oe,Fe.textContent=Oe,r(Ee,Fe)});var Wt=s(Nt,4);g(()=>{e(n),Et(()=>{})}),_e(Wt,4,()=>Array(14),ue,(Ee,qe,Oe)=>{var Fe=hn();Fe.value=(Fe.__value=Oe)==null?"":Oe,Fe.textContent=Oe,r(Ee,Fe)});var ot=s(At,2),Qe=s(a(ot),2),dt=s(Qe,4),yt=s(ot,2),ht=s(a(yt),2),Jt=s(ht,4),Ze=s(yt,2),it=s(a(Ze),2);z("click",pe,()=>_(["monsterCategories"])),oe(3,O,()=>ke,()=>({delay:0,duration:100})),z("click",ze,()=>_(["monsterAttributes"])),oe(3,ye,()=>ke,()=>({delay:0,duration:100})),z("click",Ht,()=>_(["monsterTypes"])),oe(3,tt,()=>ke,()=>({delay:0,duration:100})),z("click",pt,()=>_(["starLowerBound","starUpperBound","atkLowerBound","atkUpperBound","defLowerBound","defUpperBound","atkPlusDef"])),Rt(Nt,()=>e(n).starLowerBound,Ee=>be(n,e(n).starLowerBound=Ee)),Rt(Wt,()=>e(n).starUpperBound,Ee=>be(n,e(n).starUpperBound=Ee)),Ot(Qe,()=>e(n).atkLowerBound,Ee=>be(n,e(n).atkLowerBound=Ee)),Ot(dt,()=>e(n).atkUpperBound,Ee=>be(n,e(n).atkUpperBound=Ee)),Ot(ht,()=>e(n).defLowerBound,Ee=>be(n,e(n).defLowerBound=Ee)),Ot(Jt,()=>e(n).defUpperBound,Ee=>be(n,e(n).defUpperBound=Ee)),Ot(it,()=>e(n).atkPlusDef,Ee=>be(n,e(n).atkPlusDef=Ee)),oe(3,wt,()=>ke,()=>({delay:0,duration:100})),r(h,k)};C(lt,h=>{(e(n).deckCardKinds.includes("Monster")||e(n).deckCardKinds.includes("ExtraMonster"))&&h(Ye)})}var he=s(lt,2);{var Le=h=>{var k=xn(),O=a(k),ee=a(O),pe=s(O,2);_e(pe,5,()=>qa.filter(Pe=>Pe!=="PendulumScale"),ue,(Pe,ye)=>{var Ne=kn(),ze=a(Ne),Ve,tt=s(ze);g(()=>{Ve!==(Ve=e(ye))&&(ze.value=(ze.__value=e(ye))==null?"":e(ye)),b(tt,` ${ya[e(ye)]??""}`)}),It(d,[],ze,()=>(e(ye),e(n).spellCategories),Je=>be(n,e(n).spellCategories=Je)),z("dblclick",Ne,Je=>ve(Je,"spellCategories",e(ye))),r(Pe,Ne)}),z("click",ee,()=>_(["spellCategories"])),oe(3,k,()=>ke,()=>({delay:0,duration:100})),r(h,k)};C(he,h=>{e(n).deckCardKinds.includes("Spell")&&h(Le)})}var He=s(he,2);{var We=h=>{var k=Cn(),O=a(k),ee=a(O),pe=s(O,2);_e(pe,5,()=>La,ue,(Pe,ye)=>{var Ne=wn(),ze=a(Ne),Ve,tt=s(ze);g(()=>{Ve!==(Ve=e(ye))&&(ze.value=(ze.__value=e(ye))==null?"":e(ye)),b(tt,` ${ha[e(ye)]??""}`)}),It(B,[],ze,()=>(e(ye),e(n).trapCategories),Je=>be(n,e(n).trapCategories=Je)),z("dblclick",Ne,Je=>ve(Je,"trapCategories",e(ye))),r(Pe,Ne)}),z("click",ee,()=>_(["trapCategories"])),oe(3,k,()=>ke,()=>({delay:0,duration:100})),r(h,k)};C(He,h=>{e(n).deckCardKinds.includes("Trap")&&h(We)})}var st=s(He,2),Xe=a(st),et=a(Xe),$t=s(Xe,2);_e($t,4,()=>[{key:"test",text:"テスト用カード"},{key:"oldVersion",text:"エラッタ前カード"},{key:"implemented",text:"未実装カード"}],ue,(h,k)=>{var O=Dn(),ee=a(O),pe,Pe=s(ee);g(()=>{pe!==(pe=k.key)&&(ee.value=(ee.__value=k.key)==null?"":k.key),b(Pe,` ${k.text??""}`)}),It(A,[],ee,()=>(k.key,e(n).others),ye=>be(n,e(n).others=ye)),r(h,O)});var vt=s(w,2);{var St=h=>{var k=$n(),O=a(k);Ji(O,{get cardInfo(){return e(Te)},onAttention:M,cardControlEventHandlers:xe,get deckCardTree(){return e(Q).cardTree}}),r(h,k)};C(vt,h=>{e(R)==="CardDetail"&&e(Te)&&h(St)})}var jt=s(T,2),Yt=a(jt),sa=a(Yt);mt(sa,()=>oa,h=>{var k=Sn();r(h,k)},(h,k)=>{Wa(h,{mode:"List",get allCardTree(){return e(k).tree},onAttention:M,get searchCondition(){return e(n)},cardControlEventHandlers:xe,get deckCardTree(){return e(Q).cardTree},set deckCardTree(O){be(Q,e(Q).cardTree=O)},$$legacy:!0})});var Ut=s(jt,2),Qt=a(Ut);{var kt=h=>{var k=we(),O=H(k);mt(O,()=>e(Y),ee=>{var pe=Ln();r(ee,pe)},(ee,pe)=>{var Pe=Bn(),ye=H(Pe),Ne=a(ye),ze=s(a(Ne),2),Ve=a(ze);g(()=>{e(ge),Et(()=>{e(pe)})}),_e(Ve,5,()=>e(pe),ue,(Ze,it)=>{var Ee=Mn(),qe={},Oe=a(Ee);g(()=>{qe!==(qe=e(it).id)&&(Ee.value=(Ee.__value=e(it).id)==null?"":e(it).id),b(Oe,e(it).name)}),r(Ze,Ee)});var tt=s(Ne,2),Je=s(a(tt),2),Ht=a(Je),Tt=s(tt,4),wt=s(a(Tt),2),gt=a(wt),pt=s(wt,2),Pt=a(pt),At=s(pt,2),Nt=a(At),Wt=s(Tt,2),ot=s(a(Wt),2);mt(ot,P,Ze=>{var it=En();r(Ze,it)},(Ze,it)=>{var Ee=Tn(),qe=a(Ee);g(Oe=>rt(qe,"href",Oe),[()=>Dt.convertToObjectURL([e(it)])],de),r(Ze,Ee)});var Qe=s(ot,2);mt(Qe,()=>e(N),Ze=>{var it=An();r(Ze,it)},(Ze,it)=>{var Ee=jn(),qe=a(Ee);g(()=>rt(qe,"href",e(it))),r(Ze,Ee)});var dt=s(Qe,2),yt=a(dt),ht=s(ye,2),Jt=a(ht);Wa(Jt,{mode:"Deck",allCardTree:{ExtraMonster:[],Monster:[],Spell:[],Trap:[]},onAttention:M,cardControlEventHandlers:xe,get deckCardTree(){return e(Q).cardTree},set deckCardTree(Ze){be(Q,e(Q).cardTree=Ze)},$$legacy:!0}),g(()=>Be(ht,`deck_editor_body_right_body ${(e(te)?"can_drop":"")??""} svelte-1m129ml`)),Rt(Ve,()=>e(ge),Ze=>D(ge,Ze)),z("change",Ve,ie),Ot(Ht,()=>e(Q).name,Ze=>be(Q,e(Q).name=Ze)),z("click",gt,Z),z("click",Pt,se),z("click",Nt,x),z("click",yt,F),r(ee,Pe)}),r(h,k)},Mt=h=>{var k=qn();r(h,k)};C(Qt,h=>{e(L)==="DeckEdit"||W()==="wide"?h(kt):h(Mt,!1)})}var xt=s(X,2);{var ia=h=>{var k=Yn(),O=a(k);Ja(O,{mode:"Dragging",get cardInfo(){return e(p).cardInfo},onAttention:M,cardControlEventHandlers:xe}),g(()=>rt(k,"style",`position: fixed;
          top:${e(p).pos.clientY??""}px;
          left:${e(p).pos.clientX??""}px;
          z-index:3; 
          filter: opacity(0.8);
        	transform: translateX(-50%) translateY(-50%);`)),r(h,k)};C(xt,h=>{e(p)&&h(ia)})}var na=s(xt,2);vn(na,{modalController:$}),g((h,k,O)=>Be(X,`deck_editor
         screen_size_${h??""}
         left_pain_mode_${k??""}
         main_view_mode_${O??""}
         ${(e(p)?"dragging_card":"")??""}
          svelte-1m129ml`),[W,()=>e(R).toLowerCase(),()=>e(L).toLowerCase()],de),z("click",U,I),z("click",ne,()=>_(["name"])),Ot(ae,()=>e(n).name,h=>be(n,e(n).name=h)),z("click",Ie,()=>_(["deckCardKinds"])),z("click",et,()=>_(["others"])),oe(3,st,()=>ke,()=>({delay:0,duration:100})),z("focusin",w,()=>{D(R,"SearchCondition"),D(L,"SearchCondition")}),z("click",w,()=>{D(R,"SearchCondition"),D(L,"SearchCondition")}),z("click",Ut,()=>{D(L,"DeckEdit")}),z("focusin",Ut,()=>{D(L,"DeckEdit")}),z("touchmove",X,h=>e(p)&&xe.onCardDragging(h,"Overlay")),z("mousemove",X,h=>e(p)&&xe.onCardDragging(h,"Overlay")),r(f,J),ut()}const Pn=["TblDeckHeader","TblDeckDetail","TblDuelistProfile"],Nn=3;var Fn=l('<input class="game_mode_radio svelte-sy4ydn" type="radio" name="game_mode"> <label> </label>',1),In=l('<option class="svelte-sy4ydn"> </option>'),On=l('<option class="svelte-sy4ydn"> </option>'),Rn=l('<option class="svelte-sy4ydn"> </option>'),Kn=l('<tr class="config_row svelte-sy4ydn"><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><label for="npc_deck_selector" class="config_row_label deck_selector svelte-sy4ydn">デッキ：</label></div></td><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><select id="npc_deck_selector" class="deck_selector svelte-sy4ydn"><option class="svelte-sy4ydn">デフォルト</option><!></select></div></td></tr>'),Wn=l('<option class="svelte-sy4ydn"> </option>'),zn=l('<tr class="config_row svelte-sy4ydn"><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><label for="npc_selector" class="config_row_label npc_selector svelte-sy4ydn">対戦相手：</label></div></td><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><select id="npc_selector" class="npc_selector svelte-sy4ydn"></select> <div class="svelte-sy4ydn"> </div></div></td></tr> <!> <tr class="config_row svelte-sy4ydn"><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><label for="npc_selector" class="config_row_label npc_selector svelte-sy4ydn">先攻後攻：</label></div></td><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><select id="npc_selector" class="npc_selector svelte-sy4ydn"></select></div></td></tr>',1),Vn=l('<option class="svelte-sy4ydn"> </option>'),Xn=l('<tr class="config_row svelte-sy4ydn"><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><label for="difficulty_selector" class="config_row_label difficulty_selector svelte-sy4ydn">難易度：</label></div></td><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><select id="difficulty_selector" class="difficulty_selector svelte-sy4ydn"></select></div></td></tr>'),Gn=l('<tr class="config_row svelte-sy4ydn"><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><label class="config_row_label svelte-sy4ydn" for="game_mode_radio_preset">ゲームモード：</label></div></td><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"></div></td></tr> <tr class="config_row svelte-sy4ydn"><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><label for="deck_selector" class="config_row_label deck_selector svelte-sy4ydn">デッキ：</label></div></td><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><select id="deck_selector" class="deck_selector svelte-sy4ydn"></select></div></td></tr> <!> <tr><td colspan="2" class="svelte-sy4ydn"><div><button class="btn svelte-sy4ydn">duel start!</button></div></td></tr>',1),Qn=l('<tr><td colspan="2" class="svelte-sy4ydn"><div>デッキ情報の読み込み、もしくは作成中...</div></td></tr>'),Jn=l('<tr><td colspan="2" class="svelte-sy4ydn"><div><button class="btn svelte-sy4ydn">deck edit</button></div></td></tr>'),Zn=l('<tr class="config_row svelte-sy4ydn"><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><label for="duelist_name" class="config_row_label duelist_name svelte-sy4ydn">名前：</label></div></td><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><input id="duelist_name" class="duelist_name svelte-sy4ydn" type="text"></div></td></tr> <!> <!>',1),el=l('<tr><td colspan="2" class="svelte-sy4ydn"><div>デュエリスト情報の読み込み、もしくは作成中...</div></td></tr>'),tl=l('<div class="app_body svelte-sy4ydn"><table class="config_table svelte-sy4ydn"><tbody><!></tbody></table></div>'),al=l('<span class="svelte-sy4ydn"> </span> <span class="svelte-sy4ydn"> </span>',1),rl=l('<div class="result_title result_win svelte-sy4ydn">YOU WIN</div>'),sl=l('<div class="result_title result_lose svelte-sy4ydn">YOU LOSE</div>'),il=l('<div class="result_title result_draw svelte-sy4ydn">DRAW</div>'),nl=l('<div class="twitter_share_button_wrapper svelte-sy4ydn"><a rel="nofollow" target="_blank" class="twitter_share_button svelte-sy4ydn">X(twitter)でシェアする</a></div>'),ll=l('<div class="result svelte-sy4ydn"><!> <div class="reason_of_end svelte-sy4ydn"> </div> <!> <div class="svelte-sy4ydn"><button class="white_button svelte-sy4ydn">TOPへ戻る</button></div></div>'),ol=l('<main style="flex-direction: column; display :flex" class="svelte-sy4ydn"><div class="link link_left svelte-sy4ydn"><a href="https://github.com/Setta238/stk_ygo_svelte" target="_blank" rel="noopener noreferrer" title="repository" class="svelte-sy4ydn">repository</a> <a href="https://x.com/ninja_no" target="_blank" rel="noopener noreferrer" title="repository" class="svelte-sy4ydn">X(Twitter)</a> <a href="https://posfie.com/@ninja_no/p/Lx7FLj3" target="_blank" rel="noopener noreferrer" title="posfie" class="svelte-sy4ydn">posfie(toggeter)</a></div> <div class="link link_right svelte-sy4ydn"><a class="a_button svelte-sy4ydn" role="button" tabindex="0">TOPへ戻る</a> <a href="/stk_ygo_svelte/note.html" target="_blank" rel="noopener noreferrer" title="repository" class="svelte-sy4ydn">現時点とこの先のこと</a></div> <!> <div class="footer card_summary svelte-sy4ydn"><!></div> <div class="footer debug_info svelte-sy4ydn"><span class="svelte-sy4ydn"> </span> <span class="user_agent_info svelte-sy4ydn"> </span> <span class="screen_info svelte-sy4ydn"> </span></div> <!></main>');function dl(f,i){ct(i,!1);const t=new xr("stk_ygo_svelte",Nn,Pn);let o=le(0),m=le(0),c=le(),u=le("FtkChallenge"),d=le("None"),B=le(0),A=le(""),$=le(void 0);const S="https://setta238.github.io/stk_ygo_svelte/",n="遊戯王deそりてあ",L="ninja_no",R=wr.getOrCreateNew(t).then(T=>(D(u,Na.includes(T.previousGameMode)?T.previousGameMode:"FtkChallenge"),je(T.previousNpcId),T)),I=T=>{var v;const w=T.find(y=>y.lastUsedAt.getTime()===Math.max(...T.map(U=>U.lastUsedAt.getTime())))??T[0];D(B,w.id),e(u)==="FtkChallenge"&&w.deckType!=="Preset"&&D(B,((v=zt.find(y=>y.deckType==="Preset"))==null?void 0:v.id)??e(B))};let _=le(Dt.getAllDeckInfo(t).then(T=>(Promise.all(T.filter(w=>!w.lastUsedAt).map(w=>{w.saveDeckInfo()})),I(T),T)));const p=async()=>{const T=e(B);let w=(await e(_)).find(y=>y.id===T)??(await te()).find(y=>y.id===T);w&&await w.updateTimestamp();let v=w;if(v||(v=zt.find(y=>y.id===T)),!v)throw new Error("illegal state");return v},K=async()=>{(await R).save({previousGameMode:e(u)})},te=()=>(D(_,Dt.getAllDeckInfo(t).then(T=>(I(T),T))),e(_)),$e=async()=>{(await e(_)).length||(await Dt.prepareSampleDeck(),te())},j=async()=>{await Promise.all([K(),$e()]);const T=await p(),w=await R;let v=Zt.find(G=>G.id===Number.MIN_SAFE_INTEGER)??Zt[0],y=zt.find(G=>G.id===Number.MIN_SAFE_INTEGER)??zt[0],U="PlayFirst";e(u)==="FtkChallenge"?v=Zt.filter(G=>G.npcType==="FtkChallenge").find(G=>G.difficulty===w.previousDifficulty)??v:e(u)==="Free"&&(v=Zt.find(G=>G.id===w.previousNpcId)??v,y=zt.slice(-1)[0],U=w.previousStartMode),v.npcType!=="FtkChallenge"&&w.previousNpcDeckId>-1?y=(await e(_)).find(G=>G.id===w.previousNpcDeckId)??y:y=zt.find(G=>G.id===v.id)??y,D(c,new Sr(w,"Player",T,[],v,"NPC",y,[],U)),e(c).onDuelEnd.append(()=>(D(c,e(c)),"RemoveMe"))},q=async()=>{await Promise.all([K(),$e()]),D(d,"DeckEdit")},ce=async T=>{await K(),T.key==="Enter"&&!T.repeat&&(await R).save()},Me=()=>{D(_,te()),D(c,void 0),D(d,"None")};let xe=Date.now();const ve=T=>{Date.now()-xe<200||(xe=Date.now(),D(u,T),te())},ie=T=>{je(Number(T.currentTarget.value))},je=T=>{var w;D($,Zt.find(v=>v.id===T)),D(A,((w=e($))==null?void 0:w.description)??"")};$e(),_t();var ge=ol(),Y=s(a(ge),2),N=a(Y),V=s(Y,2);{var Q=T=>{var w=we(),v=H(w);mt(v,()=>R,null,(y,U)=>{Ci(y,{get duel(){return e(c)},get userProfile(){return e(U)}})}),r(T,w)},Te=T=>{var w=we(),v=H(w);{var y=G=>{Hn(G,{})},U=G=>{var Ce=tl(),De=a(Ce),me=a(De),ne=a(me);mt(ne,()=>R,re=>{var ae=el();r(re,ae)},(re,ae)=>{var Se=Zn(),Re=H(Se),Ie=a(Re),Ke=a(Ie),Ue=s(Ie),Ge=a(Ue),lt=a(Ge),Ye=s(Re,2);mt(Ye,()=>e(_),He=>{var We=Qn();r(He,We)},(He,We)=>{var st=Gn(),Xe=H(st),et=a(Xe),$t=a(et),vt=s(et),St=a(vt);_e(St,5,()=>Na,ue,(ee,pe)=>{var Pe=Fn(),ye=H(Pe),Ne=s(ye,2),ze=a(Ne);g(Ve=>{rt(ye,"id",`game_mode_radio_${Ve??""}`),Dr(ye,e(pe)),$r(ye,e(u)===e(pe)),Be(Ne,`game_mode_tab_label game_mode_tab_${Ve??""} svelte-sy4ydn`),rt(Ne,"for",`game_mode_radio_${Ve??""}`),b(ze,e(pe))},[()=>e(pe).toLowerCase()],de),z("change",ye,()=>ve(e(pe))),r(ee,Pe)});var jt=s(Xe,2),Yt=a(jt),sa=a(Yt),Ut=s(Yt),Qt=a(Ut),kt=a(Qt);g(()=>{e(B),Et(()=>{e(u),e(We)})}),_e(kt,5,()=>e(u)==="FtkChallenge"?zt.filter(ee=>ee.deckType==="Preset"):e(We),ue,(ee,pe)=>{var Pe=In(),ye={},Ne=a(Pe);g(()=>{ye!==(ye=e(pe).id)&&(Pe.value=(Pe.__value=e(pe).id)==null?"":e(pe).id),b(Ne,e(pe).name)}),r(ee,Pe)});var Mt=s(jt,2);{var xt=ee=>{var pe=zn(),Pe=H(pe),ye=a(Pe),Ne=a(ye),ze=s(ye),Ve=a(ze),tt=a(Ve);g(()=>{e(ae),Et(()=>{})}),_e(tt,5,()=>Zt,ue,(ot,Qe)=>{var dt=On(),yt={},ht=a(dt);g(()=>{yt!==(yt=e(Qe).id)&&(dt.value=(dt.__value=e(Qe).id)==null?"":e(Qe).id),b(ht,e(Qe).name)}),r(ot,dt)});var Je=s(tt,2),Ht=a(Je),Tt=s(Pe,2);{var wt=ot=>{var Qe=Kn(),dt=a(Qe),yt=a(dt),ht=s(dt),Jt=a(ht),Ze=a(Jt);g(()=>{e(ae),Et(()=>{e(We)})});var it=a(Ze);it.value=(it.__value=Number.MIN_SAFE_INTEGER)==null?"":Number.MIN_SAFE_INTEGER;var Ee=s(it);_e(Ee,1,()=>e(We),ue,(qe,Oe)=>{var Fe=Rn(),Ct={},Ft=a(Fe);g(()=>{Ct!==(Ct=e(Oe).id)&&(Fe.value=(Fe.__value=e(Oe).id)==null?"":e(Oe).id),b(Ft,e(Oe).name)}),r(qe,Fe)}),oe(3,yt,()=>ke,()=>({duration:200})),oe(3,dt,()=>ke,()=>({duration:200})),Rt(Ze,()=>e(ae).previousNpcDeckId,qe=>e(ae).previousNpcDeckId=qe),oe(3,Jt,()=>ke,()=>({duration:200})),oe(3,ht,()=>ke,()=>({duration:200})),oe(3,Qe,()=>ke,()=>({duration:200})),r(ot,Qe)};C(Tt,ot=>{var Qe;((Qe=e($))==null?void 0:Qe.npcType)!=="FtkChallenge"&&ot(wt)})}var gt=s(Tt,2),pt=a(gt),Pt=a(pt),At=s(pt),Nt=a(At),Wt=a(Nt);g(()=>{e(ae),Et(()=>{})}),_e(Wt,5,()=>Xt(Fa),ue,(ot,Qe)=>{var dt=Wn(),yt={},ht=a(dt);g(()=>{yt!==(yt=e(Qe))&&(dt.value=(dt.__value=e(Qe))==null?"":e(Qe)),b(ht,Fa[e(Qe)])}),r(ot,dt)}),g(()=>b(Ht,`※${e(A)??""}`)),oe(3,Ne,()=>ke,()=>({duration:200})),oe(3,ye,()=>ke,()=>({duration:200})),z("change",tt,ie),Rt(tt,()=>e(ae).previousNpcId,ot=>e(ae).previousNpcId=ot),oe(3,Ve,()=>ke,()=>({duration:200})),oe(3,ze,()=>ke,()=>({duration:200})),oe(3,Pe,()=>ke,()=>({duration:200})),oe(3,Pt,()=>ke,()=>({duration:200})),oe(3,pt,()=>ke,()=>({duration:200})),Rt(Wt,()=>e(ae).previousStartMode,ot=>e(ae).previousStartMode=ot),oe(3,Nt,()=>ke,()=>({duration:200})),oe(3,At,()=>ke,()=>({duration:200})),oe(3,gt,()=>ke,()=>({duration:200})),r(ee,pe)},ia=ee=>{var pe=we(),Pe=H(pe);{var ye=Ne=>{var ze=Xn(),Ve=a(ze),tt=a(Ve),Je=s(Ve),Ht=a(Je),Tt=a(Ht);g(()=>{e(ae),Et(()=>{})}),_e(Tt,5,()=>Mr,ue,(wt,gt)=>{var pt=Vn(),Pt={},At=a(pt);g(()=>{Pt!==(Pt=e(gt))&&(pt.value=(pt.__value=e(gt))==null?"":e(gt)),b(At,e(gt))}),r(wt,pt)}),oe(3,tt,()=>ke,()=>({duration:200})),oe(3,Ve,()=>ke,()=>({duration:200})),Rt(Tt,()=>e(ae).previousDifficulty,wt=>e(ae).previousDifficulty=wt),oe(3,Ht,()=>ke,()=>({duration:200})),oe(3,Je,()=>ke,()=>({duration:200})),oe(3,ze,()=>ke,()=>({duration:200})),r(Ne,ze)};C(Pe,Ne=>{e(u)==="FtkChallenge"&&Ne(ye)},!0)}r(ee,pe)};C(Mt,ee=>{e(u)==="Free"?ee(xt):ee(ia,!1)})}var na=s(Mt,2),h=a(na),k=a(h),O=a(k);oe(3,$t,()=>ke,()=>({duration:200})),oe(3,et,()=>ke,()=>({duration:200})),oe(3,St,()=>ke,()=>({duration:200})),oe(3,vt,()=>ke,()=>({duration:200})),oe(3,Xe,()=>ke,()=>({duration:200})),oe(3,sa,()=>ke,()=>({duration:200})),oe(3,Yt,()=>ke,()=>({duration:200})),Rt(kt,()=>e(B),ee=>D(B,ee)),oe(3,Qt,()=>ke,()=>({duration:200})),oe(3,Ut,()=>ke,()=>({duration:200})),oe(3,jt,()=>ke,()=>({duration:200})),z("click",O,j),oe(3,k,()=>ke,()=>({duration:200})),r(He,st)});var he=s(Ye,2);{var Le=He=>{var We=Jn(),st=a(We),Xe=a(st),et=a(Xe);z("click",et,q),oe(3,Xe,()=>ke,()=>({duration:200})),oe(3,st,()=>ke,()=>({duration:200})),oe(3,We,()=>ke,()=>({duration:200})),r(He,We)};C(he,He=>{e(u)==="Free"&&He(Le)})}oe(3,Ke,()=>ke,()=>({duration:200})),oe(3,Ie,()=>ke,()=>({duration:200})),Ot(lt,()=>e(ae).name,He=>e(ae).name=He),z("keypress",lt,ce),oe(3,Ge,()=>ke,()=>({duration:200})),oe(3,Ue,()=>ke,()=>({duration:200})),oe(3,Re,()=>ke,()=>({duration:200})),r(re,Se)}),r(G,Ce)};C(v,G=>{e(d)==="DeckEdit"?G(y):G(U,!1)},!0)}r(T,w)};C(V,T=>{e(c)?T(Q):T(Te,!1)})}var E=s(V,2),M=a(E);mt(M,()=>oa,T=>{var w=at("読み込み中");r(T,w)},(T,w)=>{var v=al(),y=H(v),U=a(y),G=s(y,2),Ce=a(G);g((De,me,ne)=>{b(U,`公式DB上のカード${De??""}枚`),b(Ce,`実装済カード（効果あり）${me??""}枚 （効果なし）${ne??""}枚`)},[()=>e(w).knmCount.toLocaleString(),()=>e(w).definitionCount.toLocaleString(),()=>e(w).nonDefinitionCount.toLocaleString()],de),r(T,v)});var P=s(E,2),Z=a(P),se=a(Z),x=s(Z,2),F=a(x),W=s(x,2),J=a(W),X=s(P,2);{var fe=T=>{var w=ll(),v=a(w);{var y=ae=>{var Se=we(),Re=H(Se);{var Ie=Ue=>{var Ge=rl();r(Ue,Ge)},Ke=Ue=>{var Ge=we(),lt=H(Ge);{var Ye=he=>{var Le=sl();r(he,Le)};C(lt,he=>{e(c).winner.seat==="Above"&&he(Ye)},!0)}r(Ue,Ge)};C(Re,Ue=>{e(c).winner.seat==="Below"?Ue(Ie):Ue(Ke,!1)})}r(ae,Se)},U=ae=>{var Se=il();r(ae,Se)};C(v,ae=>{e(c).winner?ae(y):ae(U,!1)})}var G=s(v,2),Ce=a(G),De=s(G,2);{var me=ae=>{var Se=nl(),Re=a(Se);g(()=>rt(Re,"href",`https://x.com/share?url=${S}&text=${e(c).twitterShareText??""}&hashtags=${n}&via=${L}`)),r(ae,Se)};C(De,ae=>{e(c).twitterShareText&&ae(me)})}var ne=s(De,2),re=a(ne);g(()=>b(Ce,e(c).reasonOfEnd)),z("click",re,Me),oe(3,w,()=>jr,()=>({delay:200,duration:200})),r(T,w)};C(X,T=>{e(c)&&e(c).isEnded&&T(fe)})}g(()=>{b(se,"build at: 20260124_123157"),b(F,Cr.text),b(J,`w:${e(o)??""}px h:${e(m)??""}px`)}),ua("innerWidth",T=>D(o,T)),ua("innerHeight",T=>D(m,T)),z("click",N,Me),r(f,ge),ut()}Tr(dl,{target:document.getElementById("app")});
