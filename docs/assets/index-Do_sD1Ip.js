var Va=Object.defineProperty;var Da=d=>{throw TypeError(d)};var Ga=(d,i,t)=>i in d?Va(d,i,{enumerable:!0,configurable:!0,writable:!0,value:t}):d[i]=t;var ot=(d,i,t)=>Ga(d,typeof i!="symbol"?i+"":i,t),$a=(d,i,t)=>i.has(d)||Da("Cannot "+t);var gt=(d,i,t)=>($a(d,i,"read from private field"),t?t.call(d):i.get(d)),Qt=(d,i,t)=>i.has(d)?Da("Cannot add the same private member more than once"):i instanceof WeakSet?i.add(d):i.set(d,t),_a=(d,i,t,c)=>($a(d,i,"write to private field"),c?c.call(d,t):i.set(d,t),t);import{s as Sa,r as Qa,a as x,b as Xa,l as Ja,g as e,d as Ra,p as mt,c as We,m as _e,i as ht,t as l,e as a,f as h,h as f,j as ye,k as Ee,n as xt,o as ve,q as s,u as bt,v as be,D as Za,w as Te,x as N,y as r,z as le,A as Ft,B as ae,C as de,E as y,F as er,G as it,H as Ht,I as tr,J as ar,K as Nt,L as kt,M as Xt,N as Wa,O as ma,P as la,Q as ha,R as Jt,S as ra,T as oa,U as va,V as rr,W as sr,X as ir,Y as nr,Z as lr,_ as or,$ as vr,a0 as sa,a1 as Ma,a2 as dr,a3 as Ia,a4 as cr,a5 as zt,a6 as fa,a7 as ua,a8 as jt,a9 as Ta,aa,ab as _r,ac as ur,ad as fr,ae as Vt,af as pr,ag as Dt,ah as yr,ai as gr,aj as mr,ak as ja,al as Ba,am as Ea,an as Aa,ao as Ya,ap as La,aq as hr,ar as Ut,as as Lt,at as St,au as br,av as Kt,aw as kr,ax as xr,ay as Ua,az as It,aA as Pt,aB as wr,aC as Cr,aD as Na,aE as Dr,aF as $r,aG as Sr}from"../chunk/entity_proc_20260111_214016.js";import"../chunk/json_20260111_214016.js";(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const _ of document.querySelectorAll('link[rel="modulepreload"]'))c(_);new MutationObserver(_=>{for(const v of _)if(v.type==="childList")for(const u of v.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&c(u)}).observe(document,{childList:!0,subtree:!0});function t(_){const v={};return _.integrity&&(v.integrity=_.integrity),_.referrerPolicy&&(v.referrerPolicy=_.referrerPolicy),_.crossOrigin==="use-credentials"?v.credentials="include":_.crossOrigin==="anonymous"?v.credentials="omit":v.credentials="same-origin",v}function c(_){if(_.ep)return;_.ep=!0;const v=t(_);fetch(_.href,v)}})();const Mr=d=>d;function ba(d){const i=d-1;return i*i*i+1}function qa(d){const i=typeof d=="string"&&d.match(/^\s*(-?[\d.]+)([^\s]*)\s*$/);return i?[parseFloat(i[1]),i[2]||"px"]:[d,"px"]}function Tr(d,{delay:i=0,duration:t=400,easing:c=Mr}={}){const _=+getComputedStyle(d).opacity;return{delay:i,duration:t,easing:c,css:v=>`opacity: ${v*_}`}}function jr(d,{delay:i=0,duration:t=400,easing:c=ba,x:_=0,y:v=0,opacity:u=0}={}){const o=getComputedStyle(d),L=+o.opacity,A=o.transform==="none"?"":o.transform,S=L*(1-u),[M,n]=qa(_),[P,W]=qa(v);return{delay:i,duration:t,easing:c,css:(V,E)=>`
			transform: ${A} translate(${(1-V)*M}${n}, ${(1-V)*P}${W});
			opacity: ${L-S*E}`}}function pe(d,{delay:i=0,duration:t=400,easing:c=ba,axis:_="y"}={}){const v=getComputedStyle(d),u=+v.opacity,o=_==="y"?"height":"width",L=parseFloat(v[o]),A=_==="y"?["top","bottom"]:["left","right"],S=A.map(U=>`${U[0].toUpperCase()}${U.slice(1)}`),M=parseFloat(v[`padding${S[0]}`]),n=parseFloat(v[`padding${S[1]}`]),P=parseFloat(v[`margin${S[0]}`]),W=parseFloat(v[`margin${S[1]}`]),V=parseFloat(v[`border${S[0]}Width`]),E=parseFloat(v[`border${S[1]}Width`]);return{delay:i,duration:t,easing:c,css:U=>`overflow: hidden;opacity: ${Math.min(U*20,1)*u};${o}: ${U*L}px;padding-${A[0]}: ${U*M}px;padding-${A[1]}: ${U*n}px;margin-${A[0]}: ${U*P}px;margin-${A[1]}: ${U*W}px;border-${A[0]}-width: ${U*V}px;border-${A[1]}-width: ${U*E}px;min-${o}: 0`}}function Pa(d,i){for(const t in i)d[t]=i[t];return d}function Br({fallback:d,...i}){const t=new Map,c=new Map;function _(u,o,L){const{delay:A=0,duration:S=I=>Math.sqrt(I)*30,easing:M=ba}=Pa(Pa({},i),L),n=u.getBoundingClientRect(),P=o.getBoundingClientRect(),W=n.left-P.left,V=n.top-P.top,E=n.width/P.width,U=n.height/P.height,ce=Math.sqrt(W*W+V*V),xe=getComputedStyle(o),k=xe.transform==="none"?"":xe.transform,B=+xe.opacity;return{delay:A,duration:typeof S=="function"?S(ce):S,easing:M,css:(I,te)=>`
			   opacity: ${I*B};
			   transform-origin: top left;
			   transform: ${k} translate(${te*W}px,${te*V}px) scale(${I+(1-I)*E}, ${I+(1-I)*U});
		   `}}function v(u,o,L){return(A,S)=>(u.set(S.key,A),()=>{if(o.has(S.key)){const M=o.get(S.key);return o.delete(S.key),_(M,A,S)}return u.delete(S.key),d&&d(A,S,L)})}return[v(c,t,!1),v(t,c,!0)]}function Fa(d){return Object.prototype.toString.call(d)==="[object Date]"}function Er(d){return d}function pa(d){const i=d-1;return i*i*i+1}function ya(d,i){if(d===i||d!==d)return()=>d;const t=typeof d;if(t!==typeof i||Array.isArray(d)!==Array.isArray(i))throw new Error("Cannot interpolate values of different type");if(Array.isArray(d)){const c=i.map((_,v)=>ya(d[v],_));return _=>c.map(v=>v(_))}if(t==="object"){if(!d||!i)throw new Error("Object cannot be null");if(Fa(d)&&Fa(i)){const v=d.getTime(),o=i.getTime()-v;return L=>new Date(v+L*o)}const c=Object.keys(i),_={};return c.forEach(v=>{_[v]=ya(d[v],i[v])}),v=>{const u={};return c.forEach(o=>{u[o]=_[o](v)}),u}}if(t==="number"){const c=i-d;return _=>d+_*c}return()=>i}var Bt,Gt,Zt,Ot;const ka=class ka{constructor(i,t={}){Qt(this,Bt,Sa(void 0));Qt(this,Gt,Sa(void 0));Qt(this,Zt);Qt(this,Ot,null);gt(this,Bt).v=gt(this,Gt).v=i,_a(this,Zt,t)}static of(i,t){const c=new ka(i(),t);return Qa(()=>{c.set(i())}),c}set(i,t){var M;x(gt(this,Gt),i);let{delay:c=0,duration:_=400,easing:v=Er,interpolate:u=ya}={...gt(this,Zt),...t};if(_===0)return(M=gt(this,Ot))==null||M.abort(),x(gt(this,Bt),i),Promise.resolve();const o=Xa.now()+c;let L,A=!1,S=gt(this,Ot);return _a(this,Ot,Ja(n=>{if(n<o)return!0;if(!A){A=!0;const W=gt(this,Bt).v;L=u(W,i),typeof _=="function"&&(_=_(W,i)),S==null||S.abort()}const P=n-o;return P>_?(x(gt(this,Bt),i),!1):(x(gt(this,Bt),L(v(P/_))),!0)})),gt(this,Ot).promise}get current(){return e(gt(this,Bt))}get target(){return e(gt(this,Gt))}set target(i){this.set(i)}};Bt=new WeakMap,Gt=new WeakMap,Zt=new WeakMap,Ot=new WeakMap;let ia=ka;var Ar=l('<div class="phase_display svelte-1boxe40"><span class="svelte-1boxe40"> </span> </div>'),Yr=l('<div class="lifepoint_display svelte-1boxe40"><div class="svelte-1boxe40"> </div> <div class="svelte-1boxe40"> </div></div>'),Lr=(d,i,t)=>i(e(t)),Ur=l('<div class="svelte-1boxe40"><button class="phase_button svelte-1boxe40"> </button></div>'),Nr=l("<div><!></div>"),qr=l('<div class="svelte-1boxe40"><!></div>'),Pr=l("<div><!></div>"),Fr=l('<div class="config_button_wrapper svelte-1boxe40"><button id="config_button" class="svelte-1boxe40">⚙</button></div>'),Hr=l("<!> <!> <!> <!>",1),Or=l('<div style="position: absolute;" class="card_animation_receiver svelte-1boxe40"><!></div>'),Rr=l('<div style="position: absolute; top:0rem" class="svelte-1boxe40">｛効果対象｝</div>'),Wr=l('<!> <div style="position: absolute; display:flex;justify-content: center;"><!></div>',1),Ir=l(" <!> 】",1),Kr=l('<div style="position: absolute; bottom:0rem" class="svelte-1boxe40"> <!></div>'),zr=l("<!> <!>",1),Vr=l('<div class="badge svelte-1boxe40"> </div>'),Gr=l('<div class="card_animation_receiver svelte-1boxe40"><!></div>'),Qr=l("<!> <!> <!> <!>",1),Xr=l('<td><div role="listitem"><!></div></td>');function Jr(d,i){mt(i,!1);let t=We(i,"view",12),c=We(i,"row",8),_=We(i,"column",8),v=We(i,"selectedEntities",28,()=>[]),u=We(i,"selectedCells",28,()=>[]),o=_e(t().getCell(c(),_())),L=_e(new ia(e(o).field.duel.duelists.Above.lp,{duration:400,easing:pa})),A=_e(new ia(e(o).field.duel.duelists.Below.lp,{duration:400,easing:pa}));const S=()=>{x(o,t().getCell(c(),_())),be(L,e(L).target=e(o).field.duel.duelists.Above.lp),be(A,e(A).target=e(o).field.duel.duelists.Below.lp)};e(o).onUpdate.append(S),t().onDuelUpdate.append(S),t().modalController.onUpdate.append(S);let M,n=_e([]),P=()=>console.log("hoge"),W,V=_e([]),E=_e(!1),U=_e(!1),ce=!1;const xe=D=>{var j,m;x(re,[]),v().reset(),M=D.activator,P=D.resolve,x(n,D.dummyActionInfos),x(V,D.chainBlockInfos.flatMap(F=>F.selectedEntities).getDistinct()),W=D.entitiesChoices,x(E,!1),x(U,((j=D.cellsChoices)==null?void 0:j.selectables.includes(e(o)))??!1),ce=e(U)&&((m=D.cellsChoices)==null?void 0:m.qty)===1,S()};t().onWaitStart.append(xe);const k=()=>{M=void 0,x(n,[]),P=()=>{console.log("hoge")},W=void 0,x(V,[]),x(E,!1),x(U,!1),ce=!1};t().onWaitEnd.append(k);let B=_e(!1),I=[];const te=D=>{I=D.filter(j=>j.dests.includes(e(o))),x(B,I.length>0),S()},ee=()=>{I=[],x(B,!1),S()};t().onDragStart.append(te),t().onDragEnd.append(ee);const[we,me]=li;let re=_e([]);const Ye=D=>{if(M=void 0,e(o)===D.to||e(o).entities.includes(D.entity)){x(re,[...e(re),D]);const j=D.resolve;x(o,e(o)),setTimeout(()=>{x(re,e(re).filter(m=>m!==D)),D.count++,D.count>1&&j()},600)}};t().onAnimation.append(Ye);const he=D=>{P({phaseChange:D})},Y=()=>e(o).isStackCell&&e(o).entities.flatMap(D=>D.actions).filter(D=>e(n).map(j=>j.action.seq).some(j=>j===D.seq)).length>0,q=D=>{var j;if(((j=D.target)==null?void 0:j.id)==="config_button"){t(t().infoBoardState="Config",!0),t().requireUpdate();return}if(t(t().infoBoardState="Default",!0),ce)P({selectedCells:[e(o)]});else if(e(U))x(E,!e(E)),u(e(E)?[...u(),e(o)]:u().filter(m=>m!==e(o)));else if(e(o).isStackCell){t(t().infoBoardState="CellInfo",!0),t(t().infoBoardCell=e(o),!0),t().requireUpdate();const m=e(o).entities.flatMap(X=>X.actions).map(X=>X.seq),F=e(n).filter(X=>m.includes(X.action.seq));if(F.length){if(!M)return;t().modalController.actionSelector.show({title:"カードを選択。",position:"Bottom",activator:M,dummyActionInfos:F,cancelable:!0}).then(X=>{X&&P({actionInfo:X})});return}}t().requireUpdate(),console.info(e(o),Se(...e(o).visibleEntities))},oe=D=>{D.preventDefault(),D.dataTransfer&&(D.dataTransfer.dropEffect="move")},ke=D=>{D.preventDefault(),console.info("drop",D,e(B),I),D.dataTransfer&&(D.dataTransfer.dropEffect="move");try{if(e(B)&&I){if(I.length===1){const j=I[0];P({actionInfo:{...j,dest:e(o)}})}else if(I.length>1){if(!M)throw new Za("想定されない状態");e(o).field.duel.view.modalController.terminateAll(),e(o).field.duel.view.modalController.actionSelector.show({title:"選択",position:"Bottom",activator:M,dummyActionInfos:I.map(j=>({...j,dest:e(o)})),cancelable:!1}).then(j=>{P({actionInfo:j})})}}}finally{t().removeDraggingActions()}},Se=(...D)=>{if(t().waitMode==="Animation")return"Disabled";if(W&&W.selectables.find(m=>D.find(F=>m===F)))return"Selectable";if(!e(n)||e(n).length===0||t().waitMode!=="Free"||Object.values(t().modalController.modals).some(m=>m.state==="Shown"))return"Disabled";const j=e(n).filter(m=>D.includes(m.action.entity));return j.length===0?"Disabled":e(o).isStackCell||j[0].action.entity!==D[0]?"Clickable":j.some(m=>m.dests.length)?"Draggable":"Clickable"};ht();var R=Xr(),T=a(R);T.__click=q;var G=a(T);{var se=D=>{var j=Te(),m=N(j);{var F=X=>{var Ce=Te(),$=N(Ce);{var w=g=>{var O=Ar(),K=a(O),Me=a(K),De=r(K,1,!0);f((ue,J)=>{y(Me,ue),y(De,J)},[()=>String(e(o).field.duel.clock.turn).padStart(2,"0"),()=>e(o).field.duel.phase.toUpperCase()],ye),s(g,O)},p=g=>{var O=Te(),K=N(O);{var Me=ue=>{var J=Yr(),Z=a(J),z=a(Z),$e=r(Z,2),Pe=a($e);f((He,qe)=>{y(z,He),y(Pe,qe)},[()=>Math.floor(e(L).current),()=>Math.floor(e(A).current)],ye),s(ue,J)},De=ue=>{var J=Te(),Z=N(J);{var z=$e=>{var Pe=Te(),He=N(Pe);{var qe=Le=>{var Ke=Te(),je=N(Ke);{var ge=H=>{var fe=Te(),Ue=N(fe);le(Ue,1,()=>t().duel.nextPhaseList,de,(Ie,Ze)=>{var Oe=Ur(),Qe=a(Oe);Qe.__click=[Lr,he,Ze];var C=a(Qe);f(b=>y(C,b),[()=>e(Ze).toUpperCase()],ye),s(Ie,Oe)}),s(H,fe)};h(je,H=>{t().duel.isEnded||H(ge)})}s(Le,Ke)};h(He,Le=>{t().waitMode==="Free"&&Le(qe)})}s($e,Pe)};h(Z,$e=>{e(o).column===5&&$e(z)},!0)}s(ue,J)};h(K,ue=>{e(o).column===3?ue(Me):ue(De,!1)},!0)}s(g,O)};h($,g=>{e(o).column===1?g(w):g(p,!1)})}s(X,Ce)};h(m,X=>{e(o).row===3&&X(F)})}s(D,j)},ne=D=>{var j=Te(),m=N(j);{var F=Ce=>{var $=Hr();const w=ye(()=>e(re).find(J=>J.to===e(o)));var p=N($);{var g=J=>{var Z=Nr(),z=a(Z);Ft(z,{get entity(){return e(w).entity},state:"Disabled",dummyActionInfos:[],cardActionResolve:void 0}),f(()=>Ee(Z,`card_animation_receiver ${e(o).cellType??""} svelte-1boxe40`)),ae(1,Z,()=>me,()=>({key:e(w).entity.seq})),s(J,Z)};h(p,J=>{e(w)&&e(w).index==="Top"&&J(g)})}var O=r(p,2);le(O,1,()=>e(o).visibleEntities,de,(J,Z)=>{var z=Te(),$e=N(z);{var Pe=He=>{var qe=qr(),Le=a(qe);const Ke=ye(()=>Se(e(Z))),je=ye(()=>e(n).filter(ge=>ge.action.entity===e(Z)));Ft(Le,{get entity(){return e(Z)},get state(){return e(Ke)},get dummyActionInfos(){return e(je)},cardActionResolve:void 0,get selectedList(){return v()},set selectedList(ge){v(ge)},$$legacy:!0}),ae(2,qe,()=>we,()=>({key:e(Z).seq})),s(He,qe)};h($e,He=>{e(re).every(qe=>qe.entity.seq!==e(Z).seq)&&He(Pe)})}s(J,z)});var K=r(O,2);{var Me=J=>{var Z=Pr(),z=a(Z);Ft(z,{get entity(){return e(w).entity},state:"Disabled",dummyActionInfos:[],cardActionResolve:void 0}),f(()=>Ee(Z,`card_animation_receiver ${e(o).cellType??""} svelte-1boxe40`)),ae(1,Z,()=>me,()=>({key:e(w).entity.seq})),s(J,Z)};h(K,J=>{e(w)&&e(w).index!=="Top"&&J(Me)})}var De=r(K,2);{var ue=J=>{var Z=Fr();s(J,Z)};h(De,J=>{e(o).owner.seat==="Below"&&J(ue)})}s(Ce,$)},X=Ce=>{var $=Qr();const w=ye(()=>e(re).find(Z=>Z.to===e(o)));var p=N($);{var g=Z=>{var z=Or(),$e=a(z);Ft($e,{get entity(){return e(w).entity},state:"Disabled",dummyActionInfos:[],cardActionResolve:void 0}),ae(1,z,()=>me,()=>({key:e(w).entity.seq})),s(Z,z)};h(p,Z=>{e(w)&&e(w).index!=="Top"&&Z(g)})}var O=r(p,2);{var K=Z=>{var z=zr(),$e=N(z);le($e,1,()=>e(o).visibleEntities.map((qe,Le)=>({index:Le,entity:qe})).toReversed(),de,(qe,Le)=>{var Ke=Te(),je=N(Ke);{var ge=H=>{var fe=Wr();const Ue=ye(()=>!e(o).isStackCell&&e(Le).index===0?Se(...e(o).visibleEntities):void 0);var Ie=N(fe);{var Ze=b=>{var Q=Rr();s(b,Q)};h(Ie,b=>{e(V).includes(e(Le).entity)&&b(Ze)})}var Oe=r(Ie,2),Qe=a(Oe);const C=ye(()=>e(Le).index===0?e(n).filter(b=>e(o).visibleEntities.includes(b.action.entity)):void 0);Ft(Qe,{get entity(){return e(Le).entity},get state(){return e(Ue)},get dummyActionInfos(){return e(C)},cardActionResolve:void 0,get selectedList(){return v()},set selectedList(b){v(b)},$$legacy:!0}),f(()=>Ee(Oe,`duel_card_wrapper ${(e(Le).entity.exist?"duel_card_wrapper_exists":"")??""} svelte-1boxe40`)),ae(2,Oe,()=>we,()=>({key:e(Le).entity.seq})),s(H,fe)};h(je,H=>{e(re).every(fe=>fe.entity.seq!==e(Le).entity.seq)&&H(ge)})}s(qe,Ke)});var Pe=r($e,2);{var He=qe=>{var Le=Kr(),Ke=a(Le),je=r(Ke);le(je,1,()=>Ht(e(o).visibleEntities[0].status.maxCounterQty),de,(ge,H)=>{var fe=Ir(),Ue=N(fe),Ie=r(Ue);{var Ze=Oe=>{var Qe=it();f(()=>y(Qe,`/${e(o).visibleEntities[0].status.maxCounterQty[e(H)]??""}`)),s(Oe,Qe)};h(Ie,Oe=>{(e(o).visibleEntities[0].status.maxCounterQty[e(H)]??9999)<100&&Oe(Ze)})}f((Oe,Qe)=>y(Ue,`【
              ${Oe??""}${Qe??""} `),[()=>er(e(H)),()=>e(o).visibleEntities[0].counterHolder.getQty(e(H))],ye),s(ge,fe)}),f(()=>y(Ke,`【${e(o).visibleEntities[0].battlePositionName??""}】 `)),s(qe,Le)};h(Pe,qe=>{e(o).visibleEntities[0].battlePosition&&qe(He)})}s(Z,z)};h(O,Z=>{e(o).visibleEntities.length>0&&Z(K)})}var Me=r(O,2);{var De=Z=>{var z=Vr(),$e=a(z);f(()=>y($e,e(o).visibleEntities.length)),s(Z,z)};h(Me,Z=>{e(o).isStackCell&&Z(De)})}var ue=r(Me,2);{var J=Z=>{var z=Gr(),$e=a(z);Ft($e,{get entity(){return e(w).entity},state:"Disabled",dummyActionInfos:[],cardActionResolve:void 0}),ae(1,z,()=>me,()=>({key:e(w).entity.seq})),s(Z,z)};h(ue,Z=>{e(w)&&e(w).index==="Top"&&Z(J)})}s(Ce,$)};h(m,Ce=>{e(o).cellType==="Hand"?Ce(F):Ce(X,!1)},!0)}s(D,j)};h(G,D=>{e(o).isDisabledCell?D(se):D(ne,!1)})}f(D=>{Ee(R,`${`duel_field_cell duel_field_cell_${e(o).cellType} ${e(o).linkArrowSources.length===0?"":"duel_field_cell_linked"}`??""} svelte-1boxe40`),xt(R,"colspan",e(o).cellType==="Hand"?7:1),Ee(T,`${D??""} svelte-1boxe40`)},[()=>`duel_field_cell_inner_box ${e(o).cellType} ${e(B)?"can_accept_drop":""} ${Y()?"can_action":""} ${e(E)?"is_selected":e(U)?"is_selectable":""} `],ye),ve("dragover",T,oe),ve("drop",T,ke),s(d,R),bt()}Ra(["click"]);const Zr=(d,i,t=void 0,c="!!!circular reference!!!")=>{let _=[];return JSON.stringify(d,(v,u)=>{if(typeof u=="object"){if(_.indexOf(u)>-1)return c;_.push(u)}let o=u;if(i&&(o=i(v,u)),typeof o=="function")return o.toString();if(o!==u&&typeof o=="object"){if(_.indexOf(o)>-1)return c;_.push(o)}return o},t)};var es=l('<div class="title svelte-14z6bdh"> </div>'),ts=l('<div class="title svelte-14z6bdh"> </div>'),as=l('<div class="duel_log_chain_number svelte-14z6bdh"> </div>'),rs=l('<div><a class="white_button" download="error_info.json">エラー情報ダウンロード</a></div>'),ss=l("<div><!> <!></div>"),is=l('<div><div style="display: flex;    justify-content: space-between;"><div style=" white-space: nowrap;text-align: center;"> </div> <!></div> <!></div>'),ns=l("<div><!> <!></div>"),ls=l("<div><!> <!></div>"),os=l('<div class="duel_log svelte-14z6bdh"><div class="duel_log_header svelte-14z6bdh"></div> <div class="duel_log_body svelte-14z6bdh"></div> <div class="duel_log_footer svelte-14z6bdh"></div></div>');function vs(d,i){mt(i,!1);let t=_e(void 0),c=We(i,"log",8),_,v=_e([]);const u=()=>{const S=((_==null?void 0:_.seq)??-1)+1;c().records.slice(S).forEach(M=>{if(!_){x(v,[[[[M]]]]),_=M;return}if(!e(v)[M.clock.turn]){be(v,e(v)[M.clock.turn]=[[[M]]]),_=M;return}if(!e(v)[M.clock.turn][M.clock.phaseSeq]){be(v,e(v)[M.clock.turn][M.clock.phaseSeq]=[[M]]),_=M;return}if(_.clock.chainSeq===M.clock.chainSeq&&_.clock.chainBlockSeq===M.clock.chainBlockSeq&&_.duelist===M.duelist){e(v)[M.clock.turn][M.clock.phaseSeq].slice(-1)[0].push(M),_=M;return}e(v)[M.clock.turn][M.clock.phaseSeq].push([M]),_=M}),x(v,e(v)),tr().then(()=>e(t)&&e(t).scroll(0,e(t).clientHeight*990))};c().onUpdate.append(u),c().duel.view.onDuelUpdate.append(u),u(),ht();var o=Te(),L=N(o);{var A=S=>{var M=os(),n=r(a(M),2);le(n,5,()=>e(v),de,(P,W)=>{var V=ls(),E=a(V);{var U=xe=>{var k=es(),B=a(k);f(()=>y(B,`ターン：${e(W)[0][0][0].clock.turn??""}`)),s(xe,k)};h(E,xe=>{e(W)[0][0][0].clock.turn>0&&xe(U)})}var ce=r(E,2);le(ce,1,()=>e(W),de,(xe,k)=>{var B=ns(),I=a(B);{var te=we=>{var me=ts(),re=a(me);f(()=>y(re,e(k)[0][0].clock.period.name)),s(we,me)};h(I,we=>{e(k)[0][0].clock.turn>0&&we(te)})}var ee=r(I,2);le(ee,1,()=>e(k),de,(we,me)=>{var re=is();const Ye=ye(()=>{var R;return((R=e(me).find(T=>T.chainNumber!==void 0))==null?void 0:R.chainNumber)??0});var he=a(re),Y=a(he),q=a(Y),oe=r(Y,2);{var ke=R=>{var T=as(),G=a(T);f(()=>y(G,`チェーン：${e(Ye)??""}`)),s(R,T)};h(oe,R=>{e(Ye)&&R(ke)})}var Se=r(he,2);le(Se,1,()=>e(me),de,(R,T)=>{var G=ss(),se=a(G);{var ne=F=>{var X=it();f(()=>y(X,e(T).text)),s(F,X)},D=F=>{var X=Te(),Ce=N(X);{var $=p=>{var g=it();f((O,K,Me)=>y(g,`移動：${O??""} ${K??""} ⇒ ${Me??""}`),[()=>{var O;return(O=e(T).mainEntity)==null?void 0:O.toString()},()=>{var O;return(O=e(T).from)==null?void 0:O.toString()},()=>{var O;return(O=e(T).to)==null?void 0:O.toString()}],ye),s(p,g)},w=p=>{var g=Te(),O=N(g);{var K=De=>{var ue=it();f((J,Z)=>y(ue,`生成：${J??""} void ⇒ ${Z??""}`),[()=>{var J;return(J=e(T).mainEntity)==null?void 0:J.toString()},()=>{var J;return(J=e(T).to)==null?void 0:J.toString()}],ye),s(De,ue)},Me=De=>{var ue=Te(),J=N(ue);{var Z=$e=>{var Pe=it();f((He,qe)=>y(Pe,`消滅：${He??""} ${qe??""} ⇒ void`),[()=>{var He;return(He=e(T).mainEntity)==null?void 0:He.toString()},()=>{var He;return(He=e(T).from)==null?void 0:He.toString()}],ye),s($e,Pe)},z=$e=>{var Pe=it();f(()=>y(Pe,e(T).text)),s($e,Pe)};h(J,$e=>{e(T).type==="EntityDisappear"?$e(Z):$e(z,!1)},!0)}s(De,ue)};h(O,De=>{e(T).type==="EntityAppear"?De(K):De(Me,!1)},!0)}s(p,g)};h(Ce,p=>{e(T).type==="EntityMove"?p($):p(w,!1)},!0)}s(F,X)};h(se,F=>{e(T).type==="ChainBlockHeader"?F(ne):F(D,!1)})}var j=r(se,2);{var m=F=>{var X=rs(),Ce=a(X);f($=>xt(Ce,"href",$),[()=>window.URL.createObjectURL(new Blob([Zr(e(T).error,($,w)=>["pool","bundles","duel"].includes($)||typeof w=="function"?void 0:w,4)],{type:"text/plain"}))],ye),s(F,X)};h(j,F=>{e(T).error&&F(m)})}f(F=>Ee(G,`duel_log_record duel_log_record_${F??""} svelte-14z6bdh`),[()=>e(T).type.toSnakeCase()],ye),s(R,G)}),f(()=>{var R,T,G;Ee(re,`duel_log_block_duelist duel_log_block_duelist_${((R=e(me)[0].duelist)==null?void 0:R.seat)??"system"} svelte-14z6bdh`),Ee(Y,`duelist ${((T=e(me)[0].duelist)==null?void 0:T.seat)??""} svelte-14z6bdh`),y(q,((G=e(me)[0].duelist)==null?void 0:G.profile.name)||"SYSTEM")}),s(we,re)}),f(()=>Ee(B,`duel_log_block_phase duel_log_block_phase_${e(k)[0][0].clock.period.key??""} svelte-14z6bdh`)),s(xe,B)}),f(()=>Ee(V,`duel_log_block_turn duel_log_block_turn_${e(W)[0][0][0].clock.turn??""} svelte-14z6bdh`)),s(P,V)}),ar(n,P=>x(t,P),()=>e(t)),s(S,M)};h(L,S=>{(c().duel.view.infoBoardState==="Log"||c().duel.view.infoBoardState==="Default")&&S(A)})}s(d,o),bt()}var ds=l("<div><div> </div> <div> </div></div>");function Ha(d,i){mt(i,!1);let t=We(i,"duelist",12),c=_e(0),_=_e();const v=async()=>{const n=t().lp-e(c);if(!e(_)||Math.abs(n)<10){x(c,t().lp),e(_)&&(e(_)(),x(_,void 0));return}x(c,e(c)+Math.floor(Math.random()*n)),await Nt(100),v()},u=()=>{t(t()),!e(_)&&t().lp!==e(c)&&new Promise(n=>{x(_,n),Math.abs(t().lp-e(c)),v()})};t().duel.log.onUpdate.append(u),v(),ht();var o=ds(),L=a(o),A=a(L),S=r(L,2),M=a(S);f(n=>{Ee(o,`duelist duelist_${n??""} svelte-1sy3trd`),Ee(L,`duelist_name duelist_${n??""}_name svelte-1sy3trd`),y(A,t().profile.name),Ee(S,`duelist_lp ${(e(_)?"vibration":"")??""} svelte-1sy3trd`),y(M,e(c))},[()=>t().seat.toLowerCase()],ye),s(d,o),bt()}const cs=(d,i,t)=>(i(i()!=="Detail"?"Detail":"Normal"),console.info(t()),!0),_s=(d,i,t)=>(i(i()!=="Debug"?"Debug":"Normal"),console.info(t()),!0);var us=l('<div class="duel_card_info_row svelte-1uevs9j" style=" justify-content: space-between;"><div class="svelte-1uevs9j"> </div> <div class="svelte-1uevs9j"> </div></div>'),fs=l('<div></div> <div class="svelte-1uevs9j"> </div>',1),ps=l("<div> </div>"),ys=l('<span class="svelte-1uevs9j">/</span> <div class="monster_defense svelte-1uevs9j"> </div>',1),gs=l("<div> </div>"),ms=l('<div class="duel_card_info_row svelte-1uevs9j"><!> <!> <div style="flex-grow: 1;" class="svelte-1uevs9j"></div> <div class="monster_attack svelte-1uevs9j"> </div> <!></div> <div class="duel_card_info_row svelte-1uevs9j"></div>',1),hs=l('<div class="duel_card_row svelte-1uevs9j"><div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"> </div></div>'),bs=l('<div class="duel_card_row svelte-1uevs9j"><div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"> </div></div>'),ks=l("<!> <!>",1),xs=l('<pre class="description svelte-1uevs9j"> </pre>'),ws=l('<div class="duel_card_info_row svelte-1uevs9j" style="border-style: solid; border-width: 1px;"><!></div>'),Cs=l('<pre class="description svelte-1uevs9j"> </pre>'),Ds=l('<!> <div class="duel_card_info_row svelte-1uevs9j"><!></div>',1),$s=l('<div class="effect_counter_area_item svelte-1uevs9j"><span class="svelte-1uevs9j"> </span> <span class="svelte-1uevs9j"> </span> <span class="svelte-1uevs9j">/</span> <span class="svelte-1uevs9j"> </span></div>'),Ss=l('<div class="duel_card_info_row effect_counter_area svelte-1uevs9j"><div class="effect_counter_area_title svelte-1uevs9j">効果使用状況</div> <div class="effect_counter_area_body svelte-1uevs9j"></div></div>'),Ms=l("[ <!> ],",1),Ts=l('<div class="svelte-1uevs9j"> <!></div>'),js=l('<div class="svelte-1uevs9j"> </div> <!> <div class="svelte-1uevs9j"></div>',1),Bs=l('<div class="svelte-1uevs9j"> </div>'),Es=l('<div class="svelte-1uevs9j"> </div>'),As=l('<div class="svelte-1uevs9j"> </div>'),Ys=l('<div class="svelte-1uevs9j"> </div>'),Ls=l('<div class="svelte-1uevs9j"> </div>'),Us=l('<div class="svelte-1uevs9j"> </div>'),Ns=l('<div class="duel_card_info_row svelte-1uevs9j"><div class="svelte-1uevs9j"><!> <div class="svelte-1uevs9j"></div> <!> <div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"></div> <!> <div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"></div> <!> <div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"></div> <!> <div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"></div> <!> <div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"></div> <!> <div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"></div> <div class="svelte-1uevs9j"> </div> <div class="svelte-1uevs9j"> </div> <div class="svelte-1uevs9j"> </div> <div class="svelte-1uevs9j"></div></div></div>'),qs=l('<div class="svelte-1uevs9j">※エラッタ前のカードです</div>'),Ps=l('<div class="svelte-1uevs9j">※テスト用カードです</div>'),Fs=l('<a target="_blank" rel="noopener noreferrer" title="コナミカードデータベース" class="svelte-1uevs9j"> </a>'),Hs=l('<div class="duel_card_info_links svelte-1uevs9j"><a target="_blank" rel="noopener noreferrer" title="遊戯王カードWiki" class="svelte-1uevs9j">⇒遊戯王カードWiki</a> <!></div>'),Os=l("<!> <!>",1),Rs=l('<div role="contentinfo"><div class="duel_card_info_header svelte-1uevs9j"><div class="duel_card_info_row svelte-1uevs9j"><div class="svelte-1uevs9j"> </div></div> <div class="duel_card_info_row svelte-1uevs9j" style="position:sticky; top:0;"><div class="svelte-1uevs9j"> </div> <div class="svelte-1uevs9j"> </div></div> <!></div> <div class="duel_card_info_body svelte-1uevs9j"><!></div> <div class="duel_card_info_footer svelte-1uevs9j"><!></div></div>');function Ws(d,i){mt(i,!1);let t=We(i,"entity",8,void 0),c=We(i,"mode",12,"Normal");const _=async()=>{if(!t())return;const S=(await Xt).getCardInfo(t().origin.name);if(S)return S.cardId!==void 0&&!S.description&&!S.pendulumDescription&&await Wa([S.cardId]),S},v=()=>t()&&t().entityType==="Card"&&(t().origin.cardId??!1)?`https://www.db.yugioh-card.com/yugiohdb/card_search.action?ope=2&cid=${t().origin.cardId}`:t()?`https://www.db.yugioh-card.com/yugiohdb/card_search.action?ope=1&sess=1&rp=10&mode=&sort=1&keyword=${t().origin.name}&stype=1&ctype=&othercon=2&starfr=&starto=&pscalefr=&pscaleto=&linkmarkerfr=&linkmarkerto=&link_m=2&atkfr=&atkto=&deffr=&defto=&releaseDStart=1&releaseMStart=1&releaseYStart=1999&releaseDEnd=&releaseMEnd=&releaseYEnd=`:"";ht();var u=Te(),o=N(u);{var L=A=>{var S=Rs();S.__click=[cs,c,t],S.__contextmenu=[_s,c,t];var M=a(S),n=a(M),P=a(n),W=a(P),V=r(n,2),E=a(V),U=a(E),ce=r(E,2),xe=a(ce),k=r(V,2);{var B=he=>{var Y=ks(),q=N(Y);{var oe=T=>{var G=us(),se=a(G),ne=a(se),D=r(se,2),j=a(D);f(()=>{y(ne,`◀ ${t().psL??""}`),y(j,`${t().psR??""} ▶`)}),s(T,G)};h(q,T=>{var G;(G=t().origin.monsterCategories)!=null&&G.includes("Pendulum")&&T(oe)})}var ke=r(q,2);{var Se=T=>{var G=ms(),se=N(G),ne=a(se);le(ne,1,()=>t().attr,de,($,w)=>{var p=fs(),g=N(p),O=r(g,2),K=a(O);f(()=>{Ee(g,`monster_attr ${e(w)??""} svelte-1uevs9j`),y(K,`${ma[e(w)]??""}属性`)}),s($,p)});var D=r(ne,2);le(D,1,()=>t().types,de,($,w)=>{var p=ps(),g=a(p);f(()=>{Ee(p,`monster_cat ${e(w)??""} svelte-1uevs9j`),y(g,`${la[e(w)]??""}${ha[e(w)]??""}族`)}),s($,p)});var j=r(D,4),m=a(j),F=r(j,2);{var X=$=>{var w=ys(),p=r(N(w),2),g=a(p);f(()=>y(g,t().def??"?")),s($,w)};h(F,$=>{var w;(w=t().status.monsterCategories)!=null&&w.includes("Link")||$(X)})}var Ce=r(se,2);le(Ce,5,()=>t().status.monsterCategories??[],de,($,w)=>{var p=gs(),g=a(p);f(()=>{Ee(p,`monster_cat ${e(w)??""} svelte-1uevs9j`),y(g,`${Jt[e(w)]??""}${ra[e(w)]??""}`)}),s($,p)}),f(()=>y(m,t().atk??"?")),s(T,G)},R=T=>{var G=Te(),se=N(G);{var ne=j=>{var m=hs(),F=r(a(m),2),X=a(F);f(()=>y(X,`${oa[t().status.spellCategory]??""}魔法`)),s(j,m)},D=j=>{var m=Te(),F=N(m);{var X=Ce=>{var $=bs(),w=r(a($),2),p=a(w);f(()=>y(p,`${va[t().status.trapCategory]??""}罠`)),s(Ce,$)};h(F,Ce=>{t().kind==="Trap"&&t().status.trapCategory&&Ce(X)},!0)}s(j,m)};h(se,j=>{t().kind==="Spell"&&t().status.spellCategory?j(ne):j(D,!1)},!0)}s(T,G)};h(ke,T=>{t().kind==="Monster"?T(Se):T(R,!1)})}s(he,Y)};h(k,he=>{c()!=="Debug"&&he(B)})}var I=r(M,2),te=a(I);{var ee=he=>{var Y=Ds(),q=N(Y);{var oe=R=>{var T=ws(),G=a(T);kt(G,_,se=>{var ne=it('"読み込み中"');s(se,ne)},(se,ne)=>{var D=xs(),j=a(D);f(()=>{var m;return y(j,(m=e(ne))==null?void 0:m.pendulumDescription)}),s(se,D)}),s(R,T)};h(q,R=>{var T;(T=t().status.monsterCategories)!=null&&T.includes("Pendulum")&&R(oe)})}var ke=r(q,2),Se=a(ke);kt(Se,_,R=>{var T=it('"読み込み中"');s(R,T)},(R,T)=>{var G=Cs(),se=a(G);f(()=>{var ne;return y(se,(ne=e(T))==null?void 0:ne.description)}),s(R,G)}),s(he,Y)},we=he=>{var Y=Te(),q=N(Y);{var oe=Se=>{var R=Te(),T=N(R);{var G=se=>{var ne=Ss(),D=r(a(ne),2);le(D,5,()=>t().actions,de,(j,m)=>{var F=Te();const X=ye(()=>e(m).actionCountUpperBound),Ce=ye(()=>e(m).actionCount);var $=N(F);{var w=p=>{var g=$s(),O=a(g),K=a(O),Me=r(O,2),De=a(Me),ue=r(Me,4),J=a(ue);f(()=>{y(K,e(m).title),y(De,e(Ce)),y(J,e(X))}),s(p,g)};h($,p=>{e(X)!==void 0&&e(Ce)!==void 0&&p(w)})}s(j,F)}),s(se,ne)};h(T,se=>{t().actions.some(ne=>ne.actionCountUpperBoundKey)&&se(G)})}s(Se,R)},ke=Se=>{var R=Ns(),T=a(R),G=a(T);le(G,0,()=>["info","status"],de,(je,ge)=>{var H=js(),fe=N(H),Ue=a(fe),Ie=r(fe,2);le(Ie,1,()=>Object.entries(t()[ge]),de,(Oe,Qe)=>{let C=()=>e(Qe)[0],b=()=>e(Qe)[1];var Q=Ts(),ie=a(Q),Be=r(ie);{var Je=ze=>{var Re=Ms(),Ve=r(N(Re));le(Ve,1,b,de,(dt,ft)=>{var Et=it();f(At=>y(Et,`${At??""},`),[()=>e(ft).toString()],ye),s(dt,Et)}),s(ze,Re)},Ne=ze=>{var Re=it();f(Ve=>y(Re,`${Ve??""},`),[()=>{var Ve;return(Ve=b())==null?void 0:Ve.toString()}],ye),s(ze,Re)};h(Be,ze=>{Array.isArray(b())?ze(Je):ze(Ne,!1)})}f(()=>y(ie,`"${C()??""}" : `)),s(Oe,Q)});var Ze=r(Ie,2);Ze.textContent="},",f(()=>y(Ue,`"${ge??""}" :{`)),s(je,H)});var se=r(G,2);se.textContent='"actions" :[';var ne=r(se,2);le(ne,1,()=>t().actions,de,(je,ge)=>{var H=Bs(),fe=a(H);f(()=>y(fe,`"${e(ge).playType??""} ${e(ge).title??""}",`)),s(je,H)});var D=r(ne,2);D.textContent="],";var j=r(D,2);j.textContent='"substituteEffects" :[';var m=r(j,2);le(m,1,()=>t().substituteEffects,de,(je,ge)=>{var H=Es(),fe=a(H);f(()=>y(fe,`"${e(ge).title??""}",`)),s(je,H)});var F=r(m,2);F.textContent="],";var X=r(F,2);X.textContent='"continuousEffects" :[';var Ce=r(X,2);le(Ce,1,()=>t().continuousEffects,de,(je,ge)=>{var H=As(),fe=a(H);f(()=>y(fe,`"${e(ge).isStarted??""}",`)),s(je,H)});var $=r(Ce,2);$.textContent="],";var w=r($,2);w.textContent='"procFilters" :[';var p=r(w,2);le(p,1,()=>t().procFilterBundle.operators,de,(je,ge)=>{var H=Ys(),fe=a(H);f(Ue=>y(fe,`"${Ue??""} ${e(ge).title??""} ${e(ge).isEffective??""} ",`),[()=>e(ge).isSpawnedBy.toString()],ye),s(je,H)});var g=r(p,2);g.textContent="],";var O=r(g,2);O.textContent='"numericStateOperators" :[';var K=r(O,2);le(K,1,()=>t().numericOprsBundle.operators,de,(je,ge)=>{var H=Ls(),fe=a(H);f(Ue=>y(fe,`"${Ue??""} ${e(ge).title??""} ${e(ge).isEffective??""} ${e(ge).isContinuous??""} ${e(ge).targetState??""} ${e(ge).targetStateGen??""} ",`),[()=>e(ge).isSpawnedBy.toString()],ye),s(je,H)});var Me=r(K,2);Me.textContent="],";var De=r(Me,2);De.textContent='"stateOperators" :[';var ue=r(De,2);le(ue,1,()=>t().statusOperatorBundle.operators,de,(je,ge)=>{var H=Us(),fe=a(H);f(Ue=>y(fe,`"${Ue??""} ${e(ge).title??""} ${e(ge).isEffective??""} ",`),[()=>e(ge).isSpawnedBy.toString()],ye),s(je,H)});var J=r(ue,2);J.textContent="],";var Z=r(J,2);Z.textContent='"lastMoveLogRecord" :{';var z=r(Z,2),$e=a(z),Pe=r(z,2),He=a(Pe),qe=r(Pe,2),Le=a(qe),Ke=r(qe,2);Ke.textContent="},",f((je,ge)=>{y($e,`"movedBy":"${je??""}",`),y(He,`"movedAs":"${ge??""}",`),y(Le,`"movedAt":"${t().moveLog.latestRecord.movedAt.totalProcSeq??""}",`)},[()=>{var je;return(je=t().moveLog.latestRecord.movedBy)==null?void 0:je.toString()},()=>t().moveLog.latestRecord.movedAs.join(" ")],ye),s(Se,R)};h(q,Se=>{c()==="Detail"?Se(oe):Se(ke,!1)},!0)}s(he,Y)};h(te,he=>{c()==="Normal"?he(ee):he(we,!1)})}var me=r(I,2),re=a(me);{var Ye=he=>{var Y=Os(),q=N(Y);{var oe=T=>{var G=qs();s(T,G)};h(q,T=>{t().origin.isOldVersion&&T(oe)})}var ke=r(q,2);{var Se=T=>{var G=Ps();s(T,G)},R=T=>{var G=Hs(),se=a(G),ne=r(se,2);{var D=j=>{var m=Fs(),F=a(m);f(X=>{var Ce;xt(m,"href",X),y(F,`⇒${((Ce=t())!=null&&Ce.origin.cardId?"公式カードページ":"公式で検索")??""}`)},[v],ye),s(j,m)};h(ne,j=>{t()&&t().entityType==="Card"&&j(D)})}f(()=>xt(se,"href",`https://yugioh-wiki.net/index.php?${t().origin.wikiEncodedName}`)),s(T,G)};h(ke,T=>{t().origin.isForTest?T(Se):T(R,!1)})}s(he,Y)};h(re,he=>{t()&&he(Ye)})}f((he,Y,q)=>{Ee(S,`duel_card duel_card_info ${t().origin.kind??""} ${he??""} svelte-1uevs9j`),y(W,t().nm),y(U,Y),y(xe,q)},[()=>{var he;return(he=t().origin.monsterCategories)==null?void 0:he.join(" ")},()=>"★".repeat(t().lvl||0),()=>"☆".repeat(t().rank||0)],ye),s(A,S)};h(o,A=>{t()&&A(L)})}s(d,u),bt()}Ra(["click","contextmenu"]);var Is=l('<div class="duel_field_cell_info_item svelte-1xj7qf1"><!></div>'),Ks=l('<div class="duel_field_cell_info_box svelte-1xj7qf1"><div class="duel_field_cell_info_label svelte-1xj7qf1"> </div> <!></div>'),zs=l('<div class="duel_field_cell_info svelte-1xj7qf1"><div class="duel_field_cell_info_header item_btn svelte-1xj7qf1"><div class="svelte-1xj7qf1"> </div> <div class="svelte-1xj7qf1"> </div></div> <div class="duel_field_cell_info_body svelte-1xj7qf1"></div></div>');function Vs(d,i){mt(i,!1);let t=We(i,"cell",12);const c=()=>{t(t())},_=L=>t().cardEntities.filter(A=>A.face===L);t().field.duel.view.onDuelUpdate.append(c),ht();var v=Te(),u=N(v);{var o=L=>{var A=zs(),S=a(A),M=a(S),n=a(M),P=r(M,2),W=a(P),V=r(S,2);le(V,4,()=>["FaceUp","FaceDown"],de,(E,U)=>{var ce=Te(),xe=N(ce);{var k=B=>{var I=Ks(),te=a(I),ee=a(te),we=r(te,2);le(we,1,()=>_(U).toSorted(rr),de,(me,re)=>{var Ye=Is(),he=a(Ye);const Y=ye(()=>t().owner===t().field.duel.duelists.Below);Ft(he,{get entity(){return e(re)},get isVisibleForcibly(){return e(Y)},isWideMode:!0,cardActionResolve:void 0}),s(me,Ye)}),f(()=>y(ee,U==="FaceUp"?"表向き":"裏向き")),s(B,I)};h(xe,B=>{_(U).length&&B(k)})}s(E,ce)}),f(()=>{var E;y(n,(E=t().owner)==null?void 0:E.profile.name),y(W,t().cellType)}),s(L,A)};h(u,L=>{t().field.duel.view.infoBoardState==="CellInfo"&&L(o)})}s(d,v),bt()}var Gs=l('<div class="duel_config_item svelte-y4u26k"><label class="toggle svelte-y4u26k"><input type="checkbox" class="svelte-y4u26k"></label> <span class="svelte-y4u26k"> </span></div>'),Qs=l('<div class="duel_config svelte-y4u26k"><div class="duel_config_title svelte-y4u26k">デュエル設定</div> <div class="duel_config_group svelte-y4u26k"><div class="duel_config_group_title svelte-y4u26k">チェーン設定</div> <!></div></div>');function Xs(d,i){mt(i,!1);let t=We(i,"viewController",8),c=We(i,"userProfile",12);ht();var _=Te(),v=N(_);{var u=o=>{var L=Qs(),A=r(a(L),2),S=r(a(A),2);le(S,1,()=>nr,de,(M,n)=>{var P=Gs(),W=a(P),V=a(W),E=r(W,2),U=a(E);f(()=>y(U,sr[e(n)])),ir(V,()=>c().chainConfig[e(n)],ce=>c(c().chainConfig[e(n)]=ce,!0)),ve("change",V,()=>c().save()),s(M,P)}),s(o,L)};h(v,o=>{t().infoBoardState==="Config"&&o(u)})}s(d,_),bt()}function Js(d,{from:i,to:t},c={}){var{delay:_=0,duration:v=I=>Math.sqrt(I)*120,easing:u=pa}=c,o=getComputedStyle(d),L=o.transform==="none"?"":o.transform,[A,S]=o.transformOrigin.split(" ").map(parseFloat);A/=d.clientWidth,S/=d.clientHeight;var M=Zs(d),n=d.clientWidth/t.width/M,P=d.clientHeight/t.height/M,W=i.left+i.width*A,V=i.top+i.height*S,E=t.left+t.width*A,U=t.top+t.height*S,ce=(W-E)*n,xe=(V-U)*P,k=i.width/t.width,B=i.height/t.height;return{delay:_,duration:typeof v=="function"?v(Math.sqrt(ce*ce+xe*xe)):v,easing:u,css:(I,te)=>{var ee=te*ce,we=te*xe,me=I+te*k,re=I+te*B;return`transform: ${L} translate(${ee}px, ${we}px) scale(${me}, ${re});`}}}function Zs(d){if("currentCSSZoom"in d)return d.currentCSSZoom;for(var i=d,t=1;i!==null;)t*=+getComputedStyle(i).zoom,i=i.parentElement;return t}var ei=l('<div class="chain_number svelte-lqu21u"> </div>'),ti=l('<div class="duel_card_row svelte-lqu21u"> </div>'),ai=l('<div class="appendix svelte-lqu21u"> </div>'),ri=l('<div class="appendix_wrapper svelte-lqu21u"></div>'),si=l('<div><div><!> <div> </div> <div><!> <div class="duel_card_row svelte-lqu21u"><div> </div> <!></div></div></div></div>'),ii=l("<div></div>");function ni(d,i){mt(i,!1);let t=We(i,"duel",8),c=We(i,"position",8,"left");const _=-100,v=()=>c()==="left"?-100:100;let u=_e([]),o=Promise.resolve(),L=Promise.resolve();const A=1e3,S=500,M=400,n=W=>{const V={...W};V.isKnown=W.chainBlockInfo.action.entity.controller.duelistType==="Player"||W.chainBlockInfo.action.entity.face==="FaceUp",V.chainBlockInfo.onStateChange.append(E=>{if(E==="done"||E==="failed"||E==="negated")return o=o.then(async()=>{const U=new Date().getTime()-V.chainBlockInfo.wasSpawnedAt.getTime();U<A&&await Nt(A-U),x(u,e(u).filter(ce=>ce.seq!==V.seq)),await Nt(S+M)}).then(),"RemoveMe";x(u,e(u))}),L=L.then(async()=>{x(u,[V,...e(u)].sort((E,U)=>lr.isSameChain(E.clock,U.clock)&&E.chainBlockInfo.action.isWithChainBlock&&U.chainBlockInfo.action.isWithChainBlock?U.clock.totalProcSeq-E.clock.totalProcSeq:E.clock.totalProcSeq-U.clock.totalProcSeq)),await Nt(300)}),o=o.then(()=>Nt(1e3))};t().chainBlockLog.onInsert.append(n),ht();var P=ii();le(P,13,()=>e(u),W=>W.seq,(W,V)=>{var E=si();const U=ye(()=>{const{activator:q,action:oe,appendix:ke}=e(V).chainBlockInfo;return{activator:q,action:oe,appendix:ke}});var ce=a(E),xe=a(ce);{var k=q=>{var oe=ei(),ke=a(oe);f(()=>y(ke,`チェーン：${e(V).chainBlockInfo.chainNumber??""}`)),s(q,oe)};h(xe,q=>{e(V).chainBlockInfo.chainNumber&&q(k)})}var B=r(xe,2),I=a(B),te=r(B,2),ee=a(te);{var we=q=>{var oe=ti(),ke=a(oe);f(()=>y(ke,e(V).isKnown?e(U).action.entity.nm:"？？？")),s(q,oe)};h(ee,q=>{(e(U).action.entity.entityType==="Card"||e(U).action.entity.entityType==="Token")&&q(we)})}var me=r(ee,2),re=a(me),Ye=a(re),he=r(re,2);{var Y=q=>{var oe=ri();le(oe,5,()=>e(U).appendix,de,(ke,Se)=>{var R=ai(),T=a(R);f(()=>y(T,e(Se))),s(ke,R)}),s(q,oe)};h(he,q=>{e(U).appendix&&q(Y)})}f((q,oe,ke)=>{Ee(E,`cut_in_row ${(!e(V).chainBlockInfo.chainNumber||e(V).chainBlockInfo.chainNumber===1?"cut_in_row_first":"")??""} svelte-lqu21u`),Ee(ce,`cut_in_item cut_in_item_${q??""} cut_in_item_${e(V).chainBlockInfo.state??""} svelte-lqu21u`),Ee(B,`duelist_name duelist_${q??""}_name svelte-lqu21u`),y(I,e(U).activator.profile.name),Ee(te,`duel_card duel_card_${q??""} ${oe??""} ${(e(V).isKnown?e(U).action.entity.origin.kind:"")??""} ${e(U).action.entity.entityType??""}  svelte-lqu21u`),y(Ye,ke)},[()=>e(U).activator.seat.toLowerCase(),()=>e(V).isKnown?(e(U).action.entity.status.monsterCategories??[]).join(" "):"Token",()=>e(U).action.toString()],ye),ae(3,ce,()=>jr,()=>new Date().getTime()-e(V).chainBlockInfo.wasSpawnedAt.getTime()<A?{x:v(),duration:M}:{y:_,duration:M}),or(E,()=>Js,()=>({duration:S})),s(W,E)}),f(()=>Ee(P,`cut_in_container cut_in_container_${c()??""} svelte-lqu21u`)),s(d,P),bt()}const li=Br({duration:400});var oi=l('<div class="duel_desk_left v_flex svelte-1w535im"><!> <!> <!></div>'),vi=l('<button class="duel_field_header_message svelte-1w535im"> </button> <div class="duel_field_header_buttons svelte-1w535im"><button class="svelte-1w535im">サレンダー</button></div>',1),di=l("<tr></tr>"),ci=l('<table class="duel_field svelte-1w535im"><tbody class="svelte-1w535im"></tbody></table>'),_i=l('<button class="svelte-1w535im">OK</button>'),ui=l('<button class="svelte-1w535im">cancel</button>'),fi=l("<!> <!>",1),pi=l('<button class="svelte-1w535im"> </button>'),yi=l('<div style="text-align: left;"><!> <!> <!></div>'),gi=l('<div><!> <div class=" duel_desk_center v_flex svelte-1w535im"><div class="duel_field_header svelte-1w535im"><!></div> <div class="duel_field_body svelte-1w535im"><!></div> <div class="duel_field_footer svelte-1w535im"><!></div></div> <!></div> <div style="position:fixed;bottom:0"> </div> <!> <div><!></div>',1);function mi(d,i){mt(i,!1);let t=We(i,"duel",12),c=We(i,"userProfile",8),_=_e(0),v=_e(0),u=_e([]),o=_e([]),L=()=>{},A=_e([]),S=_e(),M=_e(),n=_e(()=>!1),P=_e(!1);const W=p=>{L=p.resolve,x(A,p.dummyActionInfos.filter(g=>g.action.entity.entityType==="Duelist").filter(g=>g.action.entity.controller.seat==="Below")),x(S,void 0),x(M,void 0),x(o,[]),x(u,[]),x(P,!1),p.entitiesChoices&&(x(S,p.entitiesChoices),x(n,()=>{var g;return((g=p.entitiesChoices)==null?void 0:g.validator(e(u)))??!1}),x(P,p.entitiesChoices.cancelable),e(S).selectables.every(g=>g.cell.isPlayFieldCell&&g.getIndexInCell()===0||g.cell.cellType==="Hand"&&g.controller.duelistType==="Player"||g.entityType==="Duelist")||t().view.modalController.entitySelector.show({title:t().view.message,position:"Middle",entitiesChoices:p.entitiesChoices,chainBlockInfos:p.chainBlockInfos,cancelable:p.entitiesChoices.cancelable}).then(g=>{L({selectedEntities:g})})),p.cellsChoices&&(x(M,p.cellsChoices),x(n,()=>{var g;return((g=p.cellsChoices)==null?void 0:g.validator(e(o)))??!1}),x(P,p.cellsChoices.cancelable))};t().view.onWaitStart.append(W);const V=()=>{L=()=>{},x(M,void 0),x(S,void 0),x(o,[]),x(u,[]),x(n,()=>!1),x(P,!1)};t().view.onWaitEnd.append(V);let E=_e(void 0),U=_e("Normal");const ce=({card:p,mode:g})=>{x(E,p),x(U,g??(e(E)===p||e(U)==="Normal"?"Detail":"Normal"))};t().view.onShowCardEntity.append(ce);const xe=()=>{t(t())};t().view.onDuelUpdate.append(xe),t().log.onUpdate.append(xe);const k=()=>{e(S)&&e(S).validator(e(u))&&L({selectedEntities:e(u)}),e(M)&&e(M).validator(e(o))&&L({selectedCells:e(o)})},B=()=>{L({})},I=p=>{L({actionInfo:p})},te=()=>{L({surrender:!0})};t().main();const ee=()=>e(_)<=1400?"compact":"wide";ht();var we=gi(),me=N(we),re=a(me);{var Ye=p=>{var g=oi(),O=a(g);Ha(O,{get duelist(){return t().duelists.Above}});var K=r(O,2);Ws(K,{get entity(){return e(E)},get mode(){return e(U)}});var Me=r(K,2);Ha(Me,{get duelist(){return t().duelists.Below}}),s(p,g)};h(re,p=>{ee()==="wide"&&p(Ye)})}var he=r(re,2),Y=a(he),q=a(Y);{var oe=p=>{var g=vi(),O=N(g),K=a(O),Me=r(O,2),De=a(Me);f(()=>y(K,`[TURN:${t().clock.turn}][PHASE:${t().phase}] ${t().view.message}`)),ve("click",O,()=>{t(t().view.infoBoardState="Log",!0)}),ve("click",De,te),s(p,g)};h(q,p=>{t().isEnded||p(oe)})}var ke=r(Y,2),Se=a(ke);{var R=p=>{var g=ci(),O=a(g);le(O,5,()=>t().field.cells,de,(K,Me,De)=>{var ue=di();Ee(ue,`${`duel_desk_row_${De}`??""} svelte-1w535im`),le(ue,5,()=>e(Me),de,(J,Z,z)=>{Jr(J,{get view(){return t().view},row:De,column:z,get selectedEntities(){return e(u)},set selectedEntities($e){x(u,$e)},get selectedCells(){return e(o)},set selectedCells($e){x(o,$e)},$$legacy:!0})}),s(K,ue)}),s(p,g)};h(Se,p=>{t().clock.turn>0&&p(R)})}var T=r(ke,2),G=a(T);{var se=p=>{var g=fi(),O=N(g);{var K=ue=>{var J=_i();f(Z=>J.disabled=Z,[()=>!e(n)()],ye),ve("click",J,k),s(ue,J)};h(O,ue=>{((e(S)&&e(S).qty)??(e(M)&&e(M).qty)??9999)>1&&ue(K)})}var Me=r(O,2);{var De=ue=>{var J=ui();ve("click",J,B),s(ue,J)};h(Me,ue=>{e(P)&&ue(De)})}s(p,g)},ne=p=>{var g=Te(),O=N(g);le(O,1,()=>e(A),de,(K,Me)=>{var De=pi(),ue=a(De);f(()=>y(ue,e(Me).action.title)),ve("click",De,()=>I(e(Me))),s(K,De)}),s(p,g)};h(G,p=>{e(S)&&e(S).selectables.length||e(M)&&e(M).selectables?p(se):p(ne,!1)})}var D=r(he,2);{var j=p=>{var g=yi(),O=a(g);vs(O,{get log(){return t().log}});var K=r(O,2);Vs(K,{get cell(){return t().view.infoBoardCell}});var Me=r(K,2);Xs(Me,{get userProfile(){return c()},get viewController(){return t().view}}),f(De=>Ee(g,`duel_desk_right duel_desk_right_${De??""}  svelte-1w535im`),[()=>t().view.infoBoardState.toLowerCase()],ye),ae(3,g,()=>pe,()=>({duration:e(_)>1400?0:200,axis:"x"})),s(p,g)};h(D,p=>{(e(_)>1400||t().view.infoBoardState!=="Default")&&p(j)})}var m=r(me,2),F=a(m),X=r(m,2);vr(X,{get modalController(){return t().view.modalController}});var Ce=r(X,2),$=a(Ce);const w=ye(()=>ee()==="wide"?"right":"left");ni($,{get duel(){return t()},get position(){return e(w)}}),f((p,g)=>{Ee(me,`flex duel_desk ${p??""}_mode svelte-1w535im`),y(F,g),Ee(Ce,`cutin ${p??""}_mode svelte-1w535im`)},[ee,()=>t().clock.toFullString()],ye),sa("innerWidth",p=>x(_,p)),sa("innerHeight",p=>x(v,p)),s(d,we),bt()}var hi=l('<div class="svelte-1yfuu8d"><button class="button_style_reset svelte-1yfuu8d">クリア</button></div>'),bi=l("<div></div>"),ki=l("<!> <!> <!> <!> <!>",1),xi=l('<span> </span> / <span style="display: inline-block;width:2rem;text-align: right;"> </span>',1),wi=l('<li class="deck_editor_item svelte-1yfuu8d"><div role="listitem"><div class="svelte-1yfuu8d"><div class="svelte-1yfuu8d"> </div> <div style="display:flex; flex-wrap: wrap;" class="svelte-1yfuu8d"><div style="text-wrap-mode: nowrap;" class="svelte-1yfuu8d"><!> <!> <!></div> <div style="flex-grow: 1; height:0px; width:0px" class="svelte-1yfuu8d"></div> <div style="text-wrap-mode: nowrap;" class="svelte-1yfuu8d"><!></div></div></div></div> <button class="button_style_reset plus_minus_button svelte-1yfuu8d">+</button> <button class="button_style_reset plus_minus_button svelte-1yfuu8d">-</button></li>'),Ci=l('<div class="deck_editor_card_kind_header svelte-1yfuu8d"><div class="svelte-1yfuu8d"> <!> 枚） <!></div> <div style="display: flex;" class="svelte-1yfuu8d"><!> <div class="triangle svelte-1yfuu8d">▲</div></div></div> <div class="deck_editor_card_kind_body svelte-1yfuu8d"><ul></ul></div>',1),Di=l("<div><!></div>"),$i=l('<div class="deck_editor_card_list svelte-1yfuu8d"></div>');function Oa(d,i){mt(i,!1);let t=We(i,"allCardTree",8),c=We(i,"deckCardTree",12),_=We(i,"mode",8),v=We(i,"onAttention",8),u=We(i,"searchCondition",8,void 0),o=_e("ExtraMonster");const L=fa.terminalTypeName==="PC"?500:fa.terminalTypeName==="Tablet Device"?300:100,A=_e(_()==="List"?t():c()),S=(...k)=>{const B=k.length?k:Ht(e(A)),I=(te,ee)=>{var we;return Ta(te,ee,(we=u())==null?void 0:we.sort.filter(me=>me.priority>0).toSorted((me,re)=>me.priority-re.priority))};B.forEach(te=>e(A)[te].sort(I))},M=(k,B)=>{c(c()[B]=[],!0)},n=(k,B)=>{const I=ua(B),te=c()[I].filter(we=>we.name===B.name).length;let ee=k.shiftKey?3-te:1;console.debug(B,I,te,ee),!k.ctrlKey&&te>2&&(ee=0),ee&&c(c()[I]=[...c()[I],...Array(ee).fill(B)].sort(Ta),!0),v()(B)},P=(k,B)=>{const I=ua(B);let te=0;c(c()[I]=c()[I].filter(ee=>ee.name!==B.name?!0:(te++,!k.shiftKey&&te>1)),!0),v()(B)};let W=_e(100);const V=()=>{x(W,e(W)+10),!(e(W)>=L)&&(e(W)>_r(...Object.values(t()).map(k=>k.length),...Object.values(c()).map(k=>k.length))||Nt(100).then(V))};let E=_e(structuredClone(e(A))),U=_e("");const ce=k=>{if(!u())return!0;if(k.kind==="XyzMaterial")return!1;const B=ua(k);if(!u().deckCardKinds.includes(B)||u().name.trim().length&&[k.name,...k.nameTags??[],...k.textTags??[]].every(te=>!te.includes(u().name))||!k.isImplemented&&!u().others.includes("implemented")||k.isForTest&&!u().others.includes("test")||k.isOldVersion&&!u().others.includes("oldVersion"))return!1;if(k.kind==="Monster"){if(k.attributes&&!u().monsterAttributes.union(k.attributes).length||k.types&&!u().monsterTypes.union(k.types).length)return!1;const I=k.level??k.rank??k.link;return jt(u().starLowerBound)&&(I??0)<u().starLowerBound||jt(u().starUpperBound)&&(I??0)>u().starUpperBound||jt(u().atkLowerBound)&&(k.attack??0)<u().atkLowerBound||jt(u().atkUpperBound)&&(k.attack??0)>u().atkUpperBound||jt(u().defLowerBound)&&(k.defense??0)<u().defLowerBound||jt(u().defUpperBound)&&(k.defense??0)>u().defUpperBound||jt(u().atkPlusDef)&&(!jt(k.attack)||!jt(k.defense)||k.attack+k.defense!==u().atkPlusDef)||!k.monsterCategories||B==="ExtraMonster"&&!k.monsterCategories.union(u().exMonsterCategories).length?!1:k.monsterCategories.union(u().monsterCategories).length}if(k.kind==="Spell")return k.spellCategory&&u().spellCategories.includes(k.spellCategory);if(k.kind==="Trap")return k.trapCategory&&u().trapCategories.includes(k.trapCategory)};Ma(()=>(aa(_()),e(A),aa(c()),e(o),e(E)),()=>{if(_()==="Deck"){if(Ht(e(A)).forEach(k=>be(A,e(A)[k]=c()[k])),!e(A)[e(o)].length)x(o,Ht(e(A)).find(k=>e(A)[k].find(ce))??"ExtraMonster");else{const k=Ht(e(A)).map(B=>({kind:B,cardInfos:e(A)[B]})).filter(({cardInfos:B})=>B.length).find(({kind:B,cardInfos:I})=>I.length!==e(E)[B].length);k&&e(o)!==k.kind&&x(o,k.kind)}x(E,structuredClone(e(A)))}}),Ma(()=>(aa(_()),aa(u()),e(U),Nt),()=>{var k;if(_()==="List"){const B=JSON.stringify((k=u())==null?void 0:k.sort);e(U)!==B&&(x(U,B),S()),x(W,100),Nt(100).then(V)}}),dr(),ht();var xe=$i();le(xe,5,()=>zt,de,(k,B,I)=>{var te=Di();const ee=ye(()=>e(A)[e(B)].filter(ce));var we=a(te);{var me=re=>{var Ye=Ci(),he=N(Ye),Y=a(he),q=a(Y),oe=r(q);{var ke=j=>{var m=it();f(F=>y(m,`/ ${F??""}`),[()=>e(A)[e(B)].length.toLocaleString()],ye),s(j,m)};h(oe,j=>{_()==="List"&&j(ke)})}var Se=r(oe,2);{var R=j=>{var m=it();f(F=>y(m,`※表示上限${F??""}枚`),[()=>L.toLocaleString()],ye),s(j,m)};h(Se,j=>{e(ee).length>L&&j(R)})}var T=r(Y,2),G=a(T);{var se=j=>{var m=hi(),F=a(m);ve("click",F,X=>M(X,e(B))),s(j,m)};h(G,j=>{_()==="Deck"&&e(ee).length&&j(se)})}var ne=r(he,2),D=a(ne);le(D,5,()=>e(ee),de,(j,m,F)=>{var X=Te(),Ce=N(X);{var $=w=>{var p=wi(),g=a(p),O=a(g),K=a(O),Me=a(K),De=r(K,2),ue=a(De),J=a(ue);{var Z=H=>{var fe=ki(),Ue=N(fe);{var Ie=Q=>{var ie=it();f(()=>y(ie,`★${e(m).level??""}`)),s(Q,ie)};h(Ue,Q=>{e(m).level&&Q(Ie)})}var Ze=r(Ue,2);{var Oe=Q=>{var ie=it();f(()=>y(ie,`☆${e(m).rank??""}`)),s(Q,ie)};h(Ze,Q=>{e(m).rank&&Q(Oe)})}var Qe=r(Ze,2);le(Qe,1,()=>e(m).attributes??[],de,(Q,ie)=>{var Be=bi();f(()=>Ee(Be,`monster_attr ${e(ie)??""} svelte-1yfuu8d`)),s(Q,Be)});var C=r(Qe,2);le(C,1,()=>e(m).types??[],de,(Q,ie)=>{var Be=it();f(()=>y(Be,la[e(ie)])),s(Q,Be)});var b=r(C,2);le(b,1,()=>e(m).monsterCategories??[],de,(Q,ie)=>{var Be=it();f(()=>y(Be,Jt[e(ie)])),s(Q,Be)}),s(H,fe)};h(J,H=>{e(m).kind==="Monster"&&H(Z)})}var z=r(J,2);{var $e=H=>{var fe=it();f(()=>y(fe,`${oa[e(m).spellCategory]??""}魔法`)),s(H,fe)};h(z,H=>{e(m).spellCategory&&H($e)})}var Pe=r(z,2);{var He=H=>{var fe=it();f(()=>y(fe,`${va[e(m).trapCategory]??""}罠`)),s(H,fe)};h(Pe,H=>{e(m).trapCategory&&H(He)})}var qe=r(ue,4),Le=a(qe);{var Ke=H=>{var fe=xi(),Ue=N(fe),Ie=a(Ue),Ze=r(Ue,2),Oe=a(Ze);f(()=>{y(Ie,e(m).attack??"?"),y(Oe,e(m).defense??"?")}),s(H,fe)};h(Le,H=>{e(m).kind==="Monster"&&H(Ke)})}var je=r(g,2),ge=r(je,2);f((H,fe)=>{Ee(g,`${H??""} svelte-1yfuu8d`),y(Me,e(m).name),je.disabled=!e(m).isImplemented,xt(je,"title",e(m).isImplemented?`※shiftキー同時押しで一括投入
※ctrlキー同時押しで枚数制限無視`:""),ge.disabled=fe,xt(ge,"title",e(m).isImplemented?"※shiftキー同時押しで一括外し":"")},[()=>{var H,fe;return`deck_editor_card duel_card ${e(m).kind} ${(fe=(H=e(m))==null?void 0:H.monsterCategories)==null?void 0:fe.join(" ")} ${e(m).isImplemented?"is_implemented":"is_not_implemented"}`},()=>_()!=="Deck"&&c()[e(B)].every(H=>H.name!==e(m).name)],ye),ve("click",g,()=>v()(e(m))),ve("click",je,H=>n(H,e(m))),ve("click",ge,H=>P(H,e(m))),s(w,p)};h(Ce,w=>{F<e(W)&&(F<20||e(o)===e(B))&&w($)})}s(j,X)}),f(j=>{y(q,`${Ia[e(B)]??""}（${j??""} `),Ee(D,cr(e(B)),"svelte-1yfuu8d")},[()=>e(ee).length.toLocaleString()],ye),ve("click",he,()=>{if(e(o)!==e(B)){x(o,e(B));return}x(o,zt.map((j,m)=>m+I).map(j=>j%zt.length).map(j=>zt[j]).filter(j=>j!==e(B)).find(j=>e(A)[j].find(ce))??e(B))}),s(re,Ye)};h(we,re=>{e(ee).length&&re(me)})}f(()=>Ee(te,`deck_editor_card_kind deckCardKind ${(e(B)===e(o)?"selected":"")??""} ${(e(ee).length?"":"empty")??""} svelte-1yfuu8d`)),s(k,te)}),s(d,xe),bt()}var Si=l('<div class="duel_card_info_row svelte-rccxcp" style="position:sticky; top:0;"><div class="svelte-rccxcp"> </div> <div class="svelte-rccxcp"> </div></div>'),Mi=l('<div class="duel_card_info_row svelte-rccxcp"><div class="svelte-rccxcp"><pre class="description svelte-rccxcp"> </pre></div></div> <div class="duel_card_info_row svelte-rccxcp" style=" justify-content: space-between;"><div class="svelte-rccxcp"> </div> <div class="svelte-rccxcp"> </div></div>',1),Ti=l('<div></div> <div class="svelte-rccxcp"> </div>',1),ji=l("<div> </div>"),Bi=l('<span class="svelte-rccxcp">/</span> <div class="monster_defense svelte-rccxcp"> </div>',1),Ei=l("<div> </div>"),Ai=l('<div class="duel_card_info_row svelte-rccxcp"><!> <!> <div style="flex-grow: 1;" class="svelte-rccxcp"></div> <div class="monster_attack svelte-rccxcp"> </div> <!></div> <div class="duel_card_info_row svelte-rccxcp"></div>',1),Yi=l('<div class="duel_card_row svelte-rccxcp"><div class="svelte-rccxcp"></div> <div class="svelte-rccxcp"> </div></div>'),Li=l('<div class="duel_card_row svelte-rccxcp"><div class="svelte-rccxcp"></div> <div class="svelte-rccxcp"> </div></div>'),Ui=l('<div class="duel_card_info_row svelte-rccxcp"><div class="svelte-rccxcp">※エラッタ前カードです</div></div>'),Ni=l('<div class="duel_card_info_row svelte-rccxcp"><div class="svelte-rccxcp">※テスト用カードです</div></div>'),qi=l('<div class="duel_card_info_links svelte-rccxcp"><a target="_blank" rel="noopener noreferrer" title="遊戯王カードWiki" class="svelte-rccxcp">⇒遊戯王カードWiki</a> <a target="_blank" rel="noopener noreferrer" title="コナミカードデータベース" class="svelte-rccxcp"> </a></div>'),Pi=l('<div><div class="duel_card_info_header svelte-rccxcp"><div class="duel_card_info_row svelte-rccxcp"><div class="svelte-rccxcp"> </div></div> <!></div> <div class="duel_card_info_body svelte-rccxcp"><!> <!> <div class="duel_card_info_row description svelte-rccxcp"><div class="svelte-rccxcp"><pre class="description svelte-rccxcp"> </pre></div></div> <!> <!></div></div>');function Fi(d,i){mt(i,!1);let t=We(i,"cardInfo",8,void 0),c=We(i,"onAttention",8);ht();var _=Te(),v=N(_);{var u=o=>{var L=Pi(),A=a(L),S=a(A),M=a(S),n=a(M),P=r(S,2);{var W=Y=>{var q=Si(),oe=a(q),ke=a(oe),Se=r(oe,2),R=a(Se);f((T,G)=>{y(ke,T),y(R,G)},[()=>"★".repeat(t().level||0),()=>"☆".repeat(t().rank||0)],ye),s(Y,q)};h(P,Y=>{t().kind==="Monster"&&Y(W)})}var V=r(A,2),E=a(V);{var U=Y=>{var q=Mi(),oe=N(q),ke=a(oe),Se=a(ke),R=a(Se),T=r(oe,2),G=a(T),se=a(G),ne=r(G,2),D=a(ne);f(()=>{y(R,t().pendulumDescription),y(se,`◀ ${t().pendulumScaleL??""}`),y(D,`${t().pendulumScaleR??""} ▶`)}),s(Y,q)};h(E,Y=>{var q;(q=t().monsterCategories)!=null&&q.includes("Pendulum")&&Y(U)})}var ce=r(E,2);{var xe=Y=>{var q=Ai(),oe=N(q),ke=a(oe);{var Se=m=>{var F=Ti(),X=N(F),Ce=r(X,2),$=a(Ce);f(()=>{Ee(X,`monster_attr ${t().attributes[0]??""} svelte-rccxcp`),y($,`${ma[t().attributes[0]]??""}属性`)}),s(m,F)};h(ke,m=>{t().attributes&&m(Se)})}var R=r(ke,2);{var T=m=>{var F=ji(),X=a(F);f(()=>{Ee(F,`monster_cat ${t().types[0]??""} svelte-rccxcp`),y(X,`${la[t().types[0]]??""}${ha[t().types[0]]??""}族`)}),s(m,F)};h(R,m=>{t().types&&m(T)})}var G=r(R,4),se=a(G),ne=r(G,2);{var D=m=>{var F=Bi(),X=r(N(F),2),Ce=a(X);f(()=>y(Ce,t().defense??"?")),s(m,F)};h(ne,m=>{var F;(F=t().monsterCategories)!=null&&F.includes("Link")||m(D)})}var j=r(oe,2);le(j,5,()=>t().monsterCategories??[],de,(m,F)=>{var X=Ei(),Ce=a(X);f(()=>{Ee(X,`monster_cat ${e(F)??""} svelte-rccxcp`),y(Ce,`${Jt[e(F)]??""}${ra[e(F)]??""}`)}),s(m,X)}),f(()=>y(se,t().attack??"?")),s(Y,q)},k=Y=>{var q=Te(),oe=N(q);{var ke=R=>{var T=Yi(),G=r(a(T),2),se=a(G);f(()=>y(se,`${oa[t().spellCategory]??""}魔法`)),s(R,T)},Se=R=>{var T=Te(),G=N(T);{var se=ne=>{var D=Li(),j=r(a(D),2),m=a(j);f(()=>y(m,`${va[t().trapCategory]??""}罠`)),s(ne,D)};h(G,ne=>{t().kind==="Trap"&&t().trapCategory&&ne(se)},!0)}s(R,T)};h(oe,R=>{t().kind==="Spell"&&t().spellCategory?R(ke):R(Se,!1)},!0)}s(Y,q)};h(ce,Y=>{t().kind==="Monster"?Y(xe):Y(k,!1)})}var B=r(ce,2),I=a(B),te=a(I),ee=a(te),we=r(B,2);{var me=Y=>{var q=Ui();s(Y,q)};h(we,Y=>{t().isOldVersion&&Y(me)})}var re=r(we,2);{var Ye=Y=>{var q=Ni();s(Y,q)},he=Y=>{var q=qi(),oe=a(q),ke=r(oe,2),Se=a(ke);f(R=>{xt(oe,"href",`https://yugioh-wiki.net/index.php?${t().wikiEncodedName}`),xt(ke,"href",R),y(Se,`⇒${(t().cardId?"公式カードページ":"公式で検索")??""}`)},[()=>ur(t())],ye),s(Y,q)};h(re,Y=>{t().isForTest?Y(Ye):Y(he,!1)})}f(Y=>{Ee(L,`duel_card duel_card_info ${t().kind??""} ${Y??""} svelte-rccxcp`),y(n,t().name),y(ee,t().description)},[()=>{var Y;return(Y=t().monsterCategories)==null?void 0:Y.join(" ")}],ye),ve("click",L,()=>c()(t())),s(o,L)};h(v,o=>{t()&&o(u)})}s(d,_),bt()}const Hi={0:{aaa:"日",aaaa:"日曜日",ddd:"Sun",dddd:"Sunday"},1:{aaa:"月",aaaa:"月曜日",ddd:"Mon",dddd:"Monday"},2:{aaa:"火",aaaa:"火曜日",ddd:"Tue",dddd:"Tuesday"},3:{aaa:"水",aaaa:"水曜日",ddd:"Wed",dddd:"Wednesday"},4:{aaa:"木",aaaa:"木曜日",ddd:"Thu",dddd:"Thursday"},5:{aaa:"金",aaaa:"金曜日",ddd:"Fri",dddd:"Friday"},6:{aaa:"土",aaaa:"土曜日",ddd:"Sat",dddd:"Saturday"}};class Oi{constructor(){ot(this,"DefaultSeparator1","/");ot(this,"DefaultSeparator2"," ");ot(this,"DefaultSeparator3",":");ot(this,"createDate",i=>{if(!i)return;const t=new Date(i);if(!isNaN(t.getTime()))return t});ot(this,"createDateOr",(i,t)=>this.createDate(i)||t||new Date);ot(this,"truncateDate",i=>{const t=i||new Date;return new Date(t.getFullYear(),t.getMonth(),t.getDate())});ot(this,"addDate",(i,t)=>{const c=this.createDateOr(i);return c.setDate(c.getDate()+t),c});ot(this,"addMonth",(i,t)=>{const c=this.createDateOr(i);return c.setMonth(c.getMonth()+t),c});ot(this,"addYear",(i,t)=>{const c=this.createDateOr(i);return c.setFullYear(c.getFullYear()+t),c});ot(this,"getDayOfWeek",(i,t="dddd")=>{const c=this.createDate(i);return c?Hi[c.getDay()][t]:""});ot(this,"formatToYYYYMMDD",(i,t=this.DefaultSeparator1)=>{const c=this.createDate(i);if(!c)return"";const _=c.getFullYear().toString(),v=("0"+(c.getMonth()+1)).slice(-2),u=("0"+c.getDate()).slice(-2);return _+t+v+t+u});ot(this,"formatToYYYYMM",(i,t=this.DefaultSeparator1)=>{const c=this.createDate(i);if(!c)return"";t||(t="");const _=c.getFullYear().toString(),v=("0"+(c.getMonth()+1)).slice(-2);return _+t+v});ot(this,"formatToHHMMSS",(i,t=this.DefaultSeparator3)=>{const c=this.createDate(i);if(!c)return"";t||(t="");const _=c.getHours(),v=c.getMinutes(),u=c.getSeconds();return("0"+_).slice(-2)+t+("0"+v).slice(-2)+t+("0"+u).slice(-2)});ot(this,"formatToHHMM",(i,t=this.DefaultSeparator3)=>{const c=this.createDate(i);if(!c)return"";t||(t="");const _=("0"+c.getHours()).slice(-2),v=("0"+c.getMinutes()).slice(-2);return _+t+v});ot(this,"formatToYYYYMMDD_HHMM",(i,t=this.DefaultSeparator1,c=this.DefaultSeparator2,_=this.DefaultSeparator3)=>{const v=this.createDate(i);return v?this.formatToYYYYMMDD(v,t)+c+this.formatToHHMM(v,_):""});ot(this,"formatToYYYYMMDD_HHMMSS",(i,t=this.DefaultSeparator1,c=this.DefaultSeparator2,_=this.DefaultSeparator3)=>{const v=this.createDate(i);return v?this.formatToYYYYMMDD(v,t)+c+this.formatToHHMMSS(v,_):""})}}const wt=new Oi;Date.prototype.truncateDate=function(){return wt.truncateDate(this)};Date.prototype.getCloneOr=function(d){return wt.createDateOr(this,d)};Date.prototype.addDate=function(d){return wt.addDate(this,d)};Date.prototype.addMonth=function(d){return wt.addDate(this,d)};Date.prototype.addYear=function(d){return wt.addDate(this,d)};Date.prototype.getDayOfWeek=function(d="dddd"){return wt.getDayOfWeek(this,d)};Date.prototype.formatToYYYYMM=function(d){return wt.formatToYYYYMM(this,d)};Date.prototype.formatToYYYYMMDD=function(d){return wt.formatToYYYYMMDD(this,d)};Date.prototype.formatToYYYYMMDD_HHMM=function(d,i,t){return wt.formatToYYYYMMDD_HHMM(this,d,i,t)};Date.prototype.formatToYYYYMMDD_HHMMSS=function(d,i,t){return wt.formatToYYYYMMDD_HHMMSS(this,d,i,t)};Date.prototype.formatToHHMM=function(d){return wt.formatToHHMM(this,d)};Date.prototype.formatToHHMMSS=function(d){return wt.formatToHHMMSS(this,d)};var Ri=l('<li class="deck_info_list_item svelte-2wdgc8"><div class="svelte-2wdgc8"> </div> <div class="svelte-2wdgc8"> </div> <div class="svelte-2wdgc8"> </div></li>'),Wi=l('<ul class="deck_info_list svelte-2wdgc8"></ul>'),Ii=l('<label for="file_selector" class="upload_area svelte-2wdgc8" role="region" aria-label="ファイルアップロードエリア"><div class="upload_area_message svelte-2wdgc8">ここにファイルをドロップ</div> <div class="upload_area_footer svelte-2wdgc8"><input type="file" id="file_selector" name="file_selector" accept=".json" multiple></div></label>'),Ki=l('<div slot="body" class="modal_body svelte-2wdgc8"><!></div>'),zi=l('<button class="svelte-2wdgc8">追加</button> <button class="svelte-2wdgc8">削除して追加</button> <button class="svelte-2wdgc8">戻る</button>',1),Vi=l('<button class="svelte-2wdgc8">Cancel</button>'),Gi=l('<div slot="footer" class="modal_window_footer svelte-2wdgc8"><!></div>');function Qi(d,i){mt(i,!1);let t=We(i,"eventHolder",8),c=We(i,"args",8),_=We(i,"resolve",8),v=_e(Promise.resolve([])),u=_e();const o=()=>{x(u,new DataTransfer().files),x(v,Promise.resolve([]))},L=async P=>{P.preventDefault(),console.log("hoge",P)},A=async P=>{P.preventDefault(),P.dataTransfer&&M(P.dataTransfer.files)},S=()=>{M(e(u))},M=async P=>{if(!P.length)return;const W=[],V=[];for(const E of P)try{V.push(...await Dt.createfromJson(E))}catch(U){U instanceof Error&&W.push(U.message)}if(W.length){console.log(...W);return}x(v,e(v).then(()=>V))},n=o;ht(),fr(d,{get eventHolder(){return t()},get args(){return c()},$$slots:{body:(P,W)=>{var V=Ki(),E=a(V);kt(E,()=>Xt,null,(U,ce)=>{var xe=Te(),k=N(xe);kt(k,()=>e(v),null,(B,I)=>{var te=Te(),ee=N(te);{var we=re=>{var Ye=Wi();le(Ye,5,()=>e(I),de,(he,Y)=>{var q=Ri(),oe=a(q),ke=a(oe),Se=r(oe,2),R=a(Se),T=r(Se,2),G=a(T);f((se,ne,D)=>{y(ke,e(Y).name),y(R,`${se??""}
                  /
                  ${ne??""}`),y(G,`最終使用日時 ： ${D??""}`)},[()=>e(Y).cardNames.filter(se=>{var ne,D;return!((D=(ne=e(ce).getCardInfo(se))==null?void 0:ne.monsterCategories)!=null&&D.union(Vt).length)}).length,()=>e(Y).cardNames.filter(se=>{var ne,D;return(D=(ne=e(ce).getCardInfo(se))==null?void 0:ne.monsterCategories)==null?void 0:D.union(Vt).length}).length,()=>e(Y).lastUsedAt.formatToYYYYMMDD_HHMM("/"," ",":")],ye),s(he,q)}),s(re,Ye)},me=re=>{var Ye=Ii(),he=r(a(Ye),2),Y=a(he);pr(Y,()=>e(u),q=>x(u,q)),ve("change",Y,S),ve("cancel",Y,n),ve("drop",Ye,A),ve("dragover",Ye,L),s(re,Ye)};h(ee,re=>{e(I).length?re(we):re(me,!1)})}s(B,te)}),s(U,xe)}),s(P,V)},footer:(P,W)=>{var V=Gi(),E=a(V);kt(E,()=>e(v),null,(U,ce)=>{var xe=Te(),k=N(xe);{var B=te=>{var ee=zi(),we=N(ee),me=r(we,2),re=r(me,2);f(()=>{we.disabled=e(ce).length===0,me.disabled=e(ce).length===0}),ve("click",we,()=>_()({deckInfos:e(ce),replaceAll:!1})),ve("click",me,()=>_()({deckInfos:e(ce),replaceAll:!0})),ve("click",re,n),s(te,ee)},I=te=>{var ee=Te(),we=N(ee);{var me=re=>{var Ye=Vi();ve("click",Ye,()=>_()(void 0)),s(re,Ye)};h(we,re=>{c().cancelable&&re(me)},!0)}s(te,ee)};h(k,te=>{e(ce).length?te(B):te(I,!1)})}s(U,xe)}),s(P,V)}}}),bt()}const na=class na extends gr{constructor(i,t){super(i,...Object.values(t))}};ot(na,"createModalController",i=>{const t={deckUploader:new mr({title:"デッキ情報をアップロード",position:"Middle",cancelable:!1})};return Object.assign(new na(i,t),t)});let ga=na;function Xi(d,i){mt(i,!1);let t=We(i,"modalController",8);ht(),yr(d,{get modalController(){return t()},children:(c,_)=>{var v=Te(),u=N(v);{var o=L=>{Qi(L,{get eventHolder(){return t().eventHolder},get args(){return t().deckUploader.args},get resolve(){return t().deckUploader.resolve}})};h(u,L=>{t().deckUploader.state==="Shown"&&L(o)})}s(c,v)},$$slots:{default:!0}}),bt()}var Ji=l("<button> </button>"),Zi=l('<label class="svelte-n46fl7"><input type="checkbox" class="search_condition svelte-n46fl7"> </label>'),en=l('<label class="svelte-n46fl7"><input type="checkbox" class="search_condition svelte-n46fl7"> </label>'),tn=l('<div class="deck_editor_search_box_row monster_ex_categories svelte-n46fl7"><div class="svelte-n46fl7"><button class="search_condition_title black_button svelte-n46fl7">エクストラ</button></div> <div class="svelte-n46fl7"></div></div>'),an=l('<label class="svelte-n46fl7"><input type="checkbox" class="search_condition svelte-n46fl7"> </label>'),rn=l('<label class="svelte-n46fl7"><input type="checkbox" class="search_condition svelte-n46fl7"> <div style="display: inline-block;"></div> </label>'),sn=l('<label class="svelte-n46fl7"><input type="checkbox" class="search_condition svelte-n46fl7"> </label>'),nn=l('<div class="deck_editor_search_box_row monster_categories svelte-n46fl7"><div class="svelte-n46fl7"><button class="search_condition_title black_button svelte-n46fl7">モンスター</button></div> <div class="svelte-n46fl7"></div></div> <div class="deck_editor_search_box_row monster_attributes svelte-n46fl7"><div class="svelte-n46fl7"><button class="search_condition_title black_button svelte-n46fl7">属性</button></div> <div class="svelte-n46fl7"></div></div> <div class="deck_editor_search_box_row svelte-n46fl7"><div class="svelte-n46fl7"><button class="search_condition_title black_button svelte-n46fl7">種族</button></div> <div class="svelte-n46fl7"></div></div> <div class="deck_editor_search_box_row svelte-n46fl7"><div class="svelte-n46fl7"><button class="search_condition_title black_button svelte-n46fl7">星攻守</button></div> <div class="svelte-n46fl7"><div class="star_range svelte-n46fl7"><span class="svelte-n46fl7">星</span> <input type="number" min="0" max="13" class="svelte-n46fl7"> <span class="svelte-n46fl7">～</span> <input type="number" min="0" max="13" class="svelte-n46fl7"></div> <div class="atk_range svelte-n46fl7"><span class="svelte-n46fl7">攻</span> <input type="number" min="0" max="5000" step="100" class="svelte-n46fl7"> <span class="svelte-n46fl7">～</span> <input type="number" min="0" max="5000" step="100" class="svelte-n46fl7"></div> <div class="def_range svelte-n46fl7"><span class="svelte-n46fl7">守</span> <input type="number" min="0" max="5000" step="100" class="svelte-n46fl7"> <span class="svelte-n46fl7">～</span> <input type="number" min="0" max="5000" step="100" class="svelte-n46fl7"></div> <div class="atk_plus_def svelte-n46fl7"><span class="svelte-n46fl7">攻+守</span> <input type="number" min="0" max="10000" step="100" class="svelte-n46fl7"></div></div></div>',1),ln=l('<label class="svelte-n46fl7"><input type="checkbox" class="search_condition svelte-n46fl7"> </label>'),on=l('<div class="deck_editor_search_box_row svelte-n46fl7"><div class="svelte-n46fl7"><button class="search_condition_title black_button svelte-n46fl7">魔法</button></div> <div class="svelte-n46fl7"></div></div>'),vn=l('<label class="svelte-n46fl7"><input type="checkbox" class="search_condition svelte-n46fl7"> </label>'),dn=l('<div class="deck_editor_search_box_row svelte-n46fl7"><div class="svelte-n46fl7"><button class="search_condition_title black_button svelte-n46fl7">罠</button></div> <div class="svelte-n46fl7"></div></div>'),cn=l('<label class="svelte-n46fl7"><input type="checkbox" class="search_condition svelte-n46fl7"> </label>'),_n=l("<div>カード情報読込中</div>"),un=l("<option> </option>"),fn=l('<div class="svelte-n46fl7"><a class="white_button svelte-n46fl7" download="SVS_DeckInfos.json">ダウンロード</a></div>'),pn=l('<div class="svelte-n46fl7"></div>'),yn=l('<div class="svelte-n46fl7"><a class="white_button svelte-n46fl7" download="SVS_DeckInfos.json">ダウンロード(一括)</a></div>'),gn=l('<div class="svelte-n46fl7"></div>'),mn=l('<div class="deck_editor_body_right_header svelte-n46fl7"><div class="deck_editor_body_right_header_row svelte-n46fl7"><div class="svelte-n46fl7">編集対象</div> <div class="svelte-n46fl7"><select style="width:100%" class="svelte-n46fl7"></select></div></div> <div class="deck_editor_body_right_header_row svelte-n46fl7"><div class="svelte-n46fl7">新規名称</div> <div class="svelte-n46fl7"><input type="text" style="width:100%" class="svelte-n46fl7"></div></div> <div class="deck_editor_body_right_header_row svelte-n46fl7"></div> <div class="deck_editor_body_right_header_row svelte-n46fl7"><div class="svelte-n46fl7">基本操作</div> <div class="svelte-n46fl7"><button class="white_button svelte-n46fl7">デッキを保存</button></div> <div class="svelte-n46fl7"><button class="white_button svelte-n46fl7">デッキを複製</button></div> <div class="svelte-n46fl7"><button class="white_button svelte-n46fl7" title="shiftキー押下で確認メッセージスキップ">デッキを削除</button></div></div> <div class="deck_editor_body_right_header_row svelte-n46fl7"><div class="svelte-n46fl7">DL/UL</div> <!> <!> <div class="svelte-n46fl7"><button class="white_button svelte-n46fl7">アップロード</button></div></div></div> <!>',1),hn=l('<div class="svelte-n46fl7">デッキ情報読込中</div>'),bn=l('<div class="svelte-n46fl7"></div>'),kn=l('<div><div class="deck_editor_header svelte-n46fl7"></div> <div class="deck_editor_body svelte-n46fl7"><div class="deck_editor_body_left svelte-n46fl7"><div role="contentinfo" class="deck_editor_search_box svelte-n46fl7"><div class="deck_editor_search_box_header svelte-n46fl7"><div class="svelte-n46fl7"><button class="deck_editor_search_box_title svelte-n46fl7">検索条件</button></div> <div class="deck_editor_sort_setting_container svelte-n46fl7"></div></div> <div class="deck_editor_search_box_body svelte-n46fl7"><div class="deck_editor_search_box_row svelte-n46fl7"><div class="svelte-n46fl7"><button class="search_condition_title black_button svelte-n46fl7">名称</button></div> <div class="svelte-n46fl7"><input type="text" style="width:100%" placeholder="※ルビには対応していません" class="svelte-n46fl7"></div></div> <div class="deck_editor_search_box_row card_kind svelte-n46fl7"><div class="svelte-n46fl7"><button class="search_condition_title black_button svelte-n46fl7">種類</button></div> <div class="svelte-n46fl7"></div></div> <!> <!> <!> <!> <div class="deck_editor_search_box_row svelte-n46fl7"><div class="svelte-n46fl7"><button class="search_condition_title black_button svelte-n46fl7">その他</button></div> <div class="svelte-n46fl7"></div></div></div></div> <!></div> <div class="deck_editor_body_center svelte-n46fl7"><!></div>  <div class="deck_editor_body_right svelte-n46fl7"><!></div></div> <div class="footer svelte-n46fl7"></div></div> <!>',1);function xn(d,i){mt(i,!1);const t=[],c=[],_=[],v=[],u=[],o=[],L=[],A=[],S=ga.createModalController({onDragStart:{append:()=>{},remove:()=>{}},onDragEnd:{append:()=>{},remove:()=>{}}}),M={name:"",deckCardKinds:[...zt],exMonsterCategories:[...Vt],monsterCategories:Ya.filter(C=>!Vt.includes(C)),monsterAttributes:[...Aa],monsterTypes:[...Ea],spellCategories:Ba.filter(C=>C!=="PendulumScale"),trapCategories:[...ja],starLowerBound:0,starUpperBound:13,atkLowerBound:0,atkUpperBound:5e3,defLowerBound:0,defUpperBound:5e3,atkPlusDef:void 0,others:["test","oldVersion","implemented"],sort:[...La]},n=_e(structuredClone(M));be(n,e(n).others=["oldVersion"]),be(n,e(n).monsterCategories=e(n).monsterCategories.filter(C=>C!=="Normal"));let P=_e("DeckEdit"),W=_e("SearchCondition");const V=()=>{if(!e(n).deckCardKinds.length){Ht(e(n)).forEach(C=>{Array.isArray(e(n)[C])&&Array.isArray(M[C])?be(n,e(n)[C]=[...M[C]]):be(n,e(n)[C]=M[C])});return}be(n,e(n).name=""),be(n,e(n).deckCardKinds=[]),be(n,e(n).exMonsterCategories=[]),be(n,e(n).monsterCategories=[]),be(n,e(n).monsterAttributes=[]),be(n,e(n).monsterTypes=[]),be(n,e(n).spellCategories=[]),be(n,e(n).trapCategories=[]),be(n,e(n).others=[]),be(n,e(n).atkLowerBound=0),be(n,e(n).atkUpperBound=5e3),be(n,e(n).defLowerBound=0),be(n,e(n).defUpperBound=5e3),be(n,e(n).atkPlusDef=void 0),be(n,e(n).sort=[...La])},E=C=>{C.forEach(b=>{Array.isArray(e(n)[b])&&Array.isArray(M[b])?be(n,e(n)[b]=e(n)[b].length?[]:[...M[b]]):be(n,e(n)[b]=M[b])})},U=(C,b,Q)=>{Array.isArray(e(n)[b])&&Array.isArray(M[b])&&be(n,e(n)[b]=[Q])},ce=async()=>{const b=(await e(B)).find(ie=>ie.id===e(k));if(!b)return;const Q=await Xt;x(ee,{...b,cardTree:br(b.cardNames.map(ie=>{const Be=Q.getCardInfo(ie);return Be===void 0&&console.error(ie),Be}).filter(ie=>ie!==void 0))})},xe=()=>Dt.getAllDeckInfo().then(C=>(x(k,(C.find(b=>b.lastUsedAt.getTime()===Math.max(...C.map(Q=>Q.lastUsedAt.getTime())))??C[0]).id),C));let k=_e(-1),B=_e(xe()),I=_e(e(B).then(C=>Dt.convertToObjectURL(C)));e(B).then(ce);const te=()=>{x(B,xe()),x(I,e(B).then(C=>Dt.convertToObjectURL(C))),ce()};let ee=_e({id:-Number.MAX_VALUE,name:"",description:"",lastUsedAt:new Date,cardTree:{ExtraMonster:[],Monster:[],Spell:[],Trap:[]}}),we=_e(void 0),me=0;const re=C=>{x(W,"CardDetail"),C.cardId!==void 0&&!C.description&&!C.pendulumDescription&&(me=C.cardId,Wa([C.cardId]).then(()=>{C.cardId===me&&x(we,C)})),x(we,C)},Ye=async()=>{const b=(await e(B)).find(Q=>Q.id===e(k));if(!b)throw new Error("illegal state");return b},he=async()=>{const C=await Ye();await C.saveDeckInfo({...C,name:e(ee).name,cardNames:Object.values(e(ee).cardTree).flatMap(b=>b).map(b=>b.name),lastUsedAt:new Date}),te()},Y=async()=>{(await Dt.createNewDeck(`デッキ_${new Date().formatToYYYYMMDD_HHMMSS("","","")}`,`コピー日時：${new Date().formatToYYYYMMDD_HHMMSS("-"," ",":")}`,Object.values(e(ee).cardTree).flatMap(b=>b).map(b=>b.name))).saveDeckInfo(),te()},q=async C=>{const b=await Ye();!C.shiftKey&&!confirm(`デッキ【${b.name}】を削除します。
よろしいですか？`)||(await b.delete(),te())},oe=async()=>{const C=await S.deckUploader.show({title:"デッキ情報アップロード",position:"Middle",cancelable:!0});if(!C)return;const b=[];if(C.replaceAll){if(!confirm(`既存デッキ情報を全て削除し、アップロードしたファイルに置き換えます。
よろしいですか？`))return;b.push(...(await e(B)).map(Q=>Q.id))}await Promise.all(C.deckInfos.map(Q=>Dt.createNewDeck(Q.name,Q.description,Q.cardNames,Q.lastUsedAt))),b.length&&await Promise.all(b.map(Dt.remove)),te()},ke=()=>innerWidth<=1400?"compact":"wide";ht();var Se=kn(),R=N(Se),T=r(a(R),2),G=a(T),se=a(G),ne=a(se),D=a(ne),j=a(D),m=r(D,2);le(m,5,()=>e(n).sort,de,(C,b,Q)=>{var ie=Ji(),Be=a(ie);f(()=>{Ee(ie,`deck_editor_sort_setting_item ${e(b).order??""} priority_${e(b).priority??""} svelte-n46fl7`),y(Be,`${hr[e(b).key]??""}
                ${(e(b).order==="asc"?"▲":"▼")??""}`)}),ve("click",ie,()=>{e(n).sort.forEach(Je=>Je.priority++),e(b).order=e(b).order==="asc"?"desc":"asc",Ut(()=>e(n).sort),e(b).priority=1,Ut(()=>e(n).sort)}),s(C,ie)});var F=r(ne,2),X=a(F),Ce=a(X),$=a(Ce),w=r(Ce,2),p=a(w),g=r(X,2),O=a(g),K=a(O),Me=r(O,2);le(Me,5,()=>zt,de,(C,b)=>{var Q=Zi(),ie=a(Q),Be,Je=r(ie);f(()=>{Be!==(Be=e(b))&&(ie.value=(ie.__value=e(b))==null?"":e(b)),y(Je,` ${Ia[e(b)]??""}`)}),Lt(t,[],ie,()=>(e(b),e(n).deckCardKinds),Ne=>be(n,e(n).deckCardKinds=Ne)),s(C,Q)});var De=r(g,2);{var ue=C=>{var b=tn(),Q=a(b),ie=a(Q),Be=r(Q,2);le(Be,5,()=>Vt,de,(Je,Ne)=>{var ze=en(),Re=a(ze),Ve,dt=r(Re);f(()=>{Ve!==(Ve=e(Ne))&&(Re.value=(Re.__value=e(Ne))==null?"":e(Ne)),y(dt,` ${Jt[e(Ne)]??""}${ra[e(Ne)]??""}`)}),Lt(c,[],Re,()=>(e(Ne),e(n).exMonsterCategories),ft=>be(n,e(n).exMonsterCategories=ft)),s(Je,ze)}),ve("click",ie,()=>E(["exMonsterCategories"])),ae(3,b,()=>pe,()=>({delay:0,duration:100})),s(C,b)};h(De,C=>{e(n).deckCardKinds.includes("ExtraMonster")&&C(ue)})}var J=r(De,2);{var Z=C=>{var b=nn(),Q=N(b),ie=a(Q),Be=a(ie),Je=r(ie,2);le(Je,5,()=>Ya.filter(Ae=>!Vt.includes(Ae)),de,(Ae,Fe)=>{var yt=an(),vt=a(yt),Ct,lt=r(vt);f(()=>{Ct!==(Ct=e(Fe))&&(vt.value=(vt.__value=e(Fe))==null?"":e(Fe)),y(lt,` ${Jt[e(Fe)]??""}${ra[e(Fe)]??""}`)}),Lt(_,[],vt,()=>(e(Fe),e(n).monsterCategories),Ge=>be(n,e(n).monsterCategories=Ge)),s(Ae,yt)});var Ne=r(Q,2),ze=a(Ne),Re=a(ze),Ve=r(ze,2);le(Ve,5,()=>Aa,de,(Ae,Fe)=>{var yt=rn(),vt=a(yt),Ct,lt=r(vt,2),Ge=r(lt);f(()=>{Ct!==(Ct=e(Fe))&&(vt.value=(vt.__value=e(Fe))==null?"":e(Fe)),Ee(lt,`monster_attr ${e(Fe)??""} svelte-n46fl7`),y(Ge,` ${ma[e(Fe)]??""}`)}),Lt(v,[],vt,()=>(e(Fe),e(n).monsterAttributes),ut=>be(n,e(n).monsterAttributes=ut)),s(Ae,yt)});var dt=r(Ne,2),ft=a(dt),Et=a(ft),At=r(ft,2);le(At,5,()=>Ea,de,(Ae,Fe)=>{var yt=sn(),vt=a(yt),Ct,lt=r(vt);f(()=>{Ct!==(Ct=e(Fe))&&(vt.value=(vt.__value=e(Fe))==null?"":e(Fe)),y(lt,` ${la[e(Fe)]??""}
                    ${ha[e(Fe)]??""}`)}),Lt(u,[],vt,()=>(e(Fe),e(n).monsterTypes),Ge=>be(n,e(n).monsterTypes=Ge)),ve("dblclick",yt,Ge=>U(Ge,"monsterTypes",e(Fe))),s(Ae,yt)});var Yt=r(dt,2),Rt=a(Yt),rt=a(Rt),et=r(Rt,2),nt=a(et),st=r(a(nt),2),_t=r(st,4),pt=r(nt,2),ct=r(a(pt),2),$t=r(ct,4),Mt=r(pt,2),Tt=r(a(Mt),2),Xe=r(Tt,4),tt=r(Mt,2),at=r(a(tt),2);ve("click",Be,()=>E(["monsterCategories"])),ae(3,Q,()=>pe,()=>({delay:0,duration:100})),ve("click",Re,()=>E(["monsterAttributes"])),ae(3,Ne,()=>pe,()=>({delay:0,duration:100})),ve("click",Et,()=>E(["monsterTypes"])),ae(3,dt,()=>pe,()=>({delay:0,duration:100})),ve("click",rt,()=>E(["starLowerBound","starUpperBound","atkLowerBound","atkUpperBound","defLowerBound","defUpperBound","atkPlusDef"])),St(st,()=>e(n).starLowerBound,Ae=>be(n,e(n).starLowerBound=Ae)),St(_t,()=>e(n).starUpperBound,Ae=>be(n,e(n).starUpperBound=Ae)),St(ct,()=>e(n).atkLowerBound,Ae=>be(n,e(n).atkLowerBound=Ae)),St($t,()=>e(n).atkUpperBound,Ae=>be(n,e(n).atkUpperBound=Ae)),St(Tt,()=>e(n).defLowerBound,Ae=>be(n,e(n).defLowerBound=Ae)),St(Xe,()=>e(n).defUpperBound,Ae=>be(n,e(n).defUpperBound=Ae)),St(at,()=>e(n).atkPlusDef,Ae=>be(n,e(n).atkPlusDef=Ae)),ae(3,Yt,()=>pe,()=>({delay:0,duration:100})),s(C,b)};h(J,C=>{(e(n).deckCardKinds.includes("Monster")||e(n).deckCardKinds.includes("ExtraMonster"))&&C(Z)})}var z=r(J,2);{var $e=C=>{var b=on(),Q=a(b),ie=a(Q),Be=r(Q,2);le(Be,5,()=>Ba.filter(Je=>Je!=="PendulumScale"),de,(Je,Ne)=>{var ze=ln(),Re=a(ze),Ve,dt=r(Re);f(()=>{Ve!==(Ve=e(Ne))&&(Re.value=(Re.__value=e(Ne))==null?"":e(Ne)),y(dt,` ${oa[e(Ne)]??""}`)}),Lt(o,[],Re,()=>(e(Ne),e(n).spellCategories),ft=>be(n,e(n).spellCategories=ft)),s(Je,ze)}),ve("click",ie,()=>E(["spellCategories"])),ae(3,b,()=>pe,()=>({delay:0,duration:100})),s(C,b)};h(z,C=>{e(n).deckCardKinds.includes("Spell")&&C($e)})}var Pe=r(z,2);{var He=C=>{var b=dn(),Q=a(b),ie=a(Q),Be=r(Q,2);le(Be,5,()=>ja,de,(Je,Ne)=>{var ze=vn(),Re=a(ze),Ve,dt=r(Re);f(()=>{Ve!==(Ve=e(Ne))&&(Re.value=(Re.__value=e(Ne))==null?"":e(Ne)),y(dt,` ${va[e(Ne)]??""}`)}),Lt(L,[],Re,()=>(e(Ne),e(n).trapCategories),ft=>be(n,e(n).trapCategories=ft)),s(Je,ze)}),ve("click",ie,()=>E(["trapCategories"])),ae(3,b,()=>pe,()=>({delay:0,duration:100})),s(C,b)};h(Pe,C=>{e(n).deckCardKinds.includes("Trap")&&C(He)})}var qe=r(Pe,2),Le=a(qe),Ke=a(Le),je=r(Le,2);le(je,4,()=>[{key:"test",text:"テスト用カード"},{key:"oldVersion",text:"エラッタ前カード"},{key:"implemented",text:"未実装カード"}],de,(C,b)=>{var Q=cn(),ie=a(Q),Be,Je=r(ie);f(()=>{Be!==(Be=b.key)&&(ie.value=(ie.__value=b.key)==null?"":b.key),y(Je,` ${b.text??""}`)}),Lt(A,[],ie,()=>(b.key,e(n).others),Ne=>be(n,e(n).others=Ne)),s(C,Q)});var ge=r(se,2);Fi(ge,{get cardInfo(){return e(we)},onAttention:re});var H=r(G,2),fe=a(H);kt(fe,()=>Xt,C=>{var b=_n();s(C,b)},(C,b)=>{Oa(C,{mode:"List",get allCardTree(){return e(b).tree},onAttention:re,get searchCondition(){return e(n)},get deckCardTree(){return e(ee).cardTree},set deckCardTree(Q){be(ee,e(ee).cardTree=Q)},$$legacy:!0})});var Ue=r(H,2),Ie=a(Ue);{var Ze=C=>{var b=Te(),Q=N(b);kt(Q,()=>e(B),ie=>{var Be=hn();s(ie,Be)},(ie,Be)=>{var Je=mn(),Ne=N(Je),ze=a(Ne),Re=r(a(ze),2),Ve=a(Re);f(()=>{e(k),Ut(()=>{e(Be)})}),le(Ve,5,()=>e(Be),de,(Xe,tt)=>{var at=un(),Ae={},Fe=a(at);f(()=>{Ae!==(Ae=e(tt).id)&&(at.value=(at.__value=e(tt).id)==null?"":e(tt).id),y(Fe,e(tt).name)}),s(Xe,at)});var dt=r(ze,2),ft=r(a(dt),2),Et=a(ft),At=r(dt,4),Yt=r(a(At),2),Rt=a(Yt),rt=r(Yt,2),et=a(rt),nt=r(rt,2),st=a(nt),_t=r(At,2),pt=r(a(_t),2);kt(pt,Ye,Xe=>{var tt=pn();s(Xe,tt)},(Xe,tt)=>{var at=fn(),Ae=a(at);f(Fe=>xt(Ae,"href",Fe),[()=>Dt.convertToObjectURL([e(tt)])],ye),s(Xe,at)});var ct=r(pt,2);kt(ct,()=>e(I),Xe=>{var tt=gn();s(Xe,tt)},(Xe,tt)=>{var at=yn(),Ae=a(at);f(()=>xt(Ae,"href",e(tt))),s(Xe,at)});var $t=r(ct,2),Mt=a($t),Tt=r(Ne,2);Oa(Tt,{mode:"Deck",allCardTree:{ExtraMonster:[],Monster:[],Spell:[],Trap:[]},onAttention:re,get deckCardTree(){return e(ee).cardTree},set deckCardTree(Xe){be(ee,e(ee).cardTree=Xe)},$$legacy:!0}),Kt(Ve,()=>e(k),Xe=>x(k,Xe)),ve("change",Ve,ce),St(Et,()=>e(ee).name,Xe=>be(ee,e(ee).name=Xe)),ve("click",Rt,he),ve("click",et,Y),ve("click",st,q),ve("click",Mt,oe),s(ie,Je)}),s(C,b)},Oe=C=>{var b=bn();s(C,b)};h(Ie,C=>{e(P)==="DeckEdit"||ke()==="wide"?C(Ze):C(Oe,!1)})}var Qe=r(R,2);Xi(Qe,{modalController:S}),f((C,b,Q)=>Ee(R,`deck_editor screen_size_${C??""} left_pain_mode_${b??""} main_view_mode_${Q??""} svelte-n46fl7`),[ke,()=>e(W).toLowerCase(),()=>e(P).toLowerCase()],ye),ve("click",j,V),ve("click",$,()=>E(["name"])),St(p,()=>e(n).name,C=>be(n,e(n).name=C)),ve("click",K,()=>E(["deckCardKinds"])),ve("click",Ke,()=>E(["others"])),ae(3,qe,()=>pe,()=>({delay:0,duration:100})),ve("focusin",se,()=>{x(W,"SearchCondition"),x(P,"SearchCondition")}),ve("click",se,()=>{x(W,"SearchCondition"),x(P,"SearchCondition")}),ve("click",Ue,()=>{x(P,"DeckEdit")}),ve("focusin",Ue,()=>{x(P,"DeckEdit")}),s(d,Se),bt()}const wn=["TblDeckHeader","TblDeckDetail","TblDuelistProfile"],Cn=3;var Dn=l('<input class="game_mode_radio svelte-sy4ydn" type="radio" name="game_mode"> <label> </label>',1),$n=l('<option class="svelte-sy4ydn"> </option>'),Sn=l('<option class="svelte-sy4ydn"> </option>'),Mn=l('<option class="svelte-sy4ydn"> </option>'),Tn=l('<tr class="config_row svelte-sy4ydn"><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><label for="npc_deck_selector" class="config_row_label deck_selector svelte-sy4ydn">デッキ：</label></div></td><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><select id="npc_deck_selector" class="deck_selector svelte-sy4ydn"><option class="svelte-sy4ydn">デフォルト</option><!></select></div></td></tr>'),jn=l('<option class="svelte-sy4ydn"> </option>'),Bn=l('<tr class="config_row svelte-sy4ydn"><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><label for="npc_selector" class="config_row_label npc_selector svelte-sy4ydn">対戦相手：</label></div></td><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><select id="npc_selector" class="npc_selector svelte-sy4ydn"></select> <div class="svelte-sy4ydn"> </div></div></td></tr> <!> <tr class="config_row svelte-sy4ydn"><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><label for="npc_selector" class="config_row_label npc_selector svelte-sy4ydn">先攻後攻：</label></div></td><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><select id="npc_selector" class="npc_selector svelte-sy4ydn"></select></div></td></tr>',1),En=l('<option class="svelte-sy4ydn"> </option>'),An=l('<tr class="config_row svelte-sy4ydn"><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><label for="difficulty_selector" class="config_row_label difficulty_selector svelte-sy4ydn">難易度：</label></div></td><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><select id="difficulty_selector" class="difficulty_selector svelte-sy4ydn"></select></div></td></tr>'),Yn=l('<tr class="config_row svelte-sy4ydn"><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><label class="config_row_label svelte-sy4ydn" for="game_mode_radio_preset">ゲームモード：</label></div></td><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"></div></td></tr> <tr class="config_row svelte-sy4ydn"><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><label for="deck_selector" class="config_row_label deck_selector svelte-sy4ydn">デッキ：</label></div></td><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><select id="deck_selector" class="deck_selector svelte-sy4ydn"></select></div></td></tr> <!> <tr><td colspan="2" class="svelte-sy4ydn"><div><button class="btn svelte-sy4ydn">duel start!</button></div></td></tr>',1),Ln=l('<tr><td colspan="2" class="svelte-sy4ydn"><div>デッキ情報の読み込み、もしくは作成中...</div></td></tr>'),Un=l('<tr><td colspan="2" class="svelte-sy4ydn"><div><button class="btn svelte-sy4ydn">deck edit</button></div></td></tr>'),Nn=l('<tr class="config_row svelte-sy4ydn"><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><label for="duelist_name" class="config_row_label duelist_name svelte-sy4ydn">名前：</label></div></td><td class="svelte-sy4ydn"><div class="svelte-sy4ydn"><input id="duelist_name" class="duelist_name svelte-sy4ydn" type="text"></div></td></tr> <!> <!>',1),qn=l('<tr><td colspan="2" class="svelte-sy4ydn"><div>デュエリスト情報の読み込み、もしくは作成中...</div></td></tr>'),Pn=l('<div class="app_body svelte-sy4ydn"><table class="config_table svelte-sy4ydn"><tbody><!></tbody></table></div>'),Fn=l('<span class="svelte-sy4ydn"> </span> <span class="svelte-sy4ydn"> </span>',1),Hn=l('<div class="result_title result_win svelte-sy4ydn">YOU WIN</div>'),On=l('<div class="result_title result_lose svelte-sy4ydn">YOU LOSE</div>'),Rn=l('<div class="result_title result_draw svelte-sy4ydn">DRAW</div>'),Wn=l('<div class="twitter_share_button_wrapper svelte-sy4ydn"><a rel="nofollow" target="_blank" class="twitter_share_button svelte-sy4ydn">X(twitter)でシェアする</a></div>'),In=l('<div class="result svelte-sy4ydn"><!> <div class="reason_of_end svelte-sy4ydn"> </div> <!> <div class="svelte-sy4ydn"><button class="white_button svelte-sy4ydn">TOPへ戻る</button></div></div>'),Kn=l('<main style="flex-direction: column; display :flex" class="svelte-sy4ydn"><div class="link link_left svelte-sy4ydn"><a href="https://github.com/Setta238/stk_ygo_svelte" target="_blank" rel="noopener noreferrer" title="repository" class="svelte-sy4ydn">repository</a> <a href="https://x.com/ninja_no" target="_blank" rel="noopener noreferrer" title="repository" class="svelte-sy4ydn">X(Twitter)</a> <a href="https://posfie.com/@ninja_no/p/Lx7FLj3" target="_blank" rel="noopener noreferrer" title="posfie" class="svelte-sy4ydn">posfie(toggeter)</a></div> <div class="link link_right svelte-sy4ydn"><a class="a_button svelte-sy4ydn" role="button" tabindex="0">TOPへ戻る</a> <a href="/stk_ygo_svelte/note.html" target="_blank" rel="noopener noreferrer" title="repository" class="svelte-sy4ydn">現時点とこの先のこと</a></div> <!> <div class="footer card_summary svelte-sy4ydn"><!></div> <div class="footer debug_info svelte-sy4ydn"><span class="svelte-sy4ydn"> </span> <span class="user_agent_info svelte-sy4ydn"> </span> <span class="screen_info svelte-sy4ydn"> </span></div> <!></main>');function zn(d,i){mt(i,!1);const t=new kr("stk_ygo_svelte",Cn,wn);let c=_e(0),_=_e(0),v=_e(),u=_e("FtkChallenge"),o=_e("None"),L=_e(0),A=_e(""),S=_e(void 0);const M="https://setta238.github.io/stk_ygo_svelte/",n="遊戯王deそりてあ",P="ninja_no",W=xr.getOrCreateNew(t).then($=>(x(u,Ua.includes($.previousGameMode)?$.previousGameMode:"FtkChallenge"),Ye($.previousNpcId),$)),V=$=>{var p;const w=$.find(g=>g.lastUsedAt.getTime()===Math.max(...$.map(O=>O.lastUsedAt.getTime())))??$[0];x(L,w.id),e(u)==="FtkChallenge"&&w.deckType!=="Preset"&&x(L,((p=Pt.find(g=>g.deckType==="Preset"))==null?void 0:p.id)??e(L))};let E=_e(Dt.getAllDeckInfo(t).then($=>(Promise.all($.filter(w=>!w.lastUsedAt).map(w=>{w.saveDeckInfo()})),V($),$)));const U=async()=>{const $=e(L);let w=(await e(E)).find(g=>g.id===$)??(await xe()).find(g=>g.id===$);w&&await w.updateTimestamp();let p=w;if(p||(p=Pt.find(g=>g.id===$)),!p)throw new Error("illegal state");return p},ce=async()=>{(await W).save({previousGameMode:e(u)})},xe=()=>(x(E,Dt.getAllDeckInfo(t).then($=>(V($),$))),e(E)),k=async()=>{(await e(E)).length||(await Dt.prepareSampleDeck(),xe())},B=async()=>{await Promise.all([ce(),k()]);const $=await U(),w=await W;let p=It.find(K=>K.id===Number.MIN_SAFE_INTEGER)??It[0],g=Pt.find(K=>K.id===Number.MIN_SAFE_INTEGER)??Pt[0],O="PlayFirst";e(u)==="FtkChallenge"?p=It.filter(K=>K.npcType==="FtkChallenge").find(K=>K.difficulty===w.previousDifficulty)??p:e(u)==="Free"&&(p=It.find(K=>K.id===w.previousNpcId)??p,g=Pt.slice(-1)[0],O=w.previousStartMode),p.npcType!=="FtkChallenge"&&w.previousNpcDeckId>-1?g=(await e(E)).find(K=>K.id===w.previousNpcDeckId)??g:g=Pt.find(K=>K.id===p.id)??g,x(v,new Dr(w,"Player",$,[],p,"NPC",g,[],O)),e(v).onDuelEnd.append(()=>(x(v,e(v)),"RemoveMe"))},I=async()=>{await Promise.all([ce(),k()]),x(o,"DeckEdit")},te=async $=>{await ce(),$.key==="Enter"&&!$.repeat&&(await W).save()},ee=()=>{x(E,xe()),x(v,void 0),x(o,"None")};let we=Date.now();const me=$=>{Date.now()-we<200||(we=Date.now(),x(u,$),xe())},re=$=>{Ye(Number($.currentTarget.value))},Ye=$=>{var w;x(S,It.find(p=>p.id===$)),x(A,((w=e(S))==null?void 0:w.description)??"")};k(),ht();var he=Kn(),Y=r(a(he),2),q=a(Y),oe=r(Y,2);{var ke=$=>{var w=Te(),p=N(w);kt(p,()=>W,null,(g,O)=>{mi(g,{get duel(){return e(v)},get userProfile(){return e(O)}})}),s($,w)},Se=$=>{var w=Te(),p=N(w);{var g=K=>{xn(K,{})},O=K=>{var Me=Pn(),De=a(Me),ue=a(De),J=a(ue);kt(J,()=>W,Z=>{var z=qn();s(Z,z)},(Z,z)=>{var $e=Nn(),Pe=N($e),He=a(Pe),qe=a(He),Le=r(He),Ke=a(Le),je=a(Ke),ge=r(Pe,2);kt(ge,()=>e(E),Ue=>{var Ie=Ln();s(Ue,Ie)},(Ue,Ie)=>{var Ze=Yn(),Oe=N(Ze),Qe=a(Oe),C=a(Qe),b=r(Qe),Q=a(b);le(Q,5,()=>Ua,de,(rt,et)=>{var nt=Dn(),st=N(nt),_t=r(st,2),pt=a(_t);f(ct=>{xt(st,"id",`game_mode_radio_${ct??""}`),wr(st,e(et)),Cr(st,e(u)===e(et)),Ee(_t,`game_mode_tab_label game_mode_tab_${ct??""} svelte-sy4ydn`),xt(_t,"for",`game_mode_radio_${ct??""}`),y(pt,e(et))},[()=>e(et).toLowerCase()],ye),ve("change",st,()=>me(e(et))),s(rt,nt)});var ie=r(Oe,2),Be=a(ie),Je=a(Be),Ne=r(Be),ze=a(Ne),Re=a(ze);f(()=>{e(L),Ut(()=>{e(u),e(Ie)})}),le(Re,5,()=>e(u)==="FtkChallenge"?Pt.filter(rt=>rt.deckType==="Preset"):e(Ie),de,(rt,et)=>{var nt=$n(),st={},_t=a(nt);f(()=>{st!==(st=e(et).id)&&(nt.value=(nt.__value=e(et).id)==null?"":e(et).id),y(_t,e(et).name)}),s(rt,nt)});var Ve=r(ie,2);{var dt=rt=>{var et=Bn(),nt=N(et),st=a(nt),_t=a(st),pt=r(st),ct=a(pt),$t=a(ct);f(()=>{e(z),Ut(()=>{})}),le($t,5,()=>It,de,(lt,Ge)=>{var ut=Sn(),qt={},Wt=a(ut);f(()=>{qt!==(qt=e(Ge).id)&&(ut.value=(ut.__value=e(Ge).id)==null?"":e(Ge).id),y(Wt,e(Ge).name)}),s(lt,ut)});var Mt=r($t,2),Tt=a(Mt),Xe=r(nt,2);{var tt=lt=>{var Ge=Tn(),ut=a(Ge),qt=a(ut),Wt=r(ut),xa=a(Wt),wa=a(xa);f(()=>{e(z),Ut(()=>{e(Ie)})});var da=a(wa);da.value=(da.__value=Number.MIN_SAFE_INTEGER)==null?"":Number.MIN_SAFE_INTEGER;var Ka=r(da);le(Ka,1,()=>e(Ie),de,(ca,ea)=>{var ta=Mn(),Ca={},za=a(ta);f(()=>{Ca!==(Ca=e(ea).id)&&(ta.value=(ta.__value=e(ea).id)==null?"":e(ea).id),y(za,e(ea).name)}),s(ca,ta)}),ae(3,qt,()=>pe,()=>({duration:200})),ae(3,ut,()=>pe,()=>({duration:200})),Kt(wa,()=>e(z).previousNpcDeckId,ca=>e(z).previousNpcDeckId=ca),ae(3,xa,()=>pe,()=>({duration:200})),ae(3,Wt,()=>pe,()=>({duration:200})),ae(3,Ge,()=>pe,()=>({duration:200})),s(lt,Ge)};h(Xe,lt=>{var Ge;((Ge=e(S))==null?void 0:Ge.npcType)!=="FtkChallenge"&&lt(tt)})}var at=r(Xe,2),Ae=a(at),Fe=a(Ae),yt=r(Ae),vt=a(yt),Ct=a(vt);f(()=>{e(z),Ut(()=>{})}),le(Ct,5,()=>Ht(Na),de,(lt,Ge)=>{var ut=jn(),qt={},Wt=a(ut);f(()=>{qt!==(qt=e(Ge))&&(ut.value=(ut.__value=e(Ge))==null?"":e(Ge)),y(Wt,Na[e(Ge)])}),s(lt,ut)}),f(()=>y(Tt,`※${e(A)??""}`)),ae(3,_t,()=>pe,()=>({duration:200})),ae(3,st,()=>pe,()=>({duration:200})),ve("change",$t,re),Kt($t,()=>e(z).previousNpcId,lt=>e(z).previousNpcId=lt),ae(3,ct,()=>pe,()=>({duration:200})),ae(3,pt,()=>pe,()=>({duration:200})),ae(3,nt,()=>pe,()=>({duration:200})),ae(3,Fe,()=>pe,()=>({duration:200})),ae(3,Ae,()=>pe,()=>({duration:200})),Kt(Ct,()=>e(z).previousStartMode,lt=>e(z).previousStartMode=lt),ae(3,vt,()=>pe,()=>({duration:200})),ae(3,yt,()=>pe,()=>({duration:200})),ae(3,at,()=>pe,()=>({duration:200})),s(rt,et)},ft=rt=>{var et=Te(),nt=N(et);{var st=_t=>{var pt=An(),ct=a(pt),$t=a(ct),Mt=r(ct),Tt=a(Mt),Xe=a(Tt);f(()=>{e(z),Ut(()=>{})}),le(Xe,5,()=>$r,de,(tt,at)=>{var Ae=En(),Fe={},yt=a(Ae);f(()=>{Fe!==(Fe=e(at))&&(Ae.value=(Ae.__value=e(at))==null?"":e(at)),y(yt,e(at))}),s(tt,Ae)}),ae(3,$t,()=>pe,()=>({duration:200})),ae(3,ct,()=>pe,()=>({duration:200})),Kt(Xe,()=>e(z).previousDifficulty,tt=>e(z).previousDifficulty=tt),ae(3,Tt,()=>pe,()=>({duration:200})),ae(3,Mt,()=>pe,()=>({duration:200})),ae(3,pt,()=>pe,()=>({duration:200})),s(_t,pt)};h(nt,_t=>{e(u)==="FtkChallenge"&&_t(st)},!0)}s(rt,et)};h(Ve,rt=>{e(u)==="Free"?rt(dt):rt(ft,!1)})}var Et=r(Ve,2),At=a(Et),Yt=a(At),Rt=a(Yt);ae(3,C,()=>pe,()=>({duration:200})),ae(3,Qe,()=>pe,()=>({duration:200})),ae(3,Q,()=>pe,()=>({duration:200})),ae(3,b,()=>pe,()=>({duration:200})),ae(3,Oe,()=>pe,()=>({duration:200})),ae(3,Je,()=>pe,()=>({duration:200})),ae(3,Be,()=>pe,()=>({duration:200})),Kt(Re,()=>e(L),rt=>x(L,rt)),ae(3,ze,()=>pe,()=>({duration:200})),ae(3,Ne,()=>pe,()=>({duration:200})),ae(3,ie,()=>pe,()=>({duration:200})),ve("click",Rt,B),ae(3,Yt,()=>pe,()=>({duration:200})),s(Ue,Ze)});var H=r(ge,2);{var fe=Ue=>{var Ie=Un(),Ze=a(Ie),Oe=a(Ze),Qe=a(Oe);ve("click",Qe,I),ae(3,Oe,()=>pe,()=>({duration:200})),ae(3,Ze,()=>pe,()=>({duration:200})),ae(3,Ie,()=>pe,()=>({duration:200})),s(Ue,Ie)};h(H,Ue=>{e(u)==="Free"&&Ue(fe)})}ae(3,qe,()=>pe,()=>({duration:200})),ae(3,He,()=>pe,()=>({duration:200})),St(je,()=>e(z).name,Ue=>e(z).name=Ue),ve("keypress",je,te),ae(3,Ke,()=>pe,()=>({duration:200})),ae(3,Le,()=>pe,()=>({duration:200})),ae(3,Pe,()=>pe,()=>({duration:200})),s(Z,$e)}),s(K,Me)};h(p,K=>{e(o)==="DeckEdit"?K(g):K(O,!1)},!0)}s($,w)};h(oe,$=>{e(v)?$(ke):$(Se,!1)})}var R=r(oe,2),T=a(R);kt(T,()=>Xt,$=>{var w=it("読み込み中");s($,w)},($,w)=>{var p=Fn(),g=N(p),O=a(g),K=r(g,2),Me=a(K);f((De,ue,J)=>{y(O,`公式DB上のカード${De??""}枚`),y(Me,`実装済カード（効果あり）${ue??""}枚 （効果なし）${J??""}枚`)},[()=>e(w).knmCount.toLocaleString(),()=>e(w).definitionCount.toLocaleString(),()=>e(w).nonDefinitionCount.toLocaleString()],ye),s($,p)});var G=r(R,2),se=a(G),ne=a(se),D=r(se,2),j=a(D),m=r(D,2),F=a(m),X=r(G,2);{var Ce=$=>{var w=In(),p=a(w);{var g=z=>{var $e=Te(),Pe=N($e);{var He=Le=>{var Ke=Hn();s(Le,Ke)},qe=Le=>{var Ke=Te(),je=N(Ke);{var ge=H=>{var fe=On();s(H,fe)};h(je,H=>{e(v).winner.seat==="Above"&&H(ge)},!0)}s(Le,Ke)};h(Pe,Le=>{e(v).winner.seat==="Below"?Le(He):Le(qe,!1)})}s(z,$e)},O=z=>{var $e=Rn();s(z,$e)};h(p,z=>{e(v).winner?z(g):z(O,!1)})}var K=r(p,2),Me=a(K),De=r(K,2);{var ue=z=>{var $e=Wn(),Pe=a($e);f(()=>xt(Pe,"href",`https://x.com/share?url=${M}&text=${e(v).twitterShareText??""}&hashtags=${n}&via=${P}`)),s(z,$e)};h(De,z=>{e(v).twitterShareText&&z(ue)})}var J=r(De,2),Z=a(J);f(()=>y(Me,e(v).reasonOfEnd)),ve("click",Z,ee),ae(3,w,()=>Tr,()=>({delay:200,duration:200})),s($,w)};h(X,$=>{e(v)&&e(v).isEnded&&$(Ce)})}f(()=>{y(ne,"build at: 20260111_214016"),y(j,fa.text),y(F,`w:${e(c)??""}px h:${e(_)??""}px`)}),sa("innerWidth",$=>x(c,$)),sa("innerHeight",$=>x(_,$)),ve("click",q,ee),s(d,he),bt()}Sr(zn,{target:document.getElementById("app")});
